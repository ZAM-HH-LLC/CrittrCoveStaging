(()=>{var e={36009:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>ji,navigate:()=>fi,navigationRef:()=>hi});var a=o(36665),n=o(95991),r=o(73929),i=o(6283),s=o(15648),l=o(14732),d=o(8218),c=o(66986),u=o(48658),m=o(26166),g=o(43150),h=o(45010),f=o(6541),p=o(38432),y=o(59742),b=o(19620),x=o(91087),j=o(34470),w=o(77109),C=o(24534),v=o(26725),S=o(7869),T=o(60397);const B=l.default.create({overlay:{position:"web"===n.default.OS?"fixed":"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:999},container:{position:"web"===n.default.OS?"fixed":"absolute",backgroundColor:f.theme.colors.surface,borderRadius:12,padding:20,width:320,shadowColor:"#000",shadowOffset:{width:0,height:4},shadowOpacity:.3,shadowRadius:5,elevation:8,zIndex:1e3,borderWidth:2,borderColor:f.theme.colors.primary},pulseBorder:{position:"absolute",top:-4,left:-4,right:-4,bottom:-4,borderRadius:14,opacity:.7},closeButton:{position:"absolute",top:12,right:12,padding:8,zIndex:1},content:{marginTop:12},title:{fontSize:20,fontWeight:"700",color:f.theme.colors.primary,marginBottom:8,fontFamily:f.theme.fonts.header.fontFamily},description:{fontSize:16,color:f.theme.colors.text,marginBottom:20,lineHeight:22,fontFamily:f.theme.fonts.regular.fontFamily},footer:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginTop:16},leftButtons:{flex:1},skipButton:{paddingVertical:8,paddingHorizontal:12},skipText:{color:f.theme.colors.secondary,fontSize:14,fontFamily:f.theme.fonts.regular.fontFamily},navigationButton:{flexDirection:"row",alignItems:"center",paddingVertical:8,paddingHorizontal:12},navigationText:{color:f.theme.colors.primary,fontSize:14,fontWeight:"500",fontFamily:f.theme.fonts.regular.fontFamily},finishButton:{backgroundColor:f.theme.colors.primary,paddingVertical:8,paddingHorizontal:16,borderRadius:4},finishText:{color:f.theme.colors.surface,fontSize:14,fontWeight:"500",fontFamily:f.theme.fonts.regular.fontFamily},stepIndicator:{paddingHorizontal:12},stepText:{color:f.theme.colors.secondary,fontSize:14,fontFamily:f.theme.fonts.regular.fontFamily}}),k=({step:e,totalSteps:t,title:o,description:n,onNext:l,onPrevious:d,onSkip:c,onClose:u,onFinish:m,position:g="bottomRight",userRole:h,is_DEBUG:y=!1})=>{const b=1===e,x=e===t,[w,k]=(0,a.useState)(!0),[_,A]=(0,a.useState)(null),I=(0,j.useNavigation)(),D=(0,a.useRef)(new C.default.Value(0)).current,M=(0,a.useRef)(new C.default.Value(0)).current,R=(0,a.useRef)(new C.default.Value(1)).current,{width:P,height:z}=v.default.get("window");(0,a.useEffect)((()=>{y&&(0,p.debugLog)("MBA54321 TutorialModal mounted/updated",{isVisible:w,currentStep:e,userRole:h,screen:_})}),[w,e,h,_]),(0,a.useEffect)((()=>{if(w){(0,p.debugLog)("MBA54321 Tutorial is visible, ensuring it stays visible on screen change");const e=setTimeout((()=>{k(!0)}),100);return()=>clearTimeout(e)}}),[w]),(0,a.useEffect)((()=>I.addListener("focus",(()=>{w&&((0,p.debugLog)("MBA54321 Screen focused, ensuring tutorial stays visible"),k(!0))}))),[I,w]),(0,a.useEffect)((()=>{C.default.timing(D,{toValue:1,duration:500,useNativeDriver:!0}).start(),C.default.timing(M,{toValue:1,duration:800,useNativeDriver:!0}).start(),C.default.timing(R,{toValue:0,duration:800,useNativeDriver:!0}).start()}),[]);const F={top:(z+60)/2-150,left:(P-15)/2-160},L=(()=>{switch(g){case"bottomRight":default:return{bottom:20,right:20};case"bottomLeft":return{bottom:20,left:20};case"topRight":return{top:20,right:20};case"topLeft":return{top:20,left:20}}})(),O={transform:[{translateX:M.interpolate({inputRange:[0,1],outputRange:[0,L.right?P/2-160:-P/2+160]})},{translateY:M.interpolate({inputRange:[0,1],outputRange:[0,L.bottom?z/2-150:-z/2+150]})}]};return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(C.default.View,{style:[B.overlay,{opacity:R}],pointerEvents:"none"}),(0,T.jsxs)(C.default.View,{style:[B.container,F,{opacity:D},O],children:[(0,T.jsx)(r.default,{style:B.pulseBorder}),(0,T.jsx)(s.default,{style:B.closeButton,onPress:()=>{y&&(0,p.debugLog)("MBA54321 TutorialModal handleClose called"),u()},children:(0,T.jsx)(S.default,{name:"close",size:20,color:f.theme.colors.text})}),(0,T.jsxs)(r.default,{style:B.content,children:[(0,T.jsx)(i.default,{style:B.title,children:o}),(0,T.jsx)(i.default,{style:B.description,children:n}),(0,T.jsxs)(r.default,{style:B.footer,children:[(0,T.jsx)(r.default,{style:B.leftButtons,children:b?(0,T.jsx)(s.default,{style:B.skipButton,onPress:()=>{y&&(0,p.debugLog)("MBA54321 TutorialModal handleSkip called"),c()},children:(0,T.jsx)(i.default,{style:B.skipText,children:"Skip Tutorial"})}):(0,T.jsxs)(s.default,{style:B.navigationButton,onPress:()=>{y&&(0,p.debugLog)("MBA54321 TutorialModal handlePrevious called",{step:e,totalSteps:t}),d()},children:[(0,T.jsx)(S.default,{name:"chevron-left",size:20,color:f.theme.colors.primary}),(0,T.jsx)(i.default,{style:B.navigationText,children:"Previous"})]})}),(0,T.jsx)(r.default,{style:B.stepIndicator,children:(0,T.jsxs)(i.default,{style:B.stepText,children:[e,"/",t]})}),x?(0,T.jsx)(s.default,{style:B.finishButton,onPress:()=>{y&&(0,p.debugLog)("MBA54321 TutorialModal handleFinish called"),m()},children:(0,T.jsx)(i.default,{style:B.finishText,children:"Finish Tutorial"})}):(0,T.jsxs)(s.default,{style:B.navigationButton,onPress:()=>{y&&(0,p.debugLog)("MBA54321 TutorialModal handleNext called",{step:e,totalSteps:t}),l()},children:[(0,T.jsx)(i.default,{style:B.navigationText,children:"Next"}),(0,T.jsx)(S.default,{name:"chevron-right",size:20,color:f.theme.colors.primary})]})]})]})]})]})};var _=o(78264),A=o(20530);const I=l.default.create({modalOverlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center"},modalContent:{backgroundColor:f.theme.colors.surface,borderRadius:8,padding:20,width:"90%",maxWidth:400},modalText:{fontSize:f.theme.fontSizes.medium,marginBottom:20,textAlign:"center",color:f.theme.colors.text},buttonContainer:{flexDirection:"row",justifyContent:"space-between",gap:10},button:{flex:1,paddingVertical:12,borderRadius:8,alignItems:"center"},cancelButton:{backgroundColor:f.theme.colors.surface,borderWidth:1,borderColor:f.theme.colors.border},confirmButton:{backgroundColor:f.theme.colors.primary},cancelButtonText:{color:f.theme.colors.text,fontWeight:"500"},confirmButtonText:{color:f.theme.colors.surface,fontWeight:"500"},disabledButton:{opacity:.7},disabledText:{opacity:.5}}),D=({visible:e,onClose:t,onConfirm:o,actionText:a,isLoading:n=!1})=>(0,T.jsx)(_.default,{visible:e,transparent:!0,animationType:"fade",onRequestClose:t,children:(0,T.jsx)(r.default,{style:I.modalOverlay,children:(0,T.jsxs)(r.default,{style:I.modalContent,children:[(0,T.jsxs)(i.default,{style:I.modalText,children:["Are you sure you want to ",a,"?"]}),(0,T.jsxs)(r.default,{style:I.buttonContainer,children:[(0,T.jsx)(s.default,{style:[I.button,I.cancelButton],onPress:t,disabled:n,children:(0,T.jsx)(i.default,{style:[I.cancelButtonText,n&&I.disabledText],children:"Cancel"})}),(0,T.jsx)(s.default,{style:[I.button,I.confirmButton,n&&I.disabledButton],onPress:o,disabled:n,children:n?(0,T.jsx)(A.default,{size:"small",color:f.theme.colors.surface}):(0,T.jsx)(i.default,{style:I.confirmButtonText,children:"Confirm"})})]})]})})}),M=(0,a.createContext)(),R={done_client_tutorial:!1,done_pro_tutorial:!1},P={client:[{screen:"MyProfile",tab:"profile_info",title:"Welcome to Your Profile",description:"This is where you can manage your personal information. Start by completing your profile to help professionals understand your needs better.",position:"bottomRight"},{screen:"MyProfile",tab:"pets_preferences",title:"Add Pets & Home Info",description:"Add information about your pets and their care preferences along with your home information. This helps professionals provide the best care possible.",position:"bottomRight"},{screen:"MyProfile",tab:"settings_payments",title:"Payment & Settings",description:"Set up your settings, payment methods, and subscription preferences to easily book services.",position:"bottomRight"},{screen:"Dashboard",title:"Your Dashboard",description:"Here you can view your upcoming bookings, track ongoing services, and manage your account.",position:"bottomRight",onStepEnter:e=>{e&&e.navigate("Dashboard")}},{screen:"SearchProfessionalsListing",title:"Find Professionals",description:"Search for qualified professionals in your area. Filter by service type, availability, and more.",position:"bottomRight"},{screen:"BecomeProfessional",title:"Become a Professional",description:"Want to offer your services? You can apply to become a professional anytime.",position:"bottomRight"}],professional:[{screen:"MyProfile",tab:"profile_info",title:"Welcome to Your Professional Profile",description:"This is where you can manage your professional information. Start by completing your profile to help clients find you.",position:"bottomRight"},{screen:"MyProfile",tab:"services",title:"Your Services",description:"Add and manage the services you offer. Set your rates, availability, and service areas.",position:"bottomRight"},{screen:"MyProfile",tab:"settings_payments",title:"Payment Settings",description:"Set up your payment methods and subscription preferences to receive payments from clients.",position:"bottomRight"},{screen:"Dashboard",title:"Your Dashboard",description:"Here you can view your upcoming bookings, track ongoing services, and manage your account.",position:"bottomRight",onStepEnter:e=>{e&&e.navigate("Dashboard")}},{screen:"SearchClients",title:"Find Clients",description:"Search for potential clients in your area. Filter by service type, pet type, and more.",position:"bottomRight"}],default:[{screen:"Home",title:"Welcome",description:"Welcome to CrittrCove! Let's get started with a quick tour.",position:"bottomRight"}]},z=({children:e})=>{const{isSignedIn:t,userRole:o,is_DEBUG:n}=(0,a.useContext)(p.AuthContext),r=(0,j.useNavigation)(),[i,s]=(0,a.useState)(R),[l,d]=(0,a.useState)(1),[c,u]=(0,a.useState)(!1),[m,g]=(0,a.useState)(!1),[f,y]=(0,a.useState)(""),[x,C]=(0,a.useState)(!0),[v,S]=(0,a.useState)(!1),[B,_]=(0,a.useState)(!1);(0,a.useEffect)((()=>{t&&o?((0,p.debugLog)("MBA54321 Both isSignedIn and userRole are available, fetching tutorial status",{isSignedIn:t,userRole:o}),A()):((0,p.debugLog)("MBA54321 Waiting for auth data",{isSignedIn:t,userRole:o}),C(!1))}),[t,o]);const A=async()=>{try{C(!0);const e=await w.default.get("".concat(b.API_BASE_URL,"/api/users/v1/tutorial-status/current/"));n&&(0,p.debugLog)("MBA54321 Tutorial status:",e.data),s(e.data),g(!1),y(""),"professional"===o&&!e.data.done_pro_tutorial||"petOwner"===o&&!e.data.done_client_tutorial?(u(!0),n&&(0,p.debugLog)("MBA54321 Redirecting new user to MyProfile screen"),(0,h.navigateToFrom)(r,"MyProfile","Dashboard",{screen:"profile_info"}),n&&(0,p.debugLog)("MBA54321 Tutorial should be visible:",{userRole:o,done_client_tutorial:e.data.done_client_tutorial,done_pro_tutorial:e.data.done_pro_tutorial})):(n&&(0,p.debugLog)("MBA54321 Tutorial should NOT be visible"),u(!1))}catch(e){console.error("Error fetching tutorial status:",e),g(!0),y("We had trouble loading your tutorial settings, but you can still proceed with the tutorial."),s(R),u(!0)}finally{C(!1)}},I=()=>{let e="default";"professional"===o?e="professional":"petOwner"!==o&&"client"!==o||(e="client");const t=P[e]||P.default,a=Math.min(Math.max(1,l),t.length),n=t[a-1];return m&&1===a?Object.assign({},n,{description:"".concat(f,"\n\n").concat(n.description)}):n},z=async()=>{(0,p.debugLog)("MBA54321 handleNext called",{currentStep:l,userRole:o});const e=P["professional"===o?"professional":"client"];if(l>=e.length)return void(0,p.debugLog)("MBA54321 At last step, completing tutorial",{currentStep:l,totalSteps:e.length});const t=e[l],a=e[l-1];(0,p.debugLog)("MBA54321 Current step data",a),(0,p.debugLog)("MBA54321 Next step data",t),d((e=>e+1)),(t.screen!==a.screen||t.tab&&t.tab!==a.tab)&&((0,p.debugLog)("MBA54321 Navigating to different screen/tab",{from:a.screen,to:t.screen,fromTab:a.tab,toTab:t.tab}),t.tab?(0,h.navigateToFrom)(r,t.screen,a.screen,{screen:t.tab}):(0,h.navigateToFrom)(r,t.screen,a.screen),setTimeout((()=>{u(!0)}),700))},F=()=>{if((0,p.debugLog)("MBA54321 handlePrevious called",{currentStep:l,userRole:o}),l>1){const e=P["professional"===o?"professional":"client"],t=e[l-2],a=e[l-1];(0,p.debugLog)("MBA54321 Previous step data",t),(0,p.debugLog)("MBA54321 Current step data",a),d((e=>e-1)),(t.screen!==a.screen||t.tab&&t.tab!==a.tab)&&((0,p.debugLog)("MBA54321 Navigating back to different screen/tab",{from:a.screen,to:t.screen,fromTab:a.tab,toTab:t.tab}),t.tab?(0,h.navigateToFrom)(r,t.screen,a.screen,{screen:t.tab}):(0,h.navigateToFrom)(r,t.screen,a.screen),setTimeout((()=>{u(!0)}),700))}},L=()=>{(0,p.debugLog)("MBA54321 handleSkip called through the later"),S(!0)},O=async()=>{(0,p.debugLog)("MBA54321 Completing tutorial",{userRole:o});try{const e={};"professional"===o?e.done_pro_tutorial=!0:"petOwner"!==o&&"client"!==o||(e.done_client_tutorial=!0),await w.default.patch("".concat(b.API_BASE_URL,"/api/users/v1/tutorial-status/update_status/"),e),(0,p.debugLog)("MBA54321 Tutorial status updated in backend"),u(!1),(0,p.debugLog)("MBA54321 Navigating to Dashboard"),(0,h.navigateToFrom)(r,"Dashboard",I().screen)}catch(e){(0,p.debugLog)("MBA54321 Error completing tutorial",{error:e.message}),console.error("Error completing tutorial:",e),(0,h.navigateToFrom)(r,"Dashboard",I().screen)}};return x?(0,T.jsx)(M.Provider,{value:{isVisible:!1,currentStep:1,totalSteps:1,stepData:P.default[0],tutorialStatus:R,hasError:!1,errorMessage:"",handleNext:()=>{},handlePrevious:()=>{},handleSkip:()=>{},completeTutorial:()=>{},setIsVisible:()=>{},isLoading:!0},children:e}):(0,T.jsxs)(M.Provider,{value:{isVisible:c,setIsVisible:u,currentStep:l,setCurrentStep:d,handleNext:z,handlePrevious:F,handleSkip:L,completeTutorial:O,isLoading:x},children:[e,c&&I()&&(0,T.jsx)(k,{step:l,totalSteps:P["professional"===o?"professional":"petOwner"===o||"client"===o?"client":"default"].length,title:I().title,description:I().description,onNext:z,onPrevious:F,onSkip:L,onClose:()=>{(0,p.debugLog)("MBA54321 handleClose called"),_(!0)},onFinish:O,position:I().position,userRole:o,is_DEBUG:n}),(0,T.jsx)(D,{visible:v,onClose:()=>{(0,p.debugLog)("MBA54321 handleSkipCancel called"),S(!1)},onConfirm:()=>{(0,p.debugLog)("MBA54321 handleSkipConfirm called"),S(!1),O()},actionText:"skip the tutorial",isLoading:!1}),(0,T.jsx)(D,{visible:B,onClose:()=>{(0,p.debugLog)("MBA54321 handleCloseCancel called"),_(!1)},onConfirm:()=>{(0,p.debugLog)("MBA54321 handleCloseConfirm called"),_(!1),O()},actionText:"close the tutorial",isLoading:!1})]})},F=l.default.create({container:{position:"web"===n.default.OS?"fixed":"absolute",bottom:20,right:0,zIndex:9999,paddingHorizontal:16,width:"100%",alignItems:"flex-end"},toast:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingVertical:12,paddingHorizontal:12,borderRadius:8,minWidth:200,maxWidth:300,elevation:6,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:3.84},content:{flex:1,flexDirection:"row",alignItems:"center"},icon:{marginRight:8},message:{color:"#fff",fontSize:14,fontFamily:"web"===n.default.OS?void 0:f.theme.fonts?.regular?.fontFamily,flex:1},closeButton:{padding:4}}),L=({visible:e,message:t,type:o="success",onDismiss:n,duration:l=3e3})=>{const d=(0,a.useRef)(new C.default.Value(v.default.get("window").width)).current,c=(0,a.useRef)(new C.default.Value(0)).current,u=(0,a.useRef)(null);(0,a.useEffect)((()=>(e&&(u.current&&clearTimeout(u.current),C.default.parallel([C.default.timing(d,{toValue:0,duration:300,useNativeDriver:!0}),C.default.timing(c,{toValue:1,duration:300,useNativeDriver:!0})]).start(),u.current=setTimeout((()=>{m()}),l)),()=>{u.current&&clearTimeout(u.current)})),[e,l]);const m=()=>{var e;u.current&&clearTimeout(u.current),e=()=>{n&&n()},C.default.parallel([C.default.timing(d,{toValue:v.default.get("window").width,duration:300,useNativeDriver:!0}),C.default.timing(c,{toValue:0,duration:300,useNativeDriver:!0})]).start(e)};return e?(0,T.jsx)(r.default,{style:F.container,pointerEvents:"box-none",children:(0,T.jsxs)(C.default.View,{style:[F.toast,{backgroundColor:(()=>{switch(o){case"error":return f.theme.colors.error;case"warning":return f.theme.colors.warning||"#FFA726";case"info":return f.theme.colors.info||"#29B6F6";default:return f.theme.colors.primary}})(),transform:[{translateX:d}],opacity:c}],children:[(0,T.jsxs)(r.default,{style:F.content,children:[(0,T.jsx)(S.default,{name:(()=>{switch(o){case"error":return"alert-circle";case"warning":return"alert";case"info":return"information";default:return"check-circle"}})(),size:24,color:"white",style:F.icon}),(0,T.jsx)(i.default,{style:F.message,numberOfLines:3,ellipsizeMode:"tail",children:t})]}),(0,T.jsx)(s.default,{onPress:m,style:F.closeButton,hitSlop:{top:10,bottom:10,left:10,right:10},children:(0,T.jsx)(S.default,{name:"close",size:18,color:"white"})})]})}):null},O=(0,a.createContext)(),E=()=>{const e=(0,a.useContext)(O);if(!e)throw new Error("useToast must be used within a ToastProvider");return e},W=({children:e})=>{const[t,o]=(0,a.useState)({visible:!1,message:"",type:"success",duration:3e3}),n=(0,a.useCallback)((({message:e,type:t="success",duration:a=3e3})=>{o({visible:!0,message:e,type:t,duration:a})}),[]),i=(0,a.useCallback)((()=>{o((e=>Object.assign({},e,{visible:!1})))}),[]);return(0,T.jsx)(O.Provider,{value:n,children:(0,T.jsxs)(r.default,{style:N.container,children:[e,(0,T.jsx)(L,{visible:t.visible,message:t.message,type:t.type,duration:t.duration,onDismiss:i})]})})},N=l.default.create({container:{flex:1,position:"relative"}});var H=o(2772),U=o(40484),V=o(79632),q=o(16773),Y=o(18885),G=o(16204),J=o(17438),$=o(92288);const Z=l.default.create({container:{padding:20,width:"100%",maxWidth:1200,marginLeft:"auto",marginRight:"auto"},title:{fontSize:24,fontWeight:"bold",textAlign:"center",marginBottom:40,color:"black",fontFamily:f.theme.fonts.header.fontFamily},mobileContainer:{width:"100%",alignItems:"center",paddingVertical:20},mobileItemContainer:{width:"100%",alignItems:"center",marginBottom:80,position:"relative"},mobileMarker:{alignItems:"center",marginBottom:20},mobileMilestoneTitle:{fontSize:16,fontWeight:"bold",color:"black",marginTop:15,textAlign:"center",marginBottom:30},mobileDashedLine:{position:"absolute",width:2,height:60,bottom:-50,borderStyle:"dashed",borderWidth:1,borderColor:"#333"},webContainer:{position:"relative",marginTop:20,marginBottom:120,width:"100%"},dashedLine:{position:"absolute",height:2,top:30,borderStyle:"dashed",borderWidth:1,borderColor:"#333"},webMarker:{position:"absolute",alignItems:"center",width:120,transform:[{translateX:-60}]},webMilestoneTitle:{marginTop:10,fontSize:16,fontWeight:"bold",color:"black",textAlign:"center"},markerContainer:{width:60,height:60,borderRadius:30,justifyContent:"center",alignItems:"center",shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:4,elevation:5},modalOverlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center",padding:20},modalContent:{backgroundColor:"white",padding:20,borderRadius:15,width:"90%",maxWidth:400,alignItems:"center"},modalIconContainer:{width:80,height:80,borderRadius:40,justifyContent:"center",alignItems:"center",marginBottom:20},modalNumber:{color:"white",fontSize:20,fontWeight:"bold",position:"absolute",top:10},modalTitle:{fontSize:24,fontWeight:"bold",marginBottom:15,color:"black",textAlign:"center",fontFamily:f.theme.fonts.header.fontFamily},modalDescription:{fontSize:18,textAlign:"center",marginBottom:20,color:"black",lineHeight:24,fontFamily:f.theme.fonts.regular.fontFamily},closeButton:{padding:12,borderRadius:8,width:"100%",alignItems:"center"},closeButtonText:{color:"white",fontSize:16,fontWeight:"bold"}}),K=()=>{const[e,t]=(0,a.useState)(null),[o,n]=(0,a.useState)(!1),{screenWidth:l}=(0,a.useContext)(p.AuthContext),d=l<768,c=[{id:1,title:"Prototype Launch",description:"Initial release of CrittrCove webpage and landing page with no signup or app functionality.",icon:"dog",color:f.theme.colors.mainColors.senary},{id:2,title:"Launch of MVP",description:"This is when users will be able to sign up and use the app fully for the first time on the website! For a full feature list, please check our blog or discord.",icon:"dragon",color:f.theme.colors.mainColors.quinary},{id:3,title:"Launch of App",description:"Mobile app release with real-time messaging, notifications, and payment integration. For a full feature list, please check our blog or discord.",icon:"cat",color:f.theme.colors.mainColors.quaternary},{id:4,title:"Community Features",description:"Adding social features, pet communities, and expert advice forums.",icon:"fish",color:f.theme.colors.mainColors.main}],u=e=>{t(e),n(!0)};return(0,T.jsxs)(r.default,{style:Z.container,children:[(0,T.jsx)(i.default,{style:Z.title,children:"Roadmap"}),d?(0,T.jsx)(r.default,{style:Z.mobileContainer,children:c.map(((e,t)=>(0,T.jsxs)(r.default,{style:[Z.mobileItemContainer,t===c.length-1?{marginBottom:0}:null],children:[(0,T.jsx)(s.default,{style:Z.mobileMarker,onPress:()=>u(e),children:(0,T.jsx)(r.default,{style:[Z.markerContainer,{backgroundColor:e.color}],children:(0,T.jsx)($.default,{name:e.icon,size:24,color:"white"})})}),(0,T.jsx)(i.default,{style:Z.mobileMilestoneTitle,children:e.title}),t<c.length-1&&(0,T.jsx)(r.default,{style:Z.mobileDashedLine})]},e.id)))}):(0,T.jsxs)(r.default,{style:Z.webContainer,children:[(0,T.jsx)(r.default,{style:[Z.dashedLine,{width:"80%",left:"10%"}]}),c.map(((e,t)=>(0,T.jsxs)(s.default,{style:[Z.webMarker,{left:"".concat(10+t*(80/(c.length-1)),"%")}],onPress:()=>u(e),children:[(0,T.jsx)(r.default,{style:[Z.markerContainer,{backgroundColor:e.color}],children:(0,T.jsx)($.default,{name:e.icon,size:24,color:"white"})}),(0,T.jsx)(i.default,{style:Z.webMilestoneTitle,children:e.title})]},e.id)))]}),(0,T.jsx)(_.default,{visible:o,transparent:!0,animationType:"fade",onRequestClose:()=>n(!1),children:(0,T.jsx)(r.default,{style:Z.modalOverlay,children:(0,T.jsx)(r.default,{style:Z.modalContent,children:e&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)(r.default,{style:[Z.modalIconContainer,{backgroundColor:e.color}],children:[(0,T.jsx)(i.default,{style:Z.modalNumber,children:e.number}),(0,T.jsx)($.default,{name:e.icon,size:40,color:"white"})]}),(0,T.jsx)(i.default,{style:Z.modalTitle,children:e.title}),(0,T.jsx)(i.default,{style:Z.modalDescription,children:e.description}),(0,T.jsx)(s.default,{style:[Z.closeButton,{backgroundColor:e.color}],onPress:()=>n(!1),children:(0,T.jsx)(i.default,{style:Z.closeButtonText,children:"Close"})})]})})})})]})};var Q=o(52622),X=o(97584),ee=o(19149);const te={DRAFT:"Draft",PENDING_INITIAL_PROFESSIONAL_CHANGES:"Pending Initial Professional Changes",PENDING_PROFESSIONAL_CHANGES:"Pending Professional Changes",PENDING_CLIENT_APPROVAL:"Pending Owner Approval",CONFIRMED:"Confirmed",CONFIRMED_PENDING_PROFESSIONAL_CHANGES:"Confirmed Pending Professional Changes",CONFIRMED_PENDING_CLIENT_APPROVAL:"Confirmed Pending Owner Approval",COMPLETED:"Completed",DENIED:"Denied",CANCELLED:"Cancelled",PROFESSIONAL_EDITABLE_STATES:["Draft","Pending Initial Professional Changes","Pending Professional Changes","Confirmed Pending Professional Changes","Confirmed"]},oe="All Services",ae=[oe,"Overnight Cat Sitting (Owner's Home)","Cat Boarding","Drop-In Visits (30 min)","Drop-In Visits (60 min)","Dog Walking","Doggy Day Care","Pet Boarding","Exotic Pet Care","Daytime Pet Sitting","Ferrier"],ne=["15 Min","30 Min","45 Min","1 Hour","2 Hour","3 Hour","4 Hour","5 Hour","6 Hour","7 Hour","8 Hour","24 Hour","Per Day","Per Visit","Week"],re={"Per Visit":"Per Visit","Per Day (24 Hours)":"Per Day","Per Night":"Per Night","Every 15 Minutes":"15 Min","Every 30 Minutes":"30 Min","Every 45 Minutes":"45 Min","Per Hour":"1 Hour","Every 2 Hours":"2 Hour","Every 3 Hours":"3 Hour","Every 4 Hours":"4 Hour","Every 5 Hours":"5 Hour","Every 6 Hours":"6 Hour","Every 7 Hours":"7 Hour","Every 8 Hours":"8 Hour","Per Week":"Week"},ie=Object.entries(re).reduce(((e,[t,o])=>(e[o]=t,e)),{}),se={"Fish Tank Cleaning":[{title:"Extended Stay (7+ days)",amount:15},{title:"Pickup/Dropoff Service",amount:25},{title:"Special Diet Handling",amount:10},{title:"Medication Administration",amount:15}],Ferrier:[{title:"Extended Hours",amount:20},{title:"Training Session",amount:30},{title:"Grooming",amount:25}],"Dog Walking":[{title:"Extra 15 Minutes",amount:10},{title:"Plant Watering",amount:5},{title:"Photo Updates",amount:5}],"Reptile Boarding & Habitat Maintenance":[{title:"Plant Watering",amount:10},{title:"Mail Collection",amount:5},{title:"Extended Visit (4+ hrs)",amount:30}],"Bird Feeding":[{title:"Extra 15 Minutes",amount:10},{title:"Multiple Route Options",amount:5},{title:"Training During Walk",amount:20}]},le=[{id:1,name:"Fish Tank Cleaning",startingPrice:25,animalTypes:["Fish"],icon:"fish",additionalRates:se["Fish Tank Cleaning"]},{id:2,name:"Ferrier",startingPrice:30,animalTypes:["Dogs"],icon:"horse",additionalRates:se.Ferrier},{id:3,name:"Dog Walking",startingPrice:40,animalTypes:["Dogs"],icon:"dog",additionalRates:se["Dog Walking"]},{id:4,name:"Reptile Boarding & Habitat Maintenance",startingPrice:35,animalTypes:["Reptiles"],icon:"snake",additionalRates:se["Reptile Boarding & Habitat Maintenance"]},{id:5,name:"Bird Feeding",startingPrice:45,animalTypes:["Birds"],icon:"bird",additionalRates:se["Bird Feeding"]}],de=[{id:"1",name:"Max",animal_type:"Dog",breed:"border collie",age:{months:0,years:5},weight:32,sex:"Male",friendlyWithChildren:!0,friendlyWithCats:!1,friendlyWithDogs:!0,spayedNeutered:!0,houseTrained:!0,microchipped:!0,adoptionDate:"2020-01-15",description:"Loves to play fetch and go for walks.",energyLevel:"High",feedingSchedule:"Morning",leftAlone:"1-4 hours",medication:null,additionalInstructions:"Needs daily exercise.",vetName:"Dr. Smith",vetAddress:"123 Vet St.",vetPhone:"555-1234",insuranceProvider:"Pet Insurance Co.",vetDocuments:[],galleryImages:[]},{id:"2",name:"Whiskers",animal_type:"Cat",breed:"tammy ammy",age:{months:3,years:4},weight:16,sex:"Female",friendlyWithChildren:!0,friendlyWithCats:!0,friendlyWithDogs:!1,spayedNeutered:!0,houseTrained:!0,microchipped:!1,adoptionDate:"2019-05-20",description:"Enjoys lounging in the sun.",energyLevel:"Low",feedingSchedule:"Twice a day",leftAlone:"4-8 hours",medication:null,additionalInstructions:"Prefers quiet environments.",vetName:"Dr. Jones",vetAddress:"456 Vet Ave.",vetPhone:"555-5678",insuranceProvider:"Pet Health Insurance",vetDocuments:[],galleryImages:[]},{id:"3",name:"Buddy",animal_type:"snake",breed:"leopard gecko",age:{months:0,years:2},weight:1,sex:"Male",friendlyWithChildren:!1,friendlyWithCats:!1,friendlyWithDogs:!1,spayedNeutered:!1,houseTrained:!1,microchipped:!1,adoptionDate:"2021-08-10",description:"A calm and quiet pet.",energyLevel:"Low",feedingSchedule:["Custom","3 times a day with liquid food."],leftAlone:"Can be left alone indefinitely",medication:null,additionalInstructions:"Keep in a warm environment.",vetName:"Dr. Green",vetAddress:"789 Vet Blvd.",vetPhone:"555-9012",insuranceProvider:"Reptile Insurance Co.",vetDocuments:[],galleryImages:[]}],ce=[{id:1,name:"Mike V.",profilePicture:o(81029),location:"Briargate, Colorado Springs, CO, 80920",rating:5,reviewCount:72,price:35,distance:"5.7 mi. away",coordinates:{latitude:38.8339,longitude:-104.8214},services:["Dog Walking","Pet Sitting","Grooming"],experience:"5 years",description:"Professional pet sitter with extensive experience in dog walking and pet sitting. Certified in pet first aid and CPR.",repeat_owners:18,verified:!0,bestReview:"Benny's stay with Mike was outstanding! I would not hesitate to have Benny stay with them again. I would highly recommend Mike to anyone needing pet care services."},{id:2,name:"Sarah Johnson",profilePicture:o(53198),location:"Colorado Springs, CO",rating:4.8,reviewCount:127,price:45,coordinates:{latitude:38.834,longitude:-104.8215},services:["Dog Walking","Pet Sitting","Training"],experience:"8 years",description:"Experienced dog trainer and pet sitter. Specializes in working with large breeds and puppies.",verified:!0,bestReview:"Sarah is amazing with pets! She took great care of my dog and sent regular updates."},{id:3,name:"Emily Rodriguez",profilePicture:o(52695),location:"Colorado Springs, CO",rating:4.7,reviewCount:156,price:40,coordinates:{latitude:38.8341,longitude:-104.8216},services:["Dog Walking","Pet Sitting","Grooming","Training"],experience:"6 years",description:"Professional pet sitter and groomer. Available for both short-term and long-term pet care needs.",verified:!0},{id:4,name:"David Kim",profilePicture:o(30552),location:"Colorado Springs, CO",rating:4.9,reviewCount:98,price:55,coordinates:{latitude:38.8342,longitude:-104.8217},services:["Dog Walking","Pet Sitting","Training","Grooming"],experience:"10 years",description:"Certified dog trainer and experienced pet sitter. Specializes in working with rescue dogs and behavioral training.",verified:!0},{id:5,name:"Lisa Thompson",profilePicture:o(51681),location:"Colorado Springs, CO",rating:4.8,reviewCount:143,price:45,coordinates:{latitude:38.8343,longitude:-104.8218},services:["Dog Walking","Pet Sitting","Grooming"],experience:"7 years",description:"Professional pet sitter with a passion for animal care. Available for both regular and occasional pet sitting needs.",verified:!0},{id:6,name:"John Martinez",profilePicture:o(10602),location:"Colorado Springs, CO",rating:4.6,reviewCount:89,price:42,coordinates:{latitude:38.8344,longitude:-104.8219},services:["Dog Walking","Pet Sitting"],experience:"4 years",description:"Dedicated pet care professional specializing in dog walking and pet sitting services.",verified:!0},{id:7,name:"Rachel White",profilePicture:o(26163),location:"Colorado Springs, CO",rating:4.9,reviewCount:167,price:48,coordinates:{latitude:38.8345,longitude:-104.822},services:["Dog Walking","Pet Sitting","Training"],experience:"9 years",description:"Experienced pet trainer and caregiver with a focus on positive reinforcement techniques.",verified:!0},{id:8,name:"Michael Chen",profilePicture:o(244),location:"Colorado Springs, CO",rating:4.7,reviewCount:112,price:38,coordinates:{latitude:38.8346,longitude:-104.8221},services:["Dog Walking","Pet Sitting","Grooming"],experience:"5 years",description:"Professional pet groomer and sitter with expertise in handling various breeds.",verified:!0},{id:9,name:"Amanda Foster",profilePicture:o(21373),location:"Colorado Springs, CO",rating:4.8,reviewCount:134,price:44,coordinates:{latitude:38.8347,longitude:-104.8222},services:["Dog Walking","Pet Sitting","Training"],experience:"7 years",description:"Certified pet trainer with extensive experience in behavioral modification.",verified:!0},{id:10,name:"Robert Taylor",profilePicture:o(24289),location:"Colorado Springs, CO",rating:4.9,reviewCount:178,price:50,coordinates:{latitude:38.8348,longitude:-104.8223},services:["Dog Walking","Pet Sitting","Training","Grooming"],experience:"11 years",description:"Comprehensive pet care professional offering a full range of services.",verified:!0}],ue=[{id:"1",name:"Alice Johnson",pet_types:["Dog","Cat"],last_booking:"2024-01-15",pets:["1","2"],email:"alice@example.com",phone:"555-0101",address:"123 Pine St, Colorado Springs, CO"},{id:"2",name:"Bob Wilson",pet_types:["Dog"],last_booking:"2024-02-01",pets:["3"],email:"bob@example.com",phone:"555-0102",address:"456 Oak Ave, Colorado Springs, CO"},{id:"3",name:"Carol Martinez",pet_types:["Cat","Exotic"],last_booking:"2024-01-28",pets:["4","5"],email:"carol@example.com",phone:"555-0103",address:"789 Maple Dr, Colorado Springs, CO"},{id:"4",name:"David Brown",pet_types:["Dog"],last_booking:"2024-02-05",pets:["6"],email:"david@example.com",phone:"555-0104",address:"321 Elm St, Colorado Springs, CO"},{id:"5",name:"Eva Garcia",pet_types:["Exotic"],last_booking:"2024-01-20",pets:["7"],email:"eva@example.com",phone:"555-0105",address:"654 Birch Ln, Colorado Springs, CO"}],me={booking_id:"bk1",status:"Confirmed",owner_name:"matt aertker",professional_name:"matt2 aertker2",service_details:{service_type:"Ferrier"},pets:[{pet_id:3,name:"Jack",species:"DOG",breed:"Golden"}],occurrences:[{occurrence_id:10,start_date:"2025-02-01",end_date:"2025-02-02",start_time:"15:06",end_time:"16:06",calculated_cost:"61.04",base_total:"$26.04",rates:{base_rate:"25.00",additional_animal_rate:"5.00",additional_animal_rate_applies:!1,applies_after:2,unit_of_time:"PER_DAY",holiday_rate:"35.00",holiday_days:0,additional_rates:[{title:"Extra Travel Time Rate",description:"Far Drive rate for service",amount:"$25.00"},{title:"Dog Poops Inside Rate",description:"Dog Poops Inside rate for service",amount:"$5.00"},{title:"Dog Separation rate",description:"When we need to separate the dog from other animals in the house",amount:"$5.00"}]}},{occurrence_id:9,start_date:"2025-03-13",end_date:"2025-03-14",start_time:"09:00",end_time:"14:00",calculated_cost:"120.08",base_total:"$35.04",rates:{base_rate:"29.00",additional_animal_rate:"8.00",additional_animal_rate_applies:!1,applies_after:1,unit_of_time:"PER_DAY",holiday_rate:"40.00",holiday_days:0,additional_rates:[{title:"Extra Travel Time Rate",description:"Far Drive rate for service",amount:"$25.00"},{title:"Dog Poops Inside Rate",description:"Dog Poops Inside rate for service",amount:"$25.00"},{title:"Dog Separation rate",description:"When we need to separate the dog from other animals in the house",amount:"$35.04"}]}}],cost_summary:{subtotal:181.12,platform_fee:18.11,taxes:15.94,total_owner_cost:215.17,total_sitter_payout:163.01,is_prorated:!0}},ge={1234:Object.assign({},me,{id:"1234",ownerName:"John Doe",status:te.CONFIRMED,startDate:"2024-02-20",startTime:"14:00"}),5678:Object.assign({},me,{id:"5678",ownerName:"Margarett Laporte",status:te.CANCELLED,startDate:"2024-02-21",startTime:"15:30"}),56782:Object.assign({},me,{id:"56782",ownerName:"Zoe Aerial",status:te.DENIED,startDate:"2024-02-21",startTime:"15:30"}),5673:Object.assign({},me,{id:"5673",ownerName:"Matt Clark",status:te.PENDING_INITIAL_PROFESSIONAL_CHANGES,startDate:"2024-02-21",startTime:"15:30"}),5674:Object.assign({},me,{id:"5674",ownerName:"Mark Smith",status:te.PENDING_CLIENT_APPROVAL,startDate:"2024-02-21",startTime:"15:30"}),5675:Object.assign({},me,{id:"5675",ownerName:"Lauren Smith",status:te.PENDING_PROFESSIONAL_CHANGES,startDate:"2024-02-21",startTime:"15:30"}),5675:Object.assign({},me,{id:"56712",ownerName:"Matt Smith",status:te.CONFIRMED_PENDING_PROFESSIONAL_CHANGES,startDate:"2024-02-21",startTime:"15:30"}),56713:Object.assign({},me,{id:"567123",ownerName:"Albert Einstein",status:te.PENDING_INITIAL_PROFESSIONAL_CHANGES,startDate:"2025-02-21",startTime:"15:30"}),3749:Object.assign({},me,{id:"567132",ownerName:"Dr. Mike Johnson",status:te.PENDING_INITIAL_PROFESSIONAL_CHANGES,startDate:"2025-02-21",startTime:"15:30"}),91011:Object.assign({},me,{id:"91011",ownerName:"Dr. Bla Johnson",status:te.PENDING_INITIAL_PROFESSIONAL_CHANGES,startDate:"2025-02-21",startTime:"15:30"}),91012:Object.assign({},me,{id:"91012",ownerName:"Dr. Blabla Johnson",status:te.PENDING_INITIAL_PROFESSIONAL_CHANGES,startDate:"2025-02-21",startTime:"15:30"})},he=(Object.values(ge).map((e=>({id:e.id,ownerName:e.ownerName,status:e.status,date:e.startDate,time:e.startTime,serviceType:e.serviceType,numberOfPets:e.numberOfPets||1,totalCost:e.costs?.totalOwnerCost||0,professionalPayout:e.costs?.professionalPayout||0}))),te.CONFIRMED,te.PENDING_CLIENT_APPROVAL,101),fe=[{id:"conv_1",participant1_id:he,participant2_id:202,name:"Dr. Sarah Smith",role_map:{participant1_role:"owner",participant2_role:"professional"},lastMessage:"I'd be happy to help! What kind of pet do you have?",timestamp:"2024-02-21T07:05:00Z",unread:!1},{id:"conv_2",participant1_id:303,participant2_id:he,name:"Dr. Mike Johnson",role_map:{participant1_role:"owner",participant2_role:"professional"},lastMessage:"I'm available! Let's set up a booking",timestamp:"2024-02-21T15:35:00Z",unread:!1},{id:"conv_3",participant1_id:he,participant2_id:204,name:"Dr. Emily Wilson",role_map:{participant1_role:"owner",participant2_role:"professional"},lastMessage:"Your cat's checkup is scheduled",timestamp:"2024-02-20T10:15:00Z",unread:!0},{id:"conv_4",participant1_id:he,participant2_id:205,name:"Dr. James Anderson",role_map:{participant1_role:"owner",participant2_role:"professional"},lastMessage:"See you tomorrow at 2 PM",timestamp:"2024-02-19T16:45:00Z",unread:!1},{id:"conv_5",participant1_id:he,participant2_id:206,name:"Dr. Lisa Brown",role_map:{participant1_role:"owner",participant2_role:"professional"},lastMessage:"How is Max doing today?",timestamp:"2024-02-18T09:30:00Z",unread:!1},{id:"conv_6",participant1_id:he,participant2_id:207,name:"Dr. Robert Taylor",role_map:{participant1_role:"owner",participant2_role:"professional"},lastMessage:"The medication has been prescribed",timestamp:"2024-02-17T14:20:00Z",unread:!1},{id:"conv_7",participant1_id:he,participant2_id:208,name:"Dr. Maria Garcia",role_map:{participant1_role:"owner",participant2_role:"professional"},lastMessage:"Your appointment is confirmed",timestamp:"2024-02-16T11:25:00Z",unread:!0},{id:"conv_8",participant1_id:he,participant2_id:209,name:"Dr. David Lee",role_map:{participant1_role:"owner",participant2_role:"professional"},lastMessage:"Let's schedule a follow-up",timestamp:"2024-02-15T13:40:00Z",unread:!1},{id:"conv_9",participant1_id:he,participant2_id:210,name:"Dr. Sarah Martinez",role_map:{participant1_role:"owner",participant2_role:"professional"},lastMessage:"The test results are ready",timestamp:"2024-02-14T15:55:00Z",unread:!1},{id:"conv_10",participant1_id:he,participant2_id:211,name:"Dr. John White",role_map:{participant1_role:"owner",participant2_role:"professional"},lastMessage:"How's the new diet working?",timestamp:"2024-02-13T08:15:00Z",unread:!1},{id:"conv_11",participant1_id:he,participant2_id:212,name:"Dr. Anna Clark",role_map:{participant1_role:"owner",participant2_role:"professional"},lastMessage:"Vaccination reminder",timestamp:"2024-02-12T10:30:00Z",unread:!0},{id:"conv_12",participant1_id:he,participant2_id:213,name:"Dr. Thomas Wright",role_map:{participant1_role:"owner",participant2_role:"professional"},lastMessage:"Surgery scheduled for next week",timestamp:"2024-02-11T12:45:00Z",unread:!1},{id:"conv_13",participant1_id:he,participant2_id:214,name:"Dr. Patricia Moore",role_map:{participant1_role:"owner",participant2_role:"professional"},lastMessage:"Emergency consultation available",timestamp:"2024-02-10T17:20:00Z",unread:!1},{id:"conv_14",participant1_id:he,participant2_id:215,name:"Dr. Kevin Hall",role_map:{participant1_role:"owner",participant2_role:"professional"},lastMessage:"Treatment plan updated",timestamp:"2024-02-09T14:10:00Z",unread:!1},{id:"conv_15",participant1_id:he,participant2_id:216,name:"Dr. Rachel Green",role_map:{participant1_role:"owner",participant2_role:"professional"},lastMessage:"Prescription ready for pickup",timestamp:"2024-02-08T16:35:00Z",unread:!0}],pe={conv_1:[{message_id:1,participant1_id:he,participant2_id:202,sender:he,role_map:{participant1_role:"owner",participant2_role:"professional"},content:"Hi, I'm interested in your pet sitting services",timestamp:"2024-02-21T14:00:00Z",booking_id:null,status:"read",is_booking_request:!1,metadata:{}},{message_id:2,participant1_id:he,participant2_id:202,sender:202,role_map:{participant1_role:"owner",participant2_role:"professional"},content:"I'd be happy to help! What kind of pet do you have?",timestamp:"2024-02-21T14:05:00Z",booking_id:null,status:"sent",is_booking_request:!1,metadata:{}}],conv_2:[{message_id:3,participant1_id:303,participant2_id:he,sender:303,role_map:{participant1_role:"owner",participant2_role:"professional"},content:"Looking for a dog walker next week",timestamp:"2024-02-21T15:30:00Z",booking_id:null,status:"read",is_booking_request:!1,metadata:{}},{message_id:4,participant1_id:303,participant2_id:he,sender:303,role_map:{participant1_role:"owner",participant2_role:"professional"},type:"booking_request",data:{serviceType:"Dog Walking",pets:[{id:"1",name:"Max",type:"Dog",breed:"Golden Retriever"}],occurrences:[{startDate:"2024-02-28",endDate:"2024-02-28",startTime:"14:00",endTime:"15:00"}]},timestamp:"2024-02-21T15:35:00Z",status:"sent",is_booking_request:!0,metadata:{}},{message_id:5,participant1_id:303,participant2_id:he,sender:he,role_map:{participant1_role:"owner",participant2_role:"professional"},content:"I'll take a look!",timestamp:"2024-02-21T15:30:00Z",booking_id:null,status:"read",is_booking_request:!1,metadata:{}}]},ye=[{id:"blog_1",title:"What Your Dog is Really Saying",author:{id:"author_1",name:"Zoe Neale",profilePicture:o(58162),bio:"Professional dog trainer and animal behavior specialist with over 10 years of experience."},publishDate:"2024-02-22",readTime:"8 min",tags:["Dogs","Behavior","Training","Pet Care"],content:"You know that moment when your dog tilts their head at you like you just asked them to solve a calculus problem? Turns out, they're not the only ones trying to understand you\u2014they've been communicating with you this whole time, and you probably didn't even realize it.\n\nDogs may not speak English (yet\u2014give them time), but they have an entire language built on tail wags, ear positions, and those big, soulful eyes they use to manipulate you into giving them extra treats. Learning to read their body language isn't just a party trick\u2014it can help prevent stress, deepen your bond, and maybe even stop your dog from embarrassing you at the dog park. So, let's finally crack the code on what your dog has been trying to tell you.\n\nTail Wagging: Not Always a Sign of Happiness\nOne of the biggest myths out there is that a wagging tail means a happy dog. Nope. Not always. A dog's tail is basically their mood ring, and the way they wag tells a whole different story.\nLoose, full-body wag (with bonus butt wiggles): This is the classic \"OMG YOU'RE HOME!!\" happy dance. A+ vibes.\nSlow wag, tail held high: The \"I'm analyzing this situation\" wag. Suspicious, calculating, possibly deciding if you're worth their energy.\nStiff, fast wag with a raised tail: Yikes. This is \"I'm on edge, don't mess with me\" energy. Proceed with caution.\nLow, fast wag: \"I'm nervous, and I don't know what's happening, so I'm just gonna keep wiggling and hope for the best.\"\nTucked tail: Fear. If the tail is all the way tucked under, your dog is basically saying, \"I regret everything, please don't yell at me.\"\nEven the direction of the wag matters\u2014researchers found that dogs wag more to the right when they're happy and to the left when they're unsure or stressed (Quaranta et al., 2007). Yes, your dog's tail literally has anxiety tells.\n\nEars and Eyes: The Silent Storytellers\nDogs don't just talk with their tails\u2014they also use their ears and eyes like tiny, furry actors in a silent film.\nSoft eyes, relaxed ears: Your dog is living their best life. No stress, just vibes.\nWide eyes, whites showing (a.k.a. \"whale eye\"): \"I am uncomfortable with the energy we have created in this room.\" This is a warning sign\u2014your dog feels uneasy or trapped.\nPerked-up ears: \"I heard something, and I will investigate.\" Could be excitement, curiosity, or them preparing to bark at absolutely nothing.\nEars pinned back: \"I'm nervous\" or \"I did something bad, and I hope you don't notice.\" Classic guilty dog move.\nEver notice how some dogs do a little squint when they're happy? It's their version of a smile. On the flip side, prolonged direct eye contact\u2014especially with an unfamiliar dog\u2014can be a challenge. So, if you're having a staring contest with a dog you just met\u2026maybe don't.\n\nThe Freeze: When Your Dog Hits Pause (And You Should Pay Attention)\nIf a dog suddenly stops moving and stiffens, pay attention. Freezing is often their last warning before things escalate to growling, snapping, or biting. A lot of people miss this and then wonder why their dog \"suddenly\" lashed out.\nYou might see this when:\nA child is hugging a dog (which, fun fact, most dogs hate).\nSomeone is petting a dog too aggressively.\nThe dog feels cornered and has no escape route.\nResearch by Rooney Clark and Casey (2016) helped show that when a dog freezes, in some way or another they are stressed, its best to give them space in that moment and take a mental note of your newest training goal! Sometimes, they just need a minute to de-escalate, like when you have to breathe through a customer service call that's not going well.\n\nMouth Matters: Smiles vs. Stress\nDogs can technically smile, but it's not always what you think.\nLoose, open mouth, tongue hanging out: Happy, relaxed, living their best life.\nClosed mouth, tight lips: Alert or unsure. They're analyzing the situation.\nLips pulled back, slight teeth showing: Some dogs do a \"submissive grin,\" which isn't aggression\u2014it's their way of saying, \"Hey, I'm friendly!\"\nWrinkled nose, full teeth bared: This is aggression. Back off.\nExcessive yawning in a new situation: Dogs don't just yawn when they're tired\u2014they also yawn when they're stressed. To put it simply, they are overstimulated. (Glenk, 2020) Don't be fooled by the parrot dog, sometimes they yawn because they saw you yawn first! (D'Aniello, 2019)\n\nConclusion: Your Dog Has Been Sending You Texts\u2014Now You Can Finally Read Them\nDogs may not be able to talk (yet), but they've been communicating loud and clear this whole time. That tail wag? Could be excitement, could be stress. That little squint? Doggy love. The full-body freeze? That's a big ol' \"DO NOT DISTURB\" sign.\nThe more you pay attention, the better you'll understand your dog\u2014and the fewer awkward misunderstandings you'll have (like mistaking a stress yawn for a nap cue). As we said in the beginning, your dog already knows exactly how to read you. They know your routine, when you're about to leave the house, and how to guilt-trip you into sharing your snacks. The least you can do is return the favor.\nSo next time your dog gives you the side-eye, perks their ears, or flops over dramatically after a single walk, you'll finally know what they're saying. And let's be honest\u2014it's probably, \"I love you\u2026 now give me a treat.\"",references:[{title:"7 tips for canine body language",authors:"American Society for the Prevention of Cruelty to Animals (ASPCA)",publication:"ASPCApro",url:"https://www.aspcapro.org/resource/7-tips-canine-body-language"},{title:"Therapy dogs' salivary cortisol levels vary during animal-assisted interventions",authors:"Glenk, L. M., Kothgassner, O. D., Stetina, B. U., Palme, R., & Kepplinger, B.",publication:"Frontiers in Veterinary Science",year:2020,doi:"10.3389/fvets.2020.564201"},{title:"The importance of associative learning in cross-species social bonding: Dogs and humans",authors:"D'Aniello, B., Scandurra, A., Alterisio, A., Aria, M., & Siniscalchi, M.",publication:"Frontiers in Psychology",year:2019,doi:"10.3389/fpsyg.2019.01678"},{title:"Oxytocin-gaze positive loop and the coevolution of human-dog bonds",authors:"Nagasawa, M., Mitsui, S., En, S., Ohtani, N., Ohta, M., Sakuma, Y., Onaka, T., Mogi, K., & Kikusui, T.",publication:"Science",year:2015,doi:"10.1126/science.1261022"},{title:"Asymmetric tail-wagging responses by dogs to different emotive stimuli",authors:"Quaranta, A., Siniscalchi, M., & Vallortigara, G.",publication:"Current Biology",year:2007,doi:"10.1016/j.cub.2007.02.008"},{title:"Minimizing fear and anxiety in working dogs: A review",authors:"Rooney, N. J., Clark, C. C. A., & Casey, R. A.",publication:"Journal of Veterinary Behavior",year:2016,doi:"10.1016/j.jveb.2016.11.001"}],likes:245,comments:56,shares:89},{id:"blog_2",title:"What Your Cat is Really Saying",author:{id:"author_2",name:"Zoe Neale",profilePicture:o(58162),bio:"Feline behavior specialist and veterinarian with a focus on cat-human relationships."},publishDate:"2024-02-23",readTime:"7 min",tags:["Cats","Behavior","Pet Care","Communication"],content:"Ever wonder why your cat stares at you before slowly blinking or why they randomly sprint across the house at 2 AM? While cats may seem mysterious, they actually have a complex system of communication\u2014if you know what to look for. Unlike dogs, who wear their emotions on their tails (literally), cats are more subtle. But once you learn their signals, you'll start to see what your cat has been trying to tell you all along.\n\nThe Myth of the Aloof Cat: Do They Actually Care About You?\nMany people think cats are independent and don't bond with their owners the way dogs do. But research suggests otherwise. A study by Vitale et al. (2019) found that cats form secure attachments to their owners, much like infants do with their caregivers. In an experiment where cats were briefly separated from their owners, many showed signs of distress when left alone and relief upon their owner's return. So yes, your cat does care about you\u2014they just have their own way of showing it.\n\nThe Slow Blink: A Feline \"I Love You\"\nOne of the best-kept secrets of cat communication is the slow blink. If your cat locks eyes with you and then slowly closes and opens their eyes, congratulations! You've just received a cat's version of a smile. Research completed in 2020 (Humphrey) found that when humans slowly blink at their cats, the cats are more likely to return the gesture and approach them in a friendly manner. So, next time you want to say \"I love you\" to your cat, skip the baby talk and try a slow blink instead.\n\nTail Talk: Not Just for Dogs\nA cat's tail is like a built-in mood ring. Learning to read tail signals can help you avoid scratches and strengthen your bond.\nTail up, tip curved: A friendly, confident cat greeting. If your cat walks toward you with their tail high, they're happy to see you.\nPuffed-up tail: This is a defensive reaction. Your cat is startled or feels threatened.\nLow, slow-wagging tail: Unlike dogs, a slow-wagging cat tail isn't a good sign\u2014it often signals irritation or mild aggression.\nTail wrapped around you or another cat: This is a sign of affection, almost like holding hands.\n\nPurring: More Than Just Happiness\nEveryone loves the soothing sound of a purring cat, but did you know cats don't just purr when they're happy? While contentment is a common reason, studies suggest cats also purr when they're stressed, in pain, or even trying to heal themselves. The frequency of cat purrs (between 25 and 150 Hz) has been linked to tissue regeneration and bone healing in studies on vibrational therapy (Muggenthaler, 2001). So, if your cat is purring at the vet's office, they may not be enjoying themselves\u2014they might just be self-soothing.\n\nHeadbutting and Kneading: Strange but Sweet Gestures\nHeadbutting (bunting): When your cat gently bumps their head against you, they're not just being cute\u2014they're marking you with their scent glands, claiming you as their own (Rodan, 2015).\nKneading: The rhythmic pressing of paws against a soft surface (or your lap) is a behavior kittens use to stimulate milk flow. In adult cats, it's a sign of comfort and contentment (Brown & Bradshaw, 2016).\n\nDo Cats Really Ignore Their Names?\nIf you've ever called your cat and been met with a flick of the ear but no movement, you might think they don't recognize their name. But research says otherwise. A study by Saito & Shinozuka (2013) found that cats can distinguish their names from other words, even in a household with multiple cats. They just don't always feel the need to respond. Unlike dogs, who evolved to seek human approval, cats evolved as solitary hunters. They hear you\u2014they're just deciding whether you're worth getting up for.\n\nThe Zoomies: Science Behind the 2 AM Sprints\nThose sudden, chaotic bursts of energy\u2014also known as \"zoomies\"\u2014are actually a by normal part of feline behavior. Cats are natural hunters, and their instincts tell them to be most active at dawn and dusk. If your cat has zoomies at odd hours, they might just be burning off excess energy. Providing interactive play during the day can help prevent nighttime sprints (Turner, 2021).\n\nConclusion: The More You Watch, the More You Understand\nCats may seem mysterious, but once you learn their language, they're basically tiny, furry drama queens with very specific ways of expressing love (and judgment). That slow blink? A kiss. That tail flick? A warning. The 2 AM zoomies? Either pent-up energy or an exorcism\u2014we may never know.\n\nThe more you pay attention to their signals, the better you'll understand them. And honestly your cat already understands you. They know exactly how to guilt-trip you into giving extra treats, how to wake you up precisely one minute before your alarm, and how to act like they don't care\u2014right before curling up in your lap.\n\nAt the end of the day, cats aren't ignoring us. They're just selectively participating. And now that you can read their signals, you're officially part of their very exclusive club.",references:[{title:"Communication in the domestic cat: within- and between-species",authors:"Brown, S. L., & Bradshaw, J. W. S.",publication:"Animal Behaviour",year:2016,doi:"10.1016/j.anbehav.2016.05.015"},{title:"Feline Behavioral Health and Welfare",authors:"Rodan, I., & Heath, S.",publication:"Elsevier Health Sciences",year:2015},{title:"The felid purr: A healing mechanism?",authors:"Muggenthaler, E. von.",publication:"Proceedings of the 12th International Conference on Low Frequency Noise and Vibration",year:2001,url:"https://www.researchgate.net/publication/272259095_The_felid_purr_A_healing_mechanism"},{title:"Vocal recognition of owners by domestic cats (Felis catus)",authors:"Saito, A., & Shinozuka, K.",publication:"Animal Cognition",year:2013,doi:"10.1007/s10071-013-0620-4"},{title:"The mechanics of social interactions between cats and their owners",authors:"Turner, D. C.",publication:"Frontiers in Veterinary Science",year:2021,doi:"10.3389/fvets.2021.650143"},{title:"Attachment bonds between domestic cats and humans",authors:"Vitale, K. R., Behnke, A. C., & Udell, M. A. R.",publication:"Current Biology",year:2019,doi:"10.1016/j.cub.2019.08.036"},{title:"The role of cat eye narrowing movements in cat\u2013human communication",authors:"Humphrey, T., Proops, L., & McComb, K.",publication:"Scientific Reports",year:2020,doi:"10.1038/s41598-020-73426-0"}],likes:312,comments:78,shares:102},{id:"blog_3",title:"What Your Bird is Really Saying",author:{id:"author_3",name:"Zoe Neale",profilePicture:o(58162),bio:"Avian specialist and researcher focusing on bird behavior and communication."},publishDate:"2024-02-24",readTime:"6 min",tags:["Birds","Behavior","Pet Care","Avian Communication"],content:"Ever look at your bird and think, What's going on in that tiny dinosaur brain of yours? Well, good news\u2014birds may not text, but they do have an entire language made up of wing flutters, tail flicks, and the occasional judgmental stare. And if you learn to read these signals, you'll finally understand what your feathered friend has been trying to tell you all along.\n\nLet's break down the mysterious world of bird body language so you can stop guessing and start actually communicating with your avian BFF.\n\nThe Head Tilt: Curious or Plotting Something?\nThat adorable head tilt your bird does isn't just to make you go aww\u2014it's actually their way of getting a better look at something. Birds process images differently than we do, so when they tilt their head, they're adjusting their angle to see more clearly (Massen et al., 2014).\n\nSlow, curious head tilt: They're interested in what's happening and trying to analyze the situation. Basically, they're bird detectives.\nFrequent or extreme tilting: Could indicate a vision issue or neurological problem\u2014if it looks excessive, a vet visit is a good idea (Massen et al., 2014).\nOne-eye stare, body stiffened: A sign they're feeling cautious or potentially threatened. If they were a human, this would be the equivalent of side-eye.\n\nFeather Fluffing: Cozy or Cranky?\nFeather movements say a lot about how a bird is feeling. Think of them as mood indicators, kind of like how we use facial expressions\u2014except, you know, with more feathers.\n\nFluffed-up feathers for a few seconds: Just getting comfortable. If your bird puffs up and then smooths back down, they're basically stretching.\nConstantly fluffed-up feathers: Not good. This can be a sign of illness, stress, or even feeling cold (Massen et al., 2014).\nFeathers sleeked back tight to the body: Your bird is nervous or possibly feeling aggressive. Approach with caution (Pika & Bugnyar, 2011).\n\nThe Wing Flutter: Excitement or Back Off?\nBirds use their wings for way more than just flying\u2014they also use them to communicate. Unfortunately, no sign language because birds dont have thumbs\n\nExcited, quick flutters: Happiness! Your bird is basically doing a little happy dance (Osaka University, 2023).\nSlow, controlled wing movements: This can be a \"stay away\" signal, kind of like putting up a hand to say \"not now.\"\nOne wing slightly drooped: Could be a sign of injury\u2014time to check in with your vet.\n\nBunting: Love, Not a Headbutt Attack\nIf your bird presses or rubs their beak against you, congratulations\u2014they're bunting, which is a sign of affection (Pika & Bugnyar, 2011).\n\nGentle beak rubbing: They're marking you as part of their flock. You're officially theirs now.\nAggressive, sudden beak nudging: Might mean \"Hey, stop that\" or \"Give me attention NOW.\"\n\nThe Stare-Down: Challenge or Trust?\nUnlike with dogs, where prolonged eye contact can be a dominance move, birds love staring at their favorite humans. It's actually a good thing\u2014eye contact helps strengthen bonds (Osaka University, 2023).\n\nSoft, relaxed eyes: A sign of trust and comfort. They're chilling.\nWide eyes with pinning pupils: Intense excitement\u2014or potential aggression. If they suddenly go from relaxed to laser-focused, read the room.\n\nTail Wagging: A Whole Different Story Than Dogs\nIf you thought tail wagging only meant happiness (like with dogs), think again\u2014birds have their own unique tail signals.\n\nFast, side-to-side tail wagging: Happy and excited! Your bird is feeling good.\nSlow, deliberate tail flick: Annoyed or getting ready to give you a warning. Think of this as their way of saying \"I'm this close to losing it.\"\nTail fanned out: Displaying dominance or excitement\u2014this is common in birds like parrots when they're trying to show off.\n\nThe Playful Side: Hanging Upside Down & Wing Spreading\nSome birds (especially parrots) love hanging upside down like little acrobats. This is usually a sign of happiness and playfulness. If your bird does this often, they're feeling safe and confident.\n\nUpside-down hanging: Your bird is comfortable with you and their surroundings. They trust you.\nOne wing slightly lifted while playing: This can be an invitation to interact\u2014kind of like a bird's version of waving at you.\n\nConclusion: Your Bird Has Been Speaking\u2014Now You're Fluent\nBirds may not use words the way we do (unless you have a talkative parrot), but their body language speaks volumes. From fluffed feathers to head tilts and beak bunts, every little movement is a clue to how they're feeling.\n\nThe more you watch and learn, the better you'll understand their unique way of communicating. And let's be real\u2014your bird already knows exactly how to get your attention. Whether it's staring at you until you feel guilty enough to offer a treat or flapping their wings dramatically for no reason, they've got you trained.\n\nNow that you can finally read their signals, you're one step closer to becoming the ultimate bird whisperer. Just don't be surprised if they start giving you even more attitude now that you know what's up.",references:[{title:"Facial display and blushing: Means of visual communication in blue-and-yellow macaws",authors:"Massen, J. J. M., Vermunt, D. A., & Sterck, E. H. M.",publication:"PLoS ONE",year:2014,doi:"10.1371/journal.pone.0108794"},{title:"The use of referential gestures in ravens (Corvus corax) in the wild",authors:"Pika, S., & Bugnyar, T.",publication:"Nature Communications",year:2011,doi:"10.1038/ncomms1567"},{title:'Wild birds gesture "after you" to insist their mate go first',authors:"Osaka University",publication:"Scientific American",year:2023,url:"https://www.scientificamerican.com/article/wild-birds-gesture-after-you-to-insist-their-mate-go-first/"}],likes:198,comments:45,shares:67}],{width:be,height:xe}=v.default.get("window"),je=[{image:o(81029),text:'"CrittrCove has been amazing for finding reliable pet professionals!',author:"John Smith"},{image:o(53198),text:'"Great experience with pet sitting services!',author:"Jane Doe"},{image:o(52695),text:'"Found the perfect sitter for my exotic pets!',author:"Sudhakar Vuluvala"},{image:o(30552),text:"\"I've had a fantastic experience with CrittrCove's pet grooming services!",author:"Alice Brown"}],we=({source:e,style:t})=>"web"===n.default.OS?(0,T.jsx)("img",{src:e,style:t,alt:""}):(0,T.jsx)(U.default,{source:e,style:t});const Ce=l.default.create({scrollView:{flex:1},contentContainer:{paddingBottom:80},heroSection:{height:"web"===n.default.OS?"70vh":.5*xe,justifyContent:"center",alignItems:"center",overflow:"hidden"},heroImage:{width:"100%",height:"100%",position:"absolute"},heroText:{fontSize:32,fontWeight:"bold",fontFamily:f.theme.fonts.header.fontFamily,textAlign:"center",color:"white",textShadowColor:"rgba(0, 0, 0, 0.75)",textShadowOffset:{width:-1,height:1},textShadowRadius:10},section:{padding:20,width:"100%",maxWidth:1200,marginLeft:"auto",marginRight:"auto",alignItems:"center"},sectionTitle:{fontSize:f.theme.fontSizes.largeLarge,fontWeight:"bold",fontFamily:f.theme.fonts.header.fontFamily,marginBottom:10,textAlign:"center",color:"black"},card:{marginBottom:10},appButtons:{flexDirection:"row",justifyContent:"space-around",marginTop:10},appButton:{width:"45%"},reviewsSection:{marginBottom:20},reviewsBackground:{flex:1,justifyContent:"center",alignItems:"center"},reviewsOverlay:{flex:1,justifyContent:"center",alignItems:"center",padding:20},reviewsSubtitle:{fontSize:f.theme.fontSizes.mediumLarge,fontWeight:"bold",color:"black",marginBottom:10,textAlign:"center",width:"100%"},reviewsTitle:{fontSize:f.theme.fontSizes.largeLarge,fontFamily:f.theme.fonts.header.fontFamily,fontWeight:"bold",color:"black",marginBottom:20,textAlign:"center",width:"100%"},reviewsContainer:{width:"100%",maxWidth:1200,marginLeft:"auto",marginRight:"auto",overflowX:"auto",WebkitOverflowScrolling:"touch",msOverflowStyle:"auto",scrollbarWidth:"auto",scrollbarColor:"".concat(f.theme.colors.primary," transparent")},reviewsContent:{flexDirection:"row",minWidth:"min-content",gap:10,padding:20,paddingBottom:40,justifyContent:"center",alignItems:"center"},reviewCard:{width:300,height:200,padding:20,backgroundColor:"white",borderRadius:10,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3,marginRight:10},reviewCardMobile:{width:"100%",height:"100%"},reviewQuote:{fontSize:24,fontWeight:"bold",color:"black",marginBottom:10},reviewText:{fontSize:18,color:"black",fontFamily:f.theme.fonts.regular.fontFamily,marginBottom:15,flex:1},reviewAuthorContainer:{flexDirection:"row",alignItems:"center"},reviewerImage:{width:45,height:60,borderRadius:8,marginRight:10,objectFit:"cover"},reviewAuthorName:{fontSize:16,fontWeight:"bold",color:"black",fontFamily:f.theme.fonts.regular.fontFamily},reviewAuthorTitle:{fontSize:14,color:"#666",fontFamily:f.theme.fonts.regular.fontFamily,marginTop:2},paginationDots:{flexDirection:"row",justifyContent:"center",marginTop:10},paginationDot:{width:10,height:10,borderRadius:5,backgroundColor:"white",margin:5},paginationDotActive:{backgroundColor:"black"},featuresSection:{marginBottom:80,marginTop:20},toggleContainer:{flexDirection:"row",justifyContent:"center",marginBottom:10},toggleButton:{padding:10,backgroundColor:"white",borderWidth:2,borderColor:f.theme.colors.primary},toggleButtonActive:{backgroundColor:f.theme.colors.primary},toggleButtonText:{fontSize:18,fontWeight:"bold",fontFamily:f.theme.fonts.regular.fontFamily},toggleButtonTextActive:{color:f.theme.colors.whiteText,fontFamily:f.theme.fonts.regular.fontFamily},featuresContainer:{flexDirection:"row",justifyContent:"center",alignItems:"center"},featureColumn:{width:p.SCREEN_WIDTH<768?"90%":"100%",maxWidth:600,padding:20,backgroundColor:"white",borderRadius:10,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3},columnTitle:{fontSize:24,fontWeight:"bold",marginBottom:20,color:"black",textAlign:"center",fontFamily:f.theme.fonts.header.fontFamily},featuresList:{width:"100%",fontFamily:f.theme.fonts.header.fontFamily,marginBottom:20},featureItem:{flexDirection:"row",marginBottom:20,alignItems:"flex-start",width:"100%"},featureIconCircle:{width:50,height:50,borderRadius:25,justifyContent:"center",alignItems:"center",marginTop:5},featureIcon:{fontSize:40},featureTitle:{fontSize:f.theme.fontSizes.mediumLarge,fontWeight:"bold",marginBottom:5,color:"black",fontFamily:f.theme.fonts.header.fontFamily},featureText:{fontSize:f.theme.fontSizes.mediumLarge+2,color:"black",lineHeight:22,fontFamily:f.theme.fonts.regular.fontFamily},actionButton:{backgroundColor:"#6A6C51",width:"50%",padding:5,borderRadius:5,alignItems:"center"},buttonContainer:{display:"flex",justifyContent:"center",alignItems:"center"},buttonText:{fontSize:18,fontWeight:"bold",color:"white",fontFamily:f.theme.fonts.regular.fontFamily},blogSection:{marginBottom:20,alignItems:"center"},blogCard:{width:300,backgroundColor:"white",borderRadius:10,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3,padding:15,marginRight:10},authorContainer:{flexDirection:"column"},authorImage:{width:40,height:40,borderRadius:20,marginBottom:10},blogContent:{flex:1},title:{fontSize:18,fontWeight:"bold",marginBottom:8,fontFamily:f.theme.fonts.header.fontFamily},authorInfo:{flexDirection:"row",alignItems:"center",marginBottom:8},authorName:{fontSize:16,fontWeight:"500",fontFamily:f.theme.fonts.regular.fontFamily},dot:{marginHorizontal:4,color:"#666"},readTime:{fontSize:16,color:"#666",fontFamily:f.theme.fonts.regular.fontFamily},preview:{fontSize:16,lineHeight:20,marginBottom:12,color:"#444",fontFamily:f.theme.fonts.regular.fontFamily},tags:{flexDirection:"row",flexWrap:"wrap",marginBottom:12},tag:{paddingHorizontal:8,paddingVertical:4,borderRadius:16,marginRight:8,marginBottom:8},tagText:{fontSize:14,fontWeight:"500",fontFamily:f.theme.fonts.regular.fontFamily},stats:{flexDirection:"row",justifyContent:"flex-start",marginTop:8},stat:{flexDirection:"row",alignItems:"center",marginRight:16},statText:{marginLeft:4,fontSize:14,color:"#666",fontFamily:f.theme.fonts.regular.fontFamily},roadmapSection:{marginBottom:20},roadmapImage:{flex:1,justifyContent:"center",alignItems:"center"},roadmapOverlayText:{fontSize:24,fontWeight:"bold",color:"black"},faqSection:{marginBottom:20},faqItem:{marginBottom:10},faqButton:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"},faqQuestion:{fontSize:16,fontWeight:"bold"},faqToggle:{fontSize:14,color:"gray"},faqAnswer:{fontSize:16},contactSection:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",padding:20},contactContainer:{width:"100%",maxWidth:600},input:{padding:10,marginBottom:10,borderWidth:1,borderColor:"gray",borderRadius:5},footer:{padding:20,backgroundColor:f.theme.colors.primary,alignItems:"center"},socialIconsRow:{flexDirection:"row",justifyContent:"center",marginBottom:15},socialIcon:{marginHorizontal:15,padding:5},footerLinksRow:{flexDirection:"row",justifyContent:"center",flexWrap:"wrap"},footerLink:{color:"white",fontFamily:f.theme.fonts.regular.fontFamily,marginHorizontal:15,textDecorationLine:"underline"},successMessage:{fontSize:18,textAlign:"center",marginTop:10,color:"black",fontFamily:f.theme.fonts.regular.fontFamily},messageInput:{height:100,textAlignVertical:"top",paddingTop:10},disabledButton:{opacity:.7},validationError:{color:"red",fontSize:16,marginTop:-5,marginBottom:10,fontFamily:f.theme.fonts.regular.fontFamily},starsContainer:{flexDirection:"row",alignItems:"center",marginTop:4},starIcon:{marginRight:2},waitlistSection:{marginVertical:20,borderRadius:10},waitlistDescription:{fontSize:18,textAlign:"center",marginBottom:20,color:"black",fontFamily:f.theme.fonts.regular.fontFamily,paddingHorizontal:20,lineHeight:24},waitlistButton:{marginTop:10,width:"80%",maxWidth:300,padding:15},scrollIndicators:{flexDirection:"row",justifyContent:"center",alignItems:"center",marginTop:10,marginBottom:20},scrollIndicatorButton:{padding:10,marginHorizontal:-6},scrollIndicator:{width:8,height:8,borderRadius:4,backgroundColor:f.theme.colors.border,marginHorizontal:4},scrollIndicatorActive:{backgroundColor:f.theme.colors.primary,width:24},scrollHint:{flexDirection:"row",alignItems:"center",justifyContent:"center",paddingVertical:10},scrollHintText:{color:f.theme.colors.primary,marginRight:5,fontSize:f.theme.fontSizes.medium,fontFamily:f.theme.fonts.regular.fontFamily},scrollContainer:{width:"100%",maxWidth:1200,marginLeft:"auto",marginRight:"auto",overflowX:"auto",WebkitOverflowScrolling:"touch",msOverflowStyle:"auto",scrollbarWidth:"auto",scrollbarColor:"".concat(f.theme.colors.primary," transparent")},scrollContent:{flexDirection:"row",minWidth:"min-content",gap:10,padding:20,paddingBottom:40,justifyContent:"center",alignItems:"center"},serviceHighlightsSection:{padding:20,width:"100%",maxWidth:1200,marginLeft:"auto",marginRight:"auto",alignItems:"center"},mainServiceTitle:{fontSize:32,fontWeight:"bold",textAlign:"center",marginBottom:40,color:f.theme.colors.text,fontFamily:f.theme.fonts.header.fontFamily},servicesGrid:{flexWrap:"wrap",justifyContent:"center",gap:20,width:"100%"}});var ve=o(40558),Se=o(4701),Te=o(21815),Be=o(51690),ke=o(61092),_e=o(47514),Ae=o(42490),Ie=o(27339),De=o(29299),Me=o(31385),Re=o(63303),Pe=o(49050);const ze=l.default.create({container:{flex:1,backgroundColor:f.theme.colors.background,paddingTop:"android"===n.default.OS?Te.default.currentHeight:0},scrollViewContent:{flexGrow:1,paddingBottom:"web"===n.default.OS?16:80},content:{alignSelf:"center",maxWidth:800,paddingTop:16},switchProfileButton:{alignSelf:"flex-end",marginBottom:16},profileHeader:{alignItems:"center",marginBottom:20},sectionSaveButton:{marginTop:16},name:{fontSize:24,fontWeight:"bold",marginTop:10,color:f.theme.colors.primary},location:{fontSize:16,color:f.theme.colors.secondary},section:{padding:20,borderBottomWidth:1,borderBottomColor:f.theme.colors.border},sectionTitle:{fontSize:20,fontWeight:"bold",marginBottom:10,color:f.theme.colors.primary},input:{marginBottom:10,backgroundColor:f.theme.colors.surface},bioInput:{backgroundColor:f.theme.colors.surface},petItem:{marginBottom:10,padding:10,backgroundColor:f.theme.colors.surface,borderRadius:5},petName:{fontSize:16,fontWeight:"bold"},petInfo:{flex:1},petDetails:{fontSize:14,color:f.theme.colors.placeholder,flexWrap:"wrap"},saveButton:{margin:20},addButton:{marginTop:10},profilePhoto:{width:120,height:120,borderRadius:60},profilePhotoPlaceholder:{backgroundColor:f.theme.colors.surface,justifyContent:"center",alignItems:"center"},centered:{justifyContent:"center",alignItems:"center"},sectionHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:10},fieldText:{fontSize:16,marginBottom:5,color:f.theme.colors.text},iconContainer:{flexDirection:"row"},petItemContent:{flexDirection:"row",alignItems:"center"},petPhoto:{width:50,height:50,borderRadius:25,marginRight:10},modalContainer:{backgroundColor:"white",padding:20,margin:20,borderRadius:10},modalContent:{alignItems:"center"},modalTitle:{fontSize:18,fontWeight:"bold",marginBottom:10},modalText:{marginBottom:20,textAlign:"center"},webPopup:{position:"absolute",backgroundColor:"white",padding:20,borderRadius:10,width:300,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:3.84,elevation:5,zIndex:1e3},webPopupTitle:{fontSize:18,fontWeight:"bold",marginBottom:10},webPopupText:{marginBottom:20},profileInfo:{alignItems:"center"},name:{fontSize:24,fontWeight:"bold",marginBottom:5},location:{fontSize:16,color:f.theme.colors.secondary},header:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",padding:16,borderBottomWidth:1,borderBottomColor:f.theme.colors.border,backgroundColor:f.theme.colors.background},headerLeft:{flexDirection:"row",alignItems:"center"},backButton:{marginRight:16},headerText:{fontSize:20,fontWeight:"bold",color:f.theme.colors.primary},switchProfileButton:{backgroundColor:f.theme.colors.primary}}),Fe=()=>{const e=(0,j.useNavigation)(),{width:t}=(0,ve.default)(),[o,i]=(0,a.useState)(null),[l,d]=(0,a.useState)(""),[c,u]=(0,a.useState)(""),[m,g]=(0,a.useState)(""),[h,y]=(0,a.useState)(""),[b,w]=(0,a.useState)(""),[C,v]=(0,a.useState)(""),[B,k]=(0,a.useState)(""),[_,A]=(0,a.useState)(""),[I,D]=(0,a.useState)(""),[M,R]=(0,a.useState)(""),[P,z]=(0,a.useState)([]),[F,L]=(0,a.useState)({name:"",phone:""}),[O,E]=(0,a.useState)([""]),[W,N]=(0,a.useState)(!0),[V,q]=(0,a.useState)({}),[G,J]=(0,a.useState)(!1),[$,Z]=(0,a.useState)({top:0,left:0}),K=(0,a.useRef)(null),Q=(0,a.useRef)(null),{isApprovedProfessional:X,switchRole:ee}=(0,a.useContext)(p.AuthContext),[te,oe]=(0,a.useState)(!1);(0,a.useEffect)((()=>{new Promise((e=>{setTimeout((()=>{e({name:"Alice Johnson",email:"alice@example.com",phone:"(555) 123-4567",age:"32",address:"123 Main St",city:"San Francisco",state:"CA",zip:"94122",country:"USA",bio:"I'm a proud pet parent of two dogs and a cat. I love animals and am always looking for the best care for my furry friends!",pets:[{id:"1",name:"Max",type:"Dog",breed:"Golden Retriever",age:5,photo:"https://example.com/max.jpg"},{id:"2",name:"Luna",type:"Cat",breed:"Siamese",age:3,photo:"https://example.com/luna.jpg"},{id:"3",name:"Rocky",type:"Dog",breed:"Beagle",age:2,photo:"https://example.com/rocky.jpg"}],emergencyContact:{name:"John Smith",phone:"(555) 987-6543"},authorizedHouseholdMembers:["Sarah Johnson","Mike Johnson"]})}),1e3)})).then((e=>{d(e.name),u(e.email),g(e.phone),y(e.age),w(e.address),v(e.city),k(e.state),A(e.zip),D(e.country),R(e.bio),z(e.pets),L(e.emergencyContact),E(e.authorizedHouseholdMembers),N(!1)}))}),[]),(0,a.useEffect)((()=>{(async()=>{const e=await x.default.getItem("isApprovedProfessional");oe(JSON.parse(e))})()}),[]);const ae=e=>{q((t=>Object.assign({},t,{[e]:!t[e]})))},ne=(e,t,o,a)=>V[a]?(0,T.jsx)(ke.default,{label:e,value:t,onChangeText:o,style:ze.input}):(0,T.jsxs)(Y.default,{style:ze.fieldText,children:[e,": ",t]}),re=(e,t,o,a)=>(0,T.jsx)(s.default,{onPress:a,children:(0,T.jsx)(Me.default,{name:e,size:t,color:o})}),ie=("ios"===n.default.OS?Se.default:r.default,e=>V[e]?(0,T.jsxs)(_e.default,{mode:"contained",onPress:()=>(e=>{console.log("Saving ".concat(e," section")),Be.default.alert("Success","".concat(e," information saved successfully!")),ae(e)})(e),style:ze.sectionSaveButton,children:["Save ",e]}):null);if(W)return(0,T.jsx)(r.default,{style:[ze.container,ze.centered],children:(0,T.jsx)(Y.default,{children:"Loading..."})});const se=X||te;return(0,T.jsxs)(Se.default,{style:ze.container,children:[(0,T.jsxs)(r.default,{style:ze.header,children:[(0,T.jsxs)(r.default,{style:ze.headerLeft,children:[(0,T.jsx)(s.default,{onPress:()=>e.navigate("More"),style:ze.backButton,children:(0,T.jsx)(Me.default,{name:"chevron-back",size:24,color:f.theme.colors.primary})}),(0,T.jsx)(Y.default,{style:ze.headerText,children:"Owner Profile"})]}),se&&(0,T.jsx)(_e.default,{mode:"contained",onPress:()=>{ee(),e.navigate("ProfessionalProfile")},style:ze.switchProfileButton,children:"Switch to Professional"})]}),(0,T.jsx)(H.default,{ref:Q,contentContainerStyle:ze.scrollViewContent,children:(0,T.jsxs)(r.default,{style:[ze.content,{width:"web"===n.default.OS?t<600?"90%":"60%":"90%"}],children:[(0,T.jsxs)(r.default,{style:ze.profileHeader,children:[(0,T.jsx)(s.default,{onPress:async()=>{let e=await Re.launchImageLibraryAsync({mediaTypes:Pe.MediaTypeOptions.Images,allowsEditing:!0,aspect:[1,1],quality:1});e.canceled||i(e.assets[0].uri)},children:o?(0,T.jsx)(U.default,{source:{uri:o},style:ze.profilePhoto}):(0,T.jsx)(r.default,{style:[ze.profilePhoto,ze.profilePhotoPlaceholder],children:(0,T.jsx)(S.default,{name:"account",size:80,color:f.theme.colors.primary})})}),(0,T.jsxs)(r.default,{style:ze.profileInfo,children:[(0,T.jsx)(Y.default,{style:ze.name,children:l}),(0,T.jsxs)(Y.default,{style:ze.location,children:[C,", ",B]})]})]}),(0,T.jsxs)(r.default,{style:ze.section,children:[(0,T.jsxs)(r.default,{style:ze.sectionHeader,children:[(0,T.jsx)(Y.default,{style:ze.sectionTitle,children:"Personal Information"}),re("pencil",20,f.theme.colors.primary,(()=>ae("personal")))]}),ne("Name",l,d,"personal"),ne("Email",c,u,"personal"),ne("Phone",m,g,"personal"),ne("Age",h,y,"personal"),ie("personal")]}),(0,T.jsxs)(r.default,{style:ze.section,children:[(0,T.jsxs)(r.default,{style:ze.sectionHeader,children:[(0,T.jsx)(Y.default,{style:ze.sectionTitle,children:"Address"}),re("pencil",20,f.theme.colors.primary,(()=>ae("address")))]}),ne("Address",b,w,"address"),ne("City",C,v,"address"),ne("State",B,k,"address"),ne("ZIP",_,A,"address"),ne("Country",I,D,"address"),ie("address")]}),(0,T.jsxs)(r.default,{style:ze.section,children:[(0,T.jsxs)(r.default,{style:ze.sectionHeader,children:[(0,T.jsx)(Y.default,{style:ze.sectionTitle,children:"About Me"}),re("pencil",20,f.theme.colors.primary,(()=>ae("bio")))]}),V.bio?(0,T.jsx)(ke.default,{multiline:!0,numberOfLines:4,value:M,onChangeText:R,style:ze.bioInput}):(0,T.jsx)(Y.default,{style:ze.fieldText,children:M}),ie("bio")]}),(0,T.jsxs)(r.default,{style:ze.section,children:[(0,T.jsx)(s.default,{onPress:()=>e.navigate("MyPets"),children:(0,T.jsx)(Y.default,{style:ze.sectionTitle,children:"My Pets"})}),P.map((t=>(0,T.jsx)(s.default,{style:ze.petItem,onPress:()=>e.navigate("PetProfile",{petId:t.id}),children:(0,T.jsxs)(r.default,{style:ze.petItemContent,children:[(0,T.jsx)(U.default,{source:{uri:t.photo},style:ze.petPhoto}),(0,T.jsxs)(r.default,{style:ze.petInfo,children:[(0,T.jsx)(Y.default,{style:ze.petName,children:t.name}),(0,T.jsxs)(Y.default,{style:ze.petDetails,children:[t.type," \u2022 ",t.breed," \u2022 ",t.age," years old"]})]})]})},t.id)))]}),(0,T.jsxs)(r.default,{style:ze.section,children:[(0,T.jsxs)(r.default,{style:ze.sectionHeader,children:[(0,T.jsx)(Y.default,{style:ze.sectionTitle,children:"Emergency Contact"}),re("pencil",20,f.theme.colors.primary,(()=>ae("emergency")))]}),ne("Name",F.name,(e=>L(Object.assign({},F,{name:e}))),"emergency"),ne("Phone",F.phone,(e=>L(Object.assign({},F,{phone:e}))),"emergency"),ie("emergency")]}),(0,T.jsxs)(r.default,{style:ze.section,children:[(0,T.jsxs)(r.default,{style:ze.sectionHeader,children:[(0,T.jsx)(Y.default,{style:ze.sectionTitle,children:"Authorized Household Members"}),(0,T.jsxs)(r.default,{style:ze.iconContainer,children:[(0,T.jsx)(s.default,{onPress:()=>{"web"===n.default.OS?K.current&&Q.current&&K.current.measure(((e,t,o,a,n,r)=>{Q.current.measure(((e,t,a,i,s,l)=>{Z({top:r-l-200,left:n-s-(300-o)/2}),J(!0)}))})):J(!0)},ref:K,children:(0,T.jsx)(Me.default,{name:"help-circle-outline",size:20,color:f.theme.colors.primary})}),re("pencil",20,f.theme.colors.primary,(()=>ae("household")))]})]}),O.map(((e,t)=>V.household?(0,T.jsx)(ke.default,{label:"Member ".concat(t+1),value:e,onChangeText:e=>((e,t)=>{if(V.household){const o=[...O];o[e]=t,E(o)}})(t,e),style:ze.input},t):(0,T.jsx)(Y.default,{style:ze.fieldText,children:e},t))),V.household&&(0,T.jsx)(_e.default,{mode:"outlined",onPress:()=>{V.household&&E([...O,""])},style:ze.addButton,children:"Add Household Member"}),ie("household")]})]})}),(0,T.jsx)(Ae.default,{children:"web"===n.default.OS?G&&(0,T.jsxs)(r.default,{style:[ze.webPopup,{top:$.top,left:$.left}],children:[(0,T.jsx)(Y.default,{style:ze.webPopupTitle,children:"Authorized Household Members"}),(0,T.jsx)(Y.default,{style:ze.webPopupText,children:"Authorized household members are individuals who are allowed to make decisions about your pets in your absence. This may include family members, roommates, or trusted friends who have access to your home and can care for your pets if needed."}),(0,T.jsx)(_e.default,{onPress:()=>J(!1),children:"Got it"})]}):(0,T.jsxs)(Ie.default,{visible:G,onDismiss:()=>J(!1),children:[(0,T.jsx)(Ie.default.Title,{children:"Authorized Household Members"}),(0,T.jsx)(Ie.default.Content,{children:(0,T.jsx)(De.default,{children:"Authorized household members are individuals who are allowed to make decisions about your pets in your absence. This may include family members, roommates, or trusted friends who have access to your home and can care for your pets if needed."})}),(0,T.jsx)(Ie.default.Actions,{children:(0,T.jsx)(_e.default,{onPress:()=>J(!1),children:"Got it"})})]})})]})};var Le=o(98587);const Oe=l.default.create({floatingButtonContainer:{position:"fixed",bottom:20,left:0,right:0,alignItems:"center",justifyContent:"center",zIndex:9999,backgroundColor:"transparent"},webButton:{position:"fixed",bottom:20,backgroundColor:"transparent"},mobileButton:{position:"fixed",bottom:20,backgroundColor:"transparent",width:"100%"},floatingButton:{backgroundColor:f.theme.colors.primary,borderRadius:25,paddingHorizontal:24,paddingVertical:8,elevation:5,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:3.84,maxWidth:600,minWidth:200},buttonLabel:{fontSize:16,fontWeight:"bold",color:"#fff"}}),Ee=({visible:e,onSave:t,btnText:o="Save Changes"})=>{const{screenWidth:i,isCollapsed:s}=a.useContext(p.AuthContext);if(!e)return null;a.useEffect((()=>{e&&(0,p.debugLog)("MBA230uvj0834h9","FloatingSaveButton is visible")}),[e]);const l=i>900?s?70:250:0;return(0,T.jsx)(r.default,{style:[Oe.floatingButtonContainer,"web"===n.default.OS?Oe.webButton:Oe.mobileButton,{marginLeft:l}],children:(0,T.jsx)(_e.default,{mode:"contained",onPress:t,style:Oe.floatingButton,labelStyle:Oe.buttonLabel,children:o})})},We=l.default.create({wrapper:{backgroundColor:f.theme.colors.background,paddingVertical:12,width:"100%",zIndex:1},container:{flexDirection:"row",alignItems:"center",width:"100%",paddingHorizontal:16,justifyContent:"space-between"},step:{flexDirection:"row",alignItems:"center",zIndex:2},stepCircle:{width:32,height:32,borderRadius:16,backgroundColor:f.theme.colors.surface,alignItems:"center",justifyContent:"center",borderWidth:1,borderColor:f.theme.colors.modernBorder,zIndex:3},activeStepCircle:{backgroundColor:f.theme.colors.mainColors.main,borderColor:f.theme.colors.mainColors.main},completedStepCircle:{backgroundColor:f.theme.colors.mainColors.main,borderColor:f.theme.colors.mainColors.main,opacity:.8},stepNumber:{fontSize:14,color:f.theme.colors.text,opacity:.5},activeStepNumber:{color:f.theme.colors.surface,opacity:1},completedStepNumber:{color:f.theme.colors.surface},stepName:{fontSize:14,color:f.theme.colors.text,opacity:.7,marginLeft:8,whiteSpace:"nowrap"},activeStepName:{color:f.theme.colors.mainColors.main,opacity:1},line:{height:2,backgroundColor:f.theme.colors.border,opacity:.2,flex:1,marginHorizontal:4,zIndex:1},completedLine:{backgroundColor:f.theme.colors.mainColors.main,opacity:1},progressLine:{flex:1,flexDirection:"row",height:2,marginHorizontal:4,zIndex:1},progressFilled:{flex:1,backgroundColor:f.theme.colors.mainColors.main,height:2},progressEmpty:{flex:1,backgroundColor:f.theme.colors.border,opacity:.2,height:2}}),Ne=e=>{const{steps:t,currentStep:o,onStepPress:n,style:s}=e,{screenWidth:l,is_DEBUG:d}=(0,a.useContext)(p.AuthContext),c=l>768;d&&(console.log("MBA1234 - Screen width:",l),console.log("MBA1234 - Is desktop:",c),console.log("MBA1234 - Steps:",t),console.log("MBA1234 - Current step:",o));const u=(e,t)=>{const a=t===o,n=t<o;return(0,T.jsxs)(r.default,{style:We.step,children:[(0,T.jsx)(r.default,{style:[We.stepCircle,a&&We.activeStepCircle,n&&We.completedStepCircle],children:(0,T.jsx)(i.default,{style:[We.stepNumber,a&&We.activeStepNumber,n&&We.completedStepNumber],children:t+1})}),(a||c)&&(0,T.jsx)(i.default,{style:[We.stepName,a&&We.activeStepName],children:e})]},"step-".concat(t))};return(0,T.jsx)(r.default,{style:[We.wrapper,s],children:(0,T.jsx)(r.default,{style:We.container,children:t.map(((e,n)=>{return(0,T.jsxs)(a.Fragment,{children:[u(e,n),n<t.length-1&&(i=n,i<o?(0,T.jsx)(r.default,{style:[We.line,We.completedLine]}):i===o?(0,T.jsxs)(r.default,{style:We.progressLine,children:[(0,T.jsx)(r.default,{style:We.progressFilled}),(0,T.jsx)(r.default,{style:We.progressEmpty})]}):(0,T.jsx)(r.default,{style:We.line}))]},"step-fragment-".concat(n));var i}))})})};var He=o(69574);const Ue=[{id:"all",name:"All",icon:"paw-outline",animalTypes:[]},{id:"farm_animals",name:"Farm Animals",icon:"horse",animalTypes:["Horse","Cow","Sheep","Goat","Pig","Other"]},{id:"domestic",name:"Domestic",icon:"paw",animalTypes:["Dogs","Cats","Birds","Rabbits","Hamsters","Other"]},{id:"reptiles",name:"Reptiles",icon:"snake",animalTypes:["Snake","Lizard","Turtle","Gecko","Chameleon","Other"]},{id:"aquatic",name:"Aquatic",icon:"fish",animalTypes:["Fish","Frog","Newt","Axolotl","Other"]},{id:"invertebrates",name:"Invertebrates",icon:"spider",animalTypes:["Spider","Scorpion","Crab","Snail","Millipede","Other"]}],Ve={Horse:"horse",Cow:"cow",Sheep:"sheep",Goat:"cow",Pig:"pig",Dogs:"dog",Cats:"cat",Birds:"bird",Rabbits:"rabbit",Hamsters:"rodent",Snake:"snake",Lizard:"snake",Turtle:"turtle",Gecko:"snake",Chameleon:"snake",Fish:"fish",Frog:"snake",Newt:"fish",Axolotl:"fish",Spider:"spider",Scorpion:"spider",Crab:"fish",Snail:"snail",Millipede:"bug",Other:"help-circle-outline"},qe={Horse:"Farm Animals",Cow:"Farm Animals",Sheep:"Farm Animals",Goat:"Farm Animals",Pig:"Farm Animals",Dogs:"Domestic",Cats:"Domestic",Birds:"Domestic",Rabbits:"Domestic",Hamsters:"Domestic",Snake:"Reptiles",Lizard:"Reptiles",Turtle:"Reptiles",Gecko:"Reptiles",Chameleon:"Reptiles",Fish:"Aquatic",Frog:"Aquatic",Newt:"Aquatic",Axolotl:"Aquatic",Spider:"Invertebrates",Scorpion:"Invertebrates",Crab:"Invertebrates",Snail:"Invertebrates",Millipede:"Invertebrates"};Ue[0].animalTypes=(()=>{const e=[];return Ue.forEach((t=>{"all"!==t.id&&t.animalTypes.forEach((t=>{"Other"===t||e.includes(t)||e.push(t)}))})),e})();const Ye=["Dogs","Cats","Fish","Birds","Hamsters","Rabbits","Snake","Turtle"],Ge=(e,t=null)=>{if(Ve[e])return Ve[e];if(t){const e=Ue.find((e=>e.id===t));if(e)return e.icon}return"paw"},Je=({serviceData:e,setServiceData:t})=>{const[o,d]=(0,a.useState)(""),[c,u]=(0,a.useState)(""),[m,g]=(0,a.useState)(!1),[h,y]=(0,a.useState)("all"),[b,x]=(0,a.useState)(v.default.get("window").width);n.default.OS;(0,a.useEffect)((()=>{const e=()=>{x(v.default.get("window").width)};return v.default.addEventListener("change",e),()=>{v.default.removeEventListener&&v.default.removeEventListener("change",e)}}),[]),(0,a.useEffect)((()=>{!c&&Ue.length>1&&u(Ue[1].id),(0,p.debugLog)("MBA456789","CategorySelectionStep received serviceData:",e),e.animalTypes&&e.animalTypes.length>0&&(0,p.debugLog)("MBA456789","Initial animal types in CategorySelectionStep:",e.animalTypes)}),[]);const j=t=>!(!e.animalTypes||!e.animalTypes.length)&&e.animalTypes.some((e=>"string"===typeof e?e===t:"object"===typeof e&&null!==e&&e.name===t)),w=(e,o=null)=>{if((0,p.debugLog)("MBA456789","Selecting animal: ".concat(e,", categoryId: ").concat(o)),"Other"===e)return g(!0),void u(o||Ue[1]&&Ue[1].id);t((t=>{const a=t.animalTypes||[];(0,p.debugLog)("MBA456789","Current animal types before update:",a);const n=a.findIndex((t=>"string"===typeof t?t===e:"object"===typeof t&&null!==t&&t.name===e));if((0,p.debugLog)("MBA456789","Animal ".concat(e," is ").concat(-1!==n?"already selected":"not selected")),-1!==n){const e=[...a];return e.splice(n,1),(0,p.debugLog)("MBA456789","Animal types after removal:",e),Object.assign({},t,{animalTypes:e})}{const n=qe[e]||"Other";let r=o;if(!r){const e=Ue.find((e=>e.name===n));r=e?e.id:"other"}const i={name:e,categoryId:r,categoryName:n,isCustom:!1};return(0,p.debugLog)("MBA456789","Adding new animal:",i),(0,p.debugLog)("MBA456789","Animal types after addition:",[...a,i]),Object.assign({},t,{animalTypes:[...a,i]})}}))},{animalTypes:C}=(()=>{(0,p.debugLog)("MBA456789","Getting filtered animal types with filter:",h),(0,p.debugLog)("MBA456789","Current serviceData.animalTypes:",e.animalTypes);let t=[],o=new Set;if(h&&"all"!==h){const e=Ue.find((e=>e.id===h));e&&(t=e.animalTypes.filter((e=>"Other"!==e)).map((t=>({name:t,categoryId:h,categoryName:e.name,icon:Ge(t,h)}))),o.add(e.name))}else Ue.forEach((e=>{"all"!==e.id&&e.animalTypes.filter((e=>"Other"!==e)).forEach((a=>{t.push({name:a,categoryId:e.id,categoryName:e.name,icon:Ge(a,e.id)}),o.add(e.name)}))}));return e.animalTypes&&e.animalTypes.length>0&&e.animalTypes.forEach((e=>{if("object"!==typeof e||!e||!e.name)return;if(e.isCustom||!Ue.some((t=>t.animalTypes&&t.animalTypes.includes(e.name)))){let a=e.categoryId,n=e.categoryName||"Other";if(!a&&n){const e=Ue.find((e=>e.name===n));e&&(a=e.id)}if(!n&&a){const e=Ue.find((e=>e.id===a));e&&(n=e.name)}if("all"===h||a===h){t.find((t=>t.name===e.name))||((0,p.debugLog)("MBA456789","Adding custom/unknown animal to filtered list: ".concat(e.name,", category: ").concat(n)),t.push({name:e.name,categoryId:a,categoryName:n,icon:Ge(e.name,a),isCustom:!0}),o.add(n))}}})),t.sort(((e,t)=>{const o=Ye.indexOf(e.name),a=Ye.indexOf(t.name);return-1!==o&&-1!==a?o-a:-1!==o?-1:-1!==a?1:e.name.localeCompare(t.name)})),(0,p.debugLog)("MBA456789","Filtered animal types to show:",t),{animalTypes:t,categories:Array.from(o)}})(),B=l.default.create({container:{flex:1,padding:16},title:{fontSize:24,fontWeight:"600",color:f.theme.colors.text,marginBottom:16,fontFamily:f.theme.fonts.header.fontFamily},subtitle:{fontSize:20,fontWeight:"600",color:f.theme.colors.text,marginTop:24,marginBottom:16,fontFamily:f.theme.fonts.header.fontFamily},instructions:{fontSize:16,color:f.theme.colors.textSecondary,marginBottom:16,fontFamily:f.theme.fonts.regular.fontFamily},categoryFiltersContainer:{flexDirection:"row",marginBottom:24,paddingLeft:2,paddingRight:20},categoryFiltersScrollView:{maxHeight:60},categoryFilterButton:{paddingVertical:12,paddingHorizontal:20,borderRadius:50,borderWidth:1,borderColor:f.theme.colors.border,backgroundColor:f.theme.colors.surface,flexDirection:"row",alignItems:"center",gap:8,minHeight:46,marginRight:10},selectedCategoryFilter:{backgroundColor:f.theme.colors.mainColors.mainLight,borderColor:f.theme.colors.mainColors.main},categoryFilterText:{fontSize:16,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily},selectedCategoryFilterText:{color:f.theme.colors.mainColors.main,fontWeight:"600"},actionsContainer:{flexDirection:"row",justifyContent:"flex-end",marginBottom:24},actionButton:{paddingVertical:8,paddingHorizontal:12},actionButtonText:{fontSize:16,color:f.theme.colors.mainColors.main,fontFamily:f.theme.fonts.regular.fontFamily},animalTypesGrid:{flexDirection:"row",flexWrap:"wrap",gap:16},animalTypeItem:{flex:1,minWidth:"web"===n.default.OS?b<=420?"45%":"30%":"45%",marginBottom:12},animalTypeCard:{borderRadius:12,borderWidth:1,borderColor:f.theme.colors.border,backgroundColor:f.theme.colors.surface,padding:16,height:70,justifyContent:"center"},selectedAnimalCard:{borderColor:f.theme.colors.mainColors.main,backgroundColor:f.theme.colors.mainColors.mainLight},animalTypeRow:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"},animalIconAndName:{flexDirection:"row",alignItems:"center",gap:12},animalTypeName:{fontSize:16,fontWeight:"500",color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily},customInputContainer:{marginVertical:24,padding:16,borderRadius:12,borderWidth:1,borderColor:f.theme.colors.border,backgroundColor:f.theme.colors.backgroundContrast},customInputTitle:{fontSize:16,fontWeight:"600",color:f.theme.colors.text,marginBottom:12,fontFamily:f.theme.fonts.regular.fontFamily},inputRow:{flexDirection:"row",gap:8,marginBottom:12},textInput:{flex:1,height:48,borderWidth:1,borderColor:f.theme.colors.border,borderRadius:8,paddingHorizontal:12,backgroundColor:f.theme.colors.surface,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily},pickerContainer:{flex:1,height:48,borderWidth:1,borderColor:f.theme.colors.border,borderRadius:8,backgroundColor:f.theme.colors.surface,justifyContent:"center"},picker:{height:48,color:f.theme.colors.text},addButton:{backgroundColor:f.theme.colors.mainColors.main,borderRadius:8,paddingVertical:12,paddingHorizontal:16,alignItems:"center"},addButtonText:{color:f.theme.colors.surface,fontSize:16,fontWeight:"600",fontFamily:f.theme.fonts.regular.fontFamily},selectedAnimalsSection:{marginTop:24,padding:16,backgroundColor:f.theme.colors.backgroundContrast,borderRadius:12,borderWidth:1,borderColor:f.theme.colors.border},selectedAnimalsTitle:{fontSize:16,fontWeight:"600",color:f.theme.colors.text,marginBottom:12,fontFamily:f.theme.fonts.regular.fontFamily},selectedAnimalsList:{flexDirection:"row",flexWrap:"wrap",gap:8},animalBubble:{flexDirection:"row",alignItems:"center",backgroundColor:f.theme.colors.surface,borderRadius:20,paddingVertical:6,paddingHorizontal:12,borderWidth:1,borderColor:f.theme.colors.border,marginBottom:8,marginRight:8,gap:8},animalBubbleText:{fontSize:14,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily},removeAnimalButton:{padding:2}});return(0,T.jsxs)(H.default,{style:B.container,children:[(0,T.jsx)(i.default,{style:B.title,children:"Select Animal Types for Your Service"}),(0,T.jsx)(i.default,{style:B.instructions,children:"Choose the animal types your service will cover. You can filter by category or add custom animals."}),(0,T.jsx)(H.default,{horizontal:!0,showsHorizontalScrollIndicator:!1,contentContainerStyle:B.categoryFiltersContainer,style:B.categoryFiltersScrollView,children:Ue.map((e=>(0,T.jsxs)(s.default,{style:[B.categoryFilterButton,h===e.id&&B.selectedCategoryFilter],onPress:()=>{return t=e.id,void y(t);var t},children:[(0,T.jsx)(S.default,{name:e.icon,size:22,color:h===e.id?f.theme.colors.mainColors.main:f.theme.colors.text}),(0,T.jsx)(i.default,{style:[B.categoryFilterText,h===e.id&&B.selectedCategoryFilterText],children:e.name})]},e.id)))}),(0,T.jsxs)(r.default,{style:B.actionsContainer,children:[(0,T.jsx)(s.default,{style:B.actionButton,onPress:()=>{let e=[];if(h&&"all"!==h){const t=Ue.find((e=>e.id===h));t&&(e=t.animalTypes.filter((e=>"Other"!==e)).map((e=>({name:e,categoryId:h}))))}else Ue.forEach((t=>{"all"!==t.id&&t.animalTypes.filter((e=>"Other"!==e)).forEach((o=>{e.push({name:o,categoryId:t.id})}))}));t((t=>Object.assign({},t,{animalTypes:e})))},children:(0,T.jsx)(i.default,{style:B.actionButtonText,children:"Select All"})}),(0,T.jsx)(s.default,{style:B.actionButton,onPress:()=>{t((e=>Object.assign({},e,{animalTypes:[]})))},children:(0,T.jsx)(i.default,{style:B.actionButtonText,children:"Clear All"})}),(0,T.jsx)(s.default,{style:B.actionButton,onPress:()=>g(!0),children:(0,T.jsx)(i.default,{style:B.actionButtonText,children:"Add Custom Pet"})})]}),m&&(0,T.jsxs)(r.default,{style:B.customInputContainer,children:[(0,T.jsx)(i.default,{style:B.customInputTitle,children:"Add a Custom Animal Type"}),(0,T.jsxs)(r.default,{style:B.inputRow,children:[(0,T.jsx)(q.default,{style:B.textInput,placeholder:"Animal Type (e.g. Hamster)",value:o,onChangeText:d,placeholderTextColor:f.theme.colors.placeHolderText}),(0,T.jsx)(r.default,{style:B.pickerContainer,children:"ios"===n.default.OS||"android"===n.default.OS?(0,T.jsx)(He.default,{selectedValue:c,style:B.picker,onValueChange:e=>u(e),children:Ue.filter((e=>"all"!==e.id)).map((e=>(0,T.jsx)(He.default.Item,{label:e.name,value:e.id},e.id)))}):(0,T.jsx)("select",{value:c,onChange:e=>u(e.target.value),style:B.picker,children:Ue.filter((e=>"all"!==e.id)).map((e=>(0,T.jsx)("option",{value:e.id,children:e.name},e.id)))})})]}),(0,T.jsx)(s.default,{style:B.addButton,onPress:()=>{if(!o.trim())return;let a="Other";if(c){const e=Ue.find((e=>e.id===c));e&&(a=e.name)}if(t((e=>Object.assign({},e,{animalTypes:[...e.animalTypes,{name:o.trim(),categoryId:c||"other",categoryName:a,isCustom:!0}]}))),c){if(!e.generalCategories.some((e=>e.id===c))){const e=Ue.find((e=>e.id===c));e&&t((t=>Object.assign({},t,{generalCategories:[...t.generalCategories,{id:e.id,name:e.name,icon:e.icon}]})))}}d(""),g(!1)},disabled:!o.trim(),children:(0,T.jsx)(i.default,{style:B.addButtonText,children:"Add Animal"})})]}),C.length>0?(0,T.jsx)(r.default,{style:B.animalTypesGrid,children:C.map((e=>(0,T.jsx)(r.default,{style:B.animalTypeItem,children:(0,T.jsx)(s.default,{style:[B.animalTypeCard,j(e.name)&&B.selectedAnimalCard],onPress:()=>w(e.name,e.categoryId),children:(0,T.jsxs)(r.default,{style:B.animalTypeRow,children:[(0,T.jsxs)(r.default,{style:B.animalIconAndName,children:[(0,T.jsx)(S.default,{name:e.icon,size:24,color:f.theme.colors.text}),(0,T.jsx)(i.default,{style:B.animalTypeName,children:e.name})]}),j(e.name)&&(0,T.jsx)(S.default,{name:"check-circle",size:24,color:f.theme.colors.mainColors.main})]})})},"".concat(e.categoryId,"-").concat(e.name))))}):(0,T.jsx)(i.default,{style:B.instructions,children:"No animal types match your current filter. Try selecting a different category or add a custom animal."}),e.animalTypes.length>0&&(0,T.jsxs)(r.default,{style:B.selectedAnimalsSection,children:[(0,T.jsxs)(i.default,{style:B.selectedAnimalsTitle,children:["Selected Animals (",e.animalTypes.length,")"]}),(0,T.jsx)(r.default,{style:B.selectedAnimalsList,children:e.animalTypes.map(((e,t)=>{const o=e.name,a=Ge(o,e.categoryId);return(0,T.jsxs)(r.default,{style:B.animalBubble,children:[(0,T.jsx)(S.default,{name:a,size:18,color:f.theme.colors.text}),(0,T.jsx)(i.default,{style:B.animalBubbleText,children:o}),(0,T.jsx)(s.default,{onPress:()=>w(o),style:B.removeAnimalButton,children:(0,T.jsx)(S.default,{name:"close-circle",size:16,color:f.theme.colors.text})})]},t)}))})]})]})};var $e=o(74037);const Ze=l.default.create({container:{flex:1,padding:16},title:{fontSize:24,fontWeight:"600",color:f.theme.colors.text,marginBottom:24,fontFamily:f.theme.fonts.regular.fontFamily},inputGroup:{marginBottom:24},label:{fontSize:16,color:f.theme.colors.text,marginBottom:8,fontFamily:f.theme.fonts.regular.fontFamily},input:{borderWidth:1,borderColor:f.theme.colors.border,borderRadius:12,padding:16,fontSize:16,color:f.theme.colors.text,backgroundColor:f.theme.colors.surface,fontFamily:f.theme.fonts.regular.fontFamily},textArea:{height:120,textAlignVertical:"top"},switchContainer:{backgroundColor:f.theme.colors.surface,borderRadius:12,padding:16,flexDirection:"row",alignItems:"center",justifyContent:"space-between",borderWidth:1,borderColor:f.theme.colors.border},switchGroup:{flex:1,marginRight:16},switchLabel:{fontSize:16,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily,marginBottom:4},switchSubLabel:{fontSize:14,color:f.theme.colors.placeHolderText,fontFamily:f.theme.fonts.regular.fontFamily},errorText:{color:f.theme.colors.error,fontSize:14,marginTop:4,fontFamily:f.theme.fonts.regular.fontFamily},characterCount:{color:f.theme.colors.textSecondary,fontSize:12,marginTop:4,textAlign:"right",fontFamily:f.theme.fonts.regular.fontFamily}}),Ke=({serviceData:e,setServiceData:t})=>{const[o,n]=(0,a.useState)(""),[s,l]=(0,a.useState)(""),d=(e,t=!0)=>/^[a-zA-Z0-9\s&\.\-\,]*$/.test(e)?(t?n(""):l(""),!0):(t?n("Service name can only contain letters, numbers, spaces, and &"):l("Description can only contain letters, numbers, spaces, periods, commas, dashes,and &"),!1);return(0,T.jsxs)(r.default,{style:Ze.container,children:[(0,T.jsx)(i.default,{style:Ze.title,children:"Service Details"}),(0,T.jsxs)(r.default,{style:Ze.inputGroup,children:[(0,T.jsx)(i.default,{style:Ze.label,children:"Service Name"}),(0,T.jsx)(q.default,{style:Ze.input,value:e.serviceName,onChangeText:e=>{const o=e.slice(0,30);d(o,!0)&&t((e=>Object.assign({},e,{serviceName:o})))},placeholder:"e.g. Premium Pet Grooming",placeholderTextColor:f.theme.colors.placeHolderText,maxLength:30}),(0,T.jsxs)(i.default,{style:Ze.characterCount,children:[e.serviceName.length,"/",30]}),o?(0,T.jsx)(i.default,{style:Ze.errorText,children:o}):null]}),(0,T.jsxs)(r.default,{style:Ze.inputGroup,children:[(0,T.jsx)(i.default,{style:Ze.label,children:"Service Description"}),(0,T.jsx)(q.default,{style:[Ze.input,Ze.textArea],value:e.serviceDescription,onChangeText:e=>{const o=e.slice(0,300);d(o,!1)&&t((e=>Object.assign({},e,{serviceDescription:o})))},placeholder:"Describe your service in detail...",placeholderTextColor:f.theme.colors.placeHolderText,multiline:!0,numberOfLines:6,textAlignVertical:"top",maxLength:300}),(0,T.jsxs)(i.default,{style:Ze.characterCount,children:[e.serviceDescription.length,"/",300]}),s?(0,T.jsx)(i.default,{style:Ze.errorText,children:s}):null]}),(0,T.jsxs)(r.default,{style:Ze.switchContainer,children:[(0,T.jsxs)(r.default,{style:Ze.switchGroup,children:[(0,T.jsx)(i.default,{style:Ze.switchLabel,children:"Overnight Service"}),(0,T.jsx)(i.default,{style:Ze.switchSubLabel,children:"Does this service require overnight stay?"})]}),(0,T.jsx)($e.default,{value:e.isOvernight,onValueChange:e=>{t((t=>Object.assign({},t,{isOvernight:e})))},trackColor:{false:f.theme.colors.border,true:f.theme.colors.mainColors.main},thumbColor:f.theme.colors.surface,ios_backgroundColor:f.theme.colors.border})]})]})};var Qe=o(51950);const Xe=Object.keys(re),et=["1","2","3","4","5"],tt=l.default.create({container:{flex:1,padding:16},title:{fontSize:24,fontWeight:"600",color:f.theme.colors.text,marginBottom:24,fontFamily:f.theme.fonts.regular.fontFamily},rateContainer:{marginBottom:24},label:{fontSize:16,color:f.theme.colors.text,marginBottom:8,fontFamily:f.theme.fonts.regular.fontFamily},rateInputGroup:{flexDirection:"row",gap:12},currencyInputContainer:{flex:1,flexDirection:"row",alignItems:"center",borderWidth:1,borderColor:f.theme.colors.border,borderRadius:8,paddingHorizontal:12,backgroundColor:f.theme.colors.surface},currencySymbol:{fontSize:16,color:f.theme.colors.text,marginRight:4,fontFamily:f.theme.fonts.regular.fontFamily},currencyInput:{flex:1,fontSize:16,color:f.theme.colors.text,padding:12,fontFamily:f.theme.fonts.regular.fontFamily,outlineStyle:"none"},unitSelector:{flex:1,flexDirection:"row",alignItems:"center",justifyContent:"space-between",borderWidth:1,borderColor:f.theme.colors.border,borderRadius:8,paddingHorizontal:12,paddingVertical:12,backgroundColor:f.theme.colors.surface},unitText:{fontSize:16,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily},dropdownContainer:{position:"absolute",top:"100%",backgroundColor:f.theme.colors.surface,borderWidth:1,borderColor:f.theme.colors.border,borderRadius:8,marginTop:4,zIndex:1e3,elevation:5,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:3.84,maxHeight:200},dropdownScroll:{width:"100%"},dropdownScrollContent:{flexGrow:1},dropdownItem:{padding:12,borderBottomWidth:1,borderBottomColor:f.theme.colors.border},selectedDropdownItem:{backgroundColor:f.theme.colors.mainColors.mainLight},dropdownText:{fontSize:16,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily},selectedDropdownText:{color:f.theme.colors.mainColors.main,fontWeight:"600"},holidayRateContainer:{marginBottom:24},holidayRateHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:8},rateTypeToggleContainer:{flexDirection:"row",alignItems:"center",overflow:"hidden",borderRadius:8},toggleButton:{paddingVertical:8,paddingHorizontal:14,alignItems:"center",justifyContent:"center",minWidth:40,width:44,height:36},activeToggleButton:{backgroundColor:f.theme.colors.mainColors.main,borderWidth:1,borderColor:f.theme.colors.mainColors.main},inactiveToggleButton:{backgroundColor:f.theme.colors.surface,borderWidth:1,borderColor:f.theme.colors.border},toggleButtonText:{fontSize:16,fontFamily:f.theme.fonts.regular.fontFamily,fontWeight:"500"},activeToggleText:{color:f.theme.colors.surface,fontWeight:"600"},inactiveToggleText:{color:f.theme.colors.text},holidayRateInputWrapper:{position:"relative"},percentageInputContainer:{flexDirection:"row",alignItems:"center",borderWidth:1,borderColor:f.theme.colors.border,borderRadius:8,paddingHorizontal:12,backgroundColor:f.theme.colors.surface},percentageInput:{flex:1,fontSize:16,color:f.theme.colors.text,padding:12,fontFamily:f.theme.fonts.regular.fontFamily,outlineStyle:"none"},percentageSymbol:{fontSize:16,color:f.theme.colors.text,marginRight:8,fontFamily:f.theme.fonts.regular.fontFamily},calculatedHolidayRate:{position:"absolute",bottom:-24,right:4,fontSize:14,color:f.theme.colors.placeHolderText,fontFamily:f.theme.fonts.regular.fontFamily,paddingTop:4},customRatesContainer:{},customRateItem:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",padding:12,backgroundColor:f.theme.colors.surface,borderRadius:8,marginBottom:8,borderWidth:1,borderColor:f.theme.colors.border},customRateContent:{flex:1,flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginRight:12},customRateActions:{flexDirection:"row",gap:8},customRateTitleContainer:{flex:1,marginRight:16},customRateTitle:{fontSize:16,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily},customRateDescription:{fontSize:14,color:f.theme.colors.placeHolderText,marginTop:2,fontFamily:f.theme.fonts.regular.fontFamily},customRateAmount:{fontSize:16,color:f.theme.colors.text,fontWeight:"600",fontFamily:f.theme.fonts.regular.fontFamily},newCustomRateContainer:{gap:12,marginBottom:16},customRateInput:{borderWidth:1,borderColor:f.theme.colors.border,borderRadius:8,padding:12,fontSize:16,color:f.theme.colors.text,backgroundColor:f.theme.colors.surface,fontFamily:f.theme.fonts.regular.fontFamily,outlineStyle:"none"},textArea:{height:80,textAlignVertical:"top"},addRateButton:{flexDirection:"row",alignItems:"center",gap:8,padding:12,borderWidth:1,borderColor:f.theme.colors.mainColors.main,borderRadius:8,justifyContent:"center"},addRateText:{color:f.theme.colors.mainColors.main,fontSize:16,fontWeight:"600",fontFamily:f.theme.fonts.regular.fontFamily},customRateButtonContainer:{flexDirection:"row",gap:12,marginTop:12},cancelRateButton:{flex:1,flexDirection:"row",alignItems:"center",gap:8,padding:12,borderWidth:1,borderColor:f.theme.colors.border,borderRadius:8,justifyContent:"center",backgroundColor:f.theme.colors.surface},cancelRateText:{color:f.theme.colors.text,fontSize:16,fontWeight:"500",fontFamily:f.theme.fonts.regular.fontFamily},saveRateButton:{flex:2,backgroundColor:f.theme.colors.mainColors.main,borderColor:f.theme.colors.mainColors.main},disabledSaveButton:{backgroundColor:f.theme.colors.placeHolderText,borderColor:f.theme.colors.placeHolderText},saveRateText:{color:f.theme.colors.surface,fontSize:16,fontWeight:"600",fontFamily:f.theme.fonts.regular.fontFamily},customRateFormHeading:{fontSize:16,fontWeight:"600",color:f.theme.colors.text,marginBottom:12,fontFamily:f.theme.fonts.regular.fontFamily},noCustomRatesText:{fontSize:14,color:f.theme.colors.placeHolderText,fontFamily:f.theme.fonts.regular.fontFamily,marginBottom:16,fontStyle:"italic"},customRateAction:{padding:8,borderRadius:4},modalOverlay:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0, 0, 0, 0.5)"},modalContent:{backgroundColor:f.theme.colors.surface,padding:24,borderRadius:12,maxWidth:"85%",minWidth:280,alignItems:"center",shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:3.84,elevation:5},modalIcon:{marginBottom:16},modalTitle:{fontSize:20,fontWeight:"600",color:f.theme.colors.text,marginBottom:12,textAlign:"center",fontFamily:f.theme.fonts.regular.fontFamily},modalText:{fontSize:16,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily,marginBottom:24,textAlign:"center",lineHeight:22},modalButton:{backgroundColor:f.theme.colors.mainColors.main,paddingVertical:12,paddingHorizontal:24,borderRadius:8},modalButtonText:{color:f.theme.colors.surface,fontSize:16,fontWeight:"600",fontFamily:f.theme.fonts.regular.fontFamily,textAlign:"center"},disabledUnitSelector:{backgroundColor:f.theme.colors.surface,opacity:.8,borderColor:f.theme.colors.modernBorder}}),ot=({serviceData:e,setServiceData:t,isUpdatingService:o,setIsUpdatingService:n,onProceedWithUpdate:l})=>{(0,p.debugLog)("MBA5931","RatesAndReviewStep render - isOvernight status:",e.isOvernight);const[d,c]=(0,a.useState)(!1),[u,m]=(0,a.useState)(!1),[g,h]=(0,a.useState)(!1),[y,b]=(0,a.useState)(!0),[x,j]=(0,a.useState)(!1),[w,C]=(0,a.useState)(!1),[v,B]=(0,a.useState)({title:"",rate:"",description:""}),k=e.isOvernight?["Per Night"]:Xe;(0,a.useEffect)((()=>{if(t((e=>Object.assign({},e,{rates:Object.assign({},e.rates,{isPercent:y})}))),e.isOvernight)(0,p.debugLog)("MBA5931","Service is overnight, setting rate unit to Per Night"),t((e=>Object.assign({},e,{rates:Object.assign({},e.rates,{base_rate_unit:"Per Night"})})));else if(e.rates?.base_rate_unit&&!ie[e.rates.base_rate_unit]){(0,p.debugLog)("MBA5931","Converting initial base_rate_unit to mapped value");!Object.keys(re).find((t=>re[t]===e.rates.base_rate_unit))&&e.rates.base_rate_unit&&(0,p.debugLog)("MBA5931","No mapping found for:",e.rates.base_rate_unit)}if(e.rates?.holidayRate){const o=e.rates.holidayRate.toString();o.includes("%")?(b(!0),t((e=>Object.assign({},e,{rates:Object.assign({},e.rates,{holidayRate:o.replace("%",""),isPercent:!0})})))):o.includes("$")&&(b(!1),t((e=>Object.assign({},e,{rates:Object.assign({},e.rates,{holidayRate:o.replace("$",""),isPercent:!1})}))))}}),[]),(0,a.useEffect)((()=>{(0,p.debugLog)("MBA5931","Available TIME_UNITS:",Xe),(0,p.debugLog)("MBA5931","TIME_UNIT_MAPPING:",re),(0,p.debugLog)("MBA5931","Current base_rate_unit:",e.rates?.base_rate_unit),(0,p.debugLog)("MBA5931","Displayed unit text:",e.rates?.base_rate_unit?ie[e.rates.base_rate_unit]||e.rates.base_rate_unit:Xe[0])}),[e.rates?.base_rate_unit]),(0,a.useEffect)((()=>{e.isOvernight&&((0,p.debugLog)("MBA5931","Overnight service detected, forcing Per Night rate unit"),t((e=>Object.assign({},e,{rates:Object.assign({},e.rates,{base_rate_unit:"Per Night"})}))))}),[e.isOvernight]);const A=()=>{const e=g;return(0,p.debugLog)("MBAno34othg0v","hasUnsavedCustomRate check:",{customChargeVisible:g,title:v.title,rate:v.rate,description:v.description,result:e}),e};(0,a.useEffect)((()=>{if((0,p.debugLog)("MBAno34othg0v","isUpdatingService changed:",{isUpdatingService:o,hasUnsaved:A()}),!o)return;A()?((0,p.debugLog)("MBAno34othg0v","Showing unsaved rate warning modal"),C(!0),n&&((0,p.debugLog)("MBAno34othg0v","Setting isUpdatingService to FALSE to prevent API call"),n(!1))):((0,p.debugLog)("MBAno34othg0v","No unsaved custom rate, allowing update to proceed"),n&&((0,p.debugLog)("MBAno34othg0v","Setting isUpdatingService to TRUE to allow parent to call API"),n(!0),"function"===typeof l&&((0,p.debugLog)("MBAno34othg0v","Calling onProceedWithUpdate directly"),l())))}),[o]);const I=e=>{let t=e.replace(/[^0-9.]/g,"");const o=t.split(".");return o.length>2&&(t=o[0]+"."+o.slice(1).join("")),o[1]?.length>2&&(t=o[0]+"."+o[1].slice(0,2)),t},D=e=>{b(e),t((t=>Object.assign({},t,{rates:Object.assign({},t.rates,{isPercent:e})})))},M=(e,t)=>{"rate"===e&&(t=I(t)),B((o=>Object.assign({},o,{[e]:t})))},R=()=>{if(!g)return(0,p.debugLog)("MBAno34othg0v","Opening custom rate form"),h(!0),void j(!1);if(!v.title.trim())return void(0,p.debugLog)("MBAno34othg0v","Missing custom rate title");if(!v.rate)return void(0,p.debugLog)("MBAno34othg0v","Missing custom rate value");const e=parseFloat(v.rate);isNaN(e)||e<=0?(0,p.debugLog)("MBAno34othg0v","Invalid rate value:",v.rate):((0,p.debugLog)("MBAno34othg0v","Saving custom rate successfully:",v),t((e=>Object.assign({},e,{additionalRates:[...e.additionalRates||[],v]}))),B({title:"",rate:"",description:""}),h(!1),j(!1))},P=(e,t,o,a,n)=>a?(0,T.jsx)(r.default,{style:[tt.dropdownContainer,n],children:(0,T.jsx)(H.default,{style:tt.dropdownScroll,contentContainerStyle:tt.dropdownScrollContent,children:e.map((e=>(0,T.jsx)(s.default,{style:[tt.dropdownItem,t===e&&tt.selectedDropdownItem],onPress:()=>o(e),children:(0,T.jsx)(i.default,{style:[tt.dropdownText,t===e&&tt.selectedDropdownText],children:e})},e)))})}):null;return(0,T.jsx)(Qe.default,{onPress:()=>{d&&c(!1),u&&m(!1)},children:(0,T.jsxs)(H.default,{style:tt.container,children:[(0,T.jsx)(i.default,{style:tt.title,children:"Set Your Rates"}),(0,T.jsx)(_.default,{visible:w,transparent:!0,animationType:"fade",onRequestClose:()=>C(!1),children:(0,T.jsx)(r.default,{style:tt.modalOverlay,children:(0,T.jsxs)(r.default,{style:tt.modalContent,children:[(0,T.jsx)(S.default,{name:"alert-circle",size:48,color:f.theme.colors.error,style:tt.modalIcon}),(0,T.jsx)(i.default,{style:tt.modalTitle,children:"Unsaved Custom Rate"}),(0,T.jsx)(i.default,{style:tt.modalText,children:"Please save or cancel your custom rate before updating the service."}),(0,T.jsx)(s.default,{style:tt.modalButton,onPress:()=>{(0,p.debugLog)("MBAno34othg0v","Modal OK button clicked"),C(!1)},children:(0,T.jsx)(i.default,{style:tt.modalButtonText,children:"OK"})})]})})}),(0,T.jsxs)(r.default,{style:[tt.rateContainer,{zIndex:3}],children:[(0,T.jsxs)(i.default,{style:tt.label,children:["Base Rate ",(0,T.jsx)(i.default,{style:{color:f.theme.colors.placeHolderText},children:"(Required)"})]}),(0,T.jsxs)(r.default,{style:tt.rateInputGroup,children:[(0,T.jsxs)(r.default,{style:[tt.currencyInputContainer,{flex:1}],children:[(0,T.jsx)(i.default,{style:tt.currencySymbol,children:"$"}),(0,T.jsx)(q.default,{style:tt.currencyInput,placeholder:"0.00",keyboardType:"decimal-pad",value:e.rates?.base_rate||"",onChangeText:e=>{const o=I(e);t((e=>Object.assign({},e,{rates:Object.assign({},e.rates,{base_rate:o})})))},placeholderTextColor:f.theme.colors.placeHolderText})]}),(0,T.jsxs)(r.default,{style:{flex:1,zIndex:1},children:[(0,T.jsxs)(s.default,{style:[tt.unitSelector,e.isOvernight&&tt.disabledUnitSelector],onPress:()=>{e.isOvernight||(m(!1),c(!d))},disabled:e.isOvernight,children:[(0,T.jsx)(i.default,{style:tt.unitText,children:e.isOvernight?"Per Night":e.rates?.base_rate_unit?ie[e.rates.base_rate_unit]||e.rates.base_rate_unit:Xe[0]}),!e.isOvernight&&(0,T.jsx)(S.default,{name:d?"chevron-up":"chevron-down",size:24,color:f.theme.colors.text})]}),P(k,e.rates?.base_rate_unit,(o=>{const a=e.isOvernight?"Per Night":re[o];t((e=>Object.assign({},e,{rates:Object.assign({},e.rates,{base_rate_unit:a})}))),c(!1)}),d&&!e.isOvernight,{width:"100%"})]})]})]}),(0,T.jsxs)(r.default,{style:[tt.rateContainer,{zIndex:2}],children:[(0,T.jsxs)(i.default,{style:tt.label,children:["Additional Animal Rate ",(0,T.jsx)(i.default,{style:{color:f.theme.colors.placeHolderText},children:"(Optional)"})]}),(0,T.jsxs)(r.default,{style:tt.rateInputGroup,children:[(0,T.jsxs)(r.default,{style:[tt.currencyInputContainer,{flex:1}],children:[(0,T.jsx)(i.default,{style:tt.currencySymbol,children:"$"}),(0,T.jsx)(q.default,{style:tt.currencyInput,placeholder:"0.00",keyboardType:"decimal-pad",value:e.rates?.additionalAnimalRate||"",onChangeText:e=>{const o=I(e);t((e=>Object.assign({},e,{rates:Object.assign({},e.rates,{additionalAnimalRate:o})})))},placeholderTextColor:f.theme.colors.placeHolderText})]}),(0,T.jsxs)(r.default,{style:{flex:1,zIndex:1},children:[(0,T.jsxs)(s.default,{style:tt.unitSelector,onPress:()=>{c(!1),m(!u)},children:[(0,T.jsxs)(i.default,{style:tt.unitText,children:["After ",e.rates?.additionalAnimalThreshold||"1"," animals"]}),(0,T.jsx)(S.default,{name:u?"chevron-up":"chevron-down",size:24,color:f.theme.colors.text})]}),P(et,e.rates?.additionalAnimalThreshold,(e=>{t((t=>Object.assign({},t,{rates:Object.assign({},t.rates,{additionalAnimalThreshold:e})}))),m(!1)}),u,{width:"100%"})]})]})]}),(0,T.jsxs)(r.default,{style:tt.holidayRateContainer,children:[(0,T.jsxs)(r.default,{style:tt.holidayRateHeader,children:[(0,T.jsxs)(i.default,{style:tt.label,children:["Holiday Rate ",(0,T.jsx)(i.default,{style:{color:f.theme.colors.placeHolderText},children:"(Optional)"})]}),(0,T.jsxs)(r.default,{style:tt.rateTypeToggleContainer,children:[(0,T.jsx)(s.default,{style:[tt.toggleButton,y?tt.activeToggleButton:tt.inactiveToggleButton,{borderTopLeftRadius:8,borderBottomLeftRadius:8,borderTopRightRadius:0,borderBottomRightRadius:0}],onPress:()=>D(!0),children:(0,T.jsx)(i.default,{style:[tt.toggleButtonText,y?tt.activeToggleText:tt.inactiveToggleText],children:"%"})}),(0,T.jsx)(s.default,{style:[tt.toggleButton,y?tt.inactiveToggleButton:tt.activeToggleButton,{borderTopLeftRadius:0,borderBottomLeftRadius:0,borderTopRightRadius:8,borderBottomRightRadius:8}],onPress:()=>D(!1),children:(0,T.jsx)(i.default,{style:[tt.toggleButtonText,y?tt.inactiveToggleText:tt.activeToggleText],children:"$"})})]})]}),(0,T.jsxs)(r.default,{style:[tt.holidayRateInputWrapper,{marginBottom:y&&e.rates?.base_rate&&e.rates?.holidayRate?28:0}],children:[(0,T.jsxs)(r.default,{style:y?tt.percentageInputContainer:tt.currencyInputContainer,children:[!y&&(0,T.jsx)(i.default,{style:tt.currencySymbol,children:"$"}),(0,T.jsx)(q.default,{style:tt.currencyInput,placeholder:"0",keyboardType:"decimal-pad",value:"0"===e.rates?.holidayRate?"":e.rates?.holidayRate,onChangeText:e=>{const o=I(e);t((e=>Object.assign({},e,{rates:Object.assign({},e.rates,{holidayRate:o})})))},placeholderTextColor:f.theme.colors.placeHolderText}),y&&(0,T.jsx)(i.default,{style:tt.percentageSymbol,children:"%"})]}),y&&e.rates?.base_rate&&e.rates?.holidayRate&&(0,T.jsx)(i.default,{style:tt.calculatedHolidayRate,children:(()=>{const t=parseFloat(e.rates?.base_rate)||0,o=parseFloat(e.rates?.holidayRate)||0;if(t>0&&o>0){const e=(t*o/100).toFixed(2);return"$".concat(e)}return null})()})]})]}),(0,T.jsxs)(r.default,{style:tt.customRatesContainer,children:[(0,T.jsxs)(i.default,{style:tt.label,children:["Custom Charges ",(0,T.jsx)(i.default,{style:{color:f.theme.colors.placeHolderText},children:"(Optional)"})]}),e.additionalRates?.length>0?e.additionalRates.map(((o,a)=>(0,T.jsxs)(r.default,{style:tt.customRateItem,children:[(0,T.jsxs)(r.default,{style:tt.customRateContent,children:[(0,T.jsxs)(r.default,{style:tt.customRateTitleContainer,children:[(0,T.jsx)(i.default,{style:tt.customRateTitle,children:o.title}),o.description?(0,T.jsx)(i.default,{style:tt.customRateDescription,numberOfLines:1,children:o.description}):null]}),(0,T.jsxs)(i.default,{style:tt.customRateAmount,children:["$",o.rate]})]}),(0,T.jsxs)(r.default,{style:tt.customRateActions,children:[(0,T.jsx)(s.default,{onPress:()=>(o=>{const a=e.additionalRates[o];B({title:a.title,rate:a.rate,description:a.description||""}),h(!0),j(!0),t((e=>Object.assign({},e,{additionalRates:e.additionalRates.filter(((e,t)=>t!==o))})))})(a),style:tt.customRateAction,activeOpacity:.7,children:(0,T.jsx)(S.default,{name:"pencil",size:20,color:f.theme.colors.mainColors.main})}),(0,T.jsx)(s.default,{onPress:()=>(e=>{t((t=>Object.assign({},t,{additionalRates:t.additionalRates.filter(((t,o)=>o!==e))})))})(a),style:tt.customRateAction,activeOpacity:.7,children:(0,T.jsx)(S.default,{name:"delete",size:20,color:"#F26969"})})]})]},a))):g?null:(0,T.jsx)(i.default,{style:tt.noCustomRatesText,children:"No custom charges added yet. Use the button below to add one."}),g?(0,T.jsxs)(r.default,{style:tt.newCustomRateContainer,children:[(0,T.jsx)(i.default,{style:tt.customRateFormHeading,children:x?"Edit Custom Rate":"New Custom Rate"}),(0,T.jsx)(q.default,{style:tt.customRateInput,placeholder:"Charge Title",value:v.title,onChangeText:e=>M("title",e),placeholderTextColor:f.theme.colors.placeHolderText}),(0,T.jsxs)(r.default,{style:tt.currencyInputContainer,children:[(0,T.jsx)(i.default,{style:tt.currencySymbol,children:"$"}),(0,T.jsx)(q.default,{style:tt.currencyInput,placeholder:"0.00",keyboardType:"decimal-pad",value:v.rate,onChangeText:e=>M("rate",e),placeholderTextColor:f.theme.colors.placeHolderText})]}),(0,T.jsx)(q.default,{style:[tt.customRateInput,tt.textArea],placeholder:"Description",value:v.description,onChangeText:e=>M("description",e),placeholderTextColor:f.theme.colors.placeHolderText,multiline:!0,numberOfLines:3}),(0,T.jsxs)(r.default,{style:tt.customRateButtonContainer,children:[(0,T.jsxs)(s.default,{style:tt.cancelRateButton,onPress:()=>{(0,p.debugLog)("MBAno34othg0v","Cancel button pressed for custom rate form"),h(!1),B({title:"",rate:"",description:""}),j(!1),C(!1)},children:[(0,T.jsx)(S.default,{name:"close",size:20,color:f.theme.colors.text}),(0,T.jsx)(i.default,{style:tt.cancelRateText,children:"Cancel"})]}),(0,T.jsxs)(s.default,{style:[tt.addRateButton,tt.saveRateButton,!v.title.trim()||!v.rate||isNaN(parseFloat(v.rate))||parseFloat(v.rate)<=0?tt.disabledSaveButton:{}],onPress:R,disabled:!v.title.trim()||!v.rate||isNaN(parseFloat(v.rate))||parseFloat(v.rate)<=0,children:[(0,T.jsx)(S.default,{name:"content-save",size:20,color:f.theme.colors.surface}),(0,T.jsx)(i.default,{style:tt.saveRateText,children:x?"Update Custom Rate":"Save Custom Rate"})]})]})]}):(0,T.jsxs)(s.default,{style:tt.addRateButton,onPress:R,children:[(0,T.jsx)(S.default,{name:"plus",size:20,color:f.theme.colors.mainColors.main}),(0,T.jsx)(i.default,{style:tt.addRateText,children:"Add Rate"})]})]})]})})};var at=o(50294);const nt={CATEGORY_SELECTION:{id:0,name:"Categories & Types"},SERVICE_DETAILS:{id:1,name:"Service Details"},RATES_AND_REVIEW:{id:2,name:"Rates & Review"}},rt={Horse:"Farm Animals",Cow:"Farm Animals",Sheep:"Farm Animals",Goat:"Farm Animals",Pig:"Farm Animals",Dogs:"Domestic",Cats:"Domestic",Birds:"Domestic",Rabbits:"Domestic",Hamsters:"Domestic",Snake:"Reptiles",Lizard:"Reptiles",Turtle:"Reptiles",Gecko:"Reptiles",Chameleon:"Reptiles",Fish:"Aquatic",Frog:"Aquatic",Newt:"Aquatic",Axolotl:"Aquatic",Spider:"Invertebrates",Scorpion:"Invertebrates",Crab:"Invertebrates",Snail:"Invertebrates",Millipede:"Invertebrates"},it=[{id:"all",name:"All",icon:"paw-outline"},{id:"farm_animals",name:"Farm Animals",icon:"horse"},{id:"domestic",name:"Domestic",icon:"paw"},{id:"reptiles",name:"Reptiles",icon:"snake"},{id:"aquatic",name:"Aquatic",icon:"fish"},{id:"invertebrates",name:"Invertebrates",icon:"spider"}],st=l.default.create({modalOverlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center",width:"100%"},modalContent:{width:"95%",maxWidth:"web"===n.default.OS?550:"100%",maxHeight:"90%",backgroundColor:f.theme.colors.background,borderRadius:12,overflow:"hidden",display:"flex",flexDirection:"column"},stepIndicatorContainer:{width:"100%",paddingVertical:12,backgroundColor:f.theme.colors.background,borderBottomWidth:1,borderBottomColor:f.theme.colors.modernBorder},scrollContent:{flex:1},scrollContentContainer:{flexGrow:1},content:{flex:1,backgroundColor:f.theme.colors.background},footer:{flexDirection:"row",padding:16,justifyContent:"space-between",gap:12,backgroundColor:f.theme.colors.background,borderTopWidth:1,borderTopColor:f.theme.colors.modernBorder},cancelButton:{flex:1,backgroundColor:f.theme.colors.surface,paddingVertical:16,borderRadius:8,alignItems:"center",borderWidth:1,borderColor:f.theme.colors.border},cancelButtonText:{color:f.theme.colors.text,fontSize:16,fontFamily:f.theme.fonts.regular.fontFamily},nextButton:{flex:1,backgroundColor:f.theme.colors.mainColors.main,paddingVertical:16,borderRadius:8,alignItems:"center"},disabledButton:{backgroundColor:f.theme.colors.placeHolderText},nextButtonText:{color:f.theme.colors.surface,fontSize:16,fontFamily:f.theme.fonts.regular.fontFamily,fontWeight:"600"},disabledButtonText:{color:f.theme.colors.surface},errorText:{color:f.theme.colors.error,textAlign:"center",marginBottom:16,fontFamily:f.theme.fonts.regular.fontFamily}}),lt=({visible:e,onClose:t,onSave:o,initialService:n=null,setHasUnsavedChanges:l})=>{const{is_DEBUG:d}=(0,a.useContext)(p.AuthContext),[c,u]=(0,a.useState)(nt.CATEGORY_SELECTION.id),[m,g]=(0,a.useState)({generalCategories:[],animalTypes:[],serviceName:"",serviceDescription:"",isOvernight:!1,rates:{base_rate:"",base_rate_unit:"Per Visit",additionalAnimalRate:"",additionalAnimalThreshold:"1",hasHolidayRate:!1,holidayRate:"0",isPercent:!0},additionalRates:[]}),[h,y]=(0,a.useState)(null),[b,x]=(0,a.useState)(!1),[j,w]=(0,a.useState)(!1),[C,v]=(0,a.useState)(!1),S=E();(0,a.useEffect)((()=>{if(e)if(u(nt.CATEGORY_SELECTION.id),y(null),n){(0,p.debugLog)("MBA123456","Initializing with service data:",n),w(!0);let e=[];n.animalTypes&&n.animalTypes.length>0?((0,p.debugLog)("MBA123456","Using pre-formatted animalTypes array:",n.animalTypes),e=n.animalTypes):n.animal_types?((0,p.debugLog)("MBA123456","Using animal_types from backend:",n.animal_types),"object"!==typeof n.animal_types||Array.isArray(n.animal_types)||((0,p.debugLog)("MBA123456","Processing animal_types as dictionary"),Object.entries(n.animal_types).forEach((([t,o])=>{const a=it.find((e=>e.name===o));(0,p.debugLog)("MBA123456","Adding animal: ".concat(t,", category: ").concat(o,", categoryId: ").concat(a?.id||"not found")),e.push({name:t,categoryName:o,categoryId:a?a.id:null,isCustom:!1})})))):(0,p.debugLog)("MBA123456","No animal types found in data"),(0,p.debugLog)("MBA123456","Final converted animal types:",e);let t="0",o=!0;n.holiday_rate&&("string"===typeof n.holiday_rate?n.holiday_rate.includes("%")?(t=n.holiday_rate.replace("%",""),o=!0):n.holiday_rate.includes("$")?(t=n.holiday_rate.replace("$",""),o=!1):(t=n.holiday_rate,o=void 0===n.holiday_rate_is_percent||n.holiday_rate_is_percent):(t=n.holiday_rate.toString(),o=void 0===n.holiday_rate_is_percent||n.holiday_rate_is_percent));let a=[];n.additional_rates&&Array.isArray(n.additional_rates)&&(a=n.additional_rates.map((e=>({title:e.title,rate:e.rate,description:e.description||""})))),g({service_id:n.service_id,generalCategories:[],animalTypes:e,serviceName:n.service_name||"",serviceDescription:n.description||"",isOvernight:n.is_overnight||!1,rates:{base_rate:n.base_rate||"",base_rate_unit:n.unit_of_time||"Per Visit",additionalAnimalRate:n.additional_animal_rate||"",additionalAnimalThreshold:n.applies_after?.toString()||"1",hasHolidayRate:"0"!==t,holidayRate:t,isPercent:o},additionalRates:a})}else w(!1),g({generalCategories:[],animalTypes:[],serviceName:"",serviceDescription:"",isOvernight:!1,rates:{base_rate:"",base_rate_unit:"Per Visit",additionalAnimalRate:"",additionalAnimalThreshold:"1",hasHolidayRate:!1,holidayRate:"0",isPercent:!0},additionalRates:[]})}),[e,n]);const B=()=>{switch(c){case nt.CATEGORY_SELECTION.id:return m.animalTypes?.length>0;case nt.SERVICE_DETAILS.id:return m.serviceName?.trim()&&m.serviceDescription?.trim();case nt.RATES_AND_REVIEW.id:const e=m.rates?.base_rate&&parseFloat(m.rates.base_rate)>0,t=!m.rates?.additionalAnimalRate||parseFloat(m.rates.additionalAnimalRate)>=0,o=!m.rates?.hasHolidayRate||m.rates.holidayRate&&parseFloat(m.rates.holidayRate)>=0;return e&&t&&o;default:return!1}},k=async()=>{(0,p.debugLog)("MBAno34othg0v","Directly calling API without state dependencies"),(0,p.debugLog)("MBA54321","Original serviceData:",m),x(!0);try{const e={};m.animalTypes.forEach((t=>{const o="string"===typeof t?t:t.name;rt[o]?e[o]=rt[o]:"object"===typeof t&&t.categoryName?e[o]=t.categoryName:e[o]="Other"})),(0,p.debugLog)("MBA54321","Animal types dictionary created:",e);m.generalCategories.map((e=>"string"===typeof e?e:e.name||"Uncategorized"));const a=m.rates.holidayRate||"0",n=a&&"0"!==a?m.rates.isPercent?"".concat(a,"%"):"$".concat(a):"0",r={service_name:m.serviceName,description:m.serviceDescription,animal_types:e,base_rate:m.rates.base_rate,additional_animal_rate:m.rates.additionalAnimalRate||"0",holiday_rate:n,applies_after:parseInt(m.rates.additionalAnimalThreshold)||1,unit_of_time:m.rates.base_rate_unit,is_overnight:m.isOvernight||!1,additional_rates:m.additionalRates.map((e=>({title:e.title,description:e.description||"",rate:e.rate})))};let i;j&&m.service_id&&(r.service_id=m.service_id),(0,p.debugLog)("MBA54321","Formatted data for backend:",r),j&&m.service_id?(i=await(0,at.updateService)(r),(0,p.debugLog)("MBA54321","Service updated successfully, response:",i)):(i=await(0,at.createService)(r),(0,p.debugLog)("MBA54321","Service created successfully, response:",i)),S({message:j?"Service updated successfully!":"Service created successfully!",type:"success",duration:3e3});const s={service_id:i.service_id,serviceName:i.service_name||m.serviceName,serviceDescription:m.serviceDescription,lengthOfService:i.unit_of_time||m.rates.base_rate_unit,isOvernight:m.isOvernight||!1,is_active:void 0===i.is_active||i.is_active,rates:{base_rate:m.rates.base_rate,additionalAnimalRate:m.rates.additionalAnimalRate||"0",holidayRate:n},generalCategories:m.generalCategories.map((e=>"string"===typeof e?{id:e.toLowerCase().replace(/\s+/g,"_"),name:e,isCustom:!1}:{id:e.id||e.name.toLowerCase().replace(/\s+/g,"_"),name:e.name,isCustom:e.isCustom||!1})),animalTypes:m.animalTypes.map((e=>"string"===typeof e?{name:e,categoryId:null,isCustom:!1}:{name:e.name,categoryId:e.categoryId,categoryName:e.categoryName||"Other",isCustom:e.isCustom||!1})),additionalRates:m.additionalRates.map((e=>({label:e.title,value:e.rate,description:e.description||""})))};i.additional_rates&&Array.isArray(i.additional_rates)&&(s.additionalRates=i.additional_rates.map((e=>({label:e.title,value:e.rate,description:e.description||""})))),(0,p.debugLog)("MBA54321","Formatted data for ServiceManager:",s),o&&o(s),g({generalCategories:[],animalTypes:[],serviceName:"",serviceDescription:"",isOvernight:!1,rates:{base_rate:"",base_rate_unit:"Per Visit",additionalAnimalRate:"",additionalAnimalThreshold:"1",hasHolidayRate:!1,holidayRate:"0",isPercent:!0},additionalRates:[]}),u(nt.CATEGORY_SELECTION.id),l(!0),t()}catch(h){(0,p.debugLog)("MBA54321","Error saving service:",h),(0,p.debugLog)("MBA54321","Error response:",h.response?.data),S({message:"Failed to ".concat(j?"update":"create"," service: ").concat(h.response?.data?.error||h.message),type:"error",duration:4e3}),y("Failed to ".concat(j?"update":"create"," service. Please try again."))}finally{x(!1)}},I=()=>{c>nt.CATEGORY_SELECTION.id?u((e=>e-1)):t()};return(0,T.jsx)(_.default,{visible:e,animationType:"fade",onRequestClose:I,transparent:!0,children:(0,T.jsx)(r.default,{style:st.modalOverlay,children:(0,T.jsxs)(Se.default,{style:st.modalContent,children:[(0,T.jsx)(r.default,{style:st.stepIndicatorContainer,children:(0,T.jsx)(Ne,{steps:Object.values(nt).map((e=>e.name)),currentStep:c})}),(0,T.jsxs)(H.default,{style:st.scrollContent,contentContainerStyle:st.scrollContentContainer,children:[(0,T.jsx)(r.default,{style:st.content,children:(()=>{switch((0,p.debugLog)("MBA54321 Rendering step:",c,"with serviceData:",m),c){case nt.CATEGORY_SELECTION.id:return(0,T.jsx)(Je,{serviceData:m,setServiceData:g});case nt.SERVICE_DETAILS.id:return(0,T.jsx)(Ke,{serviceData:m,setServiceData:g});case nt.RATES_AND_REVIEW.id:return(0,T.jsx)(ot,{serviceData:m,setServiceData:g,isUpdatingService:C,setIsUpdatingService:v,onProceedWithUpdate:k});default:return null}})()}),h&&(0,T.jsx)(i.default,{style:st.errorText,children:h})]}),(0,T.jsxs)(r.default,{style:st.footer,children:[(0,T.jsx)(s.default,{style:st.cancelButton,onPress:I,disabled:b,children:(0,T.jsx)(i.default,{style:st.cancelButtonText,children:c>nt.CATEGORY_SELECTION.id?"Back":"Cancel"})}),(0,T.jsx)(s.default,{style:[st.nextButton,(!B()||b)&&st.disabledButton],onPress:()=>{(0,p.debugLog)("MBAno34othg0v","handleNext called, currentStep:",c),B()?(y(null),c<nt.RATES_AND_REVIEW.id?u((e=>e+1)):((0,p.debugLog)("MBAno34othg0v","Final step, checking for unsaved custom rates"),v(!0))):y("Please complete all required fields before proceeding")},disabled:!B()||b,children:b&&c===nt.RATES_AND_REVIEW.id?(0,T.jsx)(A.default,{color:f.theme.colors.surface,size:"small"}):(0,T.jsx)(i.default,{style:[st.nextButtonText,!B()&&st.disabledButtonText],children:c===nt.RATES_AND_REVIEW.id?j?"Update Service":"Create Service":"Next"})})]})]})})})},dt=l.default.create({serviceCard:{backgroundColor:f.theme.colors.surfaceContrast,borderRadius:12,padding:16,marginBottom:16,shadowColor:"#000",display:"flex",justifyContent:"center",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:3,elevation:3},cardHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"flex-start",marginBottom:16},serviceName:{fontSize:f.theme.fontSizes.large,fontWeight:"600",color:f.theme.colors.text,fontFamily:f.theme.fonts.header.fontFamily,flex:1,flexWrap:"wrap",marginRight:8},activeToggleContainer:{flexDirection:"row",alignItems:"center",gap:8},activeText:{fontSize:f.theme.fontSizes.smallMedium,color:f.theme.colors.primary,fontFamily:f.theme.fonts.regular.fontFamily,fontWeight:"600"},inactiveText:{fontSize:f.theme.fontSizes.smallMedium,color:f.theme.colors.textSecondary,fontFamily:f.theme.fonts.regular.fontFamily},switch:{transform:[{scaleX:.8},{scaleY:.8}]},ratesContainer:{gap:12,padding:16,borderRadius:8,marginBottom:16},rateRow:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingVertical:4},rateLabel:{fontSize:f.theme.fontSizes.medium,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily,fontWeight:"500"},rateValue:{fontSize:f.theme.fontSizes.medium,color:f.theme.colors.text,fontWeight:"500",fontFamily:f.theme.fonts.regular.fontFamily},buttonContainer:{flexDirection:"row",justifyContent:"space-between",gap:8},editButton:{flex:1,flexDirection:"row",alignItems:"center",justifyContent:"center",backgroundColor:f.theme.colors.primary,paddingVertical:10,borderRadius:8,gap:8},deleteButton:{flex:1,flexDirection:"row",alignItems:"center",justifyContent:"center",borderColor:"#F26969",borderWidth:1,paddingVertical:10,borderRadius:8,gap:8},buttonText:{fontSize:f.theme.fontSizes.medium,color:f.theme.colors.surfaceContrast,fontFamily:f.theme.fonts.regular.fontFamily},deleteButtonText:{fontSize:f.theme.fontSizes.medium,fontWeight:"600",color:"#F26969",fontFamily:f.theme.fonts.regular.fontFamily}}),ct=({item:e,index:t,onEdit:o,onDelete:n})=>{const{screenWidth:l}=(0,a.useContext)(p.AuthContext),[d,c]=(0,a.useState)(!1!==e.is_active);(0,a.useEffect)((()=>{(0,p.debugLog)("MBA3377","ProfessionalServiceCard Item Data:",e)}),[e]);return(0,T.jsxs)(r.default,{style:dt.serviceCard,children:[(0,T.jsxs)(r.default,{style:dt.cardHeader,children:[(0,T.jsx)(i.default,{style:dt.serviceName,numberOfLines:2,ellipsizeMode:"tail",children:e.serviceName}),(0,T.jsxs)(r.default,{style:dt.activeToggleContainer,children:[(0,T.jsx)(i.default,{style:d?dt.activeText:dt.inactiveText,children:d?"Active":"Inactive"}),(0,T.jsx)($e.default,{value:d,onValueChange:()=>{c(!d)},trackColor:{false:f.theme.colors.quaternary,true:f.theme.colors.primary},thumbColor:f.theme.colors.surfaceContrast,style:dt.switch})]})]}),(0,T.jsxs)(r.default,{style:[dt.ratesContainer,{backgroundColor:(()=>{const e=[];return e[t%e.length]})()}],children:[(0,T.jsxs)(r.default,{style:dt.rateRow,children:[(0,T.jsx)(i.default,{style:dt.rateLabel,children:"Base Rate"}),(0,T.jsxs)(i.default,{style:dt.rateValue,children:["$",e.rates.base_rate||"N/A","/",(u=e.lengthOfService,u||"visit")]})]}),e.rates.additionalAnimalRate&&(0,T.jsxs)(r.default,{style:dt.rateRow,children:[(0,T.jsx)(i.default,{style:dt.rateLabel,children:"Additional Animal"}),(0,T.jsxs)(i.default,{style:dt.rateValue,children:["$",e.rates.additionalAnimalRate]})]}),e.rates.holidayRate&&(0,T.jsxs)(r.default,{style:dt.rateRow,children:[(0,T.jsx)(i.default,{style:dt.rateLabel,children:"Holiday Rate"}),(0,T.jsx)(i.default,{style:dt.rateValue,children:e.rates.holidayRate})]}),e.additionalRates&&e.additionalRates.map(((e,t)=>(0,T.jsxs)(r.default,{style:dt.rateRow,children:[(0,T.jsx)(i.default,{style:dt.rateLabel,children:e.label}),(0,T.jsxs)(i.default,{style:dt.rateValue,children:["$",e.value]})]},t)))]}),(0,T.jsxs)(r.default,{style:dt.buttonContainer,children:[(0,T.jsxs)(s.default,{onPress:()=>n(t),style:dt.deleteButton,children:[(0,T.jsx)(S.default,{name:"trash-can",size:20,color:"#F26969"}),(0,T.jsx)(i.default,{style:dt.deleteButtonText,children:"Delete"})]}),(0,T.jsxs)(s.default,{onPress:()=>o(t),style:dt.editButton,children:[(0,T.jsx)(S.default,{name:"pencil",size:20,color:f.theme.colors.surfaceContrast}),(0,T.jsx)(i.default,{style:dt.buttonText,children:"Edit"})]})]})]});var u},ut=[{id:"all",name:"All",icon:"paw-outline"},{id:"farm_animals",name:"Farm Animals",icon:"horse"},{id:"domestic",name:"Domestic",icon:"paw"},{id:"reptiles",name:"Reptiles",icon:"snake"},{id:"aquatic",name:"Aquatic",icon:"fish"},{id:"invertebrates",name:"Invertebrates",icon:"spider"}],mt=l.default.create({container:{flex:1,position:"relative",zIndex:9998,elevation:9998,backgroundColor:f.theme.colors.surface},serviceListContainer:{flex:1,paddingVertical:0},servicesGrid:{display:"flex",flexDirection:"row",flexWrap:"wrap",gap:16,paddingBottom:24},serviceCardWrapper:{flex:1,minWidth:300,maxWidth:375},headerContainer:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:24,position:"relative",zIndex:9999,elevation:9999},headerActions:{flexDirection:"row",alignItems:"center",gap:12},collapseButton:{padding:8,borderRadius:8,backgroundColor:f.theme.colors.surface},sectionTitle:{fontSize:f.theme.fontSizes.large,fontWeight:"bold",color:f.theme.colors.text,fontFamily:f.theme.fonts.header.fontFamily},addServiceButton:{flexDirection:"row",alignItems:"center",gap:8,backgroundColor:f.theme.colors.primary,paddingHorizontal:16,paddingVertical:10,borderRadius:50},addServiceText:{color:f.theme.colors.surface,fontSize:f.theme.fontSizes.medium,fontWeight:"500",fontFamily:f.theme.fonts.regular.fontFamily},emptyContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:20,backgroundColor:f.theme.colors.surface,borderRadius:8,marginBottom:24},emptyText:{fontSize:f.theme.fontSizes.mediumLarge,color:f.theme.colors.text,marginBottom:20,fontFamily:f.theme.fonts.regular.fontFamily},addButton:{backgroundColor:f.theme.colors.primary,paddingHorizontal:20,paddingVertical:10,borderRadius:50},addButtonText:{color:f.theme.colors.surface,fontSize:f.theme.fontSizes.medium,fontWeight:"500",fontFamily:f.theme.fonts.regular.fontFamily},portalTooltip:{backgroundColor:f.theme.colors.surface,padding:8,borderRadius:4,width:70,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:3.84,elevation:5},tooltipText:{fontSize:f.theme.fontSizes.small,color:f.theme.colors.text,textAlign:"center",fontFamily:f.theme.fonts.regular.fontFamily}}),gt=({services:e,setServices:t,setHasUnsavedChanges:o,isProfessionalTab:n=!1,isMobile:l=!1})=>{const[d,c]=(0,a.useState)(!1),[u,m]=(0,a.useState)(null),[g,h]=(0,a.useState)([]),[y,b]=(0,a.useState)(!1),[x,j]=(0,a.useState)(!1),[w,C]=(0,a.useState)(null),[v,B]=(0,a.useState)(null),[k,_]=(0,a.useState)(null),{screenWidth:A,is_DEBUG:I}=(0,a.useContext)(p.AuthContext),[M,R]=(0,a.useState)(null),P=(0,a.useRef)(null),z=((0,a.useRef)(null),E()),F=t=>{const o=e[t];(0,p.debugLog)("MBA87654","Original service for editing:",o);let a=[];o.animal_types&&"object"===typeof o.animal_types&&!Array.isArray(o.animal_types)?(a=Object.entries(o.animal_types).map((([e,t])=>{const o=ut.find((e=>e.name===t)),a=o?o.id:null;return{name:e,categoryName:t,categoryId:a,isCustom:!1}})),(0,p.debugLog)("MBA87654","Converted animal_types to array format:",a)):o.animalTypes&&(a=o.animalTypes,(0,p.debugLog)("MBA87654","Using existing animalTypes array:",a));const n={service_id:o.service_id,service_name:o.service_name||o.serviceName,description:o.description||o.serviceDescription,animal_types:o.animal_types,animalTypes:a,base_rate:o.base_rate||(o.rates?o.rates.base_rate:""),additional_animal_rate:o.additional_animal_rate||(o.rates?o.rates.additionalAnimalRate:"0"),holiday_rate:o.holiday_rate||(o.rates?o.rates.holidayRate:"0"),applies_after:o.applies_after||1,unit_of_time:o.unit_of_time||o.lengthOfService||"Per Visit",is_overnight:o.is_overnight||o.isOvernight||!1,is_active:void 0===o.is_active||o.is_active,holiday_rate_is_percent:o.holiday_rate_is_percent,additional_rates:o.additional_rates||(o.additionalRates?o.additionalRates.map((e=>({title:e.label||e.title,rate:e.value||e.rate,description:e.description||""}))):[])};(0,p.debugLog)("MBA87654","Formatted service for editing modal:",n),m(n),c(!0)},L=e=>{C(e),j(!0)},O=e=>{h((t=>t.includes(e)?t.filter((t=>t!==e)):[...t,e]))},W=({item:e,index:t})=>{if(!e||"object"!==typeof e)return console.warn("Invalid item detected:",e),null;if((0,p.debugLog)("MBA8765","Rendering service item:",e),e.service_id&&((0,p.debugLog)("MBA8765","This is a backend-created service with ID:",e.service_id),e.serviceName&&e.rates))return(0,T.jsx)(ct,{item:e,index:t,onEdit:()=>F(t),onDelete:()=>L(t),isCollapsed:g.includes(t),onToggleCollapse:()=>O(t),isProfessionalTab:n},"service-".concat(t));let o=[];e.animal_types&&"object"===typeof e.animal_types&&!Array.isArray(e.animal_types)?o=Object.entries(e.animal_types).map((([e,t])=>({name:e,categoryId:void 0,category:t,isCustom:!1}))):Array.isArray(e.animal_types)&&(o=e.animal_types);const a={service_id:e.service_id,serviceName:e.service_name,description:e.description,lengthOfService:e.unit_of_time,is_active:e.is_active,generalCategories:e.categories?.map((e=>({id:e.id,name:e.name,isCustom:e.is_custom})))||[],animalTypes:o,rates:{base_rate:e.base_rate,additionalAnimalRate:e.additional_animal_rate,holidayRate:e.holiday_rate},additionalRates:e.additional_rates?.map((e=>({label:e.title,value:e.rate,description:e.description})))||[]};return(0,T.jsx)(ct,{item:a,index:t,onEdit:()=>F(t),onDelete:()=>L(t),isCollapsed:g.includes(t),onToggleCollapse:()=>O(t),isProfessionalTab:n},"service-".concat(t))};return(0,T.jsxs)(r.default,{style:mt.container,children:[(0,T.jsxs)(r.default,{style:[mt.serviceListContainer,{maxWidth:1200,marginHorizontal:"auto",width:"100%",paddingHorizontal:l?20:24,paddingTop:l?0:44}],children:[(0,T.jsxs)(r.default,{style:mt.headerContainer,children:[(0,T.jsx)(i.default,{style:mt.sectionTitle,children:"Service Manager"}),(0,T.jsx)(r.default,{style:mt.headerActions,children:(0,T.jsxs)(s.default,{ref:P,style:mt.addServiceButton,onMouseEnter:()=>{try{((e,t,o)=>{if(e&&e.current)try{setTimeout((()=>{const a=e.current;if(a.getBoundingOwnerRect){const e=a.getBoundingOwnerRect();o({x:e.left+e.width/2,y:e.top,text:t}),B(t)}else console.error("Error: getBoundingOwnerRect method not found on element")}),0)}catch(a){console.error("Error showing tooltip:",a)}})(P,"Add Service",_)}catch(e){console.error("Error showing add tooltip:",e)}},onMouseLeave:()=>{B(null),_(null)},onPress:()=>{m(null),c(!0)},children:[(0,T.jsx)(S.default,{name:"plus",size:20,color:f.theme.colors.surface}),(0,T.jsx)(i.default,{style:mt.addServiceText,children:"Add New Service"})]})})]}),Array.isArray(e)&&e.length>0?(0,T.jsx)(r.default,{style:[mt.servicesGrid,{justifyContent:A>600?"":"center"}],children:e.map(((e,t)=>(0,T.jsx)(r.default,{style:mt.serviceCardWrapper,children:W({item:e,index:t})},"service-wrapper-".concat(t))))}):(0,T.jsxs)(r.default,{style:mt.emptyContainer,children:[(0,T.jsx)(i.default,{style:mt.emptyText,children:"No services yet"}),(0,T.jsx)(s.default,{style:mt.addButton,onPress:()=>c(!0),children:(0,T.jsx)(i.default,{style:mt.addButtonText,children:"Add Services"})})]})]}),(0,T.jsx)(lt,{visible:d,onClose:()=>{c(!1),m(null)},onSave:a=>{(0,p.debugLog)("MBA8765","Service data received from modal:",a);if(u&&a.service_id){(0,p.debugLog)("MBA8765","Updating existing service with ID:",a.service_id);const n=e.findIndex((e=>e.service_id===a.service_id));return-1!==n?(t((e=>{const t=[...e];return t[n]=a,t})),(0,p.debugLog)("MBA8765","Service updated at index:",n)):((0,p.debugLog)("MBA8765","Service ID not found in existing list, adding as new"),t((e=>[...e,a]))),o(!0),void m(null)}if(a.service_id)return(0,p.debugLog)("MBA8765","New service created on backend with ID:",a.service_id),t((e=>[...e,a])),o(!0),void m(null);(0,p.debugLog)("MBA8765","Warning: Falling back to legacy service format handling");const n={};a.animalTypes&&Array.isArray(a.animalTypes)&&a.animalTypes.forEach((e=>{e&&e.name&&(e.categoryName?n[e.name]=e.categoryName:n[e.name]=e.category||"Other")}));const r={service_name:a.serviceName,description:a.serviceDescription,unit_of_time:a.lengthOfService,is_overnight:a.isOvernight||!1,base_rate:a.rates.base_rate,additional_animal_rate:a.rates.additionalAnimalRate,holiday_rate:a.rates.holidayRate,animal_types:n,additional_rates:a.additionalRates.map((e=>({title:e.label,rate:e.value,description:e.description})))};if(u){const o=e.findIndex((e=>e.service_id===u.service_id));t(-1!==o?e=>{const t=[...e];return t[o]=r,t}:e=>[...e,r])}else t((e=>[...e,r]));o(!0),m(null)},initialService:u,setHasUnsavedChanges:o}),(0,T.jsx)(D,{visible:x,onClose:()=>j(!1),onConfirm:async()=>{try{const a=e[w];if(!a||!a.service_id)return z({message:"Unable to identify service for deletion",type:"error",duration:3e3}),void j(!1);await(0,at.deleteService)(a.service_id),t((e=>e.filter(((e,t)=>t!==w)))),o(!0),j(!1),z({message:"Service deleted successfully",type:"success",duration:3e3})}catch(a){const e=a.response?.data?.error||"Failed to delete service";z({message:e,type:"error",duration:3e3}),j(!1)}},actionText:"delete this service"}),k&&(0,T.jsx)(Ae.default,{children:(0,T.jsx)(r.default,{style:[mt.portalTooltip,{position:"fixed",top:k.y-40,left:k.x-35}],children:(0,T.jsx)(i.default,{style:mt.tooltipText,children:k.text})})}),M&&(0,T.jsx)(Ae.default,{children:(0,T.jsx)(r.default,{style:[mt.portalTooltip,{position:"fixed",top:M.y-40,left:M.x-35}],children:(0,T.jsx)(i.default,{style:mt.tooltipText,children:M.text})})})]})};l.default.create({section:{width:"100%",maxWidth:600,marginBottom:20,paddingVertical:20,borderBottomWidth:1,borderBottomColor:f.theme.colors.border},sectionTitle:{fontSize:f.theme.fontSizes.large,fontWeight:"bold",color:f.theme.colors.primary,marginBottom:10},petItem:{marginBottom:10,padding:10,backgroundColor:f.theme.colors.surface,borderColor:f.theme.colors.border,borderWidth:1,borderRadius:5,width:"100%",maxWidth:600},petItemContent:{flexDirection:"row",alignItems:"center"},petPhoto:{width:50,height:50,borderRadius:25,marginRight:10},petName:{fontSize:f.theme.fontSizes.medium,fontWeight:"bold"},petInfo:{flex:1},petDetails:{fontSize:f.theme.fontSizes.smallMedium,color:f.theme.colors.placeholder,flexWrap:"wrap"}}),l.default.create({section:{width:"100%",maxWidth:600,paddingVertical:20,borderBottomWidth:1,borderBottomColor:f.theme.colors.border},sectionHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:"100%",marginBottom:10},sectionTitle:{fontSize:f.theme.fontSizes.large,marginBottom:10,fontWeight:"bold",color:f.theme.colors.primary},input:{width:"100%",maxWidth:600,marginBottom:10,backgroundColor:f.theme.colors.surface,padding:10,borderRadius:5,borderWidth:1,borderColor:f.theme.colors.border},fieldText:{width:"100%",maxWidth:600,fontSize:f.theme.fontSizes.medium,color:f.theme.colors.text,marginBottom:10}}),l.default.create({centeredContent:{width:"100%",maxWidth:600,alignItems:"center",alignSelf:"center"},section:{width:"100%",maxWidth:600,marginBottom:20,paddingVertical:20,borderBottomWidth:1,borderBottomColor:f.theme.colors.border},sectionHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:"100%",marginBottom:10},sectionTitle:{fontSize:f.theme.fontSizes.large,marginBottom:10,fontWeight:"bold",color:f.theme.colors.primary},profileHeader:{alignItems:"center",marginBottom:20,width:"100%",maxWidth:600},profilePhoto:{width:120,height:120,borderRadius:60},profilePhotoPlaceholder:{backgroundColor:f.theme.colors.surface,justifyContent:"center",alignItems:"center",borderWidth:1,borderColor:f.theme.colors.border},input:{width:"100%",maxWidth:600,marginBottom:10,backgroundColor:f.theme.colors.surface,padding:10,borderRadius:5},fieldText:{width:"100%",maxWidth:600,fontSize:f.theme.fontSizes.medium,color:f.theme.colors.text,marginBottom:10},portfolioGrid:{width:"100%",flexDirection:"row",flexWrap:"wrap",justifyContent:"space-between",gap:16},portfolioCard:{width:"48%",marginBottom:16,backgroundColor:f.theme.colors.surface,borderRadius:8,overflow:"hidden",elevation:2,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.23,shadowRadius:2.62},portfolioImageContainer:{aspectRatio:4/3,width:"100%"},portfolioPhoto:{width:"100%",height:"100%",borderTopLeftRadius:8,borderTopRightRadius:8},portfolioCaption:{fontSize:f.theme.fontSizes.small,color:f.theme.colors.text,padding:8},emptyText:{textAlign:"center",color:f.theme.colors.placeholder,marginTop:16},facilitiesContainer:{flexDirection:"row",flexWrap:"wrap",gap:8,paddingHorizontal:4},facilityTag:{paddingHorizontal:16,paddingVertical:8,borderRadius:20,backgroundColor:f.theme.colors.surface,borderWidth:1,borderColor:f.theme.colors.primary,marginBottom:8},facilityTagSelected:{backgroundColor:f.theme.colors.primary},facilityTagText:{color:f.theme.colors.primary,fontSize:f.theme.fontSizes.small},facilityTagTextSelected:{color:f.theme.colors.surface},modalOverlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center"},modalContent:{width:"90%",maxWidth:500,backgroundColor:f.theme.colors.background,borderRadius:10,padding:20,maxHeight:"80%"},modalHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:20},modalTitle:{fontSize:f.theme.fontSizes.large,fontWeight:"bold"},modalScroll:{maxHeight:"70%"},modalFacilityTag:{padding:16,borderRadius:8,backgroundColor:f.theme.colors.surface,borderWidth:1,borderColor:f.theme.colors.primary,marginBottom:8},modalFacilityText:{fontSize:f.theme.fontSizes.medium,color:f.theme.colors.primary},modalFooter:{flexDirection:"row",justifyContent:"space-between",marginTop:20},modalButton:{padding:12,borderRadius:8,width:"48%",alignItems:"center"},saveButton:{backgroundColor:f.theme.colors.primary},cancelButton:{backgroundColor:f.theme.colors.surface,borderWidth:1,borderColor:f.theme.colors.primary},modalButtonText:{color:f.theme.colors.primary,fontSize:f.theme.fontSizes.medium,fontWeight:"bold"},modalButtonText2:{color:f.theme.colors.whiteText,fontSize:f.theme.fontSizes.medium,fontWeight:"bold"}});var ht=o(49162);const ft=l.default.create({webDatePicker:{padding:8,borderRadius:8,borderWidth:1,borderColor:f.theme.colors.border,fontSize:f.theme.fontSizes.medium,width:"100%",backgroundColor:f.theme.colors.background},androidButton:{padding:8,borderRadius:4,borderWidth:1,borderColor:f.theme.colors.border,backgroundColor:f.theme.colors.background},dateText:{fontSize:f.theme.fontSizes.medium,color:f.theme.colors.text},disabledInput:{backgroundColor:f.theme.colors.disabled,opacity:.7},disabledText:{color:f.theme.colors.placeholder}}),pt=({value:e,onChange:t,placeholder:o="Select Date",displayFormat:r=e=>e,disabled:l=!1,isInModal:d=!1})=>{const[c,u]=(0,a.useState)(!1),m=e?new Date(e):new Date,g=(e,o)=>{const a=o||m;"android"===n.default.OS&&u(!1),o&&t(a.toISOString().split("T")[0])};if("web"===n.default.OS){const a=e=>{d&&(e.stopPropagation(),e.preventDefault())},n=e=>{l||t(e.target.value)};return(0,T.jsx)("div",{onClick:a,onMouseDown:a,children:(0,T.jsx)("input",{type:"date",value:e||"",onChange:n,style:Object.assign({},ft.webDatePicker,l?ft.disabledInput:{},{cursor:l?"default":"pointer"}),placeholder:o,disabled:l})})}return"ios"===n.default.OS?(0,T.jsx)(ht.default,{value:m,mode:"date",display:"default",onChange:g,disabled:l}):(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(s.default,{onPress:()=>!l&&u(!0),style:[ft.androidButton,l&&ft.disabledInput],disabled:l,children:(0,T.jsx)(i.default,{style:[ft.dateText,l&&ft.disabledText],children:e?r(e):o})}),"android"===n.default.OS&&c&&(0,T.jsx)(ht.default,{value:m,mode:"date",display:"default",onChange:g,disabled:l})]})},yt=l.default.create({header:{flexDirection:"row",alignItems:"center",padding:16,borderBottomWidth:1,borderBottomColor:f.theme.colors.border,backgroundColor:f.theme.colors.background,zIndex:100,elevation:100},backButton:{marginRight:16},headerText:{fontSize:f.theme.fontSizes.large,fontWeight:"bold",color:f.theme.colors.primary,flex:1,fontFamily:f.theme.fonts.header.fontFamily},rightButton:{marginLeft:16}}),bt=({title:e,onBackPress:t,rightIcon:o=null,onRightPress:a=null,rightComponent:n=null,customStyles:l={}})=>{(0,j.useNavigation)();return(0,T.jsxs)(r.default,{style:[yt.header,l],children:[(0,T.jsx)(s.default,{onPress:t,style:yt.backButton,children:(0,T.jsx)(S.default,{name:"arrow-left",size:24,color:f.theme.colors.primary})}),(0,T.jsx)(i.default,{style:yt.headerText,children:e}),n||o&&(0,T.jsx)(s.default,{onPress:a,style:yt.rightButton,children:(0,T.jsx)(S.default,{name:o,size:24,color:f.theme.colors.primary})})]})},xt=l.default.create({container:{flex:1,backgroundColor:f.theme.colors.background,paddingTop:"android"===n.default.OS?Te.default.currentHeight:0,width:"100%",maxWidth:"100%",overflow:"hidden"},webContainer:{display:"flex",flexDirection:"column",minHeight:"85vh",width:"100%",maxWidth:"100%",overflow:"hidden"}}),jt=({children:e,style:t,useSafeArea:o=!0,backgroundColor:i=f.theme.colors.background,fullWidthHeader:s=!1,contentWidth:l="800px"})=>{const[d,c]=(0,a.useState)(v.default.get("window").width);if((0,a.useEffect)((()=>{if("web"===n.default.OS){const e=()=>{c(v.default.get("window").width)};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}}),[]),"web"===n.default.OS){const o=s?e[0]:null,a=s?e.slice(1):e;return(0,T.jsxs)("div",{style:Object.assign({backgroundColor:i,width:"100%",maxWidth:"100%",minHeight:"100vh",display:"flex",flexDirection:"column"},t),children:[s&&(0,T.jsx)("div",{style:{width:"100%",backgroundColor:i},children:o}),(0,T.jsx)("div",{style:Object.assign({},xt.webContainer,{maxWidth:l,width:"100%",flex:1,overflow:"hidden"}),children:a})]})}return"ios"===n.default.OS&&o?(0,T.jsx)(Se.default,{style:[xt.container,{backgroundColor:i},t],children:e}):(0,T.jsx)(r.default,{style:[xt.container,{paddingTop:o?Te.default.currentHeight:0,backgroundColor:i},t],children:e})};var wt=o(82459);const Ct=[{id:"none",label:"No Insurance",description:"I do not have insurance"},{id:"petplan",label:"PetPlan Insurance",description:"Comprehensive pet insurance coverage"},{id:"trupanion",label:"Trupanion",description:"Lifetime coverage for your pets"},{id:"custom",label:"Custom Insurance",description:"Upload my own insurance card"}],vt=({address:e,setAddress:t})=>(0,T.jsxs)(r.default,{style:Tt.addressForm,children:[(0,T.jsx)(q.default,{style:Tt.addressInput,value:e.street,onChangeText:e=>t((t=>Object.assign({},t,{street:e}))),placeholder:"Street Address"}),(0,T.jsx)(q.default,{style:Tt.addressInput,value:e.apartment,onChangeText:e=>t((t=>Object.assign({},t,{apartment:e}))),placeholder:"Apartment/Suite (optional)"}),(0,T.jsxs)(r.default,{style:Tt.addressRow,children:[(0,T.jsx)(q.default,{style:[Tt.addressInput,{flex:2}],value:e.city,onChangeText:e=>t((t=>Object.assign({},t,{city:e}))),placeholder:"City"}),(0,T.jsx)(q.default,{style:[Tt.addressInput,{flex:1}],value:e.state,onChangeText:e=>t((t=>Object.assign({},t,{state:e}))),placeholder:"State"})]}),(0,T.jsxs)(r.default,{style:Tt.addressRow,children:[(0,T.jsx)(q.default,{style:[Tt.addressInput,{flex:1}],value:e.zip,onChangeText:e=>t((t=>Object.assign({},t,{zip:e}))),placeholder:"ZIP Code",keyboardType:"numeric"}),(0,T.jsx)(q.default,{style:[Tt.addressInput,{flex:2}],value:e.country,onChangeText:e=>t((t=>Object.assign({},t,{country:e}))),placeholder:"Country"})]})]}),St=({visible:e,onClose:t,title:o,value:n,onSave:l,isLocation:d,isMultiline:c,isProfessional:u,isInsurance:m,selectedInsurance:g={type:"none",card:null},onInsuranceChange:h})=>{const[y,b]=(0,a.useState)(""),[x,j]=(0,a.useState)(g),[w,C]=(0,a.useState)(!1),[v,B]=(0,a.useState)({street:"",apartment:"",city:"",state:"",zip:"",country:""}),[k,I]=(0,a.useState)(1),[D,M]=(0,a.useState)(null);(0,a.useEffect)((()=>{if(e)if(m)j(g),I(1),M(null);else if(d){const e={street:"",apartment:"",city:"",state:"",zip:"",country:"USA"};n&&"object"===typeof n&&("address"in n?(e.street=n.address||"",e.apartment=n.apartment||""):"street"in n&&(e.street=n.street||"",e.apartment=n.apartment||""),e.city=n.city||"",e.state=n.state||"",e.zip=n.zip||"",e.country=n.country||"USA"),B(e)}else b(n||"")}),[e]);return(0,T.jsx)(_.default,{visible:e,transparent:!0,animationType:"fade",onRequestClose:t,children:(0,T.jsx)(r.default,{style:Tt.modalOverlay,children:(0,T.jsxs)(r.default,{style:[Tt.modalContent,m&&Tt.insuranceModalContent],children:[(0,T.jsxs)(r.default,{style:Tt.modalHeader,children:[m&&2===k&&(0,T.jsxs)(s.default,{style:Tt.backButton,onPress:()=>I(1),children:[(0,T.jsx)(S.default,{name:"arrow-left",size:24,color:f.theme.colors.primary}),(0,T.jsx)(i.default,{style:Tt.backButtonText,children:"Back"})]}),(0,T.jsx)(i.default,{style:[Tt.modalTitle,m&&2===k&&Tt.modalTitleCentered],children:o})]}),m?1===k?(0,T.jsxs)(r.default,{style:Tt.insuranceStepContent,children:[(0,T.jsx)(i.default,{style:Tt.insuranceStepTitle,children:"Choose Insurance Type"}),(0,T.jsxs)(s.default,{style:Tt.insuranceTypeButton,onPress:()=>(M("own"),void I(2)),children:[(0,T.jsx)(S.default,{name:"file-document",size:24,color:f.theme.colors.primary}),(0,T.jsxs)(r.default,{style:Tt.insuranceTypeContent,children:[(0,T.jsx)(i.default,{style:Tt.insuranceTypeTitle,children:"Use My Own Insurance"}),(0,T.jsx)(i.default,{style:Tt.insuranceTypeDescription,children:"Upload your existing insurance card"})]})]})]}):2===k?"own"===D?(0,T.jsxs)(r.default,{style:Tt.insuranceStepContent,children:[(0,T.jsx)(i.default,{style:Tt.insuranceStepTitle,children:"Upload Insurance Card"}),(0,T.jsxs)(s.default,{style:Tt.uploadButton,onPress:()=>(async e=>{if("custom"===e){const t=await Re.launchImageLibraryAsync({mediaTypes:Pe.MediaTypeOptions.Images,allowsEditing:!0,aspect:[16,9],quality:1});if(!t.canceled){const o={type:"custom",card:t.assets[0].uri};j(o),h(e)}}else j({type:e,card:null}),h(e)})("custom"),children:[(0,T.jsx)(S.default,{name:"file-upload",size:24,color:f.theme.colors.primary}),(0,T.jsx)(i.default,{style:Tt.uploadText,children:"Upload Insurance Card"})]}),"custom"===x.type&&x.card&&(0,T.jsxs)(r.default,{style:Tt.customInsuranceCard,children:[(0,T.jsx)(U.default,{source:{uri:x.card},style:Tt.insuranceCardImage}),(0,T.jsx)(i.default,{style:Tt.insuranceCardText,children:"Custom Insurance Card"})]})]}):(0,T.jsxs)(r.default,{style:Tt.insuranceStepContent,children:[(0,T.jsx)(i.default,{style:Tt.insuranceStepTitle,children:"Select Insurance Provider"}),Ct.filter((e=>"custom"!==e.id)).map((e=>(0,T.jsxs)(s.default,{style:[Tt.insuranceOption,x.type===e.id&&Tt.selectedInsuranceOption],onPress:()=>{const t={type:e.id,card:null};j(t),h(e.id)},children:[(0,T.jsx)(S.default,{name:"none"===e.id?"shield-off":"shield-check",size:24,color:f.theme.colors.primary}),(0,T.jsxs)(r.default,{style:Tt.insuranceOptionContent,children:[(0,T.jsx)(i.default,{style:Tt.insuranceOptionTitle,children:e.label}),(0,T.jsx)(i.default,{style:Tt.insuranceOptionDescription,children:e.description})]})]},e.id)))]}):null:d?(0,T.jsxs)(r.default,{style:Tt.locationContent,children:[!u&&(0,T.jsx)(s.default,{style:Tt.locationButton,onPress:async()=>{C(!0);try{let{status:e}=await wt.requestForegroundPermissionsAsync();if("granted"!==e)return void Be.default.alert("Permission denied","Please enable location services to use this feature.");const t=await wt.getCurrentPositionAsync({}),{latitude:o,longitude:a}=t.coords,[n]=await wt.reverseGeocodeAsync({latitude:o,longitude:a});n&&B({street:n.street||"",apartment:"",city:n.city||"",state:n.region||"",zip:n.postalCode||"",country:n.country||""})}catch(e){Be.default.alert("Error","Failed to get current location. Please enter address manually.")}finally{C(!1)}},disabled:w,children:w?(0,T.jsx)(A.default,{color:f.theme.colors.background}):(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(S.default,{name:"crosshairs-gps",size:20,color:f.theme.colors.background}),(0,T.jsx)(i.default,{style:Tt.locationButtonText,children:"Use Current Location"})]})}),(0,T.jsx)(vt,{address:v,setAddress:B})]}):(0,T.jsx)(q.default,{style:[Tt.modalInput,c&&Tt.multilineInput],value:y,onChangeText:b,multiline:c,numberOfLines:c?4:1,autoFocus:!0}),(0,T.jsxs)(r.default,{style:Tt.modalButtons,children:[(0,T.jsx)(s.default,{style:Tt.modalCancelButton,onPress:t,children:(0,T.jsx)(i.default,{style:Tt.modalCancelText,children:"Cancel"})}),(0,T.jsx)(s.default,{style:[Tt.modalSaveButton,d&&!v.street&&Tt.modalSaveButtonDisabled],onPress:()=>{m?l(x):d?((0,p.debugLog)("MBA12345","Saving location with addressForm:",v),l(v)):l(y),t()},disabled:d&&!v.street,children:(0,T.jsx)(i.default,{style:Tt.modalSaveText,children:"Save"})})]})]})})})},Tt=l.default.create({container:{flex:1,backgroundColor:f.theme.colors.surface},contentWrapper:{maxWidth:1200,alignSelf:"center",width:"100%",padding:16},mainContent:{width:"100%"},desktopLayout:{flexDirection:"row",gap:24},profileSection:{marginBottom:24},profileSectionDesktop:{width:300,marginBottom:0},profileCard:{backgroundColor:f.theme.colors.surfaceContrast,borderRadius:8,padding:16},profilePhotoContainer:{position:"relative",alignItems:"center",marginBottom:16},profilePhoto:{width:200,height:200,borderRadius:8,backgroundColor:f.theme.colors.surface},profilePhotoPlaceholder:{justifyContent:"center",alignItems:"center",borderWidth:2,borderStyle:"dashed",borderColor:f.theme.colors.border},cameraButton:{position:"absolute",right:8,bottom:8,backgroundColor:f.theme.colors.primary,padding:8,borderRadius:20},profileInfo:{alignItems:"center"},nameContainer:{flexDirection:"row",alignItems:"center",gap:8,marginBottom:4},name:{fontSize:24,fontWeight:"600",color:f.theme.colors.text,fontFamily:f.theme.fonts?.regular?.fontFamily},emailContainer:{flexDirection:"row",alignItems:"center",gap:4,marginBottom:4},email:{fontSize:14,color:f.theme.colors.secondary,fontFamily:f.theme.fonts?.regular?.fontFamily},locationContainer:{flexDirection:"row",marginBottom:12,width:"100%",position:"relative",paddingHorizontal:20},locationIconWrapper:{position:"absolute",left:0,top:0},location:{fontSize:14,color:f.theme.colors.secondary,fontFamily:f.theme.fonts?.regular?.fontFamily,textAlign:"center",flex:1},locationEditIcon:{position:"absolute",right:0,top:0,padding:4},roleContainer:{flexDirection:"row",alignItems:"center",gap:4,marginBottom:4},role:{fontSize:14,color:f.theme.colors.secondary},editIcon:{padding:4},ratingContainer:{flexDirection:"row",alignItems:"center",gap:4},rating:{fontSize:16,fontWeight:"500",color:f.theme.colors.text},reviews:{fontSize:14,color:f.theme.colors.secondary},sectionsContainer:{flex:1},sectionsContainerDesktop:{paddingLeft:24},section:{backgroundColor:f.theme.colors.surfaceContrast,borderRadius:8,padding:16,marginBottom:24},sectionHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16},sectionTitle:{fontSize:18,fontWeight:"600",color:f.theme.colors.text,fontFamily:f.theme.fonts?.header?.fontFamily},editButton:{backgroundColor:"transparent"},editButtonText:{color:f.theme.colors.primary,fontSize:14,fontWeight:"500"},bioInput:{backgroundColor:f.theme.colors.surface,borderRadius:8,padding:12,minHeight:100,textAlignVertical:"top",fontSize:16,color:f.theme.colors.text},facilitiesGrid:{gap:16},facilityItem:{flexDirection:"row",alignItems:"center",backgroundColor:f.theme.colors.surface,padding:12,borderRadius:8},facilityContent:{marginLeft:12},facilityTitle:{fontSize:14,color:f.theme.colors.secondary},facilityValue:{fontSize:16,fontWeight:"500",color:f.theme.colors.text,marginTop:2},addPhotoButton:{flexDirection:"row",alignItems:"center",backgroundColor:f.theme.colors.primary,paddingHorizontal:12,paddingVertical:8,borderRadius:6,gap:6},addPhotoText:{color:f.theme.colors.background,fontSize:14,fontWeight:"500"},photoGrid:{flexDirection:"row",flexWrap:"wrap",gap:16,marginTop:16},reviewsContainer:{marginBottom:12},noReviews:{fontSize:14,color:f.theme.colors.secondary,fontStyle:"italic"},bioText:{fontSize:16,color:f.theme.colors.text,lineHeight:24,fontFamily:f.theme.fonts?.regular?.fontFamily},locationButtons:{gap:16},locationButton:{flexDirection:"row",alignItems:"center",backgroundColor:f.theme.colors.primary,padding:12,borderRadius:8,justifyContent:"center",gap:8},locationButtonText:{color:f.theme.colors.background,fontSize:16,fontWeight:"500"},orText:{textAlign:"center",color:f.theme.colors.secondary,fontSize:14},multilineInput:{minHeight:100,textAlignVertical:"top"},portfolioPhoto:{width:"30%",aspectRatio:4/3,borderRadius:8},noPhotosText:{fontSize:14,color:f.theme.colors.secondary,fontStyle:"italic",textAlign:"center",padding:20},facilitiesModalContent:{height:"80%",width:"90%",maxWidth:500},facilitiesScrollView:{flex:1,marginBottom:16},facilityPresetItem:{flexDirection:"row",alignItems:"center",padding:16,borderRadius:8,marginBottom:8,backgroundColor:f.theme.colors.background},selectedFacilityPreset:{backgroundColor:f.theme.colors.primary},facilityPresetContent:{flex:1,marginLeft:12},facilityPresetTitle:{fontSize:16,fontWeight:"500",color:f.theme.colors.text,marginBottom:4},facilityPresetDescription:{fontSize:14,color:f.theme.colors.secondary},selectedFacilityText:{color:f.theme.colors.background},checkIcon:{marginLeft:8},modalButtons:{flexDirection:"row",justifyContent:"flex-end",gap:12},modalCancelButton:{paddingHorizontal:16,paddingVertical:8,borderRadius:6,backgroundColor:f.theme.colors.surface},modalCancelText:{color:f.theme.colors.text,fontSize:14,fontWeight:"500"},modalSaveButton:{paddingHorizontal:16,paddingVertical:8,borderRadius:6,backgroundColor:f.theme.colors.primary},modalSaveText:{color:f.theme.colors.background,fontSize:14,fontWeight:"500"},locationModalContent:{width:"90%",maxWidth:500,maxHeight:"90%"},locationContent:{gap:16,paddingBottom:16},addressForm:{gap:12},addressInput:{backgroundColor:f.theme.colors.background,borderRadius:8,padding:12,fontSize:16,color:f.theme.colors.text,minHeight:44},addressRow:{flexDirection:"row",gap:12,flexWrap:"wrap"},maxFacilitiesText:{fontSize:14,color:f.theme.colors.secondary,fontStyle:"italic",textAlign:"center",marginTop:8},modalSaveButtonDisabled:{opacity:.5},insuranceContent:{gap:16},customInsuranceCard:{alignItems:"center",gap:8},insuranceCardImage:{width:"100%",height:200,borderRadius:8,backgroundColor:f.theme.colors.background},insuranceCardText:{fontSize:14,color:f.theme.colors.secondary},insuranceOption:{flexDirection:"row",alignItems:"center",backgroundColor:f.theme.colors.background,padding:16,borderRadius:8,gap:16},insuranceOptionContent:{flex:1},insuranceOptionTitle:{fontSize:16,fontWeight:"500",color:f.theme.colors.text,marginBottom:4},insuranceOptionDescription:{fontSize:14,color:f.theme.colors.secondary},editButtonContent:{flexDirection:"row",alignItems:"center",gap:4},insuranceStepContent:{gap:16},insuranceStepTitle:{fontSize:18,fontWeight:"500",color:f.theme.colors.text,marginBottom:16},insuranceTypeButton:{flexDirection:"row",alignItems:"center",backgroundColor:f.theme.colors.background,padding:16,borderRadius:8,gap:16},insuranceTypeContent:{flex:1},insuranceTypeTitle:{fontSize:16,fontWeight:"500",color:f.theme.colors.text,marginBottom:4},insuranceTypeDescription:{fontSize:14,color:f.theme.colors.secondary},uploadButton:{flexDirection:"row",alignItems:"center",justifyContent:"center",backgroundColor:f.theme.colors.background,padding:16,borderRadius:8,gap:8},uploadText:{fontSize:16,color:f.theme.colors.primary,fontWeight:"500"},selectedInsuranceOption:{backgroundColor:f.theme.colors.primary+"20"},modalOverlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center"},modalContent:{backgroundColor:f.theme.colors.surface,borderRadius:8,padding:16,width:"90%",maxWidth:400,maxHeight:"90%"},modalHeader:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",marginBottom:16,position:"relative"},modalTitle:{fontSize:18,fontWeight:"600",color:f.theme.colors.text,flex:1,fontFamily:f.theme.fonts?.header?.fontFamily},modalTitleCentered:{textAlign:"center"},backButton:{flexDirection:"row",alignItems:"center",gap:4,position:"absolute",left:0,padding:8,zIndex:1},backButtonText:{color:f.theme.colors.primary,fontSize:14,fontWeight:"500"},modalInput:{backgroundColor:f.theme.colors.background,borderRadius:8,padding:12,fontSize:16,color:f.theme.colors.text,marginBottom:16},modalCloseButton:{alignSelf:"flex-end",backgroundColor:f.theme.colors.primary,paddingHorizontal:16,paddingVertical:8,borderRadius:6},modalCloseText:{color:f.theme.colors.background,fontSize:14,fontWeight:"500"}}),Bt=({profilePhoto:e,email:t,phone:o,age:n,address:l,city:d,state:c,zip:u,country:m,bio:g,about_me:h,emergencyContact:y,authorizedHouseholdMembers:b,editMode:x,toggleEditMode:j,onChangeText:w,pickImage:C,setHasUnsavedChanges:v,onSaveComplete:B,isMobile:k,rating:_,reviews:A,role:I,isProfessional:D,insurance:M={type:"none",card:null},onNavigateToTab:R,name:P})=>{const{name:z}=(0,a.useContext)(p.AuthContext),[F,L]=(0,a.useState)(!1),[O,W]=(0,a.useState)(null),[N,H]=(0,a.useState)(""),[V,q]=(0,a.useState)([]),[Y,G]=(0,a.useState)(M),[J,$]=(0,a.useState)(!1),[Z,K]=(0,a.useState)({name:P||z||"Your Name",email:t||"",bio:D?g:h,location:"".concat(l||"").concat(d?", ".concat(d):"").concat(c?", ".concat(c):"")}),Q=E(),[X,ee]=(0,a.useState)({name:"",email:"",bio:"",location:"",address:"",apartment:"",city:"",state:"",zip:"",country:"USA",insurance:{type:"none",card:null}});(0,a.useEffect)((()=>{v&&((0,p.debugLog)("MBA230uvj0834h9","Updating parent component with hasUnsavedChanges:",F),v(F))}),[F,v]),(0,a.useEffect)((()=>{(0,p.debugLog)("MBA230uvj0834h9","ProfileInfoTab mounted with props:",{propName:P,authName:z,email:t,address:l,bio:g,about_me:h,profilePhoto:e,isProfessional:D}),K({name:P||z||"Your Name",email:t||"",bio:D?g:h,location:"".concat(l||"").concat(d?", ".concat(d):"").concat(c?", ".concat(c):"")})}),[]),(0,a.useEffect)((()=>{K((e=>Object.assign({},e,{bio:D?g:h}))),(0,p.debugLog)("MBA230uvj0834h9","Role changed - updating bio/about_me:",{isProfessional:D,bio:g,about_me:h})}),[D,g,h]);const te=(e,t)=>{if((0,p.debugLog)("MBA230uvj0834h9","Edit ".concat(e,":"),t),"location"===e){const e={address:X.address||"",apartment:X.apartment||"",city:X.city||"",state:X.state||"",zip:X.zip||"",country:X.country||"USA"};H(e)}else H(t);W(e),L(!0),v&&v(!0)};(0,a.useEffect)((()=>{const e="".concat(d||"").concat(c?", ".concat(c):"");ee({name:P||z||"Your Name",email:t||"",bio:D?g:h,location:e,address:l||"",apartment:"",city:d||"",state:c||"",zip:u||"",country:m||"USA",insurance:M})}),[]);const oe=async(e,t)=>{if(!((e,t)=>"insurance"===e?JSON.stringify(t)!==JSON.stringify(X.insurance):"location"===e&&"object"===typeof t?((0,p.debugLog)("MBA12345","Checking location changes:",{originalAddress:X.address,newAddress:t.street||t.address,originalApartment:X.apartment,newApartment:t.apartment,originalCity:X.city,newCity:t.city,originalState:X.state,newState:t.state,originalZip:X.zip,newZip:t.zip,originalCountry:X.country,newCountry:t.country}),(t.street||t.address||"")!==X.address||(t.apartment||"")!==X.apartment||(t.city||"")!==X.city||(t.state||"")!==X.state||(t.zip||"")!==X.zip||(t.country||"USA")!==X.country):t!==X[e])(e,t))return(0,p.debugLog)("MBA230uvj0834h9","No changes detected for ".concat(e,", skipping save.")),W(null),L(!1),void(v&&v(!1));(0,p.debugLog)("MBA12345","Changes detected for ".concat(e,", proceeding with save."),{value:t}),$(!0);try{let o={};switch(e){case"name":o={name:t};break;case"email":o={email:t};break;case"bio":D?(o={bio:t},(0,p.debugLog)("MBA4928","Saving professional bio:",t)):(o={about_me:t},(0,p.debugLog)("MBA4928","Saving client about_me:",t));break;case"location":(0,p.debugLog)("MBA12345","Extracting address components from:",t);const e=(e=>{if(e&&"object"===typeof e){if("street"in e)return{address:e.street||"",apartment:e.apartment||"",city:e.city||"",state:e.state||"",zip:e.zip||"",country:e.country||"USA"};if("address"in e)return{address:e.address||"",apartment:e.apartment||"",city:e.city||"",state:e.state||"",zip:e.zip||"",country:e.country||"USA"}}if("string"===typeof e){const t=e.split(",").map((e=>e.trim()));return{address:t[0]||"",apartment:"",city:t[1]||"",state:t[2]||"",zip:t[3]||"",country:t[4]||"USA"}}return{address:"",apartment:"",city:"",state:"",zip:"",country:"USA"}})(t);(0,p.debugLog)("MBA12345","Extracted components:",e),o={address:e.address,apartment:e.apartment,city:e.city,state:e.state,zip:e.zip,country:e.country||"USA"};break;case"insurance":o={insurance:t}}(0,p.debugLog)("MBA4928","Saving ".concat(e," to backend:"),o);const a=await(0,at.updateProfileInfo)(o);if((0,p.debugLog)("MBA4928","Backend response for ".concat(e,":"),a),"name"===e)K(Object.assign({},Z,{name:a.name||Z.name})),ee((e=>Object.assign({},e,{name:a.name||e.name})));else if("email"===e)K(Object.assign({},Z,{email:a.email||Z.email})),ee((e=>Object.assign({},e,{email:a.email||e.email})));else if("bio"===e)D?(K(Object.assign({},Z,{bio:a.bio||Z.bio})),ee((e=>Object.assign({},e,{bio:a.bio||e.bio})))):(K(Object.assign({},Z,{bio:a.about_me||Z.bio})),ee((e=>Object.assign({},e,{bio:a.about_me||e.bio}))));else if("location"===e){const e="".concat(a.address||"").concat(a.city?", ".concat(a.city):"").concat(a.state?", ".concat(a.state):"");K(Object.assign({},Z,{location:e})),ee((t=>Object.assign({},t,{location:e,address:a.address||t.address,apartment:a.apartment||t.apartment,city:a.city||t.city,state:a.state||t.state,zip:a.zip||t.zip,country:a.country||t.country})))}else"insurance"===e&&(G(t),ee((e=>Object.assign({},e,{insurance:t}))));(0,p.debugLog)("MBA4928","Original values updated after save for ".concat(e),{originalValues:Object.assign({},X,{[e]:"location"===e?"".concat(a.address||"").concat(a.city?", ".concat(a.city):"").concat(a.state?", ".concat(a.state):""):a[e]})}),Q({message:"".concat(e.charAt(0).toUpperCase()+e.slice(1)," updated successfully"),type:"success",duration:3e3}),L(!1),v&&v(!1),B&&B(a)}catch(o){(0,p.debugLog)("MBA4928","Error saving ".concat(e,":"),o),Q({message:"Failed to update ".concat(e,". Please try again."),type:"error",duration:4e3}),v&&v(!0)}finally{$(!1),W(null)}};"".concat(d).concat(c?", ".concat(c):""),Z.name;return(0,T.jsxs)(r.default,{style:Tt.container,children:[(0,T.jsx)(r.default,{style:Tt.contentWrapper,children:(0,T.jsxs)(r.default,{style:[Tt.mainContent,!k&&Tt.desktopLayout],children:[(0,T.jsx)(r.default,{style:[Tt.profileSection,!k&&Tt.profileSectionDesktop],children:(0,T.jsxs)(r.default,{style:Tt.profileCard,children:[(0,T.jsxs)(s.default,{onPress:async()=>{try{const e=await C();if(e){$(!0);const t=new FormData,o={uri:e,type:"image/jpeg",name:"profile_photo.jpg"};t.append("profile_picture",o),(0,p.debugLog)("MBA4928","Uploading profile photo"),await(0,at.updateProfileInfo)(t),Q({message:"Profile photo updated successfully",type:"success",duration:3e3})}}catch(e){(0,p.debugLog)("MBA4928","Error uploading profile photo:",e),Q({message:"Failed to update profile photo. Please try again.",type:"error",duration:4e3})}finally{$(!1)}},style:Tt.profilePhotoContainer,children:[e?(0,T.jsx)(U.default,{source:{uri:e},style:Tt.profilePhoto}):(0,T.jsx)(r.default,{style:[Tt.profilePhoto,Tt.profilePhotoPlaceholder],children:(0,T.jsx)(S.default,{name:"camera-plus",size:40,color:f.theme.colors.placeholder})}),(0,T.jsx)(r.default,{style:Tt.cameraButton,children:(0,T.jsx)(S.default,{name:"camera",size:20,color:f.theme.colors.background})})]}),(0,T.jsxs)(r.default,{style:Tt.profileInfo,children:[(0,T.jsxs)(r.default,{style:Tt.nameContainer,children:[(0,T.jsx)(i.default,{style:Tt.name,children:Z.name}),(0,T.jsx)(s.default,{style:Tt.editIcon,onPress:()=>te("name",Z.name),children:(0,T.jsx)(S.default,{name:"pencil",size:20,color:f.theme.colors.text})})]}),(0,T.jsxs)(r.default,{style:Tt.emailContainer,children:[(0,T.jsx)(S.default,{name:"email",size:16,color:f.theme.colors.secondary}),(0,T.jsx)(i.default,{style:Tt.email,children:Z.email||"No email provided"}),(0,T.jsx)(s.default,{style:Tt.editIcon,onPress:()=>te("email",Z.email),children:(0,T.jsx)(S.default,{name:"pencil",size:16,color:f.theme.colors.text})})]}),(0,T.jsxs)(r.default,{style:Tt.locationContainer,children:[(0,T.jsx)(r.default,{style:Tt.locationIconWrapper,children:(0,T.jsx)(S.default,{name:"map-marker",size:16,color:f.theme.colors.secondary})}),(0,T.jsx)(i.default,{style:Tt.location,children:Z.location||"Set Location"}),(0,T.jsx)(s.default,{style:Tt.locationEditIcon,onPress:()=>te("location",Z.location),children:(0,T.jsx)(S.default,{name:"pencil",size:16,color:f.theme.colors.text})})]}),(0,T.jsx)(r.default,{style:Tt.reviewsContainer,children:_?(0,T.jsxs)(r.default,{style:Tt.ratingContainer,children:[(0,T.jsx)(S.default,{name:"star",size:20,color:f.theme.colors.warning}),(0,T.jsx)(i.default,{style:Tt.rating,children:_}),(0,T.jsxs)(i.default,{style:Tt.reviews,children:["(",A," reviews)"]})]}):(0,T.jsx)(i.default,{style:Tt.noReviews,children:"No reviews yet"})})]})]})}),(0,T.jsx)(r.default,{style:[Tt.sectionsContainer,!k&&Tt.sectionsContainerDesktop],children:(0,T.jsxs)(r.default,{style:Tt.section,children:[(0,T.jsxs)(r.default,{style:Tt.sectionHeader,children:[(0,T.jsx)(i.default,{style:Tt.sectionTitle,children:D?"Professional Bio":"About Me"}),(0,T.jsx)(s.default,{style:Tt.editButton,onPress:()=>te("bio",Z.bio),children:(0,T.jsxs)(i.default,{style:Tt.editButtonText,children:["Edit ",D?"Bio":"About Me"]})})]}),(0,T.jsx)(i.default,{style:Tt.bioText,children:Z.bio||"Tell us about yourself..."})]})})]})}),(0,T.jsx)(St,{visible:!!O,onClose:()=>W(null),title:"Edit ".concat(O?.charAt(0).toUpperCase()).concat(O?.slice(1)),value:N,onSave:e=>{if((0,p.debugLog)("MBA4928","Save ".concat(O," to value:"),e),"insurance"===O)oe("insurance",e);else if("location"===O)oe("location",e);else{const t=Object.assign({},Z);t[O]=e,K(t),oe(O,e)}},isLocation:"location"===O,isMultiline:"bio"===O||"about_me"===O,isProfessional:D,isInsurance:"insurance"===O,selectedInsurance:Y,onInsuranceChange:G})]})},kt=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],_t=({service:e})=>(0,T.jsx)(S.default,{name:{"Dog Walking":"walk","Pet Sitting":"home","Overnight Care":"bed"}[e]||"paw",size:24,color:f.theme.colors.text}),At=l.default.create({container:{flex:1,backgroundColor:f.theme.colors.surface},content:{padding:24,gap:24},sectionBox:{backgroundColor:f.theme.colors.surfaceContrast,borderRadius:8,padding:16,alignSelf:"flex-start"},servicesSection:{width:"100%"},servicesList:{width:"100%"},serviceWrapper:{width:"100%"},serviceItem:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",padding:16,borderRadius:8,marginBottom:8},selectedServiceItem:{borderWidth:1,borderColor:f.theme.colors.primary},serviceItemContent:{flexDirection:"row",alignItems:"center",flex:1},serviceInfo:{marginLeft:12,flex:1},serviceName:{fontSize:16,fontWeight:"500",color:f.theme.colors.text},servicePrice:{fontSize:14,color:f.theme.colors.secondary,marginTop:2},availabilityContainer:{flex:1,width:"100%"},controlsScrollContainer:{marginBottom:16},availabilityControls:{flexDirection:"row",gap:8},controlsDivider:{height:1,backgroundColor:f.theme.colors.surface,marginBottom:16},daysScrollContainer:{marginBottom:12},daysContainer:{flexDirection:"row",gap:8},availabilityDivider:{height:4,backgroundColor:f.theme.colors.surface,marginTop:16},availabilitySection:{backgroundColor:f.theme.colors.surfaceContrast,borderRadius:8,padding:16,marginBottom:16},availabilityHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16},availabilityTitle:{fontSize:16,fontWeight:"600",color:f.theme.colors.text},editHoursButton:{backgroundColor:"transparent"},editHoursText:{color:f.theme.colors.primary,fontSize:14,fontWeight:"500"},dayItem:{borderWidth:1,borderColor:f.theme.colors.primary,backgroundColor:"transparent",paddingHorizontal:12,paddingVertical:8,borderRadius:6,position:"relative",overflow:"hidden"},petsittingDayItem:{backgroundColor:f.theme.colors.warningLight},dayText:{color:f.theme.colors.primary,fontSize:14,fontWeight:"500",zIndex:1},availabilityTime:{fontSize:14,color:f.theme.colors.secondary},serviceDivider:{backgroundColor:f.theme.colors.surface,marginVertical:8,marginHorizontal:16},availabilityList:{width:"100%"},sectionHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16},sectionTitle:{fontSize:18,fontWeight:"600",color:f.theme.colors.text},editButton:{backgroundColor:"transparent"},editButtonText:{color:f.theme.colors.primary,fontSize:14,fontWeight:"500"},controlButton:{borderRadius:20,overflow:"hidden"},blockButtonContent:{flexDirection:"row",alignItems:"center",paddingVertical:8,paddingHorizontal:12,backgroundColor:"#FEE2E2",gap:6},blockButtonText:{color:f.theme.colors.error,fontSize:14,fontWeight:"500"},partialBlockButtonContent:{flexDirection:"row",alignItems:"center",paddingVertical:8,paddingHorizontal:12,backgroundColor:"#FFEDD5",gap:6},partialBlockText:{color:"#F97316",fontSize:14,fontWeight:"500"},dateRangeButtonContent:{flexDirection:"row",alignItems:"center",paddingVertical:8,paddingHorizontal:12,backgroundColor:"#EFF6FF",gap:6},dateRangeText:{color:"#3B82F6",fontSize:14,fontWeight:"500"},unavailableDayItem:{borderColor:f.theme.colors.error},unavailableSlash:{position:"absolute",top:"50%",left:-5,right:-5,height:1,backgroundColor:f.theme.colors.error,transform:[{rotate:"45deg"}]},unavailableDayText:{color:f.theme.colors.error},nextUnavailableContainer:{paddingVertical:8,paddingHorizontal:12},nextUnavailableText:{fontSize:14,color:f.theme.colors.secondary}}),It=({services:e=[{id:1,name:"Dog Walking",price:25,unit:"walk",isActive:!0,unavailableDays:["Sun"]},{id:2,name:"Pet Sitting",price:35,unit:"visit",isActive:!0,unavailableDays:["Sat","Sun"]},{id:3,name:"Overnight Care",price:85,unit:"night",isActive:!0,isOvernight:!0}],onToggleService:t,onEditHours:o,onBlockService:n,onPartialDayBlock:l})=>{const{screenWidth:d}=(0,a.useContext)(p.AuthContext),c=(0,j.useNavigation)(),[u,m]=(0,a.useState)(null),g=d<=1250,h=(e,o)=>(0,T.jsxs)(s.default,{style:[At.serviceItem,{backgroundColor:o%2===0?f.theme.colors.proDashboard.secondary:f.theme.colors.proDashboard.tertiary},u?.id===e.id&&At.selectedServiceItem],onPress:()=>m(e),children:[(0,T.jsxs)(r.default,{style:At.serviceItemContent,children:[(0,T.jsx)(_t,{service:e.name}),(0,T.jsxs)(r.default,{style:At.serviceInfo,children:[(0,T.jsx)(i.default,{style:At.serviceName,children:e.name}),(0,T.jsxs)(i.default,{style:At.servicePrice,children:["$",e.price,"/",e.unit]})]})]}),(0,T.jsx)($e.default,{value:e.isActive,onValueChange:()=>t(e.id),trackColor:{false:f.theme.colors.border,true:f.theme.colors.primary},thumbColor:f.theme.colors.background})]},e.id),y=e=>e.isOvernight?(0,T.jsx)(r.default,{style:At.nextUnavailableContainer,children:(0,T.jsx)(i.default,{style:At.nextUnavailableText,children:"Next Unavailable: Dec 24-25"})}):(0,T.jsx)(H.default,{horizontal:!0,showsHorizontalScrollIndicator:!1,style:At.daysScrollContainer,contentContainerStyle:At.daysContainer,children:kt.map((t=>{const o=e.unavailableDays?.includes(t);return(0,T.jsxs)(r.default,{style:[At.dayItem,o&&At.unavailableDayItem],children:[o&&(0,T.jsx)(r.default,{style:At.unavailableSlash}),(0,T.jsx)(i.default,{style:[At.dayText,o&&At.unavailableDayText],children:t})]},t)}))});return(0,T.jsx)(r.default,{style:At.container,children:(0,T.jsxs)(r.default,{style:[At.content,{flexDirection:g?"column":"row"}],children:[(0,T.jsxs)(r.default,{style:[At.servicesSection,!g&&{maxWidth:400},At.sectionBox],children:[(0,T.jsxs)(r.default,{style:At.sectionHeader,children:[(0,T.jsx)(i.default,{style:At.sectionTitle,children:"Your Services"}),(0,T.jsx)(s.default,{style:At.editButton,onPress:()=>c.navigate("ServiceManager"),children:(0,T.jsx)(i.default,{style:At.editButtonText,children:"Edit Services"})})]}),(0,T.jsx)(r.default,{style:At.servicesList,children:e.map(((t,o)=>(0,T.jsxs)(r.default,{style:At.serviceWrapper,children:[h(t,o),o!==e.length-1&&(0,T.jsx)(r.default,{style:At.serviceDivider})]},t.id)))})]}),(0,T.jsxs)(r.default,{style:[At.availabilityContainer,g&&{marginTop:24},At.sectionBox],children:[(0,T.jsx)(r.default,{style:At.sectionHeader,children:(0,T.jsx)(i.default,{style:At.sectionTitle,children:"Availability"})}),(0,T.jsxs)(H.default,{horizontal:!0,showsHorizontalScrollIndicator:!1,style:At.controlsScrollContainer,contentContainerStyle:At.availabilityControls,children:[(0,T.jsx)(s.default,{style:At.controlButton,onPress:n,children:(0,T.jsxs)(r.default,{style:At.blockButtonContent,children:[(0,T.jsx)(S.default,{name:"block-helper",size:20,color:f.theme.colors.error}),(0,T.jsx)(i.default,{style:At.blockButtonText,children:"Block All Services"})]})}),(0,T.jsx)(s.default,{style:At.controlButton,onPress:l,children:(0,T.jsxs)(r.default,{style:At.partialBlockButtonContent,children:[(0,T.jsx)(S.default,{name:"clock-outline",size:20,color:"#F97316"}),(0,T.jsx)(i.default,{style:At.partialBlockText,children:"Partial Day Block"})]})}),(0,T.jsx)(s.default,{style:At.controlButton,children:(0,T.jsxs)(r.default,{style:At.dateRangeButtonContent,children:[(0,T.jsx)(S.default,{name:"calendar-range",size:20,color:"#3B82F6"}),(0,T.jsx)(i.default,{style:At.dateRangeText,children:"Date Range"})]})})]}),(0,T.jsx)(r.default,{style:At.controlsDivider}),(0,T.jsx)(r.default,{style:At.availabilityList,children:e.map(((t,a)=>((t,a)=>(0,T.jsxs)(r.default,{style:At.availabilitySection,children:[(0,T.jsxs)(r.default,{style:At.availabilityHeader,children:[(0,T.jsx)(i.default,{style:At.availabilityTitle,children:t.name}),(0,T.jsx)(s.default,{style:At.editHoursButton,onPress:()=>o(t.id),children:(0,T.jsx)(i.default,{style:At.editHoursText,children:"Edit Hours"})})]}),y(t),(0,T.jsx)(i.default,{style:At.availabilityTime,children:t.isOvernight?"Check-in: 3 PM, Check-out: 11 AM":"Available 9 AM - 5 PM"}),a!==e.length-1&&(0,T.jsx)(r.default,{style:At.availabilityDivider})]}))(t,a)))})]})]})})},Dt=l.default.create({container:{flex:1,gap:24},section:{borderRadius:12,padding:24,marginBottom:24},sectionHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingVertical:10,borderBottomWidth:1,borderBottomColor:f.theme.colors.border,marginBottom:12},sectionTitle:{fontSize:18,fontWeight:"600",color:f.theme.colors.text},sectionDescription:{fontSize:14,color:f.theme.colors.secondary,marginBottom:16},addButton:{flexDirection:"row",alignItems:"center",backgroundColor:f.theme.colors.primary,paddingHorizontal:8,paddingVertical:4,borderRadius:6,gap:8},addButtonText:{color:f.theme.colors.background,fontSize:14,fontWeight:"500"},petsList:{gap:16},petCard:{borderRadius:12,overflow:"hidden",borderWidth:1,borderColor:f.theme.colors.border},petHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:16},petBasicInfo:{flexDirection:"row",alignItems:"center",gap:16,flex:1},petPhoto:{width:68,height:68,borderRadius:50},petInfo:{flex:1,marginLeft:12,justifyContent:"center"},petName:{fontSize:16,fontWeight:"600",color:f.theme.colors.text,marginBottom:4},petDetailsContainer:{flexDirection:"column"},petDetails:{fontSize:14,color:f.theme.colors.secondary,marginBottom:2},expandedDetails:{borderTopWidth:1,borderTopColor:f.theme.colors.border,padding:16},detailRow:{flexDirection:"row",gap:24,marginBottom:16},detailColumn:{flex:1},detailTitle:{fontSize:14,fontWeight:"600",color:f.theme.colors.text,marginBottom:8},detailText:{fontSize:14,color:f.theme.colors.secondary},preferencesGrid:{flexDirection:"row",flexWrap:"wrap",gap:12,marginTop:16},preferenceButton:{flexDirection:"row",alignItems:"center",gap:8,paddingVertical:8,paddingHorizontal:12,borderRadius:6,borderWidth:1,borderColor:f.theme.colors.primary,backgroundColor:f.theme.colors.surface},selectedPreference:{borderColor:f.theme.colors.primary,backgroundColor:"".concat(f.theme.colors.primary,"15")},preferenceText:{fontSize:14,color:f.theme.colors.primary,flex:1},selectedPreferenceText:{color:f.theme.colors.primary},checkmark:{marginLeft:"auto"},petActions:{flexDirection:"row",alignItems:"center",gap:12},editButton:{padding:4},fixButton:{padding:4,backgroundColor:"".concat(f.theme.colors.warning,"15"),borderRadius:4,marginHorizontal:4},addContactForm:{marginBottom:16,gap:12},input:{borderWidth:1,borderColor:f.theme.colors.border,borderRadius:6,padding:12,fontSize:14,color:f.theme.colors.text},submitButton:{backgroundColor:f.theme.colors.primary,padding:12,borderRadius:6,alignItems:"center"},submitButtonText:{color:f.theme.colors.background,fontSize:14,fontWeight:"500"},contactsList:{gap:12},contactCard:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:12,borderRadius:8,borderWidth:1,borderColor:f.theme.colors.border,backgroundColor:f.theme.colors.surface},contactInfo:{flex:1},contactName:{fontSize:16,fontWeight:"500",color:f.theme.colors.text},contactPhone:{fontSize:14,color:f.theme.colors.secondary},contactActions:{flexDirection:"row",gap:8},actionButton:{padding:8},emptyListText:{fontSize:14,color:f.theme.colors.secondary,fontStyle:"italic",textAlign:"center",padding:12},compatibilityContainer:{flexDirection:"column",gap:12},compatibilityItem:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingVertical:6,borderBottomWidth:1,borderBottomColor:f.theme.colors.border,flexWrap:"wrap"},compatibilityLabel:{fontSize:14,color:f.theme.colors.text,flex:.4,marginRight:10},dropdownContainer:{flexDirection:"row",alignItems:"center",gap:8,minWidth:60,justifyContent:"flex-end"},dropdownText:{fontSize:14,color:f.theme.colors.secondary},careInfoContainer:{flexDirection:"column",gap:12},medicationsContainer:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingVertical:6,borderBottomWidth:1,borderBottomColor:f.theme.colors.border},medicationsText:{fontSize:14,color:f.theme.colors.secondary},vetInfoContainer:{flexDirection:"column",gap:12},vetInfoItem:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingVertical:6,borderBottomWidth:1,borderBottomColor:f.theme.colors.border},vetInfoLabel:{fontSize:14,color:f.theme.colors.text},vetInfoText:{fontSize:14,color:f.theme.colors.secondary},documentButton:{flexDirection:"row",alignItems:"center",gap:8},documentButtonText:{fontSize:14,color:f.theme.colors.primary},dropdownContainerEdit:{flexDirection:"row",alignItems:"center",gap:8,minWidth:60,justifyContent:"flex-end",flexWrap:"wrap"},optionButton:{padding:8,borderWidth:1,borderColor:f.theme.colors.border,borderRadius:6,marginLeft:10,marginBottom:5},selectedOption:{borderColor:f.theme.colors.primary,backgroundColor:"".concat(f.theme.colors.primary,"15")},optionText:{fontSize:14,color:f.theme.colors.text},selectedOptionText:{color:f.theme.colors.primary},editInput:{borderWidth:1,borderColor:f.theme.colors.border,borderRadius:6,padding:12,fontSize:14,color:f.theme.colors.text},editInputMedications:{borderWidth:1,borderColor:f.theme.colors.border,borderRadius:6,padding:12,fontSize:14,color:f.theme.colors.text,flex:1,marginLeft:10},editInputShort:{borderWidth:1,borderColor:f.theme.colors.border,borderRadius:6,padding:12,fontSize:14,color:f.theme.colors.text,width:"55%",marginLeft:"auto"},editInputWeight:{borderWidth:1,borderColor:f.theme.colors.border,borderRadius:6,padding:12,fontSize:14,color:f.theme.colors.text,width:"40%",marginLeft:"auto"},uploadButton:{flexDirection:"row",alignItems:"center",gap:8,backgroundColor:f.theme.colors.primary,paddingHorizontal:12,paddingVertical:8,borderRadius:6},uploadButtonText:{color:f.theme.colors.background,fontSize:14,fontWeight:"500"},documentActionContainer:{flexDirection:"column",gap:8},documentsList:{marginTop:8},documentItem:{flexDirection:"row",alignItems:"center",gap:8,paddingVertical:6},documentName:{fontSize:14,color:f.theme.colors.text,flex:1},viewDocButton:{paddingHorizontal:8,paddingVertical:4,borderRadius:4,backgroundColor:"".concat(f.theme.colors.primary,"15")},viewDocText:{fontSize:12,color:f.theme.colors.primary},noDocumentsText:{fontSize:14,color:f.theme.colors.secondary,fontStyle:"italic",marginTop:8},detailSection:{marginTop:16},editContainer:{flexWrap:"wrap",gap:16,alignItems:"flex-start"},inputsWrapper:{flexDirection:"row",flexWrap:"wrap",gap:16,flex:1},inputWrapper:{minWidth:150,flexBasis:"46%",flexGrow:1,marginBottom:8},inputLabel:{fontSize:12,color:f.theme.colors.secondary,marginBottom:4},profilePhotoButton:{position:"relative"},plusIconContainer:{position:"absolute",bottom:0,right:0,backgroundColor:f.theme.colors.background,borderRadius:10},sectionRow:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16},editMainContainer:{width:"100%",marginBottom:16},editHeaderRow:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:"100%",marginBottom:16},editProfileContainer:{marginBottom:16,alignItems:"center"},editDetailsContainer:{width:"100%"},editActions:{flexDirection:"row",gap:12,alignItems:"center"},dateInfoContainer:{flexDirection:"column",gap:12},dateInfoItem:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingVertical:6,borderBottomWidth:1,borderBottomColor:f.theme.colors.border},dateInfoLabel:{fontSize:14,color:f.theme.colors.text,flex:1},dateInfoText:{fontSize:14,color:f.theme.colors.secondary},customDatePickerContainer:{flexDirection:"row",alignItems:"center",borderWidth:1,borderColor:f.theme.colors.border,borderRadius:6,overflow:"hidden",height:46},dateInputBox:{flex:1,height:"100%",justifyContent:"center",paddingHorizontal:12},dateInputText:{fontSize:14,color:f.theme.colors.text},placeholderText:{color:f.theme.colors.placeholder},calendarButton:{width:46,height:"100%",backgroundColor:f.theme.colors.surface,borderLeftWidth:1,borderLeftColor:f.theme.colors.border,justifyContent:"center",alignItems:"center"},datePickerContainer:{flex:1,maxWidth:"60%",marginLeft:"auto",marginRight:10},"@media (min-width: 900px)":{petDetailsContainer:{flexDirection:"row",flexWrap:"wrap",gap:8},petDetails:{marginRight:8}},modalOverlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center"},calendarModalContent:{backgroundColor:f.theme.colors.background,borderRadius:12,padding:20,width:"90%",maxWidth:420},calendarModalHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:20},calendarModalTitle:{fontSize:20,fontWeight:"600",color:f.theme.colors.text},closeButton:{padding:4},calendarHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16},calendarNavButton:{padding:8},calendarMonthYear:{fontSize:18,fontWeight:"600",color:f.theme.colors.text},weekdayLabels:{flexDirection:"row",justifyContent:"space-around",marginBottom:8},weekdayLabel:{flex:1,textAlign:"center",fontSize:14,fontWeight:"500",color:f.theme.colors.secondary,paddingVertical:8},calendarGrid:{marginBottom:16},calendarRow:{flexDirection:"row",justifyContent:"space-around",marginBottom:8},calendarDay:{flex:1,aspectRatio:1,alignItems:"center",justifyContent:"center",borderRadius:8,margin:2},calendarDayText:{fontSize:16,color:f.theme.colors.text},calendarDayOtherMonth:{opacity:.3},calendarDayTextOtherMonth:{color:f.theme.colors.placeholder},calendarDaySelected:{backgroundColor:f.theme.colors.primary},calendarDayTextSelected:{color:f.theme.colors.white,fontWeight:"600"},confirmButton:{backgroundColor:f.theme.colors.primary,borderRadius:8,padding:14,alignItems:"center",marginTop:8},confirmButtonText:{color:f.theme.colors.white,fontSize:16,fontWeight:"600"},stackedFields:{flexDirection:"column",gap:16,marginBottom:16},fullWidth:{width:"100%"},saveButton:{borderWidth:1,borderColor:f.theme.colors.primary,borderRadius:6,paddingHorizontal:12,paddingVertical:8,backgroundColor:f.theme.colors.primary,marginRight:8,alignItems:"center",justifyContent:"center"},saveButtonText:{color:"white",fontSize:14,fontWeight:"500"},errorModalContent:{backgroundColor:f.theme.colors.surface,borderRadius:12,padding:24,width:"90%",maxWidth:500},successModalContent:{borderLeftWidth:4,borderLeftColor:f.theme.colors.success},errorModalHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16},successModalHeader:{},errorModalTitle:{fontSize:18,fontWeight:"bold",color:f.theme.colors.error},successModalTitle:{color:f.theme.colors.success},errorModalMessage:{marginBottom:24,fontSize:16,lineHeight:24},successModalMessage:{},errorModalButton:{backgroundColor:f.theme.colors.primary,padding:12,borderRadius:8,alignItems:"center"},successModalButton:{backgroundColor:f.theme.colors.success},errorModalButtonText:{color:f.theme.colors.surface,fontWeight:"bold"},successModalButtonText:{}}),Mt=({pets:e=[],preferences:t={homeEnvironment:[],emergencyContacts:[],authorizedHouseholdMembers:[]},onAddPet:l,onEditPet:d,onDeletePet:c,onReplacePet:u,onUpdatePreferences:m,userRole:g,isMobile:h})=>{const[y,b]=(0,a.useState)(new Set),[x,j]=(0,a.useState)({name:"",phone:""}),[w,C]=(0,a.useState)({name:"",phone:""}),[B,k]=(0,a.useState)(!1),[A,I]=(0,a.useState)(!1),[D,M]=(0,a.useState)(new Set),[R,P]=(0,a.useState)({}),[z,F]=(0,a.useState)({}),[L,O]=(0,a.useState)({isVisible:!1,currentField:null,currentPetId:null,selectedDate:new Date}),[W,N]=(0,a.useState)((new Date).getMonth()),[V,Y]=(0,a.useState)((new Date).getFullYear()),[G,J]=(0,a.useState)(v.default.get("window").width),$=E(),[Z,K]=(0,a.useState)(!1),[Q,X]=(0,a.useState)(!0);(0,a.useEffect)((()=>{const e=()=>{J(v.default.get("window").width)};return v.default.addEventListener("change",e),()=>{v.default.removeEventListener&&v.default.removeEventListener("change",e)}}),[]);const ee=["Yes","No","N/A"],te=["Low","Medium","High","N/A"],oe=["Male","Female"],ae=(e,t)=>{let o="No Option Selected";return e&&t&&(null===e[t]?o="N/A":!0===e[t]?o="Yes":!1===e[t]?o="No":"string"===typeof e[t]&&(o=e[t])),(0,T.jsx)(r.default,{style:Dt.dropdownContainer,children:(0,T.jsx)(i.default,{style:Dt.dropdownText,children:o})})},ne=e=>{let t="No Option Selected";return e&&void 0!==e.energyLevel&&(null===e.energyLevel?t="N/A":"LOW"===e.energyLevel?t="Low":"MODERATE"===e.energyLevel?t="Medium":"HIGH"===e.energyLevel?t="High":"string"===typeof e.energyLevel?t=e.energyLevel:e.energyLevel&&"object"===typeof e.energyLevel&&(t="No Option Selected")),(0,T.jsx)(r.default,{style:Dt.dropdownContainer,children:(0,T.jsx)(i.default,{style:Dt.dropdownText,children:t})})},re=e=>{b((t=>{const o=new Set(t);return o.has(e)?o.delete(e):o.add(e),o}))},ie=e=>{if(!e)return null;const[t,o,a]=e.split("-");return"".concat(a,"-").concat(t,"-").concat(o)},se=e=>{if(!e)return null;const[t,o,a]=e.split("-");return"".concat(o,"-").concat(a,"-").concat(t)},le=(e,t,o)=>{P((a=>Object.assign({},a,{[e]:Object.assign({},a[e]||{},{[t]:o})}))),(0,p.debugLog)("MBA456","Editing pet field",{petId:e,field:t,value:o})},de=async e=>{try{(0,p.debugLog)("MBA456","Document upload simulated");const t={name:"Document_".concat((new Date).getTime(),".pdf"),size:2097152,type:"application/pdf"};P((o=>Object.assign({},o,{[e]:Object.assign({},o[e]||{},{vetDocuments:[...o[e]?.vetDocuments||[],t]})}))),$({message:"Document added successfully. Full document upload feature coming soon.",type:"info",duration:3e3})}catch(t){(0,p.debugLog)("MBA456","Error with document upload",t),$({message:"Failed to add document",type:"error",duration:3e3})}},ce=(e=[])=>0===e.length?(0,T.jsx)(i.default,{style:Dt.noDocumentsText,children:"No documents uploaded"}):(0,T.jsx)(r.default,{style:Dt.documentsList,children:e.map(((e,t)=>(0,T.jsxs)(r.default,{style:Dt.documentItem,children:[(0,T.jsx)(S.default,{name:"file-document-outline",size:18,color:f.theme.colors.primary}),(0,T.jsx)(i.default,{style:Dt.documentName,numberOfLines:1,ellipsizeMode:"middle",children:e.name}),(0,T.jsx)(s.default,{style:Dt.viewDocButton,children:(0,T.jsx)(i.default,{style:Dt.viewDocText,children:"View"})})]},t)))}),ue=(e,t)=>{try{if(!e||!t)return!1;const o=String(e),a="".concat(o,"-").concat(t);return!0===z[a]}catch(o){return console.error("Error checking if section is expanded:",o.message||"Unknown error"),!1}},me=(e,t,o)=>{try{if(!e||!o)return console.warn("Missing required parameters in renderSectionHeader"),null;const a="string"===typeof t?t:"Section",n=ue(e,o);return(0,T.jsxs)(s.default,{style:Dt.sectionHeader,onPress:t=>((e,t,o)=>{try{if(o&&"function"===typeof o.stopPropagation&&o.stopPropagation(),!e)return void console.warn("Missing petId in toggleSection");if(!t)return void console.warn("Missing sectionName in toggleSection");const a=String(e),n=String(t),r="".concat(a,"-").concat(n);F((e=>{if(!e||"object"!==typeof e){const e={};return e[r]=!0,e}const t=Object.assign({},e),o=!0===t[r];return t[r]=!o,t}))}catch(a){console.error("Error toggling section:",a.message||"Unknown error")}})(e,o,t),children:[(0,T.jsx)(i.default,{style:Dt.detailTitle,children:a}),(0,T.jsx)(S.default,{name:n?"chevron-up":"chevron-down",size:20,color:f.theme.colors.text})]})}catch(a){return console.error("Error rendering section header:",a.message||"Unknown error"),null}},ge=e=>{if(!e)return"";const t=(e.getMonth()+1).toString().padStart(2,"0"),o=e.getDate().toString().padStart(2,"0"),a=e.getFullYear();return"".concat(t,"-").concat(o,"-").concat(a)},he=(e,t)=>{const o=(e=>{if(!e)return new Date;const[t,o,a]=e.split("-").map((e=>parseInt(e,10)));return!t||!o||!a||isNaN(t)||isNaN(o)||isNaN(a)?new Date:new Date(a,t-1,o)})(R[e]?.[t]);N(o.getMonth()),Y(o.getFullYear()),O({isVisible:!0,currentField:t,currentPetId:e,selectedDate:o})},fe=(e,t)=>{if("android"!==n.default.OS){if(t){const e=ge(t);le(L.currentPetId,L.currentField,e)}O({isVisible:!1,currentField:null,currentPetId:null,selectedDate:null})}else{if("dismissed"===e?.type)return void O((e=>Object.assign({},e,{isVisible:!1})));if(t){const e=ge(t);le(L.currentPetId,L.currentField,e)}O((e=>Object.assign({},e,{isVisible:!1})))}},pe=(0,a.useMemo)((()=>{if(!L.isVisible)return[];const e=L.selectedDate||new Date,t=new Date(V,W,1),o=new Date(V,W+1,0).getDate(),a=t.getDay(),n=7*Math.ceil((o+a)/7),r=[];let i=1-a;for(let l=0;l<n;l++){const t=new Date(V,W,i),o=t.getMonth()===W,a=o&&t.getDate()===e.getDate()&&t.getMonth()===e.getMonth()&&t.getFullYear()===e.getFullYear();r.push({date:t,day:t.getDate(),isCurrentMonth:o,isSelectedDate:a}),i++}const s=[];for(let l=0;l<r.length;l+=7)s.push(r.slice(l,l+7));return s}),[W,V,L.selectedDate,L.isVisible]),ye=()=>{0===W?(N(11),Y((e=>e-1))):N((e=>e-1))},be=()=>{11===W?(N(0),Y((e=>e+1))):N((e=>e+1))},xe=(e,t)=>{let o="There was a problem with this operation. Please try again.";if(t.response&&t.response.data){const e=t.response.data.details;e?(o="Error details: ",Object.keys(e).forEach((t=>{o+="".concat(t,": ").concat(e[t].join(", "))}))):t.response.data.error&&(o=t.response.data.error)}else t.message&&(o=t.message);$({message:"".concat(e,": ").concat(o),type:"error",duration:5e3})},je=(t,o)=>{try{(0,p.debugLog)("MBA5555","REPLACE PET - Replacing temp pet with real pet in parent state");const i=[...e],s=i.findIndex((e=>e.id===t));if(-1!==s){const e=[...i.slice(0,s),o,...i.slice(s+1)];(0,p.debugLog)("MBA5555","REPLACE PET - Before replace:",i.map((e=>({id:e.id,name:e.name||"unnamed"})))),(0,p.debugLog)("MBA5555","REPLACE PET - After replace:",e.map((e=>({id:e.id,name:e.name||"unnamed"}))));try{(0,p.debugLog)("MBA5555","REPLACE PET - Calling onReplacePet with new array"),u(e),(0,p.debugLog)("MBA5555","REPLACE PET - Atomic replacement completed")}catch(a){(0,p.debugLog)("MBA5555","REPLACE PET - Error in onReplacePet callback:",a);try{(0,p.debugLog)("MBA5555","REPLACE PET - Trying fallback: delete + add"),c(t),setTimeout((()=>{l(o)}),50)}catch(n){throw(0,p.debugLog)("MBA5555","REPLACE PET - Even fallback failed:",n),n}}}else{(0,p.debugLog)("MBA5555","REPLACE PET - Temp pet not found in array of length "+i.length),(0,p.debugLog)("MBA5555","REPLACE PET - Current pet IDs: "+i.map((e=>e.id)).join(", ")),(0,p.debugLog)("MBA5555","REPLACE PET - Temp pet ID we're looking for: "+t),(0,p.debugLog)("MBA5555","REPLACE PET - Falling back to add");try{l(o)}catch(r){throw(0,p.debugLog)("MBA5555","REPLACE PET - Error in onAddPet fallback:",r),r}}}catch(i){throw(0,p.debugLog)("MBA5555","REPLACE PET - Unexpected error during pet replacement:",i),i}};return(0,T.jsxs)(H.default,{style:Dt.container,children:[(()=>{if(!L.isVisible)return null;if("android"===n.default.OS)return(0,T.jsx)(ht.default,{value:L.selectedDate,mode:"date",display:"default",onChange:fe});return(0,T.jsx)(_.default,{visible:L.isVisible,transparent:!0,animationType:"fade",onRequestClose:()=>O((e=>Object.assign({},e,{isVisible:!1}))),children:(0,T.jsx)(r.default,{style:Dt.modalOverlay,children:(0,T.jsxs)(r.default,{style:Dt.calendarModalContent,children:[(0,T.jsxs)(r.default,{style:Dt.calendarModalHeader,children:[(0,T.jsxs)(i.default,{style:Dt.calendarModalTitle,children:["Select ","birthday"===L.currentField?"Birthday":"Adoption Date"]}),(0,T.jsx)(s.default,{onPress:()=>O((e=>Object.assign({},e,{isVisible:!1}))),style:Dt.closeButton,children:(0,T.jsx)(S.default,{name:"close",size:24,color:f.theme.colors.text})})]}),(0,T.jsxs)(r.default,{style:Dt.calendarHeader,children:[(0,T.jsx)(s.default,{onPress:ye,style:Dt.calendarNavButton,children:(0,T.jsx)(S.default,{name:"chevron-left",size:24,color:f.theme.colors.primary})}),(0,T.jsxs)(i.default,{style:Dt.calendarMonthYear,children:[["January","February","March","April","May","June","July","August","September","October","November","December"][W]," ",V]}),(0,T.jsx)(s.default,{onPress:be,style:Dt.calendarNavButton,children:(0,T.jsx)(S.default,{name:"chevron-right",size:24,color:f.theme.colors.primary})})]}),(0,T.jsx)(r.default,{style:Dt.weekdayLabels,children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(((e,t)=>(0,T.jsx)(i.default,{style:Dt.weekdayLabel,children:e},t)))}),(0,T.jsx)(r.default,{style:Dt.calendarGrid,children:pe.map(((e,t)=>(0,T.jsx)(r.default,{style:Dt.calendarRow,children:e.map(((e,t)=>(0,T.jsx)(s.default,{style:[Dt.calendarDay,!e.isCurrentMonth&&Dt.calendarDayOtherMonth,e.isSelectedDate&&Dt.calendarDaySelected],onPress:()=>{return e.isCurrentMonth&&(t=e.date,void fe(null,t));var t},disabled:!e.isCurrentMonth,children:(0,T.jsx)(i.default,{style:[Dt.calendarDayText,!e.isCurrentMonth&&Dt.calendarDayTextOtherMonth,e.isSelectedDate&&Dt.calendarDayTextSelected],children:e.day})},t)))},t)))}),(0,T.jsx)(s.default,{style:Dt.confirmButton,onPress:()=>fe(null,L.selectedDate),children:(0,T.jsx)(i.default,{style:Dt.confirmButtonText,children:"Confirm"})})]})})})})(),(0,T.jsxs)(r.default,{style:[Dt.section,{backgroundColor:f.theme.colors.surfaceContrast}],children:[(0,T.jsxs)(r.default,{style:Dt.sectionHeader,children:[(0,T.jsx)(i.default,{style:Dt.sectionTitle,children:"My Pets"}),(0,T.jsxs)(s.default,{style:Dt.addButton,onPress:()=>{const t=e.filter((e=>String(e.id).startsWith("temp_")));if((0,p.debugLog)("MBA5555","ADD PET - Existing temp pets:",t.map((e=>e.id))),t.length>0){(0,p.debugLog)("MBA5555","ADD PET - Found existing temp pet, not creating a new one");const e=t[0];return M((t=>{const o=new Set(t);return o.add(e.id),o})),void b((t=>{const o=new Set(t);return o.add(e.id),o}))}const o="temp_".concat(Date.now());(0,p.debugLog)("MBA5555","ADD PET - Creating new pet with temp ID:",o);const a={id:o,name:"",breed:"",birthday:"",type:"",feedingInstructions:"",medicalNotes:"",pottyBreakSchedule:"",specialCareInstructions:"",childrenFriendly:void 0,dogFriendly:void 0,catFriendly:void 0,spayedNeutered:void 0,houseTrained:void 0,microchipped:void 0,energyLevel:void 0,canBeLeftAlone:void 0,medications:"",vetName:"",vetAddress:"",vetPhone:"",insuranceProvider:"",vetDocuments:[],sex:void 0,weight:"",adoptionDate:""};M((e=>{const t=new Set(e);return t.add(o),t})),P((e=>Object.assign({},e,{[o]:Object.assign({},a)}))),b((e=>{const t=new Set(e);return t.add(o),t})),(0,p.debugLog)("MBA5555","ADD PET - Calling onAddPet with new pet (adding to top of list)"),l(Object.assign({},a,{_addToTop:!0})),setTimeout((()=>{(0,p.debugLog)("MBA5555","ADD PET - Final state:",e.map((e=>({id:e.id,name:e.name||"unnamed"}))))}),100)},children:[(0,T.jsx)(S.default,{name:"plus",size:20,color:f.theme.colors.background}),(0,T.jsx)(i.default,{style:Dt.addButtonText,children:"Add Pet"})]})]}),(0,T.jsx)(r.default,{style:Dt.petsList,children:e.map((t=>{try{if(!t||"object"!==typeof t||!t.id)return console.warn("Invalid pet in renderPetCard"),null;const a=y.has(t.id),n=D.has(t.id),l=R[t.id]||t,u=G<500,m=t.id&&String(t.id).startsWith("temp_"),g="string"===typeof t.name?t.name:"",h="string"===typeof t.breed?t.breed:"",x="string"===typeof t.type?t.type:"",j="string"===typeof t.birthday?t.birthday:"No birthday set";return(0,T.jsxs)(r.default,{style:Dt.petCard,children:[(0,T.jsxs)(s.default,{style:[Dt.petHeader,{backgroundColor:f.theme.colors.surface}],onPress:e=>{n?((0,p.debugLog)("MBA5555","PET HEADER - Ignoring click while in edit mode for pet:",t.id),e.stopPropagation()):((0,p.debugLog)("MBA5555","PET HEADER - Toggle clicked for pet:",t.id),re(t.id))},activeOpacity:.2,children:[(0,T.jsx)(r.default,{style:Dt.petBasicInfo,children:n?(0,T.jsxs)(r.default,{style:Dt.editMainContainer,children:[(0,T.jsxs)(r.default,{style:Dt.editHeaderRow,children:[(0,T.jsx)(r.default,{style:Dt.editProfileContainer,children:(0,T.jsxs)(s.default,{style:Dt.profilePhotoButton,onPress:()=>de(t.id),children:[(0,T.jsx)(U.default,{source:o(65460),style:Dt.petPhoto}),(0,T.jsx)(r.default,{style:Dt.plusIconContainer,children:(0,T.jsx)(S.default,{name:"plus-circle",size:20,color:f.theme.colors.primary})})]})}),(0,T.jsxs)(r.default,{style:Dt.editActions,children:[(0,T.jsx)(s.default,{style:Dt.saveButton,onPress:o=>{o.stopPropagation(),Z?(0,p.debugLog)("MBA5555","Save button already clicked, ignoring"):((0,p.debugLog)("MBA5555","SAVE BUTTON - Clicked for pet:",t.id),(async t=>{if(Z)(0,p.debugLog)("MBA5555","SAVE PET - Already saving, ignoring duplicate click");else try{K(!0),(0,p.debugLog)("MBA5555","SAVE PET - Starting save with pets:",e.map((e=>({id:e.id,name:e.name||"unnamed"})))),(0,p.debugLog)("MBA5555","SAVE PET - Saving petId:",t);const a=R[t]||{},n={name:a.name||"",species:a.type||"",breed:a.breed||"",age_years:a.ageYears,age_months:a.ageMonths,weight:a.weight,birthday:a.birthday?ie(a.birthday):null,sex:a.sex,adoption_date:a.adoptionDate?ie(a.adoptionDate):null,pet_description:a.description||"",friendly_with_children:a.childrenFriendly,friendly_with_cats:a.catFriendly,friendly_with_dogs:a.dogFriendly,spayed_neutered:a.spayedNeutered,house_trained:a.houseTrained,microchipped:a.microchipped,feeding_schedule:a.feedingInstructions||"",potty_break_schedule:a.pottyBreakSchedule||"",energy_level:a.energyLevel||"LOW",can_be_left_alone:a.canBeLeftAlone,medication_notes:a.medicalNotes||"",special_care_instructions:a.specialCareInstructions||"",vet_name:a.vetName||"",vet_address:a.vetAddress||"",vet_phone:a.vetPhone||"",insurance_provider:a.insuranceProvider||"",vet_documents:a.vetDocuments||[]};(0,p.debugLog)("MBA5555","SAVE PET - Pet data being sent:",n);const r=String(t).startsWith("temp_");(0,p.debugLog)("MBA5555","SAVE PET - Is this a new pet?",r);let i="";if(r){(0,p.debugLog)("MBA5555","SAVE PET - Creating a new pet with backend API call");try{const e=await(0,at.addPet)(n);if((0,p.debugLog)("MBA5555","SAVE PET - API response from addPet:",e),e&&e.pet&&e.pet.pet_id){const o=e.pet.pet_id,n=Object.assign({},a,e.pet,{id:o,type:e.pet.species||a.type,feedingInstructions:e.pet.feeding_schedule||a.feedingInstructions,medicalNotes:e.pet.medication_notes||a.medicalNotes,pottyBreakSchedule:e.pet.potty_break_schedule||a.pottyBreakSchedule,specialCareInstructions:e.pet.special_care_instructions||a.specialCareInstructions,birthday:e.pet.birthday?se(e.pet.birthday):a.birthday,adoptionDate:e.pet.adoption_date?se(e.pet.adoption_date):a.adoptionDate});(0,p.debugLog)("MBA5555","SAVE PET - Successfully created pet. Old ID:",t,"New ID:",o),je(t,n),i='Pet "'.concat(n.name,'" was successfully created!'),$({message:i,type:"success",duration:3e3}),M((e=>{const o=new Set(e);return o.delete(t),o})),P((e=>{const o=Object.assign({},e);return delete o[t],o})),b((e=>{const a=new Set(e);return a.delete(t),a.add(o),a}))}}catch(o){return(0,p.debugLog)("MBA5555","SAVE PET - API error adding pet:",o),K(!1),void xe("Failed to Create Pet",o)}}else{(0,p.debugLog)("MBA5555","SAVE PET - Updating existing pet:",t);try{const e=await(0,at.updatePet)(t,n);if((0,p.debugLog)("MBA5555","SAVE PET - API response from updatePet:",e),e){const o=Object.assign({},a,e,{id:t,type:e.species||a.type,feedingInstructions:e.feeding_schedule||a.feedingInstructions,medicalNotes:e.medication_notes||a.medicalNotes,pottyBreakSchedule:e.potty_break_schedule||a.pottyBreakSchedule,specialCareInstructions:e.special_care_instructions||a.specialCareInstructions,birthday:e.birthday?se(e.birthday):a.birthday,adoptionDate:e.adoption_date?se(e.adoption_date):a.adoptionDate});d(t,o),i='Pet "'.concat(o.name,'" was successfully updated!'),$({message:i,type:"success",duration:3e3}),M((e=>{const o=new Set(e);return o.delete(t),o})),P((e=>{const o=Object.assign({},e);return delete o[t],o})),(0,p.debugLog)("MBA5555","SAVE PET - Successfully updated pet:",t)}}catch(o){return(0,p.debugLog)("MBA5555","SAVE PET - API error updating pet:",o),xe("Failed to Update Pet",o),void K(!1)}}setTimeout((()=>{K(!1),(0,p.debugLog)("MBA5555","SAVE PET - Final state after all operations:",e.map((e=>({id:e.id,name:e.name||"unnamed"}))))}),100)}catch(a){(0,p.debugLog)("MBA5555","SAVE PET - Unexpected error saving pet:",a),K(!1),xe("Failed to Save Pet",a)}})(t.id))},disabled:Z,children:(0,T.jsx)(i.default,{style:Dt.saveButtonText,children:m?"Create Pet":"Save Pet"})}),(0,T.jsx)(s.default,{style:Dt.editButton,onPress:e=>{var o;e.stopPropagation(),(o=t.id)&&o.toString().startsWith("temp_")&&((0,p.debugLog)("MBA456","Discarding newly added pet:",o),c(o)),M((e=>{const t=new Set(e);return t.delete(o),t})),P((e=>{const t=Object.assign({},e);return delete t[o],t}))},children:(0,T.jsx)(S.default,{name:"close",size:20,color:f.theme.colors.error})}),(0,T.jsx)(s.default,{style:Dt.editButton,onPress:e=>{e.stopPropagation(),re(t.id)},children:(0,T.jsx)(S.default,{name:a?"chevron-up":"chevron-down",size:24,color:f.theme.colors.text})})]})]}),(0,T.jsxs)(r.default,{style:Dt.editDetailsContainer,children:[(0,T.jsxs)(r.default,{style:Dt.detailRow,children:[(0,T.jsxs)(r.default,{style:Dt.detailColumn,children:[(0,T.jsx)(i.default,{style:Dt.inputLabel,children:"Name"}),(0,T.jsx)(q.default,{style:Dt.editInput,value:l.name||"",onChangeText:e=>le(t.id,"name",e),placeholder:"Enter pet name",placeholderTextColor:f.theme.colors.placeholder})]}),(0,T.jsxs)(r.default,{style:Dt.detailColumn,children:[(0,T.jsx)(i.default,{style:Dt.inputLabel,children:"Breed"}),(0,T.jsx)(q.default,{style:Dt.editInput,value:l.breed||"",onChangeText:e=>le(t.id,"breed",e),placeholder:"Enter breed",placeholderTextColor:f.theme.colors.placeholder})]})]}),u?(0,T.jsxs)(r.default,{style:Dt.stackedFields,children:[(0,T.jsxs)(r.default,{style:[Dt.detailColumn,Dt.fullWidth],children:[(0,T.jsx)(i.default,{style:Dt.inputLabel,children:"Animal Type"}),(0,T.jsx)(q.default,{style:Dt.editInput,value:l.type||"",onChangeText:e=>le(t.id,"type",e),placeholder:"Enter type",placeholderTextColor:f.theme.colors.placeholder})]}),(0,T.jsxs)(r.default,{style:[Dt.detailColumn,Dt.fullWidth],children:[(0,T.jsx)(i.default,{style:Dt.inputLabel,children:"Birthday"}),(0,T.jsxs)(r.default,{style:Dt.customDatePickerContainer,children:[(0,T.jsx)(s.default,{activeOpacity:.8,style:Dt.dateInputBox,onPress:()=>he(t.id,"birthday"),children:(0,T.jsx)(i.default,{style:[Dt.dateInputText,!l.birthday&&Dt.placeholderText],children:l.birthday||"MM-DD-YYYY"})}),(0,T.jsx)(s.default,{style:Dt.calendarButton,onPress:()=>he(t.id,"birthday"),activeOpacity:.7,children:(0,T.jsx)(S.default,{name:"calendar",size:20,color:f.theme.colors.primary})})]})]})]}):(0,T.jsxs)(r.default,{style:Dt.detailRow,children:[(0,T.jsxs)(r.default,{style:Dt.detailColumn,children:[(0,T.jsx)(i.default,{style:Dt.inputLabel,children:"Birthday"}),(0,T.jsxs)(r.default,{style:Dt.customDatePickerContainer,children:[(0,T.jsx)(s.default,{activeOpacity:.8,style:Dt.dateInputBox,onPress:()=>he(t.id,"birthday"),children:(0,T.jsx)(i.default,{style:[Dt.dateInputText,!l.birthday&&Dt.placeholderText],children:l.birthday||"MM-DD-YYYY"})}),(0,T.jsx)(s.default,{style:Dt.calendarButton,onPress:()=>he(t.id,"birthday"),activeOpacity:.7,children:(0,T.jsx)(S.default,{name:"calendar",size:20,color:f.theme.colors.primary})})]})]}),(0,T.jsxs)(r.default,{style:Dt.detailColumn,children:[(0,T.jsx)(i.default,{style:Dt.inputLabel,children:"Animal Type"}),(0,T.jsx)(q.default,{style:Dt.editInput,value:l.type||"",onChangeText:e=>le(t.id,"type",e),placeholder:"Enter type",placeholderTextColor:f.theme.colors.placeholder})]})]})]})]}):(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(U.default,{source:o(65460),style:Dt.petPhoto}),(0,T.jsxs)(r.default,{style:Dt.petInfo,children:[(0,T.jsx)(i.default,{style:Dt.petName,children:g}),(0,T.jsx)(r.default,{style:Dt.petDetailsContainer,children:(0,T.jsxs)(i.default,{style:Dt.petDetails,children:[h||"No breed"," \u2022 ",j," \u2022 ",x||"No type"]})})]})]})}),(0,T.jsx)(r.default,{style:Dt.petActions,children:n?null:(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(s.default,{style:Dt.editButton,onPress:()=>(t=>{const o=e.find((e=>e.id===t));P((e=>Object.assign({},e,{[t]:Object.assign({},o)}))),M((e=>{const o=new Set(e);return o.add(t),o}))})(t.id),children:(0,T.jsx)(S.default,{name:"pencil",size:20,color:f.theme.colors.primary})}),(0,T.jsx)(s.default,{style:Dt.editButton,onPress:()=>re(t.id),children:(0,T.jsx)(S.default,{name:a?"chevron-up":"chevron-down",size:24,color:f.theme.colors.text})})]})})]}),a&&(0,T.jsxs)(r.default,{style:[Dt.expandedDetails,{backgroundColor:f.theme.colors.surfaceContrast}],children:[(0,T.jsxs)(r.default,{style:Dt.detailRow,children:[(0,T.jsxs)(r.default,{style:Dt.detailColumn,children:[(0,T.jsx)(i.default,{style:Dt.detailTitle,children:"Feeding Instructions"}),n?(0,T.jsx)(q.default,{style:Dt.editInput,value:l.feedingInstructions||"",onChangeText:e=>le(t.id,"feedingInstructions",e),placeholder:"Enter feeding instructions",placeholderTextColor:f.theme.colors.placeholder,multiline:!0}):(0,T.jsx)(i.default,{style:Dt.detailText,children:t.feedingInstructions||"2 cups of dry food twice daily (morning/evening)"})]}),(0,T.jsxs)(r.default,{style:Dt.detailColumn,children:[(0,T.jsx)(i.default,{style:Dt.detailTitle,children:"Medical Notes"}),n?(0,T.jsx)(q.default,{style:Dt.editInput,value:l.medicalNotes||"",onChangeText:e=>le(t.id,"medicalNotes",e),placeholder:"Enter medical notes",placeholderTextColor:f.theme.colors.placeholder,multiline:!0}):(0,T.jsx)(i.default,{style:Dt.detailText,children:t.medicalNotes||"Hip dysplasia, daily joint supplement in AM meal"})]})]}),(0,T.jsxs)(r.default,{style:Dt.detailRow,children:[(0,T.jsxs)(r.default,{style:Dt.detailColumn,children:[(0,T.jsx)(i.default,{style:Dt.detailTitle,children:"Potty Break Schedule"}),n?(0,T.jsx)(q.default,{style:Dt.editInput,value:l.pottyBreakSchedule||"",onChangeText:e=>le(t.id,"pottyBreakSchedule",e),placeholder:"Enter potty break schedule",placeholderTextColor:f.theme.colors.placeholder,multiline:!0}):(0,T.jsx)(i.default,{style:Dt.detailText,children:t.pottyBreakSchedule||"15 minutes after each meal"})]}),(0,T.jsxs)(r.default,{style:Dt.detailColumn,children:[(0,T.jsx)(i.default,{style:Dt.detailTitle,children:"Special Care Instructions"}),n?(0,T.jsx)(q.default,{style:Dt.editInput,value:l.specialCareInstructions||"",onChangeText:e=>le(t.id,"specialCareInstructions",e),placeholder:"Enter special care instructions",placeholderTextColor:f.theme.colors.placeholder,multiline:!0}):(0,T.jsx)(i.default,{style:Dt.detailText,children:t.specialCareInstructions||"Don't touch his butt, he will eat your ass"})]})]}),(0,T.jsxs)(r.default,{style:Dt.detailSection,children:[me(t.id,"Care Information","careInfo"),ue(t.id,"careInfo")&&(0,T.jsx)(r.default,{style:Dt.detailColumn,children:(0,T.jsxs)(r.default,{style:Dt.careInfoContainer,children:[(0,T.jsxs)(r.default,{style:Dt.compatibilityItem,children:[(0,T.jsx)(i.default,{style:Dt.compatibilityLabel,children:"Energy level:"}),n?(0,T.jsx)(r.default,{style:Dt.dropdownContainerEdit,children:te.map((e=>(0,T.jsx)(s.default,{style:[Dt.optionButton,null===l.energyLevel&&"N/A"===e||l.energyLevel===e?Dt.selectedOption:null],onPress:()=>le(t.id,"energyLevel","N/A"===e?null:e),children:(0,T.jsx)(i.default,{style:[Dt.optionText,null===l.energyLevel&&"N/A"===e||l.energyLevel===e?Dt.selectedOptionText:null],children:e})},e)))}):ne(t)]}),(0,T.jsxs)(r.default,{style:Dt.compatibilityItem,children:[(0,T.jsx)(i.default,{style:Dt.compatibilityLabel,children:"Weight (lbs):"}),n?(0,T.jsx)(q.default,{style:Dt.editInputWeight,value:l.weight||"",onChangeText:e=>{(/^(\d*\.?\d*)$/.test(e)||""===e)&&le(t.id,"weight",e)},placeholder:"Enter weight",placeholderTextColor:f.theme.colors.placeholder,keyboardType:"numeric"}):(0,T.jsx)(i.default,{style:Dt.vetInfoText,children:t.weight||"Not specified"})]}),(0,T.jsxs)(r.default,{style:Dt.medicationsContainer,children:[(0,T.jsx)(i.default,{style:Dt.compatibilityLabel,children:"Medications:"}),n?(0,T.jsx)(q.default,{style:Dt.editInputMedications,value:"string"===typeof l.medications?l.medications:"",onChangeText:e=>le(t.id,"medications",e),placeholder:"Enter medications",placeholderTextColor:f.theme.colors.placeholder,multiline:!0}):(0,T.jsx)(i.default,{style:Dt.medicationsText,children:"string"===typeof t.medications?t.medications:null===t.medications||"object"===typeof t.medications?"None":String(t.medications)})]})]})})]}),(0,T.jsxs)(r.default,{style:Dt.detailSection,children:[me(t.id,"Compatibility & Training","compatibility"),ue(t.id,"compatibility")&&(0,T.jsx)(r.default,{style:Dt.detailColumn,children:(0,T.jsxs)(r.default,{style:Dt.compatibilityContainer,children:[(0,T.jsxs)(r.default,{style:Dt.compatibilityItem,children:[(0,T.jsx)(i.default,{style:Dt.compatibilityLabel,children:"Friendly with children:"}),n?(0,T.jsx)(r.default,{style:Dt.dropdownContainerEdit,children:ee.map((e=>(0,T.jsx)(s.default,{style:[Dt.optionButton,null===l.childrenFriendly&&"N/A"===e||l.childrenFriendly===e?Dt.selectedOption:null],onPress:()=>le(t.id,"childrenFriendly","N/A"===e?null:e),children:(0,T.jsx)(i.default,{style:[Dt.optionText,null===l.childrenFriendly&&"N/A"===e||l.childrenFriendly===e?Dt.selectedOptionText:null],children:e})},e)))}):ae(t,"childrenFriendly")]}),(0,T.jsxs)(r.default,{style:Dt.compatibilityItem,children:[(0,T.jsx)(i.default,{style:Dt.compatibilityLabel,children:"Friendly with cats:"}),n?(0,T.jsx)(r.default,{style:Dt.dropdownContainerEdit,children:ee.map((e=>(0,T.jsx)(s.default,{style:[Dt.optionButton,null===l.catFriendly&&"N/A"===e||l.catFriendly===e?Dt.selectedOption:null],onPress:()=>le(t.id,"catFriendly","N/A"===e?null:e),children:(0,T.jsx)(i.default,{style:[Dt.optionText,null===l.catFriendly&&"N/A"===e||l.catFriendly===e?Dt.selectedOptionText:null],children:e})},e)))}):ae(t,"catFriendly")]}),(0,T.jsxs)(r.default,{style:Dt.compatibilityItem,children:[(0,T.jsx)(i.default,{style:Dt.compatibilityLabel,children:"Friendly with dogs:"}),n?(0,T.jsx)(r.default,{style:Dt.dropdownContainerEdit,children:ee.map((e=>(0,T.jsx)(s.default,{style:[Dt.optionButton,null===l.dogFriendly&&"N/A"===e||l.dogFriendly===e?Dt.selectedOption:null],onPress:()=>le(t.id,"dogFriendly","N/A"===e?null:e),children:(0,T.jsx)(i.default,{style:[Dt.optionText,null===l.dogFriendly&&"N/A"===e||l.dogFriendly===e?Dt.selectedOptionText:null],children:e})},e)))}):ae(t,"dogFriendly")]}),(0,T.jsxs)(r.default,{style:Dt.compatibilityItem,children:[(0,T.jsx)(i.default,{style:Dt.compatibilityLabel,children:"Spayed/neutered:"}),n?(0,T.jsx)(r.default,{style:Dt.dropdownContainerEdit,children:ee.map((e=>(0,T.jsx)(s.default,{style:[Dt.optionButton,null===l.spayedNeutered&&"N/A"===e||l.spayedNeutered===e?Dt.selectedOption:null],onPress:()=>le(t.id,"spayedNeutered","N/A"===e?null:e),children:(0,T.jsx)(i.default,{style:[Dt.optionText,null===l.spayedNeutered&&"N/A"===e||l.spayedNeutered===e?Dt.selectedOptionText:null],children:e})},e)))}):ae(t,"spayedNeutered")]}),(0,T.jsxs)(r.default,{style:Dt.compatibilityItem,children:[(0,T.jsx)(i.default,{style:Dt.compatibilityLabel,children:"House trained:"}),n?(0,T.jsx)(r.default,{style:Dt.dropdownContainerEdit,children:ee.map((e=>(0,T.jsx)(s.default,{style:[Dt.optionButton,null===l.houseTrained&&"N/A"===e||l.houseTrained===e?Dt.selectedOption:null],onPress:()=>le(t.id,"houseTrained","N/A"===e?null:e),children:(0,T.jsx)(i.default,{style:[Dt.optionText,null===l.houseTrained&&"N/A"===e||l.houseTrained===e?Dt.selectedOptionText:null],children:e})},e)))}):ae(t,"houseTrained")]}),(0,T.jsxs)(r.default,{style:Dt.compatibilityItem,children:[(0,T.jsx)(i.default,{style:Dt.compatibilityLabel,children:"Microchipped:"}),n?(0,T.jsx)(r.default,{style:Dt.dropdownContainerEdit,children:ee.map((e=>(0,T.jsx)(s.default,{style:[Dt.optionButton,null===l.microchipped&&"N/A"===e||l.microchipped===e?Dt.selectedOption:null],onPress:()=>le(t.id,"microchipped","N/A"===e?null:e),children:(0,T.jsx)(i.default,{style:[Dt.optionText,null===l.microchipped&&"N/A"===e||l.microchipped===e?Dt.selectedOptionText:null],children:e})},e)))}):ae(t,"microchipped")]}),(0,T.jsxs)(r.default,{style:Dt.compatibilityItem,children:[(0,T.jsx)(i.default,{style:Dt.compatibilityLabel,children:"Can be left alone:"}),n?(0,T.jsx)(r.default,{style:Dt.dropdownContainerEdit,children:ee.map((e=>(0,T.jsx)(s.default,{style:[Dt.optionButton,null===l.canBeLeftAlone&&"N/A"===e||l.canBeLeftAlone===e?Dt.selectedOption:null],onPress:()=>le(t.id,"canBeLeftAlone","N/A"===e?null:e),children:(0,T.jsx)(i.default,{style:[Dt.optionText,null===l.canBeLeftAlone&&"N/A"===e||l.canBeLeftAlone===e?Dt.selectedOptionText:null],children:e})},e)))}):ae(t,"canBeLeftAlone")]})]})})]}),(0,T.jsxs)(r.default,{style:Dt.detailSection,children:[me(t.id,"Vet Information","vetInfo"),ue(t.id,"vetInfo")&&(0,T.jsx)(r.default,{style:Dt.detailColumn,children:(0,T.jsxs)(r.default,{style:Dt.vetInfoContainer,children:[(0,T.jsxs)(r.default,{style:Dt.vetInfoItem,children:[(0,T.jsx)(i.default,{style:Dt.vetInfoLabel,children:"Vet name:"}),n?(0,T.jsx)(q.default,{style:Dt.editInputShort,value:l.vetName||"",onChangeText:e=>le(t.id,"vetName",e),placeholder:"Enter vet name",placeholderTextColor:f.theme.colors.placeholder}):(0,T.jsx)(i.default,{style:Dt.vetInfoText,children:t.vetName||"None"})]}),(0,T.jsxs)(r.default,{style:Dt.vetInfoItem,children:[(0,T.jsx)(i.default,{style:Dt.vetInfoLabel,children:"Vet address:"}),n?(0,T.jsx)(q.default,{style:Dt.editInputShort,value:l.vetAddress||"",onChangeText:e=>le(t.id,"vetAddress",e),placeholder:"Enter vet address",placeholderTextColor:f.theme.colors.placeholder}):(0,T.jsx)(i.default,{style:Dt.vetInfoText,children:t.vetAddress||"None"})]}),(0,T.jsxs)(r.default,{style:Dt.vetInfoItem,children:[(0,T.jsx)(i.default,{style:Dt.vetInfoLabel,children:"Vet phone:"}),n?(0,T.jsx)(q.default,{style:Dt.editInputShort,value:l.vetPhone||"",onChangeText:e=>le(t.id,"vetPhone",e),placeholder:"Enter vet phone",placeholderTextColor:f.theme.colors.placeholder,keyboardType:"phone-pad"}):(0,T.jsx)(i.default,{style:Dt.vetInfoText,children:t.vetPhone||"None"})]}),(0,T.jsxs)(r.default,{style:Dt.vetInfoItem,children:[(0,T.jsx)(i.default,{style:Dt.vetInfoLabel,children:"Insurance provider:"}),n?(0,T.jsx)(q.default,{style:Dt.editInputShort,value:l.insuranceProvider||"",onChangeText:e=>le(t.id,"insuranceProvider",e),placeholder:"Enter insurance provider",placeholderTextColor:f.theme.colors.placeholder}):(0,T.jsx)(i.default,{style:Dt.vetInfoText,children:t.insuranceProvider||"Not specified"})]}),(0,T.jsxs)(r.default,{style:Dt.vetInfoItem,children:[(0,T.jsx)(i.default,{style:Dt.vetInfoLabel,children:"Sex:"}),n?(0,T.jsx)(r.default,{style:Dt.dropdownContainerEdit,children:oe.map((e=>(0,T.jsx)(s.default,{style:[Dt.optionButton,l.sex===e?Dt.selectedOption:null],onPress:()=>le(t.id,"sex",e),children:(0,T.jsx)(i.default,{style:[Dt.optionText,l.sex===e?Dt.selectedOptionText:null],children:e})},e)))}):(0,T.jsx)(i.default,{style:Dt.vetInfoText,children:t.sex||"None Selected"})]}),(0,T.jsxs)(r.default,{style:Dt.vetInfoItem,children:[(0,T.jsx)(i.default,{style:Dt.vetInfoLabel,children:"Adoption Date:"}),n?(0,T.jsxs)(r.default,{style:Dt.customDatePickerContainer,children:[(0,T.jsx)(s.default,{activeOpacity:.8,style:Dt.dateInputBox,onPress:()=>he(t.id,"adoptionDate"),children:(0,T.jsx)(i.default,{style:[Dt.dateInputText,!l.adoptionDate&&Dt.placeholderText],children:l.adoptionDate||"MM-DD-YYYY"})}),(0,T.jsx)(s.default,{style:Dt.calendarButton,onPress:()=>he(t.id,"adoptionDate"),activeOpacity:.7,children:(0,T.jsx)(S.default,{name:"calendar",size:20,color:f.theme.colors.primary})})]}):(0,T.jsx)(i.default,{style:Dt.vetInfoText,children:t.adoptionDate||"Not specified"})]}),(0,T.jsxs)(r.default,{style:Dt.vetInfoItem,children:[(0,T.jsx)(i.default,{style:Dt.vetInfoLabel,children:"Vet documents:"}),n?(0,T.jsxs)(r.default,{style:Dt.documentActionContainer,children:[(0,T.jsxs)(s.default,{style:Dt.uploadButton,onPress:()=>de(t.id),children:[(0,T.jsx)(S.default,{name:"upload",size:16,color:f.theme.colors.background}),(0,T.jsx)(i.default,{style:Dt.uploadButtonText,children:"Upload"})]}),ce(l.vetDocuments)]}):(0,T.jsxs)(s.default,{style:Dt.documentButton,children:[(0,T.jsx)(S.default,{name:"file-document-outline",size:16,color:f.theme.colors.primary}),(0,T.jsx)(i.default,{style:Dt.documentButtonText,children:"View documents"})]})]})]})})]})]})]},t.id)}catch(a){return console.error("Error rendering pet card: "+(a.message||"Unknown error")),null}}))})]})]})};var Rt=o(90932);const Pt=({plan:e,isPopular:t,isCurrent:o,onSwitch:a})=>(0,T.jsxs)(r.default,{style:[zt.planCard,o&&zt.currentPlanBorder],children:[t&&(0,T.jsx)(r.default,{style:zt.popularTag,children:(0,T.jsx)(i.default,{style:zt.popularTagText,children:"Popular"})}),(0,T.jsx)(i.default,{style:zt.planTitle,children:e.title}),(0,T.jsx)(i.default,{style:zt.planPrice,children:e.price}),(0,T.jsx)(i.default,{style:zt.planDescription,children:e.description}),(0,T.jsx)(r.default,{style:zt.featuresList,children:e.features.map(((e,t)=>(0,T.jsxs)(r.default,{style:zt.featureItem,children:[(0,T.jsx)(S.default,{name:"check",size:20,color:f.theme.colors.primary}),(0,T.jsx)(i.default,{style:zt.featureText,children:e})]},t)))}),(0,T.jsx)(s.default,{style:[zt.planButton,o&&zt.currentPlanButton],onPress:()=>!o&&a(e.id),children:(0,T.jsx)(i.default,{style:[zt.planButtonText,o&&zt.currentPlanButtonText],children:o?"Current Plan":"Switch Plan"})})]}),zt=l.default.create({desktopContainer:{flexDirection:"row",gap:24},leftColumn:{flex:1,gap:24},rightColumn:{width:"35%",minWidth:300,gap:24},mobileContainer:{flex:1},section:{backgroundColor:f.theme.colors.surfaceContrast,borderRadius:10,padding:20,marginBottom:15},sectionHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:15},sectionTitle:{fontSize:18,fontWeight:"bold",color:f.theme.colors.text,marginBottom:15},plansScroll:{marginHorizontal:-20},plansScrollContent:{paddingHorizontal:20,paddingBottom:16},planCardContainer:{width:280,marginRight:16,paddingBottom:4},planCard:{backgroundColor:f.theme.colors.surface,borderRadius:10,padding:20,position:"relative",marginTop:12,height:"100%",borderWidth:0},currentPlanBorder:{borderWidth:2,borderColor:f.theme.colors.primary},popularPlan:{},popularTag:{position:"absolute",top:-12,right:20,backgroundColor:f.theme.colors.primary,paddingHorizontal:12,paddingVertical:4,borderRadius:12,zIndex:2},popularTagText:{color:f.theme.colors.surfaceContrast,fontWeight:"600",fontSize:12},planTitle:{fontSize:20,fontWeight:"bold",marginBottom:10},planPrice:{fontSize:24,fontWeight:"600",color:f.theme.colors.primary,marginBottom:5},planDescription:{color:f.theme.colors.secondary,marginBottom:15},featuresList:{gap:10,marginBottom:20},featureItem:{flexDirection:"row",alignItems:"center",gap:10},featureText:{color:f.theme.colors.text},planButton:{backgroundColor:f.theme.colors.primary,padding:12,borderRadius:8,alignItems:"center",marginTop:"auto",marginBottom:0},currentPlanButton:{backgroundColor:f.theme.colors.surface,borderWidth:1,borderColor:f.theme.colors.primary},planButtonText:{color:f.theme.colors.surfaceContrast,fontWeight:"600"},currentPlanButtonText:{color:f.theme.colors.primary},settingItem:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingVertical:12,borderBottomWidth:1,borderBottomColor:f.theme.colors.placeHolderText},settingContent:{flexDirection:"row",alignItems:"center",flex:1},settingTextContainer:{marginLeft:15,flex:1},settingTitle:{fontSize:16,fontWeight:"500"},settingDescription:{fontSize:14,color:f.theme.colors.secondary,marginTop:2},actionButton:{backgroundColor:f.theme.colors.surface,paddingHorizontal:12,paddingVertical:6,borderRadius:6},actionButtonText:{color:f.theme.colors.primary,fontWeight:"500"},currentPlanInfo:{backgroundColor:f.theme.colors.surface,padding:15,borderRadius:8},currentPlanTitle:{fontSize:20,fontWeight:"600",marginBottom:5},currentPlanBilling:{color:f.theme.colors.secondary,marginBottom:15},usageStats:{gap:8},usageText:{fontSize:14,color:f.theme.colors.text},usageBar:{height:8,backgroundColor:f.theme.colors.background,borderRadius:4},usageProgress:{height:"100%",backgroundColor:f.theme.colors.primary,borderRadius:4},paymentItem:{flexDirection:"row",alignItems:"flex-start",justifyContent:"space-between",padding:12,backgroundColor:f.theme.colors.surface,borderRadius:8,marginBottom:10},paymentContent:{flexDirection:"row",alignItems:"flex-start",flex:1,marginRight:12},paymentTextContainer:{marginLeft:15,flex:1},paymentTitleRow:{flexDirection:"row",alignItems:"center",flexWrap:"wrap",gap:8},paymentTitle:{fontSize:16,fontWeight:"500"},paymentDescription:{fontSize:14,color:f.theme.colors.secondary,marginTop:2},setDefaultButton:{paddingHorizontal:8,paddingVertical:2,borderRadius:4},setDefaultText:{color:f.theme.colors.primary,fontSize:14,fontWeight:"500"},deleteButton:{padding:4},addButton:{flexDirection:"row",alignItems:"center",backgroundColor:f.theme.colors.primary,padding:8,borderRadius:5},addButtonText:{color:f.theme.colors.surfaceContrast,marginLeft:5,fontWeight:"500"},viewAllButton:{padding:12,borderRadius:8,backgroundColor:f.theme.colors.surface,alignItems:"center"},viewAllText:{color:f.theme.colors.primary,fontWeight:"500"},modalOverlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center"},modalContent:{backgroundColor:f.theme.colors.background,borderRadius:10,width:"90%",maxWidth:500,maxHeight:"80%",padding:20},modalHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:15,paddingBottom:10,borderBottomWidth:1,borderBottomColor:f.theme.colors.border},modalTitle:{fontSize:18,fontWeight:"bold",color:f.theme.colors.text},timezoneItem:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingVertical:12,paddingHorizontal:15,borderBottomWidth:1,borderBottomColor:f.theme.colors.border},selectedTimezoneItem:{backgroundColor:f.theme.colors.primaryLight},timezoneText:{fontSize:16,color:f.theme.colors.text},selectedTimezoneText:{fontWeight:"bold",color:f.theme.colors.primary},timezoneButton:{flexDirection:"row",alignItems:"center",backgroundColor:f.theme.colors.surface,paddingHorizontal:12,paddingVertical:6,borderRadius:6},timezoneButtonText:{color:f.theme.colors.primary,fontWeight:"500",marginRight:5},noPaymentMethodsContainer:{padding:20,alignItems:"center",backgroundColor:f.theme.colors.surface,borderRadius:8},noPaymentMethodsText:{color:f.theme.colors.secondary,fontSize:16}}),Ft=({push_notifications:e,email_updates:t,marketing_communications:o,profile_visibility:n,timezone:l,use_military_time:d,onUpdateSetting:c,paymentMethods:u,onAddPaymentMethod:m,onRemovePaymentMethod:g,onSetDefaultPayment:h,isMobile:y,currentPlan:b={id:"waitlist",title:"Waitlist Signup",nextBilling:"N/A",connections:{used:0,total:"Unlimited"}},onSwitchPlan:x,userRole:j,isApprovedProfessional:w})=>{const[C,v]=(0,a.useState)(l||"UTC"),[B,k]=(0,a.useState)(!1),[A,I]=(0,a.useState)([]),[D,M]=(0,a.useState)(!1),R=E();(0,a.useEffect)((()=>{l?v(l):(async()=>{try{M(!0);const e=await(0,at.getTimeSettings)();v(e.timezone),(0,p.debugLog)("MBA12345 Fetched time settings:",e)}catch(e){(0,p.debugLog)("MBA12345 Error fetching time settings:",e)}finally{M(!1)}})()}),[l]),(0,a.useEffect)((()=>{(0,p.debugLog)("MBA54321 SettingsPaymentsTab received paymentMethods:",u)}),[u]);const P=()=>{I(["America/New_York","America/Chicago","America/Denver","America/Los_Angeles","America/Anchorage","America/Adak","Pacific/Honolulu","America/Phoenix","America/Boise","America/Detroit","America/Indiana/Indianapolis","America/Indiana/Knox","America/Indiana/Marengo","America/Indiana/Petersburg","America/Indiana/Tell_City","America/Indiana/Vevay","America/Indiana/Vincennes","America/Indiana/Winamac","America/Kentucky/Louisville","America/Kentucky/Monticello","America/Menominee","America/North_Dakota/Beulah","America/North_Dakota/Center","America/North_Dakota/New_Salem","America/Sitka","America/Yakutat","Europe/London","Europe/Paris","Europe/Berlin","Europe/Moscow","Asia/Tokyo","Asia/Shanghai","Asia/Dubai","Australia/Sydney","Pacific/Auckland","UTC"]),k(!0)},z=()=>{const e=[{id:"free",title:"Free Tier",price:"Free",description:"1 Free Booking/Month, then 15% per booking",features:["Basic profile listing","Up to 1 booking/month","Standard support"],isPopular:!1},{id:"waitlist",title:"Waitlist Tier",price:"Free",description:"No commissions, no subscriptions, no fees",features:["Early signup discounts","Waitlist for early access","Unlimited connections","Priority support"],isPopular:!1}];return"professional"===j?[...e,{id:"subscription",title:"Pro Subscription",price:"$29.99/month",description:"No fees as pro",features:["Unlimited connections","Priority support","Advanced analytics","No commission fees"],isPopular:!0},{id:"dual_subscription",title:"Dual Role Subscription",price:"$39.99/month",description:"No fees as pro or owner",features:["Unlimited connections","Priority support","Advanced analytics","No commission fees","Use as both pro and owner"],isPopular:!1}]:[...e,{id:"subscription",title:"Owner Subscription",price:"$19.99/month",description:"Unlimited bookings",features:["Unlimited connections","Priority support","Advanced analytics"],isPopular:!0}]},F=()=>(0,T.jsxs)(r.default,{style:zt.section,children:[(0,T.jsx)(i.default,{style:zt.sectionTitle,children:"Subscription Plans"}),(0,T.jsx)(H.default,{horizontal:!0,showsHorizontalScrollIndicator:!0,style:zt.plansScroll,contentContainerStyle:zt.plansScrollContent,children:z().map((e=>(0,T.jsx)(r.default,{style:zt.planCardContainer,children:(0,T.jsx)(Pt,{plan:e,isPopular:e.isPopular,isCurrent:b?.id===e.id,onSwitch:x})},e.id)))})]}),L=()=>(0,T.jsxs)(r.default,{style:zt.section,children:[(0,T.jsxs)(r.default,{style:zt.sectionHeader,children:[(0,T.jsx)(i.default,{style:zt.sectionTitle,children:"professional"===j?"Payout Methods":"Payment Methods"}),(0,T.jsxs)(s.default,{style:zt.addButton,onPress:m,children:[(0,T.jsx)(S.default,{name:"plus",size:20,color:f.theme.colors.background}),(0,T.jsx)(i.default,{style:zt.addButtonText,children:"Add New"})]})]}),u&&u.length>0?u.map(N):(0,T.jsx)(r.default,{style:zt.noPaymentMethodsContainer,children:(0,T.jsx)(i.default,{style:zt.noPaymentMethodsText,children:"No payment methods added yet"})})]}),O=()=>(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)(r.default,{style:zt.settingItem,children:[(0,T.jsxs)(r.default,{style:zt.settingContent,children:[(0,T.jsx)(S.default,{name:"bell",size:24,color:f.theme.colors.primary}),(0,T.jsxs)(r.default,{style:zt.settingTextContainer,children:[(0,T.jsx)(i.default,{style:zt.settingTitle,children:"Push Notifications"}),(0,T.jsx)(i.default,{style:zt.settingDescription,children:"Receive push notifications for updates"})]})]}),(0,T.jsx)($e.default,{value:e,onValueChange:e=>U("push_notifications",e),trackColor:{false:f.theme.colors.disabled,true:f.theme.colors.primary}})]}),(0,T.jsxs)(r.default,{style:zt.settingItem,children:[(0,T.jsxs)(r.default,{style:zt.settingContent,children:[(0,T.jsx)(S.default,{name:"email",size:24,color:f.theme.colors.primary}),(0,T.jsxs)(r.default,{style:zt.settingTextContainer,children:[(0,T.jsx)(i.default,{style:zt.settingTitle,children:"Email Updates"}),(0,T.jsx)(i.default,{style:zt.settingDescription,children:"Receive important updates via email"})]})]}),(0,T.jsx)($e.default,{value:t,onValueChange:e=>U("email_updates",e),trackColor:{false:f.theme.colors.disabled,true:f.theme.colors.primary}})]}),(0,T.jsxs)(r.default,{style:zt.settingItem,children:[(0,T.jsxs)(r.default,{style:zt.settingContent,children:[(0,T.jsx)(S.default,{name:"bell-outline",size:24,color:f.theme.colors.primary}),(0,T.jsxs)(r.default,{style:zt.settingTextContainer,children:[(0,T.jsx)(i.default,{style:zt.settingTitle,children:"Marketing Communications"}),(0,T.jsx)(i.default,{style:zt.settingDescription,children:"Receive promotions and marketing emails"})]})]}),(0,T.jsx)($e.default,{value:o,onValueChange:e=>U("marketing_communications",e),trackColor:{false:f.theme.colors.disabled,true:f.theme.colors.primary}})]})]}),W=()=>(0,T.jsx)(T.Fragment,{children:(0,T.jsxs)(r.default,{style:zt.settingItem,children:[(0,T.jsxs)(r.default,{style:zt.settingContent,children:[(0,T.jsx)(S.default,{name:"account-eye",size:24,color:f.theme.colors.primary}),(0,T.jsxs)(r.default,{style:zt.settingTextContainer,children:[(0,T.jsx)(i.default,{style:zt.settingTitle,children:"Profile Visibility"}),(0,T.jsx)(i.default,{style:zt.settingDescription,children:"Make your profile visible to others"})]})]}),(0,T.jsx)($e.default,{value:n,onValueChange:e=>U("profile_visibility",e),trackColor:{false:f.theme.colors.disabled,true:f.theme.colors.primary}})]})}),N=e=>(0,T.jsxs)(r.default,{style:zt.paymentItem,children:[(0,T.jsxs)(r.default,{style:zt.paymentContent,children:[(0,T.jsx)(S.default,{name:"card"===e.type?"credit-card":"bank",size:24,color:f.theme.colors.primary}),(0,T.jsxs)(r.default,{style:zt.paymentTextContainer,children:[(0,T.jsxs)(r.default,{style:zt.paymentTitleRow,children:[(0,T.jsx)(i.default,{style:zt.paymentTitle,children:"card"===e.type?"\u2022\u2022\u2022\u2022 ".concat(e.last4):e.bankName}),!e.isDefault&&(0,T.jsx)(s.default,{style:zt.setDefaultButton,onPress:()=>h(e.id),children:(0,T.jsx)(i.default,{style:zt.setDefaultText,children:"Set Default"})})]}),(0,T.jsx)(i.default,{style:zt.paymentDescription,numberOfLines:1,children:"card"===e.type?"Expires ".concat(e.expiry):"Account ending in ".concat(e.last4)})]})]}),(0,T.jsx)(s.default,{style:zt.deleteButton,onPress:()=>g(e.id),children:(0,T.jsx)(S.default,{name:"delete",size:20,color:f.theme.colors.error})})]},e.id),U=(e,t)=>{(0,p.debugLog)("MBA54321 Updating setting:",{id:e,value:t});const o={push_notifications:"Push Notifications",email_updates:"Email Updates",marketing_communications:"Marketing Communications",profile_visibility:"Profile Visibility",use_military_time:"Military Time"}[e]||e;c(e,t).then((()=>{R({message:"".concat(o," ").concat(t?"enabled":"disabled"," successfully"),type:"success",duration:3e3})})).catch((e=>{(0,p.debugLog)("MBA54321 Error updating setting:",e),R({message:"Failed to update ".concat(o.toLowerCase(),". Please try again."),type:"error",duration:4e3})}))};return(0,T.jsxs)(r.default,{style:zt.container,children:[y?(0,T.jsxs)(H.default,{style:zt.mobileContainer,children:[F(),L(),(0,T.jsxs)(r.default,{style:zt.section,children:[(0,T.jsx)(i.default,{style:zt.sectionTitle,children:"Notification Settings"}),O()]}),(0,T.jsxs)(r.default,{style:zt.section,children:[(0,T.jsx)(i.default,{style:zt.sectionTitle,children:"Privacy Settings"}),W()]}),(0,T.jsxs)(r.default,{style:zt.section,children:[(0,T.jsx)(i.default,{style:zt.sectionTitle,children:"Time Settings"}),(0,T.jsxs)(r.default,{style:zt.settingItem,children:[(0,T.jsxs)(r.default,{style:zt.settingContent,children:[(0,T.jsx)(S.default,{name:"clock-outline",size:24,color:f.theme.colors.primary}),(0,T.jsxs)(r.default,{style:zt.settingTextContainer,children:[(0,T.jsx)(i.default,{style:zt.settingTitle,children:"Timezone"}),(0,T.jsx)(i.default,{style:zt.settingDescription,children:"Set your local timezone for accurate time display"})]})]}),(0,T.jsxs)(s.default,{style:zt.timezoneButton,onPress:P,children:[(0,T.jsx)(i.default,{style:zt.timezoneButtonText,children:C}),(0,T.jsx)(S.default,{name:"chevron-down",size:20,color:f.theme.colors.primary})]})]})]})]}):(0,T.jsxs)(r.default,{style:zt.desktopContainer,children:[(0,T.jsxs)(r.default,{style:zt.leftColumn,children:[F(),(0,T.jsxs)(r.default,{style:zt.section,children:[(0,T.jsx)(i.default,{style:zt.sectionTitle,children:"Notification Preferences"}),O()]}),(0,T.jsxs)(r.default,{style:zt.section,children:[(0,T.jsx)(i.default,{style:zt.sectionTitle,children:"Privacy Settings"}),W()]}),(0,T.jsxs)(r.default,{style:zt.section,children:[(0,T.jsx)(i.default,{style:zt.sectionTitle,children:"Time Settings"}),(0,T.jsxs)(r.default,{style:zt.settingItem,children:[(0,T.jsxs)(r.default,{style:zt.settingContent,children:[(0,T.jsx)(S.default,{name:"clock-outline",size:24,color:f.theme.colors.primary}),(0,T.jsxs)(r.default,{style:zt.settingTextContainer,children:[(0,T.jsx)(i.default,{style:zt.settingTitle,children:"Timezone"}),(0,T.jsx)(i.default,{style:zt.settingDescription,children:"Set your local timezone for accurate time display"})]})]}),(0,T.jsxs)(s.default,{style:zt.timezoneButton,onPress:P,children:[(0,T.jsx)(i.default,{style:zt.timezoneButtonText,children:C}),(0,T.jsx)(S.default,{name:"chevron-down",size:20,color:f.theme.colors.primary})]})]})]})]}),(0,T.jsxs)(r.default,{style:zt.rightColumn,children:[(0,T.jsxs)(r.default,{style:zt.section,children:[(0,T.jsx)(i.default,{style:zt.sectionTitle,children:"Current Plan"}),(0,T.jsxs)(r.default,{style:zt.currentPlanInfo,children:[(0,T.jsx)(i.default,{style:zt.currentPlanTitle,children:b?.title||"Waitlist Signup"}),(0,T.jsxs)(i.default,{style:zt.currentPlanBilling,children:["Next billing date: ",b?.nextBilling||"N/A"]}),(0,T.jsxs)(r.default,{style:zt.usageStats,children:[(0,T.jsx)(i.default,{style:zt.usageText,children:"waitlist"===b?.id?"Unlimited connections available":"".concat(b?.connections?.used||0," of ").concat(b?.connections?.total||"Unlimited"," connections used")}),"waitlist"!==b?.id&&(0,T.jsx)(r.default,{style:zt.usageBar,children:(0,T.jsx)(r.default,{style:[zt.usageProgress,{width:"".concat(b?.connections?.used/b?.connections?.total*100||0,"%")}]})})]})]})]}),L(),(0,T.jsxs)(r.default,{style:zt.section,children:[(0,T.jsx)(i.default,{style:zt.sectionTitle,children:"Billing History"}),(0,T.jsx)(s.default,{style:zt.viewAllButton,children:(0,T.jsx)(i.default,{style:zt.viewAllText,children:"View All Transactions"})})]})]})]}),(0,T.jsx)(_.default,{animationType:"slide",transparent:!0,visible:B,onRequestClose:()=>k(!1),children:(0,T.jsx)(r.default,{style:zt.modalOverlay,children:(0,T.jsxs)(r.default,{style:zt.modalContent,children:[(0,T.jsxs)(r.default,{style:zt.modalHeader,children:[(0,T.jsx)(i.default,{style:zt.modalTitle,children:"Select Timezone"}),(0,T.jsx)(s.default,{onPress:()=>k(!1),children:(0,T.jsx)(S.default,{name:"close",size:24,color:f.theme.colors.text})})]}),(0,T.jsx)(Rt.default,{data:A,keyExtractor:e=>e,renderItem:({item:e})=>(0,T.jsxs)(s.default,{style:[zt.timezoneItem,e===C&&zt.selectedTimezoneItem],onPress:()=>(async e=>{try{M(!0),await(0,at.updateTimeSettings)(e),v(e),k(!1),(0,p.debugLog)("MBA12345 Updated timezone to:",e),R({message:"Timezone updated successfully",type:"success",duration:3e3})}catch(t){(0,p.debugLog)("MBA12345 Error updating timezone:",t),R({message:"Failed to update timezone. Please try again.",type:"error",duration:4e3})}finally{M(!1)}})(e),children:[(0,T.jsx)(i.default,{style:[zt.timezoneText,e===C&&zt.selectedTimezoneText],children:e}),e===C&&(0,T.jsx)(S.default,{name:"check",size:20,color:f.theme.colors.primary})]}),initialNumToRender:20,maxToRenderPerBatch:20,windowSize:10})]})})})]})},Lt=(l.default.create({container:{flexDirection:"row",backgroundColor:f.theme.colors.surface,borderRadius:8,padding:8,marginBottom:16},mobileContainer:{padding:4,marginBottom:10},tab:{flex:1,paddingVertical:12,paddingHorizontal:20,alignItems:"center",justifyContent:"center",borderRadius:6,marginHorizontal:4},mobileTab:{flex:0,minWidth:150,paddingVertical:8,paddingHorizontal:16},activeTab:{backgroundColor:f.theme.colors.primary},tabText:{fontSize:16,fontWeight:"500",color:f.theme.colors.text,fontFamily:f.theme.fonts?.regular?.fontFamily},mobileTabText:{fontSize:14},activeTabText:{color:f.theme.colors.whiteText||f.theme.colors.background}}),["_addToTop"]),Ot=(e,t)=>l.default.create({mainContainer:{flex:1,backgroundColor:f.theme.colors.surface,height:"100vh",overflow:"hidden",position:"fixed",top:0,left:0,right:0,bottom:0,marginLeft:e>900?t?70:250:0,transition:"margin-left 0.3s ease"},container:{flex:1,backgroundColor:f.theme.colors.surface},content:{flex:1,height:"100%",overflow:"auto",backgroundColor:f.theme.colors.surface},mainContent:{flex:1,width:"100%",alignSelf:"center",backgroundColor:f.theme.colors.surface},headerSection:{width:"100%",backgroundColor:f.theme.colors.surfaceContrast,paddingHorizontal:24,paddingTop:24,zIndex:2},title:{fontSize:32,fontWeight:"600",color:f.theme.colors.text,marginBottom:24,fontFamily:f.theme.fonts.header.fontFamily},tabScrollContainer:{flexGrow:0},tabContainer:{flexDirection:"row",gap:e<=900?22:32,paddingRight:e<=900?16:0},tab:{paddingBottom:8,borderBottomWidth:2,borderBottomColor:"transparent"},activeTab:{borderBottomColor:f.theme.colors.primary},tabText:{fontSize:16,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily},activeTabText:{color:f.theme.colors.primary,fontWeight:"500"},tabContent:{flex:1,padding:e<=900?10:24,backgroundColor:f.theme.colors.surface},errorText:{color:"red",textAlign:"center",marginTop:20}}),Et=()=>{const e=(0,j.useNavigation)(),{width:t}=(0,ve.default)(),{screenWidth:l,isCollapsed:d,is_DEBUG:c,userRole:u,isApprovedProfessional:m,user:g,logout:h}=(0,a.useContext)(p.AuthContext),[f,y]=(0,a.useState)(l<=900),[b,w]=(0,a.useState)(l>=1200),C=Ot(l,d),[v,S]=(0,a.useState)("profile_info"),[B,_]=(0,a.useState)(!1),[I,D]=(0,a.useState)(null),[R,P]=(0,a.useState)(!0),[z,F]=(0,a.useState)(null),[L,O]=(0,a.useState)({}),[E,W]=(0,a.useState)({id:"waitlist",title:"Waitlist Signup",nextBilling:"N/A",connections:{used:0,total:"Unlimited"}}),{isVisible:N,currentStep:U,totalSteps:V,stepData:q,handleNext:Y,handlePrevious:G,handleSkip:J,completeTutorial:$}=(0,a.useContext)(M),Z=async()=>{try{if("web"===n.default.OS){const e=new URLSearchParams(window.location.search),t=e.get("initialTab")||e.get("screen");if(t&&["profile_info","pets_preferences","settings_payments","services_availability"].includes(t))return(0,p.debugLog)("MBA54321 MyProfile retrieved tab from URL params",{tabFromUrl:t}),S(t),void sessionStorage.setItem("myProfileActiveTab",t)}const t=e.getState().routes.find((e=>"MyProfile"===e.name))?.params;if((0,p.debugLog)("MBA54321 MyProfile navigation params",t),t?.initialTab)return(0,p.debugLog)("MBA54321 MyProfile received initialTab param",{initialTab:t.initialTab}),S(t.initialTab),void("web"===n.default.OS?sessionStorage.setItem("myProfileActiveTab",t.initialTab):await x.default.setItem("myProfileActiveTab",t.initialTab));if(t?.screen)return(0,p.debugLog)("MBA54321 MyProfile received screen param",{screen:t.screen}),S(t.screen),void("web"===n.default.OS?sessionStorage.setItem("myProfileActiveTab",t.screen):await x.default.setItem("myProfileActiveTab",t.screen));if(q?.tab)return(0,p.debugLog)("MBA54321 MyProfile received tab from stepData",{tab:q.tab}),S(q.tab),void("web"===n.default.OS?sessionStorage.setItem("myProfileActiveTab",q.tab):await x.default.setItem("myProfileActiveTab",q.tab));if("web"===n.default.OS){const e=sessionStorage.getItem("myProfileActiveTab");e&&((0,p.debugLog)("MBA54321 MyProfile loaded tab from sessionStorage",{storedTab:e}),S(e))}else{const e=await x.default.getItem("myProfileActiveTab");e&&((0,p.debugLog)("MBA54321 MyProfile loaded tab from AsyncStorage",{storedTab:e}),S(e))}}catch(z){(0,p.debugLog)("MBA54321 Error loading active tab",z)}};(0,a.useEffect)((()=>{Z()}),[e,q]),(0,a.useEffect)((()=>{v&&(async()=>{try{if("web"===n.default.OS){sessionStorage.setItem("myProfileActiveTab",v);const e=new URL(window.location.href);e.searchParams.set("initialTab",v),window.history.replaceState({},"",e.toString()),(0,p.debugLog)("MBA54321 Stored active tab in sessionStorage and URL",{activeTab:v})}else await x.default.setItem("myProfileActiveTab",v),(0,p.debugLog)("MBA54321 Stored active tab in AsyncStorage",{activeTab:v})}catch(z){(0,p.debugLog)("MBA54321 Error storing active tab",z)}})()}),[v]),(0,a.useEffect)((()=>e.addListener("focus",(()=>{const t=e.getState().routes.find((e=>"MyProfile"===e.name))?.params;t?.screen?((0,p.debugLog)("MBA54321 MyProfile focus event - setting active tab",{screen:t.screen}),S(t.screen)):t?.initialTab&&((0,p.debugLog)("MBA54321 MyProfile focus event - setting active tab",{initialTab:t.initialTab}),S(t.initialTab))}))),[e]),(0,a.useEffect)((()=>e.addListener("state",(()=>{const t=e.getState().routes.find((e=>"MyProfile"===e.name))?.params;t?.screen?((0,p.debugLog)("MBA54321 MyProfile state change - setting active tab",{screen:t.screen}),S(t.screen)):t?.initialTab&&((0,p.debugLog)("MBA54321 MyProfile state change - setting active tab",{initialTab:t.initialTab}),S(t.initialTab))}))),[e]),(0,a.useEffect)((()=>{y(l<=900),w(l>=1200)}),[l]),(0,a.useEffect)((()=>{K()}),[]);const K=async()=>{try{P(!0);const e=await(0,at.userProfile)();D(e),await Q(),P(!1),setTimeout((()=>{Z()}),100)}catch(z){F("Failed to load profile data"),P(!1),(0,p.debugLog)("Failed to load profile data:",z)}},Q=async()=>{try{if(I?.pets&&I.pets.length>0){const t=I.pets.filter((e=>!(!e.lastUpdateFailed&&!e.ownerMissing)));if(t.length>0){(0,p.debugLog)("MBA5432","Found pets with potential missing owners:",t);for(const n of t)try{const{fixPetOwner:e}=o(50294),t=await e(n.id);(0,p.debugLog)("MBA5432","Fixed pet owner successfully:",t)}catch(e){(0,p.debugLog)("MBA5432","Failed to fix pet owner:",e)}const a=await(0,at.userProfile)();D(a)}}}catch(z){(0,p.debugLog)("MBA5432","Error checking/fixing pet owners:",z)}},X=[{id:"profile_info",label:"professional"===u?"Professional Profile Info":"Owner Profile Info"},{id:"pets_preferences",label:"Pets & Preferences"},{id:"settings_payments",label:"professional"===u?"Settings & Payout Methods":"Settings & Payment Methods"}],ee=async()=>{const e=await Re.launchImageLibraryAsync({mediaTypes:Pe.MediaTypeOptions.Images,allowsEditing:!0,aspect:[1,1],quality:1});e.canceled||(D((t=>Object.assign({},t,{profilePhoto:e.assets[0].uri}))),_(!0))},te=e=>{(0,p.debugLog)("MBA9876","Save completed with updated profile:",e),D((t=>{const o=Object.assign({},t,e);return(0,p.debugLog)("MBA9876","Updated profile data after save:",{name:o.name,email:o.email,address:o.address,city:o.city,state:o.state,zip:o.zip,country:o.country}),o})),_(!1),O({}),(0,p.debugLog)("MBA5678","Changes saved successfully")},oe=(e,t)=>{(0,p.debugLog)("MBA9876","Updating field ".concat(e," locally, will be saved later:"),t),D((o=>Object.assign({},o,{[e]:t}))),_(!0)},ae=e=>{O((t=>Object.assign({},t,{[e]:!t[e]})))},ne=e=>{(0,p.debugLog)("Switching to plan:",e)};return R?(0,T.jsx)(r.default,{style:C.container,children:(0,T.jsx)(A.default,{size:"large",color:"#0000ff"})}):z?(0,T.jsx)(r.default,{style:C.container,children:(0,T.jsx)(i.default,{style:C.errorText,children:z})}):(0,T.jsx)(r.default,{style:C.mainContainer,children:(0,T.jsxs)(Se.default,{style:C.container,children:[f&&(0,T.jsx)(bt,{title:"Profile Settings",onBackPress:()=>e.goBack()}),(0,T.jsx)(r.default,{style:C.content,children:(0,T.jsxs)(r.default,{style:C.mainContent,children:[(0,T.jsxs)(r.default,{style:C.headerSection,children:[(0,T.jsx)(i.default,{style:C.title,children:"Profile Settings"}),(0,T.jsx)(H.default,{horizontal:!0,showsHorizontalScrollIndicator:!1,contentContainerStyle:C.tabScrollContainer,children:(0,T.jsx)(r.default,{style:C.tabContainer,children:X.map((e=>(0,T.jsx)(s.default,{style:[C.tab,v===e.id&&C.activeTab],onPress:()=>{if(S(e.id),"web"===n.default.OS){const t=new URL(window.location.href);t.searchParams.set("initialTab",e.id),window.history.replaceState({},"",t.toString()),sessionStorage.setItem("myProfileActiveTab",e.id),(0,p.debugLog)("MBA54321 Tab clicked - updated URL and storage",{tabId:e.id})}else x.default.setItem("myProfileActiveTab",e.id),(0,p.debugLog)("MBA54321 Tab clicked - updated storage",{tabId:e.id})},children:(0,T.jsx)(i.default,{style:[C.tabText,v===e.id&&C.activeTabText],children:e.label})},e.id)))})})]}),(0,T.jsx)(r.default,{style:C.tabContent,children:(()=>{switch((0,p.debugLog)("MBA54321","Rendering active tab with profile data:",{activeTab:v,profileName:I?.name,paymentMethods:I?.payment_methods}),v){case"profile_info":return(0,T.jsx)(Bt,{profilePhoto:I?.profilePhoto,email:I?.email,phone:I?.phone,age:I?.age,address:I?.address,city:I?.city,state:I?.state,zip:I?.zip,country:I?.country,bio:I?.bio,about_me:I?.about_me,name:I?.name,emergencyContact:I?.emergency_contact,authorizedHouseholdMembers:I?.authorized_household_members,editMode:L,toggleEditMode:ae,onChangeText:oe,pickImage:ee,setHasUnsavedChanges:e=>{(0,p.debugLog)("MBA9876","ProfileInfoTab setting hasUnsavedChanges:",e),_(e)},onSaveComplete:te,isMobile:f,rating:I?.rating,reviews:I?.reviews,role:u,isProfessional:"professional"===u,insurance:I?.insurance,onNavigateToTab:S});case"services_availability":return(0,T.jsx)(It,{services:I?.services,onToggleService:e=>{const t=I?.services.map((t=>t.id===e?Object.assign({},t,{isActive:!t.isActive}):t));oe("services",t)},onEditHours:()=>{},onBlockService:()=>{},onPartialDayBlock:()=>{},isMobile:f});case"pets_preferences":return(0,T.jsx)(Mt,{pets:I?.pets,onAddPet:e=>{const t=e._addToTop,o=(0,Le.default)(e,Lt),a=t?[o,...I?.pets||[]]:[...I?.pets||[],o];oe("pets",a),(0,p.debugLog)("MBA5432","Added new pet locally:",o,t?"(at top of list)":"(at bottom of list)")},onEditPet:(e,t)=>{const o=(I?.pets||[]).map((o=>o.id===e?Object.assign({},o,t):o));oe("pets",o),(0,p.debugLog)("MBA5432","Updated pet locally:",{petId:e,updatedPetData:t})},onDeletePet:e=>{const t=(I?.pets||[]).filter((t=>t.id!==e));oe("pets",t),(0,p.debugLog)("MBA5432","Deleted pet locally:",e)},onReplacePet:e=>{oe("pets",e),(0,p.debugLog)("MBA5432","Replaced entire pets array:",e)},preferences:I?.preferences,onUpdatePreferences:(e,t)=>{const o=Object.assign({},I?.preferences);"homeEnvironment"===e?o[e].includes(t)?o[e]=o[e].filter((e=>e!==t)):o[e]=[...o[e],t]:o[e]=o[e].map((e=>e.id===t?Object.assign({},e,{selected:!e.selected}):e)),oe("preferences",o)},userRole:u,isMobile:f});case"settings_payments":return(0,p.debugLog)("MBA54321 Rendering settings_payments tab with payment methods:",{paymentMethods:I?.payment_methods}),(0,T.jsx)(Ft,Object.assign({},I,{onUpdateSetting:(e,t)=>{(0,p.debugLog)("Updating setting:",{id:e,value:t});const o={[e]:t};return(0,at.updateProfileInfo)(o).then((e=>(D((t=>Object.assign({},t,e))),(0,p.debugLog)("MBA54321 Setting updated successfully:",o),e)))},paymentMethods:I?.payment_methods||[],onAddPaymentMethod:()=>e.navigate("AddPaymentMethod"),onRemovePaymentMethod:e=>{(0,p.debugLog)("Removing payment method:",e)},onSetDefaultPayment:e=>{(0,p.debugLog)("Setting default payment method:",e)},currentPlan:I?.currentPlan||E,onSwitchPlan:ne,isMobile:f,userRole:u,isApprovedProfessional:m}));default:return null}})()})]})}),N&&"MyProfile"===q?.screen&&(0,T.jsx)(k,{step:U,totalSteps:V,title:q.title,description:q.description,position:q.position,onNext:Y,onPrevious:G,onSkip:J,onClose:$})]})})};var Wt=o(92365);function Nt({title:e,onPress:t}){return(0,T.jsx)(s.default,{style:Ht.button,onPress:t,children:(0,T.jsx)(i.default,{style:Ht.buttonText,children:e})})}const Ht=l.default.create({button:{backgroundColor:f.theme.colors.primary,paddingVertical:f.theme.spacing.small,paddingHorizontal:f.theme.spacing.medium,borderRadius:5,alignItems:"center",marginVertical:f.theme.spacing.small},buttonText:{color:f.theme.colors.whiteText,fontSize:f.theme.fontSizes.medium}}),Ut=e=>{if(!e||""===e.trim())return{isValid:!1,message:"Email is required"};if(!/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(e))return{isValid:!1,message:"Please enter a valid email address"};return e.replace(/[<>]/g,"")!==e?{isValid:!1,message:"Email contains invalid characters"}:{isValid:!0,message:""}},Vt=e=>{if(!e||""===e.trim())return{isValid:!1,message:"Name is required"};if(!/^[a-zA-Z\s\-']+$/.test(e))return{isValid:!1,message:"Name can only contain letters, spaces, hyphens, and apostrophes"};return e.replace(/[<>]/g,"")!==e?{isValid:!1,message:"Name contains invalid characters"}:{isValid:!0,message:""}},qt=e=>{if(!e||""===e.trim())return{isValid:!1,message:"Password is required"};const t=/[A-Z]/.test(e),o=/[a-z]/.test(e),a=/\d/.test(e),n=/[!@#$%^&*(),.?":{}|<>]/.test(e);if((0,p.IsProduction)()){if(e.replace(/[<>]/g,"")!==e)return{isValid:!1,message:"Password contains invalid characters: <, >"}}return(0,p.IsProduction)()&&e.length<8?{isValid:!1,message:"Password must be at least ".concat(8," characters long")}:!(0,p.IsProduction)()||t&&o&&a&&n?{isValid:!0,message:""}:{isValid:!1,message:"Password must contain uppercase, lowercase, numbers, and special characters"}},{width:Yt}=v.default.get("window");const Gt=l.default.create({container:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:f.theme.colors.background,padding:f.theme.spacing.medium},card:{backgroundColor:f.theme.colors.surfaceContrast,borderRadius:8,padding:1.5*f.theme.spacing.large,width:"100%",maxWidth:480,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3},title:{fontSize:1.4*f.theme.fontSizes.extraLarge,fontWeight:"bold",color:f.theme.colors.text,marginBottom:f.theme.spacing.medium,textAlign:"left"},createAccountContainer:{flexDirection:"row",marginBottom:f.theme.spacing.large},createAccountText:{fontSize:f.theme.fontSizes.medium,color:f.theme.colors.text,marginRight:5},createAccountLink:{fontSize:f.theme.fontSizes.medium,color:f.theme.colors.primary,textDecorationLine:"underline"},inputLabelContainer:{marginBottom:f.theme.spacing.medium},inputLabel:{fontSize:f.theme.fontSizes.medium,color:f.theme.colors.text,marginBottom:f.theme.spacing.small,fontWeight:"500"},passwordLabelContainer:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:f.theme.spacing.small},showHideText:{color:f.theme.colors.primary,fontSize:f.theme.fontSizes.smallMedium},input:{height:48,borderWidth:1,borderColor:f.theme.colors.border,borderRadius:4,paddingHorizontal:1.5*f.theme.spacing.small,fontSize:f.theme.fontSizes.medium,backgroundColor:f.theme.colors.surfaceContrast},errorInput:{borderColor:f.theme.colors.error},errorText:{color:f.theme.colors.error,fontSize:f.theme.fontSizes.smallMedium,marginTop:4},rememberMeContainer:{flexDirection:"row",alignItems:"center",marginBottom:f.theme.spacing.large},checkbox:{width:20,height:20,borderWidth:1,borderColor:f.theme.colors.border,borderRadius:2,marginRight:10,justifyContent:"center",alignItems:"center"},checkboxInner:{width:20,height:20,backgroundColor:f.theme.colors.primary,borderRadius:2,justifyContent:"center",alignItems:"center"},rememberMeText:{fontSize:f.theme.fontSizes.medium,color:f.theme.colors.text},loginButton:{backgroundColor:f.theme.colors.primary,paddingVertical:1.75*f.theme.spacing.small,borderRadius:4,alignItems:"center",marginBottom:f.theme.spacing.medium},loginButtonText:{color:f.theme.colors.whiteText,fontSize:f.theme.fontSizes.medium,fontWeight:"500"},forgotPasswordContainer:{alignItems:"center",marginTop:f.theme.spacing.small},link:{color:f.theme.colors.primary,fontSize:f.theme.fontSizes.smallMedium},message:{marginTop:f.theme.spacing.small,color:f.theme.colors.error,fontSize:f.theme.fontSizes.smallMedium,textAlign:"center"},prototypeWarning:{backgroundColor:"#FFF3CD",color:"#856404",padding:1.5*f.theme.spacing.small,marginBottom:f.theme.spacing.medium,borderRadius:4,textAlign:"center"}});var Jt=o(44767);const{width:$t}=v.default.get("window");function Zt(){const e=(0,j.useNavigation)(),t=(0,j.useRoute)(),{signIn:o,is_DEBUG:l}=(0,a.useContext)(p.AuthContext),[d,c]=(0,a.useState)(""),[u,m]=(0,a.useState)(""),[g,h]=(0,a.useState)(""),[y,x]=(0,a.useState)(""),[C,v]=(0,a.useState)(""),[B,k]=(0,a.useState)(!1),[_,I]=(0,a.useState)(""),[D,M]=(0,a.useState)(""),[R,P]=(0,a.useState)(null),[z,F]=(0,a.useState)(!1),[L,O]=(0,a.useState)(!1),[E,W]=(0,a.useState)(""),[N,U]=(0,a.useState)(!1),[V,Y]=(0,a.useState)(""),[G,J]=(0,a.useState)([]),[$,Z]=(0,a.useState)(!0),K=[{name:"Colorado Springs",supported:!0},{name:"Denver",supported:!1},{name:"Other",supported:!1}],[Q,X]=(0,a.useState)(""),[ee,te]=(0,a.useState)(""),[oe,ae]=(0,a.useState)(""),[ne,re]=(0,a.useState)(""),[ie,se]=(0,a.useState)("");(0,a.useEffect)((()=>{(async()=>{try{t.name;(0,p.debugLog)("MBA4321 Current route name:",t.name);let o=t.params?.token;if((0,p.debugLog)("MBA4321 Token from route params:",o),!o&&"web"===n.default.OS){const e=window.location.pathname;if((0,p.debugLog)("MBA4321 Current URL path:",e),(0,p.debugLog)("MBA4321 Full location object:",{pathname:window.location.pathname,href:window.location.href,search:window.location.search,hash:window.location.hash}),e.includes("/invite/")){const t=e.split("/"),a=t.findIndex((e=>"invite"===e));-1!==a&&t.length>a+1&&(o=t[a+1],(0,p.debugLog)("MBA4321 Found invitation token from invite URL path:",o))}else if(e.includes("/signup/")){const t=e.split("/"),a=t.findIndex((e=>"signup"===e));-1!==a&&t.length>a+1&&(o=t[a+1],(0,p.debugLog)("MBA4321 Found invitation token from signup URL path:",o))}}if(!o&&"web"===n.default.OS){const e=new URLSearchParams(window.location.search).get("token");e&&(o=e,(0,p.debugLog)("MBA4321 Found invitation token from URL search params:",o))}if(o){(0,p.debugLog)("MBA4321 Processing invitation token:",o),P(o),O(!0);try{const e=await(0,at.verifyInvitation)(o);(0,p.debugLog)("MBA4321 Invitation verification result:",e),e.valid?(F(!0),M(e.inviter_name),e.email&&h(e.email),I("You've been invited by ".concat(e.inviter_name,"!"))):I("This invitation is no longer valid: ".concat(e.error))}catch(e){(0,p.debugLog)("MBA4321 Error verifying invitation:",e),I("This invitation link is invalid or has expired.")}finally{O(!1)}}}catch(e){(0,p.debugLog)("MBA4321 Error processing invitation:",e),O(!1)}})()}),[t.params,t.name]),(0,a.useEffect)((()=>{(async()=>{Z(!0);try{const e=await w.default.get("".concat(b.API_BASE_URL,"/api/locations/v1/supported/"));(0,p.debugLog)("MBA6789: Locations fetched from backend",e.data),e.data&&Array.isArray(e.data.locations)?J(e.data.locations):((0,p.debugLog)("MBA6789: Using fallback locations due to unexpected response format",e.data),J(K))}catch(e){(0,p.debugLog)("MBA6789: Error fetching locations",e),J(K)}finally{Z(!1)}})()}),[]);const le={name:"".concat(d.trim().charAt(0).toUpperCase()+d.trim().slice(1).toLowerCase()," ").concat(u.trim().charAt(0).toUpperCase()+u.trim().slice(1).toLowerCase()),email:g.trim().toLowerCase(),password:y,password2:C,phone_number:"",location:z?"Colorado Springs":E};return(0,T.jsx)(Jt.default,{style:Kt.container,behavior:"ios"===n.default.OS?"padding":"height",keyboardVerticalOffset:"ios"===n.default.OS?64:0,children:(0,T.jsxs)(H.default,{contentContainerStyle:Kt.scrollContainer,children:[(0,T.jsxs)(r.default,{style:Kt.formContainer,children:[(0,T.jsx)(i.default,{style:Kt.title,children:"Sign Up"}),(0,T.jsx)(i.default,{style:Kt.subtitle,children:"Sign up to continue"}),L&&(0,T.jsxs)(r.default,{style:Kt.inviteContainer,children:[(0,T.jsx)(A.default,{size:"small",color:f.theme.colors.primary}),(0,T.jsx)(i.default,{style:Kt.inviteText,children:"Verifying invitation..."})]}),z&&(0,T.jsx)(r.default,{style:Kt.inviteContainer,children:(0,T.jsxs)(i.default,{style:Kt.inviteText,children:["You've been invited by ",D,"!"]})}),!z&&(0,T.jsxs)(r.default,{style:Kt.locationContainer,children:[(0,T.jsx)(i.default,{style:Kt.label,children:"Where are you located?"}),$?(0,T.jsxs)(r.default,{style:[Kt.input,Kt.dropdown,Kt.loadingContainer],children:[(0,T.jsx)(A.default,{size:"small",color:f.theme.colors.primary}),(0,T.jsx)(i.default,{style:Kt.placeholderText,children:"Loading locations..."})]}):(0,T.jsxs)(r.default,{style:Kt.dropdownWrapper,children:[(0,T.jsxs)(s.default,{style:[Kt.input,Kt.dropdown,V?Kt.errorInput:null],onPress:()=>U(!N),children:[(0,T.jsx)(i.default,{style:E?Kt.inputText:Kt.placeholderText,children:E||"Select your location"}),(0,T.jsx)(S.default,{name:N?"chevron-up":"chevron-down",size:24,color:f.theme.colors.text})]}),N&&(0,T.jsx)(r.default,{style:Kt.dropdownMenu,children:G.map((e=>(0,T.jsx)(s.default,{style:Kt.dropdownItem,onPress:()=>{return t=e.name,console.log("Location selected:",t),(0,p.debugLog)("MBA6789: Location selected",t),W(t),U(!1),void Y("");var t},children:(0,T.jsxs)(i.default,{style:Kt.dropdownItemText,children:[e.name," ",!e.supported&&"(Coming Soon)"]})},e.name)))})]}),V?(0,T.jsx)(i.default,{style:Kt.errorText,children:V}):null]}),z||!E||G.find((e=>e.name===E&&e.supported))?(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)(r.default,{style:Kt.inputContainer,children:[(0,T.jsx)(q.default,{style:[Kt.input,Q?Kt.errorInput:null],placeholder:"First Name",value:d,onChangeText:e=>{c(e),X("")}}),Q?(0,T.jsx)(i.default,{style:Kt.errorText,children:Q}):null]}),(0,T.jsxs)(r.default,{style:Kt.inputContainer,children:[(0,T.jsx)(q.default,{style:[Kt.input,ee?Kt.errorInput:null],placeholder:"Last Name",value:u,onChangeText:e=>{m(e),te("")}}),ee?(0,T.jsx)(i.default,{style:Kt.errorText,children:ee}):null]}),(0,T.jsxs)(r.default,{style:Kt.inputContainer,children:[(0,T.jsx)(q.default,{style:[Kt.input,oe?Kt.errorInput:null],placeholder:"Email",value:g,onChangeText:e=>{h(e),ae("")},keyboardType:"email-address",autoCapitalize:"none",editable:!0}),oe?(0,T.jsx)(i.default,{style:Kt.errorText,children:oe}):null]}),(0,T.jsxs)(r.default,{style:Kt.inputContainer,children:[(0,T.jsx)(q.default,{style:[Kt.input,ne?Kt.errorInput:null],placeholder:"Password",value:y,onChangeText:e=>{x(e),re("")},secureTextEntry:!0}),ne?(0,T.jsx)(i.default,{style:Kt.errorText,children:ne}):null]}),(0,T.jsxs)(r.default,{style:Kt.inputContainer,children:[(0,T.jsx)(q.default,{style:[Kt.input,ie?Kt.errorInput:null],placeholder:"Confirm Password",value:C,onChangeText:e=>{v(e),se("")},secureTextEntry:!0}),ie?(0,T.jsx)(i.default,{style:Kt.errorText,children:ie}):null]}),(0,T.jsx)(Nt,{title:"Sign Up",onPress:async()=>{if((()=>{let e=!0;z||E||(Y("Please select your location"),e=!1);const t=Vt(d);X(t.message),t.isValid||(e=!1);const o=Vt(u);te(o.message),o.isValid||(e=!1);const a=Ut(g);ae(a.message),a.isValid||(e=!1);const n=qt(y);re(n.message),n.isValid||(e=!1);const r=((e,t)=>e!==t?{isValid:!1,message:"Passwords do not match"}:{isValid:!0,message:""})(y,C);return se(r.message),r.isValid||(e=!1),e})()){k(!0);try{(0,p.debugLog)("MBA12345 Starting user registration process");let a="UTC";try{a=Intl.DateTimeFormat().resolvedOptions().timeZone,(0,p.debugLog)("MBA12345 User timezone detected using Intl API",{userTimezone:a})}catch(t){(0,p.debugLog)("MBA12345 Error detecting timezone using Intl API",t),a="UTC"}const r=!1;(0,p.debugLog)("MBA12345 User timezone and preferences",{userTimezone:a,useMilitaryTime:r});const i=Object.assign({},le,{timezone:a,use_military_time:r,invitation_token:R}),s=await w.default.post("".concat(b.API_BASE_URL,"/api/users/v1/register/"),i);(0,p.debugLog)("MBA12345 User registration successful",s.data),(0,p.debugLog)("MBA12345 Attempting to log in with new credentials");const l=await w.default.post("".concat(b.API_BASE_URL,"/api/token/"),{email:g.toLowerCase(),password:y});(0,p.debugLog)("MBA12345 Login successful, received tokens");const{access:d,refresh:c}=l.data;if((0,p.debugLog)("MBA12345 Calling signIn function from AuthContext"),await o(d,c),(0,p.debugLog)("MBA12345 Authentication setup complete"),R&&z)try{await w.default.post("".concat(b.API_BASE_URL,"/api/users/v1/invitations/").concat(R,"/accept/"),{},{headers:{Authorization:"Bearer ".concat(d),"Content-Type":"application/json"}}),(0,p.debugLog)("MBA12345 Invitation accepted successfully")}catch(t){(0,p.debugLog)("MBA12345 Error accepting invitation:",t)}"ios"===n.default.OS||"android"===n.default.OS?Be.default.alert("Success","Account created successfully!",[{text:"OK",onPress:()=>e.navigate("MyProfile")}]):e.navigate("MyProfile")}catch(t){(0,p.debugLog)("MBA12345 Error during signup process",t.response?.data||t.message);let e="Signup Failed: An error occurred during signup.";if(t.response){const o=t.response.data;if(o){const t=Object.entries(o)[0];if(t){const[o,a]=t;e="".concat(o,": ").concat(Array.isArray(a)?a[0]:a)}}}"ios"===n.default.OS||"android"===n.default.OS?Be.default.alert("Error",e):I(e)}finally{k(!1)}}},style:Kt.signupButton})]}):(0,T.jsxs)(r.default,{style:Kt.waitlistContainer,children:[(0,T.jsxs)(i.default,{style:Kt.waitlistMessage,children:["CrittrCove isn't available in ",E," yet, but we're expanding soon!"]}),(0,T.jsx)(i.default,{style:Kt.waitlistSubMessage,children:"Join our waitlist to be notified when we launch in your area."}),(0,T.jsx)(Nt,{title:"Join Waitlist",onPress:()=>{e.navigate("Waitlist")},style:Kt.waitlistButton})]}),B&&(0,T.jsx)(A.default,{size:"large",color:f.theme.colors.primary,style:Kt.loader}),_?(0,T.jsx)(i.default,{style:Kt.message,children:_}):null]}),(0,T.jsxs)(r.default,{style:Kt.signInContainer,children:[(0,T.jsx)(i.default,{style:Kt.signInText,children:"Already have an account? "}),(0,T.jsx)(s.default,{onPress:()=>{e.navigate("SignIn")},children:(0,T.jsx)(i.default,{style:Kt.signInLink,children:"Sign in"})})]})]})})}const Kt=l.default.create({container:{flex:1,backgroundColor:f.theme.colors.background},scrollContainer:{padding:20,alignItems:"center",justifyContent:"center",minHeight:"100%"},formContainer:{backgroundColor:f.theme.colors.surfaceContrast,padding:30,borderRadius:10,width:"100%",maxWidth:500,alignItems:"center",shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3,borderWidth:1,borderColor:f.theme.colors.border},title:{fontSize:32,color:f.theme.colors.text,marginBottom:8,fontWeight:"bold",textAlign:"center"},subtitle:{color:f.theme.colors.text,fontSize:16,marginBottom:24,textAlign:"center"},inputContainer:{width:"100%",marginBottom:16},input:{width:"100%",height:50,borderWidth:1,borderColor:f.theme.colors.border,borderRadius:5,paddingHorizontal:10,backgroundColor:f.theme.colors.surface,fontSize:16},errorInput:{borderColor:f.theme.colors.error},errorText:{color:f.theme.colors.error,fontSize:12,marginTop:5},message:{marginTop:20,color:f.theme.colors.text,textAlign:"center",fontSize:16},inviteContainer:{marginBottom:20,padding:16,borderWidth:1,borderColor:f.theme.colors.primary,borderRadius:8,alignItems:"center",backgroundColor:"#f0f9ff",width:"100%",flexDirection:"row",justifyContent:"center"},inviteText:{color:f.theme.colors.primary,fontSize:16,marginLeft:8,fontWeight:"500",textAlign:"center"},signupButton:{marginTop:24,width:"100%"},loader:{marginTop:20},signInContainer:{flexDirection:"row",marginTop:24,justifyContent:"center",alignItems:"center"},signInText:{color:f.theme.colors.text,fontSize:16},signInLink:{color:f.theme.colors.primary,fontSize:16,fontWeight:"600"},dropdown:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",height:50,borderWidth:1,borderColor:f.theme.colors.border,borderRadius:5,paddingHorizontal:10,backgroundColor:f.theme.colors.surface},placeholderText:{color:f.theme.colors.placeHolderText,fontSize:16},inputText:{color:f.theme.colors.text,fontSize:16},dropdownMenu:{position:"absolute",top:"100%",left:0,right:0,zIndex:1002,marginTop:4,maxHeight:200,backgroundColor:f.theme.colors.surface,borderWidth:1,borderColor:f.theme.colors.border,borderRadius:5,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3},dropdownItem:{padding:12,borderBottomWidth:1,borderBottomColor:f.theme.colors.border},dropdownItemText:{color:f.theme.colors.text,fontSize:16},label:{color:f.theme.colors.text,fontSize:16,marginBottom:8},locationContainer:{width:"100%",marginBottom:16,position:"relative",zIndex:1e3},dropdownWrapper:{position:"relative",zIndex:1001},loadingContainer:{justifyContent:"center"},waitlistContainer:{marginTop:20,padding:20,borderRadius:8,alignItems:"center",width:"100%",backgroundColor:"#f0f9ff",borderWidth:1,borderColor:"#e0e7ff",shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.05,shadowRadius:2,elevation:2},waitlistMessage:{color:f.theme.colors.text,fontSize:18,fontWeight:"600",marginBottom:16,textAlign:"center"},waitlistSubMessage:{color:f.theme.colors.text,fontSize:16,textAlign:"center",marginBottom:8},waitlistButton:{marginTop:24,width:"100%",backgroundColor:"#6B7280"}}),{width:Qt}=v.default.get("window");const Xt=l.default.create({container:{padding:f.theme.spacing.medium,backgroundColor:f.theme.colors.background,flex:1,justifyContent:"center",alignItems:"center"},title:{fontSize:f.theme.fontSizes.large,color:f.theme.colors.primary,marginBottom:f.theme.spacing.medium},input:{width:Qt>600?600:"100%",maxWidth:600,height:40,borderColor:"gray",borderWidth:1,marginBottom:f.theme.spacing.small,paddingHorizontal:f.theme.spacing.small},inputError:{borderColor:"red"},message:{marginTop:f.theme.spacing.small,color:f.theme.colors.primary,fontSize:f.theme.fontSizes.medium}}),{width:eo}=v.default.get("window");const to=l.default.create({container:{padding:f.theme.spacing.medium,backgroundColor:f.theme.colors.background,flex:1,justifyContent:"center",alignItems:"center"},title:{fontSize:f.theme.fontSizes.large,color:f.theme.colors.primary,marginBottom:f.theme.spacing.medium},input:{width:eo>600?600:"100%",maxWidth:600,height:40,borderColor:"gray",borderWidth:1,marginBottom:f.theme.spacing.small,paddingHorizontal:f.theme.spacing.small},message:{marginTop:f.theme.spacing.small,color:f.theme.colors.primary,fontSize:f.theme.fontSizes.medium}});var oo=o(91808),ao=o(12686),no=o(15558),ro=o(32160);const io=l.default.create({card:Object.assign({backgroundColor:f.theme.colors.surfaceContrast,borderRadius:12,padding:16,marginBottom:16},"web"===n.default.OS&&{transition:"all 0.2s ease-in-out",cursor:"pointer"}),cardHovered:{transform:[{scale:1.02}],shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:5},cardContent:{flexDirection:"column"},mobileCardContent:{gap:12},topContent:{flexDirection:"row",alignItems:"flex-start",gap:16},mobileTopContent:{marginBottom:0},profileImage:{width:88,height:88,borderRadius:44},mobileProfileImage:{width:48,height:48,borderRadius:24},contentContainer:{flex:1},mobileContentContainer:{flex:1},headerContainer:{flexDirection:"row",justifyContent:"space-between",alignItems:"flex-start",marginBottom:8},mobileHeaderContainer:{marginBottom:0},nameAndPets:{flex:1},statusBadge:{alignSelf:"flex-start",paddingHorizontal:12,paddingVertical:4,borderRadius:16},statusContent:{flexDirection:"row",alignItems:"center",gap:6},statusText:{fontSize:12,fontWeight:"500",fontFamily:f.theme.fonts.regular.fontFamily},clientContainer:{flexDirection:"row",alignItems:"center",gap:6,marginBottom:6},name:{fontSize:16,fontWeight:"600",color:f.theme.colors.mybookings.ownerName,fontFamily:f.theme.fonts.regular.fontFamily},petContainer:{flexDirection:"row",alignItems:"center",gap:4},petInfo:{fontSize:14,color:"#888975",fontFamily:f.theme.fonts.regular.fontFamily},mobileDivider:{height:1,backgroundColor:f.theme.colors.surface,width:"100%"},metaInfo:{flexDirection:"row",alignItems:"center",flexWrap:"wrap",gap:8},mobileMetaInfo:{width:"100%"},mobileMetaRow:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"},metaItemContainer:{flexDirection:"row",alignItems:"center",gap:4},metaText:{fontSize:14,color:f.theme.colors.mybookings.metaText,fontFamily:f.theme.fonts.regular.fontFamily},viewDetailsButton:{backgroundColor:f.theme.colors.primary,paddingHorizontal:16,paddingVertical:8,borderRadius:8},viewDetailsText:{color:f.theme.colors.surfaceContrast,fontSize:14,fontWeight:"500",fontFamily:f.theme.fonts.regular.fontFamily},mobileClientContainer:{marginBottom:4},mobileName:{fontSize:15,color:f.theme.colors.mybookings.ownerName},mobilePetContainer:{marginBottom:2},mobilePetInfo:{fontSize:13,color:f.theme.colors.mybookings.metaText},mobileStatusBadge:{paddingHorizontal:8,paddingVertical:2,borderRadius:12},mobileStatusText:{fontSize:10}}),so=({booking:e,type:t,onViewDetails:l})=>{const{id:d,status:c,date:u,time:m,serviceName:g}=e;let h="";"professional"===t?(h=e.client_name||e.ownerName||"Client",(0,p.debugLog)("MBA5677: Using client name for professional view",{client_name:e.client_name,ownerName:e.ownerName})):(h=e.professional_name||e.professionalName||"Professional",(0,p.debugLog)("MBA5677: Using professional name for client view",{professional_name:e.professional_name,professionalName:e.professionalName}));const y=(e=>{switch((0,p.debugLog)("MBA5677: Processing status",{status:e}),e){case"Pending Initial Professional Changes":case"Pending Professional Changes":return{text:"Pending Pro",bgColor:f.theme.colors.mybookings.main,textColor:f.theme.colors.mybookings.secondary,icon:"clock-outline"};case"Pending Owner Approval":return{text:"Pending Owner",bgColor:f.theme.colors.mybookings.main,textColor:f.theme.colors.mybookings.secondary,icon:"clock-outline"};case"Confirmed":return{text:"Confirmed",bgColor:f.theme.colors.mybookings.confirmedBg,textColor:f.theme.colors.mybookings.confirmedText,icon:"check-circle-outline"};case"Completed":return{text:"Completed",bgColor:f.theme.colors.mybookings.completedBg,textColor:f.theme.colors.mybookings.completedText,icon:"flag-checkered"};case"Confirmed Pending Professional Changes":return{text:"Confirmed \u2022 Pending Pro",bgColor:f.theme.colors.mybookings.confirmedBg,textColor:f.theme.colors.mybookings.confirmedText,icon:"check-circle-outline"};case"Confirmed Pending Owner Approval":return{text:"Confirmed \u2022 Pending Owner",bgColor:f.theme.colors.mybookings.confirmedBg,textColor:f.theme.colors.mybookings.confirmedText,icon:"check-circle-outline"};default:return{text:e||"Unknown",bgColor:f.theme.colors.mybookings.main,textColor:f.theme.colors.mybookings.secondary,icon:"clock-outline"}}})(c),b=e.pets||[],{screenWidth:x,timeSettings:j}=(0,a.useContext)(p.AuthContext),w=x<600,[C,v]=(0,a.useState)(!1);(0,p.debugLog)("MBA5677: Original booking date/time",{date:u,time:m});const B="UTC"!==j?.timezone&&u&&m?(0,ro.convertDateTimeFromUTC)(u,m,j?.timezone||"America/Denver",j?.use_military_time||!1):u&&m?{date:u,time:m}:null,k=B?.date?(()=>{(0,p.debugLog)("MBA5677: Formatting with direct date",B.date);const e=B.date.split("-");if(3===e.length){const[t,o,a]=e,n=new Date(parseInt(t),parseInt(o)-1,parseInt(a));if(!isNaN(n.getTime())){const e=n.toLocaleString("default",{month:"short"});return(0,p.debugLog)("MBA5677: Formatted date parts",{year:t,month:o,day:a,monthName:e,day:n.getDate()}),"".concat(e," ").concat(n.getDate())}}return B.date})():"No date selected",_=B?.time;(0,p.debugLog)("MBA5677: Converted date/time",{formattedDate:k,convertedTime:_,convertedDateTime:B,timezone:j?.timezone,originalDate:u,originalTime:m});const A=()=>{const e=_||"No time selected",t=g||"No service selected";return w?(0,T.jsx)(r.default,{style:io.mobileMetaInfo,children:(0,T.jsxs)(r.default,{style:io.mobileMetaRow,children:[(0,T.jsxs)(r.default,{style:io.metaItemContainer,children:[(0,T.jsx)(S.default,{name:"calendar",size:14,color:f.theme.colors.mybookings.metaText}),(0,T.jsx)(i.default,{style:io.metaText,children:k})]}),(0,T.jsxs)(r.default,{style:io.metaItemContainer,children:[(0,T.jsx)(S.default,{name:"clock-outline",size:14,color:f.theme.colors.mybookings.metaText}),(0,T.jsx)(i.default,{style:io.metaText,children:e})]}),(0,T.jsxs)(r.default,{style:io.metaItemContainer,children:[(0,T.jsx)(S.default,{name:"briefcase-outline",size:14,color:f.theme.colors.mybookings.metaText}),(0,T.jsx)(i.default,{style:io.metaText,children:t})]})]})}):(0,T.jsxs)(r.default,{style:io.metaInfo,children:[(0,T.jsxs)(r.default,{style:io.metaItemContainer,children:[(0,T.jsx)(S.default,{name:"calendar",size:16,color:f.theme.colors.mybookings.metaText}),(0,T.jsx)(i.default,{style:io.metaText,children:k})]}),(0,T.jsx)(i.default,{style:io.metaText,children:" \u2022 "}),(0,T.jsxs)(r.default,{style:io.metaItemContainer,children:[(0,T.jsx)(S.default,{name:"clock-outline",size:16,color:f.theme.colors.mybookings.metaText}),(0,T.jsx)(i.default,{style:io.metaText,children:e})]}),(0,T.jsx)(i.default,{style:io.metaText,children:" \u2022 "}),(0,T.jsxs)(r.default,{style:io.metaItemContainer,children:[(0,T.jsx)(S.default,{name:"briefcase-outline",size:16,color:f.theme.colors.mybookings.metaText}),(0,T.jsx)(i.default,{style:io.metaText,children:t})]})]})};return(0,p.debugLog)("MBA5677: Rendering BookingCard",{booking:e,type:t,name:h,status:c}),(0,T.jsx)(s.default,{style:[io.card,"web"===n.default.OS&&C&&io.cardHovered],onPress:l,onMouseEnter:()=>"web"===n.default.OS&&v(!0),onMouseLeave:()=>"web"===n.default.OS&&v(!1),children:(0,T.jsxs)(r.default,{style:[io.cardContent,w&&io.mobileCardContent],children:[(0,T.jsxs)(r.default,{style:[io.topContent,w&&io.mobileTopContent],children:[(0,T.jsx)(U.default,{source:o(4456),style:[io.profileImage,w&&io.mobileProfileImage]}),(0,T.jsxs)(r.default,{style:[io.contentContainer,w&&io.mobileContentContainer],children:[(0,T.jsxs)(r.default,{style:[io.headerContainer,w&&io.mobileHeaderContainer],children:[(0,T.jsxs)(r.default,{style:io.nameAndPets,children:[(0,T.jsxs)(r.default,{style:[io.clientContainer,w&&io.mobileClientContainer],children:[(0,T.jsx)(S.default,{name:"account",size:w?16:18,color:f.theme.colors.mybookings.ownername}),(0,T.jsx)(i.default,{style:[io.name,w&&io.mobileName],children:h})]}),(0,T.jsxs)(r.default,{style:[io.petContainer,w&&io.mobilePetContainer],children:[(0,T.jsx)(S.default,{name:"paw",size:14,color:f.theme.colors.mybookings.metaText}),(0,T.jsx)(i.default,{style:[io.petInfo,w&&io.mobilePetInfo],children:b.length>0?b.map((e=>e.name)).join(", "):"No pets selected"})]})]}),(0,T.jsx)(r.default,{style:[io.statusBadge,{backgroundColor:y.bgColor},w&&io.mobileStatusBadge],children:(0,T.jsxs)(r.default,{style:io.statusContent,children:[(0,T.jsx)(S.default,{name:y.icon,size:w?12:16,color:y.textColor}),(0,T.jsx)(i.default,{style:[io.statusText,{color:y.textColor},w&&io.mobileStatusText],children:y.text})]})})]}),!w&&A()]}),!w&&(0,T.jsx)(s.default,{style:io.viewDetailsButton,onPress:l,children:(0,T.jsx)(i.default,{style:io.viewDetailsText,children:"View Details"})})]}),w&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(r.default,{style:io.mobileDivider}),A()]})]})})},lo=l.default.create({container:{flex:1,backgroundColor:f.theme.colors.background},contentContainer:{padding:16},section:{marginTop:24},badge:{fontSize:12,color:f.theme.colors.whiteText,fontFamily:f.theme.fonts.regular.fontFamily,fontWeight:"bold",backgroundColor:f.theme.colors.mainColors.main,paddingHorizontal:8,paddingVertical:4,borderRadius:4,marginTop:4},sectionHeaderContainer:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:8},sectionHeader:{fontSize:20,fontFamily:f.theme.fonts.header.fontFamily,color:f.theme.colors.text,marginBottom:8},addRateText:{color:f.theme.colors.mainColors.main,fontSize:14,fontWeight:"600",fontFamily:f.theme.fonts.regular.fontFamily},card:{backgroundColor:f.theme.colors.surfaceContrast,borderRadius:8,paddingHorizontal:16,paddingBottom:16,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3},breakdownSection:{width:"100%"},dateHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16},dateTextContainer:{flex:1,marginRight:8},dateText:{fontSize:16,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily},breakdownItem:{flexDirection:"row",justifyContent:"space-between",paddingVertical:12,borderBottomWidth:1,borderBottomColor:f.theme.colors.border},breakdownLabelContainer:{flex:1,marginRight:16},breakdownLabel:{fontSize:16,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily},breakdownCalculation:{fontSize:14,color:f.theme.colors.placeHolderText,marginTop:4,fontFamily:f.theme.fonts.regular.fontFamily},breakdownAmount:{fontSize:16,color:f.theme.colors.text,fontWeight:"600",fontFamily:f.theme.fonts.regular.fontFamily},totalItem:{marginTop:8,paddingTop:16},subtotalRow:{flexDirection:"row",justifyContent:"space-between",marginBottom:12,paddingBottom:12,borderBottomWidth:1,borderBottomColor:f.theme.colors.border},subtotalLabel:{fontSize:16,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily},subtotalAmount:{fontSize:16,color:f.theme.colors.text,fontWeight:"600",fontFamily:f.theme.fonts.regular.fontFamily},feeRow:{flexDirection:"row",justifyContent:"space-between",marginBottom:12,paddingBottom:12,borderBottomWidth:1,borderBottomColor:f.theme.colors.border},feeLabel:{fontSize:16,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily},feeAmount:{fontSize:16,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily},totalAmountContainer:{flexDirection:"row",justifyContent:"space-between",marginBottom:16,paddingBottom:16},totalLabel:{fontSize:16,fontWeight:"600",color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily},totalAmount:{fontSize:18,fontWeight:"700",color:f.theme.colors.mainColors.main,fontFamily:f.theme.fonts.regular.fontFamily},divider:{height:1,backgroundColor:f.theme.colors.border,marginBottom:16},payoutContainer:{alignItems:"flex-end"},payoutLabel:{fontSize:16,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily},payoutAmount:{fontSize:18,fontWeight:"700",color:f.theme.colors.success,fontFamily:f.theme.fonts.regular.fontFamily,marginTop:4},payoutBreakdown:{fontSize:12,color:f.theme.colors.placeHolderText,fontFamily:f.theme.fonts.regular.fontFamily,marginTop:4},inputContainer:{flexDirection:"row",alignItems:"center",marginTop:4},addRateContainer:{padding:16,width:"100%"},rateNameAmountRow:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:"100%",marginBottom:12},rateEditContainer:{flexDirection:"row",alignItems:"center",marginTop:8},amountInputContainer:{flexDirection:"row",alignItems:"center",minWidth:120,maxWidth:150},rateInput:{fontSize:16,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily,borderWidth:1,borderColor:f.theme.colors.border,borderRadius:4,paddingVertical:8,paddingHorizontal:12,minWidth:100,flex:1},currencySymbol:{fontSize:16,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily,marginRight:4,marginLeft:2},inputLabel:{fontSize:14,color:f.theme.colors.placeHolderText,fontFamily:f.theme.fonts.regular.fontFamily,marginLeft:4},nameInput:{fontSize:16,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily,borderWidth:1,borderColor:f.theme.colors.border,borderRadius:4,paddingVertical:8,paddingHorizontal:12,flex:1,marginRight:16},descriptionInput:{fontSize:16,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily,borderWidth:1,borderColor:f.theme.colors.border,borderRadius:4,paddingVertical:8,paddingHorizontal:12,width:"100%"},saveButton:{backgroundColor:f.theme.colors.mainColors.main,borderRadius:4,paddingVertical:12,paddingHorizontal:20,marginTop:0,marginBottom:0,marginRight:0},saveButtonText:{color:"white",fontSize:16,fontWeight:"600",fontFamily:f.theme.fonts.regular.fontFamily},formDivider:{height:1,backgroundColor:f.theme.colors.border,marginVertical:12,width:"100%"},editableAdditionalRateRow:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",width:"100%"},rateNameAmountRowWithDelete:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",flex:1,marginRight:8},deleteButton:{padding:8,backgroundColor:f.theme.colors.surface,borderRadius:4,marginLeft:8},buttonsContainer:{flexDirection:"row",justifyContent:"flex-end",alignItems:"center",marginTop:16,marginBottom:8,marginRight:16},cancelButton:{backgroundColor:f.theme.colors.surface,borderRadius:4,paddingVertical:12,paddingHorizontal:20,marginRight:12},cancelButtonText:{color:f.theme.colors.text,fontSize:16,fontWeight:"600",fontFamily:f.theme.fonts.regular.fontFamily},multipleDatesContainer:{marginBottom:16},occurrenceCost:{fontSize:16,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily,fontWeight:"600"},ratesToggleButton:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",padding:8,backgroundColor:f.theme.colors.surface,borderRadius:4},ratesToggleText:{fontSize:16,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily},ratesBreakdown:{padding:16},rateItem:{flexDirection:"row",justifyContent:"space-between",marginBottom:8},rateLabel:{fontSize:16,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily},rateAmount:{fontSize:16,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily,fontWeight:"600"},rateDescription:{fontSize:14,color:f.theme.colors.placeHolderText,fontFamily:f.theme.fonts.regular.fontFamily},occurrenceDivider:{height:1,backgroundColor:f.theme.colors.border,marginBottom:16}}),co=({bookingData:e,onRatesUpdate:t,bookingId:o,showEditControls:n=!0,isProfessional:l=!0})=>{const{timeSettings:d}=(0,a.useContext)(p.AuthContext),[c,u]=(0,a.useState)(!1),[m,g]=(0,a.useState)(!1),[h,y]=(0,a.useState)(null),[b,x]=(0,a.useState)({name:"",amount:"",description:""}),[j,w]=(0,a.useState)(!1),[C,v]=(0,a.useState)(null),[B,k]=(0,a.useState)(new Set),[_,A]=(0,a.useState)(null),[I,D]=(0,a.useState)({}),[M,R]=(0,a.useState)(null),[P,z]=(0,a.useState)({name:"",amount:"",description:""}),{width:F}=(0,ve.default)();(0,a.useEffect)((()=>{if((0,p.debugLog)("MBA54321 ReviewAndRatesCard received bookingData:",e),(0,p.debugLog)("MBA54321 ReviewAndRatesCard received bookingId:",o),e?.occurrences?.[0]){const t={base_rate:0,additional_animal_rate:0,applies_after:1,holiday_rate:0,holiday_days:0,additional_rates:[]},o=e.occurrences[0].rates||t;y(Object.assign({},o))}}),[e,o]),(0,a.useEffect)((()=>{(0,p.debugLog)("MBA66777 Edit state changed:",{isEditMode:c,editingOccurrenceId:_,occurrencesCount:e?.occurrences?.length||0})}),[c,_,e?.occurrences?.length]);const L=e=>e?"$".concat(parseFloat(e).toFixed(2)):"$0.00",O=()=>{g(!m),x({name:"",amount:"",description:""})},E=e=>{let t=e.replace(/[^\d.]/g,"").replace(/(\..*)\./g,"$1");const o=t.split(".");return o.length>1&&o[1].length>2&&(t="".concat(o[0],".").concat(o[1].substring(0,2))),t},W=e=>{x((t=>Object.assign({},t,{amount:E(e)})))},N=e=>{z((t=>Object.assign({},t,{amount:E(e)})))},U=async()=>{if(h)try{w(!0),v(null),(0,p.debugLog)("MBA66777 Saving rate changes:",h),(0,p.debugLog)("MBA66777 Using bookingId:",o);const a=Object.assign({},h,{additional_rates:h.additional_rates&&h.additional_rates.length>0?h.additional_rates.map((e=>({title:e.name||e.title,amount:""===e.amount?0:"string"===typeof e.amount?parseFloat(e.amount):e.amount,description:e.description||"Additional rate"}))):[]}),n=e.occurrences.map(((e,t)=>0===t?{occurrence_id:e.occurrence_id,rates:{base_rate:""===h.base_rate?0:"string"===typeof h.base_rate?parseFloat(h.base_rate):h.base_rate,additional_animal_rate:""===h.additional_animal_rate?0:"string"===typeof h.additional_animal_rate?parseFloat(h.additional_animal_rate):h.additional_animal_rate||0,applies_after:parseInt(h.applies_after||1),holiday_rate:""===h.holiday_rate?0:"string"===typeof h.holiday_rate?parseFloat(h.holiday_rate):h.holiday_rate||0,additional_rates:a.additional_rates}}:{occurrence_id:e.occurrence_id,rates:{base_rate:parseFloat(e.rates.base_rate),additional_animal_rate:parseFloat(e.rates.additional_animal_rate||0),applies_after:parseInt(e.rates.applies_after||1),holiday_rate:parseFloat(e.rates.holiday_rate||0),additional_rates:(e.rates.additional_rates||[]).map((e=>({title:e.name||e.title,amount:parseFloat(e.amount),description:e.description||""})))}}));(0,p.debugLog)("MBA66777 Sending all occurrences to API:",n);const r=await(0,at.updateBookingDraftRates)(o,n);(0,p.debugLog)("MBA66777 Rate update API response:",r),r.draft_data&&t&&t(r.draft_data),u(!1),A(null),D({}),k(new Set),g(!1),R(null)}catch(a){(0,p.debugLog)("MBA66777 Error saving rate changes:",a),v("Failed to update rates. Please try again.")}finally{w(!1)}},V=async()=>{if(b.name&&(b.amount||""===b.amount))try{w(!0),v(null);b.name,""===b.amount||("string"===typeof b.amount?parseFloat(b.amount):b.amount),b.description;const a=Object.assign({},h);a.additional_rates||(a.additional_rates=[]),a.additional_rates.push({name:b.name,title:b.name,amount:""===b.amount?0:"string"===typeof b.amount?parseFloat(b.amount):b.amount,description:b.description||"Additional rate"});const n=e.occurrences.map(((e,t)=>0===t?{occurrence_id:e.occurrence_id,rates:{base_rate:parseFloat(a.base_rate),additional_animal_rate:parseFloat(a.additional_animal_rate||0),applies_after:parseInt(a.applies_after||1),holiday_rate:parseFloat(a.holiday_rate||0),additional_rates:a.additional_rates.map((e=>({title:e.name||e.title,amount:parseFloat(e.amount),description:e.description||"Additional rate"})))}}:{occurrence_id:e.occurrence_id,rates:{base_rate:parseFloat(e.rates.base_rate),additional_animal_rate:parseFloat(e.rates.additional_animal_rate||0),applies_after:parseInt(e.rates.applies_after||1),holiday_rate:parseFloat(e.rates.holiday_rate||0),additional_rates:(e.rates.additional_rates||[]).map((e=>({title:e.name||e.title,amount:parseFloat(e.amount),description:e.description||""})))}}));(0,p.debugLog)("MBA66777 Sending all occurrences with new rate to API:",n);const r=await(0,at.updateBookingDraftRates)(o,n);(0,p.debugLog)("MBA66777 New rate added API response:",r),r.draft_data&&(r.draft_data.occurrences&&r.draft_data.occurrences[0]&&y(r.draft_data.occurrences[0].rates),t&&t(r.draft_data)),g(!1),x({name:"",amount:"",description:""})}catch(a){(0,p.debugLog)("MBA66777 Error adding new rate:",a),v("Failed to add new rate. Please try again.")}finally{w(!1)}},Y=e=>{const t=E(e);y((e=>Object.assign({},e,{base_rate:t})))},G=e=>{const t=E(e);y((e=>Object.assign({},e,{additional_animal_rate:t})))},J=e=>{const t=E(e);y((e=>Object.assign({},e,{holiday_rate:t})))},$=(e,t,o)=>{if(!h?.additional_rates)return;const a=[...h.additional_rates];if("amount"===t){const t=E(o);a[e]=Object.assign({},a[e],{amount:""===t?"":t})}else"name"===t&&(a[e]=Object.assign({},a[e],{name:o}));y((e=>Object.assign({},e,{additional_rates:a})))},Z=async a=>{if(h?.additional_rates)try{w(!0),v(null);const n=Object.assign({},h),r=[...n.additional_rates];r.splice(a,1),n.additional_rates=r;const i=e.occurrences.map(((e,t)=>0===t?{occurrence_id:e.occurrence_id,rates:{base_rate:parseFloat(n.base_rate),additional_animal_rate:parseFloat(n.additional_animal_rate||0),applies_after:parseInt(n.applies_after||1),holiday_rate:parseFloat(n.holiday_rate||0),additional_rates:n.additional_rates.map((e=>({title:e.name||e.title,amount:parseFloat(e.amount),description:e.description||"Additional rate"})))}}:{occurrence_id:e.occurrence_id,rates:{base_rate:parseFloat(e.rates.base_rate),additional_animal_rate:parseFloat(e.rates.additional_animal_rate||0),applies_after:parseInt(e.rates.applies_after||1),holiday_rate:parseFloat(e.rates.holiday_rate||0),additional_rates:(e.rates.additional_rates||[]).map((e=>({title:e.name||e.title,amount:parseFloat(e.amount),description:e.description||""})))}}));(0,p.debugLog)("MBA66777 Sending all occurrences with updated rates to API:",i);const s=await(0,at.updateBookingDraftRates)(o,i);(0,p.debugLog)("MBA66777 Rate deleted API response:",s),s.draft_data&&(s.draft_data.occurrences&&s.draft_data.occurrences[0]&&y(s.draft_data.occurrences[0].rates),t&&t(s.draft_data))}catch(n){(0,p.debugLog)("MBA66777 Error deleting rate:",n),v("Failed to delete rate. Please try again.")}finally{w(!1)}},K=t=>{(0,p.debugLog)("MBA66777 Editing occurrence:",t),A(t.occurrence_id),1===e.occurrences.length?((0,p.debugLog)("MBA66777 Setting isEditMode for single occurrence booking"),u(!0),y({base_rate:t.rates.base_rate,additional_animal_rate:t.rates.additional_animal_rate||0,applies_after:t.rates.applies_after||1,holiday_rate:t.rates.holiday_rate||0,additional_rates:t.rates.additional_rates?.map((e=>({name:e.name||e.title,amount:e.amount,description:e.description||""})))||[]})):k(new Set([t.occurrence_id])),D({base_rate:t.rates.base_rate,additional_animal_rate:t.rates.additional_animal_rate||0,applies_after:t.rates.applies_after||1,holiday_rate:t.rates.holiday_rate||0,additional_rates:t.rates.additional_rates?.map((e=>({name:e.name||e.title,amount:e.amount,description:e.description||""})))||[]})},Q=()=>{A(null),D({}),1===e.occurrences.length&&u(!1),g(!1),R(null)},X=(e,t)=>{if("base_rate"===e||"additional_animal_rate"===e||"holiday_rate"===e){const o=E(t);D((t=>Object.assign({},t,{[e]:o})))}else D((o=>Object.assign({},o,{[e]:t})))},ee=(e,t,o)=>{(0,p.debugLog)("MBA66778 Changing additional rate at index ".concat(e,", field ").concat(t," to value: ").concat(o),{currentOccurrenceEdits:I,currentAdditionalRates:I.additional_rates}),D((a=>{const n=[...a.additional_rates||[]];if("amount"===t){const t=E(o);n[e]=Object.assign({},n[e],{amount:""===t?"":t})}else"name"===t&&(n[e]=Object.assign({},n[e],{name:o}));return(0,p.debugLog)("MBA66778 Updated additional rate:",{updatedRate:n[e],allRates:n}),Object.assign({},a,{additional_rates:n})}))},te=async(a,n)=>{try{w(!0),v(null);const r=Object.assign({},I);if(r.additional_rates&&r.additional_rates.length>n){r.additional_rates.splice(n,1),D(r);const i=e.occurrences.map((e=>e.occurrence_id===a.occurrence_id?{occurrence_id:a.occurrence_id,rates:{base_rate:parseFloat(r.base_rate),additional_animal_rate:parseFloat(r.additional_animal_rate||0),applies_after:parseInt(r.applies_after||1),holiday_rate:parseFloat(r.holiday_rate||0),additional_rates:r.additional_rates.map((e=>({title:e.name,amount:parseFloat(e.amount),description:e.description||""})))}}:{occurrence_id:e.occurrence_id,rates:{base_rate:parseFloat(e.rates.base_rate),additional_animal_rate:parseFloat(e.rates.additional_animal_rate||0),applies_after:parseInt(e.rates.applies_after||1),holiday_rate:parseFloat(e.rates.holiday_rate||0),additional_rates:(e.rates.additional_rates||[]).map((e=>({title:e.name||e.title,amount:parseFloat(e.amount),description:e.description||""})))}}));(0,p.debugLog)("MBA54321 - Sending all occurrences with rate deleted to API:",i);const s=await(0,at.updateBookingDraftRates)(o,i);(0,p.debugLog)("MBA54321 - Rate deleted from occurrence API response:",s),s.draft_data&&t&&t(s.draft_data)}}catch(r){(0,p.debugLog)("MBA66777 Error deleting rate for occurrence:",r),v("Failed to delete rate. Please try again.")}finally{w(!1)}},oe=(e,t,o)=>{if(_===e.occurrence_id&&I.additional_rates){const e=I.additional_rates[t]?.[o];return"amount"===o&&0===e?"":e||""}if(c&&h?.additional_rates){const e=h.additional_rates[t]?.[o];return"amount"===o&&0===e?"":e||""}const a=(e.rates?.additional_rates||[])[t]||{},n="name"===o?a.name||a.title:a[o];return"amount"===o&&0===n?"":n||""};return(0,T.jsxs)(H.default,{style:lo.container,contentContainerStyle:lo.contentContainer,children:[(()=>{(0,p.debugLog)("MBAio3htg5uohg: Rendering booking breakdown with data:",e?.occurrences?.[0]);const l=e?.occurrences;if(!l||0===l.length)return null;const{timeSettings:d}=(0,a.useContext)(p.AuthContext),y=d?.timezone||"US/Mountain";(0,p.debugLog)("MBAio3htg5uohg: userTimezone: ",y);const j=l.length>1||1===l.length&&(l[0].end_date!==l[0].start_date&&"00:00"===l[0].end_time||l[0].start_date===l[0].end_date);if((0,p.debugLog)("MBAio3htg5uohg: isMultipleDates detection:",{isMultipleDates:j,count:l.length,firstOccurrence:l[0]?{start_date:l[0].start_date,end_date:l[0].end_date,end_time:l[0].end_time}:null}),j)return(0,T.jsxs)(r.default,{style:[lo.section,{marginTop:n?24:0}],children:[(0,T.jsx)(r.default,{style:lo.sectionHeaderContainer,children:(0,T.jsx)(i.default,{style:lo.sectionHeader,children:"Booking Breakdown"})}),(0,T.jsx)(r.default,{style:[lo.card,{paddingTop:16}],children:l.map(((a,l)=>{const d=a.unit_of_time||a.rates&&a.rates.unit_of_time||"Per Visit",m=parseFloat(a.multiple)||1;return(0,p.debugLog)("MBAio3htg5uohg: Processing occurrence in UI:",{id:a.occurrence_id,unit_of_time:d,multiple:m,calculated_cost:a.calculated_cost}),(0,T.jsxs)(r.default,{style:lo.multipleDatesContainer,children:[(0,T.jsxs)(r.default,{style:lo.dateHeader,children:[(0,T.jsx)(r.default,{style:lo.dateTextContainer,children:(0,T.jsx)(i.default,{style:lo.dateText,children:(0,ro.formatDateTimeRangeFromUTC)({startDate:a.start_date,startTime:a.start_time,endDate:a.end_date,endTime:a.end_time,userTimezone:y,includeTimes:!0,includeTimezone:!0})})}),(0,T.jsx)(i.default,{style:lo.occurrenceCost,children:L(a.calculated_cost)}),_===a.occurrence_id?(0,T.jsx)(s.default,{onPress:Q,children:(0,T.jsx)(S.default,{name:"close",size:20,color:f.theme.colors.error})}):n&&(0,T.jsx)(s.default,{onPress:()=>K(a),children:(0,T.jsx)(S.default,{name:"pencil",size:20,color:f.theme.colors.mainColors.main})})]}),(0,T.jsxs)(s.default,{style:lo.ratesToggleButton,onPress:()=>{const e=new Set(B);e.has(a.occurrence_id)?e.delete(a.occurrence_id):e.add(a.occurrence_id),k(e)},children:[(0,T.jsx)(i.default,{style:lo.ratesToggleText,children:B.has(a.occurrence_id)?"Hide Rates":"Show Rates"}),(0,T.jsx)(S.default,{name:B.has(a.occurrence_id)?"chevron-up":"chevron-down",size:20,color:f.theme.colors.mainColors.main})]}),B.has(a.occurrence_id)&&(0,T.jsxs)(r.default,{style:lo.ratesBreakdown,children:[(0,T.jsxs)(r.default,{style:lo.rateItem,children:[_===a.occurrence_id?(0,T.jsxs)(r.default,{style:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",width:"100%"},children:[(0,T.jsxs)(i.default,{style:lo.rateLabel,children:["Base Rate (",d,")"]}),(0,T.jsx)(q.default,{style:{width:80,borderWidth:1,borderColor:f.theme.colors.border,borderRadius:4,padding:8},keyboardType:"decimal-pad",value:I.base_rate?.toString()||"",onChangeText:e=>X("base_rate",e)})]}):(0,T.jsxs)(r.default,{children:[(0,T.jsx)(i.default,{style:lo.rateLabel,children:"Base Rate"}),(0,T.jsxs)(i.default,{style:lo.breakdownCalculation,children:[L(a.rates.base_rate)," (",d,") \xd7 ",m," = ",L(a.base_total)]})]}),_===a.occurrence_id?null:(0,T.jsx)(i.default,{style:lo.rateAmount,children:L(a.base_total)})]}),a.rates?.additional_animal_rate&&parseFloat(a.rates.additional_animal_rate)>0&&a.rates?.applies_after&&a.rates.applies_after<(e.pets?.length||0)&&(0,T.jsxs)(r.default,{style:lo.rateItem,children:[_===a.occurrence_id?(0,T.jsxs)(r.default,{style:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",width:"100%"},children:[(0,T.jsxs)(i.default,{style:lo.rateLabel,children:["Additional Pet Rate (after ",a.rates.applies_after," ",1!==a.rates.applies_after?"pets":"pet",")"]}),(0,T.jsx)(q.default,{style:{width:80,borderWidth:1,borderColor:f.theme.colors.border,borderRadius:4,padding:8},keyboardType:"decimal-pad",value:I.additional_animal_rate?.toString()||"",onChangeText:e=>X("additional_animal_rate",e)})]}):(0,T.jsxs)(i.default,{style:lo.rateLabel,children:["Additional Pet Rate (after ",a.rates.applies_after," ",1!==a.rates.applies_after?"pets":"pet",")"]}),_===a.occurrence_id?null:(0,T.jsx)(i.default,{style:lo.rateAmount,children:L(a.rates.additional_animal_rate)})]}),a.rates?.holiday_rate&&parseFloat(a.rates.holiday_rate)>0&&(a.rates?.holiday_days>0||!("holiday_days"in a.rates))&&(0,T.jsxs)(r.default,{style:lo.rateItem,children:[_===a.occurrence_id?(0,T.jsxs)(r.default,{style:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",width:"100%"},children:[(0,T.jsx)(i.default,{style:lo.rateLabel,children:"Holiday Rate"}),(0,T.jsx)(q.default,{style:{width:80,borderWidth:1,borderColor:f.theme.colors.border,borderRadius:4,padding:8},keyboardType:"decimal-pad",value:I.holiday_rate?.toString()||"",onChangeText:e=>X("holiday_rate",e)})]}):(0,T.jsx)(i.default,{style:lo.rateLabel,children:"Holiday Rate"}),_===a.occurrence_id?null:(0,T.jsx)(i.default,{style:lo.rateAmount,children:L(a.rates.holiday_rate)})]}),((c?h?.additional_rates:a.rates?.additional_rates)||[]).length>0?((c?h?.additional_rates:a.rates?.additional_rates)||[]).map(((e,t)=>(0,T.jsxs)(r.default,{style:lo.breakdownItem,children:[(0,T.jsx)(r.default,{style:lo.breakdownLabelContainer,children:c||_===a.occurrence_id?F<600?(0,T.jsxs)(r.default,{style:{width:"100%"},children:[(0,T.jsxs)(r.default,{style:{flexDirection:"row",alignItems:"center",justifyContent:"space-between"},children:[(0,p.debugLog)("MBA66778 Rendering rate at index ".concat(t,":"),{isEditMode:c,editingOccurrenceId:_,occurrenceId:a.occurrence_id,rateName:e.name||e.title,rateAmount:e.amount,occurrenceEditsRate:I.additional_rates?.[t],valueToShow:_===a.occurrence_id?I.additional_rates&&I.additional_rates[t]?.amount?.toString()||"0":e.amount?.toString()||"0"}),(0,T.jsx)(q.default,{style:[lo.nameInput,{flex:1,marginRight:8}],value:oe(a,t,"name"),onChangeText:e=>_===a.occurrence_id?ee(t,"name",e):$(t,"name",e),placeholder:"Rate Name"}),(0,T.jsx)(s.default,{style:lo.deleteButton,onPress:()=>_===a.occurrence_id?te(a,t):Z(t),children:(0,T.jsx)(S.default,{name:"trash-can-outline",size:22,color:f.theme.colors.error})})]}),(0,T.jsx)(r.default,{style:{marginTop:8},children:(0,T.jsxs)(r.default,{style:{flexDirection:"row",alignItems:"center"},children:[(0,T.jsx)(i.default,{style:{marginRight:8},children:"Amount: $"}),(0,T.jsx)(q.default,{style:{width:80,borderWidth:1,borderColor:f.theme.colors.border,borderRadius:4,padding:8},keyboardType:"decimal-pad",value:""===oe(a,t,"amount")?"":oe(a,t,"amount").toString(),onChangeText:e=>_===a.occurrence_id?ee(t,"amount",e):$(t,"amount",e)})]})})]}):(0,T.jsxs)(r.default,{style:lo.editableAdditionalRateRow,children:[(0,T.jsxs)(r.default,{style:lo.rateNameAmountRowWithDelete,children:[(0,T.jsx)(q.default,{style:lo.nameInput,value:oe(a,t,"name"),onChangeText:e=>_===a.occurrence_id?ee(t,"name",e):$(t,"name",e),placeholder:"Rate Name"}),(0,T.jsxs)(r.default,{style:lo.amountInputContainer,children:[(0,T.jsx)(i.default,{style:lo.currencySymbol,children:"$"}),(0,T.jsx)(q.default,{style:lo.rateInput,keyboardType:"decimal-pad",value:""===oe(a,t,"amount")?"":oe(a,t,"amount").toString(),onChangeText:e=>_===a.occurrence_id?ee(t,"amount",e):$(t,"amount",e)})]})]}),(0,T.jsx)(s.default,{style:lo.deleteButton,onPress:()=>_===a.occurrence_id?te(a,t):Z(t),children:(0,T.jsx)(S.default,{name:"trash-can-outline",size:22,color:f.theme.colors.error})})]}):(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(i.default,{style:lo.breakdownLabel,children:e.name||e.title}),(0,T.jsx)(i.default,{style:lo.breakdownCalculation,children:e.description||"Additional Rate"})]})}),!c&&_!==a.occurrence_id&&(0,T.jsxs)(i.default,{style:lo.breakdownAmount,children:["+",L(e.amount)]})]},t))):null]}),M===a.occurrence_id&&(0,T.jsxs)(r.default,{children:[(0,T.jsxs)(r.default,{style:lo.addRateContainer,children:[(0,T.jsx)(r.default,{style:lo.formDivider}),F<600?(0,T.jsxs)(r.default,{children:[(0,T.jsx)(q.default,{style:[lo.nameInput,{marginRight:0,marginBottom:12}],value:P.name,onChangeText:e=>z((t=>Object.assign({},t,{name:e}))),placeholder:"Rate Name",placeholderTextColor:f.theme.colors.placeHolderText}),(0,T.jsxs)(r.default,{style:[lo.amountInputContainer,{marginBottom:12}],children:[(0,T.jsx)(i.default,{style:lo.currencySymbol,children:"$"}),(0,T.jsx)(q.default,{style:lo.rateInput,keyboardType:"decimal-pad",value:P.amount,onChangeText:N,placeholder:"0.00",placeholderTextColor:f.theme.colors.placeHolderText})]}),(0,T.jsx)(q.default,{style:lo.descriptionInput,value:P.description,onChangeText:e=>z((t=>Object.assign({},t,{description:e}))),placeholder:"Description (optional)",placeholderTextColor:f.theme.colors.placeHolderText})]}):(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)(r.default,{style:lo.rateNameAmountRow,children:[(0,T.jsx)(q.default,{style:lo.nameInput,value:P.name,onChangeText:e=>z((t=>Object.assign({},t,{name:e}))),placeholder:"Rate Name",placeholderTextColor:f.theme.colors.placeHolderText}),(0,T.jsxs)(r.default,{style:lo.amountInputContainer,children:[(0,T.jsx)(i.default,{style:lo.currencySymbol,children:"$"}),(0,T.jsx)(q.default,{style:lo.rateInput,keyboardType:"decimal-pad",value:P.amount,onChangeText:N,placeholder:"0.00",placeholderTextColor:f.theme.colors.placeHolderText})]})]}),(0,T.jsx)(q.default,{style:lo.descriptionInput,value:P.description,onChangeText:e=>z((t=>Object.assign({},t,{description:e}))),placeholder:"Description (optional)",placeholderTextColor:f.theme.colors.placeHolderText})]}),(0,T.jsx)(r.default,{style:lo.formDivider})]}),(0,T.jsxs)(r.default,{style:lo.buttonsContainer,children:[(0,T.jsx)(s.default,{style:lo.cancelButton,onPress:()=>R(null),children:(0,T.jsx)(i.default,{style:lo.cancelButtonText,children:"Cancel"})}),(0,T.jsx)(s.default,{style:lo.saveButton,onPress:()=>(async a=>{if(P.name&&(P.amount||""===P.amount))try{w(!0),v(null);const n=Object.assign({},I);n.additional_rates||(n.additional_rates=[]),n.additional_rates.push({name:P.name,title:P.name,amount:""===P.amount?0:"string"===typeof P.amount?parseFloat(P.amount):P.amount,description:P.description||"Additional rate"}),D(n);const r=e.occurrences.map((e=>e.occurrence_id===a.occurrence_id?{occurrence_id:a.occurrence_id,rates:{base_rate:parseFloat(n.base_rate),additional_animal_rate:parseFloat(n.additional_animal_rate||0),applies_after:parseInt(n.applies_after||1),holiday_rate:parseFloat(n.holiday_rate||0),additional_rates:n.additional_rates.map((e=>({title:e.name,amount:parseFloat(e.amount),description:e.description||""})))}}:{occurrence_id:e.occurrence_id,rates:{base_rate:parseFloat(e.rates.base_rate),additional_animal_rate:parseFloat(e.rates.additional_animal_rate||0),applies_after:parseInt(e.rates.applies_after||1),holiday_rate:parseFloat(e.rates.holiday_rate||0),additional_rates:(e.rates.additional_rates||[]).map((e=>({title:e.name||e.title,amount:parseFloat(e.amount),description:e.description||""})))}}));(0,p.debugLog)("MBA54321 - Sending all occurrences with new rate to API:",r);const i=await(0,at.updateBookingDraftRates)(o,r);(0,p.debugLog)("MBA54321 - New rate added to occurrence API response:",i),i.draft_data&&t&&t(i.draft_data),R(null),z({name:"",amount:"",description:""})}catch(n){(0,p.debugLog)("MBA66777 Error adding new rate for occurrence:",n),v("Failed to add new rate. Please try again.")}finally{w(!1)}})(a),children:(0,T.jsx)(i.default,{style:lo.saveButtonText,children:"Save New Rate"})})]})]}),_===a.occurrence_id&&!M&&(0,T.jsxs)(r.default,{style:lo.buttonsContainer,children:[(0,T.jsx)(s.default,{style:lo.cancelButton,onPress:()=>{return e=a.occurrence_id,R(M===e?null:e),void z({name:"",amount:"",description:""});var e},children:(0,T.jsx)(i.default,{style:lo.cancelButtonText,children:"+ Add Rate"})}),(0,T.jsx)(s.default,{style:lo.saveButton,onPress:()=>(async a=>{try{w(!0),v(null);const n=Object.assign({},I,{additional_rates:(I.additional_rates||[]).map((e=>({title:e.name||e.title,amount:""===e.amount?0:"string"===typeof e.amount?parseFloat(e.amount):e.amount,description:e.description||""})))}),r=e.occurrences.map((e=>e.occurrence_id===a.occurrence_id?{occurrence_id:a.occurrence_id,rates:{base_rate:""===I.base_rate?0:"string"===typeof I.base_rate?parseFloat(I.base_rate):I.base_rate,additional_animal_rate:""===I.additional_animal_rate?0:"string"===typeof I.additional_animal_rate?parseFloat(I.additional_animal_rate):I.additional_animal_rate||0,applies_after:parseInt(I.applies_after||1),holiday_rate:""===I.holiday_rate?0:"string"===typeof I.holiday_rate?parseFloat(I.holiday_rate):I.holiday_rate||0,additional_rates:n.additional_rates}}:{occurrence_id:e.occurrence_id,rates:{base_rate:parseFloat(e.rates.base_rate),additional_animal_rate:parseFloat(e.rates.additional_animal_rate||0),applies_after:parseInt(e.rates.applies_after||1),holiday_rate:parseFloat(e.rates.holiday_rate||0),additional_rates:(e.rates.additional_rates||[]).map((e=>({title:e.name||e.title,amount:parseFloat(e.amount),description:e.description||""})))}}));(0,p.debugLog)("MBA54321 - Sending all occurrences to API:",r);const i=await(0,at.updateBookingDraftRates)(o,r);i.draft_data&&(t&&t(i.draft_data),A(null),D({}),1===e.occurrences.length&&u(!1),k(new Set),g(!1),R(null))}catch(n){(0,p.debugLog)("MBA54321 - Error saving occurrence rates:",n),v("Failed to update rates. Please try again.")}finally{w(!1)}})(a),children:(0,T.jsx)(i.default,{style:lo.saveButtonText,children:"Save Changes"})})]})]},a.occurrence_id)}))})]});const C=l[0];if(!C)return null;const E=(0,ro.formatDateTimeRangeFromUTC)({startDate:C.start_date,startTime:C.start_time,endDate:C.end_date,endTime:C.end_time,userTimezone:y,includeTimes:!0,includeTimezone:!0});return(0,p.debugLog)("MBA54321 Formatted date range:",E),C.rates||((0,p.debugLog)("MBA54321 occurrence.rates is undefined, initializing with defaults"),C.rates={base_rate:0,additional_animal_rate:0,applies_after:1,holiday_rate:0,holiday_days:0,additional_rates:[]}),(0,T.jsxs)(r.default,{style:[lo.section,{marginTop:n?24:0}],children:[(0,T.jsx)(r.default,{style:lo.sectionHeaderContainer,children:(0,T.jsx)(i.default,{style:lo.sectionHeader,children:"Booking Breakdown"})}),(0,T.jsx)(r.default,{style:[lo.card,{paddingTop:16}],children:(0,T.jsxs)(r.default,{style:lo.breakdownSection,children:[(0,T.jsxs)(r.default,{style:lo.dateHeader,children:[(0,T.jsx)(r.default,{style:lo.dateTextContainer,children:(0,T.jsx)(i.default,{style:lo.dateText,children:(0,ro.formatDateTimeRangeFromUTC)({startDate:C.start_date,startTime:C.start_time,endDate:C.end_date,endTime:C.end_time,userTimezone:y,includeTimes:!0,includeTimezone:!0})})}),(0,T.jsx)(i.default,{style:lo.occurrenceCost,children:L(C.calculated_cost)}),_===C.occurrence_id?(0,T.jsx)(s.default,{onPress:Q,children:(0,T.jsx)(S.default,{name:"close",size:20,color:f.theme.colors.error})}):n&&(0,T.jsx)(s.default,{onPress:()=>K(C),children:(0,T.jsx)(S.default,{name:"pencil",size:20,color:f.theme.colors.mainColors.main})})]}),(0,T.jsxs)(r.default,{style:lo.breakdownItem,children:[(0,T.jsxs)(r.default,{style:lo.breakdownLabelContainer,children:[(0,T.jsxs)(r.default,{style:lo.rateNameAmountRow,children:[(0,T.jsxs)(i.default,{style:lo.breakdownLabel,children:["Base Rate (",C.unit_of_time||C.rates&&C.rates.unit_of_time||"Per Visit",")"]}),c||_===C.occurrence_id?(0,T.jsxs)(r.default,{style:lo.amountInputContainer,children:[(0,T.jsx)(i.default,{style:lo.currencySymbol,children:"$"}),(0,T.jsx)(q.default,{style:lo.rateInput,keyboardType:"decimal-pad",value:_===C.occurrence_id?I.base_rate?.toString()||"0":h?.base_rate?.toString()||"0",onChangeText:_===C.occurrence_id?e=>X("base_rate",e):Y})]}):null]}),!c&&_!==C.occurrence_id&&(0,T.jsxs)(i.default,{style:lo.breakdownCalculation,children:[C.multiple||1," \xd7 ",L(C.rates?.base_rate||0)," = ",L(C.base_total||C.rates?.base_rate||0)]})]}),!c&&_!==C.occurrence_id&&(0,T.jsx)(i.default,{style:lo.breakdownAmount,children:L(C.base_total||C.rates?.base_rate||0)})]}),C.rates?.additional_animal_rate&&C.rates?.applies_after&&C.rates.applies_after<(e.pets?.length||0)?(0,T.jsxs)(r.default,{style:lo.breakdownItem,children:[(0,T.jsxs)(r.default,{style:lo.breakdownLabelContainer,children:[(0,T.jsxs)(r.default,{style:lo.rateNameAmountRow,children:[(0,T.jsxs)(i.default,{style:lo.breakdownLabel,children:["Additional Pet Rate (after ",C.rates?.applies_after||1," ",1!==C.rates?.applies_after?"pets":"pet",")"]}),c||_===C.occurrence_id?(0,T.jsxs)(r.default,{style:lo.amountInputContainer,children:[(0,T.jsx)(i.default,{style:lo.currencySymbol,children:"$"}),(0,T.jsx)(q.default,{style:lo.rateInput,keyboardType:"decimal-pad",value:_===C.occurrence_id?I.additional_animal_rate?.toString()||"0":h?.additional_animal_rate?.toString()||"0",onChangeText:_===C.occurrence_id?e=>X("additional_animal_rate",e):G}),(0,T.jsxs)(i.default,{style:lo.inputLabel,children:[" / pet / ",C.unit_of_time||C.rates&&C.rates.unit_of_time||"Per Visit"]})]}):null]}),!c&&_!==C.occurrence_id&&(0,T.jsxs)(i.default,{style:lo.breakdownCalculation,children:["$",C.rates?.additional_animal_rate||0," / pet / ",C.unit_of_time||C.rates&&C.rates.unit_of_time||"Per Visit"]})]}),!c&&_!==C.occurrence_id&&(0,T.jsxs)(i.default,{style:lo.breakdownAmount,children:[C.rates?.applies_after&&C.rates.applies_after<(e.pets?.length||0)?"+":"",C.rates?.applies_after&&C.rates.applies_after<(e.pets?.length||0)?L(C.rates?.additional_animal_rate_total||C.rates?.additional_animal_rate||0):"NA"]})]}):null,C.rates?.holiday_rate&&C.rates?.holiday_days&&C.rates.holiday_days>0?(0,T.jsxs)(r.default,{style:[lo.breakdownItem,{borderBottomWidth:C.rates?.additional_rates?.length>0||m?1:0}],children:[(0,T.jsxs)(r.default,{style:lo.breakdownLabelContainer,children:[(0,T.jsxs)(r.default,{style:lo.rateNameAmountRow,children:[(0,T.jsx)(i.default,{style:lo.breakdownLabel,children:"Holiday Rate"}),c||_===C.occurrence_id?(0,T.jsxs)(r.default,{style:lo.amountInputContainer,children:[(0,T.jsx)(i.default,{style:lo.currencySymbol,children:"$"}),(0,T.jsx)(q.default,{style:lo.rateInput,keyboardType:"decimal-pad",value:_===C.occurrence_id?I.holiday_rate?.toString()||"0":h?.holiday_rate?.toString()||"0",onChangeText:_===C.occurrence_id?e=>X("holiday_rate",e):J}),(0,T.jsxs)(i.default,{style:lo.inputLabel,children:[" \xd7 ",C.rates?.holiday_days||0," ",1!==C.rates?.holiday_days?"holidays":"holiday"]})]}):null]}),!c&&_!==C.occurrence_id&&(0,T.jsxs)(i.default,{style:lo.breakdownCalculation,children:[L(C.rates?.holiday_rate||0)," \xd7 ",C.rates?.holiday_days||0," ",1!==C.rates?.holiday_days?"holidays":"holiday"]})]}),!c&&_!==C.occurrence_id&&(0,T.jsxs)(i.default,{style:lo.breakdownAmount,children:[C.rates?.holiday_days?"+":"",C.rates?.holiday_days?L(C.rates?.holiday_rate_total||C.rates?.holiday_rate||0):"NA"]})]}):null,((c?h?.additional_rates:C.rates?.additional_rates)||[]).length>0?((c?h?.additional_rates:C.rates?.additional_rates)||[]).map(((e,t)=>(0,T.jsxs)(r.default,{style:lo.breakdownItem,children:[(0,T.jsx)(r.default,{style:lo.breakdownLabelContainer,children:c||_===C.occurrence_id?F<600?(0,T.jsxs)(r.default,{style:{width:"100%"},children:[(0,T.jsxs)(r.default,{style:{flexDirection:"row",alignItems:"center",justifyContent:"space-between"},children:[(0,p.debugLog)("MBA66778 Rendering rate at index ".concat(t,":"),{isEditMode:c,editingOccurrenceId:_,occurrenceId:C.occurrence_id,rateName:e.name||e.title,rateAmount:e.amount,occurrenceEditsRate:I.additional_rates?.[t],valueToShow:_===C.occurrence_id?I.additional_rates&&I.additional_rates[t]?.amount?.toString()||"0":e.amount?.toString()||"0"}),(0,T.jsx)(q.default,{style:[lo.nameInput,{flex:1,marginRight:8}],value:oe(C,t,"name"),onChangeText:e=>_===C.occurrence_id?ee(t,"name",e):$(t,"name",e),placeholder:"Rate Name"}),(0,T.jsx)(s.default,{style:lo.deleteButton,onPress:()=>_===C.occurrence_id?te(C,t):Z(t),children:(0,T.jsx)(S.default,{name:"trash-can-outline",size:22,color:f.theme.colors.error})})]}),(0,T.jsx)(r.default,{style:{marginTop:8},children:(0,T.jsxs)(r.default,{style:{flexDirection:"row",alignItems:"center"},children:[(0,T.jsx)(i.default,{style:{marginRight:8},children:"Amount: $"}),(0,T.jsx)(q.default,{style:{width:80,borderWidth:1,borderColor:f.theme.colors.border,borderRadius:4,padding:8},keyboardType:"decimal-pad",value:""===oe(C,t,"amount")?"":oe(C,t,"amount").toString(),onChangeText:e=>_===C.occurrence_id?ee(t,"amount",e):$(t,"amount",e)})]})})]}):(0,T.jsxs)(r.default,{style:lo.editableAdditionalRateRow,children:[(0,T.jsxs)(r.default,{style:lo.rateNameAmountRowWithDelete,children:[(0,T.jsx)(q.default,{style:lo.nameInput,value:oe(C,t,"name"),onChangeText:e=>_===C.occurrence_id?ee(t,"name",e):$(t,"name",e),placeholder:"Rate Name"}),(0,T.jsxs)(r.default,{style:lo.amountInputContainer,children:[(0,T.jsx)(i.default,{style:lo.currencySymbol,children:"$"}),(0,T.jsx)(q.default,{style:lo.rateInput,keyboardType:"decimal-pad",value:""===oe(C,t,"amount")?"":oe(C,t,"amount").toString(),onChangeText:e=>_===C.occurrence_id?ee(t,"amount",e):$(t,"amount",e)})]})]}),(0,T.jsx)(s.default,{style:lo.deleteButton,onPress:()=>_===C.occurrence_id?te(C,t):Z(t),children:(0,T.jsx)(S.default,{name:"trash-can-outline",size:22,color:f.theme.colors.error})})]}):(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(i.default,{style:lo.breakdownLabel,children:e.name||e.title}),(0,T.jsx)(i.default,{style:lo.breakdownCalculation,children:e.description||"Additional Rate"})]})}),!c&&_!==C.occurrence_id&&(0,T.jsxs)(i.default,{style:lo.breakdownAmount,children:["+",L(e.amount)]})]},t))):null,m?(0,T.jsxs)(r.default,{children:[(0,T.jsxs)(r.default,{style:lo.addRateContainer,children:[(0,T.jsx)(r.default,{style:lo.formDivider}),F<600?(0,T.jsxs)(r.default,{children:[(0,T.jsx)(q.default,{style:[lo.nameInput,{marginRight:0,marginBottom:12}],value:b.name,onChangeText:e=>x((t=>Object.assign({},t,{name:e}))),placeholder:"Rate Name",placeholderTextColor:f.theme.colors.placeHolderText}),(0,T.jsxs)(r.default,{style:[lo.amountInputContainer,{marginBottom:12}],children:[(0,T.jsx)(i.default,{style:lo.currencySymbol,children:"$"}),(0,T.jsx)(q.default,{style:lo.rateInput,keyboardType:"decimal-pad",value:b.amount,onChangeText:W,placeholder:"0.00",placeholderTextColor:f.theme.colors.placeHolderText})]}),(0,T.jsx)(q.default,{style:lo.descriptionInput,value:b.description,onChangeText:e=>x((t=>Object.assign({},t,{description:e}))),placeholder:"Description (optional)",placeholderTextColor:f.theme.colors.placeHolderText})]}):(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)(r.default,{style:lo.rateNameAmountRow,children:[(0,T.jsx)(q.default,{style:lo.nameInput,value:b.name,onChangeText:e=>x((t=>Object.assign({},t,{name:e}))),placeholder:"Rate Name",placeholderTextColor:f.theme.colors.placeHolderText}),(0,T.jsxs)(r.default,{style:lo.amountInputContainer,children:[(0,T.jsx)(i.default,{style:lo.currencySymbol,children:"$"}),(0,T.jsx)(q.default,{style:lo.rateInput,keyboardType:"decimal-pad",value:b.amount,onChangeText:W,placeholder:"0.00",placeholderTextColor:f.theme.colors.placeHolderText})]})]}),(0,T.jsx)(q.default,{style:lo.descriptionInput,value:b.description,onChangeText:e=>x((t=>Object.assign({},t,{description:e}))),placeholder:"Description (optional)",placeholderTextColor:f.theme.colors.placeHolderText})]}),(0,T.jsx)(r.default,{style:lo.formDivider})]}),(0,T.jsxs)(r.default,{style:lo.buttonsContainer,children:[(0,T.jsx)(s.default,{style:lo.cancelButton,onPress:O,children:(0,T.jsx)(i.default,{style:lo.cancelButtonText,children:"Cancel"})}),(0,T.jsx)(s.default,{style:lo.saveButton,onPress:V,children:(0,T.jsx)(i.default,{style:lo.saveButtonText,children:"Save New Rate"})})]})]}):null,c&&!m&&(0,T.jsxs)(r.default,{style:lo.buttonsContainer,children:[(0,T.jsx)(s.default,{style:lo.cancelButton,onPress:O,children:(0,T.jsx)(i.default,{style:lo.cancelButtonText,children:"+ Add Rate"})}),(0,T.jsx)(s.default,{style:lo.saveButton,onPress:U,children:(0,T.jsx)(i.default,{style:lo.saveButtonText,children:"Save Changes"})})]})]})})]})})(),(()=>{(0,p.debugLog)("MBA54321 Rendering total amount with data:",e?.cost_summary);const t=e?.cost_summary||{subtotal:0,client_platform_fee:0,pro_platform_fee:0,taxes:0,tax_state:"",total_client_cost:0,total_sitter_payout:0,pro_subscription_plan:0};return(0,T.jsxs)(r.default,{style:lo.section,children:[(0,T.jsx)(i.default,{style:lo.sectionHeader,children:"Cost Summary"}),(0,T.jsxs)(r.default,{style:[lo.card,{paddingTop:16}],children:[(0,T.jsxs)(r.default,{style:lo.subtotalRow,children:[(0,T.jsx)(i.default,{style:lo.subtotalLabel,children:"Subtotal"}),(0,T.jsx)(i.default,{style:lo.subtotalAmount,children:L(t.subtotal)})]}),(0,T.jsxs)(r.default,{style:lo.feeRow,children:[(0,T.jsx)(i.default,{style:lo.feeLabel,children:"Service Fee"}),(0,T.jsx)(i.default,{style:lo.feeAmount,children:L(t.client_platform_fee)})]}),(0,T.jsxs)(r.default,{style:lo.feeRow,children:[(0,T.jsxs)(i.default,{style:lo.feeLabel,children:[t.tax_state,t.tax_state?" - ":"","Taxes"]}),(0,T.jsx)(i.default,{style:lo.feeAmount,children:L(t.taxes)})]}),(0,T.jsxs)(r.default,{style:[lo.totalAmountContainer,{paddingBottom:l?16:0,marginBottom:l?16:0}],children:[(0,T.jsx)(i.default,{style:lo.totalLabel,children:"Total Owner Cost"}),(0,T.jsx)(i.default,{style:lo.totalAmount,children:L(t.total_client_cost)})]}),l?(0,T.jsx)(r.default,{style:lo.divider}):null,l?(0,T.jsxs)(r.default,{style:lo.payoutContainer,children:[(0,T.jsx)(i.default,{style:lo.payoutLabel,children:"Professional Payout"}),(0,T.jsx)(i.default,{style:lo.payoutAmount,children:L(t.total_sitter_payout)}),(0,T.jsxs)(i.default,{style:lo.payoutBreakdown,children:["(Subtotal ",L(t.subtotal)," - Service Fee ",L(t.pro_platform_fee),")"]}),0===t.pro_platform_fee?(0,T.jsxs)(i.default,{style:lo.badge,children:[0===t.pro_subscription_plan?"Free Tier - ":1===t.pro_subscription_plan?"Waitlist Tier - ":2===t.pro_subscription_plan?"Commission Tier - ":3===t.pro_subscription_plan||4===t.pro_subscription_plan?"Pro Subscription - ":5===t.pro_subscription_plan?"Client Subscription - ":""," Saved ",L(.15*t.subtotal)]}):null]}):null]})]})})()]})},uo=l.default.create({safeArea:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center"},container:{flex:1,backgroundColor:f.theme.colors.background,margin:"web"===n.default.OS?0:24,borderRadius:12,overflow:"hidden"},desktopContainer:{maxWidth:800,maxHeight:"90%",alignSelf:"center",marginTop:"5%"},header:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:16,borderBottomWidth:1,borderBottomColor:f.theme.colors.border,backgroundColor:f.theme.colors.surface},title:{fontSize:20,fontWeight:"bold",color:f.theme.colors.text,fontFamily:f.theme.fonts.header.fontFamily},closeButton:{padding:8},scrollContainer:{flex:1},scrollContent:{padding:16,paddingBottom:32},footerContainer:{flexDirection:"row",justifyContent:"space-between",padding:16,borderTopWidth:1,borderTopColor:f.theme.colors.border,backgroundColor:f.theme.colors.surface},button:{paddingVertical:12,paddingHorizontal:16,borderRadius:8,borderWidth:1,borderColor:f.theme.colors.primary,alignItems:"center",justifyContent:"center",flex:1,marginRight:8},buttonText:{color:f.theme.colors.primary,fontSize:16,fontWeight:"600",fontFamily:f.theme.fonts.regular.fontFamily},approveButton:{paddingVertical:12,paddingHorizontal:16,borderRadius:8,backgroundColor:f.theme.colors.primary,alignItems:"center",justifyContent:"center",flex:1,marginLeft:8},approveText:{color:"white",fontSize:16,fontWeight:"600",fontFamily:f.theme.fonts.regular.fontFamily},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:24},loadingText:{marginTop:16,fontSize:16,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily},errorContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:24},errorText:{marginTop:16,fontSize:16,color:f.theme.colors.error,textAlign:"center",fontFamily:f.theme.fonts.regular.fontFamily},retryButton:{marginTop:16,paddingVertical:8,paddingHorizontal:16,backgroundColor:f.theme.colors.primary,borderRadius:8},retryButtonText:{color:"white",fontSize:16,fontFamily:f.theme.fonts.regular.fontFamily},emptyContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:24},emptyText:{fontSize:16,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily},section:{marginTop:24,marginHorizontal:16},sectionHeader:{fontSize:20,marginBottom:8,color:f.theme.colors.text,fontFamily:f.theme.fonts.header.fontFamily},card:{backgroundColor:f.theme.colors.surfaceContrast,borderRadius:8,padding:16,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3},serviceContainer:{flexDirection:"row",marginBottom:16,alignItems:"center",paddingBottom:16},serviceDivider:{height:1,backgroundColor:f.theme.colors.border,marginBottom:16,width:"100%"},serviceLabel:{fontSize:16,fontWeight:"600",color:f.theme.colors.text,width:80,fontFamily:f.theme.fonts.regular.fontFamily},serviceValue:{fontSize:16,color:f.theme.colors.text,flex:1,fontFamily:f.theme.fonts.regular.fontFamily},petsContainer:{flexDirection:"row",alignItems:"flex-start"},petsLabel:{fontSize:16,fontWeight:"600",color:f.theme.colors.text,width:80,fontFamily:f.theme.fonts.regular.fontFamily},petsList:{flex:1},petItem:{marginBottom:8},petName:{fontSize:16,fontWeight:"500",color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily},petType:{fontSize:14,color:f.theme.colors.placeHolderText,fontFamily:f.theme.fonts.regular.fontFamily},noPets:{fontSize:16,color:f.theme.colors.placeHolderText,fontStyle:"italic",fontFamily:f.theme.fonts.regular.fontFamily},changeRequestContainer:{padding:16},changeRequestInput:{backgroundColor:f.theme.colors.background,borderColor:f.theme.colors.border,borderWidth:1,borderRadius:8,padding:12,fontSize:16,color:f.theme.colors.text,minHeight:120,textAlignVertical:"top",fontFamily:f.theme.fonts.regular.fontFamily,marginBottom:16},buttonWrapper:{alignItems:"center",width:"100%"},changeRequestButtons:{flexDirection:"row",width:300,justifyContent:"space-between",alignItems:"center",marginTop:16},cancelRequestButton:{width:140,height:45,alignItems:"center",justifyContent:"center",borderWidth:1,borderColor:f.theme.colors.border||"#E0E0E0",borderRadius:8,backgroundColor:"white"},cancelRequestButtonText:{color:f.theme.colors.text||"#333333",fontSize:16,fontFamily:f.theme.fonts.regular.fontFamily},submitRequestButton:{width:140,height:45,alignItems:"center",justifyContent:"center",backgroundColor:f.theme.colors.olive||"#707855",borderRadius:8},submitRequestButtonText:{color:"white",fontSize:16,fontWeight:"bold",fontFamily:f.theme.fonts.regular.fontFamily},changeButton:{paddingVertical:12,paddingHorizontal:16,borderRadius:8,borderWidth:1,borderColor:f.theme.colors.primary,alignItems:"center",justifyContent:"center",flex:1,marginLeft:8},shortenedContainer:{flex:0,backgroundColor:f.theme.colors.background,margin:"web"===n.default.OS?0:24,borderRadius:12,overflow:"hidden",alignSelf:"center",width:"90%",maxWidth:500,minHeight:320}}),mo=({visible:e,onClose:t,bookingId:o,onApproveSuccess:n,onApproveError:l,onRequestChangesSuccess:d,onRequestChangesError:c,initialData:u=null,isProfessional:m=!0,modalTitle:g="Booking Approval Request",hideButtons:h=!1,isReadOnly:y=!1})=>{const{screenWidth:b}=(0,a.useContext)(p.AuthContext),x=b>768,j=u||{booking_id:o,service_type:"Loading...",pets:[],occurrences:[],cost_summary:{subtotal:0,client_platform_fee:0,pro_platform_fee:0,taxes:0,tax_state:"",total_client_cost:0,total_sitter_payout:0,pro_subscription_plan:0}},[w,C]=(0,a.useState)(j),[v,B]=(0,a.useState)(!1),[k,I]=(0,a.useState)("Loading booking details..."),[D,M]=(0,a.useState)(null),[R,P]=(0,a.useState)(""),[z,F]=(0,a.useState)(!1),L=(0,a.useRef)(j),O=(0,a.useRef)(!1);(0,a.useEffect)((()=>{e&&o&&E()}),[e,o]);(0,a.useEffect)((()=>{u&&!O.current&&((0,p.debugLog)("MBAio3htg5uohg: Updating bookingData from initialData"),C(u),L.current=u)}),[u]),(0,a.useEffect)((()=>{const t=setInterval((()=>{if(e&&O.current){const e=!w||!w.occurrences||0===w.occurrences.length,t=L.current&&L.current.occurrences&&L.current.occurrences.length>0;e&&t&&((0,p.debugLog)("MBAio3htg5uohg: Detected that bookingData was cleared unexpectedly, restoring from cache"),C(Object.assign({},L.current)))}}),1e3);return()=>{clearInterval(t)}}),[e,w]);const E=async()=>{if(o)try{B(!0),M(null),I("Loading booking details..."),(0,p.debugLog)("MBAio3htg5uohg: Fetching booking details for ID:",o);const e=await(0,at.getBookingDetails)(o);(0,p.debugLog)("MBAio3htg5uohg: Booking details fetched:",e);const t=Object.assign({},e,{occurrences:e.occurrences||[],pets:e.pets||[],cost_summary:e.cost_summary||{subtotal:0,client_platform_fee:0,pro_platform_fee:0,taxes:0,tax_state:"",total_client_cost:0,total_sitter_payout:0,pro_subscription_plan:0},service_type:e.service_type||"N/A"});0===t.occurrences.length?t.occurrences=[{occurrence_id:"0",start_date:(new Date).toISOString().split("T")[0],end_date:(new Date).toISOString().split("T")[0],start_time:"09:00",end_time:"17:00",unit_of_time:"visit",multiple:1,base_total:0,rates:{base_rate:0,additional_animal_rate:0,applies_after:1,holiday_rate:0,holiday_days:0,additional_rates:[]}}]:t.occurrences=t.occurrences.map((e=>((0,p.debugLog)("MBAio3htg5uohg: Processing occurrence:",{id:e.occurrence_id,unit_of_time:e.unit_of_time,multiple:e.multiple}),Object.assign({},e,{unit_of_time:e.unit_of_time||"visit",multiple:parseFloat(e.multiple)||1,base_total:e.base_total||0,rates:e.rates||{base_rate:0,additional_animal_rate:0,applies_after:1,holiday_rate:0,holiday_days:0,additional_rates:[]}})))),C(t),L.current=t,O.current=!0,(0,p.debugLog)("MBAio3htg5uohg: Booking data processed and stored")}catch(e){(0,p.debugLog)("MBAio3htg5uohg: Error fetching booking details:",e),M("Failed to load booking details. Please try again.")}finally{B(!1)}};(0,a.useEffect)((()=>{if(O.current){const e=!w||!w.occurrences||0===w.occurrences.length,t=L.current&&L.current.occurrences&&L.current.occurrences.length>0;e&&t&&((0,p.debugLog)("MBAio3htg5uohg: Booking data was cleared unexpectedly, restoring from cache"),C(L.current))}}),[w]);const W=async()=>{try{B(!0),I("Approving booking..."),M(null);const e=await(0,at.approveBooking)(o);n&&n(e),t()}catch(e){(0,p.debugLog)("MBA77788 Error approving booking:",e),M("Failed to approve booking. Please try again."),l&&l(e.response?.data?.error||"Failed to approve booking")}finally{B(!1)}},N=()=>{F(!0)},U=()=>{F(!1),P("")},V=async()=>{if(R.trim())try{B(!0),I("Submitting change request..."),M(null);const e=await(0,at.requestBookingChanges)(o,R);d&&((0,p.debugLog)("MBA77788 Notifying parent of successful change request submission"),d(e)),t()}catch(e){(0,p.debugLog)("MBA77788 Error requesting booking changes:",e),M("Failed to submit change request. Please try again."),c&&c(e.response?.data?.error||"Failed to submit change request")}finally{B(!1)}else M("Please provide details about your requested changes.")},Y=()=>{F(!1),P(""),t()};return(0,T.jsx)(_.default,{visible:e,transparent:!0,animationType:"slide",onRequestClose:Y,children:(0,T.jsx)(Se.default,{style:uo.safeArea,children:(0,T.jsxs)(r.default,{style:[uo.container,x?uo.desktopContainer:{},z?uo.shortenedContainer:{}],children:[(0,T.jsxs)(r.default,{style:uo.header,children:[(0,T.jsx)(i.default,{style:uo.title,children:((0,p.debugLog)("MBA4321: Modal title decision factors:",{isReadOnly:y,modalTitle:g,bookingId:o}),y?"Booking Details":g)}),(0,T.jsx)(s.default,{style:uo.closeButton,onPress:Y,children:(0,T.jsx)(S.default,{name:"close",size:24,color:f.theme.colors.text})})]}),z?(0,T.jsxs)(r.default,{style:uo.changeRequestContainer,children:[(0,T.jsx)(q.default,{style:uo.changeRequestInput,placeholder:"Enter details about your requested changes...",value:R,onChangeText:P,multiline:!0,numberOfLines:3,placeholderTextColor:f.theme.colors.placeHolderText}),(0,T.jsx)(r.default,{style:uo.buttonWrapper,children:(0,T.jsxs)(r.default,{style:uo.changeRequestButtons,children:[(0,T.jsx)(s.default,{style:uo.cancelRequestButton,onPress:U,children:(0,T.jsx)(i.default,{style:uo.cancelRequestButtonText,children:"Cancel"})}),(0,T.jsx)(s.default,{style:uo.submitRequestButton,onPress:V,disabled:!R.trim(),children:(0,T.jsx)(i.default,{style:uo.submitRequestButtonText,children:"Request Changes"})})]})})]}):(0,T.jsx)(H.default,{style:uo.scrollContainer,contentContainerStyle:uo.scrollContent,children:v?(0,T.jsxs)(r.default,{style:uo.loadingContainer,children:[(0,T.jsx)(A.default,{size:"large",color:f.theme.colors.primary}),(0,T.jsx)(i.default,{style:uo.loadingText,children:k})]}):D?(0,T.jsxs)(r.default,{style:uo.errorContainer,children:[(0,T.jsx)(S.default,{name:"alert-circle",size:48,color:f.theme.colors.error}),(0,T.jsx)(i.default,{style:uo.errorText,children:D}),(0,T.jsx)(s.default,{style:uo.retryButton,onPress:E,children:(0,T.jsx)(i.default,{style:uo.retryButtonText,children:"Retry"})})]}):w?(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)(r.default,{style:[uo.section,{marginTop:0}],children:[(0,T.jsx)(i.default,{style:uo.sectionHeader,children:"Service & Pets"}),(0,T.jsxs)(r.default,{style:uo.card,children:[(0,T.jsxs)(r.default,{style:uo.serviceContainer,children:[(0,T.jsx)(i.default,{style:uo.serviceLabel,children:"Service:"}),(0,T.jsx)(i.default,{style:uo.serviceValue,children:w.service_details?.service_type||"N/A"})]}),(0,T.jsx)(r.default,{style:uo.serviceDivider}),(0,T.jsxs)(r.default,{style:uo.petsContainer,children:[(0,T.jsx)(i.default,{style:uo.petsLabel,children:"Pets:"}),(0,T.jsx)(r.default,{style:uo.petsList,children:w.pets&&w.pets.length>0?w.pets.map(((e,t)=>{return(0,T.jsxs)(r.default,{style:uo.petItem,children:[(0,T.jsx)(i.default,{style:uo.petName,children:e.name}),(0,T.jsxs)(i.default,{style:uo.petType,children:[(o=e.species,o?o.split(" ").map((e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase())).join(" "):o)," | ",e.breed]})]},t);var o})):(0,T.jsx)(i.default,{style:uo.noPets,children:"No pets selected"})})]})]})]}),w&&(0,T.jsx)(co,{bookingData:w,bookingId:o,onRatesUpdate:e=>C(e),showEditControls:!1,isProfessional:m})]}):(0,T.jsx)(r.default,{style:uo.emptyContainer,children:(0,T.jsx)(i.default,{style:uo.emptyText,children:"No booking data available"})})}),!z&&(()=>{if((0,p.debugLog)("MBA4321: Footer render state:",{hideButtons:h,isReadOnly:y,showChangeRequestInput:z,isProfessional:m,modalTitle:g}),h)return null;if(y)return(0,T.jsx)(r.default,{style:uo.footerContainer,children:(0,T.jsx)(s.default,{style:[uo.button,uo.closeButton],onPress:Y,children:(0,T.jsx)(i.default,{style:uo.buttonText,children:"Close"})})});if(z)return null;if(m)return(0,T.jsx)(r.default,{style:uo.footerContainer,children:(0,T.jsx)(s.default,{style:[uo.button,uo.closeButton],onPress:Y,children:(0,T.jsx)(i.default,{style:uo.buttonText,children:"Close"})})});{const e="Booking Update"===g;return(0,T.jsxs)(r.default,{style:uo.footerContainer,children:[(0,T.jsx)(s.default,{style:[uo.button,uo.closeButton],onPress:Y,children:(0,T.jsx)(i.default,{style:uo.buttonText,children:"Close"})}),(0,T.jsx)(s.default,{style:[uo.button,uo.changeButton],onPress:N,children:(0,T.jsx)(i.default,{style:uo.buttonText,children:"Request Changes"})}),(0,T.jsx)(s.default,{style:[uo.button,uo.approveButton],onPress:W,children:(0,T.jsx)(i.default,{style:uo.approveText,children:e?"Approve Update":"Approve"})})]})}})()]})})})},{width:go,height:ho}=v.default.get("window"),fo=l.default.create({mainContainer:{flex:1,height:"100vh",backgroundColor:"#f5f5f5",position:"fixed",top:0,right:0,bottom:0,left:0,overflow:"hidden"},scrollView:{flex:1,height:"100%",overflow:"auto"},scrollViewContent:{width:"100%",paddingBottom:40},headerContainer:{padding:24,paddingTop:"android"===n.default.OS?Te.default.currentHeight+24:24,flexDirection:"row",justifyContent:"flex-end",alignItems:"center"},headerRight:{flexDirection:"row",alignItems:"center",gap:16},notificationButton:{position:"relative",padding:8},notificationBadge:{position:"absolute",top:4,right:4,backgroundColor:f.theme.colors.error,borderRadius:10,minWidth:20,height:20,justifyContent:"center",alignItems:"center"},notificationCount:{color:f.theme.colors.whiteText,fontSize:12,fontWeight:"bold"},profileButton:{borderRadius:20,overflow:"hidden"},welcomeSection:{padding:24,paddingTop:0},welcomeContent:{maxWidth:1200,marginHorizontal:"auto",width:"100%"},welcomeCard:{backgroundColor:"transparent",backgroundImage:"linear-gradient(to right, #6B6C53, #86C5D9)",borderRadius:12,padding:24,marginBottom:24},welcomeHeader:{flexDirection:"row",flexWrap:"wrap"},welcomeTextContainer:{flex:1,minWidth:280},statsContainer:{padding:24,paddingTop:0,backgroundColor:"#f5f5f5"},statsGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(140px, 1fr))",gap:24,maxWidth:1200,marginHorizontal:"auto",width:"100%"},statCard:Object.assign({backgroundColor:f.theme.colors.surface,padding:16,borderRadius:12,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3},n.default.select({ios:{activeOpacity:.7},android:{android_ripple:{color:"rgba(0, 0, 0, 0.1)"}}})),statHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:12},statIconContainer:{width:48,height:48,borderRadius:12,justifyContent:"center",alignItems:"center"},bookingsContainer:{padding:24,paddingTop:0,backgroundColor:"#f5f5f5",maxWidth:1200,marginHorizontal:"auto",width:"100%"},bookingItem:{marginBottom:16,backgroundColor:f.theme.colors.surface,borderRadius:8,padding:16,shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.1,shadowRadius:2,elevation:2},bookingContent:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"},bookingInfo:{flexDirection:"row",alignItems:"center",flex:1},bookingDetails:{marginLeft:12},bookingTitle:{fontSize:16,fontWeight:"600",color:f.theme.colors.text,marginBottom:4},bookingTime:{fontSize:14,color:f.theme.colors.textSecondary},bookingStatus:{alignItems:"flex-end"},statusText:{fontSize:14,fontWeight:"500",marginBottom:8},progressBar:{width:100,height:4,backgroundColor:f.theme.colors.border,borderRadius:2,overflow:"hidden"},progress:{height:"100%",backgroundColor:f.theme.colors.primary},timeLeft:{fontSize:12,color:f.theme.colors.textSecondary,marginTop:4},emptyStateContainer:{padding:40,alignItems:"center",backgroundColor:f.theme.colors.surface,borderRadius:8,marginBottom:24},emptyStateTitle:{fontSize:f.theme.fontSizes.large,color:f.theme.colors.text,fontWeight:"600",marginTop:16,marginBottom:8,fontFamily:f.theme.fonts.header.fontFamily},emptyStateText:{fontSize:f.theme.fontSizes.medium,color:f.theme.colors.textSecondary,textAlign:"center",fontFamily:f.theme.fonts.regular.fontFamily,marginBottom:24},createServiceButton:{flexDirection:"row",alignItems:"center",backgroundColor:"#6B6C53",paddingVertical:12,paddingHorizontal:20,borderRadius:8,gap:8},createServiceButtonText:{color:f.theme.colors.surface,fontSize:16,fontWeight:"600",fontFamily:f.theme.fonts.regular.fontFamily},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center"},filterContainer:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16,paddingHorizontal:24,paddingVertical:8,borderRadius:30},filterButtons:{flexDirection:"row",backgroundColor:"rgb(238, 241, 245)",padding:4,borderRadius:5},filterButton:{paddingHorizontal:20,paddingVertical:10,borderRadius:5},activeFilterButton:{backgroundColor:f.theme.colors.surface,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.05,shadowRadius:3,elevation:2},filterText:{color:"#6B7280",fontSize:16,fontFamily:f.theme.fonts.regular.fontFamily,fontWeight:"500"},activeFilterText:{color:"#111827",fontWeight:"600"},viewAllButton:{flexDirection:"row",alignItems:"center",gap:4,paddingRight:12},viewAllText:{color:f.theme.colors.primary,fontSize:16,fontFamily:f.theme.fonts.regular.fontFamily,fontWeight:"500"},servicesContainer:{padding:24,paddingTop:0},sectionHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16},servicesGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:16},serviceCard:{backgroundColor:f.theme.colors.surface,borderRadius:12,padding:20,marginBottom:16,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.05,shadowRadius:3,elevation:2,justifyContent:"space-between"},serviceContent:{marginBottom:20},serviceHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"flex-start",marginBottom:4},serviceTitle:{fontSize:16,fontWeight:"600",color:f.theme.colors.text,fontFamily:f.theme.fonts.header.fontFamily,maxWidth:"50%"},serviceCategory:{fontSize:14,color:f.theme.colors.textSecondary,fontFamily:f.theme.fonts.regular.fontFamily},serviceFooter:{flexDirection:"row",alignItems:"center",justifyContent:"space-between"},bookingsCount:{flexDirection:"row",alignItems:"center",gap:6},bookingsText:{fontSize:14,color:f.theme.colors.textSecondary,fontFamily:f.theme.fonts.regular.fontFamily},serviceRate:{fontSize:16,color:"#6B6C53",fontWeight:"600",fontFamily:f.theme.fonts.regular.fontFamily},viewButton:{paddingVertical:8,paddingHorizontal:16,borderRadius:6,backgroundColor:f.theme.colors.surface,shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.05,shadowRadius:2,elevation:1},viewButtonText:{color:f.theme.colors.text,fontSize:14,fontWeight:"500",fontFamily:f.theme.fonts.regular.fontFamily}}),po=({navigation:e})=>{const{colors:t}=(0,G.useTheme)(),{signOut:l,firstName:d,is_prototype:c,screenWidth:u,is_DEBUG:m,isSignedIn:g,isCollapsed:y,userRole:j}=(0,a.useContext)(p.AuthContext),{isVisible:C,currentStep:v,totalSteps:B,stepData:_,handleNext:A,handlePrevious:I,handleSkip:D,completeTutorial:R}=(0,a.useContext)(M),[P,z]=(0,a.useState)([]),[F,L]=(0,a.useState)([]),[O,E]=(0,a.useState)(!0),[W,N]=(0,a.useState)("upcoming"),[U,V]=(0,a.useState)({profile_complete:0,has_bank_account:!1,has_services:!1,subscription_plan:0}),[q,Y]=(0,a.useState)(!1),[J,$]=(0,a.useState)(null),Z=u>900,K=u<=900,Q="professional"===j,X=P.filter((e=>{const t=new Date;let o=null;if(e.start_date)try{if(o=new Date(e.start_date),isNaN(o.getTime()))return(0,p.debugLog)("MBA5677: Invalid booking date",e.start_date),!1}catch(a){return(0,p.debugLog)("MBA5677: Error parsing booking date",{date:e.start_date,error:a}),!1}switch((0,p.debugLog)("MBA5677: Filtering booking",{id:e.booking_id||e.id,date:e.start_date||e.date,parsedDate:o?o.toISOString():null,now:t.toISOString(),filter:W}),W){case"upcoming":return o&&o>t;case"active":return o&&o<=t&&!e.completed;case"past":return o&&o<t&&e.completed;default:return!0}})),ee=(Q||X.slice(0,3),{welcomeTitle:{fontSize:Z?32:24,fontWeight:"600",color:f.theme.colors.whiteText,fontFamily:f.theme.fonts.header.fontFamily},bookingCount:{fontSize:Z?16:14,color:f.theme.colors.whiteText,fontFamily:f.theme.fonts.regular.fontFamily,opacity:.8,marginTop:12},statValue:{fontSize:Z?20:16,fontWeight:"600",color:f.theme.colors.text,fontFamily:f.theme.fonts.header.fontFamily},statLabel:{fontSize:Z?16:14,color:f.theme.colors.textSecondary,fontFamily:f.theme.fonts.regular.fontFamily,marginTop:4},statChange:{fontSize:Z?14:12,fontFamily:f.theme.fonts.regular.fontFamily,marginTop:4},sectionTitle:{fontSize:Z?20:18,fontWeight:"600",color:f.theme.colors.text,fontFamily:f.theme.fonts.header.fontFamily,marginBottom:16,marginTop:24}}),te=[{id:"56782",owner:"John Doe",pet:"Max (Dog)",date:"2023-05-15",time:"14:00",status:"upcoming"},{id:"5678",owner:"Jane Smith",pet:"Whiskers (Cat)",date:"2023-05-17",time:"10:00",status:"active"}],oe=[{service_name:"Dog Walking",description:"Professional dog walking service",unit_of_time:"30 minutes",base_rate:25,additional_animal_rate:10,holiday_rate:35,additional_rates:[]}],ae=async()=>{if(c)return z(te),L(oe),V({profile_complete:.5,has_bank_account:!1,has_services:!0,subscription_plan:0}),void E(!1);try{E(!0);let e="web"===n.default.OS?sessionStorage.getItem("userToken"):await x.default.getItem("userToken");const o=Q?"professionals":"clients",a=await w.default.get("".concat(b.API_BASE_URL,"/api/").concat(o,"/v1/dashboard/"),{headers:{Authorization:"Bearer ".concat(e)}});if((0,p.debugLog)("MBA5677: Dashboard response data",a.data),a.data&&a.data.upcoming_bookings&&a.data.upcoming_bookings.length>0){const e=a.data.upcoming_bookings[0];(0,p.debugLog)("MBA5677: First booking complete structure",e),(0,p.debugLog)("MBA5677: First booking keys",Object.keys(e)),(0,p.debugLog)("MBA5677: First booking client_name field",{client_name:e.client_name,owner_name:e.owner_name,client_name_exists:"client_name"in e})}const r=(a.data.upcoming_bookings||[]).map((e=>{if((0,p.debugLog)("MBA5677: Processing booking",e),!e)return(0,p.debugLog)("MBA5677: Null booking received"),null;let t=e.start_date;return t&&t.includes(" ")&&(t=t.split(" ")[0]),Object.assign({},e,{start_date:t,client_name:e.client_name||e.owner_name})})).filter((e=>null!==e));if((0,p.debugLog)("MBA5677: Processed bookings",r),z(r),V(a.data.onboarding_progress||{profile_complete:0,has_bank_account:!1,has_services:!1,subscription_plan:0}),Q)try{const e=await(0,at.getProfessionalServices)();L(e||[])}catch(t){console.error("Error fetching professional services:",t)}}catch(t){if(401===t.response?.status){const a=await(async()=>{try{const e=await x.default.getItem("refreshToken"),t=await w.default.post("".concat(b.API_BASE_URL,"/api/token/refresh/"),{refresh:e}),{access:o}=t.data;return await x.default.setItem("userToken",o),o}catch(t){console.error("Error refreshing token:",t),await l(),e.navigate("SignIn")}})();if(a)try{const e=await w.default.get("".concat(b.API_BASE_URL,"/api/").concat(Q?"professionals":"owners","/v1/dashboard/"),{headers:{Authorization:"Bearer ".concat(a)}});z(e.data.upcoming_bookings||[]),V(e.data.onboarding_progress||{profile_complete:0,has_bank_account:!1,has_services:!1,subscription_plan:0})}catch(o){console.error("Error fetching dashboard data after token refresh:",o)}}else console.error("Error fetching dashboard data:",t)}finally{E(!1)}};(0,a.useEffect)((()=>{ae()}),[j,c]),(0,a.useEffect)((()=>{if(!O&&P.length>0){const e=new Date,t=P.some((t=>{try{const o=t.start_date?new Date(t.start_date):null;return o&&o<=e&&!t.completed}catch(o){return!1}}));(0,p.debugLog)("MBA5677: Checking for active bookings",{hasActiveBookings:t,bookingsCount:P.length,currentActiveFilter:W}),t&&"active"!==W&&((0,p.debugLog)("MBA5677: Setting active filter to 'active' due to active bookings"),N("active"))}}),[P,O]);"web"===n.default.OS||oo.default;return(0,T.jsxs)(r.default,{style:fo.mainContainer,children:[(0,T.jsxs)(H.default,{style:[fo.scrollView,{marginLeft:!K&&g?y?70:250:0,marginTop:K?60:0}],contentContainerStyle:[fo.scrollViewContent,{maxWidth:1200,marginHorizontal:"auto",paddingTop:K?24:0}],children:[K?null:(0,T.jsx)(r.default,{style:fo.headerContainer,children:(0,T.jsxs)(r.default,{style:fo.headerRight,children:[(0,T.jsxs)(s.default,{style:fo.notificationButton,children:[(0,T.jsx)(S.default,{name:"bell-outline",size:24,color:f.theme.colors.text}),(0,T.jsx)(r.default,{style:fo.notificationBadge,children:(0,T.jsx)(i.default,{style:fo.notificationCount,children:"3"})})]}),(0,T.jsx)(s.default,{style:fo.profileButton,onPress:()=>(0,h.navigateToFrom)(e,"MyProfile","Dashboard"),children:(0,T.jsx)(no.default,{size:40,source:o(4456)})})]})}),(0,T.jsx)(r.default,{style:fo.welcomeSection,children:(0,T.jsx)(r.default,{style:fo.welcomeContent,children:(0,T.jsx)(r.default,{style:fo.welcomeCard,children:(0,T.jsx)(r.default,{style:fo.welcomeHeader,children:(0,T.jsxs)(r.default,{style:fo.welcomeTextContainer,children:[(0,T.jsxs)(i.default,{style:ee.welcomeTitle,children:["Welcome back",d?", "+d:"","! \ud83d\udc4b"]}),(0,T.jsxs)(i.default,{style:ee.bookingCount,children:["You have ",P.filter((e=>!e.completed)).length," active bookings today and ",P.filter((e=>new Date(e.start_date)>new Date)).length," upcoming appointments."]})]})})})})}),(0,T.jsx)(r.default,{style:fo.statsContainer,children:(0,T.jsx)(r.default,{style:fo.statsGrid,children:Q?(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)(s.default,{style:fo.statCard,onPress:()=>(0,h.navigateToFrom)(e,"MyProfile","Dashboard",{initialTab:"profile_info"}),children:[(0,T.jsxs)(r.default,{style:fo.statHeader,children:[(0,T.jsx)(r.default,{style:[fo.statIconContainer,{backgroundColor:"#F0F9E5"}],children:(0,T.jsx)(S.default,{name:"account-check",size:24,color:f.theme.colors.primary})}),(0,T.jsxs)(i.default,{style:[ee.statChange,{color:1===U.profile_complete?f.theme.colors.success:f.theme.colors.warning}],children:[Math.round(100*U.profile_complete),"% Complete"]})]}),(0,T.jsx)(i.default,{style:ee.statValue,children:"Profile"}),(0,T.jsx)(i.default,{style:ee.statLabel,children:"Complete your profile to get started"})]}),(0,T.jsxs)(s.default,{style:fo.statCard,onPress:()=>(0,h.navigateToFrom)(e,"MyProfile","Dashboard",{initialTab:"settings_payments"}),children:[(0,T.jsxs)(r.default,{style:fo.statHeader,children:[(0,T.jsx)(r.default,{style:[fo.statIconContainer,{backgroundColor:"#E7F3F8"}],children:(0,T.jsx)(S.default,{name:"bank",size:24,color:f.theme.colors.primary})}),(0,T.jsx)(i.default,{style:[ee.statChange,{color:U.has_bank_account?f.theme.colors.success:f.theme.colors.warning}],children:U.has_bank_account?"Connected":"Not Connected"})]}),(0,T.jsx)(i.default,{style:ee.statValue,children:"Bank Account"}),(0,T.jsx)(i.default,{style:ee.statLabel,children:"Connect your bank to receive payments"})]}),(0,T.jsxs)(s.default,{style:fo.statCard,onPress:()=>(0,h.navigateToFrom)(e,"ServiceManager","Dashboard"),children:[(0,T.jsxs)(r.default,{style:fo.statHeader,children:[(0,T.jsx)(r.default,{style:[fo.statIconContainer,{backgroundColor:"#FEF0DA"}],children:(0,T.jsx)(S.default,{name:"briefcase",size:24,color:f.theme.colors.primary})}),(0,T.jsx)(i.default,{style:[ee.statChange,{color:U.has_services?f.theme.colors.success:f.theme.colors.warning}],children:U.has_services?"Active":"No Services"})]}),(0,T.jsx)(i.default,{style:ee.statValue,children:"Services"}),(0,T.jsx)(i.default,{style:ee.statLabel,children:"Add services to start accepting bookings"})]}),(0,T.jsxs)(s.default,{style:fo.statCard,onPress:()=>(0,h.navigateToFrom)(e,"MyProfile","Dashboard",{initialTab:"settings_payments"}),children:[(0,T.jsxs)(r.default,{style:fo.statHeader,children:[(0,T.jsx)(r.default,{style:[fo.statIconContainer,{backgroundColor:"#E1E2DB"}],children:(0,T.jsx)(S.default,{name:"star",size:24,color:f.theme.colors.primary})}),(0,T.jsx)(i.default,{style:[ee.statChange,{color:U.subscription_plan>0?f.theme.colors.success:f.theme.colors.warning}],children:0===U.subscription_plan?"Free Tier":"Premium"})]}),(0,T.jsx)(i.default,{style:ee.statValue,children:"Subscription"}),(0,T.jsx)(i.default,{style:ee.statLabel,children:"Upgrade for more features"})]})]}):(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)(s.default,{style:fo.statCard,onPress:()=>(0,h.navigateToFrom)(e,"MyProfile","Dashboard",{initialTab:"profile_info"}),children:[(0,T.jsxs)(r.default,{style:fo.statHeader,children:[(0,T.jsx)(r.default,{style:[fo.statIconContainer,{backgroundColor:"#F0F9E5"}],children:(0,T.jsx)(S.default,{name:"account-check",size:24,color:f.theme.colors.primary})}),(0,T.jsxs)(i.default,{style:[ee.statChange,{color:1===U.profile_complete?f.theme.colors.success:f.theme.colors.warning}],children:[Math.round(100*U.profile_complete),"% Complete"]})]}),(0,T.jsx)(i.default,{style:ee.statValue,children:"Profile"}),(0,T.jsx)(i.default,{style:ee.statLabel,children:"Complete your profile to get started"})]}),(0,T.jsxs)(s.default,{style:fo.statCard,onPress:()=>(0,h.navigateToFrom)(e,"MyProfile","Dashboard",{initialTab:"settings_payments"}),children:[(0,T.jsxs)(r.default,{style:fo.statHeader,children:[(0,T.jsx)(r.default,{style:[fo.statIconContainer,{backgroundColor:"#E7F3F8"}],children:(0,T.jsx)(S.default,{name:"credit-card",size:24,color:f.theme.colors.primary})}),(0,T.jsx)(i.default,{style:[ee.statChange,{color:U.has_payment_method?f.theme.colors.success:f.theme.colors.warning}],children:U.has_payment_method?"Connected":"Not Connected"})]}),(0,T.jsx)(i.default,{style:ee.statValue,children:"Payment Method"}),(0,T.jsx)(i.default,{style:ee.statLabel,children:"Add a payment method to book services"})]}),(0,T.jsxs)(s.default,{style:fo.statCard,onPress:()=>(0,h.navigateToFrom)(e,"MyProfile","Dashboard",{initialTab:"pets_preferences"}),children:[(0,T.jsxs)(r.default,{style:fo.statHeader,children:[(0,T.jsx)(r.default,{style:[fo.statIconContainer,{backgroundColor:"#FEF0DA"}],children:(0,T.jsx)(S.default,{name:"paw",size:24,color:f.theme.colors.primary})}),(0,T.jsx)(i.default,{style:[ee.statChange,{color:U.has_pets?f.theme.colors.success:f.theme.colors.warning}],children:U.has_pets?"Added":"No Pets"})]}),(0,T.jsx)(i.default,{style:ee.statValue,children:"Pets"}),(0,T.jsx)(i.default,{style:ee.statLabel,children:"Add your pets to book services"})]}),(0,T.jsxs)(s.default,{style:fo.statCard,onPress:()=>(0,h.navigateToFrom)(e,"MyProfile","Dashboard",{initialTab:"settings_payments"}),children:[(0,T.jsxs)(r.default,{style:fo.statHeader,children:[(0,T.jsx)(r.default,{style:[fo.statIconContainer,{backgroundColor:"#E1E2DB"}],children:(0,T.jsx)(S.default,{name:"star",size:24,color:f.theme.colors.primary})}),(0,T.jsx)(i.default,{style:[ee.statChange,{color:U.subscription_plan>0?f.theme.colors.success:f.theme.colors.warning}],children:0===U.subscription_plan?"Free Tier":"Premium"})]}),(0,T.jsx)(i.default,{style:ee.statValue,children:"Subscription"}),(0,T.jsx)(i.default,{style:ee.statLabel,children:"Upgrade for more features"})]})]})})}),(0,T.jsx)(r.default,{style:fo.filterContainer,children:(0,T.jsx)(r.default,{style:fo.filterButtons,children:["upcoming","active"].map((e=>(0,T.jsx)(s.default,{style:[fo.filterButton,W===e&&fo.activeFilterButton],onPress:()=>N(e),children:(0,T.jsx)(i.default,{style:[fo.filterText,W===e&&fo.activeFilterText],children:e.charAt(0).toUpperCase()+e.slice(1)})},e)))})}),(0,T.jsx)(r.default,{style:fo.bookingsContainer,children:O?(0,T.jsx)(r.default,{style:fo.loadingContainer,children:(0,T.jsx)(ao.default,{size:"small",color:t.primary})}):X.length>0?X.map((e=>{(0,p.debugLog)("MBA5677: Rendering booking",{id:c?e.id:e.booking_id,date:c?e.date:e.start_date,time:c?e.time:e.start_time,client_name:c?e.owner:e.client_name,professional_name:c?e.professional:e.professional_name,status:e.status});const t=c?e.id:e.booking_id;let o;return Q?(o=c?e.owner:e.client_name||e.owner_name||"Client",(0,p.debugLog)("MBA5677: Using client name",o)):(o=c?e.professional:e.professional_name||"Professional",(0,p.debugLog)("MBA5677: Using professional name",o)),(0,T.jsx)(so,{booking:{id:t,client_name:Q?o:null,professional_name:Q?null:o,serviceName:c?e.service:e.service_type,date:c?e.date:e.start_date,time:c?e.time:e.start_time,status:e.status,pets:c?[{name:e.pet}]:e.pets},type:Q?"professional":"client",onViewDetails:()=>(e=>{$(e),Y(!0),(0,p.debugLog)("MBA5677: Opening booking modal for ID:",e)})(t)},t)})):(0,T.jsxs)(r.default,{style:fo.emptyStateContainer,children:[(0,T.jsx)(S.default,{name:"calendar",size:48,color:f.theme.colors.textSecondary}),(0,T.jsxs)(i.default,{style:fo.emptyStateTitle,children:["No ",W," bookings"]}),(0,T.jsx)(i.default,{style:fo.emptyStateText,children:Q?"Create services to start receiving bookings from owners.":"Find professional services to book your first appointment."}),(0,T.jsxs)(s.default,{style:fo.createServiceButton,onPress:()=>(0,h.navigateToFrom)(e,Q?"ServiceManager":"SearchProfessionals","Dashboard"),children:[(0,T.jsx)(S.default,{name:Q?"plus":"magnify",size:20,color:f.theme.colors.surface}),(0,T.jsx)(i.default,{style:fo.createServiceButtonText,children:Q?"Create Service":"Find Professionals"})]})]})}),Q?(0,T.jsxs)(r.default,{style:fo.servicesContainer,children:[(0,T.jsxs)(r.default,{style:fo.sectionHeader,children:[(0,T.jsx)(i.default,{style:ee.sectionTitle,children:"My Services"}),(0,T.jsxs)(s.default,{style:fo.viewAllButton,onPress:()=>(0,h.navigateToFrom)(e,"ServiceManager","Dashboard"),children:[(0,T.jsx)(i.default,{style:fo.viewAllText,children:"View All"}),(0,T.jsx)(S.default,{name:"chevron-right",size:20,color:f.theme.colors.primary})]})]}),(0,T.jsx)(r.default,{style:fo.servicesGrid,children:F.map((t=>(t=>(0,T.jsxs)(r.default,{style:fo.serviceCard,children:[(0,T.jsxs)(r.default,{style:fo.serviceContent,children:[(0,T.jsxs)(r.default,{style:fo.serviceHeader,children:[(0,T.jsx)(i.default,{style:fo.serviceTitle,numberOfLines:1,ellipsizeMode:"tail",children:t.service_name}),(0,T.jsxs)(i.default,{style:fo.serviceRate,children:["$",t.base_rate," ",t.unit_of_time||"Per Visit"]})]}),(0,T.jsx)(i.default,{style:fo.serviceCategory,children:t.category||"Exotic"})]}),(0,T.jsx)(r.default,{style:fo.serviceFooter,children:(0,T.jsx)(s.default,{style:fo.viewButton,onPress:()=>(0,h.navigateToFrom)(e,"ServiceManager","Dashboard",{serviceId:t.id}),children:(0,T.jsx)(i.default,{style:fo.viewButtonText,children:"View"})})})]},t.id))(t)))})]}):null]}),(0,T.jsx)(mo,{visible:q,onClose:()=>{Y(!1),$(null)},bookingId:J,isProfessional:Q,modalTitle:"Review Details",hideButtons:!0}),C&&"Dashboard"===_?.screen&&(0,T.jsx)(k,{step:v,totalSteps:B,title:_.title,description:_.description,position:_.position,onNext:()=>A(e),onPrevious:I,onSkip:D,onClose:R})]})},yo=({navigation:e})=>{const{width:t}=(0,ve.default)(),{screenWidth:o,isCollapsed:d,is_DEBUG:c}=(0,a.useContext)(p.AuthContext),[u,m]=(0,a.useState)(o<=900),[g,y]=(0,a.useState)({dog:!1,cat:!1,exotics:!1}),[b,j]=(0,a.useState)(""),[w,C]=(0,a.useState)([]),[v,B]=(0,a.useState)([]),[k,_]=(0,a.useState)(!1);(0,a.useEffect)((()=>{m(o<=900)}),[o]),(0,a.useEffect)((()=>{(async()=>{const t="web"===n.default.OS?sessionStorage.getItem("currentRoute"):await x.default.getItem("currentRoute");"BecomeProfessional"!==t?await(0,h.navigateToFrom)(e,"BecomeProfessional",t):c&&console.log("Error, currentRoute is BecomeProfessional")})()}),[]);const I=(e,t)=>l.default.create({mainContainer:{flex:1,backgroundColor:f.theme.colors.background,height:"100vh",overflow:"hidden",position:"fixed",top:0,left:0,right:0,bottom:0,marginLeft:e>900?t?70:250:0,transition:"margin-left 0.3s ease"},container:{flex:1,backgroundColor:f.theme.colors.background,paddingTop:"android"===n.default.OS?Te.default.currentHeight:0},scrollContent:{flexGrow:1,padding:e<=900?16:20,width:e>900?"60%":"90%",maxWidth:800,alignSelf:"center"},header:{flexDirection:"row",alignItems:"center",padding:16,borderBottomWidth:1,borderBottomColor:f.theme.colors.border,display:e<=900?"flex":"none"},backButton:{marginRight:16},headerText:{fontSize:20,fontWeight:"bold",color:f.theme.colors.primary},title:{fontSize:e<=900?24:32,color:f.theme.colors.text,textAlign:"center",marginBottom:e<=900?16:24,fontFamily:f.theme.fonts.header.fontFamily},label:{fontSize:f.theme.fontSizes.medium,color:f.theme.colors.text,marginBottom:e<=900?8:12,fontFamily:f.theme.fonts.regular.fontFamily},checkboxContainer:{flexDirection:"row",flexWrap:"wrap",justifyContent:e<=900?"space-between":"flex-start",gap:e<=900?8:16,marginBottom:e<=900?16:24},petButton:{flexDirection:"row",alignItems:"center",padding:e<=900?8:12,borderWidth:1,borderColor:f.theme.colors.primary,borderRadius:8,backgroundColor:f.theme.colors.surface,minWidth:e<=900?"45%":150},selectedPetButton:{backgroundColor:f.theme.colors.primary},petButtonText:{marginLeft:8,color:f.theme.colors.primary,fontSize:f.theme.fontSizes.medium,fontFamily:f.theme.fonts.regular.fontFamily},selectedPetButtonText:{color:f.theme.colors.surface},textInput:{borderColor:f.theme.colors.border,borderWidth:1,borderRadius:8,padding:e<=900?12:16,marginBottom:e<=900?16:24,backgroundColor:f.theme.colors.inputBackground,minHeight:120,fontSize:f.theme.fontSizes.medium,fontFamily:f.theme.fonts.regular.fontFamily},uploadButton:{flexDirection:"row",alignItems:"center",justifyContent:"center",padding:e<=900?12:16,borderWidth:1,borderColor:f.theme.colors.border,borderRadius:8,borderStyle:"dashed",marginBottom:e<=900?12:16},uploadText:{marginLeft:8,color:f.theme.colors.text,fontSize:f.theme.fontSizes.medium,fontFamily:f.theme.fonts.regular.fontFamily},uploadedFileContainer:{flexDirection:"row",alignItems:"center",backgroundColor:f.theme.colors.surfaceVariant,padding:e<=900?8:12,borderRadius:8,marginBottom:8},uploadedFilePreview:{width:40,height:40,borderRadius:4,marginRight:8},certificationText:{flex:1,fontSize:f.theme.fontSizes.small,color:f.theme.colors.text,marginRight:8,fontFamily:f.theme.fonts.regular.fontFamily},removeFileButton:{padding:4},submitButton:{backgroundColor:f.theme.colors.primary,padding:e<=900?12:16,borderRadius:8,alignItems:"center",marginTop:e<=900?20:32},submitButtonDisabled:{opacity:.6},submitButtonText:{color:f.theme.colors.surface,fontSize:f.theme.fontSizes.medium,fontWeight:"bold",fontFamily:f.theme.fonts.regular.fontFamily},loadingIndicator:{marginTop:16},formContainer:{width:"100%"}});return(0,T.jsx)(r.default,{style:I(o,d).mainContainer,children:(0,T.jsxs)(Se.default,{style:I(o,d).container,children:[u&&(0,T.jsxs)(r.default,{style:I(o,d).header,children:[(0,T.jsx)(s.default,{onPress:()=>{(0,h.handleBack)(e)},style:I(o,d).backButton,children:(0,T.jsx)(S.default,{name:"arrow-left",size:24,color:f.theme.colors.primary})}),(0,T.jsx)(i.default,{style:I(o,d).headerText,children:"Become a Professional"})]}),(0,T.jsx)(H.default,{contentContainerStyle:I(o,d).scrollContent,children:(0,T.jsxs)(r.default,{style:I(o,d).formContainer,children:[(0,T.jsx)(i.default,{style:I(o,d).title,children:"Become a Professional"}),(0,T.jsx)(i.default,{style:I(o,d).label,children:"Select Pets You Can Sit:"}),(0,T.jsx)(r.default,{style:I(o,d).checkboxContainer,children:["dog","cat","exotics"].map((e=>(0,T.jsxs)(s.default,{style:[I(o,d).petButton,g[e]&&I(o,d).selectedPetButton],onPress:()=>(e=>{y(Object.assign({},g,{[e]:!g[e]}))})(e),children:[(0,T.jsx)(S.default,{name:"exotics"===e?"turtle":e,size:24,color:g[e]?f.theme.colors.surface:f.theme.colors.primary}),(0,T.jsx)(i.default,{style:[I(o,d).petButtonText,g[e]&&I(o,d).selectedPetButtonText],children:e.charAt(0).toUpperCase()+e.slice(1)})]},e)))}),(0,T.jsx)(i.default,{style:I(o,d).label,children:"About You:"}),(0,T.jsx)(q.default,{style:I(o,d).textInput,multiline:!0,numberOfLines:4,placeholder:"Write a little about yourself...",value:b,onChangeText:j}),(0,T.jsx)(i.default,{style:I(o,d).label,children:"Upload Certifications/Resume:"}),(0,T.jsxs)(s.default,{style:I(o,d).uploadButton,onPress:async()=>{let e=await Re.launchImageLibraryAsync({mediaTypes:Pe.MediaTypeOptions.Images,allowsEditing:!0,aspect:[4,3],quality:1,base64:!0});if(!e.canceled){const t={uri:e.assets[0].uri,base64:e.assets[0].base64,name:e.assets[0].uri.split("/").pop()};C([...w,t])}},children:[(0,T.jsx)(S.default,{name:"file-upload",size:24,color:f.theme.colors.text}),(0,T.jsx)(i.default,{style:I(o,d).uploadText,children:"Upload Documents"})]}),w.map(((e,t)=>(0,T.jsxs)(r.default,{style:I(o,d).uploadedFileContainer,children:[(0,T.jsx)(U.default,{source:{uri:e.uri},style:I(o,d).uploadedFilePreview}),(0,T.jsx)(i.default,{style:I(o,d).certificationText,numberOfLines:1,children:e.name}),(0,T.jsx)(s.default,{style:I(o,d).removeFileButton,onPress:()=>(e=>{C(w.filter(((t,o)=>o!==e)))})(t),children:(0,T.jsx)(S.default,{name:"close",size:20,color:f.theme.colors.error})})]},t))),(0,T.jsx)(i.default,{style:I(o,d).label,children:"Upload Insurance Proof:"}),(0,T.jsxs)(s.default,{style:I(o,d).uploadButton,onPress:async()=>{let e=await Re.launchImageLibraryAsync({mediaTypes:Pe.MediaTypeOptions.Images,allowsEditing:!0,aspect:[4,3],quality:1,base64:!0});if(!e.canceled){const t={uri:e.assets[0].uri,base64:e.assets[0].base64,name:e.assets[0].uri.split("/").pop()};B([...v,t])}},children:[(0,T.jsx)(S.default,{name:"file-upload",size:24,color:f.theme.colors.text}),(0,T.jsx)(i.default,{style:I(o,d).uploadText,children:"Upload Insurance"})]}),v.map(((e,t)=>(0,T.jsxs)(r.default,{style:I(o,d).uploadedFileContainer,children:[(0,T.jsx)(U.default,{source:{uri:e.uri},style:I(o,d).uploadedFilePreview}),(0,T.jsx)(i.default,{style:I(o,d).certificationText,numberOfLines:1,children:e.name}),(0,T.jsx)(s.default,{style:I(o,d).removeFileButton,onPress:()=>(e=>{B(v.filter(((t,o)=>o!==e)))})(t),children:(0,T.jsx)(S.default,{name:"close",size:20,color:f.theme.colors.error})})]},t))),(0,T.jsx)(s.default,{style:[I(o,d).submitButton,k&&I(o,d).submitButtonDisabled],onPress:async()=>{_(!0),setTimeout((()=>{_(!1),y({dog:!1,cat:!1,exotics:!1}),j(""),C([]),B([]),"web"===n.default.OS?window.confirm("Success: Your application has been submitted successfully!")&&e.navigate("More"):Be.default.alert("Success","Your application has been submitted successfully!",[{text:"OK",onPress:()=>e.navigate("More",{screen:"More",transition:"slide"})}])}),2e3)},disabled:k,children:(0,T.jsx)(i.default,{style:I(o,d).submitButtonText,children:k?"Submitting...":"Submit Application"})}),k&&(0,T.jsx)(A.default,{style:I(o,d).loadingIndicator,size:"small",color:f.theme.colors.primary})]})})]})})};var bo=o(30336),xo=o(84268),jo=o(59793);const wo=(e,t)=>l.default.create({mainContainer:{flex:1,backgroundColor:f.theme.colors.background,height:"100vh",overflow:"hidden",position:"fixed",top:0,left:0,right:0,bottom:0,marginLeft:e>900?t?70:250:0,transition:"margin-left 0.3s ease"},container:{flex:1},content:{flex:1,backgroundColor:f.theme.colors.background,paddingTop:"android"===n.default.OS?Te.default.currentHeight:0},webContent:{width:"100%",maxWidth:e>900?800:600,alignSelf:"center",padding:e<=900?10:16,paddingTop:e<=900?80:16},listSection:{backgroundColor:f.theme.colors.surface,borderRadius:8,marginBottom:16},webListItem:{borderBottomWidth:1,borderBottomColor:f.theme.colors.border,paddingVertical:e<=900?8:12},listItemTitle:{fontSize:e<=900?f.theme.fontSizes.medium:f.theme.fontSizes.large,fontFamily:f.theme.fonts.regular.fontFamily,fontWeight:"600"},buttonContainer:{marginBottom:16},switchRoleButton:{borderColor:f.theme.colors.primary},logoutButton:{backgroundColor:f.theme.colors.error},buttonText:{fontFamily:f.theme.fonts.regular.fontFamily,fontWeight:"600"}}),Co=({navigation:e})=>{const{isSignedIn:t,isApprovedProfessional:o,userRole:i,switchRole:s,signOut:l,screenWidth:d,isCollapsed:c,is_DEBUG:u}=(0,a.useContext)(p.AuthContext),[m,g]=(0,a.useState)(d<=900),y=wo(d,c);(0,a.useEffect)((()=>{g(d<=900)}),[d]),(0,a.useEffect)((()=>{(async()=>{try{const e=t?"Dashboard":"Home";"web"===n.default.OS?(sessionStorage.setItem("currentRoute",e),sessionStorage.setItem("previousRoute","More")):(await x.default.setItem("currentRoute",e),await x.default.setItem("previousRoute","More"))}catch(e){console.error("Error initializing routes:",e)}})()}),[t,i]);const b=async(t,o)=>{try{await(0,h.navigateToFrom)(e,t,"More",o)}catch(a){console.error("Error handling navigation:",a),e.navigate(t)}},j=[{title:"Privacy Policy",icon:"shield-account",route:"PrivacyPolicy"},{title:"Terms of Service",icon:"file-document",route:"TermsOfService"}],w=[{title:"Profile",icon:"account",route:"MyProfile"},{title:"My Bookings",icon:"calendar-clock",route:"MyBookings"},{title:"Payment Methods",icon:"credit-card",route:"PaymentMethods"},{title:"Become a Professional",icon:"account-tie",route:"BecomeProfessional"},{title:"Settings",icon:"cog",route:"Settings"},{title:"My Pets",icon:"paw",route:"MyPets"},{title:"Blog",icon:"post",route:"Blog"},{title:"Privacy Policy",icon:"shield-account",route:"PrivacyPolicy"},{title:"Terms of Service",icon:"file-document",route:"TermsOfService"},{title:"Contact Us",icon:"email",route:"ContactUs"}],C=[{title:"Profile",icon:"account",route:"MyProfile"},{title:"My Services",icon:"briefcase-outline",route:"ServiceManager"},{title:"My Bookings",icon:"calendar-clock",route:"MyBookings"},{title:"My Pets",icon:"paw",route:"MyPets"},{title:"Payment Methods",icon:"credit-card",route:"PaymentMethods"},{title:"Settings",icon:"cog",route:"Settings"},{title:"Blog",icon:"post",route:"Blog"},{title:"Privacy Policy",icon:"shield-account",route:"PrivacyPolicy"},{title:"Terms of Service",icon:"file-document",route:"TermsOfService"},{title:"Contact Us",icon:"email",route:"ContactUs"}];return(0,T.jsx)(r.default,{style:y.mainContainer,children:(0,T.jsx)(Se.default,{style:y.container,children:(0,T.jsx)(r.default,{style:y.content,children:(0,T.jsxs)(r.default,{style:y.webContent,children:[(0,T.jsx)(xo.default,{style:y.listSection,children:(()=>{let e;return e=t?"professional"===i?C:w:j,e.map(((t,o)=>(0,T.jsxs)(a.Fragment,{children:[(0,T.jsx)(bo.default,{title:t.title,titleStyle:y.listItemTitle,left:e=>"web"===n.default.OS?(0,T.jsx)(S.default,{name:t.icon,size:d<=900?20:24,color:f.theme.colors.primary}):(0,T.jsx)(oo.default,Object.assign({},e,{icon:t.icon})),onPress:()=>b(t.route,t.tab||"Overview"),style:[y.webListItem,{paddingHorizontal:d<=900?8:16}]}),o<e.length-1&&(0,T.jsx)(jo.default,{})]},o)))})()}),t&&(0,T.jsx)(r.default,{style:y.buttonContainer,children:(0,T.jsx)(_e.default,{mode:"contained",onPress:async()=>{try{await l(),"web"===n.default.OS?(sessionStorage.removeItem("currentRoute"),sessionStorage.removeItem("previousRoute")):await x.default.multiRemove(["currentRoute","previousRoute"]),Be.default.alert("Logged Out","You have been successfully logged out."),e.navigate("Home")}catch(t){console.error("Logout failed",t),Be.default.alert("Logout Failed","An error occurred while logging out.")}},style:[y.logoutButton],labelStyle:y.buttonText,children:"Log Out"})})]})})})})};var vo=o(61171),So=o(56662),To=(o(99164),o(59814)),Bo=o(32724),ko=o(54564);const _o=l.default.create({container:{flexDirection:"row",alignItems:"center",paddingVertical:8,paddingHorizontal:10,backgroundColor:f.theme.colors.lightGrey,borderRadius:5,marginBottom:5},removeButton:{padding:5,marginRight:5},contentContainer:{flex:1,flexDirection:"row",justifyContent:"space-between",alignItems:"center"},time:{fontSize:f.theme.fontSizes.small,fontWeight:"bold",flex:1},serviceContainer:{flex:2,flexDirection:"row",justifyContent:"flex-end",alignItems:"center"},reason:{fontSize:f.theme.fontSizes.small,color:f.theme.colors.textSecondary,marginRight:8},seeMoreButton:{padding:4,borderRadius:4,backgroundColor:f.theme.colors.primary},seeMoreText:{color:f.theme.colors.whiteText,fontSize:f.theme.fontSizes.small},modalOverlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center"},modalContent:{backgroundColor:f.theme.colors.background,borderRadius:8,padding:16,width:"80%",maxHeight:"80%"},modalHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16},modalTitle:{fontSize:f.theme.fontSizes.large,fontWeight:"bold",color:f.theme.colors.text},modalTime:{fontSize:f.theme.fontSizes.medium,color:f.theme.colors.text,marginBottom:12},serviceItem:{fontSize:f.theme.fontSizes.medium,color:f.theme.colors.text,paddingVertical:4}}),Ao=({startTime:e,endTime:t,reason:o,onPress:n,onRemove:l})=>{const[d,c]=(0,a.useState)(!1),u="00:00"===e&&"24:00"===t,m=e=>{if(u)return"All Day";if("string"!==typeof e)return e instanceof Date?(0,ko.format)(e,"h:mm a"):(console.warn("Invalid time format: ".concat(e)),"Invalid Time");try{const t=(0,Bo.parse)(e,"HH:mm",new Date);return(0,ko.format)(t,"h:mm a")}catch(t){return console.warn("Invalid time format: ".concat(e)),"Invalid Time"}};return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)(r.default,{style:_o.container,children:[(0,T.jsx)(s.default,{style:_o.removeButton,onPress:l,children:(0,T.jsx)(S.default,{name:"close",size:20,color:f.theme.colors.error})}),(0,T.jsxs)(r.default,{style:_o.contentContainer,children:[(0,T.jsx)(i.default,{style:_o.time,children:u?"All Day":"".concat(m(e)," - ").concat(m(t))}),(0,T.jsxs)(r.default,{style:_o.serviceContainer,children:[(0,T.jsx)(i.default,{style:_o.reason,children:(()=>{const e=o?.replace("Unavailable for: ","").split(", ")||[];return 0===e.length?"No services specified":10===e.length?"All Services":"".concat(e.length," ").concat(1===e.length?"Service":"Services")})()}),o&&(0,T.jsx)(s.default,{onPress:()=>c(!0),style:_o.seeMoreButton,children:(0,T.jsx)(i.default,{style:_o.seeMoreText,children:"See All"})})]})]})]}),(0,T.jsx)(_.default,{visible:d,transparent:!0,animationType:"fade",onRequestClose:()=>c(!1),children:(0,T.jsx)(s.default,{style:_o.modalOverlay,activeOpacity:1,onPress:()=>c(!1),children:(0,T.jsxs)(r.default,{style:_o.modalContent,children:[(0,T.jsxs)(r.default,{style:_o.modalHeader,children:[(0,T.jsx)(i.default,{style:_o.modalTitle,children:"Unavailable Services"}),(0,T.jsx)(s.default,{onPress:()=>c(!1),children:(0,T.jsx)(S.default,{name:"close",size:24,color:f.theme.colors.text})})]}),(0,T.jsxs)(i.default,{style:_o.modalTime,children:[m(e)," - ",m(t)]}),o?.replace("Unavailable for: ","").split(", ").map(((e,t)=>(0,T.jsxs)(i.default,{style:_o.serviceItem,children:["\u2022 ",e]},t)))]})})})]})},Io=l.default.create({card:{backgroundColor:f.theme.colors.surface,borderRadius:8,padding:12,marginBottom:8,flexDirection:"row",justifyContent:"space-between",alignItems:"center",elevation:2,shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.2,shadowRadius:2},cardContent:{flex:1},timeContainer:{flexDirection:"row",alignItems:"center",marginBottom:4},timeText:{marginLeft:8,fontSize:f.theme.fontSizes.medium,color:f.theme.colors.text,fontWeight:"500"},ownerName:{fontSize:f.theme.fontSizes.small,color:f.theme.colors.textSecondary},editButton:{padding:8}}),Do=({booking:e,onPress:t,onEdit:o})=>{(0,j.useNavigation)();const a=e=>{try{const t=(0,Bo.parse)(e,"HH:mm",new Date);return(0,ko.format)(t,"h:mm a")}catch(t){return console.warn("Invalid time format: ".concat(e)),"Invalid Time"}},n=()=>{t&&t(e)};return(0,T.jsxs)(s.default,{style:Io.card,onPress:n,children:[(0,T.jsxs)(r.default,{style:Io.cardContent,children:[(0,T.jsxs)(r.default,{style:Io.timeContainer,children:[(0,T.jsx)(S.default,{name:"clock-outline",size:20,color:f.theme.colors.primary}),(0,T.jsxs)(i.default,{style:Io.timeText,children:[a(e.startTime)," - ",a(e.endTime)]})]}),(0,T.jsxs)(i.default,{style:Io.ownerName,children:["Booked with ",e.owner_name]})]}),(0,T.jsx)(s.default,{style:Io.editButton,onPress:n,children:(0,T.jsx)(S.default,{name:"pencil",size:20,color:f.theme.colors.primary})})]})},Mo=l.default.create({container:{},fullWidth:{width:"100%"},label:{fontSize:f.theme.fontSizes.smallMedium,color:f.theme.colors.placeholder,fontWeight:"500"},timeButton:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",borderWidth:1,borderColor:f.theme.colors.border,borderRadius:8,padding:8,backgroundColor:f.theme.colors.background,minHeight:20},compactTimeButton:{width:150},timeText:{fontSize:f.theme.fontSizes.medium,color:f.theme.colors.text},webInputContainer:{position:"relative",borderWidth:1,borderColor:f.theme.colors.border,borderRadius:8,backgroundColor:f.theme.colors.background,overflow:"hidden",height:40,display:"flex",flexDirection:"row",alignItems:"center"},webInput:{padding:"8px 36px 8px 12px",fontSize:f.theme.fontSizes.medium,marginLeft:12,width:"90%",height:"100%",border:"none",outline:"none",backgroundColor:"transparent",color:f.theme.colors.text},webIcon:{position:"absolute",right:12,cursor:"pointer",pointerEvents:"auto"},errorBorder:{borderColor:f.theme.colors.error},errorText:{color:f.theme.colors.error},errorMessage:{color:f.theme.colors.error,fontSize:f.theme.fontSizes.small,marginTop:4},disabled:{backgroundColor:f.theme.colors.disabled,opacity:.7},disabledText:{color:f.theme.colors.placeholder}}),Ro=({label:e,value:t,onChange:o,fullWidth:l=!1,containerStyle:d,error:c,disabled:u=!1})=>{const[m,g]=a.useState(!1),{screenWidth:h}=(0,a.useContext)(p.AuthContext),y=h>400;if("web"===n.default.OS){const a="undefined"!==typeof navigator&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor);return(0,T.jsxs)(r.default,{style:[Mo.container,l&&Mo.fullWidth,d],children:[e&&(0,T.jsx)(i.default,{style:[Mo.label,c&&Mo.errorText],children:e}),(0,T.jsxs)(r.default,{style:[Mo.webInputContainer,!l&&Mo.compactTimeButton,c&&Mo.errorBorder,u&&Mo.disabled],children:[(0,T.jsx)("style",{children:'\n              input[type="time"]::-webkit-calendar-picker-indicator {\n                display: '.concat(y&&a?"block":"none",';\n              }\n              input[type="time"]::-webkit-inner-spin-button,\n              input[type="time"]::-webkit-clear-button {\n                display: none;\n              }\n            ')}),(0,T.jsx)("input",{type:"time",value:t.toTimeString().slice(0,5),onChange:e=>o(new Date("2000-01-01T".concat(e.target.value))),style:Object.assign({},Mo.webInput,{paddingRight:"12px"}),disabled:u}),y&&!a&&(0,T.jsx)(S.default,{name:"clock-outline",size:24,color:u?f.theme.colors.placeholder:f.theme.colors.text,style:Mo.webIcon,onPress:u?null:()=>{const e=document.querySelector('input[type="time"]');e&&e.showPicker()}})]}),c&&(0,T.jsx)(i.default,{style:Mo.errorMessage,children:c})]})}return(0,T.jsxs)(r.default,{style:[Mo.container,l&&Mo.fullWidth,d],children:[e&&(0,T.jsx)(i.default,{style:[Mo.label,c&&Mo.errorText],children:e}),(0,T.jsxs)(s.default,{onPress:()=>{g(!0)},style:[Mo.timeButton,!l&&Mo.compactTimeButton,c&&Mo.errorBorder,u&&Mo.disabled],disabled:u,children:[(0,T.jsx)(i.default,{style:[Mo.timeText,u&&Mo.disabledText],children:t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),y&&(0,T.jsx)(S.default,{name:"clock-outline",size:24,color:u?f.theme.colors.placeholder:f.theme.colors.text})]}),c&&(0,T.jsx)(i.default,{style:Mo.errorMessage,children:c}),m&&(0,T.jsx)(ht.default,{value:t,mode:"time",is24Hour:!0,display:"default",onChange:(e,t)=>{g("ios"===n.default.OS),t&&o(t)},disabled:u})]})},{width:Po,height:zo}=v.default.get("window"),Fo=(n.default.OS,l.default.create({modalContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0, 0, 0, 0.5)"},modalContent:{backgroundColor:f.theme.colors.background,padding:22,justifyContent:"center",alignItems:"center",borderRadius:17,maxHeight:.7*zo,zIndex:1},modalHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:"100%",marginBottom:15},modalTitle:{fontSize:f.theme.fontSizes.large,fontWeight:"bold"},closeButton:{padding:5},switchContainer:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:"100%",marginVertical:10,zIndex:1},buttonContainer:{flexDirection:"row",justifyContent:"space-between",width:"100%",marginTop:20,gap:10},availabilityButton:{padding:10,borderRadius:5,flex:1,alignItems:"center"},availableButton:{backgroundColor:f.theme.colors.primary},unavailableButton:{backgroundColor:f.theme.colors.danger},disabledButton:{opacity:.5},availabilityButtonText:{color:f.theme.colors.whiteText,fontWeight:"bold"},timePickerContainer:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:"100%",marginVertical:10,zIndex:1},webTimePicker:{padding:5,borderWidth:1,borderColor:f.theme.colors.border,borderRadius:5},unavailableTimesContainer:{marginTop:20,maxHeight:200},sectionTitle:{fontSize:f.theme.fontSizes.medium,fontWeight:"bold",marginBottom:10},inputWrapper:{position:"relative",width:"100%",marginBottom:15,zIndex:2},inputLabel:{fontSize:f.theme.fontSizes.small,color:f.theme.colors.text,marginBottom:5,fontWeight:"500"},input:{borderColor:f.theme.colors.border,borderWidth:1,borderRadius:5,padding:10,backgroundColor:f.theme.colors.inputBackground},customDropdown:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",height:40},dropdownContainer:{position:"absolute",top:"95%",left:0,right:0,backgroundColor:f.theme.colors.surface,borderWidth:1,borderColor:f.theme.colors.border,borderRadius:5,marginTop:2,maxHeight:160,zIndex:1e3,elevation:5,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:3.84},dropdownScroll:{maxHeight:160},dropdownItem:{padding:10,borderBottomWidth:1,borderBottomColor:f.theme.colors.border,height:40},dropdownText:{color:f.theme.colors.text,fontSize:f.theme.fontSizes.medium},selectedOption:{color:f.theme.colors.primary,fontWeight:"bold"},inputError:{borderColor:f.theme.colors.danger},dropdownItemContent:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingRight:10},toggleContainer:{flexDirection:"row",marginBottom:16,borderRadius:8,backgroundColor:f.theme.colors.surface,padding:4},toggleButton:{flex:1,paddingVertical:8,paddingHorizontal:16,borderRadius:6,borderColor:f.theme.colors.border,borderWidth:1,margin:2},activeToggle:{backgroundColor:f.theme.colors.primary},toggleText:{textAlign:"center",color:f.theme.colors.text,fontSize:f.theme.fontSizes.small},activeToggleText:{color:f.theme.colors.whiteText,fontWeight:"500"},bookingsList:{maxHeight:300},emptyState:{alignItems:"center",justifyContent:"center",padding:32},emptyStateText:{marginTop:16,color:f.theme.colors.textSecondary,fontSize:f.theme.fontSizes.medium,textAlign:"center"},contentScrollView:{flex:1,width:"100%"},availabilityControls:{marginTop:20,paddingTop:20,borderTopWidth:1,borderTopColor:f.theme.colors.border,width:"100%"},bookingsContainer:{maxHeight:200,marginBottom:16},unavailableTimesWrapper:{maxHeight:200,marginBottom:16},bookingsWrapper:{marginBottom:16},selectedDatesText:{marginVertical:8,fontSize:f.theme.fontSizes.medium,color:f.theme.colors.text}})),Lo=({isVisible:e,onClose:t,onSave:o,selectedDates:n,currentAvailability:l,bookings:d,onRemoveTimeSlot:c})=>{const[u,m]=(0,a.useState)(e),[g,h]=(0,a.useState)(!1),[p,y]=(0,a.useState)(new Date),[b,x]=(0,a.useState)(new Date),[w,C]=(0,a.useState)(!1),[B,k]=(0,a.useState)(!1),[A,I]=(0,a.useState)([]),[D,M]=(0,a.useState)(!1),[R,P]=(0,a.useState)(W()),[z,F]=(0,a.useState)("bookings"),[L,O]=(0,a.useState)(null),E=(0,j.useNavigation)();function W(){const{width:e}=v.default.get("window");return e<600?.9*e:.4*e}(0,a.useEffect)((()=>{m(e)}),[e]),(0,a.useEffect)((()=>{const e=v.default.addEventListener("change",(()=>{P(W())}));return()=>{e.remove()}}),[]);const N=()=>!(!p||!b||g)&&n.some((e=>(l[e]?.unavailableTimes||[]).some((e=>{const[t,o]=e.startTime.split(":").map(Number),[a,n]=e.endTime.split(":").map(Number),r=(0,ko.format)(p,"HH:mm"),i=(0,ko.format)(b,"HH:mm"),[s,l]=r.split(":").map(Number),[d,c]=i.split(":").map(Number);return s===t&&l===o&&d===a&&c===n}))));return(0,T.jsx)(_.default,{visible:u,animationType:"slide",transparent:!0,onRequestClose:t,children:(0,T.jsx)(r.default,{style:Fo.modalContainer,children:(0,T.jsxs)(r.default,{style:[Fo.modalContent,{width:R}],children:[(0,T.jsxs)(r.default,{style:Fo.modalHeader,children:[(0,T.jsx)(i.default,{style:Fo.modalTitle,children:n.length>1?"Edit Multiple Days":"Edit Availability"}),(0,T.jsx)(s.default,{style:Fo.closeButton,onPress:t,children:(0,T.jsx)(S.default,{name:"close",size:24,color:f.theme.colors.text})})]}),(0,T.jsxs)(i.default,{style:Fo.selectedDatesText,children:["Selected Dates: ",(()=>{if(!n||0===n.length)return"";const e=n[0],t=n[n.length-1];return e===t?e:"".concat(e," - ").concat(t)})()]}),(0,T.jsxs)(r.default,{style:Fo.toggleContainer,children:[(0,T.jsx)(s.default,{style:[Fo.toggleButton,"unavailable"===z&&Fo.activeToggle],onPress:()=>F("unavailable"),children:(0,T.jsx)(i.default,{style:[Fo.toggleText,"unavailable"===z&&Fo.activeToggleText],children:"Unavailable Times"})}),(0,T.jsx)(s.default,{style:[Fo.toggleButton,"bookings"===z&&Fo.activeToggle],onPress:()=>F("bookings"),children:(0,T.jsx)(i.default,{style:[Fo.toggleText,"bookings"===z&&Fo.activeToggleText],children:"Bookings"})})]}),(0,T.jsxs)(H.default,{style:Fo.contentScrollView,nestedScrollEnabled:!0,children:["unavailable"===z?(0,T.jsx)(r.default,{style:Fo.unavailableTimesWrapper,children:(()=>{if(0===n.length)return null;const e=n[0],t=l[e]?.unavailableTimes||[];return 0===t.length?null:(0,T.jsxs)(r.default,{style:Fo.unavailableTimesContainer,children:[(0,T.jsx)(i.default,{style:Fo.sectionTitle,children:"Unavailable Times:"}),(0,T.jsx)(H.default,{children:t.map(((t,o)=>(0,T.jsx)(Ao,{startTime:t.startTime,endTime:t.endTime,reason:t.reason,onRemove:()=>((e,t)=>{if(1===n.length)return void c(e,t);const o={};n.forEach((e=>{if(l[e]?.unavailableTimes){const a=l[e].unavailableTimes.filter((e=>e.startTime!==t.startTime||e.endTime!==t.endTime));o[e]=Object.assign({},l[e],{unavailableTimes:a})}})),c(e,t,o,n)})(e,t)},o)))})]})})()}):(0,T.jsx)(r.default,{style:Fo.bookingsWrapper,children:(()=>{const e=n.reduce(((e,t)=>(d[t]&&e.push(...d[t].map((e=>Object.assign({},e,{date:t})))),e)),[]);if(0===e.length)return(0,T.jsxs)(r.default,{style:Fo.emptyState,children:[(0,T.jsx)(S.default,{name:"calendar-blank",size:48,color:f.theme.colors.textSecondary}),(0,T.jsx)(i.default,{style:Fo.emptyStateText,children:"No bookings for selected dates"})]});const o=e=>{t(),setTimeout((()=>{E.navigate("BookingDetails",{bookingId:e.id})}),300)};return(0,T.jsx)(r.default,{style:Fo.bookingsContainer,children:(0,T.jsx)(H.default,{style:Fo.bookingsList,nestedScrollEnabled:!0,children:e.map(((e,t)=>(0,T.jsx)(Do,{booking:e,onPress:()=>o(e),onEdit:()=>o(e)},t)))})})})()}),(0,T.jsxs)(r.default,{style:Fo.availabilityControls,children:[(0,T.jsxs)(r.default,{style:Fo.inputWrapper,children:[(0,T.jsx)(i.default,{style:Fo.inputLabel,children:"Service Type(s) *"}),(0,T.jsxs)(s.default,{style:[Fo.input,Fo.customDropdown,0===A.length&&Fo.inputError],onPress:()=>M(!D),children:[(0,T.jsx)(i.default,{style:{color:A.length>0?f.theme.colors.text:f.theme.colors.placeHolderText},children:A.length>0?A.includes(oe)?"All Services":A.length>1?"".concat(A.length," services selected"):A[0]:"Select service type(s)"}),(0,T.jsx)(S.default,{name:D?"chevron-up":"chevron-down",size:24,color:f.theme.colors.primary})]}),D&&(0,T.jsx)(r.default,{style:Fo.dropdownContainer,children:(0,T.jsx)(H.default,{style:Fo.dropdownScroll,children:ae.map((e=>(0,T.jsx)(s.default,{style:Fo.dropdownItem,onPress:()=>{I(e===oe?A.includes(oe)?[]:[oe]:t=>{const o=t.filter((e=>e!==oe));return t.includes(e)?o.filter((t=>t!==e)):[...o,e]})},children:(0,T.jsxs)(r.default,{style:Fo.dropdownItemContent,children:[(0,T.jsx)(i.default,{style:[Fo.dropdownText,A.includes(e)&&Fo.selectedOption],children:e}),A.includes(e)&&(0,T.jsx)(S.default,{name:"check",size:20,color:f.theme.colors.primary})]})},e)))})})]}),(0,T.jsxs)(r.default,{style:Fo.switchContainer,children:[(0,T.jsx)(i.default,{children:"All Day"}),(0,T.jsx)($e.default,{value:g,onValueChange:h})]}),!g&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)(r.default,{style:Fo.timePickerContainer,children:[(0,T.jsx)(i.default,{children:"Start Time:"}),(0,T.jsx)(Ro,{value:p,onChange:y,showPicker:w,setShowPicker:C,fullWidth:!0})]}),(0,T.jsxs)(r.default,{style:Fo.timePickerContainer,children:[(0,T.jsx)(i.default,{children:"End Time:"}),(0,T.jsx)(Ro,{value:b,onChange:x,showPicker:B,setShowPicker:k,fullWidth:!0})]})]}),(0,T.jsxs)(r.default,{style:Fo.buttonContainer,children:[(0,T.jsx)(s.default,{style:[Fo.availabilityButton,Fo.availableButton,(0===A.length||!N())&&Fo.disabledButton],onPress:()=>{if(0===A.length||!N())return;const e=(0,ko.format)(p,"HH:mm"),t=(0,ko.format)(b,"HH:mm"),o={};n.forEach((a=>{if(l[a]?.unavailableTimes){const n=l[a].unavailableTimes.filter((o=>o.startTime!==e||o.endTime!==t));o[a]=Object.assign({},l[a],{unavailableTimes:n})}})),c(n[0],{startTime:e,endTime:t},o,n)},disabled:0===A.length||!N(),children:(0,T.jsx)(i.default,{style:Fo.availabilityButtonText,children:"Mark Available"})}),(0,T.jsx)(s.default,{style:[Fo.availabilityButton,Fo.unavailableButton,(0===A.length||N())&&Fo.disabledButton],onPress:()=>{if(0===A.length||N())return;const e=A.includes(oe)?ae.filter((e=>e!==oe)):A;o({dates:n,isAllDay:g,startTime:g?null:(0,ko.format)(p,"HH:mm"),endTime:g?null:(0,ko.format)(b,"HH:mm"),isUnavailable:!0,serviceTypes:e,reason:"Unavailable for: ".concat(e.join(", "))})},disabled:0===A.length||N(),children:(0,T.jsx)(i.default,{style:Fo.availabilityButtonText,children:"Mark Unavailable"})})]})]})]})]})})})},Oo=({format:e=[["months","days","years"],["hours","minutes","am/pm"]],value:t,onChange:o,disabled:i=!1,isInModal:s=!1,error:l=!1})=>{const[d,c]=(0,a.useState)({months:"",days:"",years:"",hours:"",minutes:"",ampm:"AM"}),u=e=>{const{months:t,days:o,years:a,hours:n,minutes:r,ampm:i}=e;if(!t||!o||!a)return null;let s=parseInt(n||"12");return"PM"===i&&12!==s&&(s+=12),"AM"===i&&12===s&&(s=0),new Date(parseInt(a),parseInt(t)-1,parseInt(o),s,parseInt(r||"0"))},m=e=>{let t=[];switch(e){case"months":t=Array.from({length:12},((e,t)=>({value:(t+1).toString(),label:new Date(2e3,t).toLocaleString("default",{month:"long"})})));break;case"days":t=Array.from({length:31},((e,t)=>({value:(t+1).toString(),label:(t+1).toString()})));break;case"years":const e=(new Date).getFullYear();t=Array.from({length:100},((t,o)=>({value:(e-50+o).toString(),label:(e-50+o).toString()})));break;case"hours":t=Array.from({length:12},((e,t)=>({value:(t+1).toString(),label:(t+1).toString()})));break;case"minutes":t=Array.from({length:60},((e,t)=>({value:t.toString().padStart(2,"0"),label:t.toString().padStart(2,"0")})));break;case"am/pm":t=[{value:"AM",label:"AM"},{value:"PM",label:"PM"}]}const a=Object.assign({},Eo.select,l?Eo.errorSelect:{},"months"===e?Eo.monthSelect:{},"years"===e?Eo.yearSelect:{},"days"===e?Eo.daySelect:{});return(0,T.jsxs)("select",{value:d["am/pm"===e?"ampm":e],onChange:t=>{s&&"web"===n.default.OS&&t.stopPropagation(),((e,t)=>{if(i)return;const a=Object.assign({},d,{[e]:t});if(c(a),o){const e=u(a);o(e)}})("am/pm"===e?"ampm":e,t.target.value)},style:a,disabled:i,children:[(0,T.jsx)("option",{value:"",children:e.charAt(0).toUpperCase()+e.slice(1)}),t.map((e=>(0,T.jsx)("option",{value:e.value,children:e.label},e.value)))]})};return(0,T.jsx)(r.default,{style:Eo.container,children:e.map(((e,t)=>(0,T.jsx)(r.default,{style:Eo.row,children:e.map(((e,t)=>(0,T.jsx)(r.default,{style:Eo.selectContainer,children:m(e)},e)))},t)))})},Eo=l.default.create({container:{width:"100%"},row:{flexDirection:"row",marginBottom:8,gap:8},selectContainer:{flex:1},select:{width:"100%",padding:8,borderRadius:4,borderWidth:1,borderColor:f.theme.colors.border,backgroundColor:f.theme.colors.background,fontSize:f.theme.fontSizes.medium,color:f.theme.colors.text,appearance:"none",WebkitAppearance:"none",MozAppearance:"none",paddingRight:8,cursor:"pointer"},monthSelect:{flex:1.5},daySelect:{flex:.8},yearSelect:{flex:1.2},errorSelect:{borderColor:f.theme.colors.danger}}),{width:Wo}=v.default.get("window"),No=(n.default.OS,"All Days"),Ho=[No,"Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],Uo=l.default.create({modalContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0, 0, 0, 0.5)"},modalContent:{backgroundColor:f.theme.colors.background,padding:22,borderRadius:17,maxHeight:"80%"},modalHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:20},closeButton:{padding:8},modalTitle:{fontSize:f.theme.fontSizes.large,fontWeight:"bold",marginBottom:15,fontFamily:f.theme.fonts.header.fontFamily},settingContainer:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:"100%",marginVertical:10},sectionTitle:{fontSize:f.theme.fontSizes.medium,fontWeight:"bold",marginTop:20,marginBottom:10,fontFamily:f.theme.fonts.header.fontFamily},dayContainer:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:"100%",marginVertical:5},buttonContainer:{flexDirection:"row",justifyContent:"space-between",gap:12,marginTop:20},button:{flex:1,padding:12,borderRadius:8,alignItems:"center"},availableButton:{backgroundColor:f.theme.colors.primary},unavailableButton:{backgroundColor:f.theme.colors.error},buttonText:{color:f.theme.colors.whiteText,fontWeight:"bold",fontFamily:f.theme.fonts.regular.fontFamily},tabContainer:{flexDirection:"row",marginBottom:15},tab:{paddingHorizontal:15,paddingVertical:10,borderBottomWidth:2,borderBottomColor:"transparent"},selectedTab:{borderBottomColor:f.theme.colors.primary},tabText:{color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily},selectedTabText:{color:f.theme.colors.primary,fontFamily:f.theme.fonts.regular.fontFamily},daySettingsContainer:{marginBottom:15},settingRow:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:15,gap:12},webTimePicker:{padding:5,borderWidth:1,borderColor:f.theme.colors.border,borderRadius:5},webDatePicker:{padding:5,borderWidth:1,borderColor:f.theme.colors.border,borderRadius:5},inputWrapper:{position:"relative",width:"100%",marginBottom:15,zIndex:2},inputLabel:{marginBottom:5,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily},input:{borderWidth:1,borderColor:f.theme.colors.border,borderRadius:5,padding:10,backgroundColor:f.theme.colors.surface},customDropdown:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"},dropdownContainer:{position:"absolute",top:"100%",left:0,right:0,backgroundColor:f.theme.colors.surface,borderWidth:1,borderColor:f.theme.colors.border,borderRadius:5,maxHeight:200,zIndex:1e3},dropdownScroll:{maxHeight:200},dropdownItem:{padding:10,borderBottomWidth:1,borderBottomColor:f.theme.colors.border},dropdownItemContent:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"},dropdownText:{color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily},selectedOption:{color:f.theme.colors.primary,fontWeight:"bold",fontFamily:f.theme.fonts.regular.fontFamily},inputError:{borderColor:f.theme.colors.danger},disabledButton:{opacity:.5},disabledText:{color:f.theme.colors.placeHolderText,fontFamily:f.theme.fonts.regular.fontFamily},enabledText:{color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily},timePickerContainer:{flex:1,maxWidth:150},datePickerContainer:{flex:1,maxWidth:200},datePickerWrapper:{width:"100%"},validationErrorText:{color:f.theme.colors.danger,fontSize:f.theme.fontSizes.small,marginTop:4,fontFamily:f.theme.fonts.regular.fontFamily}}),Vo=({isVisible:e,onClose:t,onSave:o,defaultSettings:l})=>{const{screenWidth:d}=(0,a.useContext)(p.AuthContext),[c,u]=(0,a.useState)([]),[m,g]=(0,a.useState)(l||{Monday:{isAllDay:!1,startTime:"09:00",endTime:"17:00",endDate:null},Tuesday:{isAllDay:!1,startTime:"09:00",endTime:"17:00",endDate:null},Wednesday:{isAllDay:!1,startTime:"09:00",endTime:"17:00",endDate:null},Thursday:{isAllDay:!1,startTime:"09:00",endTime:"17:00",endDate:null},Friday:{isAllDay:!1,startTime:"09:00",endTime:"17:00",endDate:null},Saturday:{isAllDay:!1,startTime:"09:00",endTime:"17:00",endDate:null},Sunday:{isAllDay:!1,startTime:"09:00",endTime:"17:00",endDate:null}}),[h,y]=(0,a.useState)({visible:!1,type:"",value:""}),[b,x]=(0,a.useState)(!1),[j,w]=(0,a.useState)(!1),[v,B]=(0,a.useState)(!1),[k,A]=(0,a.useState)("Please select day(s) first"),I=(0,a.useRef)(new C.default.Value(0)).current,D=(0,a.useRef)(new C.default.Value(600)).current,M=()=>{C.default.parallel([C.default.timing(I,{toValue:0,duration:300,useNativeDriver:!0}),C.default.timing(D,{toValue:600,duration:300,useNativeDriver:!0})]).start((()=>{t()}))};(0,a.useEffect)((()=>{e&&(C.default.timing(I,{toValue:1,duration:300,useNativeDriver:!0}).start(),C.default.spring(D,{toValue:0,tension:50,friction:8,useNativeDriver:!0}).start())}),[e]),(0,a.useEffect)((()=>{const e=e=>{const t=document.getElementById("dropdown-button"),o=document.getElementById("dropdown-container");v&&o&&!o.contains(e.target)&&!t.contains(e.target)&&B(!1)};if("web"===n.default.OS)return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[v]);const R=e=>{if(console.log("Selected days:",c),0===c.length)return;const t=c.includes(No)?Ho.filter((e=>e!==No)):c;console.log("Days to update:",t),console.log("Current settings:",m),console.log("Making available:",e);const a=Object.assign({},m);t.forEach((t=>{console.log("Updating ".concat(t)),a[t]=Object.assign({},m[t],{isUnavailable:!e,startTime:m[c[0]].startTime,endTime:m[c[0]].endTime,isAllDay:m[c[0]].isAllDay,endDate:m[c[0]].endDate})})),console.log("New settings:",a),g(a),o(a),w(!e)};(0,a.useEffect)((()=>{0===c.length?A("Please select day(s) first"):A("")}),[c]);const P=(e,t,o)=>(0,T.jsx)(Ro,{value:new Date("2000-01-01T".concat(t)),onChange:e=>{const t=e.toTimeString().slice(0,5);o(t)},fullWidth:!1,disabled:0===c.length,error:k}),z=()=>{if(!c||0===c.length)return(0,T.jsxs)(r.default,{style:Uo.datePickerWrapper,children:[(0,T.jsx)(r.default,{style:[Uo.datePickerContainer],onClick:e=>e.stopPropagation(),onMouseDown:e=>e.stopPropagation(),children:(0,T.jsx)(Oo,{format:[["months","days","years"]],disabled:!0,isInModal:!0,error:!0})}),(0,T.jsx)(i.default,{style:Uo.validationErrorText,children:k})]});const e=m[c[0]];return(0,T.jsx)(r.default,{style:Uo.datePickerWrapper,children:(0,T.jsx)(r.default,{style:Uo.datePickerContainer,onClick:e=>e.stopPropagation(),onMouseDown:e=>e.stopPropagation(),children:(0,T.jsx)(Oo,{format:[["months","days","years"]],value:e.endDate?new Date(e.endDate):null,onChange:e=>{return t=c[0],o={endDate:e.toISOString().split("T")[0]},void g((e=>Object.assign({},e,{[t]:Object.assign({},e[t],o)})));var t,o},disabled:!1,isInModal:!0,error:!1})})})};(0,a.useEffect)((()=>{if(c.length>0){const e=((e,t)=>!(!e||0===e.length)&&e.some((e=>t[e]?.isUnavailable)))(c,m);w(e)}else w(!1)}),[c,m]);return(0,T.jsx)(_.default,{visible:e,transparent:!0,onRequestClose:M,children:(0,T.jsx)(C.default.View,{style:[Uo.modalContainer,{opacity:I}],children:(0,T.jsxs)(C.default.View,{style:[Uo.modalContent,{width:d<600?"90%":600,transform:[{translateY:D}]}],children:[(0,T.jsxs)(r.default,{style:Uo.modalHeader,children:[(0,T.jsx)(i.default,{style:Uo.modalTitle,children:"Default Settings"}),(0,T.jsx)(s.default,{onPress:M,style:Uo.closeButton,children:(0,T.jsx)(S.default,{name:"close",size:24,color:f.theme.colors.text})})]}),(0,T.jsxs)(r.default,{style:Uo.inputWrapper,children:[(0,T.jsx)(i.default,{style:Uo.inputLabel,children:"Day(s) *"}),(0,T.jsxs)(s.default,{id:"dropdown-button",style:[Uo.input,Uo.customDropdown,0===c.length&&Uo.inputError],onPress:()=>B(!v),children:[(0,T.jsx)(i.default,{style:{color:c.length>0?f.theme.colors.text:f.theme.colors.placeHolderText},children:0===c.length?"Select Days":c.includes(No)?"All Days":c.length>2?"".concat(c.length," Days Selected"):c.join(", ")}),(0,T.jsx)(S.default,{name:v?"chevron-up":"chevron-down",size:24,color:f.theme.colors.text})]}),v&&(0,T.jsx)(r.default,{id:"dropdown-container",style:Uo.dropdownContainer,children:(0,T.jsx)(H.default,{style:Uo.dropdownScroll,children:Ho.map((e=>(0,T.jsx)(s.default,{style:Uo.dropdownItem,onPress:()=>(e=>{u((t=>{if(e===No)return t.includes(No)?[]:Ho.filter((e=>e!==No));const o=t.filter((e=>e!==No));return o.includes(e)?o.filter((t=>t!==e)):o.length+1===Ho.length-1?Ho.filter((e=>e!==No)):[...o,e]}))})(e),children:(0,T.jsxs)(r.default,{style:Uo.dropdownItemContent,children:[(0,T.jsx)(i.default,{style:[Uo.dropdownText,c.includes(e)&&Uo.selectedOption],children:e}),c.includes(e)&&(0,T.jsx)(S.default,{name:"check",size:20,color:f.theme.colors.primary})]})},e)))})})]}),(()=>{const e=m[c[0]]||{isAllDay:!1,startTime:"09:00",endTime:"17:00",endDate:null};return(0,T.jsxs)(r.default,{style:Uo.daySettingsContainer,children:[(0,T.jsxs)(r.default,{style:Uo.settingRow,children:[(0,T.jsx)(i.default,{style:0===c.length?Uo.disabledText:Uo.enabledText,children:"All Day:"}),(0,T.jsx)($e.default,{value:e.isAllDay,onValueChange:e=>{if(0===c.length)return;const t=Object.assign({},m);c.forEach((o=>{t[o]=Object.assign({},t[o],{isAllDay:e})})),g(t)},disabled:0===c.length})]}),!e.isAllDay&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)(r.default,{style:Uo.settingRow,children:[(0,T.jsx)(i.default,{style:0===c.length?Uo.disabledText:Uo.enabledText,children:"Start Time:"}),(0,T.jsx)(r.default,{style:Uo.timePickerContainer,children:P(0,e.startTime,(e=>{if(0===c.length)return;const t=Object.assign({},m);c.forEach((o=>{t[o]=Object.assign({},t[o],{startTime:e})})),g(t)}))})]}),(0,T.jsxs)(r.default,{style:Uo.settingRow,children:[(0,T.jsx)(i.default,{style:0===c.length?Uo.disabledText:Uo.enabledText,children:"End Time:"}),(0,T.jsx)(r.default,{style:Uo.timePickerContainer,children:P(0,e.endTime,(e=>{if(0===c.length)return;const t=Object.assign({},m);c.forEach((o=>{t[o]=Object.assign({},t[o],{endTime:e})})),g(t)}))})]})]}),(0,T.jsxs)(r.default,{style:Uo.settingRow,children:[(0,T.jsx)(i.default,{style:0===c.length?Uo.disabledText:Uo.enabledText,children:"End Date:"}),(0,T.jsx)(r.default,{pointerEvents:0===c.length?"none":"auto",children:z()})]})]})})(),(0,T.jsxs)(r.default,{style:Uo.buttonContainer,children:[(0,T.jsx)(s.default,{style:[Uo.button,Uo.availableButton],onPress:()=>R(!0),disabled:0===c.length,children:(0,T.jsx)(i.default,{style:Uo.buttonText,children:"Mark Available"})}),(0,T.jsx)(s.default,{style:[Uo.button,Uo.unavailableButton],onPress:()=>R(!1),disabled:0===c.length,children:(0,T.jsx)(i.default,{style:Uo.buttonText,children:"Mark Unavailable"})})]})]})})})},qo=l.default.create({overlay:{width:"100%",pointerEvents:"box-none"},container:{backgroundColor:f.theme.colors.surface,borderTopLeftRadius:20,borderTopRightRadius:20,padding:16,paddingBottom:"ios"===n.default.OS?40:16,maxWidth:600,width:"100%",alignSelf:"center",shadowColor:"#000",shadowOffset:{width:0,height:-2},shadowOpacity:.25,shadowRadius:3.84,elevation:5},handleContainer:{width:"100%",height:24,alignItems:"center",justifyContent:"center",marginBottom:4},handle:{width:40,height:4,backgroundColor:f.theme.colors.border,borderRadius:2},header:{flexDirection:"row",alignItems:"center",marginBottom:12,paddingRight:8,marginTop:4},headerMinimized:{marginBottom:8,paddingBottom:12,justifyContent:"space-between"},headerCenter:{flex:1,alignItems:"center"},closeButton:{width:60,height:40,justifyContent:"center",alignItems:"center"},dateText:{fontSize:f.theme.fontSizes.medium,fontWeight:"bold",color:f.theme.colors.text,fontFamily:f.theme.fonts.header.fontFamily},statusText:{fontSize:f.theme.fontSizes.medium,marginTop:4,fontFamily:f.theme.fonts.regular.fontFamily},actionButton:{width:60,alignItems:"center"},actionButtonText:{fontSize:f.theme.fontSizes.small,color:f.theme.colors.primary,marginTop:4,textAlign:"center",lineHeight:16,fontFamily:f.theme.fonts.regular.fontFamily},content:{gap:12},timeToggleContainer:{},customToggle:{flexDirection:"row",backgroundColor:f.theme.colors.background,borderRadius:8,padding:4,gap:8},toggleButton:{flex:1,paddingVertical:12,paddingHorizontal:16,borderRadius:6,alignItems:"center",borderWidth:1,borderColor:f.theme.colors.border},toggleButtonActive:{backgroundColor:f.theme.colors.primary,borderColor:f.theme.colors.primary},toggleButtonInactive:{backgroundColor:"transparent"},toggleButtonText:{color:f.theme.colors.text,fontSize:f.theme.fontSizes.medium,fontFamily:f.theme.fonts.regular.fontFamily},toggleButtonTextActive:{color:f.theme.colors.whiteText,fontWeight:"bold",fontFamily:f.theme.fonts.regular.fontFamily},timeSection:{flexDirection:"row",gap:16},timeContainer:{flex:1},label:{fontSize:f.theme.fontSizes.medium,color:f.theme.colors.text,marginBottom:4,fontFamily:f.theme.fonts.regular.fontFamily},serviceSection:{position:"relative",zIndex:1},serviceSelector:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",borderWidth:1,borderColor:f.theme.colors.border,borderRadius:8,padding:12,backgroundColor:f.theme.colors.background},serviceSelectorText:{color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily},dropdownContainer:{position:"absolute",top:"100%",left:0,right:0,backgroundColor:f.theme.colors.surface,borderWidth:1,borderColor:f.theme.colors.border,borderRadius:8,maxHeight:200,zIndex:1e3},dropdownScroll:{maxHeight:200},dropdownItem:{padding:12,borderBottomWidth:1,borderBottomColor:f.theme.colors.border},dropdownItemContent:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"},dropdownText:{color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily},selectedOption:{color:f.theme.colors.primary,fontWeight:"bold",fontFamily:f.theme.fonts.regular.fontFamily},buttonContainer:{flexDirection:"row",gap:12},button:{flex:1,padding:12,borderRadius:8,alignItems:"center"},availableButton:{backgroundColor:f.theme.colors.primary},unavailableButton:{backgroundColor:f.theme.colors.error},buttonText:{color:f.theme.colors.whiteText,fontSize:f.theme.fontSizes.medium,fontWeight:"bold",fontFamily:f.theme.fonts.regular.fontFamily},serviceSelectorError:{borderColor:f.theme.colors.error,borderWidth:1},errorText:{color:f.theme.colors.error,fontSize:f.theme.fontSizes.small,marginTop:4,fontFamily:f.theme.fonts.regular.fontFamily}}),Yo=({selectedDates:e,currentAvailability:t,onClose:o,onViewUnavailableTimes:l,onSave:d,onMinimize:c})=>{const{screenWidth:u}=(0,a.useContext)(p.AuthContext),[m,g]=(0,a.useState)(new Date),[h,y]=(0,a.useState)(new Date),[b,x]=(0,a.useState)([]),[j,w]=(0,a.useState)(!1),[v,B]=(0,a.useState)(!1),[k,_]=(0,a.useState)(null),[A,I]=(0,a.useState)(!1),D=(0,a.useRef)(new C.default.Value(1)).current,M=(0,a.useRef)(new C.default.Value(1)).current,R=(0,a.useRef)(new C.default.Value(0)).current;(0,a.useEffect)((()=>{C.default.spring(R,{toValue:1,useNativeDriver:!0,tension:50,friction:8}).start()}),[]);const P=()=>{if(!e||0===e.length)return"Unknown";const o=e[0],a=t[o];return a?a.isAvailable?a.unavailableTimes?.length>0?"Partially Available":"Available":"Unavailable":"Available"},z=e=>{0!==b.length?(_(null),d({startTime:v?"00:00":(0,ko.format)(m,"HH:mm"),endTime:v?"24:00":(0,ko.format)(h,"HH:mm"),services:b,isAvailable:e,isAllDay:v})):_("Please select at least one service type")},F=()=>{const e=A?1:0,t=!A;c?.(t),C.default.parallel([C.default.timing(D,{toValue:e,duration:300,useNativeDriver:!1}),C.default.timing(M,{toValue:e,duration:300,useNativeDriver:!1})]).start((()=>{I(t)}))},L=v?364:445,O=D.interpolate({inputRange:[0,1],outputRange:[96,L]});return(0,T.jsx)(r.default,{style:[qo.overlay,{pointerEvents:A?"box-none":"auto"}],children:(0,T.jsxs)(C.default.View,{style:[qo.container,{height:O,transform:[{translateY:R.interpolate({inputRange:[0,1],outputRange:[600,0]})}]}],children:["web"===n.default.OS?(0,T.jsx)(s.default,{onPress:F,style:qo.handleContainer,children:(0,T.jsx)(S.default,{name:A?"chevron-up":"chevron-down",size:24,color:f.theme.colors.text})}):(0,T.jsx)(s.default,{onPress:F,style:qo.handleContainer,children:(0,T.jsx)(r.default,{style:qo.handle})}),(0,T.jsxs)(r.default,{style:[qo.header,A&&qo.headerMinimized],children:[!A&&(0,T.jsx)(s.default,{onPress:()=>{C.default.timing(R,{toValue:0,duration:300,useNativeDriver:!0}).start((()=>{o()}))},style:qo.closeButton,children:(0,T.jsx)(S.default,{name:"close",size:24,color:f.theme.colors.text})}),(0,T.jsxs)(r.default,{style:qo.headerCenter,children:[(0,T.jsx)(i.default,{style:qo.dateText,children:e&&0!==e.length?1===e.length?(0,ko.format)((0,Bo.parse)(e[0],"yyyy-MM-dd",new Date),"MMM dd, yyyy"):"".concat((0,ko.format)((0,Bo.parse)(e[0],"yyyy-MM-dd",new Date),"MMM dd")," - ").concat((0,ko.format)((0,Bo.parse)(e[e.length-1],"yyyy-MM-dd",new Date),"MMM dd, yyyy")):""}),(0,T.jsx)(i.default,{style:[qo.statusText,{color:(()=>{switch(P()){case"Available":return f.theme.colors.success;case"Partially Available":return f.theme.colors.warning;case"Unavailable":return f.theme.colors.error;default:return f.theme.colors.text}})()}],children:P()})]}),!A&&(0,T.jsx)(C.default.View,{style:{opacity:M},children:(0,T.jsxs)(s.default,{style:qo.actionButton,onPress:l,children:[(0,T.jsx)(S.default,{name:"clock-outline",size:24,color:f.theme.colors.primary}),(0,T.jsx)(i.default,{style:qo.actionButtonText,children:"Unavailable\nTimes"})]})})]}),(0,T.jsxs)(C.default.View,{style:[qo.content,{opacity:M}],children:[(0,T.jsxs)(r.default,{style:qo.serviceSection,children:[(0,T.jsx)(i.default,{style:[qo.label,{textAlign:"center"}],children:"Change Availability for Services"}),(0,T.jsxs)(s.default,{style:[qo.serviceSelector,k&&b.length<=0&&qo.serviceSelectorError],onPress:()=>w(!j),children:[(0,T.jsx)(i.default,{style:qo.serviceSelectorText,children:b.length>0?b.includes(oe)?"All Services":b.length>1?"".concat(b.length," services selected"):b[0]:"Select one or more service types"}),(0,T.jsx)(S.default,{name:j?"chevron-up":"chevron-down",size:24,color:f.theme.colors.primary})]}),k&&b.length<=0&&!j&&(0,T.jsx)(i.default,{style:qo.errorText,children:k}),j&&(0,T.jsx)(r.default,{style:qo.dropdownContainer,children:(0,T.jsx)(H.default,{style:qo.dropdownScroll,children:ae.map((e=>(0,T.jsx)(s.default,{style:qo.dropdownItem,onPress:()=>{x(e===oe?b.includes(oe)?[]:[oe]:t=>{const o=t.filter((e=>e!==oe));return t.includes(e)?o.filter((t=>t!==e)):[...o,e]})},children:(0,T.jsxs)(r.default,{style:qo.dropdownItemContent,children:[(0,T.jsx)(i.default,{style:[qo.dropdownText,b.includes(e)&&qo.selectedOption],children:e}),b.includes(e)&&(0,T.jsx)(S.default,{name:"check",size:20,color:f.theme.colors.primary})]})},e)))})})]}),(0,T.jsxs)(r.default,{style:qo.timeToggleContainer,children:[(0,T.jsx)(i.default,{style:[qo.label,{marginBottom:0}],children:"Time Selection"}),(0,T.jsxs)(r.default,{style:qo.customToggle,children:[(0,T.jsx)(s.default,{style:[qo.toggleButton,v?qo.toggleButtonActive:qo.toggleButtonInactive],onPress:()=>B(!0),children:(0,T.jsx)(i.default,{style:[qo.toggleButtonText,v&&qo.toggleButtonTextActive],children:"All Day"})}),(0,T.jsx)(s.default,{style:[qo.toggleButton,v?qo.toggleButtonInactive:qo.toggleButtonActive],onPress:()=>B(!1),children:(0,T.jsx)(i.default,{style:[qo.toggleButtonText,!v&&qo.toggleButtonTextActive],children:"Custom Hours"})})]})]}),!v&&(0,T.jsxs)(r.default,{style:qo.timeSection,children:[(0,T.jsxs)(r.default,{style:qo.timeContainer,children:[(0,T.jsx)(i.default,{style:[qo.label,{marginBottom:0}],children:"Start Time"}),(0,T.jsx)(Ro,{value:m,onChange:g,fullWidth:!0})]}),(0,T.jsxs)(r.default,{style:qo.timeContainer,children:[(0,T.jsx)(i.default,{style:[qo.label,{marginBottom:0}],children:"End Time"}),(0,T.jsx)(Ro,{value:h,onChange:y,fullWidth:!0})]})]}),(0,T.jsxs)(r.default,{style:qo.buttonContainer,children:[(0,T.jsx)(s.default,{style:[qo.button,qo.availableButton],onPress:()=>z(!0),children:(0,T.jsx)(i.default,{style:qo.buttonText,children:"Mark Available"})}),(0,T.jsx)(s.default,{style:[qo.button,qo.unavailableButton],onPress:()=>z(!1),children:(0,T.jsx)(i.default,{style:qo.buttonText,children:"Mark Unavailable"})})]})]})]})})},Go=l.default.create({modalContainer:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center"},modalContent:{backgroundColor:f.theme.colors.surface,borderRadius:20,padding:20,width:"90%",maxWidth:500,maxHeight:"80%"},modalHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:20},modalTitle:{fontSize:f.theme.fontSizes.large,fontWeight:"bold",color:f.theme.colors.text,fontFamily:f.theme.fonts.header.fontFamily},closeButton:{padding:5},timesList:{maxHeight:"90%"},timeSlotContainer:{marginBottom:15},dateHeader:{marginBottom:8},dateText:{fontSize:f.theme.fontSizes.medium,fontWeight:"bold",color:f.theme.colors.text,fontFamily:f.theme.fonts.header.fontFamily},timeSlotContent:{flexDirection:"row",justifyContent:"space-between",alignItems:"flex-start",backgroundColor:f.theme.colors.background,padding:12,borderRadius:8},bookingContent:{borderWidth:1,borderColor:f.theme.colors.border,backgroundColor:f.theme.colors.surface,shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.1,shadowRadius:2,elevation:2},timeAndReason:{flex:1},timeText:{fontSize:f.theme.fontSizes.medium,color:f.theme.colors.text,marginBottom:4,fontFamily:f.theme.fonts.regular.fontFamily},reasonText:{fontSize:f.theme.fontSizes.medium,color:f.theme.colors.textSecondary,fontFamily:f.theme.fonts.regular.fontFamily},removeButton:{padding:5,marginLeft:10},bookingButton:{padding:5,marginLeft:10,backgroundColor:f.theme.colors.surface,borderRadius:20,width:34,height:34,alignItems:"center",justifyContent:"center",shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.1,shadowRadius:1,elevation:2},emptyText:{textAlign:"center",color:f.theme.colors.textSecondary,fontSize:f.theme.fontSizes.medium,marginTop:20,fontFamily:f.theme.fonts.regular.fontFamily}}),Jo=({visible:e,onClose:t,selectedDates:o,currentAvailability:n,onRemoveTimeSlot:l,bookings:d})=>{const c=(0,j.useNavigation)(),u=(0,a.useRef)(new C.default.Value(0)).current,m=(0,a.useRef)(new C.default.Value(600)).current;(0,a.useEffect)((()=>{e&&(C.default.timing(u,{toValue:1,duration:300,useNativeDriver:!0}).start(),C.default.spring(m,{toValue:0,tension:50,friction:8,useNativeDriver:!0}).start())}),[e]);const g=()=>{C.default.parallel([C.default.timing(u,{toValue:0,duration:300,useNativeDriver:!0}),C.default.timing(m,{toValue:600,duration:300,useNativeDriver:!0})]).start((()=>{t()}))},p=e=>{const[t,o]=e.split(":"),a=new Date;return a.setHours(parseInt(t),parseInt(o)),(0,ko.format)(a,"h:mm a")},y=()=>{if(!o||0===o.length)return[];const e=[],t=new Set;return o.forEach((o=>{const a=d[o]||[],r=n[o];a.forEach((a=>{const n="".concat(o,"-").concat(a.startTime,"-").concat(a.endTime);t.has(n)||(e.push({date:o,startTime:a.startTime,endTime:a.endTime,reason:"".concat(a.service_type,"\nBooked with ").concat(a.owner_name),isBooking:!0,ownerId:a.ownerId}),t.add(n))})),r?.unavailableTimes&&r.unavailableTimes.filter((e=>!e.ownerId)).forEach((a=>{const n="".concat(o,"-").concat(a.startTime,"-").concat(a.endTime);t.has(n)||(e.push({date:o,startTime:a.startTime,endTime:a.endTime,reason:a.reason,isBooking:!1}),t.add(n))}))})),e.sort(((e,t)=>e.date!==t.date?e.date.localeCompare(t.date):e.startTime.localeCompare(t.startTime)))},b=e=>e.isBooking?(0,T.jsx)(s.default,{style:Go.bookingButton,onPress:()=>(async e=>{t(),await(0,h.navigateToFrom)(c,"BookingDetails","AvailabilitySettings",{bookingId:e})})(e.ownerId),children:(0,T.jsx)(S.default,{name:"arrow-right",size:24,color:f.theme.colors.primary})}):(0,T.jsx)(s.default,{style:Go.removeButton,onPress:()=>l(e.date,e),children:(0,T.jsx)(S.default,{name:"close",size:24,color:f.theme.colors.error})});return(0,T.jsx)(_.default,{visible:e,transparent:!0,onRequestClose:g,children:(0,T.jsx)(C.default.View,{style:[Go.modalContainer,{opacity:u}],children:(0,T.jsxs)(C.default.View,{style:[Go.modalContent,{transform:[{translateY:m}]}],children:[(0,T.jsxs)(r.default,{style:Go.modalHeader,children:[(0,T.jsx)(i.default,{style:Go.modalTitle,children:"Unavailable Times"}),(0,T.jsx)(s.default,{onPress:g,style:Go.closeButton,children:(0,T.jsx)(S.default,{name:"close",size:24,color:f.theme.colors.text})})]}),(0,T.jsxs)(H.default,{style:Go.timesList,children:[y().map(((e,t)=>((e,t)=>{const o=(0,ko.format)((0,Bo.parse)(e.date,"yyyy-MM-dd",new Date),"MMM d, yyyy"),a=p(e.startTime),n=p(e.endTime);return(0,T.jsxs)(r.default,{style:Go.timeSlotContainer,children:[(0,T.jsx)(r.default,{style:Go.dateHeader,children:(0,T.jsx)(i.default,{style:Go.dateText,children:o})}),(0,T.jsxs)(r.default,{style:[Go.timeSlotContent,e.isBooking&&Go.bookingContent],children:[(0,T.jsxs)(r.default,{style:Go.timeAndReason,children:[(0,T.jsxs)(i.default,{style:Go.timeText,children:[a," - ",n]}),(0,T.jsx)(i.default,{style:Go.reasonText,children:e.reason})]}),b(e)]})]},t)})(e,t))),0===y().length&&(0,T.jsx)(i.default,{style:Go.emptyText,children:"No unavailable times for selected date(s)"})]})]})})})},$o=(e,t)=>l.default.create({mainContainer:{flex:1,backgroundColor:f.theme.colors.background,height:"100vh",overflow:"hidden",position:"fixed",top:0,left:0,right:0,bottom:0,marginLeft:e>900?t?70:250:0,transition:"margin-left 0.3s ease"},container:{flex:1},scrollView:{flex:1},scrollContent:{flexGrow:1},bottomSheetOverlay:{position:"absolute",bottom:0,left:0,right:0},centeredContainer:{maxWidth:e>900?1e3:"100%",width:"100%",alignSelf:"center",flex:1,padding:e<=900?10:20},header:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:e<=900?10:16,flexWrap:e<=600?"wrap":"nowrap",gap:e<=600?10:0},title:{fontSize:e<=600?f.theme.fontSizes.medium:f.theme.fontSizes.large,fontWeight:"bold",color:f.theme.colors.text,fontFamily:f.theme.fonts.header.fontFamily,width:e<=600?"100%":"auto"},addButton:{position:"absolute",right:20,bottom:20,width:56,height:56,borderRadius:28,backgroundColor:f.theme.colors.primary,justifyContent:"center",alignItems:"center",elevation:5,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:3.84},defaultSettingsButton:{flexDirection:"row",alignItems:"center",padding:8},defaultSettingsText:{marginRight:8,fontSize:f.theme.fontSizes.medium,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily},colorKeyContainer:{marginTop:20,padding:e<=600?15:10,backgroundColor:"white",borderRadius:5,elevation:2,flexDirection:e<=600?"column":"row",flexWrap:"wrap",gap:10},colorKeyTitle:{fontSize:16,fontWeight:"bold",marginBottom:10,fontFamily:f.theme.fonts.header.fontFamily},colorKeyItem:{flexDirection:"row",alignItems:"center",marginVertical:e<=600?2:5,flex:e<=600?0:1},colorBox:{width:20,height:20,borderRadius:3,marginRight:10},colorKeyText:{fontSize:14,color:"black",fontFamily:f.theme.fonts.regular.fontFamily},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center"},loadingText:{marginTop:10,fontSize:f.theme.fontSizes.medium,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily},errorContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:20},errorText:{fontSize:f.theme.fontSizes.medium,color:f.theme.colors.error,textAlign:"center",marginBottom:20,fontFamily:f.theme.fonts.regular.fontFamily},retryButton:{backgroundColor:f.theme.colors.primary,padding:10,borderRadius:5},retryButtonText:{color:f.theme.colors.whiteText,fontSize:f.theme.fontSizes.medium,fontFamily:f.theme.fonts.regular.fontFamily},overlay:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"black"},bottomSheetContainer:{position:"absolute",bottom:0,left:0,right:0},calendar:{paddingBottom:20,paddingLeft:10,paddingRight:10}}),Zo=()=>{const{screenWidth:e,isCollapsed:t,is_DEBUG:o}=(0,a.useContext)(p.AuthContext),[l,d]=(0,a.useState)(e<=900),c=$o(e,t),[u,m]=(0,a.useState)({}),[g,h]=(0,a.useState)([]),[y,b]=(0,a.useState)(!1),[x,w]=(0,a.useState)(!1),[v,B]=(0,a.useState)("available"),[k,_]=(0,a.useState)({}),[I,D]=(0,a.useState)({}),[M,R]=(0,a.useState)({Monday:{isAllDay:!1,isUnavailable:!1,startTime:"09:00",endTime:"17:00",endDate:null},Tuesday:{isAllDay:!1,isUnavailable:!1,startTime:"09:00",endTime:"17:00",endDate:null},Wednesday:{isAllDay:!1,isUnavailable:!1,startTime:"09:00",endTime:"17:00",endDate:null},Thursday:{isAllDay:!1,isUnavailable:!1,startTime:"09:00",endTime:"17:00",endDate:null},Friday:{isAllDay:!1,isUnavailable:!1,startTime:"09:00",endTime:"17:00",endDate:null},Saturday:{isAllDay:!1,isUnavailable:!1,startTime:"09:00",endTime:"17:00",endDate:null},Sunday:{isAllDay:!1,isUnavailable:!1,startTime:"09:00",endTime:"17:00",endDate:null}}),[P,z]=(0,a.useState)(!0),[F,L]=(0,a.useState)(null),[O,E]=(0,a.useState)(!1),[W,N]=(0,a.useState)(!1),[U,V]=(0,a.useState)(!1),[q,Y]=(0,a.useState)(!1),G=(0,j.useNavigation)(),J=(0,a.useRef)(new C.default.Value(0)).current;(0,a.useEffect)((()=>{d(e<=900)}),[e]),(0,a.useEffect)((()=>{(async()=>{try{z(!0);const e=await new Promise((e=>{setTimeout((()=>{e({availableDates:{"2025-02-01":{startTime:"09:00",endTime:"17:00"},"2025-02-02":{startTime:"10:00",endTime:"18:00"},"2025-02-03":{startTime:"09:00",endTime:"17:00"}},unavailableDates:{"2025-02-04":{startTime:"00:00",endTime:"24:00"},"2025-02-05":{startTime:"10:00",endTime:"18:00"}},bookings:{"2025-02-06":[{id:"bk1",startTime:"14:00",endTime:"16:00",owner_name:"Charlie",service_type:"Dog Walking"},{id:"bk2",startTime:"16:00",endTime:"18:00",owner_name:"Bob",service_type:"Dog Walking"},{id:"bk3",startTime:"18:00",endTime:"20:00",owner_name:"Nick",service_type:"Pet Boarding"},{id:"bk4",startTime:"20:00",endTime:"22:00",owner_name:"Alfred",service_type:"Drop-In Visits (30 min)"}],"2025-02-07":[{id:"bk5",startTime:"10:00",endTime:"12:00",owner_name:"Uhtred",service_type:"Dog Walking"}]}})}),1e3)}));$(e.availableDates,e.unavailableDates,e.bookings);const t={};Object.keys(e.availableDates).forEach((e=>{t[e]={isAvailable:!0,unavailableTimes:[]}})),Object.keys(e.unavailableDates).forEach((o=>{t[o]={isAvailable:!1,unavailableTimes:[{startTime:e.unavailableDates[o].startTime,endTime:e.unavailableDates[o].endTime,reason:" Personal Time"}]}})),Object.keys(e.bookings).forEach((o=>{t[o]||(t[o]={isAvailable:!0,unavailableTimes:[]}),t[o].unavailableTimes=[...t[o].unavailableTimes,...e.bookings[o].map((e=>({startTime:e.startTime,endTime:e.endTime,reason:" Booked with ".concat(e.owner_name),ownerId:e.ownerId})))]})),_(t),D(e.bookings)}catch(e){L("Failed to load availability data"),console.error(e)}finally{z(!1)}})()}),[]);const $=(e,t,o)=>{const a={};Object.entries(t).forEach((([e,t])=>{const o="00:00"===t.startTime&&"24:00"===t.endTime,n=!!(r=t.reason)&&r.replace("Unavailable for: ","").split(", ").length===ae.length-1;var r;a[e]={customStyles:{container:{backgroundColor:o&&n?"lightgrey":f.theme.colors.calendarColor,width:35,height:35,borderRadius:17.5,alignItems:"center",justifyContent:"center"},text:{color:"white"}}}})),Object.entries(e).forEach((([e,t])=>{a[e]||(a[e]={customStyles:{container:{backgroundColor:"white",width:35,height:35,borderRadius:17.5,alignItems:"center",justifyContent:"center"},text:{color:"black"}}})})),Object.entries(o).forEach((([e,t])=>{const o=t.some((e=>"00:00"===e.startTime&&"24:00"===e.endTime));a[e]={marked:!0,dotColor:f.theme.colors.primary,customStyles:{container:{backgroundColor:o?f.theme.colors.primary:f.theme.colors.calendarColorYellowBrown,width:35,height:35,borderRadius:17.5,alignItems:"center",justifyContent:"center"},text:{color:"white"}}}})),m(a)},Z=e=>{e?(V(!1),E(!0),C.default.timing(J,{toValue:.5,duration:300,useNativeDriver:!0}).start()):(V(!0),C.default.timing(J,{toValue:0,duration:300,useNativeDriver:!0}).start((()=>{E(!1),V(!1)})))},K=e=>{const t=Object.assign({},u),o=Object.assign({},k);e.dates.forEach((a=>{const n=e.serviceTypes.includes(oe)||e.serviceTypes.length===ae.length-1;e.isAvailable?(o[a]={isAvailable:!0,unavailableTimes:[]},t[a]={customStyles:{container:{backgroundColor:"white",width:35,height:35,borderRadius:17.5,alignItems:"center",justifyContent:"center"},text:{color:"black"}}}):(o[a]={isAvailable:!1,unavailableTimes:[{startTime:e.startTime,endTime:e.endTime,reason:e.reason}]},t[a]={customStyles:{container:{backgroundColor:e.isAllDay&&n?"lightgrey":f.theme.colors.calendarColor,width:35,height:35,borderRadius:17.5,alignItems:"center",justifyContent:"center"},text:{color:"white"}}})})),m(t),_(o),b(!1),h([])},Q="web"===n.default.OS?S.default:To.default;return P?(0,T.jsx)(vo.SafeAreaView,{style:c.container,children:(0,T.jsxs)(r.default,{style:c.loadingContainer,children:[(0,T.jsx)(A.default,{size:"large",color:f.theme.colors.primary}),(0,T.jsx)(i.default,{style:c.loadingText,children:"Loading availability..."})]})}):F?(0,T.jsx)(vo.SafeAreaView,{style:c.container,children:(0,T.jsxs)(r.default,{style:c.errorContainer,children:[(0,T.jsx)(i.default,{style:c.errorText,children:F}),(0,T.jsx)(s.default,{style:c.retryButton,onPress:()=>{L(null),loadAvailabilityData()},children:(0,T.jsx)(i.default,{style:c.retryButtonText,children:"Retry"})})]})}):(0,T.jsxs)(r.default,{style:$o(e,t).mainContainer,children:[(0,T.jsxs)(r.default,{style:$o(e,t).container,children:[(0,T.jsx)(H.default,{style:$o(e,t).scrollView,contentContainerStyle:$o(e,t).scrollContent,showsVerticalScrollIndicator:!1,children:(0,T.jsxs)(r.default,{style:$o(e,t).centeredContainer,children:[(0,T.jsxs)(r.default,{style:$o(e,t).header,children:[(0,T.jsx)(i.default,{style:$o(e,t).title,children:"Availability Settings"}),(0,T.jsxs)(s.default,{style:$o(e,t).defaultSettingsButton,onPress:()=>w(!0),children:[(0,T.jsx)(i.default,{style:$o(e,t).defaultSettingsText,children:"Default Settings"}),(0,T.jsx)(Q,{name:"web"===n.default.OS?"cog":"settings-outline",size:24,color:f.theme.colors.text})]})]}),(0,T.jsx)(So.Calendar,{style:[$o(e,t).calendar,{width:e<=900?"100%":"auto"}],markedDates:u,onDayPress:e=>{const{dateString:t}=e,o=new Date(t);if(o.setDate(o.getDate()+1),o.setHours(0,0,0,0),0===g.length)h([t]),Z(!0);else if(g.length>=1){const e=new Date(g[0]);if(e.setDate(e.getDate()+1),e.setHours(0,0,0,0),o.getTime()===e.getTime())return;if(o<e)return h([t]),void Z(!0);const a=[],n=new Date(e),r=new Date(o);for(;n<=r;)a.push((0,ko.format)(n,"yyyy-MM-dd")),n.setDate(n.getDate()+1);h(a)}},theme:{backgroundColor:"transparent",calendarBackground:"transparent",textSectionTitleColor:f.theme.colors.text,selectedDayBackgroundColor:f.theme.colors.primary,selectedDayTextColor:"#ffffff",todayTextColor:f.theme.colors.primary,dayTextColor:f.theme.colors.text,textDisabledColor:"#d9e1e8",dotColor:f.theme.colors.primary,monthTextColor:f.theme.colors.text,arrowColor:f.theme.colors.primary,indicatorColor:f.theme.colors.primary}}),(0,T.jsxs)(r.default,{style:$o(e,t).colorKeyContainer,children:[(0,T.jsx)(i.default,{style:$o(e,t).colorKeyTitle,children:"Color Key"}),(0,T.jsxs)(r.default,{style:$o(e,t).colorKeyItem,children:[(0,T.jsx)(r.default,{style:[$o(e,t).colorBox,{backgroundColor:f.theme.colors.calendarColor}]}),(0,T.jsx)(i.default,{style:$o(e,t).colorKeyText,children:"Unavailable"})]}),(0,T.jsxs)(r.default,{style:$o(e,t).colorKeyItem,children:[(0,T.jsx)(r.default,{style:[$o(e,t).colorBox,{backgroundColor:f.theme.colors.calendarColorYellowBrown}]}),(0,T.jsx)(i.default,{style:$o(e,t).colorKeyText,children:"Partially Available"})]})]})]})}),(0,T.jsx)(s.default,{style:$o(e,t).addButton,onPress:()=>b(!0),children:(0,T.jsx)(To.default,{name:"add",size:24,color:f.theme.colors.whiteText})})]}),y&&(0,T.jsx)(Lo,{visible:y,onClose:()=>b(!1),onSave:K,selectedDate:g.length>0?g[0]:null}),x&&(0,T.jsx)(Vo,{isVisible:x,onClose:()=>w(!1),onSave:e=>{console.log("Before updating defaultSettings:",M),console.log("New settings to be applied:",e),R(e),setTimeout((()=>{console.log("After updating defaultSettings:",M)}),0),(e=>{const t=Object.assign({},u),o=Object.assign({},k),a=new Date,n=new Date(a.getFullYear()+1,a.getMonth(),a.getDate()),r={Sunday:0,Monday:1,Tuesday:2,Wednesday:3,Thursday:4,Friday:5,Saturday:6};Object.entries(e).forEach((([e,i])=>{let s=new Date(Date.UTC(a.getFullYear(),a.getMonth(),a.getDate()));const l=r[e];for(;s<=(i.endDate?new Date(i.endDate):n);){const e=s.getUTCDay(),a=s.toISOString().split("T")[0];e===l&&(i.isUnavailable?i.isAllDay?(t[a]={customStyles:{container:{backgroundColor:"lightgrey"},text:{color:"white"}}},o[a]={isAvailable:!1,unavailableTimes:[{startTime:"00:00",endTime:"24:00",reason:"Default Setting"}]}):(t[a]={customStyles:{container:{backgroundColor:f.theme.colors.calendarColor},text:{color:"white"}}},o[a]={isAvailable:!0,unavailableTimes:[{startTime:i.startTime,endTime:i.endTime,reason:"Default Setting"}]}):(delete t[a],delete o[a])),s.setUTCDate(s.getUTCDate()+1)}})),m(t),_(o)})(e),w(!1)},defaultSettings:M}),(O||U)&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(C.default.View,{style:[c.overlay,{opacity:J,backgroundColor:"black",pointerEvents:q?"none":"auto"}]}),(0,T.jsx)(r.default,{style:[c.bottomSheetContainer,{pointerEvents:"box-none"}],children:(0,T.jsx)(Yo,{selectedDates:g,currentAvailability:k,onClose:()=>{Z(!1),h([])},onViewUnavailableTimes:()=>{N(!0)},onSave:e=>{const{startTime:t,endTime:o,services:a,isAvailable:n}=e;K({dates:g,isAllDay:"00:00"===t&&"24:00"===o,startTime:t,endTime:o,isUnavailable:!n,serviceTypes:a,reason:"Unavailable for: ".concat(a.join(", "))}),Z(!1),h([])},onViewBookings:()=>{g.length>0&&G.navigate("MyBookings",{selectedDates:g,initialTab:"Upcoming"})},onMinimize:e=>{Y(e),C.default.timing(J,{toValue:e?0:.5,duration:300,useNativeDriver:!0}).start()}})})]}),(0,T.jsx)(Jo,{visible:W,onClose:()=>N(!1),selectedDates:g,currentAvailability:k,onRemoveTimeSlot:(e,t,o,a)=>{if(o&&a){_((e=>Object.assign({},e,o)));const e=Object.assign({},u);a.forEach((t=>{0===o[t]?.unavailableTimes.length&&(e[t]={customStyles:{container:{backgroundColor:"white"},text:{color:"black"}}})})),m(e)}else _((o=>{const a=o[e];if(!a)return o;const n=a.unavailableTimes.filter((e=>!(e.startTime===t.startTime&&e.endTime===t.endTime))),r=Object.assign({},u);return 0===n.length&&(r[e]={customStyles:{container:{backgroundColor:"white"},text:{color:"black"}}},m(r)),Object.assign({},o,{[e]:Object.assign({},a,{unavailableTimes:n})})}))},bookings:I})]})};var Ko=o(26318),Qo=o(21055);const{width:Xo}=v.default.get("window"),ea=l.default.create({container:{flex:1,backgroundColor:f.theme.colors.background},scrollContent:{flexGrow:1,padding:16},contentWrapper:{alignSelf:"center"},title:{fontSize:f.theme.fontSizes.large,color:f.theme.colors.text,marginBottom:16},petCard:{marginBottom:16,transform:[{scale:"web"===n.default.OS&&Xo<=800&&Xo>600?1.15:1}]},petCardContent:{flexDirection:"row",alignItems:"center"},petImage:{width:80,height:80,borderRadius:40,marginRight:16},petImagePlaceholder:{width:80,height:80,borderRadius:40,marginRight:16,borderWidth:2,borderColor:f.theme.colors.primary,justifyContent:"center",alignItems:"center"},petInfo:{flex:1},addButton:{marginTop:5,alignSelf:"center"},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center"}}),ta=({navigation:e})=>{const[t,o]=(0,a.useState)([]),[i,l]=(0,a.useState)(!0),{screenWidth:d}=(0,a.useContext)(p.AuthContext);(0,a.useEffect)((()=>{c()}),[]);const c=async()=>{l(!0);try{await new Promise((e=>setTimeout(e,1e3)));o([{id:"1",name:"Max",animal_type:"Dog",breed:"border collie",age:{months:0,years:5},weight:32,sex:"Male",friendlyWithChildren:!0,friendlyWithCats:!1,friendlyWithDogs:!0,spayedNeutered:!0,houseTrained:!0,microchipped:!0,adoptionDate:"2020-01-15",description:"Loves to play fetch and go for walks.",energyLevel:"High",feedingSchedule:"Morning",leftAlone:"1-4 hours",medication:null,additionalInstructions:"Needs daily exercise.",vetName:"Dr. Smith",vetAddress:"123 Vet St.",vetPhone:"555-1234",insuranceProvider:"Pet Insurance Co.",vetDocuments:[],galleryImages:[]},{id:"2",name:"Whiskers",animal_type:"Cat",breed:"tammy ammy",age:{months:3,years:4},weight:16,sex:"Female",friendlyWithChildren:!0,friendlyWithCats:!0,friendlyWithDogs:!1,spayedNeutered:!0,houseTrained:!0,microchipped:!1,adoptionDate:"2019-05-20",description:"Enjoys lounging in the sun.",energyLevel:"Low",feedingSchedule:"Twice a day",leftAlone:"4-8 hours",medication:null,additionalInstructions:"Prefers quiet environments.",vetName:"Dr. Jones",vetAddress:"456 Vet Ave.",vetPhone:"555-5678",insuranceProvider:"Pet Health Insurance",vetDocuments:[],galleryImages:[]},{id:"3",name:"Buddy",animal_type:"Lizard",breed:"leopard gecko",age:{months:0,years:2},weight:1,sex:"Male",friendlyWithChildren:!1,friendlyWithCats:!1,friendlyWithDogs:!1,spayedNeutered:!1,houseTrained:!1,microchipped:!1,adoptionDate:"2021-08-10",description:"A calm and quiet pet.",energyLevel:"Low",feedingSchedule:["Custom","3 times a day with liquid food."],leftAlone:"Can be left alone indefinitely",medication:null,additionalInstructions:"Keep in a warm environment.",vetName:"Dr. Green",vetAddress:"789 Vet Blvd.",vetPhone:"555-9012",insuranceProvider:"Reptile Insurance Co.",vetDocuments:[],galleryImages:[]}])}catch(e){console.error("Error fetching pets:",e)}finally{l(!1)}},u=({pet:t})=>(0,T.jsx)(s.default,{onPress:()=>{"web"===n.default.OS?(sessionStorage.setItem("editPetData",JSON.stringify(t)),e.navigate("AddPet"),window.history.replaceState({},"","/AddPet")):e.navigate("AddPet",{pet:t})},children:(0,T.jsx)(Ko.default,{style:ea.petCard,children:(0,T.jsxs)(Ko.default.Content,{style:ea.petCardContent,children:[t.image?(0,T.jsx)(U.default,{source:{uri:t.image},style:ea.petImage}):(0,T.jsx)(r.default,{style:ea.petImagePlaceholder,children:(0,T.jsx)(S.default,{name:m(t.animal_type?t.animal_type:"paw"),size:40,color:f.theme.colors.primary})}),(0,T.jsxs)(r.default,{style:ea.petInfo,children:[(0,T.jsx)(Qo.default,{children:t.name}),(0,T.jsx)(De.default,{children:t.animal_type?t.animal_type:"paw"}),(0,T.jsxs)(De.default,{children:[t.age.years," years ",t.age.months," months old"]})]})]})})}),m=e=>{switch(e.toLowerCase()){case"dog":return"dog";case"cat":return"cat";case"rabbit":return"rabbit";case"reptile":case"lizard":case"snake":return"snake";case"turtle":return"turtle";case"bird":case"parrot":return"bird";case"horse":return"horse";case"fish":return"fish";default:return"paw"}},g=()=>i?(0,T.jsx)(r.default,{style:ea.loadingContainer,children:(0,T.jsx)(A.default,{size:"large",color:f.theme.colors.primary})}):(0,T.jsx)(H.default,{contentContainerStyle:[ea.scrollContent,"web"===n.default.OS&&{alignItems:"center"},{marginBottom:15}],children:(0,T.jsxs)(r.default,{style:[ea.contentWrapper,{width:d<=600?"90%":d<=800?"60%":"30%"}],children:[t.map((e=>(0,T.jsx)(u,{pet:e},e.id))),(0,T.jsx)(_e.default,{mode:"contained",onPress:()=>e.navigate("AddPet",{pet:{}}),style:ea.addButton,icon:({size:e,color:t})=>(0,T.jsx)(S.default,{name:"plus",size:e,color:t}),children:"Add Pet"})]})});return"ios"===n.default.OS?(0,T.jsxs)(Se.default,{style:ea.container,children:[(0,T.jsx)(bt,{title:"My Pets",onBackPress:()=>(0,h.handleBack)(e)}),(0,T.jsx)(g,{})]}):"android"===n.default.OS?(0,T.jsxs)(r.default,{style:[ea.container,{paddingTop:Te.default.currentHeight}],children:[(0,T.jsx)(bt,{title:"My Pets",onBackPress:()=>(0,h.handleBack)(e)}),(0,T.jsx)(g,{})]}):(0,T.jsxs)(r.default,{style:ea.container,children:[(0,T.jsx)(bt,{title:"My Pets",onBackPress:()=>(0,h.handleBack)(e)}),(0,T.jsx)(g,{})]})},oa=l.default.create({container:{flex:1,backgroundColor:f.theme.colors.background},androidContainer:{paddingTop:Te.default.currentHeight},scrollView:{flex:1},scrollViewContent:{padding:16,paddingBottom:"web"===n.default.OS?16:90},card:{marginBottom:16,maxWidth:600,alignSelf:"center",width:"100%"},messageButtonContainer:{maxWidth:600,alignSelf:"center",width:"100%",marginTop:16},messageButton:{width:"100%"}}),aa=({route:e,navigation:t})=>{const{ownerId:o}=e.params,{colors:a}=(0,G.useTheme)(),i={id:o,name:"John Doe",email:"john.doe@example.com",phone:"(123) 456-7890",contracts:[{id:"1",date:"2023-05-01",status:"Completed"},{id:"2",date:"2023-04-15",status:"Pending"}],invoices:[{id:"1",date:"2023-05-02",amount:"$100",status:"Paid"},{id:"2",date:"2023-04-16",amount:"$75",status:"Unpaid"}],upcomingBookings:[{id:"1",date:"2023-06-01",service:"Dog Walking"},{id:"2",date:"2023-06-15",service:"Cat Sitting"}]},s=()=>(0,T.jsxs)(H.default,{style:oa.scrollView,contentContainerStyle:oa.scrollViewContent,children:[(0,T.jsx)(Ko.default,{style:oa.card,children:(0,T.jsxs)(Ko.default.Content,{children:[(0,T.jsx)(Qo.default,{children:i.name}),(0,T.jsxs)(De.default,{children:["Email: ",i.email]}),(0,T.jsxs)(De.default,{children:["Phone: ",i.phone]})]})}),(0,T.jsx)(Ko.default,{style:oa.card,children:(0,T.jsxs)(Ko.default.Content,{children:[(0,T.jsx)(Qo.default,{children:"Upcoming Bookings"}),i.upcomingBookings.map((e=>(0,T.jsx)(bo.default,{title:"Booking ".concat(e.id),description:"Date: ".concat(e.date," - Service: ").concat(e.service),left:e=>(0,T.jsx)(oo.default,Object.assign({},e,{icon:"calendar"}))},e.id)))]})}),(0,T.jsxs)(Ko.default,{style:oa.card,children:[(0,T.jsxs)(Ko.default.Content,{children:[(0,T.jsx)(Qo.default,{children:"Contracts"}),i.contracts.map((e=>(0,T.jsx)(bo.default,{title:"Contract ".concat(e.id),description:"Date: ".concat(e.date," - Status: ").concat(e.status),left:e=>(0,T.jsx)(oo.default,Object.assign({},e,{icon:"file-document-outline"}))},e.id)))]}),(0,T.jsx)(Ko.default.Actions,{children:(0,T.jsx)(_e.default,{onPress:()=>(0,h.navigateToFrom)(t,"Contracts","OwnerHistory",{ownerId:o}),children:"View All Contracts"})})]}),(0,T.jsxs)(Ko.default,{style:oa.card,children:[(0,T.jsxs)(Ko.default.Content,{children:[(0,T.jsx)(Qo.default,{children:"Invoices"}),i.invoices.map((e=>(0,T.jsx)(bo.default,{title:"Invoice ".concat(e.id),description:"Date: ".concat(e.date," - Amount: ").concat(e.amount," - Status: ").concat(e.status),left:e=>(0,T.jsx)(oo.default,Object.assign({},e,{icon:"file-document-outline"}))},e.id)))]}),(0,T.jsx)(Ko.default.Actions,{children:(0,T.jsx)(_e.default,{onPress:()=>(0,h.navigateToFrom)(t,"Invoices","OwnerHistory",{ownerId:o}),children:"View All Invoices"})})]}),(0,T.jsx)(r.default,{style:oa.messageButtonContainer,children:(0,T.jsx)(_e.default,{mode:"contained",onPress:()=>(0,h.navigateToFrom)(t,"MessageHistory","OwnerHistory",{ownerId:o}),style:oa.messageButton,children:"View Messages"})})]});return"ios"===n.default.OS?(0,T.jsx)(Se.default,{style:oa.container,children:(0,T.jsx)(s,{})}):"android"===n.default.OS?(0,T.jsx)(r.default,{style:[oa.container,oa.androidContainer],children:(0,T.jsx)(s,{})}):(0,T.jsx)(r.default,{style:oa.container,children:(0,T.jsx)(s,{})})};var na=o(35708);const ra=l.default.create({container:{position:"relative"},dateTimeContainer:{flexDirection:"row",alignItems:"center",backgroundColor:f.theme.colors.background,borderRadius:8,borderWidth:1,borderColor:f.theme.colors.border,paddingHorizontal:12,height:40,width:"100%",justifyContent:"space-between"},dateInputGroup:{flexDirection:"row",alignItems:"center",justifyContent:"center",paddingHorizontal:4},timeInputGroup:{flexDirection:"row",alignItems:"center",justifyContent:"center",paddingHorizontal:4},numberInput:{fontSize:f.theme.fontSizes.medium,color:f.theme.colors.text,width:24,textAlign:"center",padding:0},yearInput:{fontSize:f.theme.fontSizes.medium,color:f.theme.colors.text,width:42,textAlign:"center",padding:0},separator:{fontSize:f.theme.fontSizes.medium,color:f.theme.colors.text,marginHorizontal:2},divider:{fontSize:f.theme.fontSizes.medium,color:f.theme.colors.border,marginHorizontal:8},periodButton:{backgroundColor:f.theme.colors.surface,borderRadius:4,paddingHorizontal:8,paddingVertical:4,marginLeft:8},periodText:{fontSize:f.theme.fontSizes.medium,color:f.theme.colors.text,fontWeight:"500"},errorBorder:{borderColor:f.theme.colors.error},errorText:{color:f.theme.colors.error,fontSize:f.theme.fontSizes.small,marginTop:4},disabled:{backgroundColor:f.theme.colors.disabled,opacity:.7},icon:{marginLeft:8},pickerContainer:{position:"absolute",top:"100%",left:0,right:0,zIndex:1e3},calendar:{backgroundColor:f.theme.colors.surface,borderRadius:8,borderWidth:1,borderColor:f.theme.colors.border,marginTop:4,padding:12,elevation:5,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:3.84},calendarHeader:{alignItems:"center",marginBottom:12},calendarHeaderText:{fontSize:f.theme.fontSizes.medium,fontWeight:"500"},calendarWeekDays:{flexDirection:"row",justifyContent:"space-around",marginBottom:8},calendarWeekDay:{width:36,textAlign:"center",fontSize:f.theme.fontSizes.small,color:f.theme.colors.placeholder},calendarWeek:{flexDirection:"row",justifyContent:"space-around",marginBottom:4},calendarDay:{width:36,height:36,justifyContent:"center",alignItems:"center",borderRadius:18},calendarDayText:{fontSize:f.theme.fontSizes.medium},selectedDay:{backgroundColor:f.theme.colors.primary},selectedDayText:{color:f.theme.colors.surface},timeSelector:{flexDirection:"row",backgroundColor:f.theme.colors.surface,borderRadius:8,borderWidth:1,borderColor:f.theme.colors.border,marginTop:4,padding:12,gap:12,elevation:5,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:3.84},timeSelectorColumn:{flex:1,alignItems:"center"},timeSelectorLabel:{fontSize:f.theme.fontSizes.small,color:f.theme.colors.placeholder,marginBottom:8},timeSelectorScroll:{height:200,width:"100%"},timeSelectorItem:{padding:12,alignItems:"center",borderRadius:4,width:"100%"},timeSelectorText:{fontSize:f.theme.fontSizes.medium},selectedTime:{backgroundColor:f.theme.colors.primary},selectedTimeText:{color:f.theme.colors.surface},periodContainer:{width:"100%"},disabledDay:{opacity:.3}}),ia=({value:e,onChange:t,error:o,disabled:n=!1,containerStyle:s,isMilitary:l=!0,onPickerStateChange:d})=>{const{is_DEBUG:c,screenWidth:u}=(0,a.useContext)(p.AuthContext),[m,g]=(0,a.useState)({month:"",day:"",year:"",hours:"",minutes:"",period:l?null:"AM"}),[h,y]=(0,a.useState)(!1),[b,x]=(0,a.useState)(!1),j=(0,a.useRef)(null),w=(0,a.useRef)(new C.default.Value(0)).current;(0,a.useEffect)((()=>{var e;e=h||b,C.default.timing(w,{toValue:e?1:0,duration:200,useNativeDriver:!0}).start()}),[h,b]),(0,a.useEffect)((()=>{if(e instanceof Date&&!isNaN(e)){c&&console.log("MBA1234 Received date value:",e.toISOString());const t=e.getHours(),o=t%12||12,a=l?null:t>=12?"PM":"AM";c&&console.log("MBA1234 Time format detection:",{hours24:t,hours12:o,period:a,isMilitary:l}),g({month:String(e.getMonth()+1).padStart(2,"0"),day:String(e.getDate()).padStart(2,"0"),year:String(e.getFullYear()),hours:l?String(t).padStart(2,"0"):String(o).padStart(2,"0"),minutes:String(e.getMinutes()).padStart(2,"0"),period:a})}}),[e,l]),(0,a.useEffect)((()=>{c&&console.log("MBA5678 DateTimePicker picker states:",{showCalendar:h,showTimeSelector:b,isPickerActive:h||b}),d?.(h||b)}),[h,b]),(0,a.useEffect)((()=>{const e=e=>{j.current&&!j.current.contains(e.target)&&(c&&console.log("MBA5678 Click outside - closing pickers"),y(!1),x(!1))};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)}),[]);const v=(e,t,o)=>{const a=e.replace(/[^0-9]/g,"");if(c&&console.log("MBA1234 Formatting input:",{field:t,input:e,numbers:a,currentValue:o}),0===a.length)return"00";if(1===a.length)return"0".concat(a);if(a.length>=2){const e=parseInt(a[0],10),n=parseInt(a[1],10);if("month"===t)return e>1||1===e&&n>2?"12":"".concat(e).concat(n);if("day"===t)return e>3||3===e&&n>1?"31":"".concat(e).concat(n);if("hours"===t){if(o.period){if(e>1||1===e&&n>2)return"12"}else if(e>2||2===e&&n>3)return"23";return"".concat(e).concat(n)}if("minutes"===t)return e>5?"59":"".concat(e).concat(n)}return a.slice(0,2)},B=(e,t)=>{let o=t;switch(c&&console.log("MBA1234 Input change:",{field:e,value:t,currentInputs:m}),e){case"month":o=v(t,"month",m);break;case"day":o=v(t,"day",m);break;case"year":o=(e=>{const t=e.replace(/[^0-9]/g,"");return 0===t.length?"0000":t.padStart(4,"0").slice(0,4)})(t);break;case"hours":o=v(t,"hours",m);break;case"minutes":o=v(t,"minutes",m);break;case"period":o=t}c&&console.log("MBA1234 Formatted value:",{field:e,formattedValue:o});const a=Object.assign({},m,{[e]:o});g(a),a.month&&a.day&&a.year&&a.hours&&a.minutes&&k(a)},k=e=>{try{let o=parseInt(e.hours,10);e.period&&("PM"===e.period&&12!==o?o+=12:"AM"===e.period&&12===o&&(o=0));const a=new Date(parseInt(e.year,10),parseInt(e.month,10)-1,parseInt(e.day,10),o,parseInt(e.minutes,10));c&&console.log("MBA1234 Created new date:",{inputs:e,newDate:a.toISOString()}),isNaN(a.getTime())||t(a)}catch(o){c&&console.error("MBA1234 Error creating date:",o)}};return c&&console.log("MBA1234 Current state:",{inputs:m,isMilitary:l}),(0,T.jsxs)(r.default,{style:[ra.container,s],ref:j,children:[(0,T.jsxs)(r.default,{style:[ra.dateTimeContainer,o&&ra.errorBorder,n&&ra.disabled],children:[(0,T.jsxs)(na.default,{style:ra.dateInputGroup,onPress:()=>!n&&(c&&console.log("MBA5678 Date press - toggling calendar"),y((e=>!e)),void x(!1)),children:[(0,T.jsx)(q.default,{style:ra.numberInput,value:m.month,maxLength:2,keyboardType:"number-pad",onChangeText:e=>B("month",e),placeholder:"MM",editable:!n}),(0,T.jsx)(i.default,{style:ra.separator,children:"/"}),(0,T.jsx)(q.default,{style:ra.numberInput,value:m.day,maxLength:2,keyboardType:"number-pad",onChangeText:e=>B("day",e),placeholder:"DD",editable:!n}),(0,T.jsx)(i.default,{style:ra.separator,children:"/"}),(0,T.jsx)(q.default,{style:ra.yearInput,value:m.year,maxLength:4,keyboardType:"number-pad",onChangeText:e=>B("year",e),placeholder:"YYYY",editable:!n}),u>410&&(0,T.jsx)(S.default,{name:"calendar",size:20,color:f.theme.colors.text,style:ra.icon})]}),(0,T.jsx)(i.default,{style:ra.divider,children:"|"}),(0,T.jsxs)(na.default,{style:ra.timeInputGroup,onPress:()=>!n&&(c&&console.log("MBA5678 Time press - toggling time selector"),x((e=>!e)),void y(!1)),children:[(0,T.jsx)(q.default,{style:ra.numberInput,value:m.hours,maxLength:2,keyboardType:"number-pad",onChangeText:e=>B("hours",e),placeholder:"HH",editable:!n}),(0,T.jsx)(i.default,{style:ra.separator,children:":"}),(0,T.jsx)(q.default,{style:ra.numberInput,value:m.minutes,maxLength:2,keyboardType:"number-pad",onChangeText:e=>B("minutes",e),placeholder:"MM",editable:!n}),!l&&(0,T.jsx)(na.default,{style:ra.periodButton,onPress:()=>!n&&B("period",m.period),disabled:n,children:(0,T.jsx)(i.default,{style:ra.periodText,children:m.period})}),u>410&&(0,T.jsx)(S.default,{name:"clock-outline",size:20,color:f.theme.colors.text,style:ra.icon})]})]}),(0,T.jsxs)(C.default.View,{style:[ra.pickerContainer,{opacity:w},{display:h||b?"flex":"none"}],children:[h&&!n&&(0,T.jsxs)(r.default,{style:ra.calendar,children:[(0,T.jsx)(r.default,{style:ra.calendarHeader,children:(0,T.jsxs)(i.default,{style:ra.calendarHeaderText,children:[e.toLocaleString("default",{month:"long"})," ",e.getFullYear()]})}),(0,T.jsx)(r.default,{style:ra.calendarWeekDays,children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map((e=>(0,T.jsx)(i.default,{style:ra.calendarWeekDay,children:e},e)))}),Array.from({length:6}).map(((t,o)=>(0,T.jsx)(r.default,{style:ra.calendarWeek,children:Array.from({length:7}).map(((t,a)=>{const n=7*o+a-e.getDay()+1,r=n>0&&n<=new Date(e.getFullYear(),e.getMonth()+1,0).getDate(),s=parseInt(m.day)===n;return(0,T.jsx)(na.default,{style:[ra.calendarDay,s&&ra.selectedDay,!r&&ra.disabledDay],onPress:()=>r&&(B("day",String(n)),void y(!1)),children:r&&(0,T.jsx)(i.default,{style:[ra.calendarDayText,s&&ra.selectedDayText],children:n})},"day-".concat(a))}))},"week-".concat(o))))]}),b&&!n&&(0,T.jsxs)(r.default,{style:ra.timeSelector,children:[(0,T.jsxs)(r.default,{style:ra.timeSelectorColumn,children:[(0,T.jsx)(i.default,{style:ra.timeSelectorLabel,children:"Hour"}),(0,T.jsx)(H.default,{style:ra.timeSelectorScroll,children:Array.from({length:l?24:12},((e,t)=>(0,T.jsx)(na.default,{style:[ra.timeSelectorItem,parseInt(m.hours)===(l?t:t+1)&&ra.selectedTime],onPress:()=>{B("hours",String(l?t:t+1).padStart(2,"0"))},children:(0,T.jsx)(i.default,{style:[ra.timeSelectorText,parseInt(m.hours)===(l?t:t+1)&&ra.selectedTimeText],children:String(l?t:t+1).padStart(2,"0")})},t)))})]}),(0,T.jsxs)(r.default,{style:ra.timeSelectorColumn,children:[(0,T.jsx)(i.default,{style:ra.timeSelectorLabel,children:"Minute"}),(0,T.jsx)(H.default,{style:ra.timeSelectorScroll,children:Array.from({length:60},((e,t)=>(0,T.jsx)(na.default,{style:[ra.timeSelectorItem,parseInt(m.minutes)===t&&ra.selectedTime],onPress:()=>B("minutes",String(t).padStart(2,"0")),children:(0,T.jsx)(i.default,{style:[ra.timeSelectorText,parseInt(m.minutes)===t&&ra.selectedTimeText],children:String(t).padStart(2,"0")})},t)))})]}),!l&&(0,T.jsxs)(r.default,{style:ra.timeSelectorColumn,children:[(0,T.jsx)(i.default,{style:ra.timeSelectorLabel,children:"Period"}),(0,T.jsxs)(r.default,{style:ra.periodContainer,children:[(0,T.jsx)(na.default,{style:[ra.timeSelectorItem,"AM"===m.period&&ra.selectedTime],onPress:()=>B("period","AM"),children:(0,T.jsx)(i.default,{style:[ra.timeSelectorText,"AM"===m.period&&ra.selectedTimeText],children:"AM"})}),(0,T.jsx)(na.default,{style:[ra.timeSelectorItem,"PM"===m.period&&ra.selectedTime],onPress:()=>B("period","PM"),children:(0,T.jsx)(i.default,{style:[ra.timeSelectorText,"PM"===m.period&&ra.selectedTimeText],children:"PM"})})]})]})]})]}),o&&(0,T.jsx)(i.default,{style:ra.errorText,children:o})]})},sa=(e,t,o,a)=>{const[n,r]=o.split(":").map(Number),[i,s]=a.split(":").map(Number),l=new Date(e);let d;return l.setHours(n,r,0),t?(d=new Date(t),d.setHours(i,s,0)):(d=new Date(e),d.setHours(i,s,0)),d<l?{isValid:!1,error:"End date/time cannot be before start date/time"}:{isValid:!0,error:null}};var la=o(62914);const da=(e,t=0)=>{console.log("MBA93652 Starting cost calculation with data:",{occurrenceData:e,numPets:t});const{start_date:o,end_date:a,start_time:n,end_time:r,rates:{base_rate:i,additional_animal_rate:s,applies_after:l,holiday_rate:d,unit_of_time:c,additional_rates:u=[]}}=e,m=((e,t,o,a,n)=>{const[r,i,s]=e.split("-").map(Number),[l,d]=o.split(":").map(Number),[c,u,m]=t.split("-").map(Number),[g,h]=a.split(":").map(Number);console.log("MBA12348785 ========= Starting calculateProratedMultiplier ========="),console.log("MBA12348785 Input parameters:",{startDate:e,endDate:t,startTime:o,endTime:a,timeUnit:n}),console.log("MBA12348785 Parsed components:",{start:{year:r,month:i,day:s,hour:l,minute:d},end:{year:c,month:u,day:m,hour:g,minute:h}});const f=new Date(Date.UTC(r,i-1,s)),p=new Date(Date.UTC(c,u-1,m)),y=Math.floor((p-f)/864e5),b=24*y;console.log("MBA12348785 Date difference calculation:",{startDateOnly:f.toISOString(),endDateOnly:p.toISOString(),daysDiff:y,daysDiffHours:b});const x=60*l+d,j=60*g+h,w=(j-x)/60;console.log("MBA12348785 Time difference calculation:",{startTimeMinutes:x,endTimeMinutes:j,timeDiffHours:w});const C=b+w;let v;switch(console.log("MBA12348785 Total duration:",{daysDiffHours:b,timeDiffHours:w,totalHours:C}),n){case"15 Min":v=C/.25;break;case"30 Min":v=C/.5;break;case"45 Min":v=C/.75;break;case"1 Hour":v=C/1;break;case"2 Hour":v=C/2;break;case"3 Hour":v=C/3;break;case"4 Hour":v=C/4;break;case"5 Hour":v=C/5;break;case"6 Hour":v=C/6;break;case"7 Hour":v=C/7;break;case"8 Hour":v=C/8;break;case"24 Hour":case"Per Day":v=C/24;break;case"Week":v=C/168;break;default:v=1}return console.log("MBA12348785 Final calculation:",{timeUnit:n,totalHours:C,divisor:"Per Visit"===n?1:"Week"===n?168:parseInt(n)||24,result:v}),console.log("MBA12348785 ========= End calculateProratedMultiplier ========="),v})(o,a,n,r,c);console.log("MBA93652 calculateProratedMultiplier returned:",{numberOfUnits:m,unit_of_time:c,start:"".concat(o," ").concat(n),end:"".concat(a," ").concat(r)});const g=parseFloat(i)*m;console.log("MBA93652 Base cost calculation:",{numberOfUnits:m,baseTotal:g,base_rate:i});let h=0;if(t>parseInt(l)){const e=t-parseInt(l);h=parseFloat(s)*e}console.log("MBA93652 Additional animal cost:",{additionalAnimalRateTotal:h,numPets:t,applies_after:l,additional_animal_rate:s});const f=u.reduce(((e,t)=>e+parseFloat(t.amount||0)),0);console.log("MBA93652 Additional rates:",{additionalRatesTotal:f,additional_rates:u});const p=g+h+0+f;return console.log("MBA93652 Final calculation:",{baseTotal:g,additionalAnimalRateTotal:h,holidayRateTotal:0,additionalRatesTotal:f,totalCost:p}),{base_total:g,multiplier:m,additional_animal_rate_total:h,holiday_rate_total:0,additional_rates_total:f,total_cost:p}},ca=["1","2","3","4","5"],ua=l.default.create({modalContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0, 0, 0, 0.5)"},modalContent:{backgroundColor:f.theme.colors.background,borderRadius:8,padding:20,width:"95%",maxWidth:500},modalHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:20},modalTitle:{fontSize:f.theme.fontSizes.largeLarge,fontWeight:"bold",fontFamily:f.theme.fonts.header.fontFamily},section:{position:"relative",marginBottom:16},label:{fontSize:f.theme.fontSizes.medium,color:f.theme.colors.text,marginBottom:2,fontFamily:f.theme.fonts.header.fontFamily},inputContainer:{position:"relative",zIndex:200,marginBottom:16},dollarSign:{fontSize:f.theme.fontSizes.medium,color:f.theme.colors.text,marginRight:4,fontFamily:f.theme.fonts.regular.fontFamily},input:{borderWidth:1,borderColor:f.theme.colors.border,borderRadius:8,padding:8,backgroundColor:f.theme.colors.background},buttonContainer:{flexDirection:"row",justifyContent:"space-between",gap:10,marginTop:16},button:{flex:1,paddingVertical:6},rateSection:{},rateContainer:{flexDirection:"row",alignItems:"flex-end",justifyContent:"space-between",gap:12},baseRateInput:{flex:1},timeUnitInput:{flex:1,marginTop:-32},picker:{backgroundColor:f.theme.colors.surface,borderRadius:8,height:39,borderWidth:1,borderColor:f.theme.colors.border,fontFamily:f.theme.fonts.regular.fontFamily},totalSection:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginTop:20,paddingTop:20,borderTopWidth:1,borderTopColor:f.theme.colors.border},totalLabel:{fontSize:f.theme.fontSizes.medium,fontWeight:"bold",fontFamily:f.theme.fonts.regular.fontFamily},totalAmount:{fontSize:f.theme.fontSizes.mediumLarge,fontWeight:"bold",color:f.theme.colors.primary,fontFamily:f.theme.fonts.regular.fontFamily},errorText:{color:f.theme.colors.error,fontSize:f.theme.fontSizes.small,marginTop:8,marginBottom:8,fontFamily:f.theme.fonts.regular.fontFamily},rateRow:{flexDirection:"row",alignItems:"center",gap:10,marginBottom:10,width:"100%",flexWrap:"nowrap"},rateInput:{flex:2,borderWidth:1,borderColor:f.theme.colors.border,borderRadius:8,height:39,padding:12,fontFamily:f.theme.fonts.regular.fontFamily,minWidth:0},rateAmountContainer:{flex:1,minWidth:0},rateAmountInput:{borderWidth:1,borderColor:f.theme.colors.border,borderRadius:8,height:39,padding:12,fontFamily:f.theme.fonts.regular.fontFamily,width:"100%"},addRateButton:{padding:10,borderWidth:1,borderColor:f.theme.colors.border,borderRadius:8,alignItems:"center"},addRateButtonText:{color:f.theme.colors.primary,fontSize:f.theme.fontSizes.medium,fontFamily:f.theme.fonts.regular.fontFamily},rateLabelContainer:{flexDirection:"row",marginTop:10,marginBottom:5},rateTitleLabel:{flex:2,fontSize:f.theme.fontSizes.medium,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily},rateAmountLabel:{flex:1,fontSize:f.theme.fontSizes.medium,color:f.theme.colors.text,marginLeft:10,fontFamily:f.theme.fonts.regular.fontFamily},scrollView:{flex:1},scrollViewContent:{flexGrow:1},errorMessage:{color:f.theme.colors.error,fontSize:14,textAlign:"center",fontFamily:f.theme.fonts.regular.fontFamily,marginTop:8},loadingContainer:{minWidth:80,alignItems:"center",justifyContent:"center"}}),ma=({visible:e,onClose:t,onAdd:o,defaultRates:n,hideRates:l=!1,initialOccurrence:d=null,isEditing:c=!1,modalTitle:u="Add New Occurrence",isFromRequestBooking:m=!1,booking:g})=>{const{is_DEBUG:h,screenWidth:y,timeSettings:b}=(0,a.useContext)(p.AuthContext),[x,j]=(0,a.useState)(!1),[w,v]=(0,a.useState)(!1),B=(0,a.useRef)(new C.default.Value(0)).current,[k,I]=(0,a.useState)(null),M=(0,a.useRef)(null),[R,P]=(0,a.useState)(!1),z=e=>{if(h&&(console.log("MBA1234 Parsing initial occurrence:",e),console.log("MBA1234 Time settings:",b)),!e){const e=new Date,t=new Date(e.getTime()+36e5);return{startDateTime:e,endDateTime:t,isMilitary:b.use_military_time}}try{const{startDate:t,startTime:o,endDate:a,endTime:n}=e,r=b.use_military_time;let i,s;return h&&console.log("MBA1234 Time format detection:",{startTime:o,endTime:n,isMilitary:r,timeSettings:b}),r?(i=(0,Bo.parse)("".concat(t," ").concat(o),"yyyy-MM-dd HH:mm",new Date),s=(0,Bo.parse)("".concat(a," ").concat(n),"yyyy-MM-dd HH:mm",new Date)):(i=(0,Bo.parse)("".concat(t," ").concat(o),"yyyy-MM-dd hh:mm aa",new Date),s=(0,Bo.parse)("".concat(a," ").concat(n),"yyyy-MM-dd hh:mm aa",new Date)),h&&console.log("MBA1234 Parsed dates:",{startDateTime:i.toISOString(),endDateTime:s.toISOString(),isMilitary:r}),{startDateTime:i,endDateTime:s,isMilitary:r}}catch(t){console.error("MBA1234 Error parsing dates:",t);const e=new Date,o=new Date(e.getTime()+36e5);return{startDateTime:e,endDateTime:o,isMilitary:b.use_military_time}}},F=z(d);h&&console.log("MBA565656 AddOccurrenceModal initializing with:",{defaultRates:n,initialOccurrence:d,initialDates:F});const[L,O]=(0,a.useState)((()=>{const e={startDateTime:F.startDateTime,endDateTime:F.endDateTime,isMilitary:b.use_military_time,rates:{baseRate:"0",additionalAnimalRate:"0",appliesAfterAnimals:"1",holidayRate:"0",unit_of_time:"Per Visit",additionalRates:[]},calculatedCost:"0"};return d?.rates?(e.rates=d.rates,e.calculatedCost=d.calculatedCost||"0"):n&&(e.rates={baseRate:n.base_rate?.toString()||"0",additionalAnimalRate:n.additional_animal_rate?.toString()||"0",appliesAfterAnimals:n.applies_after?.toString()||"1",holidayRate:n.holiday_rate?.toString()||"0",unit_of_time:n.unit_of_time||"Per Visit",additionalRates:n.additional_rates?.map((e=>({name:e.title,description:e.description||"",amount:e.amount})))||[]},e.calculatedCost=n.calculated_cost?.toString()||"0"),h&&console.log("MBA565656 Initial state calculated:",e),e})),[E,W]=(0,a.useState)(d?.rates?.unit_of_time||n?.unit_of_time||"Per Visit");(0,a.useEffect)((()=>{e&&(I(null),M.current={baseRate:L.rates.baseRate,additionalAnimalRate:L.rates.additionalAnimalRate,holidayRate:L.rates.holidayRate,unit_of_time:L.rates.unit_of_time,additionalRates:[...L.rates.additionalRates],startDateTime:new Date(L.startDateTime),endDateTime:new Date(L.endDateTime)},h&&console.log("MBA565656 Setting initial values:",M.current))}),[e]);const N=e=>{v(e),h&&console.log("MBA5678 Picker state changed:",{isActive:e,isFromRequestBooking:m,currentModalHeight:e&&m?"65vh":"80%"}),C.default.timing(B,{toValue:e&&m?1:0,duration:300,useNativeDriver:!1}).start()};(0,a.useEffect)((()=>{h&&console.log("MBA5678 Modal state:",{isFromRequestBooking:m,isAnyPickerActive:w,visible:e})}),[m,w,e]),(0,a.useEffect)((()=>{if(!d&&n){h&&console.log("MBA565656 Updating rates from defaultRates:",{defaultRates:n,currentRates:L.rates});const e={baseRate:n.base_rate?.toString()||"0",additionalAnimalRate:n.additional_animal_rate?.toString()||"0",appliesAfterAnimals:n.applies_after?.toString()||"1",holidayRate:n.holiday_rate?.toString()||"0",unit_of_time:n.unit_of_time||"Per Visit",additionalRates:n.additional_rates?.map((e=>({name:e.title,description:e.description||"",amount:e.amount})))||[]};h&&(console.log("MBA565656 Setting new rates:",e),console.log("MBA565656 Setting calculated cost:",n.calculated_cost)),O((t=>{const o=Object.assign({},t,{rates:e,calculatedCost:n.calculated_cost?.toString()||"0"});return h&&console.log("MBA565656 Updated occurrence state:",o),o})),W(n.unit_of_time||"Per Visit")}}),[n,d]);const U=(0,a.useCallback)((0,la.debounce)((e=>{if(g?.booking_id)try{P(!0);const t=da(e,g.pets?.length||0);h&&console.log("MBA565656 Cost calculation result:",t),O((e=>Object.assign({},e,{calculatedCost:t.total_cost.toFixed(2)})))}catch(t){h&&console.error("MBA565656 Error calculating costs:",t)}finally{P(!1)}}),500),[g?.booking_id,g?.pets?.length]);(0,a.useEffect)((()=>{if(e&&M.current&&g?.booking_id){h&&console.log("MBA565656 Checking for changes:",{current:{rates:L.rates,startDateTime:L.startDateTime.toISOString(),endDateTime:L.endDateTime.toISOString()},initial:{rates:M.current,startDateTime:M.current.startDateTime.toISOString(),endDateTime:M.current.endDateTime.toISOString()}});const e={start:Math.abs(L.startDateTime.getTime()-M.current.startDateTime.getTime()),end:Math.abs(L.endDateTime.getTime()-M.current.endDateTime.getTime())},t={baseRate:L.rates.baseRate!==M.current.baseRate,additionalAnimalRate:L.rates.additionalAnimalRate!==M.current.additionalAnimalRate,holidayRate:L.rates.holidayRate!==M.current.holidayRate,unit_of_time:L.rates.unit_of_time!==M.current.unit_of_time,additionalRatesLength:L.rates.additionalRates.length!==M.current.additionalRates.length},o=t.baseRate||t.additionalAnimalRate||t.holidayRate||t.unit_of_time||t.additionalRatesLength||e.start>=1e3||e.end>=1e3;if(h&&console.log("MBA565656 Change detection details:",{timeDiffs:e,rateChanges:t,hasChanges:o}),o){h&&console.log("MBA565656 Changes detected, calculating costs:",{current:{rates:L.rates,startDateTime:L.startDateTime.toISOString(),endDateTime:L.endDateTime.toISOString()},initial:{rates:M.current,startDateTime:M.current.startDateTime.toISOString(),endDateTime:M.current.endDateTime.toISOString()},timeDiffs:e,rateChanges:t});const o={start_date:(0,ko.format)(L.startDateTime,"yyyy-MM-dd"),end_date:(0,ko.format)(L.endDateTime,"yyyy-MM-dd"),start_time:(0,ko.format)(L.startDateTime,"HH:mm"),end_time:(0,ko.format)(L.endDateTime,"HH:mm"),rates:{base_rate:L.rates.baseRate,additional_animal_rate:L.rates.additionalAnimalRate,applies_after:L.rates.appliesAfterAnimals,holiday_rate:L.rates.holidayRate,unit_of_time:L.rates.unit_of_time,additional_rates:L.rates.additionalRates}};h&&console.log("MBA565656 Calling debouncedCalculateCosts with:",o),U(o)}else h&&console.log("MBA565656 No changes detected, skipping calculation")}else h&&console.log("MBA565656 Skipping cost calculation:",{visible:e,hasInitialValues:!!M.current,hasBookingId:!!g?.booking_id});return()=>{U.cancel()}}),[e,L.startDateTime,L.endDateTime,L.rates.baseRate,L.rates.additionalAnimalRate,L.rates.appliesAfterAnimals,L.rates.holidayRate,L.rates.unit_of_time,L.rates.additionalRates,U,g?.booking_id]),(0,a.useEffect)((()=>{h&&console.log("MBA565656 Rates changed:",L.rates),W(L.rates.unit_of_time)}),[L.rates]),(0,a.useEffect)((()=>{e&&h&&console.log("MBA565656 Modal became visible:",{defaultRates:n,initialOccurrence:d,currentRates:L.rates})}),[e]),(0,a.useEffect)((()=>{h&&console.log("MBA4321 Time settings changed:",b),O((e=>Object.assign({},e,{isMilitary:b.use_military_time})))}),[b]),(0,a.useEffect)((()=>{if(d){h&&(console.log("MBA4321 Initial occurrence rates:",d.rates),console.log("MBA4321 Initial unit_of_time:",d.rates?.unit_of_time));const e=z(d),t=d.rates?.unit_of_time;h&&console.log("MBA4321 Setting unit_of_time to:",t),O((o=>Object.assign({},o,{startDateTime:e.startDateTime,endDateTime:e.endDateTime,isMilitary:e.isMilitary,rates:Object.assign({},d.rates,{unit_of_time:t})}))),W(t)}}),[d]);const[V,Y]=(0,a.useState)(!1),[G,J]=(0,a.useState)({name:"",amount:""});(0,a.useEffect)((()=>{h&&(console.log("MBA1234 Initial occurrence:",d),console.log("MBA1234 Unit of time set to:",E))}),[E,d]),(0,a.useEffect)((()=>{h&&console.log("MBA4321 Unit of time changed:",{newUnitOfTime:E,occurrenceRatesUnitOfTime:L.rates.unit_of_time}),O((e=>Object.assign({},e,{rates:Object.assign({},e.rates,{unit_of_time:E})})))}),[E]);const $=()=>{Z(),t()},Z=()=>{O({startDateTime:new Date,endDateTime:new Date((new Date).setHours((new Date).getHours()+1)),isMilitary:b.use_military_time,rates:{baseRate:n?.base_rate?.toString()||"0",additionalAnimalRate:n?.additional_animal_rate?.toString()||"0",appliesAfterAnimals:n?.applies_after?.toString()||"1",holidayRate:n?.holiday_rate?.toString()||"0",unit_of_time:n?.unit_of_time||"Per Visit",additionalRates:n?.additional_rates?.map((e=>({name:e.title,description:e.description||"",amount:e.amount})))||[]},calculatedCost:"0"}),W(n?.unit_of_time||"Per Visit"),Y(!1),J({name:"",amount:""})};return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(_.default,{visible:e,onRequestClose:$,animationType:"slide",transparent:!0,children:(0,T.jsx)(r.default,{style:ua.modalContainer,children:(0,T.jsxs)(C.default.View,{style:[ua.modalContent,m?{maxHeight:void 0,height:B.interpolate({inputRange:[0,1],outputRange:["325px","650px"]}),transform:[{translateY:B.interpolate({inputRange:[0,1],outputRange:[0,-40]})}]}:{maxHeight:"80%"}],children:[(0,T.jsxs)(r.default,{style:ua.modalHeader,children:[(0,T.jsx)(i.default,{style:ua.modalTitle,children:u}),(0,T.jsx)(s.default,{onPress:$,children:(0,T.jsx)(S.default,{name:"close",size:24,color:f.theme.colors.text})})]}),(0,T.jsxs)(H.default,{style:ua.scrollView,contentContainerStyle:[ua.scrollViewContent,m&&w&&{paddingBottom:300}],children:[(0,T.jsxs)(r.default,{style:[ua.section,{zIndex:10}],children:[(0,T.jsx)(i.default,{style:ua.label,children:"Start Date & Time"}),(0,T.jsx)(ia,{value:L.startDateTime,onChange:e=>{h&&console.log("MBA1234 Start datetime changed:",{newDate:e?.toISOString(),currentInitialValues:M.current,currentOccurrence:{startDateTime:L.startDateTime.toISOString(),endDateTime:L.endDateTime.toISOString()}}),e&&!isNaN(e.getTime())&&O((t=>{const o=Object.assign({},t,{startDateTime:e});return h&&console.log("MBA1234 Updated occurrence:",{startDateTime:o.startDateTime.toISOString(),endDateTime:o.endDateTime.toISOString()}),o}))},error:k?.startDateTime,isMilitary:L.isMilitary,onPickerStateChange:N})]}),(0,T.jsxs)(r.default,{style:[ua.section,{zIndex:9}],children:[(0,T.jsx)(i.default,{style:ua.label,children:"End Date & Time"}),(0,T.jsx)(ia,{value:L.endDateTime,onChange:e=>{h&&console.log("MBA1234 End datetime changed:",{newDate:e?.toISOString(),currentInitialValues:M.current,currentOccurrence:{startDateTime:L.startDateTime.toISOString(),endDateTime:L.endDateTime.toISOString()}}),e&&!isNaN(e.getTime())&&O((t=>{const o=Object.assign({},t,{endDateTime:e});return h&&console.log("MBA1234 Updated occurrence:",{startDateTime:o.startDateTime.toISOString(),endDateTime:o.endDateTime.toISOString()}),o}))},error:k?.endDateTime,isMilitary:L.isMilitary,onPickerStateChange:N})]}),!l&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)(r.default,{style:[ua.section,{zIndex:8}],children:[(0,T.jsx)(i.default,{style:ua.label,children:"Base Rate"}),(0,T.jsxs)(r.default,{style:ua.rateContainer,children:[(0,T.jsx)(r.default,{style:ua.baseRateInput,children:(0,T.jsx)(q.default,{style:ua.input,value:L.rates.baseRate.toString(),onChangeText:e=>O((t=>Object.assign({},t,{rates:Object.assign({},t.rates,{baseRate:e.replace(/[^0-9.]/g,"")})}))),keyboardType:"decimal-pad",placeholder:"0.00"})}),(0,T.jsxs)(r.default,{style:ua.timeUnitInput,children:[(0,T.jsx)(i.default,{style:ua.label,children:"Per"}),(0,T.jsx)(He.default,{selectedValue:E,onValueChange:e=>{h&&console.log("MBA4321 Picker value changed to:",e),W(e),O((t=>Object.assign({},t,{rates:Object.assign({},t.rates,{unit_of_time:e})})))},style:ua.picker,children:(K=ne,K.map((e=>(0,T.jsx)(He.default.Item,{label:e,value:e,style:ua.pickerItem},e))))})]})]})]}),(0,T.jsxs)(r.default,{style:[ua.section,{zIndex:7}],children:[(0,T.jsx)(i.default,{style:ua.label,children:y<375?"+".concat(L.rates.appliesAfterAnimals," Pet Rate"):"Additional Pet Rate"}),(0,T.jsxs)(r.default,{style:ua.rateContainer,children:[(0,T.jsx)(r.default,{style:ua.baseRateInput,children:(0,T.jsx)(q.default,{style:ua.input,value:L.rates.additionalAnimalRate.toString(),onChangeText:e=>O((t=>Object.assign({},t,{rates:Object.assign({},t.rates,{additionalAnimalRate:e.replace(/[^0-9.]/g,"")})}))),keyboardType:"decimal-pad",placeholder:"0.00"})}),(0,T.jsxs)(r.default,{style:ua.timeUnitInput,children:[(0,T.jsx)(i.default,{style:ua.label,children:"Applies After"}),(0,T.jsx)(He.default,{selectedValue:L.rates.appliesAfterAnimals,onValueChange:e=>O((t=>Object.assign({},t,{rates:Object.assign({},t.rates,{appliesAfterAnimals:e})}))),style:ua.picker,children:ca.map((e=>(0,T.jsx)(He.default.Item,{label:"".concat(e," animal").concat("1"===e?"":"s"),value:e},e)))})]})]})]}),(0,T.jsxs)(r.default,{style:[ua.section,{zIndex:6}],children:[(0,T.jsx)(i.default,{style:ua.label,children:"Holiday Rate"}),(0,T.jsx)(r.default,{style:ua.rateContainer,children:(0,T.jsx)(r.default,{style:ua.baseRateInput,children:(0,T.jsx)(q.default,{style:ua.input,value:L.rates.holidayRate.toString(),onChangeText:e=>O((t=>Object.assign({},t,{rates:Object.assign({},t.rates,{holidayRate:e.replace(/[^0-9.]/g,"")})}))),keyboardType:"decimal-pad",placeholder:"0.00"})})})]}),(0,T.jsxs)(r.default,{style:[ua.section,{zIndex:5}],children:[(0,T.jsx)(i.default,{style:ua.label,children:"Additional Rates"}),L.rates.additionalRates.map(((e,t)=>(0,T.jsxs)(r.default,{style:[ua.rateRow,{marginBottom:10}],children:[(0,T.jsx)(q.default,{style:[ua.input,ua.rateInput],value:e.name,editable:!1}),(0,T.jsx)(r.default,{style:[ua.rateAmountContainer],children:(0,T.jsx)(q.default,{style:[ua.input,ua.rateAmountInput],value:e.amount.toString(),editable:!1})}),(0,T.jsx)(s.default,{onPress:()=>(e=>{O((t=>Object.assign({},t,{rates:Object.assign({},t.rates,{additionalRates:t.rates.additionalRates.filter(((t,o)=>o!==e))})})))})(t),children:(0,T.jsx)(S.default,{name:"close",size:24,color:f.theme.colors.error})})]},t))),V?(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)(r.default,{style:ua.rateLabelContainer,children:[(0,T.jsx)(i.default,{style:ua.rateTitleLabel,children:"Rate Title"}),(0,T.jsx)(i.default,{style:ua.rateAmountLabel,children:"Rate Amount"})]}),(0,T.jsxs)(r.default,{style:ua.rateRow,children:[(0,T.jsx)(q.default,{style:[ua.input,ua.rateInput],value:G.name,onChangeText:e=>J((t=>Object.assign({},t,{name:e}))),placeholder:"Rate Title"}),(0,T.jsx)(r.default,{style:[ua.rateAmountContainer],children:(0,T.jsx)(q.default,{style:[ua.input,ua.rateAmountInput],value:G.amount,onChangeText:e=>J((t=>Object.assign({},t,{amount:e.replace(/[^0-9.]/g,"")}))),keyboardType:"decimal-pad",placeholder:"0.00"})}),(0,T.jsx)(s.default,{onPress:()=>handleAddRate(),children:(0,T.jsx)(S.default,{name:"plus",size:24,color:f.theme.colors.primary})})]})]}):(0,T.jsx)(s.default,{style:ua.addRateButton,onPress:()=>Y(!0),children:(0,T.jsx)(i.default,{style:ua.addRateButtonText,children:"Add custom rate"})})]}),(0,T.jsxs)(r.default,{style:ua.totalSection,children:[(0,T.jsx)(i.default,{style:ua.totalLabel,children:"Total:"}),R?(0,T.jsx)(r.default,{style:ua.loadingContainer,children:(0,T.jsx)(A.default,{size:"small",color:f.theme.colors.primary})}):(0,T.jsxs)(i.default,{style:ua.totalAmount,children:["$",parseFloat(L.calculatedCost).toFixed(2)]})]})]})]}),(0,T.jsxs)(r.default,{style:ua.buttonContainer,children:[(0,T.jsx)(_e.default,{mode:"outlined",onPress:()=>{j(!0)},style:[ua.button,{borderColor:f.theme.colors.error}],textColor:f.theme.colors.error,children:"Delete"}),(0,T.jsx)(_e.default,{mode:"contained",onPress:()=>{const e=sa((0,ko.format)(L.startDateTime,"yyyy-MM-dd"),(0,ko.format)(L.endDateTime,"yyyy-MM-dd"),(0,ko.format)(L.startDateTime,"HH:mm"),(0,ko.format)(L.endDateTime,"HH:mm"));e.isValid?(I(null),(async()=>{try{const e=(0,ko.format)(L.startDateTime,"yyyy-MM-dd"),a=(0,ko.format)(L.startDateTime,"HH:mm"),n=(0,ko.format)(L.endDateTime,"yyyy-MM-dd"),r=(0,ko.format)(L.endDateTime,"HH:mm");h&&console.log("MBA1234 Adding occurrence:",{startDate:e,startTime:a,endDate:n,endTime:r,startDateTime:L.startDateTime.toISOString(),endDateTime:L.endDateTime.toISOString()});const i=await o({startDate:e,startTime:a,endDate:n,endTime:r,rates:L.rates});h&&console.log("MBA1234 Response from onAdd:",i),"success"===i?.status?(h&&console.log("MBA1234 Successfully added/updated occurrence"),Z(),t(),Be.default.alert("Success",i.message)):I(i?.message||"Failed to add event")}catch(e){h&&console.error("MBA1234 Error adding occurrence:",e),I(e.message||"An unexpected error occurred")}})()):I(e.error)},style:ua.button,children:c?"Save Changes":"Add"})]}),k&&(0,T.jsx)(i.default,{style:ua.errorMessage,children:k})]})})}),(0,T.jsx)(D,{visible:x,onClose:()=>j(!1),onConfirm:()=>{j(!1),$()},actionText:"delete this occurrence"})]});var K},ga=l.default.create({modalContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0, 0, 0, 0.5)"},modalContent:{backgroundColor:f.theme.colors.background,borderRadius:8,padding:20,width:"90%",maxWidth:500,maxHeight:"80%"},modalTitle:{fontSize:f.theme.fontSizes.largeLarge,fontWeight:"bold",marginBottom:20,textAlign:"center"},scrollView:{maxHeight:"70%"},label:{fontSize:f.theme.fontSizes.medium,fontWeight:"500",marginTop:15,marginBottom:10},serviceOptions:{flexDirection:"row",flexWrap:"wrap",gap:10},serviceButton:{marginBottom:10},petOptions:{flexDirection:"row",flexWrap:"wrap",gap:10},petButton:{marginBottom:10},dateContainer:{gap:10},timeContainer:{flexDirection:"row",justifyContent:"space-between",gap:10},buttonContainer:{flexDirection:"row",justifyContent:"space-between",marginTop:20,gap:10},button:{flex:1},timePickerWrapper:{flex:1},dropdownContainer:{position:"relative",marginBottom:20,zIndex:3},dropdownInput:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",borderWidth:1,borderColor:f.theme.colors.border,borderRadius:8,padding:12,backgroundColor:f.theme.colors.surface},dropdownList:{position:"absolute",top:"100%",left:0,right:0,backgroundColor:f.theme.colors.surface,borderWidth:1,borderColor:f.theme.colors.border,borderRadius:8,maxHeight:200,zIndex:1e3,elevation:5},dropdownItem:{padding:12,borderBottomWidth:1,borderBottomColor:f.theme.colors.border},dropdownText:{color:f.theme.colors.text},selectedOption:{color:f.theme.colors.primary,fontWeight:"bold"},petItem:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingVertical:12,borderBottomWidth:1,borderBottomColor:f.theme.colors.border},petInfo:{flex:1},petName:{fontSize:f.theme.fontSizes.medium,fontWeight:"500",marginBottom:4},petDetails:{fontSize:f.theme.fontSizes.smallMedium,color:f.theme.colors.placeholder},addPetButton:{flexDirection:"row",alignItems:"center",padding:12,marginTop:8,borderWidth:1,borderColor:f.theme.colors.border,borderRadius:8,justifyContent:"center"},addPetText:{marginLeft:8,color:f.theme.colors.primary,fontSize:f.theme.fontSizes.medium},occurrenceCard:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:15,backgroundColor:f.theme.colors.surface,borderRadius:8,marginBottom:10,borderWidth:1,borderColor:f.theme.colors.border},occurrenceDetails:{flex:1},dateText:{fontSize:f.theme.fontSizes.medium,fontWeight:"500",marginBottom:4},timeText:{fontSize:f.theme.fontSizes.smallMedium,color:f.theme.colors.placeholder},addOccurrenceButton:{flexDirection:"row",alignItems:"center",justifyContent:"center",padding:16,borderWidth:1,borderColor:f.theme.colors.primary,borderRadius:8,marginTop:12},addOccurrenceText:{marginLeft:8,color:f.theme.colors.primary,fontSize:f.theme.fontSizes.medium},occurrenceActions:{flexDirection:"row",alignItems:"center",gap:10},actionButton:{padding:8,borderWidth:1,borderColor:f.theme.colors.error,borderRadius:4},bookingRequestCard:{backgroundColor:f.theme.colors.surface,borderRadius:8,padding:16,margin:8,borderWidth:1,borderColor:f.theme.colors.primary},bookingRequestHeader:{flexDirection:"row",alignItems:"center",marginBottom:12,gap:8},bookingRequestTitle:{fontSize:f.theme.fontSizes.mediumLarge,fontWeight:"bold",color:f.theme.colors.primary},bookingRequestDetails:{gap:8},detailLabel:{fontSize:f.theme.fontSizes.smallMedium,fontWeight:"500",color:f.theme.colors.placeholder},detailText:{fontSize:f.theme.fontSizes.medium,color:f.theme.colors.text},acceptButton:{backgroundColor:f.theme.colors.primary,padding:12,borderRadius:8,alignItems:"center",marginTop:16},acceptButtonText:{color:f.theme.colors.surface,fontSize:f.theme.fontSizes.medium,fontWeight:"500"},occurrenceCardError:{borderColor:f.theme.colors.error},errorText:{color:f.theme.colors.error,fontSize:f.theme.fontSizes.small,marginTop:4},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:20},errorContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:20}}),ha=({visible:e,onClose:t,onSubmit:o,conversationId:n})=>{const[i,l]=(0,a.useState)(""),{is_DEBUG:d}=(0,a.useContext)(p.AuthContext),[c,u]=(0,a.useState)([]),[m,g]=(0,a.useState)(!1),[h,y]=(0,a.useState)(!1),[x,j]=(0,a.useState)(!1),[C,v]=(0,a.useState)([]),[B,k]=(0,a.useState)(null),[I,M]=(0,a.useState)({visible:!1,actionText:"",onConfirm:null,isLoading:!1}),[R,P]=(0,a.useState)({}),[z,F]=(0,a.useState)([]),[L,O]=(0,a.useState)([]),[E,W]=(0,a.useState)(!0),[N,U]=(0,a.useState)(null);(0,a.useEffect)((()=>{e&&n?V():e||(W(!1),U(null))}),[e,n]);const V=async()=>{try{W(!0),U(null),d&&console.log("Fetching prerequest data for conversation:",n);const e=await(0,p.getStorage)("userToken"),t=await w.default.get("".concat(b.API_BASE_URL,"/api/messages/v1/prerequest_booking/").concat(n,"/"),{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});d&&console.log("Prerequest data response:",t.data),F(t.data.services),O(t.data.pets),d&&(console.log("Updated services:",t.data.services),console.log("Updated pets:",t.data.pets))}catch(e){d&&console.error("Error fetching pre-request data:",e.response||e),U("Failed to load booking data. Please try again.")}finally{W(!1)}},q=()=>{l(""),u([]),v([]),k(null),W(!1),U(null)},G=e=>{M({visible:!0,actionText:"delete this occurrence",onConfirm:()=>(async e=>{M((e=>Object.assign({},e,{isLoading:!0})));try{v((t=>t.filter((t=>t.startDate!==e.startDate||t.startTime!==e.startTime))))}finally{M({visible:!1,actionText:"",onConfirm:null,isLoading:!1})}})(e),isLoading:!1})},J=()=>{q(),t()},$=()=>{g(!1),y(!1),j(!0)};return(0,T.jsxs)(_.default,{visible:e,onRequestClose:J,animationType:"slide",transparent:!0,children:[(0,T.jsx)(r.default,{style:ga.modalContainer,children:(0,T.jsxs)(r.default,{style:ga.modalContent,children:[(0,T.jsx)(Y.default,{style:ga.modalTitle,children:"Request Booking"}),E?(0,T.jsxs)(r.default,{style:ga.loadingContainer,children:[(0,T.jsx)(A.default,{size:"large",color:f.theme.colors.primary}),(0,T.jsx)(Y.default,{children:"Loading booking data..."})]}):N?(0,T.jsxs)(r.default,{style:ga.errorContainer,children:[(0,T.jsx)(Y.default,{style:ga.errorText,children:N}),(0,T.jsx)(_e.default,{mode:"contained",onPress:V,children:"Retry"})]}):(0,T.jsxs)(H.default,{style:ga.scrollView,children:[(0,T.jsx)(Y.default,{style:ga.label,children:"Select Service"}),(0,T.jsxs)(r.default,{style:ga.dropdownContainer,children:[(0,T.jsxs)(s.default,{style:ga.dropdownInput,onPress:()=>g(!m),children:[(0,T.jsx)(Y.default,{children:i||"Select Service Type"}),(0,T.jsx)(S.default,{name:m?"chevron-up":"chevron-down",size:24,color:f.theme.colors.text})]}),m&&(0,T.jsx)(r.default,{style:ga.dropdownList,children:(0,T.jsx)(H.default,{nestedScrollEnabled:!0,children:z.map((e=>(0,T.jsx)(s.default,{style:ga.dropdownItem,onPress:()=>{l(e.service_name),g(!1)},children:(0,T.jsx)(Y.default,{style:[ga.dropdownText,i===e.service_name&&ga.selectedOption],children:e.service_name})},e.service_id)))})})]}),(0,T.jsx)(Y.default,{style:ga.label,children:"Select Pets"}),(0,T.jsxs)(r.default,{style:{zIndex:2},children:[c.map((e=>{const t=L.find((t=>t.pet_id===e));return(0,T.jsxs)(r.default,{style:ga.petItem,children:[(0,T.jsxs)(r.default,{style:ga.petInfo,children:[(0,T.jsx)(Y.default,{style:ga.petName,children:t.name}),(0,T.jsxs)(Y.default,{style:ga.petDetails,children:[t.pet_type," \u2022 ",t.breed]})]}),(0,T.jsx)(s.default,{onPress:()=>u((t=>t.filter((t=>t!==e)))),children:(0,T.jsx)(S.default,{name:"close",size:24,color:f.theme.colors.error})})]},e)})),(0,T.jsxs)(s.default,{style:ga.addPetButton,onPress:()=>y(!h),children:[(0,T.jsx)(S.default,{name:h?"chevron-up":"chevron-down",size:20,color:f.theme.colors.primary}),(0,T.jsx)(Y.default,{style:ga.addPetText,children:0===c.length?"Select Pets":"Add Pet"})]}),h&&(0,T.jsx)(r.default,{style:ga.dropdownList,children:(0,T.jsx)(H.default,{nestedScrollEnabled:!0,style:ga.petDropdown,children:L.filter((e=>!c.includes(e.pet_id))).map((e=>(0,T.jsx)(s.default,{style:ga.dropdownItem,onPress:()=>{u((t=>[...t,e.pet_id])),y(!1)},children:(0,T.jsxs)(r.default,{children:[(0,T.jsx)(Y.default,{style:ga.dropdownPetName,children:e.name}),(0,T.jsxs)(Y.default,{style:ga.dropdownPetDetails,children:[e.pet_type," \u2022 ",e.breed]})]})},e.pet_id)))})})]}),(0,T.jsx)(Y.default,{style:ga.label,children:"Select Date & Time"}),C.map(((e,t)=>((e,t)=>(0,T.jsx)(r.default,{children:(0,T.jsxs)(s.default,{style:[ga.occurrenceCard,R[t]&&ga.occurrenceCardError],children:[(0,T.jsxs)(r.default,{style:ga.occurrenceDetails,children:[(0,T.jsx)(Y.default,{style:ga.dateText,children:e.endDate&&e.startDate!==e.endDate?"".concat(e.startDate," - ").concat(e.endDate):e.startDate}),(0,T.jsx)(Y.default,{style:ga.timeText,children:"".concat(e.startTime," - ").concat(e.endTime)}),R[t]&&(0,T.jsx)(Y.default,{style:ga.errorText,children:R[t]})]}),(0,T.jsxs)(r.default,{style:ga.occurrenceActions,children:[(0,T.jsx)(s.default,{style:ga.actionButton,onPress:()=>G(e),children:(0,T.jsx)(S.default,{name:"trash-can-outline",size:20,color:f.theme.colors.error})}),(0,T.jsx)(s.default,{style:ga.actionButton,onPress:()=>{k(e),$()},children:(0,T.jsx)(S.default,{name:"pencil",size:20,color:f.theme.colors.primary})})]})]})},t))(e,t))),(0,T.jsxs)(s.default,{style:ga.addOccurrenceButton,onPress:()=>{k(null),$()},children:[(0,T.jsx)(S.default,{name:"plus",size:24,color:f.theme.colors.primary}),(0,T.jsx)(Y.default,{style:ga.addOccurrenceText,children:"Add Date & Time"})]})]}),(0,T.jsxs)(r.default,{style:ga.buttonContainer,children:[(0,T.jsx)(_e.default,{mode:"outlined",onPress:J,style:ga.button,children:"Cancel"}),(0,T.jsx)(_e.default,{mode:"contained",onPress:()=>{if(0===C.length)return;if(!(e=>{const t={};let o=!0;return e.forEach(((e,a)=>{const n=sa(e.startDate,e.endDate,e.startTime,e.endTime);n.isValid||(t[a]=n.error,o=!1)})),P(t),o})(C))return;const e=z.find((e=>e.service_name===i));if(!e)return void U("Please select a valid service");const a={conversation_id:n,service_type:e.service_id,pets:c,occurrences:C.map((e=>({start_date:e.startDate,end_date:e.endDate||e.startDate,start_time:e.startTime,end_time:e.endTime})))};d&&console.log("Sending booking data:",JSON.stringify(a,null,2)),W(!0),U(null),o(a).then((()=>{q(),t()})).catch((e=>{const t=e.response?.data?.error||"Failed to create booking request";U(t)})).finally((()=>{W(!1)}))},style:ga.button,disabled:!i||0===c.length||0===C.length||E,children:"Submit"})]})]})}),(0,T.jsx)(ma,{visible:x,onClose:()=>j(!1),onAdd:e=>{const{startDate:t,endDate:o,startTime:a,endTime:n}=e;return!!sa(t,o,a,n).isValid&&(v(B?e=>e.map((e=>e===B?{startDate:t,endDate:o,startTime:a,endTime:n}:e)):e=>[...e,{startDate:t,endDate:o,startTime:a,endTime:n}]),k(null),j(!1),!0)},hideRates:!0,initialOccurrence:B,modalTitle:B?"Edit Occurrence":"Add New Occurrence",isFromRequestBooking:!0}),(0,T.jsx)(D,{visible:I.visible,actionText:I.actionText,onClose:()=>{I.isLoading||M({visible:!1,actionText:"",onConfirm:null,isLoading:!1})},onConfirm:I.onConfirm,isLoading:I.isLoading})]})},fa=l.default.create({container:{flex:1,backgroundColor:f.theme.colors.background},section:{padding:16},sectionTitle:{fontSize:"web"===n.default.OS?18:14,fontFamily:f.theme.fonts.header.fontFamily,marginBottom:16,color:f.theme.colors.text},servicesGrid:{flexDirection:"row",flexWrap:"wrap",gap:12,justifyContent:"flex-start",width:"100%"},serviceCard:{width:"31%",minWidth:100,maxWidth:150,aspectRatio:1.2,backgroundColor:f.theme.colors.surface,borderRadius:12,padding:12,alignItems:"center",justifyContent:"center",borderWidth:1,borderColor:f.theme.colors.border,marginBottom:8},selectedServiceCard:{backgroundColor:"".concat(f.theme.colors.mainColors.main,"10"),borderColor:f.theme.colors.mainColors.main},serviceText:{marginTop:8,fontSize:16,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily,textAlign:"center",width:"100%"},selectedServiceText:{color:f.theme.colors.mainColors.main,fontWeight:"600"},petsContainer:{gap:12,flexDirection:"row",flexWrap:"wrap",justifyContent:"flex-start"},petCard:{flexDirection:"row",alignItems:"center",backgroundColor:f.theme.colors.surface,borderRadius:12,padding:12,borderWidth:1,borderColor:f.theme.colors.border,width:"web"===n.default.OS?"calc(50% - 6px)":"100%",minWidth:"web"===n.default.OS?250:"auto",maxWidth:"web"===n.default.OS?400:"100%"},selectedPetCard:{backgroundColor:"".concat(f.theme.colors.mainColors.main,"10"),borderColor:f.theme.colors.mainColors.main},petImageContainer:{marginRight:12},petImage:{width:48,height:48,borderRadius:24},defaultPetImage:{width:48,height:48,borderRadius:24,backgroundColor:f.theme.colors.surface,alignItems:"center",justifyContent:"center",borderWidth:1,borderColor:f.theme.colors.border},petInfo:{flex:1},petName:{fontSize:16,fontFamily:f.theme.fonts.regular.fontFamily,marginBottom:4,color:f.theme.colors.text},petDetails:{fontSize:14,color:f.theme.colors.placeHolderText,fontFamily:f.theme.fonts.regular.fontFamily},checkIcon:{marginLeft:12},selectedItemsContainer:{backgroundColor:"rgba(0, 0, 0, 0.03)",padding:16,borderRadius:8},selectedItemsTitle:{fontSize:"web"===n.default.OS?14:10,fontFamily:f.theme.fonts.header.fontFamily,marginBottom:16,color:f.theme.colors.text},selectedItemsContent:{flexDirection:"row",flexWrap:"wrap",gap:8},selectedTag:{flexDirection:"row",alignItems:"center",backgroundColor:"".concat(f.theme.colors.mainColors.main,"10"),borderRadius:20,paddingVertical:6,paddingHorizontal:12,gap:8},selectedTagText:{color:f.theme.colors.mainColors.main,fontSize:14,fontFamily:f.theme.fonts.regular.fontFamily},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:20},errorContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:20},errorText:{color:f.theme.colors.error,textAlign:"center",fontFamily:f.theme.fonts.regular.fontFamily},serviceCheckIcon:{position:"absolute",top:8,right:8},createServiceButton:{backgroundColor:f.theme.colors.mainColors.main,padding:16,borderRadius:8,alignItems:"center"},createServiceButtonText:{color:f.theme.colors.surface,fontSize:16,fontFamily:f.theme.fonts.regular.fontFamily}}),pa=({bookingId:e,onServiceSelect:t,onPetSelect:n,selectedService:l,selectedPets:d,isLoading:c,error:u,onNext:m,currentBookingId:g,navigation:y,onClose:b})=>{const{is_DEBUG:x}=(0,a.useContext)(p.AuthContext),[j,w]=(0,a.useState)([]),[C,v]=(0,a.useState)([]),[B,k]=(0,a.useState)(!1),[_,I]=(0,a.useState)(!1),[D,M]=(0,a.useState)(null),[R,P]=(0,a.useState)(null);(0,a.useEffect)((()=>{e&&(z(),F())}),[e]);const z=async()=>{try{k(!0),M(null);const o=await(0,at.getBookingAvailableServices)(e);if(x&&console.log("MBA12345 Available services response:",o),w(o.services),o.selected_service_id&&!l){const e=o.services.find((e=>e.service_id===o.selected_service_id));e&&t(Object.assign({},e,{isOvernightForced:e.is_overnight}))}}catch(u){x&&console.error("MBA12345 Error fetching services:",u),M("Failed to load available services")}finally{k(!1)}},F=async()=>{try{I(!0),P(null);const t=await(0,at.getBookingAvailablePets)(e);if(x&&console.log("MBA12345 Available pets response:",t),v(t.pets),t.selected_pet_ids&&t.selected_pet_ids.length>0&&0===d.length){t.pets.filter((e=>t.selected_pet_ids.includes(e.pet_id))).forEach((e=>n(e)))}}catch(u){x&&console.error("MBA12345 Error fetching pets:",u),P("Failed to load available pets")}finally{I(!1)}},L=e=>{switch(e.toLowerCase()){case"dog walking":default:return"paw";case"house sitting":return"home";case"drop-in visits":return"food-variant";case"boarding":return"home-city"}};return c?(0,T.jsx)(r.default,{style:fa.loadingContainer,children:(0,T.jsx)(A.default,{size:"large",color:f.theme.colors.mainColors.main})}):u?(0,T.jsx)(r.default,{style:fa.errorContainer,children:(0,T.jsx)(i.default,{style:fa.errorText,children:u})}):(0,T.jsxs)(H.default,{style:fa.container,children:[(0,T.jsxs)(r.default,{style:fa.section,children:[(0,T.jsx)(i.default,{style:fa.sectionTitle,children:"Select Service"}),D?(0,T.jsx)(i.default,{style:fa.errorText,children:D}):B?(0,T.jsx)(A.default,{size:"small",color:f.theme.colors.mainColors.main}):j.length>0?(0,T.jsx)(r.default,{style:fa.servicesGrid,children:j.map((e=>(e=>{const o=l?.service_id===e.service_id;return(0,T.jsxs)(s.default,{style:[fa.serviceCard,o&&fa.selectedServiceCard],onPress:()=>t(Object.assign({},e,{isOvernightForced:e.is_overnight})),children:[(0,T.jsx)(S.default,{name:L(e.service_name),size:24,color:o?f.theme.colors.mainColors.main:f.theme.colors.text}),(0,T.jsx)(i.default,{style:[fa.serviceText,o&&fa.selectedServiceText],children:e.service_name}),o&&(0,T.jsx)(S.default,{name:"check",size:24,color:f.theme.colors.mainColors.main,style:fa.serviceCheckIcon})]},e.service_id)})(e)))}):(0,T.jsxs)(r.default,{style:fa.noServicesContainer,children:[(0,T.jsx)(i.default,{style:fa.errorText,children:"No services available. Please add services to create a booking."}),(0,T.jsx)(s.default,{style:fa.createServiceButton,onPress:()=>{b(),(0,h.navigateToFrom)(y,"ServiceManager","MessageHistory")},children:(0,T.jsx)(i.default,{style:fa.createServiceButtonText,children:"Create Services"})})]})]}),(0,T.jsxs)(r.default,{style:fa.section,children:[(0,T.jsx)(i.default,{style:fa.sectionTitle,children:"Select Pets"}),R?(0,T.jsx)(i.default,{style:fa.errorText,children:R}):_?(0,T.jsx)(A.default,{size:"small",color:f.theme.colors.mainColors.main}):C.length>0?(0,T.jsx)(r.default,{style:fa.petsContainer,children:C.map((e=>(e=>{const t=d.some((t=>t.pet_id===e.pet_id));return(0,T.jsxs)(s.default,{style:[fa.petCard,t&&fa.selectedPetCard],onPress:()=>n(e),children:[(0,T.jsx)(r.default,{style:fa.petImageContainer,children:e.image_url?(0,T.jsx)(U.default,{source:{uri:e.image_url},style:fa.petImage,defaultSource:o(65460)}):(0,T.jsx)(r.default,{style:fa.defaultPetImage,children:(0,T.jsx)(S.default,{name:"paw",size:24,color:f.theme.colors.placeHolderText})})}),(0,T.jsxs)(r.default,{style:fa.petInfo,children:[(0,T.jsx)(i.default,{style:fa.petName,children:e.name}),(0,T.jsxs)(i.default,{style:fa.petDetails,children:[e.breed," \u2022 ",e.age," years"]})]}),t&&(0,T.jsx)(S.default,{name:"check",size:24,color:f.theme.colors.mainColors.main,style:fa.checkIcon})]},e.pet_id)})(e)))}):(0,T.jsx)(i.default,{style:fa.errorText,children:"Please instruct client to add pets to their account so you can create a booking for their pets."})]})]})},{width:ya,height:ba}=v.default.get("window"),xa=.4*ba,ja=ya>480,wa=l.default.create({container:{flex:1,backgroundColor:f.theme.colors.background,padding:12,minHeight:ja?600:"auto"},bookingTypeContainer:{flexDirection:"row",marginBottom:12,borderRadius:8,overflow:"hidden"},bookingTypeButton:{flex:1,paddingVertical:12,alignItems:"center",justifyContent:"center",backgroundColor:"#e8e8e8"},selectedBookingTypeButton:{backgroundColor:f.theme.colors.mainColors.main},bookingTypeText:{fontSize:16,fontFamily:f.theme.fonts.regular.fontFamily,color:f.theme.colors.text},selectedBookingTypeText:{color:f.theme.colors.surface,fontWeight:"600"},dateRangeTypeContainer:{flexDirection:"row",marginBottom:12,borderRadius:8,overflow:"hidden"},dateRangeTypeButton:{flex:1,paddingVertical:12,alignItems:"center",justifyContent:"center",backgroundColor:"#e8e8e8"},selectedDateRangeTypeButton:{backgroundColor:f.theme.colors.mainColors.main},dateRangeTypeText:{fontSize:16,fontFamily:f.theme.fonts.regular.fontFamily,color:f.theme.colors.text},selectedDateRangeTypeText:{color:f.theme.colors.surface,fontWeight:"600"},calendarContainer:{backgroundColor:f.theme.colors.surface,borderRadius:8,padding:12,marginBottom:12,maxHeight:ja?ya>700?600:500:xa,overflow:"visible",minHeight:ja?ya>700?500:400:350,display:"flex",flexDirection:"column"},calendarHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:8},calendarTitle:{fontSize:16,fontFamily:f.theme.fonts.regular.fontFamily,fontWeight:"600",color:f.theme.colors.text},calendarNavButton:{padding:6},calendarNavButtonText:{fontSize:18,color:f.theme.colors.text},weekdaysContainer:{flexDirection:"row",justifyContent:"space-around",marginBottom:ja?8:4,paddingHorizontal:4},weekdayText:{flex:1,textAlign:"center",fontSize:12,color:f.theme.colors.text,opacity:.7,fontFamily:f.theme.fonts.regular.fontFamily},weekRow:{flexDirection:"row",justifyContent:"space-around",marginBottom:ja?12:4,minHeight:ja?ya>700?70:50:40,flex:1,paddingHorizontal:4},dateCell:{flex:1,aspectRatio:1,alignItems:"center",justifyContent:"center",borderRadius:4,padding:ja?4:2,minHeight:ja?ya>700?60:40:"auto"},dateText:{fontSize:ja&&ya>700?16:14,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily},otherMonthDate:{opacity:.3},otherMonthDateText:{color:f.theme.colors.placeHolderText},selectedDate:{backgroundColor:f.theme.colors.mainColors.main},dateInRange:{backgroundColor:"".concat(f.theme.colors.mainColors.main,"80")},selectedDateText:{color:f.theme.colors.surface,fontWeight:"600"},selectedDatesContainer:{marginTop:12},selectedDatesTitle:{fontSize:14,fontFamily:f.theme.fonts.regular.fontFamily,fontWeight:"600",marginBottom:6,color:f.theme.colors.text},selectedDatesList:{flexDirection:"row",flexWrap:"wrap",gap:6},selectedDateChip:{flexDirection:"row",alignItems:"center",backgroundColor:f.theme.colors.backgroundContrast,borderRadius:16,paddingVertical:6,paddingLeft:10,paddingRight:6,marginRight:6,marginBottom:6},selectedDateChipText:{color:f.theme.colors.mainColors.main,fontFamily:f.theme.fonts.regular.fontFamily,fontSize:12,marginRight:2},removeButton:{marginLeft:4,padding:2},removeButtonText:{fontSize:16,color:f.theme.colors.mainColors.main,fontWeight:"bold"},dateRangeText:{fontSize:14,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily,marginBottom:8},recurringOptionsContainer:{marginTop:8},sectionTitle:{fontSize:16,fontFamily:f.theme.fonts.regular.fontFamily,fontWeight:"600",marginBottom:8,color:f.theme.colors.text},daysOfWeekContainer:{flexDirection:"row",justifyContent:"space-between",marginBottom:16},dayOfWeekButton:{width:40,height:40,borderRadius:20,alignItems:"center",justifyContent:"center",backgroundColor:"#e8e8e8"},selectedDayOfWeekButton:{backgroundColor:f.theme.colors.mainColors.main},dayOfWeekText:{fontSize:14,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily},selectedDayOfWeekText:{color:f.theme.colors.surface,fontWeight:"600"},dateRangeSection:{backgroundColor:f.theme.colors.surface,borderRadius:8,padding:12,marginBottom:16,borderWidth:1,borderColor:f.theme.colors.modernBorder},dateRangeRow:{flexDirection:"row",justifyContent:"space-between"},dateRangeColumn:{flex:1,backgroundColor:f.theme.colors.surface,padding:8,borderRadius:8},dateRangeLabel:{fontSize:14,color:f.theme.colors.text,opacity:.7,marginBottom:4,fontFamily:f.theme.fonts.regular.fontFamily},dateRangeValue:{fontSize:16,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily,fontWeight:"600"},frequencyContainer:{flexDirection:"row",marginBottom:16},frequencyButton:{flex:1,paddingVertical:10,paddingHorizontal:8,alignItems:"center",justifyContent:"center",backgroundColor:"#e8e8e8",borderRadius:8,marginRight:8},selectedFrequencyButton:{backgroundColor:f.theme.colors.mainColors.main},frequencyText:{fontSize:14,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily},selectedFrequencyText:{color:f.theme.colors.surface,fontWeight:"600"},recurrencePatternContainer:{backgroundColor:f.theme.colors.backgroundContrast,borderRadius:8,padding:12,marginBottom:16},recurrencePatternTitle:{fontSize:14,fontFamily:f.theme.fonts.regular.fontFamily,fontWeight:"600",marginBottom:4,color:f.theme.colors.text},recurrencePatternText:{fontSize:14,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily,marginBottom:2},modalOverlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center"},modalContent:{backgroundColor:f.theme.colors.surface,borderRadius:12,padding:16,width:"90%",maxWidth:400},modalTitle:{fontSize:18,fontFamily:f.theme.fonts.regular.fontFamily,fontWeight:"600",marginBottom:16,textAlign:"center",color:f.theme.colors.text},modalCloseButton:{marginTop:16,paddingVertical:12,alignItems:"center",backgroundColor:f.theme.colors.backgroundContrast,borderRadius:8},modalCloseButtonText:{fontSize:16,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily},previewButton:{marginTop:8,paddingVertical:8,paddingHorizontal:12,backgroundColor:f.theme.colors.mainColors.main,borderRadius:8,alignSelf:"flex-start"},previewButtonText:{color:f.theme.colors.surface,fontSize:14,fontFamily:f.theme.fonts.regular.fontFamily},previewModalContent:{maxHeight:"80%"},previewCalendarContainer:{backgroundColor:f.theme.colors.surface,borderRadius:8,padding:12,marginVertical:16},recurringDate:{backgroundColor:f.theme.colors.mainColors.main},recurringDateText:{color:f.theme.colors.surface,fontWeight:"600"},previewDateCell:{flex:1,aspectRatio:1,alignItems:"center",justifyContent:"center",borderRadius:4,padding:2},dateRangeChip:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",backgroundColor:f.theme.colors.backgroundContrast,borderRadius:16,paddingVertical:8,paddingLeft:12,paddingRight:8},removeRangeButton:{marginLeft:8,padding:4},selectedDateChip:{flexDirection:"row",alignItems:"center",backgroundColor:f.theme.colors.backgroundContrast,borderRadius:16,paddingVertical:6,paddingLeft:10,paddingRight:6,marginRight:6,marginBottom:6},removeButton:{marginLeft:4,padding:2},removeButtonText:{fontSize:16,color:f.theme.colors.mainColors.main,fontWeight:"bold"},oneTimeOptionsContainer:{marginTop:8},dateSelectionTitle:{color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily,fontWeight:"600",marginBottom:16,paddingHorizontal:4}}),Ca=({selectedDates:e=[],onDateSelect:t,bookingType:o="one-time",dateRangeType:n="date-range",initialDateRange:l=null,isOvernightForced:d=!1})=>{const{is_DEBUG:c,screenWidth:u}=(0,a.useContext)(p.AuthContext),[m,g]=(0,a.useState)(new Date),[h,f]=(0,a.useState)(e),[y,b]=(0,a.useState)(d?"one-time":o),[x,j]=(0,a.useState)("date-range"),[w,C]=(0,a.useState)(l?l.startDate:null),[v,S]=(0,a.useState)([1,3]),[B,k]=(0,a.useState)("weekly"),[A,I]=(0,a.useState)(l?l.endDate:null),[D,M]=(0,a.useState)(!1),[R,P]=(0,a.useState)(new Date),[z,F]=(0,a.useState)((()=>{const e=new Date;return e.setMonth(e.getMonth()+1),e})),[L,O]=(0,a.useState)(!0),[E,W]=(0,a.useState)(!1),[N,U]=(0,a.useState)(!1),[V,q]=(0,a.useState)(null),[Y,G]=(0,a.useState)(null),[J,$]=(0,a.useState)(!1),[Z,K]=(0,a.useState)(null);(0,a.useEffect)((()=>{if((0,p.debugLog)("MBA54321 DateSelectionCard initialized with dates:",e),(0,p.debugLog)("MBA54321 Current booking type:",o),(0,p.debugLog)("MBA54321 Current date range type:",n),(0,p.debugLog)("MBA54321 Initial date range:",l),(0,p.debugLog)("MBA54321 isOvernightForced:",d),b(d?"one-time":o),j(d?"date-range":"multiple-days"),e&&e.length>0){const a=e.map((e=>e instanceof Date?e:"object"===typeof e&&e.date?new Date(e.date):new Date(e)));f(a);const r=Q(a);if(("date-range"===n||d)&&a.length>0&&r){const e=[...a].sort(((e,t)=>e-t));C(e[0]),I(e[e.length-1]),$(!0)}else a.length>0&&$(!1);if(t){const e={type:o,dates:a,rangeType:d?"date-range":"multiple-days",isValid:!0};if(("date-range"===n||d)&&a.length>0&&r){const t=[...a].sort(((e,t)=>e-t));e.startDate=t[0],e.endDate=t[t.length-1]}t(e)}}}),[]);const Q=e=>{if(!e||e.length<=1)return!0;const t=[...e].sort(((e,t)=>e-t));for(let o=1;o<t.length;o++){const e=new Date(t[o-1]),a=new Date(t[o]);if(e.setDate(e.getDate()+1),e.getTime()!==a.getTime())return(0,p.debugLog)("MBA54321 Non-consecutive dates found:",{prev:t[o-1].toISOString().split("T")[0],current:t[o].toISOString().split("T")[0]}),!1}return!0};(0,a.useEffect)((()=>{if(l&&l.startDate&&l.endDate&&!J){if(h.length>0&&!Q(h))return(0,p.debugLog)("MBA54321 Non-consecutive dates already loaded, not converting to range"),void(t&&t({type:o,dates:h,rangeType:"multiple-days",isValid:h.length>0}));const e=[],a=new Date(l.startDate),n=new Date(l.endDate);for(;a<=n;)e.push(new Date(a)),a.setDate(a.getDate()+1);f(e),C(new Date(l.startDate)),I(new Date(l.endDate)),$(!0),t&&t({type:o,dates:e,rangeType:"date-range",startDate:new Date(l.startDate),endDate:new Date(l.endDate),isValid:!0})}}),[l,J]);const X=e=>{c&&console.log("MBA54321 Frequency selected:",e),k(e)},ee=()=>{const e=new Date(m);e.setMonth(e.getMonth()-1),g(e)},te=()=>{const e=new Date(m);e.setMonth(e.getMonth()+1),g(e)},oe=e=>h.some((t=>{if(!(t instanceof Date))if("string"===typeof t)t=new Date(t);else{if(!t||"string"!==typeof t.date)return!1;t=new Date(t.date)}return t.getDate()===e.getDate()&&t.getMonth()===e.getMonth()&&t.getFullYear()===e.getFullYear()})),ae=e=>{if(c&&(console.log("MBA19ynkiy34b handleDateRangeSelection - date:",e),console.log("MBA19ynkiy34b handleDateRangeSelection - current state:",{rangeStartDate:w,dateRangeEnd:A,selectedDatesList:h.length})),h.length>1&&!Q(h))return(0,p.debugLog)("MBA19ynkiy34b handleDateRangeSelection - clearing non-consecutive dates for date range"),f([e]),C(e),I(null),$(!1),void(t&&t({type:"one-time",dates:[e],rangeType:"date-range",startDate:e,isValid:!1}));if(h.length>1&&!Q(h))return"multiple-days"!==x&&((0,p.debugLog)("MBA19ynkiy34b Non-consecutive dates exist, forcing multiple-days mode"),j("multiple-days")),void ne(e);if(w)if(A)C(e),f([e]),I(null),K(null),c&&console.log("MBA19ynkiy34b handleDateRangeSelection - resetting selection"),t&&t({type:"one-time",dates:[e],rangeType:"date-range",startDate:e,isValid:!1});else{let o=new Date(w),a=new Date(e);e<w&&(o=new Date(e),a=new Date(w)),I(a);const n=[],r=new Date(o);for(;r<=a;)n.push(new Date(r)),r.setDate(r.getDate()+1);if(f(n),K({startDate:o,endDate:a,dates:n}),t){const e={type:"one-time",dates:n,rangeType:"date-range",startDate:o,endDate:a,isValid:!0};c&&console.log("MBA19ynkiy34b handleDateRangeSelection - complete range selected, sending data:",e),t(e)}}else C(e),f([e]),I(null),K(null),c&&console.log("MBA19ynkiy34b handleDateRangeSelection - first date selected"),t&&t({type:"one-time",dates:[e],rangeType:"date-range",startDate:e,isValid:!1})},ne=e=>{c&&(console.log("MBA19ynkiy34b toggleDateSelection - date:",e),console.log("MBA19ynkiy34b toggleDateSelection - current selected dates:",h.length));let o;if(o=oe(e)?h.filter((t=>{if(!(t instanceof Date))if("string"===typeof t)t=new Date(t);else{if(!t||"string"!==typeof t.date)return!0;t=new Date(t.date)}return!(t.getDate()===e.getDate()&&t.getMonth()===e.getMonth()&&t.getFullYear()===e.getFullYear())})):[...h,e].sort(((e,t)=>e-t)),f(o),t){const e={type:"one-time",dates:o,rangeType:"multiple-days",isValid:o.length>0};c&&(console.log("MBA19ynkiy34b toggleDateSelection - sending data:",e),console.log("MBA19ynkiy34b toggleDateSelection - newSelectedDates length:",o.length)),t(e)}},re=()=>{const e=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],t=v.map((t=>e[t]));if(0===t.length)return"No days selected";let o="";if(1===t.length)o=t[0];else if(2===t.length)o="".concat(t[0]," and ").concat(t[1]);else{const e=t.pop();o="".concat(t.join(", "),", and ").concat(e)}switch(B){case"bi-weekly":return"every other ".concat(o);case"monthly":const e=ie(R);return"the ".concat(e," ").concat(o," of each month");default:return"every ".concat(o)}},ie=e=>{const t=Math.ceil((e.getDate()+(0===e.getDay()?6:e.getDay()-1))/7);return["first","second","third","fourth","last"][Math.min(t-1,4)]},se=()=>{const e=new Date(m.getFullYear(),m.getMonth(),1),o=new Date(m.getFullYear(),m.getMonth()+1,0),a=new Date(e),n=new Date(o);a.setDate(a.getDate()-a.getDay()),n.setDate(n.getDate()+(6-n.getDay()));const l=[];let u=[],g=new Date(a);for(;g<=n;){for(let e=0;e<7;e++)u.push(new Date(g)),g.setDate(g.getDate()+1);l.push(u),u=[]}const h=m.toLocaleString("default",{month:"long"}),f=m.getFullYear();return(0,T.jsxs)(r.default,{style:wa.calendarContainer,children:[(0,T.jsxs)(r.default,{style:wa.calendarHeader,children:[(0,T.jsx)(s.default,{onPress:ee,style:wa.calendarNavButton,children:(0,T.jsx)(i.default,{style:wa.calendarNavButtonText,children:"<"})}),(0,T.jsx)(i.default,{style:wa.calendarTitle,children:"".concat(h," ").concat(f)}),(0,T.jsx)(s.default,{onPress:te,style:wa.calendarNavButton,children:(0,T.jsx)(i.default,{style:wa.calendarNavButtonText,children:">"})})]}),(0,T.jsx)(r.default,{style:wa.weekdaysContainer,children:["S","M","T","W","T","F","S"].map(((e,t)=>(0,T.jsx)(i.default,{style:wa.weekdayText,children:e},"weekday-".concat(t))))}),l.map(((e,o)=>(0,T.jsx)(r.default,{style:wa.weekRow,children:e.map(((e,a)=>{const n=(e=>{const t=new Date;return t.setHours(0,0,0,0),e.getMonth()<m.getMonth()?e.getMonth()===(m.getMonth()-1+12)%12&&e>=t:e.getMonth()>m.getMonth()?e.getMonth()===(m.getMonth()+1)%12&&e>=t:e>=t})(e),r=oe(e),l="date-range"===x&&(e=>!(!w||!A)&&e>=w&&e<=A)(e),u=N&&(e=>!(!V||!e)&&(Y?e>=V&&e<=Y:e.getTime()===V.getTime()))(e);return(0,T.jsx)(s.default,{style:[wa.dateCell,!n&&wa.otherMonthDate,r&&wa.selectedDate,l&&wa.dateInRange,u&&wa.dateInRange],onPress:()=>n&&(N?(e=>{if(c&&(console.log("MBA19ynkiy34b handleRecurringDateSelect - date:",e),console.log("MBA19ynkiy34b handleRecurringDateSelect - current state:",{tempRangeStart:V,selectedDaysOfWeek:v.length,frequency:B})),V){let o=V,a=e;if(e<V&&(o=e,a=V),P(o),F(a),q(null),G(null),U(!1),t){const e={type:"recurring",daysOfWeek:v,frequency:B,startDate:o,endDate:a,isValid:v.length>0};c&&(console.log("MBA19ynkiy34b handleRecurringDateSelect - complete selection, sending data:",e),console.log("MBA19ynkiy34b handleRecurringDateSelect - selectedDaysOfWeek:",v)),t(e)}}else q(e),P(e),c&&console.log("MBA19ynkiy34b handleRecurringDateSelect - first date selected"),t&&t({type:"recurring",startDate:e,daysOfWeek:v,frequency:B,isValid:!1})})(e):(e=>{c&&console.log("MBA54321 Date selected:",e),d||"date-range"===x?ae(e):ne(e)})(e)),disabled:!n,children:(0,T.jsx)(i.default,{style:[wa.dateText,!n&&wa.otherMonthDateText,(r||l||u)&&wa.selectedDateText],children:e.getDate()})},"date-".concat(o,"-").concat(a))}))},"week-".concat(o))))]})},le=e=>{const t=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][e.getMonth()],o=e.getDate(),a=e.getFullYear();return"".concat(t," ").concat(o,", ").concat(a)},de=()=>{c&&console.log("MBA54321 Clearing date range"),f([]),C(null),I(null),$(!1),K(null),t&&t({type:"one-time",dates:[],rangeType:x,startDate:null,endDate:null,isValid:!1})};return(0,a.useEffect)((()=>{c&&console.log("MBA19ynkiy34b Component mounted with:",{selectedDates:e,bookingType:o,dateRangeType:n})}),[]),(0,T.jsxs)(H.default,{style:wa.container,children:[d||"one-time"===y?(0,T.jsxs)(r.default,{style:wa.oneTimeOptionsContainer,children:[(0,T.jsx)(i.default,{style:[wa.dateSelectionTitle,{fontSize:u>768?24:18}],children:d?"Select a date range":"Select one or more dates"}),se(),(()=>{if(0===h.length)return null;if("date-range"===x&&(A||J&&l)){const e=w||l?.startDate||h[0],t=A||l?.endDate||h[h.length-1];return(0,T.jsxs)(r.default,{style:wa.selectedDatesContainer,children:[(0,T.jsx)(i.default,{style:wa.selectedDatesTitle,children:"Selected Range:"}),(0,T.jsxs)(r.default,{style:wa.dateRangeChip,children:[(0,T.jsxs)(i.default,{style:wa.dateRangeText,children:["From ",le(e)," to ",le(t)]}),(0,T.jsx)(s.default,{onPress:de,style:wa.removeRangeButton,children:(0,T.jsx)(i.default,{style:wa.removeButtonText,children:"\xd7"})})]})]})}return(0,T.jsxs)(r.default,{style:wa.selectedDatesContainer,children:[(0,T.jsx)(i.default,{style:wa.selectedDatesTitle,children:"Selected Dates:"}),(0,T.jsx)(r.default,{style:wa.selectedDatesList,children:h.map(((e,t)=>(0,T.jsxs)(r.default,{style:wa.selectedDateChip,children:[(0,T.jsx)(i.default,{style:wa.selectedDateChipText,children:le(e)}),(0,T.jsx)(s.default,{onPress:()=>ne(e),style:wa.removeButton,children:(0,T.jsx)(i.default,{style:wa.removeButtonText,children:"\xd7"})})]},"selected-date-".concat(t))))})]})})()]}):"recurring"!==y?null:(0,T.jsxs)(r.default,{style:wa.recurringOptionsContainer,children:[(0,T.jsx)(i.default,{style:wa.sectionTitle,children:"Repeat on"}),(0,T.jsx)(r.default,{style:wa.daysOfWeekContainer,children:["M","T","W","T","F","S","S"].map(((e,t)=>{const o=6===t?0:t+1,a=v.includes(o);return(0,T.jsx)(s.default,{style:[wa.dayOfWeekButton,a&&wa.selectedDayOfWeekButton],onPress:()=>(e=>{c&&console.log("MBA54321 Day of week toggled:",e),S((t=>t.includes(e)?t.filter((t=>t!==e)):[...t,e]))})(o),children:(0,T.jsx)(i.default,{style:[wa.dayOfWeekText,a&&wa.selectedDayOfWeekText],children:e})},"day-".concat(t))}))}),(0,T.jsxs)(r.default,{style:wa.dateRangeSection,children:[(0,T.jsxs)(r.default,{style:wa.dateRangeRow,children:[(0,T.jsxs)(s.default,{style:wa.dateRangeColumn,onPress:()=>U(!0),children:[(0,T.jsx)(i.default,{style:wa.dateRangeLabel,children:"From"}),(0,T.jsx)(i.default,{style:wa.dateRangeValue,children:le(R)})]}),(0,T.jsxs)(s.default,{style:wa.dateRangeColumn,onPress:()=>U(!0),children:[(0,T.jsx)(i.default,{style:wa.dateRangeLabel,children:"To"}),(0,T.jsx)(i.default,{style:wa.dateRangeValue,children:le(z)})]})]}),N?(0,T.jsx)(r.default,{style:wa.dropdownCalendar,children:(0,T.jsxs)(r.default,{style:wa.dropdownCalendarContent,children:[se(),(0,T.jsx)(s.default,{style:wa.dropdownCloseButton,onPress:()=>{U(!1),q(null),G(null)},children:(0,T.jsx)(i.default,{style:wa.dropdownCloseButtonText,children:"Cancel"})})]})}):null]}),(0,T.jsx)(i.default,{style:wa.sectionTitle,children:"Frequency"}),(0,T.jsxs)(r.default,{style:wa.frequencyContainer,children:[(0,T.jsx)(s.default,{style:[wa.frequencyButton,"weekly"===B&&wa.selectedFrequencyButton],onPress:()=>X("weekly"),children:(0,T.jsx)(i.default,{style:[wa.frequencyText,"weekly"===B&&wa.selectedFrequencyText],children:"Weekly"})}),(0,T.jsx)(s.default,{style:[wa.frequencyButton,"bi-weekly"===B&&wa.selectedFrequencyButton],onPress:()=>X("bi-weekly"),children:(0,T.jsx)(i.default,{style:[wa.frequencyText,"bi-weekly"===B&&wa.selectedFrequencyText],children:"Bi-weekly"})}),(0,T.jsx)(s.default,{style:[wa.frequencyButton,"monthly"===B&&wa.selectedFrequencyButton],onPress:()=>X("monthly"),children:(0,T.jsx)(i.default,{style:[wa.frequencyText,"monthly"===B&&wa.selectedFrequencyText],children:"Monthly"})})]}),(0,T.jsxs)(r.default,{style:wa.recurrencePatternContainer,children:[(0,T.jsx)(i.default,{style:wa.recurrencePatternTitle,children:"Recurrence Pattern:"}),(0,T.jsx)(i.default,{style:wa.recurrencePatternText,children:re()}),(0,T.jsxs)(i.default,{style:wa.recurrencePatternText,children:["From ",le(R)," to ",le(z)]}),(0,T.jsx)(s.default,{style:wa.previewButton,onPress:()=>W(!0),children:(0,T.jsx)(i.default,{style:wa.previewButtonText,children:"View on Calendar"})})]})]}),(0,T.jsx)((()=>{const[e,t]=(0,a.useState)(new Date(R)),o=()=>{const o=new Date(e);o.setMonth(o.getMonth()-1),t(o)},n=()=>{const o=new Date(e);o.setMonth(o.getMonth()+1),t(o)};return(0,T.jsx)(_.default,{visible:E,transparent:!0,animationType:"fade",onRequestClose:()=>W(!1),children:(0,T.jsx)(r.default,{style:wa.modalOverlay,children:(0,T.jsxs)(r.default,{style:[wa.modalContent,wa.previewModalContent],children:[(0,T.jsx)(i.default,{style:wa.modalTitle,children:"Recurring Dates Preview"}),(()=>{const t=new Date(e.getFullYear(),e.getMonth(),1),a=new Date(e.getFullYear(),e.getMonth()+1,0),l=new Date(t),d=new Date(a);l.setDate(l.getDate()-l.getDay()),d.setDate(d.getDate()+(6-d.getDay()));const c=[];let u=[],m=new Date(l);const g=(()=>{if(!R||!z||0===v.length)return new Set;const e=new Set,t=new Date(R),o=new Date(z);for(;t<=o;)v.includes(t.getDay())&&("weekly"===B?e.add(new Date(t).getTime()):"bi-weekly"===B?Math.floor((t-R)/6048e5)%2===0&&e.add(new Date(t).getTime()):"monthly"===B&&ie(R)===ie(t)&&e.add(new Date(t).getTime())),t.setDate(t.getDate()+1);return e})();for(;m<=d;){for(let e=0;e<7;e++)u.push(new Date(m)),m.setDate(m.getDate()+1);c.push(u),u=[]}const h=e.toLocaleString("default",{month:"long"}),f=e.getFullYear();return(0,T.jsxs)(r.default,{style:wa.previewCalendarContainer,children:[(0,T.jsxs)(r.default,{style:wa.calendarHeader,children:[(0,T.jsx)(s.default,{onPress:o,style:wa.calendarNavButton,children:(0,T.jsx)(i.default,{style:wa.calendarNavButtonText,children:"<"})}),(0,T.jsx)(i.default,{style:wa.calendarTitle,children:"".concat(h," ").concat(f)}),(0,T.jsx)(s.default,{onPress:n,style:wa.calendarNavButton,children:(0,T.jsx)(i.default,{style:wa.calendarNavButtonText,children:">"})})]}),(0,T.jsx)(r.default,{style:wa.weekdaysContainer,children:["S","M","T","W","T","F","S"].map(((e,t)=>(0,T.jsx)(i.default,{style:wa.weekdayText,children:e},"weekday-".concat(t))))}),c.map(((t,o)=>(0,T.jsx)(r.default,{style:wa.weekRow,children:t.map(((t,a)=>{const n=t.getMonth()===e.getMonth(),s=g.has(t.getTime());return(0,T.jsx)(r.default,{style:[wa.previewDateCell,!n&&wa.otherMonthDate,s&&wa.recurringDate],children:(0,T.jsx)(i.default,{style:[wa.dateText,!n&&wa.otherMonthDateText,s&&wa.recurringDateText],children:t.getDate()})},"date-".concat(o,"-").concat(a))}))},"week-".concat(o))))]})})(),(0,T.jsx)(s.default,{style:wa.modalCloseButton,onPress:()=>W(!1),children:(0,T.jsx)(i.default,{style:wa.modalCloseButtonText,children:"Close"})})]})})})}),{})]})},va=Array.from({length:12},((e,t)=>0===t?12:t)),Sa=Array.from({length:60},((e,t)=>t)).filter((e=>e%5===0)),Ta=["AM","PM"],Ba=l.default.create({timeDisplay:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",backgroundColor:f.theme.colors.surface,padding:10,borderRadius:8,borderWidth:1,borderColor:f.theme.colors.modernBorder,marginVertical:5},timeText:{flex:1,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily,fontSize:f.theme.fontSizes.medium,marginLeft:8},dropdownContainer:{position:"absolute",top:"100%",left:0,right:0,backgroundColor:f.theme.colors.background,borderRadius:8,borderWidth:1,borderColor:f.theme.colors.modernBorder,marginTop:4,zIndex:1e3,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3},inlineContainer:{backgroundColor:f.theme.colors.background,borderRadius:8,padding:4},label:{color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily,fontSize:f.theme.fontSizes.small,marginBottom:8},dropdownContent:{flexDirection:"row",padding:4},column:{flex:1,height:160},option:{padding:8,alignItems:"center",height:40,justifyContent:"center"},selectedOption:{backgroundColor:"".concat(f.theme.colors.mainColors.main,"20"),borderRadius:4},optionText:{color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily,fontSize:f.theme.fontSizes.medium},selectedOptionText:{color:f.theme.colors.mainColors.main,fontWeight:"600"},buttonRow:{flexDirection:"row",justifyContent:"space-between",marginTop:8,paddingHorizontal:4},button:{paddingVertical:8,paddingHorizontal:16,borderRadius:6,flex:1,marginHorizontal:4,alignItems:"center"},confirmButton:{backgroundColor:f.theme.colors.mainColors.main},cancelButton:{backgroundColor:f.theme.colors.modernBorder},confirmButtonText:{color:"white",fontFamily:f.theme.fonts.medium.fontFamily,fontSize:f.theme.fontSizes.small},cancelButtonText:{color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily,fontSize:f.theme.fontSizes.small},errorContainer:{flexDirection:"row",alignItems:"center",backgroundColor:"#FFEBEE",padding:8,marginHorizontal:4,marginTop:4,borderRadius:4},errorText:{color:f.theme.colors.error||"#D32F2F",fontSize:f.theme.fontSizes.small,fontFamily:f.theme.fonts.regular.fontFamily,marginLeft:4,flex:1}}),ka=({initialTime:e,onTimeSelect:t,isOpen:o,onClose:n,label:l="Time",uniqueId:d="default",showInlinePicker:c=!1})=>{const u=(0,a.useRef)(null),m=(0,a.useRef)(null),g=(0,a.useRef)(null),h=JSON.parse(JSON.stringify(e||{hours:9,minutes:0})),y=()=>{const e=h.hours,t=5*Math.round(h.minutes/5);return{hour:e%12===0?12:e%12,minute:t>=60?0:t,period:e>=12?"PM":"AM"}},[b,x]=(0,a.useState)(y()),[j,w]=(0,a.useState)(y()),[C,v]=(0,a.useState)(null);(0,a.useEffect)((()=>{if(e){const e=y();x(e),w(e),v(null)}}),[e?.hours,e?.minutes]),(0,a.useEffect)((()=>{if(C){const e=setTimeout((()=>{v(null)}),5e3);return()=>clearTimeout(e)}}),[C]),(0,a.useEffect)((()=>{o&&setTimeout((()=>{k()}),50)}),[o,b]);const S=()=>{(e=>{const{hour:o,minute:a,period:r}=e;let i=o;"PM"===r&&12!==o&&(i+=12),"AM"===r&&12===o&&(i=0);const s={hours:i,minutes:a};(0,p.debugLog)("MBAoi9uv43d: TimePickerDropdown selected time (".concat(d,"):"),{time12h:e,time24h:s}),w(e),!1===t(s)?(Be.default.alert("Invalid Time Selection",d.includes("start")?"Start time cannot be later than end time.":"End time cannot be earlier than start time.",[{text:"OK"}]),v(d.includes("start")?"Start time cannot be later than end time.":"End time cannot be earlier than start time.")):n()})(b)},B=()=>{x(j),v(null),n()},k=()=>{if(u.current){const e=40*va.indexOf(b.hour);u.current.scrollTo({y:Math.max(0,e-40),animated:!0})}if(m.current){const e=40*Sa.indexOf(b.minute);m.current.scrollTo({y:Math.max(0,e-40),animated:!0})}if(g.current){const e=40*Ta.indexOf(b.period);g.current.scrollTo({y:Math.max(0,e-20),animated:!0})}},_=()=>(0,T.jsxs)(r.default,{children:[(0,T.jsxs)(r.default,{style:Ba.dropdownContent,children:[(0,T.jsx)(H.default,{ref:u,style:Ba.column,showsVerticalScrollIndicator:!1,children:va.map((e=>(0,T.jsx)(s.default,{style:[Ba.option,b.hour===e&&Ba.selectedOption],onPress:()=>(e=>{x((t=>Object.assign({},t,{hour:e}))),v(null)})(e),children:(0,T.jsx)(i.default,{style:[Ba.optionText,b.hour===e&&Ba.selectedOptionText],children:e})},"hour-".concat(e))))}),(0,T.jsx)(H.default,{ref:m,style:Ba.column,showsVerticalScrollIndicator:!1,children:Sa.map((e=>(0,T.jsx)(s.default,{style:[Ba.option,b.minute===e&&Ba.selectedOption],onPress:()=>(e=>{x((t=>Object.assign({},t,{minute:e}))),v(null)})(e),children:(0,T.jsx)(i.default,{style:[Ba.optionText,b.minute===e&&Ba.selectedOptionText],children:e.toString().padStart(2,"0")})},"minute-".concat(e))))}),(0,T.jsx)(H.default,{ref:g,style:Ba.column,showsVerticalScrollIndicator:!1,children:Ta.map((e=>(0,T.jsx)(s.default,{style:[Ba.option,b.period===e&&Ba.selectedOption],onPress:()=>(e=>{x((t=>Object.assign({},t,{period:e}))),v(null)})(e),children:(0,T.jsx)(i.default,{style:[Ba.optionText,b.period===e&&Ba.selectedOptionText],children:e})},"period-".concat(e))))})]}),C&&(0,T.jsxs)(r.default,{style:Ba.errorContainer,children:[(0,T.jsx)(ee.default,{name:"error",size:16,color:f.theme.colors.error||"#D32F2F"}),(0,T.jsx)(i.default,{style:Ba.errorText,children:C})]}),(0,T.jsxs)(r.default,{style:Ba.buttonRow,children:[(0,T.jsx)(s.default,{style:[Ba.button,Ba.cancelButton],onPress:B,children:(0,T.jsx)(i.default,{style:Ba.cancelButtonText,children:"Cancel"})}),(0,T.jsx)(s.default,{style:[Ba.button,Ba.confirmButton],onPress:S,children:(0,T.jsx)(i.default,{style:Ba.confirmButtonText,children:"Confirm"})})]})]});return c?(0,T.jsxs)(r.default,{style:Ba.inlineContainer,children:[l&&(0,T.jsx)(i.default,{style:Ba.label,children:l}),_()]}):(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)(s.default,{style:Ba.timeDisplay,onPress:o?n:()=>{},children:[(0,T.jsx)(ee.default,{name:"access-time",size:18,color:f.theme.colors.mainColors.main}),(0,T.jsx)(i.default,{style:Ba.timeText,children:(A=b.hour,I=b.minute,D=b.period,"".concat(A,":").concat(I.toString().padStart(2,"0")," ").concat(D))}),(0,T.jsx)(ee.default,{name:o?"keyboard-arrow-up":"keyboard-arrow-down",size:20,color:f.theme.colors.text})]}),o&&(0,T.jsx)(r.default,{style:Ba.dropdownContainer,children:_()})]});var A,I,D},_a=l.default.create({container:{backgroundColor:f.theme.colors.background,borderRadius:8,padding:16,marginBottom:16},title:{fontSize:f.theme.fontSizes.medium,fontFamily:f.theme.fonts.medium.fontFamily,color:f.theme.colors.text,marginBottom:16},timeSelectionContainer:{flexDirection:"row",justifyContent:"space-between",marginBottom:16},timePickerContainer:{flex:1,marginHorizontal:4,position:"relative",zIndex:10},dateLabel:{fontSize:f.theme.fontSizes.small,fontFamily:f.theme.fonts.medium.fontFamily,color:f.theme.colors.textSecondary,marginBottom:4},timeLabel:{fontSize:f.theme.fontSizes.smallMedium,fontFamily:f.theme.fonts.regular.fontFamily,color:f.theme.colors.text,marginBottom:8},timeButton:{borderWidth:1,borderColor:f.theme.colors.modernBorder,borderRadius:8,backgroundColor:f.theme.colors.surface,position:"relative"},timeButtonContent:{flexDirection:"row",alignItems:"center",padding:12},timeText:{flex:1,fontSize:f.theme.fontSizes.medium,fontFamily:f.theme.fonts.regular.fontFamily,color:f.theme.colors.text,marginLeft:8},durationContainer:{flexDirection:"row",alignItems:"center",marginTop:4,padding:12,backgroundColor:f.theme.colors.bgColorModern,borderRadius:8},durationText:{fontSize:f.theme.fontSizes.medium,fontFamily:f.theme.fonts.regular.fontFamily,color:f.theme.colors.text,marginLeft:8},modalOverlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.2)",justifyContent:"center",alignItems:"center"},modalContent:{backgroundColor:f.theme.colors.background,borderRadius:8,borderWidth:1,borderColor:f.theme.colors.modernBorder,width:"80%",padding:8,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.2,shadowRadius:4,elevation:5},startModalContent:{alignSelf:"flex-start",marginLeft:"10%"},endModalContent:{alignSelf:"flex-end",marginRight:"10%"}}),Aa=({title:e,onTimeSelect:t,initialTimes:o={},is_overnight:n=!1,uniqueId:l="default",dateRange:d=null,selectedDates:c=[],isIndividualDaySelector:u=!1})=>{const{is_DEBUG:m}=(0,a.useContext)(p.AuthContext),[g,h]=(0,a.useState)((()=>{const e={startTime:{hours:9,minutes:0},endTime:{hours:17,minutes:0},isOvernightForced:o?.isOvernightForced||n||!1};return o?{startTime:o.startTime?JSON.parse(JSON.stringify(o.startTime)):e.startTime,endTime:o.endTime?JSON.parse(JSON.stringify(o.endTime)):e.endTime,isOvernightForced:o.isOvernightForced||n||!1}:e})),[y,b]=(0,a.useState)(null);(0,a.useEffect)((()=>{if(!o)return;(0,p.debugLog)("MBAoi9uv43d: NewTimeRangeSelector (".concat(l,") initialTimes update:"),o);const e={startTime:o.startTime?JSON.parse(JSON.stringify(o.startTime)):g.startTime,endTime:o.endTime?JSON.parse(JSON.stringify(o.endTime)):g.endTime,isOvernightForced:o.isOvernightForced||n||g.isOvernightForced};h(e)}),[o?.startTime?.hours,o?.startTime?.minutes,o?.endTime?.hours,o?.endTime?.minutes,o?.isOvernightForced,n]),(0,a.useEffect)((()=>()=>{}),[y]);const x=e=>{if(!e)return"";const t=e.hours,o=e.minutes,a=t>=12?"PM":"AM";return"".concat(t%12===0?12:t%12,":").concat(o.toString().padStart(2,"0")," ").concat(a)},j=e=>{if(!e)return"";try{return new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}catch(t){return(0,p.debugLog)("MBAoi9uv43d: Error formatting date: ".concat(t.message)),""}},w=(()=>{if(d&&d.startDate)return d.startDate;if(c&&c.length>0){return[...c].sort(((e,t)=>new Date(e)-new Date(t)))[0]}return null})(),C=(()=>{if(d&&d.endDate)return d.endDate;if(c&&c.length>0){const e=[...c].sort(((e,t)=>new Date(e)-new Date(t)));return e[e.length-1]}return null})();return(0,T.jsxs)(r.default,{style:_a.container,children:[e&&(0,T.jsx)(i.default,{style:_a.title,children:e}),(0,T.jsxs)(r.default,{style:_a.timeSelectionContainer,children:[(0,T.jsxs)(r.default,{style:_a.timePickerContainer,children:[w&&(u||g.isOvernightForced||n)?(0,T.jsx)(i.default,{style:_a.dateLabel,children:j(w)}):(0,T.jsx)(i.default,{style:_a.dateLabel,children:"Applies to all individual days"}),(0,T.jsx)(i.default,{style:_a.timeLabel,children:"Start Time"}),(0,T.jsx)(s.default,{style:_a.timeButton,onPress:()=>b("start"===y?null:"start"),children:(0,T.jsxs)(r.default,{style:_a.timeButtonContent,children:[(0,T.jsx)(ee.default,{name:"access-time",size:18,color:f.theme.colors.mainColors.main}),(0,T.jsx)(i.default,{style:_a.timeText,children:x(g.startTime)}),(0,T.jsx)(ee.default,{name:"start"===y?"keyboard-arrow-up":"keyboard-arrow-down",size:20,color:f.theme.colors.text})]})})]}),(0,T.jsxs)(r.default,{style:_a.timePickerContainer,children:[C&&(u||g.isOvernightForced||n)?(0,T.jsx)(i.default,{style:_a.dateLabel,children:j(C)}):(0,T.jsx)(i.default,{style:_a.dateLabel,children:"Applies to all individual days"}),(0,T.jsx)(i.default,{style:_a.timeLabel,children:"End Time"}),(0,T.jsx)(s.default,{style:_a.timeButton,onPress:()=>b("end"===y?null:"end"),children:(0,T.jsxs)(r.default,{style:_a.timeButtonContent,children:[(0,T.jsx)(ee.default,{name:"access-time",size:18,color:f.theme.colors.mainColors.main}),(0,T.jsx)(i.default,{style:_a.timeText,children:x(g.endTime)}),(0,T.jsx)(ee.default,{name:"end"===y?"keyboard-arrow-up":"keyboard-arrow-down",size:20,color:f.theme.colors.text})]})})]})]}),(0,T.jsxs)(r.default,{style:_a.durationContainer,children:[(0,T.jsx)(ee.default,{name:"timelapse",size:18,color:f.theme.colors.mainColors.main}),(0,T.jsxs)(i.default,{style:_a.durationText,children:["Duration: ",(()=>{const{isOvernightForced:e}=g;if((e||n)&&(d||c&&c.length>0)){let e,t;if(d&&d.startDate&&d.endDate)e=new Date(d.startDate),t=new Date(d.endDate);else{if(!(c&&c.length>=2))return c&&1===c.length?"Same day":"1 night";{const o=[...c].sort(((e,t)=>new Date(e)-new Date(t)));e=new Date(o[0]),t=new Date(o[o.length-1])}}Math.abs(t-e);let o;const a=new Date(e.getFullYear(),e.getMonth(),e.getDate()),n=new Date(t.getFullYear(),t.getMonth(),t.getDate());o=Math.round(Math.abs(n-a)/864e5)+1;const r=o>1?o-1:0;return 0===r?"Same day":1===r?"1 night":"".concat(r," nights")}const{startTime:t,endTime:o}=g,a=60*t.hours+t.minutes;let r=60*o.hours+o.minutes;0===o.hours&&0===o.minutes&&(r=1440);let i=r-a;i<0&&(0!==o.hours||0!==o.minutes)&&(i+=1440);const s=Math.floor(i/60),l=i%60;let u="";return s>0&&(u+="".concat(s," hour").concat(1!==s?"s":"")),l>0&&(u.length>0&&(u+=" "),u+="".concat(l," minute").concat(1!==l?"s":"")),u||"0 minutes"})()]})]}),y&&(0,T.jsx)(_.default,{transparent:!0,animationType:"none",visible:!!y,onRequestClose:()=>b(null),children:(0,T.jsx)(Qe.default,{onPress:()=>b(null),children:(0,T.jsx)(r.default,{style:_a.modalOverlay,children:(0,T.jsx)(Qe.default,{children:(0,T.jsx)(r.default,{style:[_a.modalContent,"start"===y?_a.startModalContent:_a.endModalContent],children:(0,T.jsx)(ka,{initialTime:"start"===y?g.startTime:g.endTime,onTimeSelect:"start"===y?e=>{const o=0===g.endTime.hours&&0===g.endTime.minutes,a=60*e.hours+e.minutes,n=60*g.endTime.hours+g.endTime.minutes;if(!(o||a<n))return(0,p.debugLog)("MBAoi9uv43d: NewTimeRangeSelector (".concat(l,") invalid start time - would be after end time:"),{attemptedStart:e,currentEnd:g.endTime,startMinutes:a,endMinutes:n}),!1;const r=Object.assign({},g,{startTime:JSON.parse(JSON.stringify(e))});return h(r),t(r),(0,p.debugLog)("MBAoi9uv43d: NewTimeRangeSelector (".concat(l,") startTime changed:"),{newTime:e,updatedTimes:r}),!0}:e=>{const o=0===e.hours&&0===e.minutes,a=60*g.startTime.hours+g.startTime.minutes,n=60*e.hours+e.minutes;if(!(o||n>a))return(0,p.debugLog)("MBAoi9uv43d: NewTimeRangeSelector (".concat(l,") invalid end time - would be before start time:"),{currentStart:g.startTime,attemptedEnd:e,startMinutes:a,endMinutes:n}),!1;const r=Object.assign({},g,{endTime:JSON.parse(JSON.stringify(e))});return h(r),t(r),(0,p.debugLog)("MBAoi9uv43d: NewTimeRangeSelector (".concat(l,") endTime changed:"),{newTime:e,updatedTimes:r}),!0},isOpen:!0,onClose:()=>b(null),uniqueId:"".concat(l,"-").concat(y),showInlinePicker:!0})})})})})})]})},Ia=l.default.create({container:{marginBottom:16,borderWidth:1,borderColor:f.theme.colors.modernBorder,borderRadius:8,backgroundColor:f.theme.colors.surface,overflow:"visible"},dateLabel:{fontSize:f.theme.fontSizes.medium,fontFamily:f.theme.fonts.medium.fontFamily,color:f.theme.colors.text,backgroundColor:f.theme.colors.bgColorModern,padding:12,borderBottomWidth:1,borderBottomColor:f.theme.colors.modernBorder}}),Da=({date:e,initialTimes:t={},onTimeChange:o,is_overnight:n=!1})=>{const{is_DEBUG:s}=(0,a.useContext)(p.AuthContext),l=(()=>{if(!e)return"day-unknown";try{if(e instanceof Date)return"day-".concat(e.toISOString().split("T")[0]);if("string"===typeof e&&e.match(/^\d{4}-\d{2}-\d{2}$/))return"day-".concat(e);const t=new Date(e);return isNaN(t.getTime())?"day-unknown-".concat(Date.now()):"day-".concat(t.toISOString().split("T")[0])}catch(t){return(0,p.debugLog)("MBAoi9uv43d: Error generating unique ID for date:",t),"day-unknown-".concat(Date.now())}})(),d=(()=>{if(!e)return null;try{if(e instanceof Date)return e.toISOString().split("T")[0];if("string"===typeof e&&e.match(/^\d{4}-\d{2}-\d{2}$/))return e;const t=new Date(e);return isNaN(t.getTime())?((0,p.debugLog)("MBAoi9uv43d: Could not parse date:",e),null):t.toISOString().split("T")[0]}catch(t){return(0,p.debugLog)("MBAoi9uv43d: Error generating date key:",t),null}})();return(0,T.jsxs)(r.default,{style:Ia.container,children:[(0,T.jsx)(i.default,{style:Ia.dateLabel,children:(e=>{if(!e)return"";return new Date(e).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})})(e)}),(0,T.jsx)(Aa,{onTimeSelect:e=>{if(!d)return void(0,p.debugLog)("MBAoi9uv43d: Cannot handle time selection - invalid date key");const t=JSON.parse(JSON.stringify(e));(0,p.debugLog)("MBAoi9uv43d: DayTimeSelector (".concat(l,") time changed:"),{dateKey:d,timesData:t}),o(t,d)},initialTimes:t,is_overnight:n,uniqueId:l,selectedDates:[e],isIndividualDaySelector:!0})]})},Ma=e=>{if(!e)return null;if("string"===typeof e&&e.includes(":")){const[t,o]=e.split(":").map((e=>parseInt(e,10)));return{hours:t,minutes:o}}return"object"!==typeof e||null===e||void 0===e.hours&&void 0===e.minutes?null:{hours:e.hours||0,minutes:e.minutes||0}},Ra=l.default.create({container:{flex:1,padding:16},card:{backgroundColor:f.theme.colors.background,borderRadius:12},customizeButtonContainer:{marginBottom:24,paddingHorizontal:16},customizeButton:{flexDirection:"row",alignItems:"center",justifyContent:"center",gap:8,paddingVertical:12,paddingHorizontal:16,borderRadius:8,borderWidth:1,borderColor:f.theme.colors.mainColors.main},customizeButtonText:{color:f.theme.colors.mainColors.main,fontSize:f.theme.fontSizes.medium,fontFamily:f.theme.fonts.regular.fontFamily,textAlign:"center"},individualDaysContainer:{gap:12,marginBottom:16},sectionHeader:{fontSize:f.theme.fontSizes.medium,fontFamily:f.theme.fonts.regular.fontFamily,color:f.theme.colors.text,marginBottom:12,paddingHorizontal:16}}),Pa=({onTimeSelect:e,initialTimes:t={},dateRange:o=null,selectedService:n=null,isOvernightForced:l=!1})=>{const{is_DEBUG:d}=(0,a.useContext)(p.AuthContext),[c,u]=(0,a.useState)((()=>{if(n?.is_overnight||l)return!1;const e=t&&!0===t.hasIndividualTimes;return(0,p.debugLog)("MBAoi9uv43d: Initial showIndividualDays value:",e),e})),[m,g]=(0,a.useState)({}),[h,y]=(0,a.useState)((()=>{try{return t&&"object"===typeof t?t:((0,p.debugLog)("MBAoi9uv43d: Invalid initialTimes, using defaults:",t),{startTime:{hours:9,minutes:0},endTime:{hours:17,minutes:0},isOvernightForced:!1})}catch(e){return(0,p.debugLog)("MBAoi9uv43d: Error initializing times:",e),{startTime:{hours:9,minutes:0},endTime:{hours:17,minutes:0},isOvernightForced:!1}}})),b=(0,a.useRef)(!0);(0,a.useEffect)((()=>{(0,p.debugLog)("MBAoi9uv43d: TimeSelectionCard received initialTimes:",t);try{if(!t||"object"!==typeof t){const e={startTime:{hours:9,minutes:0},endTime:{hours:17,minutes:0},isOvernightForced:n?.is_overnight||!1};return(0,p.debugLog)("MBAoi9uv43d: Using default times:",e),y(e),void u(!1)}const e=!0===t.hasIndividualTimes;(0,p.debugLog)("MBAoi9uv43d: hasIndividualTimes flag is",e),b.current?((0,p.debugLog)("MBAoi9uv43d: Initial render - setting showIndividualDays to",e),u(e),b.current=!1):(0,p.debugLog)("MBAoi9uv43d: Not initial render - preserving showIndividualDays state");const a=Ma(t.startTime),r={startTime:a||{hours:9,minutes:0},endTime:Ma(t.endTime)||{hours:17,minutes:0},isOvernightForced:t.isOvernightForced||n?.is_overnight||!1};(0,p.debugLog)("MBAoi9uv43d: Setting formatted times:",r),y(r);const i=t&&Object.keys(t).some((e=>e.match(/^\d{4}-\d{2}-\d{2}$/)));if((0,p.debugLog)("MBAoi9uv43d: Time selection setup:",{hasDatesInDraft:i,hasIndividualTimesFlag:e,hasDateRange:!!(o&&o.startDate&&o.endDate),hasDates:!!(t&&t.dates&&t.dates.length>0)}),o&&o.startDate&&o.endDate||i){const a={};if(o&&o.startDate&&o.endDate){const e=new Date(o.startDate),t=new Date(o.endDate),n=new Date(e);for(;n<=t;){const e=n.toISOString().split("T")[0];a[e]=JSON.parse(JSON.stringify(r)),n.setDate(n.getDate()+1)}}t.dates&&t.dates.length>0&&!o&&((0,p.debugLog)("MBAoi9uv43d: Creating time ranges from multiple days selection"),t.dates.forEach((e=>{let t;t="string"===typeof e?new Date(e):e&&e.date?new Date(e.date):new Date(e);const o=t.toISOString().split("T")[0];a[o]||(a[o]=JSON.parse(JSON.stringify(r)))}))),(e||i)&&Object.keys(t).forEach((e=>{if(e.match(/^\d{4}-\d{2}-\d{2}$/)&&t[e]){const o=t[e],n=Ma(o.startTime),r=Ma(o.endTime);(n||r)&&(a[e]={startTime:n||{hours:9,minutes:0},endTime:r||{hours:17,minutes:0},isOvernightForced:o.isOvernightForced||!1})}})),t.individualTimeRanges&&Object.keys(t.individualTimeRanges).forEach((e=>{if(e.match(/^\d{4}-\d{2}-\d{2}$/)){const o=t.individualTimeRanges[e],n=Ma(o.startTime),r=Ma(o.endTime);(n||r)&&(a[e]={startTime:n||{hours:9,minutes:0},endTime:r||{hours:17,minutes:0},isOvernightForced:o.isOvernightForced||!1})}})),(0,p.debugLog)("MBAoi9uv43d: Setting individual time ranges:",a),g(a)}}catch(e){(0,p.debugLog)("MBAoi9uv43d: Error processing initialTimes:",e),y({startTime:{hours:9,minutes:0},endTime:{hours:17,minutes:0},isOvernightForced:n?.is_overnight||!1})}}),[t,o,n]);const x=(o,a)=>{if((0,p.debugLog)("MBAoi9uv43d: Individual day time selection for card:",{dateKey:a,timesData:o}),!a)return void(0,p.debugLog)("MBAoi9uv43d: No dateKey provided, returning");const n=JSON.parse(JSON.stringify(m));n[a]=JSON.parse(JSON.stringify(o)),(0,p.debugLog)("MBAoi9uv43d: TimeSelectionCard updating only date:",a),(0,p.debugLog)("MBAoi9uv43d: Current individualTimeRanges keys:",Object.keys(m)),(0,p.debugLog)("MBAoi9uv43d: New updatedRanges keys:",Object.keys(n)),g(n);const r={};Object.keys(n).forEach((e=>{const t=n[e];r[e]={startTime:"".concat(String(t.startTime.hours).padStart(2,"0"),":").concat(String(t.startTime.minutes).padStart(2,"0")),endTime:"".concat(String(t.endTime.hours).padStart(2,"0"),":").concat(String(t.endTime.minutes).padStart(2,"0")),isOvernightForced:!!t.isOvernightForced}}));const i={startTime:JSON.parse(JSON.stringify(h.startTime)),endTime:JSON.parse(JSON.stringify(h.endTime)),isOvernightForced:h.isOvernightForced,hasIndividualTimes:!0,dates:t.dates?[...t.dates]:[],individualTimeRanges:r};i[a]=r[a],(0,p.debugLog)("MBAoi9uv43d: TimeSelectionCard sending updated data to parent"),e(i)};return(0,T.jsx)(r.default,{style:Ra.container,children:(0,T.jsxs)(r.default,{style:Ra.card,children:[!c&&(0,T.jsx)(Aa,{onTimeSelect:t=>{(0,p.debugLog)("MBAoi9uv43d: handleDefaultTimeSelect called with:",t);const o=JSON.parse(JSON.stringify(t));if(y(o),c){const t={};Object.keys(m).forEach((e=>{t[e]={startTime:o.startTime,endTime:o.endTime,isOvernightForced:o.isOvernightForced}})),g(t),e(Object.assign({},o,t,{hasIndividualTimes:!0}))}else e(Object.assign({},o,{hasIndividualTimes:!1}))},initialTimes:h,is_overnight:n?.is_overnight||h.isOvernightForced||l||!1,uniqueId:"default-time-range",dateRange:o,selectedDates:t.dates||[]}),!n?.is_overnight&&!l&&(0,T.jsx)(r.default,{style:Ra.customizeButtonContainer,children:(0,T.jsxs)(s.default,{style:Ra.customizeButton,onPress:()=>{if((0,p.debugLog)("MBAoi9uv43d: TOGGLE button pressed"),(0,p.debugLog)("MBAoi9uv43d: Current showIndividualDays state:",c),c){(0,p.debugLog)("MBAoi9uv43d: Switching FROM individual days TO default time range"),u(!1);const o={startTime:h.startTime,endTime:h.endTime,isOvernightForced:h.isOvernightForced,hasIndividualTimes:!1,dates:t.dates||[]};(0,p.debugLog)("MBAoi9uv43d: Sending default time data to parent:",o),e(o)}else{(0,p.debugLog)("MBAoi9uv43d: Switching FROM default time range TO individual days"),u(!0);let a={};if(t&&t.dates&&t.dates.length>0)(0,p.debugLog)("MBAoi9uv43d: Creating time ranges for multiple individual dates"),t.dates.forEach((e=>{let t;t="string"===typeof e?new Date(e):e&&e.date?new Date(e.date):new Date(e);const o=t.toISOString().split("T")[0];a[o]={startTime:JSON.parse(JSON.stringify(h.startTime)),endTime:JSON.parse(JSON.stringify(h.endTime)),isOvernightForced:h.isOvernightForced}}));else if(o&&o.startDate&&o.endDate){(0,p.debugLog)("MBAoi9uv43d: Creating time ranges from dateRange");const e=new Date(o.startDate),t=new Date(o.endDate),n=new Date(e);for(;n<=t;){const e=n.toISOString().split("T")[0];a[e]={startTime:JSON.parse(JSON.stringify(h.startTime)),endTime:JSON.parse(JSON.stringify(h.endTime)),isOvernightForced:h.isOvernightForced},n.setDate(n.getDate()+1)}}else Object.keys(m).length>0&&(a=JSON.parse(JSON.stringify(m)));(0,p.debugLog)("MBAoi9uv43d: Setting individual time ranges:",a),g(a),e(Object.assign({},h,a,{hasIndividualTimes:!0}))}},activeOpacity:.7,children:[(0,T.jsx)(ee.default,{name:"schedule",size:20,color:f.theme.colors.mainColors.main}),(0,T.jsx)(i.default,{style:Ra.customizeButtonText,children:c?"Set Default Time Range":"Customize Individual Day Schedules"})]})}),c&&!n?.is_overnight&&!l&&(0,T.jsxs)(r.default,{style:Ra.individualDaysContainer,children:[(0,T.jsx)(i.default,{style:Ra.sectionHeader,children:"Individual Day Schedules"}),(0,T.jsx)(H.default,{children:(()=>{let e=[];if(t&&t.dates&&t.dates.length>0)(0,p.debugLog)("MBAoi9uv43d: Using multiple individual dates from initialTimes:",t.dates),e=t.dates.map((e=>"string"===typeof e?new Date(e):e&&e.date?new Date(e.date):new Date(e)));else if(o&&o.startDate&&o.endDate){(0,p.debugLog)("MBAoi9uv43d: Generating dates from dateRange:",o);const t=new Date(o.startDate),a=new Date(o.endDate),n=new Date(t);for(;n<=a;)e.push(new Date(n)),n.setDate(n.getDate()+1)}return e})().map(((e,o)=>{const a=e.toISOString().split("T")[0];let r;if(t&&t[a]){const e=Ma(t[a].startTime),o=Ma(t[a].endTime);r={startTime:e||JSON.parse(JSON.stringify(h.startTime)),endTime:o||JSON.parse(JSON.stringify(h.endTime)),isOvernightForced:!!t[a].isOvernightForced},(0,p.debugLog)("MBAoi9uv43d: Found specific time data for date ".concat(a," in initialTimes"))}else m&&m[a]?(r=JSON.parse(JSON.stringify(m[a])),(0,p.debugLog)("MBAoi9uv43d: Using time from individualTimeRanges for date ".concat(a))):(r={startTime:JSON.parse(JSON.stringify(h.startTime)),endTime:JSON.parse(JSON.stringify(h.endTime)),isOvernightForced:h.isOvernightForced},(0,p.debugLog)("MBAoi9uv43d: Using default times for date ".concat(a)));return(0,T.jsx)(Da,{date:e,initialTimes:r,onTimeChange:x,is_overnight:n?.is_overnight||!1},"day-".concat(a))}))})]})]})})},za={SERVICES_AND_PETS:{id:0,name:"Services & Pets"},DATE_SELECTION:{id:1,name:"Date Selection"},TIME_SELECTION:{id:2,name:"Time Selection"},REVIEW_AND_RATES:{id:3,name:"Review & Rates"}},Fa=l.default.create({modalOverlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center",width:"100%"},modalContent:{width:"95%",maxWidth:"web"===n.default.OS?600:"100%",maxHeight:"90%",backgroundColor:f.theme.colors.background,borderRadius:12,overflow:"hidden",display:"flex",flexDirection:"column"},stepIndicatorContainer:{width:"100%",paddingVertical:12,backgroundColor:f.theme.colors.background,borderBottomWidth:1,borderBottomColor:f.theme.colors.modernBorder},scrollContent:{flex:1},scrollContentContainer:{flexGrow:1},content:{flex:1,backgroundColor:f.theme.colors.background},footer:{flexDirection:"row",padding:16,justifyContent:"space-between",alignItems:"center",backgroundColor:f.theme.colors.background,borderTopWidth:1,borderTopColor:f.theme.colors.modernBorder},spacer:{width:16,flexGrow:1},smallMargin:{width:8},backButton:{minWidth:100,backgroundColor:f.theme.colors.surface,paddingVertical:12,paddingHorizontal:16,borderRadius:8,alignItems:"center",borderWidth:1,borderColor:f.theme.colors.border},smallScreenButton:{minWidth:80,paddingVertical:8,paddingHorizontal:10},backButtonText:{color:f.theme.colors.text,fontSize:16,fontFamily:f.theme.fonts.regular.fontFamily},cancelButton:{flex:1,backgroundColor:f.theme.colors.surface,paddingVertical:12,borderRadius:8,alignItems:"center",borderWidth:1,borderColor:f.theme.colors.border},cancelButtonSmall:{minWidth:100,backgroundColor:f.theme.colors.surface,paddingVertical:12,paddingHorizontal:16,borderRadius:8,alignItems:"center",borderWidth:1,borderColor:f.theme.colors.border},cancelButtonText:{color:f.theme.colors.text,fontSize:16,fontFamily:f.theme.fonts.regular.fontFamily},nextButton:{flex:1,backgroundColor:f.theme.colors.mainColors.main,paddingVertical:12,borderRadius:8,alignItems:"center"},nextButtonSmall:{minWidth:100,backgroundColor:f.theme.colors.mainColors.main,paddingVertical:12,paddingHorizontal:16,borderRadius:8,alignItems:"center"},disabledButton:{backgroundColor:f.theme.colors.placeHolderText},nextButtonText:{color:f.theme.colors.surface,fontSize:16,fontFamily:f.theme.fonts.regular.fontFamily,fontWeight:"600"},disabledButtonText:{color:f.theme.colors.surface},errorText:{color:f.theme.colors.error,textAlign:"center",marginBottom:16,fontFamily:f.theme.fonts.regular.fontFamily},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:16},loadingText:{color:f.theme.colors.text,fontSize:16,fontFamily:f.theme.fonts.regular.fontFamily},stepContent:{flex:1,backgroundColor:f.theme.colors.background},divider:{height:1,backgroundColor:f.theme.colors.modernBorder,marginVertical:16},errorContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:16},confirmButtonColumn:{flexDirection:"column",alignItems:"center",justifyContent:"center"}}),La=({visible:e,onClose:t,bookingId:o,onComplete:n,initialData:l={},navigation:d})=>{const{is_DEBUG:c,screenWidth:u,timeSettings:m}=(0,a.useContext)(p.AuthContext),g=u<600,[h,f]=(0,a.useState)(za.SERVICES_AND_PETS.id),[y,b]=(0,a.useState)({service:l.service||null,pets:l.pets||[],dates:l.dates||[],bookingType:l.bookingType||"one-time",dateRangeType:l.dateRangeType||"date-range",times:l.times||{startTime:"09:00",endTime:"17:00",isOvernightForced:!1,hasIndividualTimes:!1},rates:l.rates||{},dateSelectionData:null,dateRange:null,hasFetchedDates:!1}),[x,j]=(0,a.useState)(null),[w,C]=(0,a.useState)(!1);(0,a.useEffect)((()=>{(0,p.debugLog)("MBA12345 Initial data received:",l),(0,p.debugLog)("MBA12345 Initial booking data state:",y)}),[l]),(0,a.useEffect)((()=>{(async()=>{if(o&&e)if(y.hasFetchedDates)(0,p.debugLog)("MBA2j3kbr9hve4: Skipping fetch as hasFetchedDates is true");else try{C(!0),j(null),(0,p.debugLog)("MBA2j3kbr9hve4: Fetching draft dates and times for booking ID:",o);const e=await(0,at.getBookingDraftDatesAndTimes)(o);if((0,p.debugLog)("MBA2j3kbr9hve4: Received draft dates and times:",e),e){const o=(0,ro.parseOccurrencesForBookingSteps)(e.occurrences||[]);(0,p.debugLog)("MBA2j3kbr9hve4: Parsed draft dates and times:",o);const a=(e.service_details?.service_type||"").toLowerCase(),n=["overnight","boarding","house sitting","pet sitting"],r=!0===e.service_details?.is_overnight||n.some((e=>a.includes(e)));(0,p.debugLog)("MBA2j3kbr9hve4: Is overnight service from response:",r),(0,p.debugLog)("MBA2j3kbr9hve4: Service name:",a),(0,p.debugLog)("MBA2j3kbr9hve4: Known overnight terms match:",n.some((e=>a.includes(e)))),(0,p.debugLog)("MBA2j3kbr9hve4: Full service details from response:",e.service_details);let i=null;if(e.service_details&&(i=Object.assign({},e.service_details,{service_id:e.service_details.service_id,service_name:e.service_details.service_type,is_overnight:r}),(0,p.debugLog)("MBA2j3kbr9hve4: Setting service data with overnight status:",i)),e.occurrences&&e.occurrences.length>0){const t=e.occurrences[0],o=e.occurrences[e.occurrences.length-1];if(t.start_date!==o.end_date){const e=new Date(t.start_date),a=new Date(o.end_date),n=Math.ceil((a-e)/864e5);n>=1&&((0,p.debugLog)("MBA2j3kbr9hve4: DETECTED OVERNIGHT from date range:",{startDate:t.start_date,endDate:o.end_date,daysDifference:n}),i&&(i.is_overnight=!0))}}if(2===e.occurrences?.length)try{const t=new Date(e.occurrences[0].start_date),o=new Date(e.occurrences[1].start_date),a=Math.abs(Math.round((o-t)/864e5));a>1&&((0,p.debugLog)("MBA2j3kbr9hve4: DETECTED POTENTIAL OVERNIGHT from date distance:",{date1:e.occurrences[0].start_date,date2:e.occurrences[1].start_date,daysBetween:a}),i&&(i.is_overnight=!0))}catch(t){(0,p.debugLog)("MBA2j3kbr9hve4: Error checking occ dates:",t)}let s=e.date_range_type||"date-range";r||i&&i.is_overnight?(s="date-range",(0,p.debugLog)("MBA2j3kbr9hve4: Forcing date-range type for overnight service")):o.dates&&o.dates.length>1&&!o.dateRange&&(s="multiple-days",(0,p.debugLog)("MBA2j3kbr9hve4: Non-consecutive dates detected, forcing multiple-days mode"));const l=r||i&&i.is_overnight;(0,p.debugLog)("MBA2j3kbr9hve4: Final overnight determination:",{initialCheck:r,afterOccurrenceChecks:i?.is_overnight,finalIsOvernightForced:l}),b((t=>Object.assign({},t,{dates:o.dates||[],dateRange:o.dateRange,times:Object.assign({},o.defaultTimes||{},o.individualTimes,{individualTimeRanges:o.individualTimes||{},allTimesAreTheSame:o.allTimesAreTheSame,hasIndividualTimes:!o.allTimesAreTheSame,isOvernightForced:l}),dateRangeType:s,bookingType:e.booking_type||t.bookingType||"one-time",hasFetchedDates:!0,service:i||t.service})))}}catch(x){(0,p.debugLog)("MBA2j3kbr9hve4: Error fetching draft dates and times:",x),h>za.SERVICES_AND_PETS.id?j("Failed to load booking details. Please try again."):(0,p.debugLog)("MBA2j3kbr9hve4: Suppressing error on first step:",x.message)}finally{C(!1)}})()}),[o,e,h,y.hasFetchedDates]),(0,a.useEffect)((()=>{(y.service?.is_overnight||y.times?.isOvernightForced)&&((0,p.debugLog)("MBA2j3kbr9hve4: Detected overnight service, ensuring dateRangeType is date-range"),"date-range"!==y.dateRangeType&&((0,p.debugLog)("MBA2j3kbr9hve4: Updating dateRangeType from",y.dateRangeType,"to date-range"),b((e=>Object.assign({},e,{dateRangeType:"date-range"})))))}),[y.service,y.times?.isOvernightForced]);const v=e=>{(0,p.debugLog)("MBA12345 Selected service:",e);const t=(e?.service_name||"").toLowerCase(),o=["overnight","boarding","house sitting","pet sitting"],a=!0===e?.is_overnight||o.some((e=>t.includes(e)));(0,p.debugLog)("MBA2j3kbr9hve4: Service overnight status:",{isOvernight:a,serviceData:e,serviceName:t,matchesOvernightTerms:o.some((e=>t.includes(e)))}),b((t=>{const o=Object.assign({},t.times||{},{isOvernightForced:a});(0,p.debugLog)("MBA2j3kbr9hve4: Updated times with overnight status:",o);const n=Object.assign({},e,{is_overnight:a});return Object.assign({},t,{service:n,times:o,dateRangeType:a?"date-range":t.dateRangeType})}))},S=e=>{(0,p.debugLog)("MBA12345 Selected/deselected pet:",e);const t=y.pets.find((t=>t.pet_id===e.pet_id))?y.pets.filter((t=>t.pet_id!==e.pet_id)):[...y.pets,e];b((e=>Object.assign({},e,{pets:t})))},B=e=>{(0,p.debugLog)("MBA12345 Selected dates:",e),(0,p.debugLog)("MBA2j3kbr9hve4: CRITICAL handleDateSelect rangeType:",{rangeType:e.rangeType,currentDateRangeType:y.dateRangeType,isServiceOvernight:y.service?.is_overnight,isTimesOvernightForced:y.times?.isOvernightForced}),b((t=>{let o=t.dateRange;return"date-range"===e.rangeType&&e.startDate&&e.endDate?o={startDate:e.startDate,endDate:e.endDate}:"multiple-days"===e.rangeType?o=t.dateRange:e.dates&&0!==e.dates.length||(o=null),Object.assign({},t,{dates:e.dates||[],dateSelectionData:e,dateRange:o,dateRangeType:e.rangeType||t.dateRangeType})}))},k=e=>{(0,p.debugLog)("MBAoi1h34ghnvo: TimeSelectionCard sent time data:",e);y.service;b((t=>{if(e.hasIndividualTimes){(0,p.debugLog)("MBAoi1h34ghnvo: Processing individual times");const o=Object.assign({},t.times,{hasIndividualTimes:!0,isOvernightForced:e.isOvernightForced,dates:e.dates||t.times.dates||[],individualTimeRanges:e.individualTimeRanges||{}});return Object.keys(e).forEach((t=>{t.match(/^\d{4}-\d{2}-\d{2}$/)&&((0,p.debugLog)("MBAoi1h34ghnvo: Processing date key:",t,e[t]),o[t]={startTime:e[t].startTime,endTime:e[t].endTime,isOvernightForced:e[t].isOvernightForced})})),(0,p.debugLog)("MBAoi1h34ghnvo: Final individual times object:",o),Object.assign({},t,{times:o})}{(0,p.debugLog)("MBAoi1h34ghnvo: Using default time range mode");const o=Object.assign({},t.times,{startTime:e.startTime?"".concat(String(e.startTime.hours).padStart(2,"0"),":").concat(String(e.startTime.minutes||0).padStart(2,"0")):t.times.startTime,endTime:e.endTime?"".concat(String(e.endTime.hours).padStart(2,"0"),":").concat(String(e.endTime.minutes||0).padStart(2,"0")):t.times.endTime,isOvernightForced:e.isOvernightForced,hasIndividualTimes:!1,dates:e.dates||t.times.dates||[]});return(0,p.debugLog)("MBAoi1h34ghnvo: Updated default times:",o),Object.assign({},t,{times:o})}}))},A=()=>{switch(h){case za.SERVICES_AND_PETS.id:return y.service&&y.pets.length>0;case za.DATE_SELECTION.id:return!(!y.dateSelectionData||!y.dateSelectionData.isValid)||(!!(y.dates&&y.dates.length>0)||!!(y.dateRange&&y.dateRange.startDate&&y.dateRange.endDate));case za.TIME_SELECTION.id:case za.REVIEW_AND_RATES.id:return!0;default:return!1}},I=async()=>{if(A())if(j(null),(0,p.debugLog)("MBA2j3kbr9hve4: Moving to next step:",{currentStep:h,nextStep:h+1,hasValidDates:y.dates&&y.dates.length>0,hasValidDateRange:y.dateRange&&y.dateRange.startDate&&y.dateRange.endDate,hasValidDateSelectionData:y.dateSelectionData&&y.dateSelectionData.isValid,dateRangeType:y.dateRangeType,bookingType:y.bookingType}),h<za.REVIEW_AND_RATES.id){if(h===za.SERVICES_AND_PETS.id)try{(0,p.debugLog)("MBA2j3kbr9hve4: Updating booking draft with service and pets"),await(0,at.updateBookingDraftPetsAndServices)(o,{service_id:y.service?.service_id,pets:y.pets}),(0,p.debugLog)("MBA2j3kbr9hve4: Successfully updated booking draft with service and pets"),b((e=>Object.assign({},e,{hasFetchedDates:!1})))}catch(x){return(0,p.debugLog)("MBA2j3kbr9hve4: Error updating booking draft:",x),void j("Failed to save service and pet selections")}if(h===za.TIME_SELECTION.id)try{(0,p.debugLog)("MBA5asdt3f4321 Original booking data:",y);const t=!0===y.service?.is_overnight,a=!0===y.times?.isOvernightForced,n=t||a;if((0,p.debugLog)("MBA5asdt3f4321 DIRECT OVERNIGHT CHECK AT START:",{isServiceOvernightFlag:t,isTimeOvernightFlag:a,isAnyOvernightFlag:n,dateRangeType:y.dateRangeType}),n&&y.dateRange){(0,p.debugLog)("MBA53212co2v3nvoub5 DIRECT OVERRIDE: Forcing overnight mode for any overnight service");const e=(0,ro.formatDateForAPI)(y.dateRange.startDate),t=(0,ro.formatDateForAPI)(y.dateRange.endDate),a=(0,ro.formatTimeForAPI)(y.times.startTime),n=(0,ro.formatTimeForAPI)(y.times.endTime);(0,p.debugLog)("MBA53212co2v3nvoub5 DIRECT OVERRIDE: Using time-and-date endpoint with dates:",{startDate:e,endDate:t,startTime:a,endTime:n});const r=m?.timezone||"US/Mountain";(0,p.debugLog)("MBA53212co2v3nvoub5 Using user timezone for UTC conversion:",r);const{date:i,time:s}=(0,ro.convertToUTC)(e,a,r),{date:l,time:d}=(0,ro.convertToUTC)(t,n,r),c=await(0,at.updateBookingDraftTimeAndDate)(o,i,l,s,d);return(0,p.debugLog)("MBA53212co2v3nvoub5 DIRECT OVERRIDE: Response from updateBookingDraftTimeAndDate:",c),c?.draft_data&&b((e=>Object.assign({},e,c.draft_data,{times:Object.assign({},c.draft_data.times||e.times,{isOvernightForced:!0}),service:Object.assign({},c.draft_data.service||e.service,{is_overnight:!0}),dateRangeType:"date-range"}))),void f((e=>e+1))}if("date-range"===y.dateRangeType){const t=!0===y.service?.is_overnight,a=!0===y.times?.isOvernightForced&&!("00:00"===y.times.endTime&&!t);let n=!1;if(y.dateRange&&y.dateRange.startDate&&y.dateRange.endDate)try{const e=new Date(y.dateRange.startDate),t=new Date(y.dateRange.endDate),o=Math.ceil((t-e)/864e5);o>1&&(n=!0,(0,p.debugLog)("MBA53212co2v3nvoub5 DETECTED multi-day date range:",{startDate:y.dateRange.startDate,endDate:y.dateRange.endDate,daysDifference:o}))}catch(e){(0,p.debugLog)("MBA53212co2v3nvoub5 Error checking date range:",e)}if((0,p.debugLog)("MBA53212co2v3nvoub5 CRITICAL Checking overnight status:",{dateRangeType:y.dateRangeType,serviceIsOvernight:t,timesIsOvernightForced:y.times?.isOvernightForced,endTime:y.times?.endTime,endTimeIsMidnight:"00:00"===y.times?.endTime,isMidnightEndTimeButNotForced:"00:00"===y.times?.endTime&&!t,isTimeOvernight:a,isMultiDayRange:n,service:y.service,times:y.times}),t||a||n){const e=Object.assign({},y,{service:Object.assign({},y.service,{is_overnight:!0}),times:Object.assign({},y.times,{isOvernightForced:!0})});b(e),(0,p.debugLog)("MBA53212co2v3nvoub5 OVERRIDE: Forcing overnight mode for date range due to overnight service or flag");const t=(0,ro.formatDateForAPI)(y.dateRange.startDate),a=(0,ro.formatDateForAPI)(y.dateRange.endDate),n=(0,ro.formatTimeForAPI)(y.times.startTime),r=(0,ro.formatTimeForAPI)(y.times.endTime),i=m?.timezone||"US/Mountain";(0,p.debugLog)("MBA53212co2v3nvoub5 Using user timezone for UTC conversion:",i);const{date:s,time:l}=(0,ro.convertToUTC)(t,n,i),{date:d,time:c}=(0,ro.convertToUTC)(a,r,i),u=await(0,at.updateBookingDraftTimeAndDate)(o,s,d,l,c);return(0,p.debugLog)("MBA53212co2v3nvoub5 Received response from updateBookingDraftTimeAndDate (overnight override):",u),u?.draft_data&&b((e=>Object.assign({},e,u.draft_data,{times:Object.assign({},u.draft_data.times||e.times,{isOvernightForced:!0}),service:Object.assign({},u.draft_data.service||e.service,{is_overnight:!0})}))),void f((e=>e+1))}const r="date-range"===y.dateRangeType&&!t&&!a&&!n;if((0,p.debugLog)("MBA53212co2v3nvoub5 Decision:",{isNonOvernightDateRange:r,willUseEndpoint:r?"updateBookingDraftMultipleDays":"updateBookingDraftTimeAndDate"}),r){(0,p.debugLog)("MBA53212co2v3nvoub5 Handling non-overnight date range as individual occurrences");const e=new Date(y.dateRange.startDate),t=new Date(y.dateRange.endDate),a=[],n=new Date(e);for(;n<=t;)a.push(new Date(n)),n.setDate(n.getDate()+1);(0,p.debugLog)("MBA53212co2v3nvoub5 Generated dates from range:",a.map((e=>e.toISOString().split("T")[0]))),(0,p.debugLog)("MBA53212co2v3nvoub5 Time settings:",y.times);const r=a.map((e=>{const t=e.toISOString().split("T")[0];(0,p.debugLog)("MBA53212co2v3nvoub5 Processing date:",t);let o,a,n=y.times;y.times[t]&&y.times.hasIndividualTimes?(n=y.times[t],(0,p.debugLog)("MBA53212co2v3nvoub5 Using individual times for date:",t,n)):(0,p.debugLog)("MBA53212co2v3nvoub5 Using default times for date:",t,n),o="string"===typeof n.startTime?n.startTime:void 0!==n.startTime?.hours?"".concat(String(n.startTime.hours).padStart(2,"0"),":").concat(String(n.startTime.minutes||0).padStart(2,"0")):"09:00",a="string"===typeof n.endTime?n.endTime:void 0!==n.endTime?.hours?"".concat(String(n.endTime.hours).padStart(2,"0"),":").concat(String(n.endTime.minutes||0).padStart(2,"0")):"17:00",(0,p.debugLog)("MBA53212co2v3nvoub5 Formatted times for date:",t,{startTime:o,endTime:a});const r=(0,ro.formatDateForAPI)(e);(0,p.debugLog)("MBA53212co2v3nvoub5 Formatted date:",r);const i="00:00"===a||parseInt(a.split(":")[0],10)<parseInt(o.split(":")[0],10)||parseInt(a.split(":")[0],10)===parseInt(o.split(":")[0],10)&&parseInt(a.split(":")[1],10)<parseInt(o.split(":")[1],10),s=i?new Date(e.getTime()+864e5):new Date(e),l=(0,ro.formatDateForAPI)(s);(0,p.debugLog)("MBA53212co2v3nvoub5 End date calculation:",{needsNextDayDate:i,startTime:o,endTime:a,originalDate:r,calculatedEndDate:l});const d=m?.timezone||"US/Mountain";(0,p.debugLog)("MBA53212co2v3nvoub5 Using user timezone for UTC conversion in map function:",d);const{date:c,time:u}=(0,ro.convertToUTC)(r,o,d),{date:g,time:h}=(0,ro.convertToUTC)(l,a,d);return(0,p.debugLog)("MBA53212co2v3nvoub5 Converted UTC times:",{utcStartDate:c,utcStartTime:u,utcEndDate:g,utcEndTime:h,isDifferentDates:c!==g}),{date:c,startTime:u,endDate:g,endTime:h}}));(0,p.debugLog)("MBA53212co2v3nvoub5 - Converted UTC dates:",r);const i=await(0,at.updateBookingDraftMultipleDays)(o,{dates:r,times:{}},m);(0,p.debugLog)("MBA53212co2v3nvoub5 Received response from updateBookingDraftMultipleDays:",i),i?.draft_data&&b((e=>Object.assign({},e,i.draft_data)))}else{const e=(0,ro.formatDateForAPI)(y.dateRange.startDate),t=(0,ro.formatDateForAPI)(y.dateRange.endDate),a=(0,ro.formatTimeForAPI)(y.times.startTime),n=(0,ro.formatTimeForAPI)(y.times.endTime);(0,p.debugLog)("MBA53212co2v3nvoub5 Using update-time-and-date endpoint for OVERNIGHT service with dates:",{startDate:e,endDate:t,startTime:a,endTime:n,service:{id:y.service?.service_id,name:y.service?.service_name,is_overnight:y.service?.is_overnight},times:{isOvernightForced:y.times?.isOvernightForced}});const{date:r,time:i}=(0,ro.convertToUTC)(e,a,userTz),{date:s,time:l}=(0,ro.convertToUTC)(t,n,userTz);(0,p.debugLog)("MBA53212co2v3nvoub5 UTC dates and times:",{utcStartDate:r,utcStartTime:i,utcEndDate:s,utcEndTime:l});const d=await(0,at.updateBookingDraftTimeAndDate)(o,r,s,i,l);(0,p.debugLog)("MBA53212co2v3nvoub5 Received response from updateBookingDraftTimeAndDate:",d),d?.draft_data?b((e=>Object.assign({},e,d.draft_data))):(0,p.debugLog)("MBA53212co2v3nvoub5 No draft_data in response:",d)}}else if("multiple-days"===y.dateRangeType){(0,p.debugLog)("MBA53212co2v3nvoub5 Multiple days selection:",{dates:y.dates,times:y.times});const e=await(0,at.updateBookingDraftMultipleDays)(o,{dates:y.dates,times:y.times},m);(0,p.debugLog)("MBA53212co2v3nvoub5 Received response from updateBookingDraftMultipleDays:",e),e?.draft_data&&b((t=>Object.assign({},t,e.draft_data)))}else if("recurring"===y.bookingType){(0,p.debugLog)("MBA53212co2v3nvoub5 Recurring dates selection:",{startDate:y.recurringStartDate,endDate:y.recurringEndDate,daysOfWeek:y.selectedDaysOfWeek,frequency:y.selectedFrequency,times:y.times});const e=await(0,at.updateBookingDraftRecurring)(o,{startDate:y.recurringStartDate,endDate:y.recurringEndDate,daysOfWeek:y.selectedDaysOfWeek,frequency:y.selectedFrequency,startTime:y.times.startTime,endTime:y.times.endTime});(0,p.debugLog)("MBA53212co2v3nvoub5 Received response from updateBookingDraftRecurring:",e),e?.draft_data&&b((t=>Object.assign({},t,e.draft_data)))}}catch(x){return(0,p.debugLog)("MBA53212co2v3nvoub5 Error calculating booking totals:",x),(0,p.debugLog)("MBA53212co2v3nvoub5 Error stack:",x.stack),(0,p.debugLog)("MBA53212co2v3nvoub5 Error details:",{message:x.message,name:x.name,response:x.response?.data}),void j("Failed to calculate booking totals")}f((e=>e+1))}else try{if(j(null),!y.conversation_id)return void j("Missing conversation information");(0,p.debugLog)("MBA66777 Creating booking from draft with conversation ID:",y.conversation_id);const e=await(0,at.createBookingFromDraft)(y.conversation_id);(0,p.debugLog)("MBA66777 Booking created successfully:",e);const t=e.message||{},o=e.booking_id,a={id:Date.now().toString(),type_of_message:"send_approved_message",metadata:{booking_id:o,service_type:t.service_type||y.service?.service_name,occurrences:t.occurrences||[],cost_summary:t.cost_summary||{total_client_cost:t.occurrences?.[0]?.cost_summary?.total_client_cost,total_sitter_payout:t.occurrences?.[0]?.cost_summary?.total_sitter_payout}},content:"Approval Request",sent_by_other_user:!1,timestamp:(new Date).toISOString()};n(Object.assign({},y,{booking_id:o,status:"Pending Client Approval",message:a})),D()}catch(x){(0,p.debugLog)("MBA66777 Error creating booking:",x),j("Failed to create booking. Please try again."),setTimeout((()=>{n(Object.assign({},y,{error:!0,errorMessage:x.message}))}),3e3)}else j("Please complete all required fields before proceeding")},D=()=>{(0,p.debugLog)("MBA2j3kbr9hve4: Resetting booking step modal state"),f(za.SERVICES_AND_PETS.id),b({service:l.service||null,pets:l.pets||[],dates:l.dates||[],bookingType:l.bookingType||"one-time",dateRangeType:l.dateRangeType||"date-range",times:l.times||{startTime:"09:00",endTime:"17:00",isOvernightForced:!1,hasIndividualTimes:!1},rates:l.rates||{},dateSelectionData:null,dateRange:null,hasFetchedDates:!1}),j(null),C(!1)},M=()=>{(0,p.debugLog)("MBA66777: Closing booking step modal and resetting state"),D(),t()};(0,a.useEffect)((()=>()=>{(0,p.debugLog)("MBA2j3kbr9hve4: BookingStepModal unmounting, cleaning up state")}),[]);return(0,T.jsx)(_.default,{visible:e,animationType:"fade",onRequestClose:M,transparent:!0,children:(0,T.jsx)(r.default,{style:Fa.modalOverlay,children:(0,T.jsxs)(Se.default,{style:Fa.modalContent,children:[(0,T.jsx)(r.default,{style:Fa.stepIndicatorContainer,children:(0,T.jsx)(Ne,{steps:Object.values(za).map((e=>e.name)),currentStep:h})}),(0,T.jsxs)(H.default,{style:Fa.scrollContent,contentContainerStyle:Fa.scrollContentContainer,children:[(0,T.jsx)(r.default,{style:Fa.content,children:w?(0,T.jsx)(r.default,{style:Fa.loadingContainer,children:(0,T.jsx)(i.default,{style:Fa.loadingText,children:"Loading booking information..."})}):(()=>{switch(h){case za.SERVICES_AND_PETS.id:return(0,T.jsx)(pa,{bookingId:o,onServiceSelect:v,onPetSelect:S,selectedService:y.service,selectedPets:y.pets,navigation:d,onClose:t});case za.DATE_SELECTION.id:(0,p.debugLog)("MBA2j3kbr9hve4: Rendering date selection with:",{dates:y.dates,dateRange:y.dateRange,bookingType:y.bookingType,dateRangeType:y.dateRangeType,hasFetchedDates:y.hasFetchedDates});const e=y.service?.is_overnight||y.times?.isOvernightForced||!1;return(0,p.debugLog)("MBA2j3kbr9hve4: Date selection overnight status:",{serviceIsOvernight:y.service?.is_overnight,timesIsOvernightForced:y.times?.isOvernightForced,combinedMode:e}),(0,T.jsx)(Ca,{selectedDates:y.dates||[],onDateSelect:B,bookingType:y.bookingType||"one-time",dateRangeType:y.dateRangeType||"date-range",initialDateRange:y.dateRange||null,isOvernightForced:e});case za.TIME_SELECTION.id:if(!y.dates||0===y.dates.length)return(0,T.jsx)(r.default,{style:Fa.errorContainer,children:(0,T.jsx)(i.default,{style:Fa.errorText,children:"Please select dates first"})});(0,p.debugLog)("MBA66777: CURRENT STATE Before rendering time selection:",{service:{id:y.service?.service_id,name:y.service?.service_name,is_overnight:y.service?.is_overnight},times:{isOvernightForced:y.times?.isOvernightForced,hasIndividualTimes:y.times?.hasIndividualTimes},dateRange:y.dateRange,dateRangeType:y.dateRangeType});const a=Object.assign({},y.times,{dates:y.dates||[],occurrences:y.occurrences||[],hasIndividualTimes:y.times?.hasIndividualTimes||!1,isOvernightForced:y.service?.is_overnight||y.times?.isOvernightForced||!1});(y.service?.is_overnight||y.times?.isOvernightForced)&&(a.hasIndividualTimes=!1,a.isOvernightForced=!0);const n=y.service?.is_overnight||y.times?.isOvernightForced||!1;return(0,p.debugLog)("MBA66777: Passing initialTimes to TimeSelectionCard:",{hasIndividualTimes:a.hasIndividualTimes,dateCount:a.dates?.length||0,isOvernightService:y.service?.is_overnight,isOvernightForced:y.times?.isOvernightForced,combinedOvernight:n}),(0,T.jsx)(Pa,{onTimeSelect:k,initialTimes:a,dateRange:y.dateRange,selectedService:Object.assign({},y.service,{is_overnight:n}),isOvernightForced:n});case za.REVIEW_AND_RATES.id:return(0,T.jsx)(co,{bookingData:y,bookingId:o,onRatesUpdate:e=>{(0,p.debugLog)("MBA2j3kbr9hve4: Rates updated:",e),b((t=>Object.assign({},t,{occurrences:e.occurrences,cost_summary:e.cost_summary})))}});default:return null}})()}),x&&(0,T.jsx)(i.default,{style:Fa.errorText,children:x})]}),(0,T.jsx)(r.default,{style:Fa.footer,children:h===za.SERVICES_AND_PETS.id?(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(s.default,{style:Fa.cancelButton,onPress:M,children:(0,T.jsx)(i.default,{style:Fa.cancelButtonText,children:"Cancel"})}),(0,T.jsx)(s.default,{style:[Fa.nextButton,(!A()||w)&&Fa.disabledButton],onPress:I,disabled:!A()||w,children:(0,T.jsx)(i.default,{style:[Fa.nextButtonText,(!A()||w)&&Fa.disabledButtonText],children:"Next"})})]}):(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(s.default,{style:[Fa.backButton,g&&Fa.smallScreenButton],onPress:()=>{h>za.SERVICES_AND_PETS.id?f((e=>e-1)):M()},children:(0,T.jsx)(i.default,{style:Fa.backButtonText,children:"Back"})}),(0,T.jsx)(r.default,{style:Fa.spacer}),(0,T.jsx)(s.default,{style:[Fa.cancelButtonSmall,g&&Fa.smallScreenButton],onPress:M,children:(0,T.jsx)(i.default,{style:Fa.cancelButtonText,children:"Cancel"})}),(0,T.jsx)(r.default,{style:g?Fa.smallMargin:null}),(0,T.jsx)(s.default,{style:[Fa.nextButtonSmall,g&&Fa.smallScreenButton,(!A()||w)&&Fa.disabledButton],onPress:I,disabled:!A()||w,children:h===za.REVIEW_AND_RATES.id&&g?(0,T.jsxs)(r.default,{style:Fa.confirmButtonColumn,children:[(0,T.jsx)(i.default,{style:[Fa.nextButtonText,(!A()||w)&&Fa.disabledButtonText],children:"Request"}),(0,T.jsx)(i.default,{style:[Fa.nextButtonText,(!A()||w)&&Fa.disabledButtonText],children:"Booking"})]}):(0,T.jsx)(i.default,{style:[Fa.nextButtonText,(!A()||w)&&Fa.disabledButtonText],children:h===za.REVIEW_AND_RATES.id?"Request Booking":"Next"})})]})})]})})})};var Oa=o(72302),Ea=o.n(Oa);const Wa=l.default.create({card:{backgroundColor:f.theme.colors.surface,borderRadius:12,padding:0,margin:8,borderWidth:1,borderColor:f.theme.colors.border,maxWidth:"80%",shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3,overflow:"hidden",position:"relative"},sentCard:{alignSelf:"flex-end",marginLeft:"20%"},receivedCard:{alignSelf:"flex-start",marginRight:"20%"},approvalCard:{borderColor:f.theme.colors.border,borderWidth:1},confirmedCard:{borderColor:f.theme.colors.success,borderWidth:2},colorBar:{width:4,backgroundColor:f.theme.colors.primary,position:"absolute",top:0,bottom:0,zIndex:1},colorBarLeft:{left:0},colorBarRight:{right:0},cardContent:{padding:12},header:{flexDirection:"row",alignItems:"center",marginBottom:8,paddingBottom:8,borderBottomWidth:1,borderBottomColor:f.theme.colors.border,gap:8},requestHeader:{borderBottomColor:f.theme.colors.border+"40"},approvalHeader:{borderBottomColor:f.theme.colors.border+"40"},confirmedHeader:{borderBottomColor:f.theme.colors.success},title:{fontSize:16,fontWeight:"bold",fontFamily:f.theme.fonts.header.fontFamily},requestTitle:{color:f.theme.colors.primary},approvalTitle:{color:f.theme.colors.primary},changeRequestTitle:{color:f.theme.colors.warning},content:{gap:8},infoSection:{gap:4,paddingBottom:8,borderBottomWidth:1,borderBottomColor:f.theme.colors.border+"40"},row:{flexDirection:"row",alignItems:"center",gap:8},label:{fontSize:14,fontWeight:"500",color:f.theme.colors.text,minWidth:80,fontFamily:f.theme.fonts.regular.fontFamily},value:{fontSize:14,color:f.theme.colors.text,flex:1,fontFamily:f.theme.fonts.regular.fontFamily},datesSection:{gap:4},datesSectionHeader:{flexDirection:"row",alignItems:"center"},datesCount:{fontSize:14,color:f.theme.colors.placeholder,marginLeft:8,fontFamily:f.theme.fonts.regular.fontFamily},occurrenceContainer:{borderBottomWidth:1,borderBottomColor:f.theme.colors.border+"40",paddingBottom:8,marginBottom:4},occurrenceItem:{gap:2,marginLeft:4},dateTimeText:{fontSize:14,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily,fontStyle:"italic"},durationText:{fontSize:14,color:f.theme.colors.placeHolderText,fontFamily:f.theme.fonts.regular.fontFamily},dstMessage:{fontSize:12,color:f.theme.colors.error,fontFamily:f.theme.fonts.regular.fontFamily},buttonContainer:{flexDirection:"row",justifyContent:"space-between",marginTop:8,gap:8},detailsButton:{flex:1,padding:8,borderRadius:8,alignItems:"center",backgroundColor:f.theme.colors.primary},detailsButtonText:{color:"white",fontSize:14,fontWeight:"500",fontFamily:f.theme.fonts.regular.fontFamily},approveButton:{flex:1,padding:8,borderRadius:8,alignItems:"center",backgroundColor:f.theme.colors.surface,borderWidth:1,borderColor:f.theme.colors.border},approveButtonText:{color:f.theme.colors.text,fontSize:14,fontWeight:"500",fontFamily:f.theme.fonts.regular.fontFamily},editButton:{flex:1,padding:8,borderRadius:8,alignItems:"center",backgroundColor:f.theme.colors.surface,borderWidth:1,borderColor:f.theme.colors.border},editButtonText:{color:f.theme.colors.text,fontSize:14,fontWeight:"500",fontFamily:f.theme.fonts.regular.fontFamily},disabledButton:{backgroundColor:f.theme.colors.border,opacity:.6},statusOverlay:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.4)",alignItems:"center",justifyContent:"center",zIndex:2},statusText:{color:"white",fontSize:16,fontWeight:"bold",padding:8,backgroundColor:"rgba(0, 0, 0, 0.6)",borderRadius:4,fontFamily:f.theme.fonts.header.fontFamily},changeMessageContainer:{backgroundColor:f.theme.colors.background,borderRadius:8,padding:8,marginTop:4,marginBottom:4,borderLeftWidth:3,borderLeftColor:f.theme.colors.warning},changeMessageLabel:{fontSize:16,fontWeight:"500",color:f.theme.colors.text,marginBottom:4,fontFamily:f.theme.fonts.regular.fontFamily},changeMessageText:{fontSize:14,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily},showMoreButton:{flexDirection:"row",alignItems:"center",justifyContent:"center",paddingVertical:8,marginTop:8,marginBottom:4,backgroundColor:f.theme.colors.surface,borderRadius:8,borderWidth:1,borderColor:f.theme.colors.primary+"40",paddingHorizontal:12,shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.1,shadowRadius:1,elevation:1},showMoreText:{fontSize:14,color:f.theme.colors.primary,marginRight:5,fontWeight:"500",fontFamily:f.theme.fonts.regular.fontFamily},confirmationContainerClickable:{flex:1,width:"100%",borderRadius:8},confirmationContainer:{backgroundColor:f.theme.colors.success+"15",padding:12,borderRadius:8,marginBottom:8},confirmationText:{fontSize:14,color:f.theme.colors.text,textAlign:"center",fontFamily:f.theme.fonts.regular.fontFamily,fontWeight:"500"},confirmedTitle:{color:f.theme.colors.success},confirmationBorder:{position:"absolute",top:0,left:0,right:0,height:4,backgroundColor:f.theme.colors.success}}),Na=({type:e,displayType:t,data:o,isFromMe:n,onPress:l,isProfessional:d,onApproveSuccess:c,onApproveError:u,onEditDraft:m,bookingStatus:g,hasChangeRequest:h,isNewestMessage:y=!1,messageCreatedAt:b,hasNewerApprovalRequests:x=!1,isAfterConfirmation:j=!1})=>{const{timeSettings:w}=(0,a.useContext)(p.AuthContext),C=w?.timezone||"US/Mountain",[v,B]=(0,a.useState)(!1),[k,_]=(0,a.useState)(null),[A,I]=(0,a.useState)(!1);(0,a.useEffect)((()=>{const e=Object.assign({},o,{occurrences:o.occurrences?.map((e=>Object.assign({},e,{rates:e.rates||{base_rate:0,additional_animal_rate:0,applies_after:1,holiday_rate:0,holiday_days:0,additional_rates:[]}})))});_(e)}),[o]);const D="Confirmed"===g,M="request_changes"===e,R="booking_confirmed"===e,P="approval"===e||M,z=D&&!R&&"approval"!==e&&!j&&!(M&&y)||"approval"===e&&h&&!y||M&&!y||R&&x||"booking_update"===t&&h&&!y||"approval"===e&&j&&!y,F=R&&x||"booking_update"===t&&h&&!y||"approval"===e&&j&&!y?"Booking Updated":"approval"===e&&j&&y||M&&y?"":!D||R||j||M&&y?"approval"===e&&h&&!y?"Changes Requested":M&&!y?"Booking Updated":"":"Booking Confirmed";(0,p.debugLog)("MBA4321: Message state for booking",o.booking_id,{type:e,displayType:t,isFromMe:n,isProfessional:d,bookingStatus:g,hasChangeRequest:h,isNewestMessage:y,isAfterConfirmation:j,hasNewerApprovalRequests:x,shouldShowOverlay:z,overlayText:F,messageCreatedAt:b||"N/A",overlayLogicChecks:{isConfirmedButNotConfirmationMessage:D&&!R,isChangeRequestAndNewestMessage:M&&y,isApprovalWithChangeRequest:"approval"===e&&h&&!y,isBookingConfirmedWithNewerApprovals:R&&x}});const L=()=>{if(!k){const e=Object.assign({},o,{occurrences:o.occurrences?.map((e=>Object.assign({},e,{rates:e.rates||{base_rate:0,additional_animal_rate:0,applies_after:1,holiday_rate:0,holiday_days:0,additional_rates:[]}})))||[]});_(e)}(0,p.debugLog)("MBA9876 Opening approval modal with booking ID:",o.booking_id),B(!0)},O=e=>{if(e.start_date&&e.end_date&&e.start_time&&e.end_time){const t=(0,ro.formatDateTimeRangeFromUTC)({startDate:e.start_date,startTime:e.start_time,endDate:e.end_date,endTime:e.end_time,userTimezone:C,includeTimes:!0,includeTimezone:!0});return((e,t,o,a,n)=>{try{const r=Ea().utc("".concat(e,"T").concat(t,":00Z")).tz(n),i=Ea().utc("".concat(o,"T").concat(a,":00Z")).tz(n);return r.utcOffset()!==i.utcOffset()}catch(r){return(0,p.debugLog)("MBA9876DST Error checking DST change:",r),!1}})(e.start_date,e.start_time,e.end_date,e.end_time,C)&&!e.dst_message&&((0,p.debugLog)("MBA9876DST Detected DST change for occurrence:",{start:"".concat(e.start_date," ").concat(e.start_time),end:"".concat(e.end_date," ").concat(e.end_time),timezone:C}),e.dst_message="Elapsed time may be different than expected due to Daylight Savings Time."),t}return e.formatted_start&&e.formatted_end?"".concat(e.formatted_start," to ").concat(e.formatted_end):"Date information unavailable"},E=e=>{if(e.duration)return e.duration;if(e.start_date&&e.end_date&&e.start_time&&e.end_time)try{const t=Ea().utc("".concat(e.start_date,"T").concat(e.start_time,":00Z")),o=Ea().utc("".concat(e.end_date,"T").concat(e.end_time,":00Z")),a=o.diff(t,"hours"),n=o.diff(t,"days");return n>0?"".concat(n," ").concat(1===n?"day":"days",", ").concat(a%24," ").concat(a%24===1?"hour":"hours"):"".concat(a," ").concat(1===a?"hour":"hours")}catch(t){(0,p.debugLog)("MBA9876DST Error calculating duration:",t)}return"N/A"},W=o.occurrences||[],N=W.length>3,H=A?W:W.slice(0,3),U=Math.max(0,W.length-3);return(0,T.jsxs)(r.default,{style:(()=>{const e=[Wa.card,n?Wa.sentCard:Wa.receivedCard];return P&&e.push(Wa.approvalCard),R&&e.push(Wa.confirmedCard),e})(),children:[P&&(0,T.jsx)(r.default,{style:[Wa.colorBar,n?Wa.colorBarLeft:Wa.colorBarRight]}),R&&(0,T.jsx)(r.default,{style:Wa.confirmationBorder}),(0,T.jsxs)(r.default,{style:Wa.cardContent,children:[(0,T.jsxs)(r.default,{style:R?[Wa.header,Wa.confirmedHeader]:[Wa.header,P?Wa.approvalHeader:Wa.requestHeader],children:[(0,T.jsx)(S.default,{name:(()=>{switch(e){case"request":return"calendar-plus";case"approval":return"calendar-check";case"request_changes":return"calendar-edit";case"booking_confirmed":return"check-circle-outline";default:return"calendar"}})(),size:24,color:M?f.theme.colors.warning:R?f.theme.colors.success:f.theme.colors.primary}),(0,T.jsx)(i.default,{style:[Wa.title,M?Wa.changeRequestTitle:R?Wa.confirmedTitle:P?Wa.approvalTitle:Wa.requestTitle],children:(()=>{if("booking_update"===t)return"Booking Update";if("request_changes"===e&&j)return"Update Change Request";switch(e){case"request":return"Booking Request";case"approval":return"Approval Request";case"request_changes":return"Request Changes";case"booking_confirmed":return"Booking Confirmed";default:return"Booking"}})()})]}),(0,T.jsx)(r.default,{style:Wa.content,children:R?(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)(s.default,{style:Wa.confirmationContainerClickable,onPress:L,activeOpacity:.7,children:[(0,T.jsx)(r.default,{style:Wa.confirmationContainer,children:(0,T.jsx)(i.default,{style:Wa.confirmationText,children:"This booking has been confirmed and is ready to go!"})}),(0,T.jsxs)(r.default,{style:Wa.infoSection,children:[(0,T.jsxs)(r.default,{style:Wa.row,children:[(0,T.jsx)(i.default,{style:Wa.label,children:"Booking ID:"}),(0,T.jsx)(i.default,{style:Wa.value,children:o.booking_id||"N/A"})]}),(0,T.jsxs)(r.default,{style:Wa.row,children:[(0,T.jsx)(i.default,{style:Wa.label,children:"Service:"}),(0,T.jsx)(i.default,{style:Wa.value,children:o.service_type||"N/A"})]}),(0,T.jsxs)(r.default,{style:Wa.row,children:[(0,T.jsx)(i.default,{style:Wa.label,children:d?"Your Payout:":"Total Cost:"}),(0,T.jsxs)(i.default,{style:Wa.value,children:["$",d?o.cost_summary?.total_sitter_payout||"0.00":o.cost_summary?.total_client_cost||"0.00"]})]})]})]}),(0,T.jsxs)(r.default,{style:Wa.buttonContainer,children:[(0,T.jsx)(s.default,{style:[Wa.detailsButton,{flex:1}],onPress:L,children:(0,T.jsx)(i.default,{style:Wa.detailsButtonText,children:"View Details"})}),d&&m&&(0,T.jsx)(s.default,{style:[Wa.editButton,{flex:1}],onPress:m,children:(0,T.jsx)(i.default,{style:Wa.editButtonText,children:"Edit Details"})})]})]}):(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)(r.default,{style:Wa.infoSection,children:[(0,T.jsxs)(r.default,{style:Wa.row,children:[(0,T.jsx)(i.default,{style:Wa.label,children:"Booking ID:"}),(0,T.jsx)(i.default,{style:Wa.value,children:o.booking_id||"N/A"})]}),(0,T.jsxs)(r.default,{style:Wa.row,children:[(0,T.jsx)(i.default,{style:Wa.label,children:"Service:"}),(0,T.jsx)(i.default,{style:Wa.value,children:o.service_type||"N/A"})]}),(0,T.jsxs)(r.default,{style:Wa.row,children:[(0,T.jsx)(i.default,{style:Wa.label,children:d?"Your Payout:":"Total Cost:"}),(0,T.jsxs)(i.default,{style:Wa.value,children:["$",(()=>{if(o.cost_summary){if(d){const e=o.cost_summary.total_sitter_payout||"0.00";return"number"===typeof e?e.toFixed(2):parseFloat(e).toFixed(2)}{const e=o.cost_summary.total_client_cost||"0.00";return"number"===typeof e?e.toFixed(2):parseFloat(e).toFixed(2)}}if(d){const e=o.total_sitter_payout||"0.00";return"number"===typeof e?e.toFixed(2):parseFloat(e).toFixed(2)}{const e=o.total_owner_cost||"0.00";return"number"===typeof e?e.toFixed(2):parseFloat(e).toFixed(2)}})()]})]})]}),(0,T.jsxs)(r.default,{style:Wa.datesSection,children:["request_changes"!==e?(0,T.jsxs)(r.default,{style:Wa.datesSectionHeader,children:[(0,T.jsx)(i.default,{style:Wa.label,children:"Dates:"}),N&&(0,T.jsxs)(i.default,{style:Wa.datesCount,children:["(",W.length," total)"]})]}):null,H.map(((e,t)=>{const o=t===H.length-1,a=!(!A&&o&&N);return(0,T.jsx)(r.default,{style:[Wa.occurrenceContainer,a?null:{borderBottomWidth:0}],children:(0,T.jsxs)(r.default,{style:Wa.occurrenceItem,children:[(0,T.jsx)(i.default,{style:Wa.dateTimeText,children:O(e)}),(0,T.jsxs)(i.default,{style:Wa.durationText,children:["Event Duration: ",E(e)," (",e.timezone||C.split("/")[1]||C,")"]}),e.dst_message?(0,T.jsx)(i.default,{style:Wa.dstMessage,children:e.dst_message}):null]})},t)})),N&&(0,T.jsxs)(s.default,{style:Wa.showMoreButton,onPress:()=>{I(!A)},children:[(0,T.jsx)(i.default,{style:Wa.showMoreText,children:A?"Show Fewer Dates":"Show ".concat(U," More Date").concat(1!==U?"s":"")}),(0,T.jsx)(S.default,{name:A?"chevron-up":"chevron-down",size:18,color:f.theme.colors.primary})]})]}),M&&(0,T.jsxs)(r.default,{style:Wa.changeMessageContainer,children:[(0,T.jsx)(i.default,{style:Wa.changeMessageLabel,children:"Change Request Message:"}),(0,T.jsx)(i.default,{style:Wa.changeMessageText,children:o.content||"No details provided"})]}),(0,T.jsxs)(r.default,{style:Wa.buttonContainer,children:[(0,T.jsx)(s.default,{style:[Wa.detailsButton,D&&!R&&!j&&"booking_update"!==t&&Wa.disabledButton],onPress:L,disabled:D&&!R&&!j&&"booking_update"!==t,children:(0,T.jsx)(i.default,{style:Wa.detailsButtonText,children:R?"View Details":"Review Details"})}),"approval"===e&&!d&&!D&&!h&&(0,T.jsx)(s.default,{style:Wa.approveButton,onPress:async()=>{try{const e=await(0,at.approveBooking)(o.booking_id);c&&c(e)}catch(e){console.error("Error approving booking from message card:",e),u&&u(e.response?.data?.error||"Failed to approve booking")}},children:(0,T.jsx)(i.default,{style:Wa.approveButtonText,children:"Approve"})}),"request"===e&&d&&m&&!D&&(0,T.jsx)(s.default,{style:Wa.editButton,onPress:m,children:(0,T.jsx)(i.default,{style:Wa.editButtonText,children:"Edit Draft"})}),M&&d&&m&&(0,T.jsx)(s.default,{style:Wa.editButton,onPress:m,children:(0,T.jsx)(i.default,{style:Wa.editButtonText,children:"Edit Details"})})]})]})})]}),z&&(0,T.jsx)(r.default,{style:Wa.statusOverlay,children:(0,T.jsx)(i.default,{style:Wa.statusText,children:F})}),(0,T.jsx)(mo,{visible:v,onClose:()=>B(!1),bookingId:o.booking_id,onApproveSuccess:e=>{c&&c(e)},onApproveError:e=>{u&&u(e)},onRequestChangesSuccess:e=>{(0,p.debugLog)("MBA9999 Change request submitted successfully:",e),c&&c(e)},onRequestChangesError:e=>{(0,p.debugLog)("MBA9999 Error submitting change request:",e),u&&u(e)},initialData:k,isProfessional:d,isReadOnly:(D||R)&&"booking_update"!==t&&!j,hideButtons:(D||R)&&"booking_update"!==t&&!j,modalTitle:"booking_update"===t||j?"Booking Update":R||D?"Booking Details":"Booking Approval Request"})]})};var Ha=o(98055);const Ua=l.default.create({modalContainer:{backgroundColor:f.theme.colors.surface,padding:20,margin:20,borderRadius:8,maxWidth:500,alignSelf:"center"},content:{alignItems:"center"},title:{fontSize:20,fontWeight:"bold",marginBottom:16,color:f.theme.colors.text,fontFamily:f.theme.fonts.header.fontFamily},description:{fontSize:16,marginBottom:24,textAlign:"center",color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily},buttonContainer:{flexDirection:"row",justifyContent:"space-around",width:"100%",gap:16},button:{flex:1}}),Va=({visible:e,onClose:t,onContinueExisting:o,onCreateNew:a})=>(0,T.jsx)(Ae.default,{children:(0,T.jsx)(Ha.default,{visible:e,onDismiss:t,contentContainerStyle:Ua.modalContainer,children:(0,T.jsxs)(r.default,{style:Ua.content,children:[(0,T.jsx)(i.default,{style:Ua.title,children:"Existing Draft Found"}),(0,T.jsx)(i.default,{style:Ua.description,children:"Would you like to continue with the existing draft or start a new one?"}),(0,T.jsxs)(r.default,{style:Ua.buttonContainer,children:[(0,T.jsx)(_e.default,{mode:"outlined",onPress:a,style:Ua.button,textColor:f.theme.colors.error,children:"Create New"}),(0,T.jsx)(_e.default,{mode:"contained",onPress:o,style:Ua.button,children:"Continue Existing"})]})]})})});var qa=o(65688);const Ya=(e,t,o={})=>{const{disabled:n=!1,handlerId:r=Math.random().toString(36).substr(2,9)}=o,[i,s]=(0,a.useState)(!1),[l,d]=(0,a.useState)("disconnected"),c=(0,a.useRef)(Date.now()),u=(0,a.useRef)(!1),m=(0,a.useRef)(0);(0,a.useEffect)((()=>{if(n)return;(0,p.debugLog)("MBA3210: useWebSocket hook initializing for ".concat(e,", handler ").concat(r));let o=[];(async()=>{try{const a=await(0,p.getStorage)("userToken");if(!a)return void(0,p.debugLog)("MBA3210: No token available for WebSocket connection");if(qa.default.init(a),e&&!u.current){const a=qa.default.registerHandler(e,t,"".concat(r,"-").concat(e));o.push(a),u.current=!0,(0,p.debugLog)("MBA3210: Registered handler for ".concat(e))}const n=qa.default.registerHandler("connection",(e=>{const t=l,o=i;c.current=Date.now(),"connected"===e.status?((0,p.debugLog)("MBA3210: Setting connection status to connected"),s(!0),d("connected"),m.current=0):((0,p.debugLog)("MBA3210: Setting connection status to disconnected"),s(!1),d("disconnected")),(0,p.debugLog)("MBA3210: Connection status changed in hook: ".concat(t," -> ").concat(e.status)),(0,p.debugLog)("MBA3210: isConnected changed in hook: ".concat(o," -> ").concat("connected"===e.status))}),"".concat(r,"-connection"));o.push(n),(0,p.debugLog)("MBA3210: Registered connection status handler");const g=qa.default.registerHandler("user_status_update",(o=>{"user_status_update"!==e&&"*"!==e||t(o),(0,p.debugLog)("MBA3210: Received user status update for user ".concat(o.user_id,": ").concat(o.is_online?"online":"offline"))}),"".concat(r,"-user_status_update"));o.push(g),(0,p.debugLog)("MBA3210: Registered user status update handler"),qa.default.isConnected&&((0,p.debugLog)("MBA3210: WebSocket manager reports connected on init, updating state"),s(!0),d("connected"))}catch(a){(0,p.debugLog)("MBA3210: Error initializing WebSocket in hook: ".concat(a.message))}})();const a=setInterval((()=>{qa.default.isConnected?((0,p.debugLog)("MBA3210: Initial connection check: WebSocket is connected"),s(!0),d("connected"),clearInterval(a)):(0,p.debugLog)("MBA3210: Initial connection check: WebSocket not connected yet")}),1e3),g=setTimeout((()=>{clearInterval(a)}),5e3);return()=>{(0,p.debugLog)("MBA3210: useWebSocket hook cleaning up for ".concat(e,", handler ").concat(r)),o.forEach((e=>e())),clearInterval(a),clearTimeout(g),u.current=!1}}),[n,e,t,r]),(0,a.useEffect)((()=>{if(n)return;const e=setInterval((()=>{const e=Date.now(),t=(e-c.current)/1e3;if(t>30){(0,p.debugLog)("MBA3210: [MY CONNECTION] No updates on MY OWN connection in ".concat(t.toFixed(0)," seconds, verifying status"));const o=qa.default.isConnected;o!==i&&((0,p.debugLog)("MBA3210: [MY CONNECTION] State mismatch detected - WebSocket manager: ".concat(o,", hook state: ").concat(i)),s(o),d(o?"connected":"disconnected")),i?((0,p.debugLog)("MBA3210: [MY CONNECTION] Sending heartbeat to verify MY OWN connection"),qa.default.send("heartbeat")):o&&((0,p.debugLog)("MBA3210: [MY CONNECTION] Sending heartbeat despite disconnected state in hook"),qa.default.send("heartbeat")),c.current=e}}),15e3);return()=>clearInterval(e)}),[n,i]);const g=(0,a.useCallback)(((e,t)=>((0,p.debugLog)("MBA3210: [MY CONNECTION] Attempting to send ".concat(e," message through MY OWN WebSocket")),i?qa.default.send(e,t):((0,p.debugLog)("MBA3210: [MY CONNECTION] Cannot send message, MY OWN WebSocket not connected, falling back to REST"),(async()=>{try{const o=await(0,p.getStorage)("userToken");if(!o)return(0,p.debugLog)("MBA3210: [MY CONNECTION] No token available for REST message send"),!1;let a="".concat(b.API_BASE_URL,"/api/messages/v1/send_norm_message/"),n={conversation_id:t.conversation_id,content:t.content};"request_booking"===e&&(a="".concat(b.API_BASE_URL,"/api/messages/v1/send_request_booking/"),n=Object.assign({},n,t)),(0,p.debugLog)("MBA3210: [MY CONNECTION] Sending message via REST API to ".concat(a," (fallback for failed WebSocket)"));const r=await w.default.post(a,n,{headers:{Authorization:"Bearer ".concat(o),"Content-Type":"application/json"}});return setTimeout((()=>{qa.default.reconnect&&((0,p.debugLog)("MBA3210: [MY CONNECTION] Attempting reconnection after REST fallback"),qa.default.reconnect())}),1e3),r.data}catch(o){return(0,p.debugLog)("MBA3210: [MY CONNECTION] Error sending message via REST fallback: ".concat(o.message)),!1}})()))),[i]),h=(0,a.useCallback)(((e,t)=>e&&t&&0!==t.length?((0,p.debugLog)("MBA3210: [MY CONNECTION] Marking messages as read for conversation ".concat(e)),i?qa.default.markMessagesAsRead(e,t):((0,p.debugLog)("MBA3210: [MY CONNECTION] Cannot mark messages as read through WebSocket, using REST API instead"),(async()=>{try{const o=await(0,p.getStorage)("userToken");if(!o)return(0,p.debugLog)("MBA3210: [MY CONNECTION] No token available for REST mark as read"),!1;(0,p.debugLog)("MBA3210: [MY CONNECTION] Sending mark_read via REST API for ".concat(t.length," messages (fallback)"));return(await w.default.post("".concat(b.API_BASE_URL,"/api/messages/v1/mark_read/"),{conversation_id:e,message_ids:t},{headers:{Authorization:"Bearer ".concat(o),"Content-Type":"application/json"}})).data}catch(o){return(0,p.debugLog)("MBA3210: [MY CONNECTION] Error marking messages as read via REST fallback: ".concat(o.message)),!1}})())):((0,p.debugLog)("MBA3210: [MY CONNECTION] Skipping markMessagesAsRead - missing data"),Promise.resolve(!1))),[i]),f=((0,a.useCallback)((()=>{(0,p.debugLog)("MBA3210: [MY CONNECTION] Hook requesting reconnection of MY OWN WebSocket");try{qa.default.disconnect&&((0,p.debugLog)("MBA3210: [MY CONNECTION] Disconnecting MY OWN existing WebSocket before reconnect"),qa.default.disconnect()),setTimeout((()=>{qa.default.reconnect?((0,p.debugLog)("MBA3210: [MY CONNECTION] Calling websocketManager.reconnect() for MY OWN connection"),qa.default.reconnect()):qa.default.connect?((0,p.debugLog)("MBA3210: [MY CONNECTION] Calling websocketManager.connect() as fallback for MY OWN connection"),qa.default.connect()):((0,p.debugLog)("MBA3210: [MY CONNECTION] No reconnect method found, reinitializing MY OWN connection"),(0,p.getStorage)("userToken").then((e=>{e?qa.default.init(e):(0,p.debugLog)("MBA3210: [MY CONNECTION] No token available for WebSocket reconnection")})).catch((e=>{(0,p.debugLog)("MBA3210: [MY CONNECTION] Error getting token for reconnection: ".concat(e.message))})))}),300)}catch(e){(0,p.debugLog)("MBA3210: [MY CONNECTION] Error during reconnection of MY OWN connection: ".concat(e.message))}}),[]),(0,a.useCallback)((()=>{n||((0,p.debugLog)("MBA3210: useWebSocket hook explicitly disconnecting for ".concat(e,", handler ").concat(r)),qa.default.disconnect(),s(!1),d("disconnected"),m.current=0)}),[n,e,r]));return{isConnected:i,connectionStatus:l,sendMessage:g,markMessagesAsRead:h,reconnect:qa.default.reconnect?qa.default.reconnect.bind(qa.default):null,disconnect:f,simulateConnection:qa.default.connect?qa.default.connect.bind(qa.default):null,isUsingFallback:!i}},Ga=({navigation:e,route:t})=>{const{colors:d}=(0,G.useTheme)(),{screenWidth:c}=(0,a.useContext)(p.AuthContext),u=(e=>l.default.create({container:{flex:1,backgroundColor:f.theme.colors.background,paddingTop:0,paddingRight:0,paddingLeft:0,height:e>900?"100vh":"calc(100vh - 64px)",overflow:"hidden",position:"fixed",top:e>900?0:64,left:0,right:0,bottom:0},headerContainer:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:16,borderBottomWidth:1,borderBottomColor:f.theme.colors.border},headerTitle:{fontSize:20,fontWeight:"bold",color:f.theme.colors.primary,fontFamily:f.theme.fonts.header.fontFamily},filterButton:{marginLeft:"auto"},contentContainer:{flex:1,flexDirection:"row",justifyContent:"center",maxWidth:e>900?"100%":900,alignSelf:"center",width:"100%",overflow:"hidden",height:"100%"},mainSection:{flex:1,display:"flex",flexDirection:"column",maxWidth:"web"===n.default.OS?e<=900?"100%":"70%":"100%",alignSelf:e<=900?"stretch":"flex-start",width:e<=900?"100%":"auto",height:"100%"},conversationListContainer:{width:e<=900?"100%":"30%",maxWidth:e<900?"":600,backgroundColor:f.theme.colors.surfaceContrast,overflow:"auto"},conversationItem:{padding:16,maxWidth:e<900?"":600,width:"100%",borderBottomWidth:1,borderBottomColor:f.theme.colors.border},selectedConversation:{backgroundColor:f.theme.colors.primary+"20",borderLeftWidth:3,borderLeftColor:f.theme.colors.primary},conversationName:{fontSize:16,fontFamily:f.theme.fonts.header.fontFamily,flex:1},messageSection:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden",paddingHorizontal:5,backgroundColor:f.theme.colors.surface},messageHeader:{padding:22,backgroundColor:f.theme.colors.surfaceContrast,width:"100%",flexDirection:"row",alignItems:"center",shadowColor:"#000",shadowOffset:{width:0,height:.5},shadowOpacity:.1,shadowRadius:3,elevation:3,zIndex:1},profilePhoto:{width:40,height:40,borderRadius:20,marginRight:12},messageHeaderName:{fontSize:18,fontWeight:"bold",color:f.theme.colors.text,fontFamily:f.theme.fonts.header.fontFamily},messagesContainer:{flex:1,overflow:"auto",width:"100%"},messageList:{width:"100%",paddingBottom:16},inputSection:{width:"100%",backgroundColor:f.theme.colors.surfaceContrast,padding:e>600?16:8,shadowColor:"#000",shadowOffset:{width:0,height:-.5},shadowOpacity:.1,shadowRadius:3,elevation:3,zIndex:1},inputContainer:{flexDirection:"row",alignItems:"center",width:"100%"},attachButtonContainer:{marginRight:8},attachButton:{padding:8,backgroundColor:f.theme.colors.surfaceContrast,borderRadius:20,width:40,height:40,justifyContent:"center",alignItems:"center"},inputInnerContainer:{flex:1,flexDirection:"row",alignItems:"center",backgroundColor:f.theme.colors.surfaceContrast,borderRadius:20,marginRight:8},messageInput:{flex:1,backgroundColor:f.theme.colors.background,borderRadius:20,paddingHorizontal:16,paddingVertical:8,marginHorizontal:8},sendButton:{borderRadius:20,marginLeft:8},messageCard:{marginVertical:4,maxWidth:e>900?"40%":"75%",borderRadius:12,overflow:"hidden"},messageContent:{paddingHorizontal:8,paddingVertical:4},sentMessage:{alignSelf:"flex-end",backgroundColor:f.theme.colors.primary},receivedMessage:{alignSelf:"flex-start",backgroundColor:f.theme.colors.receivedMessage},messageText:{fontSize:16,lineHeight:20,fontFamily:f.theme.fonts.regular.fontFamily},sentMessageContainer:{alignItems:"flex-end",marginBottom:4},receivedMessageContainer:{alignItems:"flex-start",marginBottom:4},senderAbove:{fontWeight:"bold",marginBottom:4,fontSize:12,fontFamily:f.theme.fonts.header.fontFamily},sentSenderName:{alignSelf:"flex-end"},receivedSenderName:{alignSelf:"flex-start"},timestampBelow:{fontSize:12,color:f.theme.colors.placeholder,marginTop:4,fontFamily:f.theme.fonts.regular.fontFamily},sentTimestamp:{alignSelf:"flex-end"},receivedTimestamp:{alignSelf:"flex-start"},sentMessageText:{color:f.theme.colors.whiteText},receivedMessageText:{color:f.theme.colors.text},webInput:{flex:1,backgroundColor:"transparent",paddingVertical:"8px",paddingLeft:"12px",height:24,maxHeight:"120px",border:"1px solid "+f.theme.colors.border,borderRadius:20,fontFamily:f.theme.fonts.regular.fontFamily,fontSize:e<=600?"14px":"inherit",appearance:"none",touchAction:"manipulation",WebkitTapHighlightColor:"transparent",WebkitUserSelect:"none",userSelect:"none",resize:"none",overflowY:"auto",lineHeight:"20px",paddingRight:"12px"},conversationContent:{flex:1,width:"100%"},conversationHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:6,width:"100%"},conversationNameContainer:{flexDirection:"row",alignItems:"center",flex:1},conversationTime:{fontSize:12,color:f.theme.colors.placeholder},conversationLastMessageContainer:{flexDirection:"row",alignItems:"center",width:"100%",marginBottom:6},conversationLastMessage:{fontSize:14,color:f.theme.colors.placeholder,flex:1,fontFamily:f.theme.fonts.regular.fontFamily},conversationUnreadBadge:{position:"relative",backgroundColor:f.theme.colors.error,borderRadius:10,minWidth:18,height:18,justifyContent:"center",alignItems:"center",paddingHorizontal:4,marginLeft:8},unreadMessage:{color:f.theme.colors.text,fontWeight:"bold"},bookingStatusContainer:{backgroundColor:f.theme.colors.primary+"20",padding:4,borderRadius:4,alignSelf:"flex-start",marginTop:2},bookingStatus:{fontSize:12,color:f.theme.colors.primary,fontFamily:f.theme.fonts.regular.fontFamily},requestBookingButton:{marginTop:4,height:28,alignSelf:"flex-start"},requestBookingLabel:{fontSize:12,marginVertical:0},messageListContainer:{flex:1},inputWrapper:{position:"absolute",bottom:0,left:0,right:0,flexDirection:"row",alignItems:"center",borderTopWidth:1,borderTopColor:f.theme.colors.border,backgroundColor:f.theme.colors.surface,zIndex:1,width:"100%",padding:e>600?16:8},dropdownMenu:{position:"absolute",bottom:"100%",left:0,backgroundColor:f.theme.colors.surface,borderRadius:8,shadowColor:"#000",shadowOffset:{width:0,height:-2},shadowOpacity:.25,shadowRadius:3.84,elevation:5,marginBottom:8,minWidth:150,borderWidth:1,borderColor:f.theme.colors.border},dropdownItem:{padding:12,flexDirection:"row",alignItems:"center"},dropdownText:{color:f.theme.colors.text,fontSize:14,marginLeft:8,fontFamily:f.theme.fonts.regular.fontFamily},activeConversationText:{color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily},mobileMessageView:{flex:1,width:"100%",height:"100%",position:"relative",backgroundColor:f.theme.colors.background,display:"flex",flexDirection:"column"},backButton:{flexDirection:"row",alignItems:"center",padding:16},backButtonText:{marginLeft:8,color:f.theme.colors.primary,fontSize:16,fontFamily:f.theme.fonts.regular.fontFamily},mobileHeader:{width:"100%",borderBottomWidth:1,borderBottomColor:f.theme.colors.border,position:"relative",zIndex:10,shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.1,shadowRadius:2,elevation:3},mobileContent:{flex:1,position:"relative",height:"calc(100% - 56px)"},mobileContainer:{paddingTop:0,paddingLeft:0,paddingRight:0},sendButtonMobile:{width:24,height:24,minWidth:0,padding:0,marginLeft:4,justifyContent:"center",alignItems:"center"},mobileHeaderContent:{flexDirection:"row",alignItems:"center",justifyContent:"center",position:"relative",paddingVertical:16,paddingHorizontal:8,width:"100%",minHeight:60},mobileHeaderName:{fontSize:18,fontWeight:"bold",color:f.theme.colors.text,textAlign:"center",fontFamily:f.theme.fonts.header.fontFamily,flexWrap:"wrap",maxWidth:"70%"},mobileHeaderNameContainer:{flexDirection:"row",alignItems:"center",justifyContent:"center",flexWrap:"wrap"},backArrow:{position:"absolute",left:16,zIndex:10,padding:8},bookingRequestCard:{backgroundColor:f.theme.colors.surface,borderRadius:12,padding:16,margin:8,borderWidth:1,borderColor:f.theme.colors.border,maxWidth:"75%",position:"relative"},sentBookingRequest:{alignSelf:"flex-end",marginLeft:"20%"},receivedBookingRequest:{alignSelf:"flex-start",marginRight:"20%"},bookingRequestHeader:{flexDirection:"row",alignItems:"center",marginBottom:12,gap:8},bookingRequestTitle:{fontSize:18,fontWeight:"bold",color:f.theme.colors.primary,fontFamily:f.theme.fonts.header.fontFamily},bookingRequestDetails:{gap:8},inlineDetailRow:{flexDirection:"row",gap:8,marginBottom:8},dateSection:{gap:8},detailLabel:{fontSize:16,fontWeight:"502",color:f.theme.colors.text},detailText:{fontSize:16,color:f.theme.colors.text,flex:1},acceptButton:{backgroundColor:f.theme.colors.primary,padding:12,borderRadius:8,alignItems:"center",marginTop:16},acceptButtonText:{color:f.theme.colors.surface,fontSize:16,fontWeight:"500"},viewBookingButton:{backgroundColor:f.theme.colors.primary,padding:12,borderRadius:8,alignItems:"center",marginTop:16},viewBookingText:{color:f.theme.colors.surface,fontSize:16,fontWeight:"500",fontFamily:f.theme.fonts.regular.fontFamily},statusContainer:{backgroundColor:f.theme.colors.primary+"15",padding:8,borderRadius:4,marginBottom:12},statusText:{color:f.theme.colors.primary,fontSize:14,fontWeight:"500",fontFamily:f.theme.fonts.regular.fontFamily},deletedOverlay:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.7)",justifyContent:"center",alignItems:"center",borderRadius:12},deletedText:{color:f.theme.colors.surface,fontSize:18,fontWeight:"bold"},occurrenceItem:{marginBottom:12,borderBottomWidth:1,borderColor:f.theme.colors.border},occurrenceNumber:{fontWeight:"bold",marginBottom:4,color:f.theme.colors.primary},occurrenceDetails:{backgroundColor:f.theme.colors.background,padding:8,borderRadius:4},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center"},loadingText:{marginTop:12,color:f.theme.colors.placeholder,fontSize:16,fontFamily:f.theme.fonts.regular.fontFamily},emptyText:{padding:16,color:f.theme.colors.placeholder,fontSize:16,fontFamily:f.theme.fonts.regular.fontFamily,textAlign:"center"},loadingMore:{padding:16},searchContainer:{padding:16,backgroundColor:f.theme.colors.surfaceContrast},searchInputContainer:{flexDirection:"row",alignItems:"center",backgroundColor:f.theme.colors.surface,borderRadius:20,paddingHorizontal:12,marginVertical:6,height:40,borderWidth:1,borderColor:f.theme.colors.border},searchIcon:{marginRight:8},clearButton:{padding:4},searchInput:{flex:1,height:"100%",fontSize:16,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily,outline:"none",WebkitTapHighlightColor:"transparent",WebkitAppearance:"none",outlineStyle:"none"},messageHeaderContent:{flexDirection:"row",alignItems:"center",flex:1},editDraftButton:{flexDirection:"row",alignItems:"center",backgroundColor:f.theme.colors.surface,paddingHorizontal:12,paddingVertical:6,borderRadius:16,marginLeft:"auto",borderWidth:1,borderColor:f.theme.colors.primary},editDraftText:{marginLeft:4,color:f.theme.colors.primary,fontSize:14,fontFamily:f.theme.fonts.regular.fontFamily},conversationUnreadBadge:{position:"relative",backgroundColor:f.theme.colors.error,borderRadius:10,minWidth:18,height:18,justifyContent:"center",alignItems:"center",paddingHorizontal:4},conversationUnreadText:{color:f.theme.colors.whiteText,fontSize:11,fontWeight:"bold",fontFamily:f.theme.fonts.regular.fontFamily},timeContainer:{flexDirection:"column",alignItems:"flex-end",justifyContent:"flex-start"},unreadBadge:{backgroundColor:f.theme.colors.error,borderRadius:10,minWidth:18,height:18,justifyContent:"center",alignItems:"center",paddingHorizontal:4,marginLeft:8,alignSelf:"flex-start"},unreadBadgeText:{color:"white",fontSize:11,fontWeight:"bold",fontFamily:f.theme.fonts.regular.fontFamily},conversationNameRow:{flexDirection:"row",alignItems:"center",marginBottom:4},mobileEditDraftButton:{marginRight:10,paddingHorizontal:8,paddingVertical:4,borderRadius:12,borderWidth:1,borderColor:f.theme.colors.primary,backgroundColor:f.theme.colors.surface,minWidth:55,alignSelf:"flex-start"}}))(c),[m,g]=(0,a.useState)(!0),[x,j]=(0,a.useState)(!1),[C,v]=(0,a.useState)(!1),[B,k]=(0,a.useState)(!1),[_,A]=(0,a.useState)(null),[I,D]=(0,a.useState)(null),[M,R]=(0,a.useState)([]),[P,z]=(0,a.useState)(!1),[F,L]=(0,a.useState)(!1),[O,E]=(0,a.useState)(!1),{is_DEBUG:W,is_prototype:N,isCollapsed:H,isApprovedProfessional:V,userRole:Y,timeSettings:J}=(0,a.useContext)(p.AuthContext),[$,Z]=(0,a.useState)([]),[K,Q]=(0,a.useState)([]),[X,ee]=(0,a.useState)(!0),[te,oe]=(0,a.useState)(1),[ae,ne]=(0,a.useState)(!1),re=(0,a.useRef)(c),[ie,se]=((0,a.useRef)(!1),(0,a.useState)(!0)),le=(0,a.useRef)(!0),[de,ce]=(0,a.useState)(!1),[ue,me]=(0,a.useState)(null),[ge,fe]=(0,a.useState)(""),[pe,ye]=(0,a.useState)(!1),[be,xe]=(0,a.useState)(null),[je,we]=(0,a.useState)(!1),[Ce,ve]=(0,a.useState)("disconnected"),[Te,ke]=(0,a.useState)(0),{resetNotifications:Ae,updateRoute:Ie,markConversationAsRead:De,getConversationUnreadCount:Me}=(0,a.useContext)(y.default),Re=(0,a.useRef)(!1),Pe=(0,a.useRef)(!1),ze=(0,a.useRef)(!1),Fe=(0,a.useRef)(null),Le=(0,a.useRef)(null),Oe=(0,a.useRef)(!1),Ee=(0,a.useRef)(new Set),We=(0,a.useRef)(new Set),Ne=(0,a.useCallback)((e=>{(0,p.debugLog)("MBA3210: Received WebSocket message:",e);try{if(!e||!e.message_id&&!e.conversation_id&&!e.type)return void(0,p.debugLog)("MBA3210: Invalid message data received");if("user_status_update"===e.type&&e.user_id){(0,p.debugLog)("MBA3210: [OTHER USER STATUS] Received online status update for user ID:",e.user_id);const t=String(e.user_id),o=!!e.is_online;if((0,p.debugLog)("MBA3210: [OTHER USER STATUS] Processing status change for user ".concat(t,", online=").concat(o)),Z((e=>{(0,p.debugLog)("MBA3210: [OTHER USER STATUS] Checking ".concat(e.length," conversations for user ").concat(t));const a=e.map((e=>{const a=e.participant1_id?String(e.participant1_id):"",n=e.participant2_id?String(e.participant2_id):"";return t===a||t===n?((0,p.debugLog)("MBA3210: [OTHER USER STATUS] Found match in conversation ".concat(e.conversation_id,", setting other_participant_online=").concat(o)),Object.assign({},e,{other_participant_online:o})):e})),n=a.filter(((t,o)=>t.other_participant_online!==e[o].other_participant_online)).length;return(0,p.debugLog)("MBA3210: [OTHER USER STATUS] Updated ".concat(n," conversations with new status for user ").concat(t)),a})),I){const e=I.participant1_id?String(I.participant1_id):"",a=I.participant2_id?String(I.participant2_id):"";t!==e&&t!==a||((0,p.debugLog)("MBA3210: [OTHER USER STATUS] Updating selected conversation with online status: ".concat(o," for user ").concat(t)),D((e=>Object.assign({},e,{other_participant_online:o}))))}return}_&&e.conversation_id&&String(e.conversation_id)===String(_)?((0,p.debugLog)("MBA3210: Message is for current conversation, adding to list"),R((t=>t.some((t=>{if(t.message_id&&e.message_id&&String(t.message_id)===String(e.message_id))return(0,p.debugLog)("MBA3210: Duplicate detected by ID"),!0;if(t.content===e.content&&t.sent_by_other_user===e.sent_by_other_user){if(!t.timestamp||!e.timestamp)return(0,p.debugLog)("MBA3210: Duplicate detected by content+sender"),!0;if(Math.abs(new Date(t.timestamp).getTime()-new Date(e.timestamp).getTime())<5e3)return(0,p.debugLog)("MBA3210: Duplicate detected by content+timestamp"),!0}return!(!t._isOptimistic||t.content!==e.content||e.sent_by_other_user)&&((0,p.debugLog)("MBA3210: Found matching optimistic message, replacing"),!0)}))?((0,p.debugLog)("MBA3210: Message already exists in the list, skipping"),e.message_id?t.map((t=>t._isOptimistic&&t.content===e.content&&!e.sent_by_other_user?Object.assign({},e,{_wasOptimistic:!0}):t)):t):((0,p.debugLog)("MBA3210: Adding new message to list:",e.message_id),[e,...t]))),e.message_id&&Fe.current&&e.sent_by_other_user&&((0,p.debugLog)("MBA3210: Marking message as read:",e.message_id),Fe.current(_,[e.message_id]))):e.conversation_id&&((0,p.debugLog)("MBA3210: Message is for another conversation, updating conversation list"),Z((t=>t.map((t=>String(t.conversation_id)===String(e.conversation_id)?Object.assign({},t,{last_message:e.content,last_message_time:e.timestamp,unread:!0}):t)))))}catch(t){(0,p.debugLog)("MBA3210: Error handling WebSocket message:",t)}}),[_]),{isConnected:He,connectionStatus:Ue,markMessagesAsRead:Ve,reconnect:qe,disconnect:Ye,simulateConnection:Ge,isUsingFallback:Je}=Ya("message",Ne,{handlerId:"message-history"});(0,a.useEffect)((()=>{Fe.current=Ve}),[Ve]);(0,a.useCallback)((()=>{(0,p.debugLog)("MBA3210: [CONNECTION] User manually requested WebSocket reconnection"),"function"===typeof qe&&qe()}),[qe,I]);(0,a.useEffect)((()=>{ve(Ue),window&&window.WebSocket,"connected"===Ue&&He||Je?(0,p.debugLog)("MBA3210: [MY CONNECTION] Connection fully verified as connected or using fallback"):(0,p.debugLog)("MBA3210: [MY CONNECTION] Connection not fully verified, status and state mismatch")}),[Ue,He,Je]),(0,a.useEffect)((()=>{const e=setTimeout((()=>{(0,p.debugLog)("MBA3210: [MY CONNECTION] Forcing reconnection on component mount"),"function"===typeof qe&&qe()}),1e3);return()=>clearTimeout(e)}),[qe]),(0,a.useEffect)((()=>{if(!le.current)return;(0,p.debugLog)("MBA3210: Component mounted - initializing data");return(async()=>{try{if(Z([]),R([]),A(null),D(null),g(!0),j(!1),oe(1),ee(!0),Le.current=null,"web"===n.default.OS){const e=new URL(window.location.href),t=e.searchParams.get("conversationId");if(e.searchParams.has("conversationId")&&(e.searchParams.delete("conversationId"),window.history.replaceState({},"",e.toString()),(0,p.debugLog)("MBA3210: Cleared URL parameters on initial load")),t){await $e();return void A(t)}}if(t.params?.conversationId){Re.current=!0,!0===t.params.isProfessional&&(ze.current=!0,(0,p.debugLog)("MBA3210: Will open booking creation after data loads"));await $e();return A(t.params.conversationId),void e.setParams({messageId:null,conversationId:null,otherUserName:null,isProfessional:null,clientId:null})}const o=await $e();"web"===n.default.OS&&c>900&&o?.length>0&&A(o[0].conversation_id)}catch(o){console.error("Error in initialization:",o)}finally{le.current=!1,se(!1),Re.current=!1}})(),()=>{(0,p.debugLog)("MBA3210: Component unmounting - cleaning up"),Z([]),R([]),A(null),D(null),le.current=!0,se(!0),Re.current=!1,Pe.current=!1,ze.current=!1,Le.current=null,window.selectedConversationId=null}}),[]),(0,a.useEffect)((()=>{le.current||Re.current||!t.params?.conversationId||(W&&console.log("MBA98765 Route params detected (non-reload):",{messageId:t.params.messageId,conversationId:t.params.conversationId,otherUserName:t.params.otherUserName,isProfessional:t.params.isProfessional,clientId:t.params.clientId}),Re.current=!0,!0===t.params.isProfessional&&(ze.current=!0,W&&console.log("MBA98765 Will open booking creation after data loads")),A(t.params.conversationId),oe(1),ee(!0),$e().then((()=>{Re.current=!1})),e.setParams({messageId:null,conversationId:null,otherUserName:null,isProfessional:null,clientId:null}))}),[t.params]),(0,a.useEffect)((()=>{ze.current&&I&&Pe.current&&(W&&console.log("MBA98765 Conversation data and messages loaded, triggering booking creation",{conversationId:I.conversation_id,isProfessional:I.is_professional,hasDraft:pe,draftData:be?"exists":"none"}),ze.current=!1,setTimeout((()=>{Qe()}),300))}),[I,Pe.current,pe,be]),(0,a.useEffect)((()=>{if(!_||ie)return void(W&&console.log("MBA98765 Skipping conversation data update - initial load or no conversation"));if(Le.current===_)return void(W&&console.log("MBA98765 Skipping redundant conversation update - already viewing this conversation"));W&&console.log("MBA98765 Selected conversation changed:",{id:_,type:typeof _,isHandlingRouteParams:Re.current}),window.selectedConversationId=_,(0,p.debugLog)("MBA4321: Updated global selectedConversationId to ".concat(_));const e=$.find((e=>String(e.conversation_id)===String(_)));if(e){if((0,p.debugLog)("MBA3210: [OTHER USER STATUS] Setting selected conversation to ".concat(e.conversation_id,' with user "').concat(e.other_user_name,'"')),(0,p.debugLog)('MBA3210: [OTHER USER STATUS] Initial online status for "'.concat(e.other_user_name,'": ').concat(e.other_participant_online?"ONLINE":"OFFLINE")),D(e),De&&((0,p.debugLog)("MBA4321: Marking ONLY conversation ".concat(_," as read when selected")),De(_)),"web"===n.default.OS){const e=new URL(window.location.href);e.searchParams.set("conversationId",_),window.history.pushState({},"",e.toString())}oe(1),ee(!0),Pe.current=!1,Le.current=_}else W&&console.log("MBA98765 Could not find conversation data for ID:",_),(0,p.debugLog)("MBA3210: [OTHER USER STATUS] Could not find conversation data for ID: ".concat(_))}),[_,$,ie,De]),(0,a.useEffect)((()=>()=>{window.selectedConversationId=null,(0,p.debugLog)("MBA4321: Cleared global selectedConversationId on unmount")}),[]),(0,a.useEffect)((()=>{if(!_||ie)return;const e=Le.current!==_;if(!e&&Pe.current)return void(0,p.debugLog)("MBA4321: Skipping message fetch - conversation unchanged and messages already loaded");W&&console.log("MBA98765 Fetching messages for conversation:",{id:_,hasLoaded:Pe.current,hasChanged:e,shouldOpenBookingCreation:ze.current});let t=!0;return Pe.current=!0,j(!0),Ze(_,1).then((()=>{t&&(j(!1),ze.current&&I&&W&&console.log("MBA98765 Messages loaded, now draft data is available"),De&&e&&((0,p.debugLog)("MBA4321: Marking conversation ".concat(_," as read after successful message fetch")),De(_)),ke((e=>e+1)))})).catch((e=>{t&&(j(!1),console.error("Error fetching messages:",e))})),()=>{t=!1}}),[_,ie,De]),(0,a.useEffect)((()=>{const e=re.current,t=e<=900&&c>900||e>900&&c<=900;W&&console.log("MBA98765 Screen width change:",{prev:e,current:c,crossedThreshold:t}),re.current=c,t&&c>900&&$.length>0&&!_&&(W&&console.log("MBA98765 Auto-selecting first conversation on width change"),A($[0].conversation_id))}),[c]),(0,a.useEffect)((()=>{if(""===ge.trim())Q($);else{const e=ge.trim().toLowerCase(),t=$.filter((t=>t.other_user_name&&t.other_user_name.toLowerCase().includes(e)));Q(t)}}),[$,ge]);const $e=async()=>{try{if(m&&$.length>0&&!le.current)return(0,p.debugLog)("MBA3210: [OTHER USERS STATUS] Skipping duplicate conversation fetch - already loading"),$;g(!0),(0,p.debugLog)("MBA3210: [OTHER USERS STATUS] Starting to fetch conversations with online status data");const e=await(0,p.getStorage)("userToken"),t="".concat(b.API_BASE_URL,"/api/conversations/v1/");(0,p.debugLog)("MBA3210: [OTHER USERS STATUS] Making API request to get conversations with online statuses");const o=await w.default.get(t,{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(o.data&&Array.isArray(o.data)){const e=o.data.map((e=>Object.assign({},e,{other_participant_online:e.other_participant_online||!1})));return e.forEach((e=>{const t=e.other_user_name||"Unknown";(0,p.debugLog)('MBA3210: [OTHER USERS STATUS] User "'.concat(t,'" (conversation ').concat(e.conversation_id,") online status: ").concat(e.other_participant_online?"ONLINE":"OFFLINE"))})),(0,p.debugLog)("MBA3210: [OTHER USERS STATUS] Fetched ".concat(e.length," conversations with online status data")),Z(e),Q(e),e}return[]}catch(e){return console.error("Error fetching conversations:",e),(0,p.debugLog)("MBA3210: [OTHER USERS STATUS] Error fetching conversation status data: ".concat(e.message)),[]}finally{g(!1)}},Ze=async(e,t=1)=>{try{const o="".concat(e,"-").concat(t);if(Ee.current.has(o)&&t>1)return void(0,p.debugLog)("MBA4321: Skipping duplicate fetch for page ".concat(t," of conversation ").concat(e));if(1===t)j(!0),R([]),Ee.current.clear(),We.current.clear();else{if(Oe.current)return void(0,p.debugLog)("MBA4321: Already loading more messages, skipping request for page ".concat(t));Oe.current=!0,ne(!0)}Ee.current.add(o);const a=await(0,p.getStorage)("userToken"),n="".concat(b.API_BASE_URL,"/api/messages/v1/conversation/").concat(e,"/?page=").concat(t);(0,p.debugLog)("MBA4321: Fetching messages for conversation ".concat(e,", page ").concat(t));const r=await w.default.get(n,{headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"}}),i=r.data.messages||[],s=i.filter((e=>e.message_id&&We.current.has(e.message_id)?((0,p.debugLog)("MBA4321: Skipping duplicate message ".concat(e.message_id)),!1):(e.message_id&&We.current.add(e.message_id),!0)));(0,p.debugLog)("MBA4321: Received ".concat(i.length," messages, ").concat(s.length," unique for page ").concat(t)),1===t?(R(s),ye(r.data.has_draft||!1),xe(r.data.draft_data||null),setTimeout((()=>{ke((e=>e+1))}),100)):R((e=>{const t=new Set(e.map((e=>e.message_id)).filter(Boolean)),o=s.filter((e=>!e.message_id||!t.has(e.message_id)));return(0,p.debugLog)("MBA4321: Adding ".concat(o.length," unique messages to existing ").concat(e.length," messages")),[...e,...o]})),ee(r.data.has_more),oe(t)}catch(o){(0,p.debugLog)("MBABOSS [ERROR] Error in fetchMessages:",{message:o.message,response:o.response?.data,status:o.response?.status,url:o.config?.url,method:o.config?.method})}finally{j(!1),ne(!1),setTimeout((()=>{Oe.current=!1}),300)}},Ke=async e=>{try{const t=await(0,p.getStorage)("userToken"),o=await w.default.post("".concat(b.API_BASE_URL,"/api/messages/v1/send_norm_message/"),{conversation_id:_,content:e},{headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"}});return R((e=>[o.data,...e])),Z((t=>t.map((t=>t.conversation_id===_?Object.assign({},t,{last_message:e,last_message_time:o.data.timestamp}):t)))),o.data}catch(t){throw console.error("Error sending message:",t),t}},Qe=async()=>{if(W&&console.log("MBA98765 handleCreateBooking:",{selectedConversationData:I,selectedConversation:_,isProfessional:I?.is_professional,hasDraft:pe,draftData:be}),!I){console.log("MBA98765 No conversation data found, refreshing conversations"),await $e();const e=$.find((e=>e.conversation_id===_));if(!e)return void console.log("MBA98765 Still no conversation data after refresh");D(e),W&&console.log("MBA98765 Updated conversation data:",e)}const e=!0===I.is_professional;W&&console.log("MBA98765 Is Professional?",e),E(!1),e?(W&&console.log("MBA98765 User is professional - checking for existing draft",{hasDraft:pe,draftData:be}),pe&&be?we(!0):await Xe()):(console.log("MBA98765 User is owner - showing request modal"),L(!0))},Xe=async()=>{try{const e=await(0,p.getStorage)("userToken"),t=await w.default.post("".concat(b.API_BASE_URL,"/api/bookings/v1/create/"),{conversation_id:_},{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});W&&console.log("MBA98765 Create draft response:",t.data),await Ze(_,1),t.data.draft_id&&(me(t.data.draft_id),setTimeout((()=>{ce(!0)}),100))}catch(e){console.error("Error creating draft:",e),Be.default.alert("Error","Unable to create draft. Please try again.")}},et=(0,a.useCallback)((()=>{W&&console.log("MBA98765 loadMoreMessages called:",{hasMore:X,isLoadingMore:ae,isLoadingMoreRef:Oe.current,currentPage:te,selectedConversation:_}),X&&!Oe.current&&_&&((0,p.debugLog)("MBA4321: Loading more messages for page ".concat(te+1)),Ze(_,te+1))}),[X,te,_]),tt=(0,a.useCallback)((({item:t})=>{const o=(e=>{const t={};return e.forEach((e=>{if(e.metadata&&e.metadata.booking_id){const o=e.metadata.booking_id;t[o]||(t[o]=[]),t[o].push({messageId:e.message_id,type:e.type_of_message,timestamp:new Date(e.created_at||e.timestamp),message:e})}})),Object.keys(t).forEach((e=>{t[e].sort(((e,t)=>t.timestamp-e.timestamp))})),t})(M),a=M.filter((e=>"booking_confirmed"===e.type_of_message)).map((e=>e.metadata?.booking_id)).filter(Boolean),n={};a.forEach((e=>{const t=M.filter((t=>t.metadata?.booking_id===e)).sort(((e,t)=>new Date(t.timestamp)-new Date(e.timestamp))),o=t.find((e=>"booking_confirmed"===e.type_of_message));if(o){const a=new Date(o.timestamp),r=t.filter((e=>"send_approved_message"===e.type_of_message&&new Date(e.timestamp)>a));r.length>0&&(n[e]=!0,(0,p.debugLog)("MBA6428: Detected booking update for confirmed booking:",{bookingId:e,confirmationTime:a,newerApprovalRequests:r.map((e=>e.message_id))}))}}));t.metadata?.booking_id&&M.some((e=>"request_changes"===e.type_of_message&&e.metadata?.booking_id===t.metadata.booking_id));const s=t.metadata?.booking_id&&a.includes(t.metadata.booking_id),l=t.metadata?.booking_id&&n[t.metadata.booking_id];let d=!1,c=new Date(t.created_at||t.timestamp);if(t.metadata?.booking_id&&o[t.metadata.booking_id]){const e=o[t.metadata.booking_id];d=e.length>0&&e[0].messageId===t.message_id,(0,p.debugLog)("MBA7321: Message ".concat(t.message_id," for booking ").concat(t.metadata.booking_id," isNewestMessage: ").concat(d))}if("initial_booking_request"===t.type_of_message||"send_approved_message"===t.type_of_message){const o=!t.sent_by_other_user,a=t.metadata?.booking_id,n=a&&M.some((e=>"request_changes"===e.type_of_message&&e.metadata?.booking_id===a)),r="send_approved_message"===t.type_of_message,i=s?"Confirmed":t.metadata?.booking_status,l=r&&s&&a&&M.some((e=>"booking_confirmed"===e.type_of_message&&e.metadata?.booking_id===a&&new Date(e.timestamp)<new Date(t.timestamp))),u=l&&a&&M.some((e=>"request_changes"===e.type_of_message&&e.metadata?.booking_id===a&&new Date(e.timestamp)>new Date(t.timestamp)));l&&(0,p.debugLog)("MBA6428: Detected approval request for already confirmed booking:",{messageId:t.message_id,bookingId:a,isApprovalMessage:r,bookingIsConfirmed:s,isUpdateToConfirmedBooking:l,hasNewerRequestChanges:u});const m=I?.is_professional&&("initial_booking_request"===t.type_of_message||"send_approved_message"===t.type_of_message&&n);m&&(0,p.debugLog)("MBA6428: Showing edit draft button for message:",{messageId:t.message_id,bookingId:a,type:t.type_of_message});let h="0.00";try{t.metadata.cost_summary&&t.metadata.cost_summary.total_client_cost&&(h=t.metadata.cost_summary.total_client_cost)}catch(g){console.error("Error parsing total cost:",g)}return(0,T.jsx)(Na,{type:"initial_booking_request"===t.type_of_message?"request":"approval",displayType:l?"booking_update":void 0,data:Object.assign({},t.metadata,{booking_id:t.metadata.booking_id,service_type:t.metadata.service_type,total_owner_cost:h,occurrences:t.metadata.occurrences||[]}),isFromMe:o,onPress:()=>{t.metadata.booking_id&&e.navigate("BookingDetails",{bookingId:t.metadata.booking_id,from:"MessageHistory"})},isProfessional:I?.is_professional,onApproveSuccess:e=>{e&&e.status&&(Be.default.alert("Success","Booking approved successfully"),Ze(_,1))},onApproveError:e=>{Be.default.alert("Error",e||"Failed to approve booking")},onEditDraft:m?()=>{(0,p.debugLog)("MBA6428: Edit Draft button clicked, calling handleEditDraft with bookingId:",a),dt(a)}:void 0,bookingStatus:i,hasChangeRequest:n||u,isNewestMessage:d,messageCreatedAt:c,isAfterConfirmation:l})}if("request_changes"===t.type_of_message){const o=!t.sent_by_other_user,a=t.metadata?.booking_id,n=t.metadata?.service_type,r=s?"Confirmed":t.metadata?.booking_status;let i=d;if(!i&&"request_changes"===t.type_of_message&&a){const e=M.some((e=>"send_approved_message"===e.type_of_message&&e.metadata?.booking_id===a&&new Date(e.timestamp)>new Date(t.timestamp)));i=!e,(0,p.debugLog)("MBA4321: Checking if request_changes is effectively newest:",{messageId:t.message_id,originalIsNewest:d,hasNewerApprovals:e,effectivelyNewest:i})}const l=s&&a&&M.some((e=>("send_approved_message"===e.type_of_message||"booking_confirmed"===e.type_of_message)&&e.metadata?.booking_id===a));return(0,p.debugLog)("MBA4321: Rendering change request message:",{bookingId:a,isFromMe:o,content:t.content,metadata:t.metadata,isNewestMessage:d,isNewestChangeRequest:i,isConfirmed:s,isRelatedToUpdate:l,hasOlderBookingConfirmedMessage:M.some((e=>"booking_confirmed"===e.type_of_message&&e.metadata?.booking_id===a&&new Date(e.timestamp)<new Date(t.timestamp))),hasOlderApprovalMessage:M.some((e=>"send_approved_message"===e.type_of_message&&e.metadata?.booking_id===a&&new Date(e.timestamp)<new Date(t.timestamp)))}),(0,T.jsx)(Na,{type:"request_changes",data:Object.assign({},t.metadata,{booking_id:a,service_type:n,cost_summary:t.metadata?.cost_summary||{},occurrences:t.metadata?.occurrences||[],content:t.content}),isFromMe:o,onPress:()=>{a&&e.navigate("BookingDetails",{bookingId:a,from:"MessageHistory"})},isProfessional:I?.is_professional,onApproveSuccess:e=>{e&&e.status&&(Be.default.alert("Success","Changes handled successfully"),Ze(_,1))},onApproveError:e=>{Be.default.alert("Error",e||"Failed to process changes")},onEditDraft:I?.is_professional?()=>{dt(a)}:void 0,bookingStatus:r,hasChangeRequest:!1,isNewestMessage:i,messageCreatedAt:c,isAfterConfirmation:l})}if("booking_confirmed"===t.type_of_message){const o=!t.sent_by_other_user,a=t.metadata?.booking_id,n=t.metadata?.service_type;let r="0.00",i="0.00";try{t.metadata.cost_summary&&(r=t.metadata.cost_summary.total_client_cost||"0.00",i=t.metadata.cost_summary.total_sitter_payout||"0.00")}catch(g){console.error("Error parsing cost data:",g)}return(0,p.debugLog)("MBA6428: Rendering booking confirmation message:",{bookingId:a,isFromMe:o,metadata:t.metadata,totalCost:r,payout:i,hasNewerApprovalRequests:l}),(0,T.jsx)(Na,{type:"booking_confirmed",data:{booking_id:a,service_type:n,cost_summary:{total_client_cost:r,total_sitter_payout:i}},isFromMe:o,onPress:()=>{a&&e.navigate("BookingDetails",{bookingId:a,from:"MessageHistory"})},isProfessional:I?.is_professional,bookingStatus:"Confirmed",isNewestMessage:d,messageCreatedAt:c,onEditDraft:I?.is_professional?()=>{(0,p.debugLog)("MBA6428: Edit Draft button clicked for confirmed booking with bookingId:",a),dt(a)}:void 0,hasNewerApprovalRequests:l})}const m=!t.sent_by_other_user;return(0,T.jsx)(r.default,{style:m?u.sentMessageContainer:u.receivedMessageContainer,children:(0,T.jsx)(r.default,{style:[u.messageCard,m?u.sentMessage:u.receivedMessage],children:(0,T.jsx)(r.default,{style:u.messageContent,children:(0,T.jsx)(i.default,{style:[u.messageText,m?u.sentMessageText:u.receivedMessageText],children:t.content})})})})}),[e,I,J,pe,be,_,Ze,M]),ot=()=>{const[e,t]=(0,a.useState)(""),o=(0,a.useRef)(null),n=(0,a.useRef)(!1),i=async()=>{if(e.trim()&&!P&&!n.current){n.current=!0,z(!0);try{const a=e.trim();t(""),o.current&&(o.current.style.height="24px",o.current.scrollTop=0);const n={message_id:"temp-".concat(Date.now(),"-").concat(Math.random().toString(36).substring(2,9)),content:a,timestamp:(new Date).toISOString(),status:"sent",type_of_message:"normal_message",is_clickable:!1,sent_by_other_user:!1,_isOptimistic:!0};R((e=>e.some((e=>e._isOptimistic&&e.content===a))?((0,p.debugLog)("MBA3210: Skipping duplicate optimistic message"),e):[n,...e]));const r=await Ke(a);R((e=>{const t=e.filter((e=>!(e._isOptimistic&&e.content===a)));return t.some((e=>e.message_id&&r.message_id&&String(e.message_id)===String(r.message_id)))?((0,p.debugLog)("MBA3210: Real message already exists, skipping"),t):[r,...t]}))}catch(a){console.error("Failed to send message:",a),t(e),R((e=>e.filter((e=>!e._isOptimistic)))),Be.default.alert("Error","Failed to send message. Please try again.")}finally{z(!1),setTimeout((()=>{n.current=!1}),300)}}};return(0,T.jsxs)(r.default,{style:u.inputInnerContainer,children:[(0,T.jsx)("textarea",{ref:o,style:u.webInput,placeholder:"Type a message...",value:e,onChange:e=>{t(e.target.value),(()=>{if(o.current){const e=o.current.scrollTop;o.current.style.height="inherit";const t=Math.min(o.current.scrollHeight,120);o.current.style.height="".concat(t,"px"),o.current.scrollHeight>120&&(o.current.scrollTop=e)}})()},onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),i())},disabled:P,rows:1}),(0,T.jsx)(_e.default,{mode:"contained",onPress:i,disabled:P,style:[u.sendButton,c<=600&&u.sendButtonMobile],children:P?(0,T.jsx)(ao.default,{color:f.theme.colors.whiteText,size:"small"}):c<=600?(0,T.jsx)(S.default,{name:"arrow-up",size:16,color:f.theme.colors.whiteText}):"Send"})]})},nt=()=>{const[e,t]=(0,a.useState)(""),o=(0,a.useRef)(null),n=(0,a.useRef)(!1);return(0,T.jsxs)(r.default,{style:u.inputContainer,children:[(0,T.jsx)(q.default,{ref:o,style:u.input,placeholder:"Type a message...",value:e,onChangeText:t,multiline:!0,blurOnSubmit:!1,editable:!P}),(0,T.jsx)(_e.default,{mode:"contained",onPress:async()=>{if(e.trim()&&!P&&!n.current){n.current=!0,z(!0);try{const o=e.trim();t("");const a={message_id:"temp-".concat(Date.now(),"-").concat(Math.random().toString(36).substring(2,9)),content:o,timestamp:(new Date).toISOString(),status:"sent",type_of_message:"normal_message",is_clickable:!1,sent_by_other_user:!1,_isOptimistic:!0};R((e=>e.some((e=>e._isOptimistic&&e.content===o))?((0,p.debugLog)("MBA3210: Skipping duplicate optimistic message"),e):[a,...e]));const n=await Ke(o);R((e=>{const t=e.filter((e=>!(e._isOptimistic&&e.content===o)));return t.some((e=>e.message_id&&n.message_id&&String(e.message_id)===String(n.message_id)))?((0,p.debugLog)("MBA3210: Real message already exists, skipping"),t):[n,...t]}))}catch(o){console.error("Failed to send message:",o),t(e),R((e=>e.filter((e=>!e._isOptimistic)))),Be.default.alert("Error","Failed to send message. Please try again.")}finally{z(!1),setTimeout((()=>{n.current=!1}),300)}}},disabled:P,children:P?(0,T.jsx)(ao.default,{color:f.theme.colors.primary,size:"small"}):"Send"})]})},rt=("web"===n.default.OS?(0,T.jsx)(ot,{}):(0,T.jsx)(nt,{}),e=>{fe(e)}),it=()=>(0,T.jsxs)(r.default,{style:u.conversationListContainer,children:[(0,T.jsx)(r.default,{style:u.searchContainer,children:(0,T.jsxs)(r.default,{style:[u.searchInputContainer,B&&{borderColor:f.theme.colors.primary}],children:[(0,T.jsx)(S.default,{name:"magnify",size:20,color:f.theme.colors.placeholder,style:u.searchIcon}),(0,T.jsx)(q.default,{style:u.searchInput,placeholder:"Search conversations",placeholderTextColor:f.theme.colors.placeholder,value:ge,onChangeText:rt,onFocus:()=>k(!0),onBlur:()=>k(!1)}),ge.length>0&&(0,T.jsx)(s.default,{style:u.clearButton,onPress:()=>fe(""),children:(0,T.jsx)(S.default,{name:"close-circle",size:16,color:f.theme.colors.placeholder})})]})}),K.map((e=>{const t=e.participant1_id===he?e.participant2_name:e.participant1_name;W&&console.log("MBA98765 Rendering conversation item:",{convId:e.conversation_id,convIdType:typeof e.conversation_id,selectedId:_,selectedIdType:typeof _,isSelected:String(e.conversation_id)===String(_)});const o=String(e.conversation_id)===String(_),a=Me?Me(String(e.conversation_id)):0;return a>0&&(0,p.debugLog)("MBA4321: Conversation ".concat(e.conversation_id," has ").concat(a," unread messages")),(0,T.jsx)(s.default,{style:[u.conversationItem,o&&u.selectedConversation],onPress:()=>{W&&console.log("MBA98765 Setting selected conversation:",{id:e.conversation_id,type:typeof e.conversation_id}),A(e.conversation_id),De&&a>0&&((0,p.debugLog)("MBA4321: Explicitly marking ONLY conversation ".concat(e.conversation_id," as read when clicked")),De(e.conversation_id))},children:(0,T.jsxs)(r.default,{style:u.conversationContent,children:[(0,T.jsxs)(r.default,{style:u.conversationHeader,children:[(0,T.jsx)(r.default,{style:{flexDirection:"row",alignItems:"center",flex:1},children:(0,T.jsx)(i.default,{style:u.conversationName,children:t||e.name||e.other_user_name||"Unknown"})}),(0,T.jsx)(i.default,{style:u.conversationTime,children:new Date(e.last_message_time).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),(0,T.jsxs)(r.default,{style:u.conversationLastMessageContainer,children:[(0,T.jsx)(i.default,{style:[u.conversationLastMessage,o&&u.activeConversationText,(e.unread||a>0)&&!o&&u.unreadMessage],numberOfLines:1,children:e.last_message}),a>0&&!o&&(0,T.jsx)(r.default,{style:u.unreadBadge,children:(0,T.jsx)(i.default,{style:u.unreadBadgeText,children:a})})]}),e.bookingStatus&&(0,T.jsx)(r.default,{style:[u.bookingStatusContainer,u["booking".concat(e.bookingStatus,"Status")]||u.bookingPendingStatus],children:(0,T.jsx)(i.default,{style:u.bookingStatus,children:e.bookingStatus})})]})},e.conversation_id)}))]}),st=a.memo((({messages:e,renderMessage:t,loadMoreMessages:o,isLoadingMore:a,hasMore:n,forceRerender:r})=>(0,T.jsx)(Rt.default,{data:e,renderItem:t,keyExtractor:e=>{if(e.message_id)return"message-".concat(e.message_id);const t=e.timestamp||e.created_at||Date.now(),o=e.sent_by_other_user?"other":"self",a=e.content?"".concat(e.content.substring(0,10),"-").concat(e.content.length):"no-content",n=e.type_of_message||"normal";return"message-".concat(t,"-").concat(o,"-").concat(n,"-").concat(a)},style:u.messageList,onEndReached:o,onEndReachedThreshold:.3,inverted:!0,contentContainerStyle:{flexGrow:1,justifyContent:"flex-end",paddingTop:16},maintainVisibleContentPosition:{minIndexForVisible:0,autoscrollToTopThreshold:10},ListFooterComponent:a&&(0,T.jsx)(ao.default,{size:"small",color:f.theme.colors.primary,style:u.loadingMore}),initialNumToRender:20,maxToRenderPerBatch:10,windowSize:15,removeClippedSubviews:!1,extraData:r,getItemLayout:(e,t)=>({length:100,offset:100*t,index:t})}))),lt=()=>_?(0,T.jsxs)(r.default,{style:u.mainSection,children:[c>900&&(0,T.jsx)(r.default,{style:u.messageHeader,children:(0,T.jsxs)(r.default,{style:u.messageHeaderContent,children:[(0,T.jsx)(U.default,{source:I?.profile_photo||o(4456),style:u.profilePhoto}),(0,T.jsx)(i.default,{style:u.messageHeaderName,children:I?.other_user_name}),pe&&be?.draft_id&&(0,T.jsxs)(s.default,{style:u.editDraftButton,onPress:()=>{be?.draft_id&&ct(be.draft_id)},children:[(0,T.jsx)(S.default,{name:"pencil",size:20,color:f.theme.colors.primary}),(0,T.jsx)(i.default,{style:u.editDraftText,children:"Edit Draft"})]})]})}),(0,T.jsx)(r.default,{style:u.messageSection,children:(0,T.jsx)(r.default,{style:u.messagesContainer,children:x?(0,T.jsxs)(r.default,{style:u.loadingContainer,children:[(0,T.jsx)(ao.default,{size:"large",color:f.theme.colors.primary}),(0,T.jsx)(i.default,{style:u.loadingText,children:"Loading messages..."})]}):0===M.length?(0,T.jsx)(i.default,{style:u.emptyText,children:"No messages yet, start the conversation!"}):(0,T.jsx)(st,{messages:M,renderMessage:tt,loadMoreMessages:et,isLoadingMore:ae,hasMore:X,forceRerender:Te})})}),(0,T.jsx)(r.default,{style:u.inputSection,children:(0,T.jsxs)(r.default,{style:u.inputContainer,children:[(0,T.jsxs)(r.default,{style:u.attachButtonContainer,children:[(0,T.jsx)(s.default,{style:u.attachButton,onPress:()=>E(!O),children:(0,T.jsx)(S.default,{name:O?"close":"plus",size:24,color:f.theme.colors.primary})}),O&&(0,T.jsx)(r.default,{style:u.dropdownMenu,children:(0,T.jsxs)(s.default,{style:u.dropdownItem,onPress:()=>{Qe(),E(!1)},children:[(0,T.jsx)(S.default,{name:"calendar-plus",size:20,color:f.theme.colors.primary}),(0,T.jsx)(i.default,{style:u.dropdownText,children:I?.is_professional?"Create Booking":"Request Booking"})]})})]}),"web"===n.default.OS?(0,T.jsx)(ot,{}):(0,T.jsx)(nt,{})]})})]}):null,dt=async e=>{if((0,p.debugLog)("MBA6428: handleEditDraft called with booking ID:",e),!e)return(0,p.debugLog)("MBA6428: Error - No booking ID provided"),void Be.default.alert("Error","Missing booking information. Please try again.");try{v(!0),(0,p.debugLog)("MBA6428: Calling createDraftFromBooking API with booking ID:",e);const t=await(0,at.createDraftFromBooking)(e);if(t.error)return(0,p.debugLog)("MBA6428: Error returned from createDraftFromBooking:",t),void Be.default.alert("Error",t.message||"Failed to create draft from booking. Please try again.");t&&t.draft_id?((0,p.debugLog)("MBA6428: Draft created successfully:",t),ye(!0),xe(t.draft_data),me(t.draft_id),we(!1),setTimeout((()=>{(0,p.debugLog)("MBA6428: Opening BookingStepModal with draft:",t.draft_id),ce(!0)}),100)):((0,p.debugLog)("MBA6428: Error - Invalid response from createDraftFromBooking:",t),Be.default.alert("Error","Failed to create draft from booking. Please try again."))}catch(t){(0,p.debugLog)("MBA6428: Error creating draft from booking:",t),Be.default.alert("Error","Failed to create draft from booking. Please try again.")}finally{v(!1)}},ct=e=>{if((0,p.debugLog)("MBA6428: handleOpenExistingDraft called with draft ID:",e),!e)return(0,p.debugLog)("MBA6428: Error - No draft ID provided"),void Be.default.alert("Error","Missing draft information. Please try again.");try{me(e),we(!1),setTimeout((()=>{(0,p.debugLog)("MBA6428: Opening BookingStepModal with existing draft:",e),ce(!0)}),100)}catch(t){(0,p.debugLog)("MBA6428: Error opening booking modal with draft:",t),Be.default.alert("Error","Failed to open booking draft. Please try again.")}};return(0,a.useEffect)((()=>{if(!I||!_)return;const e=I.other_user_name||"Unknown user";return(0,p.debugLog)('MBA3210: [OTHER USER STATUS] Setting up polling for "'.concat(e,'" online status')),()=>{(0,p.debugLog)('MBA3210: [OTHER USER STATUS] Cleaning up polling interval for "'.concat(e,'"'))}}),[I,_]),(0,a.useEffect)((()=>()=>{(0,p.debugLog)("MBA3210: MessageHistory unmounting, cleaning up websocket references")}),[]),(0,a.useEffect)((()=>{const e=()=>{(0,p.debugLog)("MBA3210: Page unloading, but keeping websocket alive for session restore")};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}}),[]),(0,a.useEffect)((()=>(Ie&&Ie("MessageHistory"),()=>{})),[]),(0,a.useEffect)((()=>(Ie&&((0,p.debugLog)("MBA4321: Updating route in MessageNotificationContext to MessageHistory"),Ie("MessageHistory")),()=>{(0,p.debugLog)("MBA4321: Cleaning up message notification tracking for MessageHistory")})),[Ie]),(0,a.useEffect)((()=>{_&&De&&((0,p.debugLog)("MBA4321: Marking conversation ".concat(_," as read")),De(_))}),[_,De]),(0,a.useEffect)((()=>{if(!le.current)return;return(async()=>{try{Z([]),R([]),A(null),D(null),g(!0),j(!1),oe(1),ee(!0),Le.current=null;let e=null;if("web"===n.default.OS){const t=new URL(window.location.href).searchParams.get("conversationId");t&&(e=t,(0,p.debugLog)("MBA4321: Using conversation ID ".concat(t," from URL parameters")))}!e&&t.params?.conversationId&&(e=t.params.conversationId,(0,p.debugLog)("MBA4321: Using conversation ID ".concat(e," from route parameters")),!0===t.params.isProfessional&&(ze.current=!0));const o=await $e();e?(A(e),(0,p.debugLog)("MBA4321: Setting initially selected conversation to ".concat(e))):"web"===n.default.OS&&c>900&&o?.length>0&&(A(o[0].conversation_id),(0,p.debugLog)("MBA4321: Auto-selecting first conversation ".concat(o[0].conversation_id," on desktop")))}catch(e){console.error("Error initializing MessageHistory:",e)}finally{le.current=!1,se(!1)}})(),()=>{(0,p.debugLog)("MBA4321: Cleaning up MessageHistory component"),Le.current=null,window.selectedConversationId=null}}),[]),(0,a.useEffect)((()=>{{const e=()=>{(0,p.debugLog)("MBA3210: Page unloading, but keeping websocket alive for session restore")};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}}}),[]),(0,a.useEffect)((()=>{_&&(Ee.current.clear(),We.current.clear(),Oe.current=!1)}),[_]),(0,T.jsxs)(Se.default,{style:[u.container,c<=900&&_&&u.mobileContainer,{marginLeft:c>900?H?70:250:0}],children:[m?(0,T.jsxs)(r.default,{style:{flex:1,justifyContent:"center",alignItems:"center"},children:[(0,T.jsx)(ao.default,{size:"large",color:f.theme.colors.primary}),(0,T.jsx)(i.default,{style:{marginTop:16,color:f.theme.colors.placeholder},children:"Loading conversations..."})]}):$.length>0?(0,T.jsx)(T.Fragment,{children:(0,T.jsx)(r.default,{style:u.contentContainer,children:c<=900?_?(0,T.jsxs)(r.default,{style:u.mobileMessageView,children:[(0,T.jsx)(r.default,{style:[u.mobileHeader,{backgroundColor:f.theme.colors.surfaceContrast}],children:(0,T.jsxs)(r.default,{style:u.mobileHeaderContent,children:[(0,T.jsx)(s.default,{style:u.backArrow,onPress:()=>A(null),children:(0,T.jsx)(S.default,{name:"arrow-left",size:24,color:f.theme.colors.primary})}),(0,T.jsx)(r.default,{style:u.mobileHeaderNameContainer,children:(0,T.jsx)(i.default,{style:u.mobileHeaderName,children:I?.name||I?.other_user_name})}),pe&&be?.draft_id&&(0,T.jsxs)(s.default,{style:[u.editDraftButton,u.mobileEditDraftButton,{position:"absolute",right:10,top:"50%",transform:[{translateY:-20}]}],onPress:()=>{be?.draft_id&&ct(be.draft_id)},children:[(0,T.jsx)(S.default,{name:"pencil",size:16,color:f.theme.colors.primary}),(0,T.jsxs)(r.default,{style:{alignItems:"center"},children:[(0,T.jsx)(i.default,{style:[u.editDraftText,{fontSize:12,lineHeight:14}],children:"Edit"}),(0,T.jsx)(i.default,{style:[u.editDraftText,{fontSize:12,lineHeight:14}],children:"Draft"})]})]})]})}),lt()]}):it():(0,T.jsxs)(T.Fragment,{children:[it(),lt()]})})}):(0,T.jsxs)(r.default,{style:{flex:1,justifyContent:"center",alignItems:"center",padding:20},children:[(0,T.jsx)(S.default,{name:"message-text-outline",size:64,color:f.theme.colors.placeholder,style:{marginBottom:16}}),(0,T.jsx)(i.default,{style:{fontSize:20,fontWeight:"bold",color:f.theme.colors.text,marginBottom:8,textAlign:"center"},children:"No Messages Yet"}),(0,T.jsx)(i.default,{style:{fontSize:16,color:f.theme.colors.placeholder,marginBottom:24,textAlign:"center"},children:"professional"===Y?"Create services to start getting bookings and messages from owners":"Search professionals to find services and start messaging"}),(0,T.jsx)(_e.default,{mode:"contained",onPress:()=>(0,h.navigateToFrom)(e,"professional"===Y?"Services":"SearchProfessionalListing","MessageHistory"),style:{borderRadius:8},children:"professional"===Y?"Create Services":"Find Professionals"})]}),C&&(0,T.jsx)(r.default,{style:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.4)",justifyContent:"center",alignItems:"center",zIndex:1e3},children:(0,T.jsxs)(r.default,{style:{backgroundColor:f.theme.colors.surface,borderRadius:12,padding:24,alignItems:"center",shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:3.84,elevation:5},children:[(0,T.jsx)(ao.default,{size:"large",color:f.theme.colors.primary}),(0,T.jsx)(i.default,{style:{marginTop:16,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily},children:"Creating draft from booking..."})]})}),(0,T.jsx)(ha,{visible:F,onClose:()=>L(!1),onSubmit:async e=>{try{const t=await(0,p.getStorage)("userToken"),o=await w.default.post("".concat(b.API_BASE_URL,"/api/bookings/v1/request_booking/"),e,{headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"}});W&&console.log("MBABOSS Created booking with ID:",o.data.booking_id);const a=await w.default.post("".concat(b.API_BASE_URL,"/api/messages/v1/send_request_booking/"),Object.assign({},e,{booking_id:o.data.booking_id}),{headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"}});W&&console.log("Sent message response:",a.data),R((e=>[a.data,...e])),L(!1)}catch(t){console.error("Error creating booking:",t),Be.default.alert("Error","Unable to create booking. Please try again.",[{text:"OK"}])}},conversationId:_}),(0,T.jsx)(La,{visible:de,onClose:()=>{ce(!1),me(null),_&&((0,p.debugLog)("MBA6428: Refreshing message data after closing BookingStepModal"),Ze(_,1))},navigation:e,bookingId:ue,onComplete:e=>{if((0,p.debugLog)("MBA6428: Booking completed:",e),(0,p.debugLog)("MBA6428: New booking message:",e.message),(0,p.debugLog)("MBA6428: Message metadata:",e.message?.metadata),(0,p.debugLog)("MBA6428: Is this an update?",e.isUpdate),e.error)return Be.default.alert("Error",e.errorMessage||"Failed to process booking. Please try again."),ce(!1),me(null),void(_&&((0,p.debugLog)("MBA6428: Refreshing message data after booking error"),Ze(_,1)));if(e.message){R((t=>[e.message,...t]));const t=e.isUpdate?"Updated Booking Request":"Approval Request";Z((o=>o.map((o=>o.conversation_id===_?Object.assign({},o,{last_message:t,last_message_time:e.message.timestamp}):o))))}ye(!1),xe(null),ce(!1),me(null),_&&((0,p.debugLog)("MBA6428: Refreshing message data after successful booking completion"),Ze(_,1));const t=e.isUpdate?"Booking update request sent successfully!":"Booking request sent successfully!";Be.default.alert("Success",t)}}),(0,T.jsx)(Va,{visible:je,onClose:()=>we(!1),onContinueExisting:()=>{W&&console.log("MBA98765 handleContinueExisting:",{draftData:be,showDraftConfirmModal:je,showBookingStepModal:de}),we(!1),be?.draft_id?(me(be.draft_id),setTimeout((()=>{W&&console.log("MBA98765 Opening BookingStepModal with draft:",be.draft_id),ce(!0)}),100)):console.error("MBA98765 No draft_id found in draftData:",be)},onCreateNew:async()=>{we(!1),await Xe()}})]})};var Ja=o(61457),$a=o(74352);const Za=o.p+"static/media/.env.631343ad8d6b091e6ddd";var Ka=o(92844);let Qa=null,Xa=null,en=null,tn=null,on=null,an=null;let nn=null;"web"!==n.default.OS&&o.e(210).then(o.bind(o,79210)).then((e=>{nn=e.CardField}));const rn={supportedCountries:["US"],style:{base:{color:"#32325d",fontFamily:'"Helvetica Neue", Helvetica, sans-serif',fontSmoothing:"antialiased",fontSize:"16px","::placeholder":{color:"#aab7c4"}},invalid:{color:"#fa755a",iconColor:"#fa755a"}}},sn=({onChange:e,paymentType:t})=>{const o=en&&en(),n=tn&&tn(),[r,i]=(0,a.useState)({accountNumber:"",routingNumber:""});(0,a.useEffect)((()=>{o&&n&&e({complete:!1,stripe:o,elements:n,paymentType:t})}),[o,n,t]);const s=(a,s)=>{const l=Object.assign({},r,{[a]:s});i(l);const d=l.accountNumber.length>=9,c=9===l.routingNumber.length;e({complete:d&&c,value:l,stripe:o,elements:n,paymentType:t})};return(0,T.jsx)("div",{style:{padding:"10px 0"},children:"card"===t?(0,T.jsx)(on,{options:rn,onChange:a=>e(Object.assign({},a,{stripe:o,elements:n,paymentType:t}))}):(0,T.jsxs)("div",{children:[(0,T.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",marginBottom:"10px"},children:(0,T.jsx)("input",{className:"stripe-input",placeholder:"Account Number",value:r.accountNumber,onChange:e=>s("accountNumber",e.target.value),style:{padding:"10px",border:"1px solid #ccc",borderRadius:"4px",width:"50%",marginTop:"5px"}})}),(0,T.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",marginBottom:"10px"},children:(0,T.jsx)("input",{className:"stripe-input",placeholder:"Routing Number",value:r.routingNumber,onChange:e=>s("routingNumber",e.target.value),style:{padding:"10px",border:"1px solid #ccc",borderRadius:"4px",width:"50%",marginTop:"5px"}})})]})})},ln=({onChange:e,paymentType:t})=>nn?"bank"===t?(0,T.jsxs)(r.default,{style:[{marginRight:20}],children:[(0,T.jsx)(q.default,{placeholder:"Account Number",onChangeText:t=>e({complete:t.length>=9,value:{accountNumber:t}}),style:cn.input,keyboardType:"numeric"}),(0,T.jsx)(q.default,{placeholder:"Routing Number",onChangeText:t=>e({complete:9===t.length,value:{routingNumber:t}}),style:cn.input,keyboardType:"numeric"})]}):(0,T.jsx)(nn,{postalCodeEnabled:!1,onCardChange:e,style:{width:"100%",height:50,marginVertical:10}}):null,dn=({onChange:e,paymentType:t})=>((0,a.useEffect)((()=>{(async()=>{if("web"===n.default.OS){const e=await o.e(210).then(o.bind(o,79210)),t=await Promise.resolve().then(o.t.bind(o,32147,23));Qa=e.loadStripe(void 0),Xa=t.Elements,en=t.useStripe,tn=t.useElements,on=t.CardElement,an=t.IbanElement}})()}),[]),"web"===n.default.OS&&Xa&&Qa?(0,T.jsx)(Xa,{stripe:Qa,children:(0,T.jsx)(sn,{onChange:e,paymentType:t})}):(0,T.jsx)(ln,{onChange:e,paymentType:t})),cn=l.default.create({input:{height:50,borderWidth:1,borderColor:"#ddd",borderRadius:4,marginVertical:5,paddingHorizontal:10},bankInputsContainer:{marginHorizontal:16,marginBottom:16},bankInput:{marginBottom:16},container:{padding:16}});var un=o(32147);const{width:mn}=v.default.get("window"),gn=l.default.create({container:{flex:1,width:"100%",overflow:"hidden"},contentContainer:{padding:16,alignItems:"center",width:"100%"},sectionContainer:{width:"100%",maxWidth:500,alignSelf:"center"},card:{marginBottom:16,width:"100%",alignSelf:"center"},addButton:{marginTop:16,width:"100%"},segmentedButtons:{marginBottom:16,maxWidth:500,alignSelf:"center",minHeight:40},sectionTitle:{fontSize:20,fontWeight:"bold",color:f.theme.colors.primary},cardContent:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"},methodInfo:{flex:1},methodType:{fontSize:16,fontWeight:"bold"},primaryOptionsContainer:{marginTop:8,gap:4},checkboxRow:{flexDirection:"row",alignItems:"center"},checkbox:{margin:0,padding:0},checkboxLabel:{fontSize:14,color:f.theme.colors.text,marginLeft:-8},cardActions:{flexDirection:"row",alignItems:"center"},dialog:{width:"web"===n.default.OS?"90%":"100%",alignSelf:"center",maxWidth:500,marginHorizontal:"web"===n.default.OS?"auto":16},input:{marginBottom:16},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center"},loadingText:{marginLeft:8},errorText:{color:f.theme.colors.error,marginBottom:10},closeButton:{position:"absolute",right:5,top:5},loadingOverlay:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.7)",justifyContent:"center",alignItems:"center"},bankName:{fontSize:14,color:f.theme.colors.secondary,marginTop:4},verificationNeeded:{color:f.theme.colors.error,fontSize:12,marginTop:4},amountsContainer:{flexDirection:"row",justifyContent:"space-between",marginTop:16,marginBottom:16},amountInput:{width:"48%"},verificationText:{marginBottom:8,fontSize:14},headerContainer:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16,width:"100%"},addIconButton:{margin:0},webContainer:{display:"flex",flexDirection:"column",minHeight:"85vh",width:"100%",maxWidth:"100%",overflowX:"hidden"}}),hn=()=>{const e=(0,j.useNavigation)(),[t,s]=(0,a.useState)([]),[l,d]=(0,a.useState)(!1),[c,u]=(0,a.useState)(!1),[m,g]=(0,a.useState)(null),[h,y]=(0,a.useState)(null),[b,x]=(0,a.useState)({type:"card",cardNumber:"",expiryDate:"",cvc:"",accountNumber:"",routingNumber:""}),{isApprovedProfessional:w,is_DEBUG:C}=(0,a.useContext)(p.AuthContext),[v,B]=(0,a.useState)(!1),[k,_]=(0,a.useState)(!1),[A,I]=(0,a.useState)(null),[D,M]=(0,a.useState)(null),[R,P]=("web"!==n.default.OS&&stripeModule()?.useStripe(),(0,a.useState)(!0)),[z,F]=(0,a.useState)(null),[L,O]=(0,a.useState)(!1),[E,W]=(0,a.useState)(null),[N,U]=(0,a.useState)(null),[V,q]=(0,a.useState)({accountNumber:!1,routingNumber:!1}),[Y,G]=(0,a.useState)(!1),[J,$]=(0,a.useState)({first:"",second:""}),[Z,K]=(0,a.useState)(null),[Q,X]=(0,a.useState)(!1);if((0,a.useEffect)((()=>{s([{id:"1",type:"bank",accountNumber:"****1234",routingNumber:"123456789",isPrimaryPayment:!0,isPrimaryReceive:!0,is_verified:!0},{id:"2",type:"card",last4:"4242",brand:"Visa",isPrimaryPayment:!1,isPrimaryReceive:!1,is_verified:!0},{id:"3",type:"bank",accountNumber:"****5678",routingNumber:"987654321",isPrimaryPayment:!1,isPrimaryReceive:!1,is_verified:!0}])}),[]),(0,a.useEffect)((()=>{if("web"===n.default.OS){console.log("Stripe loading started"),P(!0);const e=async()=>{try{const e=await o.e(210).then(o.bind(o,79210)),t=await Promise.resolve().then(o.t.bind(o,32147,23));e&&t&&(console.log("Stripe modules loaded"),P(!1))}catch(z){console.error("Error loading Stripe modules:",z),P(!1)}};e()}else P(!1)}),[]),R)return C&&console.log("Loading indicator should be visible"),(0,T.jsx)(r.default,{style:gn.loadingContainer,children:(0,T.jsx)(ao.default,{size:"large",color:f.theme.colors.primary})});const ee=e=>{F(""),g(Object.assign({},e)),x({type:e.type,cardNumber:"",expiryDate:"",cvc:"",accountNumber:e.accountNumber||"",routingNumber:e.routingNumber||""}),d(!0)},te=e=>{I(Object.assign({},e)),M(null),_(!0)},oe=(e,t)=>{g({id:e}),y(t),u(!0)},ae=async()=>{B(!0);try{await new Promise((e=>setTimeout(e,2e3))),s((e=>e.map((e=>Object.assign({},e,"payment"===h&&{isPrimaryPayment:e.id===m.id},"receive"===h&&{isPrimaryReceive:e.id===m.id}))))),console.log("Primary method updated:",m)}catch(z){console.error("Failed to update primary method:",z)}finally{B(!1),u(!1),y(null)}},ne=async()=>{if(A.isPrimaryPayment&&A.isPrimaryReceive)M("This payment method is set as both your primary payment and receive method. Please select another payment method for both before deleting this one.");else if(A.isPrimaryPayment)M("This is your primary payment method. Please select another payment method before deleting this one.");else if(A.isPrimaryReceive)M("This is your primary receive method. Please select another receive method before deleting this one.");else{B(!0);try{await new Promise((e=>setTimeout(e,2e3))),s((e=>e.filter((e=>e.id!==A.id)))),console.log("Payment method deleted:",A),_(!1)}catch(z){console.error("Failed to delete payment method:",z),M("An error occurred while deleting the payment method. Please try again.")}finally{B(!1)}}},re=e=>{K(e),$({first:"",second:""}),G(!0),F(null)},ie=async()=>{P(!0),F(null);try{if(!Z)throw new Error("Missing required verification data");const e=parseInt(J.first),t=parseInt(J.second);if([e,t].some((e=>isNaN(e)||e<1||e>99)))throw new Error("Please enter valid amounts between 1 and 99 cents");const o=()=>new Promise(((o,a)=>{setTimeout((()=>{12===e&&12===t?o({success:!0}):a(new Error("The amounts entered do not match our records. Please verify the amounts and try again."))}),1e3)})),a=(await o(),e=>e.map((e=>e.id===Z.id?Object.assign({},e,{is_verified:!0}):e)));s((e=>a(e))),G(!1),K(null),$({first:"",second:""}),F("Bank account successfully verified!")}catch(e){console.error("Verification error:",e),F(e.message||"Failed to verify bank account. Please check the amounts and try again.")}finally{P(!1)}},se=e=>{console.log("Payment change event:",e),"web"===n.default.OS?("card"===b.type?O(e.complete):(e.value&&q((t=>Object.assign({},t,{accountNumber:e.value.accountNumber?.length>=9||t.accountNumber,routingNumber:9===e.value.routingNumber?.length||t.routingNumber}))),O(V.accountNumber&&V.routingNumber)),W({stripe:e.stripe,elements:e.elements,complete:e.complete,paymentType:b.type,value:e.value}),"bank"===b.type&&e.value&&x((t=>Object.assign({},t,{accountNumber:e.value.accountNumber||t.accountNumber,routingNumber:e.value.routingNumber||t.routingNumber})))):(O(e.complete),W(e))},le=async()=>{if("card"===b.type){if(!L)return void F("Please complete card details")}else if("bank"===b.type&&(!V.accountNumber||!V.routingNumber))return void F("Please complete both account number and routing number");P(!0),F(null);try{if("web"===n.default.OS){if(!E.stripe||!E.elements)throw new Error("Stripe not initialized");let e;if("card"===b.type){if(e=await E.stripe.createPaymentMethod({type:"card",card:E.elements.getElement(un.CardElement)}),console.log("Card payment method result:",e),e.error)throw new Error(e.error.message);const t={id:e.paymentMethod.id,type:"card",last4:e.paymentMethod.card.last4,brand:e.paymentMethod.card.brand,is_verified:!1};s((e=>[...e,t]))}else{if(e=await E.stripe.createToken("bank_account",{country:"US",currency:"usd",routing_number:E.value.routingNumber,account_number:E.value.accountNumber,account_holder_type:"individual"}),console.log("Bank token creation result:",e),e.error||!e.token)throw new Error(e.error?.message||"Invalid routing number. Please check and try again.");const t={id:e.token.id,type:"bank",accountNumber:"****".concat(e.token.bank_account.last4),routingNumber:E.value.routingNumber,bankName:e.token.bank_account.bank_name,is_verified:!1};s((e=>[...e,t])),F("Bank account added but requires verification. Two small deposits will be made to your account in 1-2 business days. Please check your account and return to verify the amounts.")}d(!1)}else{const{paymentMethod:e,error:t}=await(0,Ka.createPaymentMethod)({type:b.type,card:E,is_receive_payment:m?.isPrimaryReceive||!1});if(t)throw new Error(t.message);s((t=>[...t,e]))}d(!1)}catch(e){console.error("Payment method error:",e),F(e.message||"Failed to save payment method")}finally{P(!1)}};return(0,T.jsxs)(jt,{fullWidthHeader:!0,children:[(0,T.jsx)(bt,{title:"Payment Methods",onBackPress:()=>e.navigate("More")}),(0,T.jsxs)(H.default,{style:gn.container,contentContainerStyle:gn.contentContainer,children:[(0,T.jsxs)(r.default,{style:gn.sectionContainer,children:[(0,T.jsxs)(r.default,{style:gn.headerContainer,children:[(0,T.jsx)(i.default,{style:gn.sectionTitle,children:"Payment Methods"}),(0,T.jsx)(Ja.default,{icon:()=>(0,T.jsx)(S.default,{name:"plus",size:24,color:f.theme.colors.primary}),onPress:()=>(async()=>{if(F(null),g(null),x({type:"card",cardNumber:"",expiryDate:"",cvc:"",accountNumber:"",routingNumber:""}),d(!0),C&&console.log("MBA: Setting modalLoading to true"),X(!0),"web"===n.default.OS)if(C&&console.log("MBA: Initializing Stripe elements for web"),E&&E.stripe&&E.elements)C&&console.log("MBA: Stripe elements already initialized");else{C&&console.log("MBA: Stripe elements not initialized, setting up now");try{const{loadStripe:e}=await o.e(210).then(o.bind(o,79210)),t=await e(Za);if(t){C&&console.log("MBA: Stripe loaded successfully");const e=t.elements();W({stripe:t,elements:e,complete:!1,paymentType:"card",value:{}})}}catch(z){C&&console.error("MBA: Error initializing Stripe elements:",z)}}setTimeout((()=>{C&&console.log("MBA: Setting modalLoading to false"),X(!1)}),500)})(),style:gn.addIconButton})]}),t.map((e=>(e=>(0,T.jsx)(Ko.default,{style:gn.card,children:(0,T.jsxs)(Ko.default.Content,{children:[(0,T.jsxs)(r.default,{style:gn.cardContent,children:[(0,T.jsxs)(r.default,{style:gn.methodInfo,children:[(0,T.jsx)(i.default,{style:gn.methodType,children:"card"===e.type?"".concat(e.brand," \u2022\u2022\u2022\u2022 ").concat(e.last4):"Bank Account ".concat(e.accountNumber||"\u2022\u2022\u2022\u2022 undefined")}),e.bankName&&(0,T.jsx)(i.default,{style:gn.bankName,children:e.bankName}),!e.is_verified&&(0,T.jsx)(i.default,{style:gn.verificationNeeded,children:"card"===e.type?"Card Verification In Progress":"Bank Account Verification Required"})]}),(0,T.jsxs)(r.default,{style:gn.cardActions,children:[!e.is_verified&&"bank"===e.type&&(0,T.jsx)(_e.default,{onPress:()=>re(e),mode:"contained",children:"Verify"}),e.is_verified&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(Ja.default,{icon:()=>(0,T.jsx)(S.default,{name:"pencil",size:20,color:f.theme.colors.primary}),onPress:()=>ee(e)}),(0,T.jsx)(Ja.default,{icon:()=>(0,T.jsx)(S.default,{name:"delete",size:20,color:f.theme.colors.error}),onPress:()=>te(e)})]})]})]}),e.is_verified&&(0,T.jsxs)(r.default,{style:gn.primaryOptionsContainer,children:[(0,T.jsxs)(r.default,{style:gn.checkboxRow,children:[(0,T.jsx)(Ja.default,{icon:()=>(0,T.jsx)(S.default,{name:e.isPrimaryPayment?"checkbox-marked":"checkbox-blank-outline",size:24,color:f.theme.colors.primary}),onPress:()=>oe(e.id,"payment"),style:gn.checkbox}),(0,T.jsx)(i.default,{style:gn.checkboxLabel,children:e.isPrimaryPayment?"Primary Payment Method":"Make Primary Payment Method"})]}),"bank"===e.type&&w&&(0,T.jsxs)(r.default,{style:gn.checkboxRow,children:[(0,T.jsx)(Ja.default,{icon:()=>(0,T.jsx)(S.default,{name:e.isPrimaryReceive?"checkbox-marked":"checkbox-blank-outline",size:24,color:f.theme.colors.primary}),onPress:()=>oe(e.id,"receive"),style:gn.checkbox}),(0,T.jsx)(i.default,{style:gn.checkboxLabel,children:e.isPrimaryReceive?"Primary Receive Method":"Make Primary Receive Method"})]})]})]})},e.id))(e)))]}),(C&&(console.log("MBA: Rendering Add Payment Method Modal"),console.log("MBA: modalLoading state:",Q)),(0,T.jsx)(Ae.default,{children:(0,T.jsxs)(Ie.default,{visible:l,onDismiss:()=>d(!1),style:gn.dialog,children:[(0,T.jsx)(Ie.default.Title,{children:"Add Payment Method"}),(0,T.jsx)(Ja.default,{icon:()=>(0,T.jsx)(S.default,{name:"close",size:24,color:f.theme.colors.text}),onPress:()=>d(!1),style:gn.closeButton}),(0,T.jsx)(Ie.default.Content,{children:Q?(0,T.jsxs)(r.default,{style:gn.loadingContainer,children:[(0,T.jsx)(ao.default,{size:"large",color:f.theme.colors.primary}),(0,T.jsx)(i.default,{style:gn.loadingText,children:"Loading..."})]}):(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)($a.default,{value:b.type,onValueChange:e=>x(Object.assign({},b,{type:e})),buttons:[{value:"card",label:"Credit Card"},{value:"bank",label:"Bank Account"}],style:gn.segmentedButtons}),(0,T.jsx)(dn,{onChange:se,paymentType:b.type},b.type),z&&(0,T.jsx)(i.default,{style:gn.errorText,children:z})]})}),(0,T.jsxs)(Ie.default.Actions,{children:[(0,T.jsx)(_e.default,{onPress:()=>d(!1),disabled:R,children:"Cancel"}),(0,T.jsx)(_e.default,{onPress:le,disabled:R||"card"===b.type&&!L||"bank"===b.type&&(!V.accountNumber||!V.routingNumber),loading:R,children:"Save"})]})]})})),(0,T.jsx)(Ae.default,{children:(0,T.jsxs)(Ie.default,{visible:c,onDismiss:()=>u(!1),style:gn.dialog,children:[(0,T.jsx)(Ie.default.Title,{children:"receive"===h?"Confirm Primary Receive Method":"Confirm Primary Payment Method"}),(0,T.jsx)(Ja.default,{icon:()=>(0,T.jsx)(S.default,{name:"close",size:24,color:f.theme.colors.text}),onPress:()=>u(!1),style:gn.closeButton}),(0,T.jsxs)(Ie.default.Content,{children:[(0,T.jsx)(i.default,{children:"receive"===h?"Are you sure you want to make this your primary receive method?":"Are you sure you want to make this your primary payment method?"}),v&&(0,T.jsxs)(r.default,{style:gn.loadingContainer,children:[(0,T.jsx)(ao.default,{animating:!0,color:f.theme.colors.primary}),(0,T.jsx)(i.default,{style:gn.loadingText,children:"receive"===h?"Updating primary receive method...":"Updating primary payment method..."})]})]}),(0,T.jsxs)(Ie.default.Actions,{children:[(0,T.jsx)(_e.default,{onPress:()=>u(!1),disabled:v,children:"Cancel"}),(0,T.jsx)(_e.default,{onPress:ae,disabled:v,children:"Confirm"})]})]})}),(0,T.jsx)(Ae.default,{children:(0,T.jsxs)(Ie.default,{visible:k,onDismiss:()=>_(!1),style:gn.dialog,children:[(0,T.jsx)(Ie.default.Title,{children:"Confirm Delete Payment Method"}),(0,T.jsx)(Ja.default,{icon:()=>(0,T.jsx)(S.default,{name:"close",size:24,color:f.theme.colors.text}),onPress:()=>_(!1),style:gn.closeButton}),(0,T.jsxs)(Ie.default.Content,{children:[D?(0,T.jsx)(i.default,{style:gn.errorText,children:D}):(0,T.jsx)(i.default,{children:"Are you sure you want to delete this payment method?"}),v&&(0,T.jsxs)(r.default,{style:gn.loadingContainer,children:[(0,T.jsx)(ao.default,{animating:!0,color:f.theme.colors.primary}),(0,T.jsx)(i.default,{style:gn.loadingText,children:"Deleting payment method..."})]})]}),(0,T.jsxs)(Ie.default.Actions,{children:[(0,T.jsx)(_e.default,{onPress:()=>_(!1),disabled:v,children:"Cancel"}),(0,T.jsx)(_e.default,{onPress:ne,disabled:v||D,children:"Confirm"})]})]})}),(0,T.jsx)(Ae.default,{children:(0,T.jsxs)(Ie.default,{visible:Y,onDismiss:()=>G(!1),style:gn.dialog,children:[(0,T.jsx)(Ie.default.Title,{children:"Verify Bank Account"}),(0,T.jsx)(Ja.default,{icon:()=>(0,T.jsx)(S.default,{name:"close",size:24,color:f.theme.colors.text}),onPress:()=>G(!1),style:gn.closeButton}),(0,T.jsxs)(Ie.default.Content,{children:[(0,T.jsx)(i.default,{style:gn.verificationText,children:"A deposit will be made to your bank account in 1-2 business days of adding your bank account. Please enter the two small deposit amounts that were made to your account:"}),(0,T.jsxs)(r.default,{style:gn.amountsContainer,children:[(0,T.jsx)(ke.default,{label:"First Amount (cents)",value:J.first,onChangeText:e=>$((t=>Object.assign({},t,{first:e}))),keyboardType:"numeric",style:gn.amountInput,mode:"outlined",placeholder:"32"}),(0,T.jsx)(ke.default,{label:"Second Amount (cents)",value:J.second,onChangeText:e=>$((t=>Object.assign({},t,{second:e}))),keyboardType:"numeric",style:gn.amountInput,mode:"outlined",placeholder:"45"})]}),z&&(0,T.jsx)(i.default,{style:gn.errorText,children:z})]}),(0,T.jsxs)(Ie.default.Actions,{children:[(0,T.jsx)(_e.default,{onPress:()=>G(!1),disabled:R,children:"Cancel"}),(0,T.jsx)(_e.default,{onPress:ie,loading:R,disabled:R||!J.first||!J.second,children:"Verify"})]})]})})]})]})},fn=(e,t)=>l.default.create({mainContainer:{flex:1,backgroundColor:f.theme.colors.background,height:"100vh",overflow:"hidden",position:"fixed",top:0,left:0,right:0,bottom:0,marginLeft:e>900?t?70:250:0,transition:"margin-left 0.3s ease"},container:{flex:1},content:{flex:1,backgroundColor:f.theme.colors.background,paddingTop:"android"===n.default.OS?Te.default.currentHeight:0},listSection:{backgroundColor:f.theme.colors.surface},webContent:{width:"100%",maxWidth:e>900?800:600,alignSelf:"center",padding:e<=900?10:16},webListItem:{borderBottomWidth:1,borderBottomColor:f.theme.colors.border,paddingVertical:e<=900?8:12},listItemTitle:{fontSize:e<=900?f.theme.fontSizes.medium:f.theme.fontSizes.large,fontFamily:f.theme.fonts.regular.fontFamily},warningContainer:{backgroundColor:"#FFF3CD",padding:f.theme.spacing.small,marginHorizontal:f.theme.spacing.small,marginTop:f.theme.spacing.small,borderRadius:4},warningText:{color:"#856404",textAlign:"center"}}),pn=({navigation:e})=>{const{screenWidth:t,isCollapsed:o,is_DEBUG:i}=(0,a.useContext)(p.AuthContext),[s,l]=(0,a.useState)(t<=900),d=fn(t,o);(0,a.useEffect)((()=>{l(t<=900)}),[t]);const c=[{title:"Change Password",icon:"lock-reset",route:"ChangePassword"},{title:"Notification Preferences",icon:"bell-outline",route:"NotificationPreferences"},{title:"Privacy Settings",icon:"shield-account",route:"PrivacySettings"},{title:"Language",icon:"translate",route:"LanguageSettings"},{title:"Display & Accessibility",icon:"palette",route:"DisplaySettings"},{title:"Data Usage",icon:"chart-bar",route:"DataUsage"},{title:"About",icon:"information-outline",route:"About"}];return(0,T.jsx)(r.default,{style:d.mainContainer,children:(0,T.jsx)(Se.default,{style:d.container,children:(0,T.jsxs)(r.default,{style:d.content,children:[s&&(0,T.jsx)(bt,{title:"Settings",onBackPress:()=>e.navigate("More")}),(0,T.jsx)(r.default,{style:d.webContent,children:(0,T.jsx)(xo.default,{style:d.listSection,children:c.map(((o,r)=>(0,T.jsxs)(a.Fragment,{children:[(0,T.jsx)(bo.default,{title:o.title,titleStyle:d.listItemTitle,left:e=>"web"===n.default.OS?(0,T.jsx)(S.default,{name:o.icon,size:t<=900?20:24,color:f.theme.colors.primary}):(0,T.jsx)(oo.default,Object.assign({},e,{icon:o.icon})),onPress:()=>e.navigate(o.route),style:[d.webListItem,{paddingHorizontal:t<=900?8:16}]}),r<c.length-1&&(0,T.jsx)(jo.default,{})]},r)))})})]})})})},yn="Zen Exotics",bn=l.default.create({container:{flex:1,padding:20,width:"100%",maxWidth:800,alignSelf:"center"},contentContainer:{paddingBottom:"web"===n.default.OS?16:80},title:{fontSize:24,fontWeight:"bold",marginBottom:10,color:f.theme.colors.primary},date:{fontSize:16,marginBottom:20,color:f.theme.colors.text},sectionTitle:{fontSize:20,fontWeight:"bold",marginTop:20,marginBottom:10,color:f.theme.colors.primary},paragraph:{fontSize:16,marginBottom:10,color:f.theme.colors.text},listItem:{fontSize:16,marginBottom:5,marginLeft:10,color:f.theme.colors.text}}),xn=()=>{const e=(0,j.useNavigation)();return(0,T.jsxs)(jt,{fullWidthHeader:!0,children:[(0,T.jsx)(bt,{title:"Privacy Policy",onBackPress:()=>(0,h.handleBack)(e)}),(0,T.jsxs)(H.default,{style:bn.container,contentContainerStyle:bn.contentContainer,children:[(0,T.jsxs)(i.default,{style:bn.title,children:["Privacy Policy for ",yn]}),(0,T.jsx)(i.default,{style:bn.date,children:"Effective Date: 10/21/2024"}),(0,T.jsxs)(i.default,{style:bn.paragraph,children:["By accessing or using ",yn,", you agree to the practices described in this Privacy Policy. If you do not agree with these terms, please discontinue the use of our services immediately."]}),(0,T.jsx)(i.default,{style:bn.sectionTitle,children:"Information We Collect"}),(0,T.jsxs)(i.default,{style:bn.paragraph,children:["When you use ",yn,", we collect several types of information to ensure the best experience for both professionals and pet owners. This includes:"]}),(0,T.jsx)(i.default,{style:bn.listItem,children:"\u2022 Personal Information: Name, email, phone number, address, and service preferences."}),(0,T.jsx)(i.default,{style:bn.listItem,children:"\u2022 Payment Information: Card type, expiration date, and the last four digits of your payment card. Complete payment details are managed by third-party processors, and we do not store full card numbers."}),(0,T.jsx)(i.default,{style:bn.listItem,children:"\u2022 Health Data: Medical information about your pets (e.g., medical history, medications, vaccinations, behavioral traits). By using this service, you consent to our use of this health data as we deem necessary for analytics, research, marketing, or any other purpose related to improving our services."}),(0,T.jsx)(i.default,{style:bn.listItem,children:"\u2022 Device Data: We collect information about your device, including IP address, browser type, operating system, and other usage data."}),(0,T.jsx)(i.default,{style:bn.listItem,children:"\u2022 Location Data: With your permission, we collect location information to match professionals and owners more effectively. Disabling location services may limit certain app features."}),(0,T.jsx)(i.default,{style:bn.listItem,children:"\u2022 Cookies and Tracking: We use cookies and tracking technologies to improve user experience and monitor traffic patterns. You can disable cookies in your browser settings."}),(0,T.jsx)(i.default,{style:bn.sectionTitle,children:"How We Use Your Data"}),(0,T.jsx)(i.default,{style:bn.paragraph,children:"We use the data we collect to:"}),(0,T.jsx)(i.default,{style:bn.listItem,children:"\u2022 Facilitate bookings and transactions between professionals and owners."}),(0,T.jsx)(i.default,{style:bn.listItem,children:"\u2022 Verify professional eligibility through background checks."}),(0,T.jsx)(i.default,{style:bn.listItem,children:"\u2022 Provide customer support and resolve disputes between users."}),(0,T.jsx)(i.default,{style:bn.listItem,children:"\u2022 Improve app functionality through analytics and feedback."}),(0,T.jsx)(i.default,{style:bn.listItem,children:"\u2022 Manage communications between professionals and owners."}),(0,T.jsx)(i.default,{style:bn.listItem,children:"\u2022 Use health data for internal analysis and marketing purposes. We retain control over how this data is used."}),(0,T.jsx)(i.default,{style:bn.sectionTitle,children:"Sharing of Information"}),(0,T.jsx)(i.default,{style:bn.paragraph,children:"We may share your data in the following ways:"}),(0,T.jsx)(i.default,{style:bn.listItem,children:"\u2022 With Other Users: For bookings, we share relevant information between professionals and pet owners."}),(0,T.jsx)(i.default,{style:bn.listItem,children:"\u2022 With Third-Party Providers: Payment processors, analytics providers, and background check services may access limited information to perform their services."}),(0,T.jsx)(i.default,{style:bn.listItem,children:"\u2022 Legal and Compliance Purposes: We may disclose information if required by law or to protect the safety and security of our users."}),(0,T.jsx)(i.default,{style:bn.listItem,children:"\u2022 Business Transfers: In case of a merger, sale, or acquisition, your data may be transferred to a new owner."}),(0,T.jsx)(i.default,{style:bn.listItem,children:"\u2022 Aggregated Data: We may share non-identifiable, aggregated data for research or business purposes."}),(0,T.jsx)(i.default,{style:bn.sectionTitle,children:"Your Rights and Choices"}),(0,T.jsx)(i.default,{style:bn.listItem,children:"\u2022 Account Management: You can update or delete your account information through the app settings."}),(0,T.jsx)(i.default,{style:bn.listItem,children:"\u2022 Health Data Access: You may review the health data associated with your pets but agree that we control its use."}),(0,T.jsx)(i.default,{style:bn.listItem,children:"\u2022 Location Services: Manage your location preferences through your device settings."}),(0,T.jsx)(i.default,{style:bn.listItem,children:"\u2022 Cookie Preferences: You can opt out of personalized ads and tracking through your browser settings."}),(0,T.jsx)(i.default,{style:bn.sectionTitle,children:"Security and Data Retention"}),(0,T.jsx)(i.default,{style:bn.paragraph,children:"We implement reasonable security measures to protect your data, though no system is entirely secure. We retain your data as long as needed for operational purposes or as required by law."}),(0,T.jsx)(i.default,{style:bn.sectionTitle,children:"International Data Transfers"}),(0,T.jsx)(i.default,{style:bn.paragraph,children:"Your data may be processed or stored in countries outside your own. By using the app, you agree to these transfers, even if those countries have different data protection laws."}),(0,T.jsx)(i.default,{style:bn.sectionTitle,children:"Changes to This Privacy Policy"}),(0,T.jsx)(i.default,{style:bn.paragraph,children:"We may update this policy from time to time to reflect changes in our practices or services. We will notify you of significant changes through the app or via email. Continued use of the app constitutes acceptance of the revised policy."}),(0,T.jsx)(i.default,{style:bn.sectionTitle,children:"Contact Us"}),(0,T.jsx)(i.default,{style:bn.paragraph,children:"If you have questions or concerns about this policy, please contact us:"}),(0,T.jsx)(i.default,{style:bn.listItem,children:"Email: zam.hh.llc@gmail.com"}),(0,T.jsx)(i.default,{style:bn.listItem,children:"Phone: 7195106341"})]})]})},jn=l.default.create({container:{flex:1,padding:20,backgroundColor:f.theme.colors.background},title:{fontSize:24,fontWeight:"bold",marginBottom:20,color:f.theme.colors.primary}}),wn=()=>(0,T.jsxs)(r.default,{style:jn.container,children:[(0,T.jsx)(i.default,{style:jn.title,children:"Professional Settings"}),(0,T.jsx)(i.default,{children:"Manage your professional profile and preferences here."})]}),Cn="Zen Exotics",vn=l.default.create({container:{flex:1,padding:20},contentContainer:{paddingBottom:80},title:{fontSize:24,fontWeight:"bold",marginBottom:10,color:f.theme.colors.primary},date:{fontSize:16,marginBottom:20,color:f.theme.colors.text},sectionTitle:{fontSize:20,fontWeight:"bold",marginTop:20,marginBottom:10,color:f.theme.colors.primary},paragraph:{fontSize:16,marginBottom:10,color:f.theme.colors.text},listItem:{fontSize:16,marginBottom:5,marginLeft:10,color:f.theme.colors.text},testSection:{marginBottom:20,borderWidth:1,borderColor:f.theme.colors.border,padding:10,borderRadius:4}}),Sn=()=>{const e=(0,j.useNavigation)();return(0,T.jsxs)(jt,{fullWidthHeader:!0,children:[(0,T.jsx)(bt,{title:"Terms of Service",onBackPress:()=>(0,h.handleBack)(e)}),(0,T.jsx)(i.default,{children:"Terms of Service coming soon. Right now we are in prototype mode, so no data is saved except for email/name if you choose to contact us through this platform, then it is saved for marketing purposes."}),(0,T.jsxs)(H.default,{style:vn.container,contentContainerStyle:vn.contentContainer,children:[(0,T.jsxs)(i.default,{style:vn.title,children:["Terms of Service for ",Cn]}),(0,T.jsx)(i.default,{style:vn.date,children:"Effective Date: 10/21/2024"}),(0,T.jsxs)(i.default,{style:vn.paragraph,children:["Welcome to ",Cn,'! By using our platform, mobile application, or any services offered through our platform (collectively, "the Service"), you agree to be bound by these Terms of Service ("Terms"). If you do not agree to these Terms, you must discontinue use of the Service immediately.']}),(0,T.jsx)(i.default,{style:vn.sectionTitle,children:"1. Description of Service"}),(0,T.jsxs)(i.default,{style:vn.paragraph,children:[Cn," provides an online platform for connecting pet owners with professionals specializing in exotic animals, as well as dogs and cats. Users can book services, communicate with professionals, and manage pet-related services, including payments and reviews."]}),(0,T.jsx)(i.default,{style:vn.sectionTitle,children:"2. User Accounts"}),(0,T.jsx)(i.default,{style:vn.paragraph,children:"To use certain features of the Service, you must create an account. You are responsible for keeping your account information accurate and secure."}),(0,T.jsx)(i.default,{style:vn.listItem,children:"\u2022 Eligibility: Users must be at least 18 years old to create an account."}),(0,T.jsx)(i.default,{style:vn.listItem,children:"\u2022 Account Security: You are responsible for all activities under your account. Notify us immediately if you suspect unauthorized use."}),(0,T.jsx)(i.default,{style:vn.listItem,children:"\u2022 Account Termination: We reserve the right to suspend or terminate accounts at our sole discretion for violations of these Terms."}),(0,T.jsx)(i.default,{style:vn.sectionTitle,children:"3. User Conduct and Acceptable Use"}),(0,T.jsx)(i.default,{style:vn.paragraph,children:"By using the Service, you agree:"}),(0,T.jsx)(i.default,{style:vn.listItem,children:"\u2022 To provide accurate and complete information."}),(0,T.jsx)(i.default,{style:vn.listItem,children:"\u2022 Not to engage in fraudulent or unlawful activities."}),(0,T.jsx)(i.default,{style:vn.listItem,children:"\u2022 Not to use the Service for spam, harassment, or abusive behavior toward other users."}),(0,T.jsx)(i.default,{style:vn.listItem,children:"\u2022 To comply with all local, national, and international laws applicable to your activities on the platform."}),(0,T.jsx)(i.default,{style:vn.paragraph,children:"Failure to comply with these rules may result in account suspension or termination."}),(0,T.jsx)(i.default,{style:vn.sectionTitle,children:"4. Pet and Health Information"}),(0,T.jsx)(i.default,{style:vn.paragraph,children:"You acknowledge that the Service involves the collection and sharing of health-related data for pets. By using the Service, you agree to provide accurate medical information for your animals and grant us permission to use and share this data as outlined in our Privacy Policy."}),(0,T.jsx)(i.default,{style:vn.sectionTitle,children:"5. Payment Terms"}),(0,T.jsx)(i.default,{style:vn.paragraph,children:"All transactions between pet owners and professionals must be processed through the platform's payment system, powered by Stripe. You agree to the following:"}),(0,T.jsx)(i.default,{style:vn.listItem,children:"\u2022 Booking Fees: You will be charged the agreed-upon amount at the time of booking."}),(0,T.jsx)(i.default,{style:vn.listItem,children:"\u2022 Cancellations and Refunds: Cancellations are subject to our cancellation policy, which may result in partial or no refunds."}),(0,T.jsx)(i.default,{style:vn.listItem,children:"\u2022 Payouts to Professionals: Professionals must provide accurate payment information and comply with local tax regulations."}),(0,T.jsx)(i.default,{style:vn.sectionTitle,children:"6. Liability and Disclaimer of Warranties"}),(0,T.jsxs)(i.default,{style:vn.paragraph,children:["You acknowledge that ",Cn," does not guarantee the quality or safety of services provided by professionals. Our platform only facilitates connections between users."]}),(0,T.jsx)(i.default,{style:vn.listItem,children:"\u2022 We are not liable for any injury, damage, or loss caused during the provision of pet care services."}),(0,T.jsx)(i.default,{style:vn.listItem,children:'\u2022 The Service is provided "as is" and "as available" without warranties of any kind, express or implied.'}),(0,T.jsx)(i.default,{style:vn.sectionTitle,children:"7. Dispute Resolution Between Users"}),(0,T.jsxs)(i.default,{style:vn.paragraph,children:["Disputes between users (e.g., pet owners and professionals) must first be addressed directly between the parties. If no resolution is reached, ",Cn," may mediate but is not responsible for the outcome."]}),(0,T.jsx)(i.default,{style:vn.sectionTitle,children:"8. Limitation of Liability"}),(0,T.jsxs)(i.default,{style:vn.paragraph,children:["In no event shall ",Cn,", its affiliates, officers, employees, or partners be liable for:"]}),(0,T.jsx)(i.default,{style:vn.listItem,children:"\u2022 Indirect, incidental, or consequential damages arising from the use of the Service."}),(0,T.jsx)(i.default,{style:vn.listItem,children:"\u2022 Any claims exceeding the amount you paid through the Service within the last six months."}),(0,T.jsx)(i.default,{style:vn.sectionTitle,children:"9. Termination and Suspension"}),(0,T.jsx)(i.default,{style:vn.paragraph,children:"We reserve the right to suspend or terminate access to the Service at any time without notice if:"}),(0,T.jsx)(i.default,{style:vn.listItem,children:"\u2022 You breach these Terms."}),(0,T.jsx)(i.default,{style:vn.listItem,children:"\u2022 Your actions jeopardize the safety or security of the platform or other users."}),(0,T.jsx)(i.default,{style:vn.sectionTitle,children:"10. Modifications to the Service and Terms"}),(0,T.jsx)(i.default,{style:vn.paragraph,children:"We may modify these Terms or the Service at any time. Significant changes will be communicated via email or in-app notifications. Continued use of the Service after changes constitutes acceptance of the revised Terms."}),(0,T.jsx)(i.default,{style:vn.sectionTitle,children:"11. Intellectual Property Rights"}),(0,T.jsxs)(i.default,{style:vn.paragraph,children:["All content, trademarks, and logos on the platform are owned by or licensed to ",Cn,". You may not copy, modify, or distribute content without express permission."]}),(0,T.jsx)(i.default,{style:vn.sectionTitle,children:"12. Governing Law and Dispute Resolution"}),(0,T.jsx)(i.default,{style:vn.paragraph,children:"These Terms are governed by the laws of El Paso County, Colorado, without regard to conflict of law principles."}),(0,T.jsx)(i.default,{style:vn.listItem,children:"\u2022 Arbitration Clause: All disputes arising under these Terms shall be resolved through binding arbitration in Colorado Springs, Colorado."}),(0,T.jsx)(i.default,{style:vn.listItem,children:"\u2022 Class Action Waiver: You agree to waive your right to participate in class action lawsuits."}),(0,T.jsx)(i.default,{style:vn.sectionTitle,children:"13. Indemnification"}),(0,T.jsxs)(i.default,{style:vn.paragraph,children:["You agree to indemnify and hold harmless ",Cn,", its affiliates, officers, and employees from any claims, damages, or liabilities arising from your use of the Service or breach of these Terms."]}),(0,T.jsx)(i.default,{style:vn.sectionTitle,children:"14. Third-Party Links and Services"}),(0,T.jsxs)(i.default,{style:vn.paragraph,children:["The platform may contain links to third-party websites or services. ",Cn," is not responsible for the content or actions of those third parties."]}),(0,T.jsx)(i.default,{style:vn.sectionTitle,children:"15. Contact Us"}),(0,T.jsx)(i.default,{style:vn.paragraph,children:"If you have questions about these Terms, please contact us:"}),(0,T.jsx)(i.default,{style:vn.listItem,children:"Email: zam.hh.llc@gmail.com"}),(0,T.jsx)(i.default,{style:vn.listItem,children:"Phone: 7195106341"}),(0,T.jsx)(i.default,{style:vn.sectionTitle,children:"Acknowledgment of Agreement"}),(0,T.jsxs)(i.default,{style:vn.paragraph,children:["By accessing or using ",Cn,", you acknowledge that you have read, understood, and agreed to these Terms of Service."]})]})]})},Tn=l.default.create({container:{flex:1,padding:20,backgroundColor:f.theme.colors.background},title:{fontSize:24,fontWeight:"bold",marginBottom:20,color:f.theme.colors.primary}}),Bn=()=>(0,T.jsxs)(H.default,{style:Tn.container,children:[(0,T.jsx)(i.default,{style:Tn.title,children:"Help / FAQ"}),(0,T.jsx)(i.default,{children:"Frequently asked questions and help topics go here..."})]}),kn=l.default.create({container:{flex:1,width:"100%",alignItems:"center",justifyContent:"flex-start",paddingVertical:20},contentWrapper:{padding:20,alignItems:"center",backgroundColor:"white",borderRadius:10,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3},title:{fontSize:f.theme.fontSizes.largeLarge,fontWeight:"bold",marginBottom:10,color:f.theme.colors.primary,fontFamily:f.theme.fonts.header.fontFamily,textAlign:"center"},subtitle:{fontSize:f.theme.fontSizes.medium,marginBottom:20,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily,textAlign:"center"},input:{backgroundColor:f.theme.colors.surface,borderRadius:5,borderColor:f.theme.colors.border,borderWidth:1,padding:15,marginBottom:15,fontSize:f.theme.fontSizes.medium,width:"100%",fontFamily:f.theme.fonts.regular.fontFamily},messageInput:{height:120,textAlignVertical:"top"},button:{backgroundColor:f.theme.colors.primary,padding:15,borderRadius:5,alignItems:"center",width:"100%",marginTop:10},buttonText:{color:f.theme.colors.whiteText,fontSize:f.theme.fontSizes.mediumLarge,fontWeight:"bold",fontFamily:f.theme.fonts.regular.fontFamily},successMessage:{color:f.theme.colors.success,textAlign:"center",marginBottom:10,fontSize:f.theme.fontSizes.medium,fontFamily:f.theme.fonts.regular.fontFamily,width:"100%"},disabledButton:{opacity:.7}}),_n=()=>{const e=(0,j.useNavigation)(),{screenWidth:t}=(0,a.useContext)(p.AuthContext),[o,n]=(0,Q.useForm)("mkgobpro"),[l,d]=(0,a.useState)(""),[c,u]=(0,a.useState)(""),[m,g]=(0,a.useState)(""),[h,y]=(0,a.useState)(!1),[x,C]=(0,a.useState)(""),v=t<768,S=v?"90%":"600px",B=v?"100%":"800px";return o.succeeded?(0,T.jsxs)(jt,{fullWidthHeader:!0,contentWidth:B,children:[(0,T.jsx)(bt,{title:"Contact Us",onBackPress:()=>e.navigate("More")}),(0,T.jsx)(r.default,{style:kn.container,children:(0,T.jsxs)(r.default,{style:[kn.contentWrapper,{width:S}],children:[(0,T.jsx)(i.default,{style:[kn.title,{color:f.theme.colors.primary}],children:"Thanks for reaching out!"}),(0,T.jsx)(i.default,{style:kn.successMessage,children:"We'll get back to you soon."})]})})]}):(0,T.jsxs)(jt,{fullWidthHeader:!0,contentWidth:B,children:[(0,T.jsx)(bt,{title:"Contact Us",onBackPress:()=>e.navigate("More")}),(0,T.jsx)(r.default,{style:kn.container,children:(0,T.jsxs)(r.default,{style:[kn.contentWrapper,{width:S}],children:[(0,T.jsx)(i.default,{style:kn.title,children:"Contact Us"}),(0,T.jsx)(i.default,{style:kn.subtitle,children:"Get in touch with our support team"}),(0,T.jsx)(q.default,{style:kn.input,placeholder:"Your Name",value:l,onChangeText:d,name:"name"}),(0,T.jsx)(Q.ValidationError,{prefix:"Name",field:"name",errors:o.errors}),(0,T.jsx)(q.default,{style:kn.input,placeholder:"Your Email",value:c,onChangeText:u,keyboardType:"email-address",name:"email",autoCapitalize:"none"}),(0,T.jsx)(Q.ValidationError,{prefix:"Email",field:"email",errors:o.errors}),(0,T.jsx)(q.default,{style:[kn.input,kn.messageInput],placeholder:"Your Message",value:m,onChangeText:g,multiline:!0,name:"message"}),(0,T.jsx)(Q.ValidationError,{prefix:"Message",field:"message",errors:o.errors}),x?(0,T.jsx)(i.default,{style:kn.successMessage,children:x}):null,(0,T.jsx)(s.default,{style:[kn.button,h&&kn.disabledButton],onPress:async()=>{if(l&&c&&m){y(!0),C("");try{if(200!==(await w.default.post("".concat(b.API_BASE_URL,"/api/users/v1/contact/"),{name:l,email:c,message:m})).status)throw new Error("Failed to send message");C("Your message has been sent successfully!"),d(""),u(""),g("")}catch(e){C(e.response?.data?.error||"Failed to send message. Please try again later."),console.error(e)}finally{y(!1)}}else C("Please fill in all fields")},disabled:h||o.submitting,children:(0,T.jsx)(i.default,{style:kn.buttonText,children:h||o.submitting?"Sending...":"Send Message"})})]})})]})};var An=o(802);const In=(0,a.forwardRef)((({placeholder:e,onChangeText:t,initialValue:o="",style:n},i)=>{const{colors:s}=(0,G.useTheme)(),[l,d]=(0,a.useState)(o),c=(0,a.useRef)(null);(0,a.useEffect)((()=>{o!==l&&d(o)}),[o]);return(0,T.jsxs)(r.default,{style:[Dn.container,n,{backgroundColor:s.surface}],children:[(0,T.jsx)(Ja.default,{icon:()=>(0,T.jsx)(ee.default,{name:"search",size:24,color:s.primary}),onPress:()=>c.current?.focus()}),(0,T.jsx)(q.default,{ref:c,style:[Dn.input,{color:s.text}],placeholder:e,placeholderTextColor:s.placeholder,value:l,onChangeText:e=>{e!==l&&(d(e),t(e))},autoFocus:!0,keyboardType:"default",returnKeyType:"search",blurOnSubmit:!1})]})})),Dn=l.default.create({container:{flexDirection:"row",alignItems:"center",borderRadius:25,elevation:2,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:2},input:{flex:1,fontSize:16,paddingVertical:8,paddingRight:8}}),Mn=(0,a.memo)(In),Rn=l.default.create({container:{flex:1,backgroundColor:f.theme.colors.background},androidSafeArea:{paddingTop:"android"===n.default.OS?Te.default.currentHeight:0},searchAndFilterContainer:{flexDirection:"row",alignItems:"center",margin:16,maxWidth:600,alignSelf:"center",width:"100%"},searchBar:{flex:1,marginRight:8,marginLeft:"web"===n.default.OS?0:8},filterButton:{minWidth:80,marginRight:"web"===n.default.OS?0:8},ownerList:{padding:16},ownerCard:{marginBottom:16,maxWidth:600,alignSelf:"center",width:"100%"},petTypes:{flexDirection:"row",marginTop:8},petChip:{marginRight:8},noOwnersContainer:{flex:1,justifyContent:"center",alignItems:"center"},modalContainer:{backgroundColor:"white",padding:20,margin:20,borderRadius:5,maxWidth:600,alignSelf:"center",width:"90%"},modalTitle:{marginBottom:10},filtersContainer:{flexDirection:"row",flexWrap:"wrap",marginBottom:20},filterChip:{margin:4},applyButton:{marginTop:10},closeButton:{marginTop:10,alignSelf:"flex-end"},closeIcon:{position:"absolute",top:10,right:10,zIndex:1}}),Pn=({navigation:e})=>{const{colors:t}=(0,G.useTheme)(),[o,i]=(0,a.useState)(""),[l,d]=(0,a.useState)([]),[c,u]=(0,a.useState)([]),[m,g]=(0,a.useState)(!1),[h,f]=(0,a.useState)([]);(0,a.useEffect)((()=>{p()}),[]);const p=async()=>{try{await new Promise((e=>setTimeout(e,1e3))),f(ue)}catch(e){console.error("Error fetching owners:",e)}},y=[{label:"Dog Sitting",value:"Dog"},{label:"Cat Sitting",value:"Cat"},{label:"Exotic Sitting",value:"Exotic"},{label:"Last Week",value:"week"},{label:"Last Month",value:"month"},{label:"Last Year",value:"year"}],b=(0,a.useCallback)((e=>{u((t=>t.includes(e)?t.filter((t=>t!==e)):[...t,e]))}),[]),x=(0,a.useCallback)((()=>{d(c),g(!1)}),[c]),j=(0,a.useMemo)((()=>h.filter((e=>{const t=e.name.toLowerCase().includes(o.toLowerCase()),a=0===l.length||l.every((t=>{if(["Dog","Cat","Exotic"].includes(t))return e.pet_types.includes(t);const o=new Date(e.last_booking),a=new Date;switch(t){case"week":const e=new Date;return e.setDate(a.getDate()-7),o>=e;case"month":const t=new Date;return t.setMonth(a.getMonth()-1),o>=t;case"year":const n=new Date;return n.setFullYear(a.getFullYear()-1),o>=n;default:return!0}}));return t&&a}))),[h,o,l]),w=(0,a.useCallback)((({item:t})=>(0,T.jsx)(s.default,{onPress:()=>e.navigate("OwnerHistory",{ownerId:t.id}),children:(0,T.jsx)(Ko.default,{style:Rn.ownerCard,children:(0,T.jsxs)(Ko.default.Content,{children:[(0,T.jsx)(Qo.default,{children:t.name}),(0,T.jsxs)(De.default,{children:["Last booking: ",t.last_booking]}),(0,T.jsx)(r.default,{style:Rn.petTypes,children:t.pet_types.map((e=>(0,T.jsx)(An.default,{style:Rn.petChip,children:e},e)))})]})})})),[e]),C=(0,a.useCallback)((e=>{i(e)}),[]);return"web"===n.default.OS?(0,T.jsxs)(r.default,{style:Rn.container,children:[(0,T.jsxs)(r.default,{style:Rn.searchAndFilterContainer,children:[(0,T.jsx)(Qe.default,{onPress:()=>{},children:(0,T.jsx)(Mn,{placeholder:"Search owners",onChangeText:C,initialValue:o,style:Rn.searchBar})}),(0,T.jsx)(_e.default,{mode:"outlined",onPress:()=>{u(l),g(!0)},style:Rn.filterButton,children:"Filters"})]}),j.length>0?(0,T.jsx)(Rt.default,{data:j,renderItem:w,keyExtractor:e=>e.id,contentContainerStyle:Rn.ownerList,keyboardShouldPersistTaps:"handled",removeClippedSubviews:!1}):(0,T.jsx)(r.default,{style:Rn.noOwnersContainer,children:(0,T.jsx)(De.default,{children:"No owners match your search or filters."})}),(0,T.jsx)(Ae.default,{children:(0,T.jsxs)(Ha.default,{visible:m,onDismiss:()=>g(!1),contentContainerStyle:Rn.modalContainer,children:[(0,T.jsx)(s.default,{onPress:()=>g(!1),style:Rn.closeIcon,children:(0,T.jsx)(S.default,{name:"close",size:24,color:"black"})}),(0,T.jsx)(Qo.default,{style:Rn.modalTitle,children:"Filters"}),(0,T.jsx)(r.default,{style:Rn.filtersContainer,children:y.map((e=>(0,T.jsx)(An.default,{style:Rn.filterChip,selected:c.includes(e.value),onPress:()=>b(e.value),icon:c.includes(e.value)?({size:e,color:t})=>(0,T.jsx)(S.default,{name:"check",size:e,color:t}):void 0,children:e.label},e.value)))}),(0,T.jsx)(_e.default,{mode:"contained",onPress:x,style:Rn.applyButton,children:"Apply Filters"})]})})]}):(0,T.jsxs)(Se.default,{style:[Rn.container,Rn.androidSafeArea],children:[(0,T.jsxs)(r.default,{style:Rn.searchAndFilterContainer,children:[(0,T.jsx)(Qe.default,{onPress:()=>{},children:(0,T.jsx)(Mn,{placeholder:"Search owners",onChangeText:C,initialValue:o,style:Rn.searchBar})}),(0,T.jsx)(_e.default,{mode:"outlined",onPress:()=>{u(l),g(!0)},style:Rn.filterButton,children:"Filters"})]}),j.length>0?(0,T.jsx)(Rt.default,{data:j,renderItem:w,keyExtractor:e=>e.id,contentContainerStyle:Rn.ownerList,keyboardShouldPersistTaps:"handled",removeClippedSubviews:!1}):(0,T.jsx)(r.default,{style:Rn.noOwnersContainer,children:(0,T.jsx)(De.default,{children:"No owners match your search or filters."})}),(0,T.jsx)(Ae.default,{children:(0,T.jsxs)(Ha.default,{visible:m,onDismiss:()=>g(!1),contentContainerStyle:Rn.modalContainer,children:[(0,T.jsx)(s.default,{onPress:()=>g(!1),style:Rn.closeIcon,children:(0,T.jsx)(S.default,{name:"close",size:24,color:"black"})}),(0,T.jsx)(Qo.default,{style:Rn.modalTitle,children:"Filters"}),(0,T.jsx)(r.default,{style:Rn.filtersContainer,children:y.map((e=>(0,T.jsx)(An.default,{style:Rn.filterChip,selected:c.includes(e.value),onPress:()=>b(e.value),icon:c.includes(e.value)?({size:e,color:t})=>(0,T.jsx)(S.default,{name:"check",size:e,color:t}):void 0,children:e.label},e.value)))}),(0,T.jsx)(_e.default,{mode:"contained",onPress:x,style:Rn.applyButton,children:"Apply Filters"})]})})]})},zn=({visible:e,onClose:t,serviceName:o,additionalRates:n=[],professionalName:l="Professional",onContactPress:d})=>{const[c,u]=(0,a.useState)(new Date),[m,g]=(0,a.useState)(new Date),[h,p]=(0,a.useState)(0),[y,b]=(0,a.useState)(!1),[x,j]=(0,a.useState)({}),[w,C]=(0,a.useState)(0),[v,S]=(0,a.useState)(0);return(0,a.useEffect)((()=>{const e={};n.forEach((t=>{e[t.title]=Object.assign({},t,{selected:!1})})),j(e)}),[n]),(0,a.useEffect)((()=>{(()=>{let e=y?40:20;e+=10*h,Object.entries(x).forEach((([t,o])=>{o.selected&&(e+=o.amount)})),C(e),S(.1*e)})()}),[h,y,x]),(0,T.jsx)(_.default,{visible:e,animationType:"slide",transparent:!0,onRequestClose:t,children:(0,T.jsx)(r.default,{style:Fn.modalContainer,children:(0,T.jsxs)(r.default,{style:Fn.modalContent,children:[(0,T.jsx)(s.default,{style:Fn.closeIcon,onPress:t,children:(0,T.jsx)(ee.default,{name:"close",size:24,color:f.theme.colors.text})}),(0,T.jsx)(i.default,{style:Fn.modalTitle,children:o}),(0,T.jsxs)(H.default,{style:Fn.scrollContent,showsVerticalScrollIndicator:!0,persistentScrollbar:!0,children:[(0,T.jsxs)(r.default,{style:Fn.rateItem,children:[(0,T.jsx)(i.default,{children:"Base Rate"}),(0,T.jsxs)(i.default,{children:["$",20]})]}),(0,T.jsxs)(r.default,{style:Fn.rateItem,children:[(0,T.jsxs)(i.default,{children:["Additional Animals ($",10," each)"]}),(0,T.jsxs)(r.default,{style:Fn.counterContainer,children:[(0,T.jsx)(s.default,{onPress:()=>p(Math.max(0,h-1)),style:Fn.counterButton,children:(0,T.jsx)(ee.default,{name:"remove",size:24,color:f.theme.colors.primary})}),(0,T.jsx)(i.default,{style:Fn.counterText,children:h}),(0,T.jsx)(s.default,{onPress:()=>p(h+1),style:Fn.counterButton,children:(0,T.jsx)(ee.default,{name:"add",size:24,color:f.theme.colors.primary})})]})]}),(0,T.jsxs)(r.default,{style:Fn.rateItem,children:[(0,T.jsxs)(i.default,{children:["Holiday Rate ($",40,")"]}),(0,T.jsx)($e.default,{value:y,onValueChange:b,trackColor:{false:"#767577",true:f.theme.colors.primary}})]}),Object.entries(x).map((([e,t])=>(0,T.jsxs)(r.default,{style:Fn.rateItem,children:[(0,T.jsxs)(i.default,{children:[e," ($",t.amount,")"]}),(0,T.jsx)($e.default,{value:t.selected,onValueChange:o=>{j(Object.assign({},x,{[e]:Object.assign({},t,{selected:o})}))},trackColor:{false:"#767577",true:f.theme.colors.primary}})]},e))),(0,T.jsxs)(r.default,{style:Fn.totalSection,children:[(0,T.jsxs)(r.default,{style:Fn.totalItem,children:[(0,T.jsx)(i.default,{style:Fn.totalLabel,children:"Subtotal:"}),(0,T.jsxs)(i.default,{style:Fn.totalAmount,children:["$",w]})]}),(0,T.jsxs)(r.default,{style:Fn.totalItem,children:[(0,T.jsx)(i.default,{style:Fn.totalLabel,children:"Service Fees (10%):"}),(0,T.jsxs)(i.default,{style:Fn.totalAmount,children:["$",v.toFixed(2)]})]}),(0,T.jsxs)(r.default,{style:[Fn.totalItem,Fn.finalTotal],children:[(0,T.jsx)(i.default,{style:[Fn.totalLabel,Fn.finalTotalText],children:"Total Cost:"}),(0,T.jsxs)(i.default,{style:[Fn.totalAmount,Fn.finalTotalText],children:["$",(w+v).toFixed(2)]})]})]})]}),(0,T.jsx)(s.default,{style:Fn.contactButton,onPress:d,children:(0,T.jsxs)(i.default,{style:Fn.contactButtonText,children:["Contact ",l]})})]})})})},Fn=l.default.create({modalContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0, 0, 0, 0.5)"},modalContent:{backgroundColor:f.theme.colors.surface,borderRadius:12,padding:20,paddingRight:15,width:"90%",maxHeight:"43%",maxWidth:400},scrollContent:{flexGrow:0,marginBottom:10,paddingRight:12,marginRight:-7},modalTitle:{fontSize:f.theme.fontSizes.large,fontWeight:"bold",marginBottom:15,textAlign:"center",marginTop:5,paddingHorizontal:30},dateSection:{marginBottom:20,flexDirection:"row",justifyContent:"space-between",gap:16},dateColumn:{flex:1},dateLabel:{marginBottom:8,fontSize:f.theme.fontSizes.smallMedium,color:f.theme.colors.text},rateItem:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:15},counterContainer:{flexDirection:"row",alignItems:"center"},counterButton:{padding:5},counterText:{marginHorizontal:10,fontSize:f.theme.fontSizes.medium},totalSection:{marginTop:20,borderTopWidth:1,borderTopColor:f.theme.colors.border,paddingTop:15},totalItem:{flexDirection:"row",justifyContent:"space-between",marginBottom:10},finalTotal:{borderTopWidth:1,borderTopColor:f.theme.colors.border,paddingTop:10,marginTop:5},totalLabel:{fontSize:f.theme.fontSizes.medium,fontWeight:"600"},totalAmount:{fontSize:f.theme.fontSizes.medium,fontWeight:"bold"},finalTotalText:{fontSize:f.theme.fontSizes.mediumLarge,fontWeight:"bold",color:f.theme.colors.primary},closeButton:{backgroundColor:f.theme.colors.primary,padding:12,borderRadius:8,alignItems:"center",marginTop:10},closeButtonText:{color:f.theme.colors.surface,fontSize:f.theme.fontSizes.medium,fontWeight:"600"},closeIcon:{position:"absolute",right:15,top:15,zIndex:1,padding:5},contactButton:{backgroundColor:f.theme.colors.primary,padding:12,borderRadius:8,alignItems:"center",marginTop:10},contactButtonText:{color:f.theme.colors.surface,fontSize:f.theme.fontSizes.medium,fontWeight:"600"}}),Ln=l.default.create({serviceCard:{backgroundColor:f.theme.colors.surface,borderRadius:12,padding:12,marginRight:12,width:280,height:220,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3,position:"relative",justifyContent:"space-between"},heartButton:{position:"absolute",right:8,top:8,zIndex:1},serviceName:{fontSize:f.theme.fontSizes.mediumLarge,fontWeight:"600",marginTop:8,marginBottom:6,fontFamily:f.theme.fonts.header.fontFamily,flexShrink:1},startingPrice:{fontSize:f.theme.fontSizes.medium+2,color:f.theme.colors.secondary,marginBottom:6,fontFamily:f.theme.fonts.regular.fontFamily},animalTypeContainer:{flexDirection:"row",flexWrap:"wrap",gap:4,marginBottom:8},animalType:{fontSize:f.theme.fontSizes.small+2,color:f.theme.colors.secondary,backgroundColor:f.theme.colors.background,borderRadius:8,paddingHorizontal:6,paddingVertical:2,fontFamily:f.theme.fonts.regular.fontFamily},calculateButton:{backgroundColor:f.theme.colors.primary,padding:10,borderRadius:8,alignItems:"center",marginTop:"auto"},calculateButtonText:{color:f.theme.colors.surface,fontSize:f.theme.fontSizes.medium,fontWeight:"600",fontFamily:f.theme.fonts.regular.fontFamily},contentContainer:{flex:1}}),On=({service:e,onHeartPress:t,isFavorite:o,professionalName:n,professionalId:l,navigation:d})=>{const[c,u]=(0,a.useState)(!1);return(0,T.jsxs)(r.default,{style:Ln.serviceCard,children:[(0,T.jsxs)(r.default,{style:Ln.contentContainer,children:[(0,T.jsx)(S.default,{name:e.icon,size:30,color:f.theme.colors.primary}),(0,T.jsx)(i.default,{numberOfLines:2,style:Ln.serviceName,children:e.name}),(0,T.jsxs)(i.default,{style:Ln.startingPrice,children:["Starting at $",e.startingPrice]}),(0,T.jsx)(r.default,{style:Ln.animalTypeContainer,children:e.animalTypes.map(((e,t)=>(0,T.jsx)(i.default,{style:Ln.animalType,children:e},t)))})]}),(0,T.jsx)(s.default,{style:Ln.calculateButton,onPress:()=>u(!0),children:(0,T.jsx)(i.default,{style:Ln.calculateButtonText,children:"Calculate Cost"})}),(0,T.jsx)(zn,{visible:c,onClose:()=>u(!1),serviceName:e.name,additionalRates:e.additionalRates||[],professionalName:n,professionalId:l,onContactPress:()=>{const e=fe.find((e=>e.professionalId===l));if(e)d.replace("MessageHistory",{selectedConversation:e.id,professionalName:n,professionalId:l});else{const e=((e,t,o)=>{const a="conv_".concat(Date.now()),n=o===he;return{id:a,participant1_id:n?o:e,participant2_id:n?e:o,role_map:{participant1_role:n?"owner":"professional",participant2_role:n?"professional":"owner"},lastMessage:"",timestamp:(new Date).toISOString(),unread:!1,bookingStatus:null}})(l,0,"current_user_id");fe.unshift(e),pe[e.id]=[],d.replace("MessageHistory",{selectedConversation:e.id,professionalName:n,professionalId:l})}u(!1)}})]})},En="web"===n.default.OS?o(27733).MapContainer:null,Wn=[{id:1,name:"Noah M.",service:"Fish Tank Cleaning",date:"Dec 02, 2024",rating:5,text:"Dina was fantastic with our dog! Sent lots of photos and clearly made sure she was comfortable. Will definitely use again!",photo:"https://via.placeholder.com/50"},{id:2,name:"Kaily J.",service:"Ferrier",date:"Nov 26, 2024",rating:4,text:"Dina always takes such good care of Elijah. He was having tummy problems today and she kept me updated all day on how he was doing.",photo:"https://via.placeholder.com/50"},{id:3,name:"Nadia U.",service:"Reptile Boarding & Habitat Maintenance",date:"Nov 19, 2024",rating:5,text:"She took such great care of our puppy! Sent pictures and videos the whole time, her backyard was super nice and clean \u2764\ufe0f my puppy was definitely in great hands! Bonus her dogs were so sweet with our puppy.",photo:"https://via.placeholder.com/50"},{id:4,name:"Vanessa G.",service:"Bird Feeding",date:"Nov 19, 2024",rating:5,text:"Dina was great! She communicated through the whole stay and sent plenty of videos and photos. 10/10",photo:"https://via.placeholder.com/50"}];if("web"===n.default.OS){const e=document.createElement("style");e.textContent="\n    .services-scroll::-webkit-scrollbar {\n      -webkit-appearance: none;\n    }\n\n    .services-scroll::-webkit-scrollbar:vertical {\n      width: 11px;\n    }\n\n    .services-scroll::-webkit-scrollbar:horizontal {\n      height: 11px;\n    }\n\n    .services-scroll::-webkit-scrollbar-thumb {\n      border-radius: 8px;\n      border: 2px solid white;\n      background-color: rgba(0, 0, 0, .5);\n    }\n  ",document.head.appendChild(e)}const Nn=l.default.create({scrollViewContent:{flexGrow:1,paddingBottom:"web"===n.default.OS?16:80,height:"web"===n.default.OS?"calc(100vh - 124px)":"100%",overflow:"auto"},content:{alignSelf:"center",padding:24},topSection:{flexDirection:"web"===n.default.OS?"row":"column",gap:24,marginBottom:24},gallerySection:{maxHeight:400,overflow:"hidden",marginBottom:24},photoGrid:{flexDirection:"row",flexWrap:"wrap",gap:8,maxHeight:320,overflow:"auto"},bottomSection:{flexDirection:"web"===n.default.OS?"row":"column",gap:24},servicesSection:{flex:"web"===n.default.OS?1:void 0,backgroundColor:f.theme.colors.background,padding:24,borderRadius:12,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3},aboutSection:{maxHeight:300,overflow:"auto",marginBottom:24,padding:16,backgroundColor:f.theme.colors.surface,borderRadius:12},profileHeader:{alignItems:"web"===n.default.OS?"flex-start":"center"},profileInfo:{alignItems:"web"===n.default.OS?"flex-start":"center"},hostingSection:{marginTop:24},hostTitle:{fontSize:18,fontWeight:"bold",marginBottom:12,fontFamily:f.theme.fonts.header.fontFamily},weightRanges:{gap:8},weightRange:{fontSize:16,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily},galleryPhoto:{width:"web"===n.default.OS?100:50,height:"web"===n.default.OS?100:50,borderRadius:8},centered:{flex:1,justifyContent:"center",alignItems:"center"},profilePhoto:{width:120,height:120,borderRadius:60,marginBottom:16,alignSelf:"center"},profilePhotoPlaceholder:{backgroundColor:f.theme.colors.surface,justifyContent:"center",alignItems:"center",marginBottom:10},name:{fontSize:24,fontWeight:"bold",marginBottom:4,textAlign:"center",fontFamily:f.theme.fonts.header.fontFamily},location:{fontSize:16,color:f.theme.colors.secondary,marginBottom:8,textAlign:"center",fontFamily:f.theme.fonts.regular.fontFamily},section:{padding:20,borderBottomWidth:1,borderBottomColor:f.theme.colors.border},sectionTitle:{fontSize:20,fontWeight:"bold",marginBottom:10,color:f.theme.colors.primary,fontFamily:f.theme.fonts.header.fontFamily},bioInput:{backgroundColor:f.theme.colors.surface},service:{fontSize:16,marginBottom:5},rateItem:{flexDirection:"row",alignItems:"center",marginBottom:10},rateLabel:{flex:1,fontSize:16},rateInput:{flex:1,backgroundColor:f.theme.colors.surface},photoGrid:{flexDirection:"row",flexWrap:"wrap"},petPhoto:{width:50,height:50,borderRadius:25,backgroundColor:f.theme.colors.surface,justifyContent:"center",alignItems:"center",borderWidth:1,borderColor:f.theme.colors.border},addPhotoButton:{width:100,height:100,margin:5,borderRadius:10,borderWidth:1,borderColor:f.theme.colors.primary,justifyContent:"center",alignItems:"center"},saveButton:{margin:20},ratingContainer:{flexDirection:"row",alignItems:"center",justifyContent:"center",marginBottom:16},rating:{fontSize:16,fontWeight:"bold",marginLeft:5},reviewCount:{fontSize:14,color:f.theme.colors.secondary,marginLeft:4},contactButton:{backgroundColor:f.theme.colors.primary,padding:12,borderRadius:8,alignSelf:"center"},contactButtonText:{fontSize:16,fontWeight:"bold",color:f.theme.colors.surface,textAlign:"center"},statsContainer:{flexDirection:"row",justifyContent:"space-around",marginBottom:20},statItem:{flexDirection:"row",alignItems:"center",marginRight:10},statText:{fontSize:16,marginLeft:5},bioText:{fontSize:18,lineHeight:28,color:f.theme.colors.text,overflow:"hidden",fontFamily:f.theme.fonts.regular.fontFamily},serviceItem:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:10},serviceText:{fontSize:8,fontFamily:f.theme.fonts.regular.fontFamily},servicePrice:{fontSize:14,color:f.theme.colors.secondary,fontFamily:f.theme.fonts.regular.fontFamily},skillsGrid:{flexDirection:"row",flexWrap:"wrap"},skillBadge:{backgroundColor:f.theme.colors.surface,padding:10,borderRadius:5,margin:5},skillText:{fontSize:16,fontFamily:f.theme.fonts.regular.fontFamily},photoGallery:{flexDirection:"row"},calculatorText:{fontSize:16,color:f.theme.colors.secondary,fontFamily:f.theme.fonts.regular.fontFamily},additionalRatesButton:{marginTop:16,paddingVertical:12,paddingHorizontal:16,borderRadius:6,backgroundColor:f.theme.colors.surface,alignItems:"center",borderWidth:1,borderColor:f.theme.colors.outline},additionalRatesText:{color:f.theme.colors.primary,fontSize:16,fontWeight:"600",fontFamily:f.theme.fonts.regular.fontFamily},calendarSection:{marginTop:24},readMoreButton:{marginTop:8},readMoreText:{color:f.theme.colors.primary,fontSize:16,fontWeight:"600",fontFamily:f.theme.fonts.regular.fontFamily},reviewsSection:{marginVertical:32,width:"100%",backgroundColor:f.theme.colors.background},reviewItem:{marginBottom:16,backgroundColor:f.theme.colors.surface,padding:16,borderRadius:12,maxWidth:"web"===n.default.OS?600:void 0},servicesSection:{backgroundColor:f.theme.colors.surface,padding:24,borderRadius:12,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3,marginBottom:24},mapContainer:{height:400,width:"100%",marginVertical:24},map:{flex:1},petsSection:{marginBottom:24,backgroundColor:f.theme.colors.surface,padding:16,borderRadius:12},petItem:{flexDirection:"row",alignItems:"center",marginBottom:12,padding:12,borderRadius:8,borderWidth:1,borderColor:f.theme.colors.border,backgroundColor:f.theme.colors.background},petInfo:{marginLeft:12,flex:1},petName:{fontSize:16,fontWeight:"600",marginBottom:2,fontFamily:f.theme.fonts.header.fontFamily},petBreed:{fontSize:14,color:f.theme.colors.secondary,marginBottom:2,fontFamily:f.theme.fonts.regular.fontFamily},petDetails:{fontSize:14,color:f.theme.colors.secondary,fontFamily:f.theme.fonts.regular.fontFamily},modalContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0, 0, 0, 0.5)"},aboutSubsections:{flexDirection:"web"===n.default.OS?"row":"column",gap:24},communicationSection:{flex:1},skillsSection:{flex:1},homeDetails:{flexDirection:"row",flexWrap:"wrap",gap:16},noReviews:{fontSize:16,color:f.theme.colors.secondary,fontStyle:"italic",textAlign:"center",marginTop:16},twoColumnLayout:{flexDirection:"row",gap:24},singleColumnLayout:{flexDirection:"column"},leftColumn:{flex:"web"===n.default.OS?1:void 0,maxWidth:"web"===n.default.OS?400:void 0},rightColumn:{flex:"web"===n.default.OS?2:void 0},calendar:{height:300,marginTop:16},serviceText:{fontSize:12,fontFamily:f.theme.fonts.regular.fontFamily,fontWeight:"100"},homeFeaturesGrid:{flexDirection:"row",flexWrap:"wrap",gap:8,marginTop:16},featureBubble:{backgroundColor:f.theme.colors.surface,paddingVertical:8,paddingHorizontal:16,borderRadius:20,borderWidth:1,borderColor:f.theme.colors.outline},featureText:{fontSize:14,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily},reviewItem:{marginBottom:24,backgroundColor:f.theme.colors.surface,padding:16,borderRadius:12},reviewHeader:{flexDirection:"row",marginBottom:12},reviewerPhoto:{width:40,height:40,borderRadius:20,marginRight:12},reviewerInfo:{flex:1},reviewerName:{fontSize:16,fontWeight:"600",marginBottom:4,fontFamily:f.theme.fonts.header.fontFamily},serviceInfo:{flexDirection:"row",alignItems:"center",gap:4},reviewText:{fontSize:14,lineHeight:20,fontFamily:f.theme.fonts.regular.fontFamily},modalTitle:{fontSize:20,fontWeight:"600",marginBottom:16,fontFamily:f.theme.fonts.header.fontFamily},modalScroll:{maxHeight:"web"===n.default.OS?"70vh":"80%"},closeButton:{marginTop:16,alignItems:"center",padding:12,backgroundColor:f.theme.colors.primary,borderRadius:8},closeButtonText:{color:"#fff",fontSize:16,fontWeight:"600",fontFamily:f.theme.fonts.regular.fontFamily},modalHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16},modalCloseIcon:{padding:8},modalScrollContent:{paddingBottom:24},modalContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0, 0, 0, 0.5)",padding:"web"===n.default.OS?40:20},reviewsGrid:{flexDirection:"row",flexWrap:"wrap",gap:16,marginTop:16},reviewItem:{backgroundColor:f.theme.colors.surface,padding:16,borderRadius:12,flex:1,minWidth:"web"===n.default.OS?300:"100%",marginBottom:0},specialistSection:{marginTop:24,backgroundColor:f.theme.colors.surface,padding:16,borderRadius:12},specialistText:{fontSize:16,lineHeight:24,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily},modalReviewItem:{marginBottom:16,width:"100%"},leftColumnMobile:{maxWidth:"100%",alignItems:"center"},seeAllButton:{borderWidth:1,borderColor:f.theme.colors.primary,paddingHorizontal:12,paddingVertical:6,borderRadius:8,alignSelf:"flex-start",minWidth:"auto",width:"auto"},seeAllButtonText:{color:f.theme.colors.primary,fontSize:16,fontWeight:"600",textAlign:"center",fontFamily:f.theme.fonts.regular.fontFamily},modalServicesGrid:{flexDirection:"row",flexWrap:"wrap",gap:16,justifyContent:"center",padding:16},reviewMeta:{gap:4},starContainer:{flexDirection:"row",alignItems:"center",marginBottom:4}}),Hn=({route:e,navigation:t})=>{const{width:d}=(0,ve.default)(),[c,u]=(0,a.useState)(null),[m,g]=(0,a.useState)(!1),[h,p]=(0,a.useState)(!1),[y,b]=(0,a.useState)(!1),[j,w]=(0,a.useState)(!1),[C,v]=(0,a.useState)([]),[B,k]=(0,a.useState)(!1),A=(()=>{const{width:e}=(0,ve.default)(),[t,o]=(0,a.useState)(!0);return(0,a.useEffect)((()=>{o("web"===n.default.OS&&e>=900)}),[e]),t})(),I={profileSection:{backgroundColor:f.theme.colors.surface,borderRadius:12,padding:16,marginBottom:16,alignItems:"center",width:"100%",display:d>=600?"flex":"block"},profileSectionMobile:{backgroundColor:f.theme.colors.surface,borderRadius:12,padding:16,marginBottom:16,alignItems:"center",width:"100%",maxWidth:500,alignSelf:"center",display:"flex",flexDirection:"column",alignItems:"center"},servicesBox:{backgroundColor:f.theme.colors.surface,padding:24,paddingTop:0,borderRadius:12,marginTop:24,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.2,shadowRadius:4,elevation:3,width:"100%",maxWidth:"web"===n.default.OS?600:void 0,alignSelf:"center"}};(0,a.useEffect)((()=>{const e=t.getState().routes.some((e=>"SearchProfessionalsListing"===e.name));g(t.canGoBack()&&e)}),[t]);const D=()=>{"web"===n.default.OS?(sessionStorage.removeItem("currentProfessional"),t.navigate("SearchProfessionalsListing")):t.goBack()};(0,a.useEffect)((()=>{if("web"===n.default.OS){const e=()=>{D()};return window.addEventListener("popstate",e),()=>window.removeEventListener("popstate",e)}}),[]),(0,a.useEffect)((()=>{(async()=>{if(e?.params?.professional)u(e.params.professional);else if("web"===n.default.OS){const e=sessionStorage.getItem("currentProfessional");e?u(JSON.parse(e)):t.replace("SearchProfessionalsListing")}})()}),[e?.params?.professional]),(0,a.useEffect)((()=>{"web"!==n.default.OS&&c&&x.default.setItem("currentProfessional",JSON.stringify(c))}),[c]);const M=e=>{v((t=>t.includes(e)?t.filter((t=>t!==e)):[...t,e]))};if(!c)return(0,T.jsxs)(jt,{fullWidthHeader:!0,children:[(0,T.jsx)(bt,{title:"Professional Profile",onBackPress:D}),(0,T.jsx)(r.default,{style:Nn.centered,children:(0,T.jsx)(i.default,{children:"Loading..."})})]});const R=()=>c.profilePicture?(0,T.jsx)(U.default,{source:{uri:c.profilePicture},style:Nn.profilePhoto}):(0,T.jsx)(r.default,{style:[Nn.profilePhoto,Nn.profilePhotoPlaceholder],children:(0,T.jsx)(S.default,{name:"account",size:80,color:f.theme.colors.primary})}),P=()=>(0,T.jsxs)(r.default,{style:Nn.ratingContainer,children:[(0,T.jsx)(S.default,{name:"star",size:24,color:f.theme.colors.primary}),(0,T.jsx)(i.default,{style:Nn.rating,children:c.reviews}),(0,T.jsxs)(i.default,{style:[Nn.reviewCount,{marginLeft:12}],children:["(",c.reviewCount||50," reviews)"]})]}),z=({text:e,maxLines:t=3})=>(0,T.jsxs)(r.default,{children:[(0,T.jsx)(i.default,{numberOfLines:t,style:Nn.specialistText,children:e}),(0,T.jsx)(s.default,{style:Nn.readMoreButton,onPress:()=>w(!0),children:(0,T.jsx)(i.default,{style:Nn.readMoreText,children:"Read more"})})]}),F=()=>{if("web"===n.default.OS&&En){const{MapContainer:e,TileLayer:t,Marker:a}=o(27733);return(0,T.jsx)(r.default,{style:Nn.mapContainer,children:(0,T.jsxs)(e,{center:[38.8339,-104.8214],zoom:13,style:{height:400,width:"100%"},children:[(0,T.jsx)(t,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'\xa9 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}),(0,T.jsx)(a,{position:[38.8339,-104.8214]})]})})}return null},L=l.default.create({modalContent:{backgroundColor:f.theme.colors.background,padding:24,borderRadius:12,width:"web"===n.default.OS?d<=650?"90%":"60%":"90%",maxWidth:800,maxHeight:"90%"}}),O=({text:e})=>(0,T.jsx)(r.default,{style:Nn.featureBubble,children:(0,T.jsx)(i.default,{style:Nn.featureText,children:e})}),E=e=>(0,T.jsxs)(r.default,{style:Nn.reviewItem,children:[(0,T.jsxs)(r.default,{style:Nn.reviewHeader,children:[(0,T.jsx)(U.default,{source:{uri:e.photo},style:Nn.reviewerPhoto}),(0,T.jsxs)(r.default,{style:Nn.reviewerInfo,children:[(0,T.jsx)(i.default,{style:Nn.reviewerName,children:e.name}),(0,T.jsxs)(r.default,{style:Nn.reviewMeta,children:[(0,T.jsx)(r.default,{style:Nn.starContainer,children:[...Array(5)].map(((t,o)=>(0,T.jsx)(S.default,{name:o<e.rating?"star":"star-outline",size:16,color:f.theme.colors.primary},o)))}),(0,T.jsxs)(r.default,{style:Nn.serviceInfo,children:[(0,T.jsx)(S.default,{name:"home",size:16,color:f.theme.colors.secondary}),(0,T.jsxs)(i.default,{style:Nn.serviceText,children:[e.service," \u2022 ",e.date]})]})]})]})]}),(0,T.jsx)(i.default,{style:Nn.reviewText,children:e.text})]},e.id),W=()=>(0,T.jsx)(r.default,{style:I.servicesBox,children:(0,T.jsxs)(r.default,{style:Nn.calendarSection,children:[(0,T.jsx)(i.default,{style:[Nn.sectionTitle,{marginBottom:0}],children:"Availability"}),(0,T.jsx)(So.Calendar,{style:Nn.calendar,theme:{calendarBackground:f.theme.colors.surface,selectedDayBackgroundColor:f.theme.colors.primary,selectedDayTextColor:"#ffffff",todayTextColor:f.theme.colors.primary}})]})}),N=(l.default.create({servicesSection:{marginBottom:24},sectionHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16},seeAllButton:{borderWidth:1,borderColor:f.theme.colors.primary,paddingHorizontal:12,paddingVertical:6,borderRadius:8,alignSelf:"flex-start",minWidth:"auto",width:"auto"},seeAllButtonText:{color:f.theme.colors.primary,fontSize:16,fontWeight:"600",textAlign:"center"},servicesScroll:{marginHorizontal:-24,paddingHorizontal:24},modalServicesGrid:{flexDirection:"row",flexWrap:"wrap",gap:16,justifyContent:"center",padding:16}}),()=>{const e=fe.find((e=>e.professionalId===c.id));if(e)t.replace("MessageHistory",{selectedConversation:e.id});else{const e={id:"conv_".concat(Date.now()),name:c.name,professionalId:c.id,lastMessage:"",timestamp:(new Date).toISOString(),unread:!1,bookingStatus:null};fe.unshift(e),pe[e.id]=[],t.replace("MessageHistory",{selectedConversation:e.id})}});return(0,T.jsxs)(jt,{fullWidthHeader:!0,contentWidth:"1200px",children:[(0,T.jsx)(bt,{title:"Professional Profile",onBackPress:D}),(0,T.jsx)(H.default,{contentContainerStyle:Nn.scrollViewContent,children:(0,T.jsx)(r.default,{style:[Nn.content,{width:"web"===n.default.OS?Math.min(1e3,d-32):d-32}],children:(0,T.jsxs)(r.default,{style:[Nn.twoColumnLayout,!A&&Nn.singleColumnLayout],children:[d>=600?(0,T.jsxs)(r.default,{style:[Nn.leftColumn,!A&&Nn.leftColumnMobile],children:[(0,T.jsxs)(r.default,{style:[Nn.profileSection,!A&&Nn.profileSectionMobile],children:[R(),(0,T.jsx)(i.default,{style:Nn.name,children:c.name}),(0,T.jsx)(i.default,{style:Nn.location,children:c.location}),P(),(0,T.jsx)(s.default,{style:Nn.contactButton,onPress:N,children:(0,T.jsxs)(i.default,{style:Nn.contactButtonText,children:["Contact ",c.name]})})]}),A&&W(),A&&F(),A&&de&&de.length>0&&(de&&0!==de.length?(0,T.jsxs)(r.default,{style:Nn.petsSection,children:[(0,T.jsx)(i.default,{style:Nn.sectionTitle,children:"Pets"}),de.map(((e,t)=>(0,T.jsxs)(r.default,{style:Nn.petItem,children:[(0,T.jsx)(r.default,{style:Nn.petPhoto,children:(0,T.jsx)(S.default,{name:"dog"===e.animal_type.toLowerCase()?"dog":"cat"===e.animal_type.toLowerCase()?"cat":"snake",size:30,color:f.theme.colors.primary})}),(0,T.jsxs)(r.default,{style:Nn.petInfo,children:[(0,T.jsx)(i.default,{style:Nn.petName,children:e.name}),(0,T.jsx)(i.default,{style:Nn.petBreed,children:e.breed}),(0,T.jsx)(i.default,{style:Nn.petDetails,children:"".concat(e.weight," lbs, ").concat(e.age.years," years").concat(e.age.months?" ".concat(e.age.months," months"):"")})]})]},e.id)))]}):null)]}):(0,T.jsxs)(r.default,{style:[I.profileSection,I.profileSectionMobile],children:[R(),(0,T.jsx)(i.default,{style:Nn.name,children:c.name}),(0,T.jsx)(i.default,{style:Nn.location,children:c.location}),P(),(0,T.jsx)(s.default,{style:Nn.contactButton,onPress:N,children:(0,T.jsxs)(i.default,{style:Nn.contactButtonText,children:["Contact ",c.name]})})]}),(0,T.jsxs)(r.default,{style:Nn.rightColumn,children:[(0,T.jsxs)(r.default,{style:Nn.gallerySection,children:[(0,T.jsx)(i.default,{style:Nn.sectionTitle,children:"53 Photos"}),(0,T.jsx)(r.default,{style:Nn.photoGrid,children:[1,2,3,4].map(((e,t)=>(0,T.jsx)(U.default,{source:{uri:"https://via.placeholder.com/150"},style:Nn.galleryPhoto},t)))})]}),(0,T.jsxs)(r.default,{style:Nn.servicesSection,children:[(0,T.jsxs)(r.default,{style:Nn.sectionHeader,children:[(0,T.jsx)(i.default,{style:Nn.sectionTitle,children:"Services"}),(0,T.jsx)(s.default,{style:Nn.seeAllButton,onPress:()=>k(!0),children:(0,T.jsx)(i.default,{style:Nn.seeAllButtonText,children:"See All"})})]}),(0,T.jsx)(r.default,{style:Nn.servicesWrapper,children:(0,T.jsx)(H.default,{horizontal:!0,showsHorizontalScrollIndicator:!0,style:[Nn.servicesScroll,"web"===n.default.OS&&{className:"services-scroll",overflowX:"scroll"}],contentContainerStyle:Nn.servicesScrollContent,persistentScrollbar:!0,children:le.slice(0,5).map((e=>(0,T.jsx)(On,{service:e,onHeartPress:M,isFavorite:C.includes(e.id),professionalName:c.name,professionalId:c.id,navigation:t},e.id)))})})]}),!A&&W(),(0,T.jsxs)(r.default,{style:Nn.specialistSection,children:[(0,T.jsx)(i.default,{style:Nn.sectionTitle,children:"Specialist Experience"}),(0,T.jsx)(z,{text:c?.bio||""})]}),(0,T.jsxs)(r.default,{style:Nn.reviewsSection,children:[(0,T.jsx)(i.default,{style:Nn.sectionTitle,children:"Reviews"}),(0,T.jsx)(r.default,{style:Nn.reviewsGrid,children:Wn.slice(0,4).map(E)}),(0,T.jsx)(s.default,{style:Nn.readMoreButton,onPress:()=>b(!0),children:(0,T.jsx)(i.default,{style:Nn.readMoreText,children:"Read more reviews"})})]}),(0,T.jsxs)(r.default,{style:Nn.homeSection,children:[(0,T.jsx)(i.default,{style:Nn.sectionTitle,children:"Home"}),(0,T.jsxs)(r.default,{style:Nn.homeFeaturesGrid,children:[(0,T.jsx)(O,{text:"No children present"}),(0,T.jsx)(O,{text:"Has security system"}),(0,T.jsx)(O,{text:"Non-smoking household"}),(0,T.jsx)(O,{text:"Has 2 dogs"}),(0,T.jsx)(O,{text:"Dogs allowed on bed"}),(0,T.jsx)(O,{text:"Dogs allowed on furniture"}),(0,T.jsx)(O,{text:"Potty breaks every 0-2 hours"})]})]}),!A&&F()]})]})})}),(0,T.jsx)(_.default,{visible:h,animationType:"slide",transparent:!0,onRequestClose:()=>p(!1),children:(0,T.jsx)(r.default,{style:Nn.modalContainer,children:(0,T.jsxs)(r.default,{style:L.modalContent,children:[(0,T.jsx)(i.default,{style:Nn.bioText,children:c.bio}),(0,T.jsx)(s.default,{style:Nn.closeButton,onPress:()=>p(!1),children:(0,T.jsx)(i.default,{style:Nn.closeButtonText,children:"Close"})})]})})}),(0,T.jsx)(_.default,{visible:y,animationType:"slide",transparent:!0,onRequestClose:()=>b(!1),children:(0,T.jsx)(r.default,{style:Nn.modalContainer,children:(0,T.jsxs)(r.default,{style:L.modalContent,children:[(0,T.jsxs)(r.default,{style:Nn.modalHeader,children:[(0,T.jsx)(i.default,{style:Nn.modalTitle,children:"All Reviews"}),(0,T.jsx)(s.default,{style:Nn.modalCloseIcon,onPress:()=>b(!1),children:(0,T.jsx)(S.default,{name:"close",size:24,color:f.theme.colors.text})})]}),(0,T.jsx)(H.default,{style:Nn.modalScroll,contentContainerStyle:Nn.modalScrollContent,children:Wn.map((e=>(0,T.jsx)(r.default,{style:Nn.modalReviewItem,children:E(e)},e.id)))})]})})}),(0,T.jsx)(_.default,{visible:j,animationType:"slide",transparent:!0,onRequestClose:()=>w(!1),children:(0,T.jsx)(r.default,{style:Nn.modalContainer,children:(0,T.jsxs)(r.default,{style:L.modalContent,children:[(0,T.jsxs)(r.default,{style:Nn.modalHeader,children:[(0,T.jsx)(i.default,{style:Nn.modalTitle,children:"Specialist Experience"}),(0,T.jsx)(s.default,{style:Nn.modalCloseIcon,onPress:()=>w(!1),children:(0,T.jsx)(S.default,{name:"close",size:24,color:f.theme.colors.text})})]}),(0,T.jsx)(H.default,{style:Nn.modalScroll,contentContainerStyle:Nn.modalScrollContent,children:(0,T.jsx)(i.default,{style:Nn.bioText,children:c?.bio})})]})})}),(0,T.jsx)(_.default,{visible:B,animationType:"slide",transparent:!0,onRequestClose:()=>k(!1),children:(0,T.jsx)(r.default,{style:Nn.modalContainer,children:(0,T.jsxs)(r.default,{style:L.modalContent,children:[(0,T.jsxs)(r.default,{style:Nn.modalHeader,children:[(0,T.jsx)(i.default,{style:Nn.modalTitle,children:"All Services"}),(0,T.jsx)(s.default,{style:Nn.modalCloseIcon,onPress:()=>k(!1),children:(0,T.jsx)(S.default,{name:"close",size:24,color:f.theme.colors.text})})]}),(0,T.jsx)(H.default,{style:Nn.modalScroll,contentContainerStyle:Nn.modalScrollContent,children:(0,T.jsx)(r.default,{style:Nn.modalServicesGrid,children:le.map((e=>(0,T.jsx)(On,{service:e,onHeartPress:M,isFavorite:C.includes(e.id),professionalName:c.name,professionalId:c.id,navigation:t},e.id)))})})]})})})]})},Un=l.default.create({container:{marginTop:16},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center",marginTop:50},sectionTitle:{fontSize:f.theme.fontSizes.mediumLarge,fontWeight:"bold",marginBottom:8,color:f.theme.colors.text},noContractsText:{fontSize:f.theme.fontSizes.medium,color:f.theme.colors.text,textAlign:"center",marginTop:20},card:{backgroundColor:f.theme.colors.surface,borderRadius:8,padding:16,marginBottom:16},contractTitle:{fontSize:f.theme.fontSizes.medium,fontWeight:"bold",color:f.theme.colors.primary},ownerName:{fontSize:f.theme.fontSizes.medium,color:f.theme.colors.text,marginTop:4},buttonContainer:{flexDirection:"row",justifyContent:"flex-end",marginTop:8},button:{backgroundColor:f.theme.colors.primary,paddingHorizontal:12,paddingVertical:6,borderRadius:4,marginLeft:8},buttonText:{color:f.theme.colors.background,fontWeight:"bold"}}),Vn=()=>{const[e,t]=(0,a.useState)([]),[o,n]=(0,a.useState)(!0);(0,a.useEffect)((()=>{l()}),[]);const l=async()=>{n(!0);try{const e=await x.default.getItem("userToken");if(!e)return void console.error("No token found");const o=await w.default.get("".concat(b.API_BASE_URL,"/api/contracts/"),{headers:{Authorization:"Bearer ".concat(e)}});t(o.data)}catch(e){console.error("Error fetching contracts:",e)}finally{n(!1)}};return o?(0,T.jsx)(r.default,{style:Un.loadingContainer,children:(0,T.jsx)(A.default,{size:"large",color:f.theme.colors.primary})}):(0,T.jsxs)(r.default,{style:Un.container,children:[(0,T.jsx)(i.default,{style:Un.sectionTitle,children:"Your Contracts"}),0===e.length?(0,T.jsx)(i.default,{style:Un.noContractsText,children:"No contracts yet"}):e.map((e=>(0,T.jsxs)(r.default,{style:Un.card,children:[(0,T.jsx)(i.default,{style:Un.contractTitle,children:e.title}),(0,T.jsxs)(i.default,{style:Un.ownerName,children:["Owner: ",e.owner_name]}),(0,T.jsxs)(r.default,{style:Un.buttonContainer,children:[(0,T.jsx)(s.default,{style:Un.button,children:(0,T.jsx)(i.default,{style:Un.buttonText,children:"Share"})}),(0,T.jsx)(s.default,{style:Un.button,children:(0,T.jsx)(i.default,{style:Un.buttonText,children:"Edit"})})]})]},e.id)))]})};var qn=o(17366);const Yn=l.default.create({picker:{backgroundColor:f.theme.colors.surface,marginBottom:8,borderRadius:4,padding:"ios"===n.default.OS?12:0,width:"90%"},modalPicker:{width:"90%"},dropdownButton:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",backgroundColor:f.theme.colors.surface,borderRadius:4,padding:12,marginBottom:16,borderWidth:1,borderColor:f.theme.colors.border},dropdownButtonText:{color:f.theme.colors.text},pickerModalContainer:{flex:1,justifyContent:"flex-end",backgroundColor:"rgba(0, 0, 0, 0.5)"},pickerContainer:{backgroundColor:f.theme.colors.background,borderTopLeftRadius:20,borderTopRightRadius:20,padding:16},pickerCloseButton:{backgroundColor:f.theme.colors.primary,padding:16,alignItems:"center"},pickerCloseButtonText:{color:f.theme.colors.background,fontWeight:"bold"}}),Gn=({owners:e,selectedOwner:t,onSelectOwner:o})=>{const[l,d]=(0,a.useState)(!1);return"web"===n.default.OS?(0,T.jsxs)(qn.Picker,{selectedValue:t,onValueChange:e=>o(e),style:Yn.picker,children:[(0,T.jsx)(qn.Picker.Item,{label:"Select a owner...",value:""}),e.map((e=>(0,T.jsx)(qn.Picker.Item,{label:e.name,value:e.name},e.id)))]}):(0,T.jsxs)(r.default,{children:[(0,T.jsxs)(s.default,{style:Yn.dropdownButton,onPress:()=>d(!0),children:[(0,T.jsx)(i.default,{style:Yn.dropdownButtonText,children:t||"Select a owner..."}),(0,T.jsx)(S.default,{name:"chevron-down",size:24,color:f.theme.colors.primary})]}),(0,T.jsx)(_.default,{visible:l,transparent:!0,animationType:"slide",onRequestClose:()=>d(!1),children:(0,T.jsxs)(r.default,{style:Yn.pickerModalContainer,children:[(0,T.jsx)(r.default,{style:Yn.pickerContainer,children:(0,T.jsxs)(qn.Picker,{selectedValue:t,onValueChange:e=>{o(e),d(!1)},style:Yn.modalPicker,children:[(0,T.jsx)(qn.Picker.Item,{label:"Select a owner...",value:""}),e.map((e=>(0,T.jsx)(qn.Picker.Item,{label:e.name,value:e.name},e.id)))]})}),(0,T.jsx)(s.default,{style:Yn.pickerCloseButton,onPress:()=>d(!1),children:(0,T.jsx)(i.default,{style:Yn.pickerCloseButtonText,children:"Close"})})]})})]})},Jn=l.default.create({container:{marginBottom:16},sectionTitle:{fontSize:18,fontWeight:"bold",marginBottom:8,color:f.theme.colors.text},button:{backgroundColor:f.theme.colors.primary,paddingHorizontal:16,paddingVertical:12,borderRadius:8,alignItems:"center",marginBottom:10},buttonText:{color:f.theme.colors.background,fontWeight:"bold",fontSize:16},modalContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0, 0, 0, 0.5)"},modalContent:{width:"80%",backgroundColor:f.theme.colors.surface,borderRadius:10,padding:20,alignItems:"center"},modalTitle:{fontSize:20,fontWeight:"bold",marginBottom:20},templateGrid:{flexDirection:"row",flexWrap:"wrap",justifyContent:"center"},templateBox:{width:100,height:100,margin:10,justifyContent:"center",alignItems:"center",backgroundColor:f.theme.colors.primary,borderRadius:5},templateTitle:{color:f.theme.colors.background,textAlign:"center"},noTemplatesText:{fontSize:16,color:f.theme.colors.text,textAlign:"center",marginTop:20},closeButton:{marginTop:20,padding:10,backgroundColor:f.theme.colors.primary,borderRadius:5},closeButtonText:{color:f.theme.colors.background,fontWeight:"bold"},textArea:{width:"100%",height:100,padding:10,borderColor:f.theme.colors.primary,borderWidth:1,borderRadius:5,marginBottom:10,textAlignVertical:"top"},ownerPickerContainer:{width:"100%",marginBottom:10},pickerModalContainer:{flex:1,justifyContent:"flex-end",backgroundColor:"rgba(0, 0, 0, 0.5)"},pickerContainer:{backgroundColor:f.theme.colors.background,borderTopLeftRadius:20,borderTopRightRadius:20,padding:16},pickerCloseButton:{backgroundColor:f.theme.colors.primary,padding:16,alignItems:"center"},pickerCloseButtonText:{color:f.theme.colors.background,fontWeight:"bold"}}),$n=({templates:e})=>{const[t,o]=(0,a.useState)(!1),[n,l]=(0,a.useState)(!1),[d,c]=(0,a.useState)(null),[u,m]=(0,a.useState)(""),[g,h]=(0,a.useState)([]),[f,p]=(0,a.useState)("");(0,a.useEffect)((()=>{y()}),[]);const y=async()=>{try{const e=await x.default.getItem("userToken");if(!e)return void console.error("No token found");const t=await w.default.get("".concat(b.API_BASE_URL,"/api/clients/"),{headers:{Authorization:"Bearer ".concat(e)}});h(t.data)}catch(e){console.error("Error fetching owners:",e)}};return(0,T.jsxs)(r.default,{style:Jn.container,children:[(0,T.jsx)(i.default,{style:Jn.sectionTitle,children:"Create New Contract"}),(0,T.jsx)(s.default,{style:Jn.button,onPress:()=>o(!0),children:(0,T.jsx)(i.default,{style:Jn.buttonText,children:"Use Template"})}),(0,T.jsx)(_.default,{visible:t,transparent:!0,animationType:"slide",onRequestClose:()=>o(!1),children:(0,T.jsx)(r.default,{style:Jn.modalContainer,children:(0,T.jsxs)(r.default,{style:Jn.modalContent,children:[(0,T.jsx)(i.default,{style:Jn.modalTitle,children:"Select a Template"}),(0,T.jsx)(H.default,{contentContainerStyle:Jn.templateGrid,children:0===e.length?(0,T.jsx)(i.default,{style:Jn.noTemplatesText,children:"No templates yet"}):e.map((e=>(0,T.jsx)(s.default,{style:Jn.templateBox,onPress:()=>(e=>{c(e),m(e.description),o(!1),l(!0)})(e),children:(0,T.jsx)(i.default,{style:Jn.templateTitle,children:e.title})},e.id)))}),(0,T.jsx)(s.default,{style:Jn.closeButton,onPress:()=>o(!1),children:(0,T.jsx)(i.default,{style:Jn.closeButtonText,children:"Close"})})]})})}),(0,T.jsx)(_.default,{visible:n,transparent:!0,animationType:"slide",onRequestClose:()=>l(!1),children:(0,T.jsx)(r.default,{style:Jn.modalContainer,children:(0,T.jsxs)(r.default,{style:Jn.modalContent,children:[(0,T.jsx)(i.default,{style:Jn.modalTitle,children:"Edit Contract"}),(0,T.jsxs)(r.default,{style:Jn.ownerPickerContainer,children:[(0,T.jsx)(i.default,{style:Jn.sectionTitle,children:"Select a Owner"}),(0,T.jsx)(Gn,{owners:g,selectedOwner:f,onSelectOwner:p})]}),(0,T.jsx)(q.default,{style:Jn.textArea,placeholder:"Contract Content",value:u,onChangeText:m,multiline:!0}),(0,T.jsx)(s.default,{style:Jn.button,onPress:()=>{m((e=>"".concat(e,"\n[signable] ___________ [end signable]")))},children:(0,T.jsx)(i.default,{style:Jn.buttonText,children:"Add Signable Field"})}),(0,T.jsx)(s.default,{style:Jn.button,onPress:async()=>{try{const e=await x.default.getItem("userToken");if(!e)return void console.error("No token found");const t=await w.default.post("".concat(b.API_BASE_URL,"/api/contracts/"),{template:d.id,content:u,owner:f},{headers:{Authorization:"Bearer ".concat(e)}});console.log("Contract submitted:",t.data),l(!1)}catch(e){console.error("Error submitting contract:",e)}},children:(0,T.jsx)(i.default,{style:Jn.buttonText,children:"Submit Contract"})}),(0,T.jsx)(s.default,{style:Jn.closeButton,onPress:()=>l(!1),children:(0,T.jsx)(i.default,{style:Jn.closeButtonText,children:"Close"})})]})})})]})},Zn=l.default.create({container:{flex:1},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center",minHeight:200},emptyContainer:{flex:1,justifyContent:"center",alignItems:"center",minHeight:200,backgroundColor:f.theme.colors.surface,borderRadius:8,padding:20,marginTop:16},emptyText:{fontSize:16,color:f.theme.colors.text,textAlign:"center"},sectionTitle:{fontSize:18,fontWeight:"bold",marginBottom:8,color:f.theme.colors.text},card:{backgroundColor:f.theme.colors.surface,borderRadius:8,padding:16,marginBottom:16},chronicleTitle:{fontSize:16,fontWeight:"bold",color:f.theme.colors.primary},ownerName:{fontSize:14,color:f.theme.colors.text,marginTop:4},petName:{fontSize:14,color:f.theme.colors.text,marginTop:2},summary:{fontSize:14,color:f.theme.colors.text,marginTop:8,marginBottom:8},buttonContainer:{flexDirection:"row",justifyContent:"flex-end",marginTop:8},button:{backgroundColor:f.theme.colors.primary,paddingHorizontal:12,paddingVertical:6,borderRadius:4,marginLeft:8},buttonText:{color:f.theme.colors.background,fontWeight:"bold"}}),Kn=({chronicles:e})=>e&&0!==e.length?(0,T.jsxs)(H.default,{style:Zn.container,children:[(0,T.jsx)(i.default,{style:Zn.sectionTitle,children:"Your Chronicles"}),e.map((e=>(0,T.jsxs)(r.default,{style:Zn.card,children:[(0,T.jsx)(i.default,{style:Zn.chronicleTitle,children:e.title}),(0,T.jsxs)(i.default,{style:Zn.ownerName,children:["Owner: ",e.owner]}),(0,T.jsxs)(i.default,{style:Zn.petName,children:["Pet: ",e.pets.join(", ")]}),(0,T.jsx)(i.default,{style:Zn.summary,children:e.summary}),(0,T.jsxs)(r.default,{style:Zn.buttonContainer,children:[(0,T.jsx)(s.default,{style:Zn.button,children:(0,T.jsx)(i.default,{style:Zn.buttonText,children:"Edit"})}),(0,T.jsx)(s.default,{style:Zn.button,children:(0,T.jsx)(i.default,{style:Zn.buttonText,children:"Send to Owner"})})]})]},e.id)))]}):(0,T.jsx)(r.default,{style:Zn.emptyContainer,children:(0,T.jsx)(i.default,{style:Zn.emptyText,children:"No chronicles yet"})}),{width:Qn}=v.default.get("window"),Xn=l.default.create({outerContainer:{width:"100%",alignItems:"center",marginBottom:16},container:{width:Qn-80,maxWidth:600,alignItems:"center"},inputContainer:{width:"100%",position:"relative"},input:Object.assign({width:"100%",backgroundColor:f.theme.colors.surface,borderRadius:4,padding:8,minHeight:60},n.default.select({web:{border:"1px solid ".concat(f.theme.colors.border)},default:{borderWidth:1,borderColor:f.theme.colors.border}})),dropdownButton:{position:"absolute",right:8,top:8,padding:4},modalOverlay:{flex:1},dropdownContainer:Object.assign({position:"absolute",backgroundColor:f.theme.colors.background,borderRadius:4,borderWidth:1,borderColor:f.theme.colors.border,maxHeight:200,zIndex:1e3},n.default.select({web:{boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},default:{elevation:4}})),dropdownList:{maxHeight:200},dropdownItem:{padding:12,borderBottomWidth:1,borderBottomColor:f.theme.colors.border},dropdownItemText:{color:f.theme.colors.text}}),er=({value:e,onChange:t})=>{const[o,l]=(0,a.useState)(!1),[d,c]=(0,a.useState)({top:0,left:0,width:0}),u=(0,a.useRef)(null),[m,g]=(0,a.useState)(null),h=e=>{t(e)};(0,a.useLayoutEffect)((()=>(o&&u.current&&u.current.measure(((e,t,o,a,n,r)=>{if(!isNaN(r)&&!isNaN(a)){c({top:r+a,left:n,width:o})}})),"web"===n.default.OS&&(document.body.style.overflow=o?"hidden":"auto"),()=>{"web"===n.default.OS&&(document.body.style.overflow="auto")})),[o,m]);const p=()=>{l(!o)};return(0,T.jsx)(r.default,{style:Xn.outerContainer,children:(0,T.jsxs)(r.default,{style:Xn.container,children:[(0,T.jsxs)(r.default,{style:Xn.inputContainer,ref:u,onLayout:e=>{const{x:t,y:o,width:a,height:n}=e.nativeEvent.layout;g({x:t,y:o,width:a,height:n})},children:[(0,T.jsx)(q.default,{style:Xn.input,value:e,onChangeText:h,placeholder:"Enter or select a question",multiline:!0}),(0,T.jsx)(s.default,{style:Xn.dropdownButton,onPress:p,children:(0,T.jsx)(S.default,{name:o?"chevron-up":"chevron-down",size:24,color:f.theme.colors.primary})})]}),(0,T.jsx)(_.default,{visible:o,transparent:!0,animationType:"none",onRequestClose:p,children:(0,T.jsx)(s.default,{style:Xn.modalOverlay,activeOpacity:1,onPress:p,children:(0,T.jsx)(r.default,{style:[Xn.dropdownContainer,{top:d.top,left:d.left,width:d.width}],children:(0,T.jsx)(H.default,{style:Xn.dropdownList,children:["What is your favorite animal?","How many pets do you have?","What's your experience with exotic pets?","Do you have any allergies to animals?","What type of exotic pet are you interested in?","Have you owned an exotic pet before?","Are you familiar with the care requirements for exotic pets?","Do you have a veterinarian experienced with exotic animals?","What's your living situation? (House, apartment, etc.)","Are there any local regulations about exotic pet ownership in your area?"].map(((e,t)=>(0,T.jsx)(s.default,{style:Xn.dropdownItem,onPress:()=>{h(e),p()},children:(0,T.jsx)(i.default,{style:Xn.dropdownItemText,children:e})},t)))})})})})]})})},{width:tr}=v.default.get("window"),or=l.default.create({createButton:{backgroundColor:f.theme.colors.primary,paddingHorizontal:16,paddingVertical:12,borderRadius:8,alignItems:"center",marginBottom:16},createButtonText:{color:f.theme.colors.background,fontWeight:"bold",fontSize:16},modalContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0, 0, 0, 0.5)"},modalContent:{backgroundColor:f.theme.colors.background,borderRadius:8,padding:16,width:"90%",maxHeight:"80%"},webModalContent:{width:tr>600?"40%":"90%"},modalHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16},modalTitle:{fontSize:20,fontWeight:"bold",color:f.theme.colors.text},closeButton:{padding:8},closeButtonText:{fontSize:20,color:f.theme.colors.text,fontWeight:"bold"},label:{fontSize:16,fontWeight:"bold",marginBottom:8,color:f.theme.colors.text},input:{backgroundColor:f.theme.colors.surface,borderRadius:4,marginBottom:8,minHeight:20},picker:{backgroundColor:f.theme.colors.surface,marginBottom:8,borderRadius:4,padding:"ios"===n.default.OS?12:0},petOption:{padding:8,backgroundColor:f.theme.colors.surface,marginBottom:8,borderRadius:4},selectedPet:{backgroundColor:f.theme.colors.primary},petOptionText:{color:f.theme.colors.text},uploadButton:{flexDirection:"row",alignItems:"center",justifyContent:"center",padding:12,backgroundColor:f.theme.colors.surface,borderRadius:4,marginTop:16},uploadButtonText:{marginLeft:8,color:f.theme.colors.primary,fontWeight:"bold"},photoPreview:{flexDirection:"row",marginTop:16},photoThumbnail:{width:80,height:80,marginRight:8,borderRadius:4},questionContainer:{marginBottom:16,width:"100%",alignItems:"center"},modalButtonContainer:{flexDirection:"row",justifyContent:"space-between",marginTop:16},cancelButton:{backgroundColor:f.theme.colors.error,paddingHorizontal:16,paddingVertical:12,borderRadius:4,alignItems:"center",flex:1,marginRight:8},cancelButtonText:{color:f.theme.colors.background,fontWeight:"bold"},submitButton:{backgroundColor:f.theme.colors.primary,paddingHorizontal:16,paddingVertical:12,borderRadius:4,alignItems:"center",flex:1,marginLeft:8},submitButtonText:{color:f.theme.colors.background,fontWeight:"bold"},addQuestionButton:{flexDirection:"row",alignItems:"center",justifyContent:"center",padding:12,backgroundColor:f.theme.colors.surface,borderRadius:4,marginTop:8,marginBottom:16,zIndex:1},addQuestionButtonText:{marginLeft:8,zIndex:1,color:f.theme.colors.primary,fontWeight:"bold"},answerInputContainer:{width:"100%",alignItems:"center"},answerInput:Object.assign({width:tr-80,maxWidth:600,minHeight:60,backgroundColor:f.theme.colors.surface,borderRadius:4,padding:8,marginTop:8},n.default.select({web:{border:"1px solid ".concat(f.theme.colors.border)},default:{borderWidth:1,borderColor:f.theme.colors.border}})),summaryInput:Object.assign({backgroundColor:f.theme.colors.surface,borderRadius:4,marginBottom:8,padding:8,height:100,textAlignVertical:"top"},n.default.select({web:{minHeight:100},ios:{paddingTop:8},android:{paddingTop:8}}),n.default.select({web:{border:"1px solid ".concat(f.theme.colors.border)},default:{borderWidth:1,borderColor:f.theme.colors.border}})),dropdownButton:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",backgroundColor:f.theme.colors.surface,borderRadius:4,padding:12,marginBottom:16,borderWidth:1,borderColor:f.theme.colors.border},dropdownButtonText:{color:f.theme.colors.text},pickerModalContainer:{flex:1,justifyContent:"flex-end",backgroundColor:"rgba(0, 0, 0, 0.5)"},pickerContainer:{backgroundColor:f.theme.colors.background,borderTopLeftRadius:20,borderTopRightRadius:20,padding:16},pickerCloseButton:{backgroundColor:f.theme.colors.primary,padding:16,alignItems:"center"},pickerCloseButtonText:{color:f.theme.colors.background,fontWeight:"bold"},photoContainer:{marginRight:8},photo:{width:100,height:100,borderRadius:8}}),ar=({onCreateChronicle:e})=>{const[t,o]=(0,a.useState)(!1),[l,d]=(0,a.useState)(""),[c,u]=(0,a.useState)([]),[m,g]=(0,a.useState)([{question:"",answer:"",isPreset:!0}]),[h,p]=(0,a.useState)(""),[y,b]=(0,a.useState)([]),[x,j]=(0,a.useState)(!1),[w,C]=(0,a.useState)(!1),[v,B]=(0,a.useState)(!1),k=[{id:"1",name:"John Doe",pets:[{id:"1",name:"Max"},{id:"2",name:"Bella"}]},{id:"2",name:"Jane Smith",pets:[{id:"3",name:"Luna"},{id:"4",name:"Charlie"}]}],I=(e,t,o)=>{const a=[...m];a[e]=Object.assign({},a[e],{[t]:o}),g(a)},D=()=>{d(""),u([]),p(""),g([{question:"",answer:""}]),b([])},M=({photo:e})=>(0,T.jsx)(r.default,{style:or.photoContainer,children:(0,T.jsx)(U.default,{source:{uri:e.uri},style:or.photo})});return(0,T.jsxs)(r.default,{children:[(0,T.jsx)(s.default,{style:or.createButton,onPress:()=>o(!0),children:(0,T.jsx)(i.default,{style:or.createButtonText,children:"Create New Chronicle"})}),(0,T.jsx)(_.default,{animationType:"slide",transparent:!0,visible:t,onRequestClose:()=>o(!1),children:(0,T.jsx)(r.default,{style:or.modalContainer,children:(0,T.jsxs)(r.default,{style:[or.modalContent,"web"===n.default.OS&&or.webModalContent],children:[(0,T.jsxs)(r.default,{style:or.modalHeader,children:[(0,T.jsx)(i.default,{style:or.modalTitle,children:"Create New Chronicle"}),(0,T.jsx)(s.default,{onPress:()=>o(!1),children:(0,T.jsx)(i.default,{style:or.closeButtonText,children:"\u2715"})})]}),(0,T.jsxs)(H.default,{children:[(0,T.jsx)(i.default,{style:or.label,children:"Select Owner"}),(0,T.jsx)(Gn,{owners:k,selectedOwner:l,onSelectOwner:d}),(0,T.jsx)(i.default,{style:or.label,children:"Select Pets"}),l&&k.find((e=>e.name===l))?.pets.map((e=>(0,T.jsx)(s.default,{style:[or.petOption,c.includes(e.name)&&or.selectedPet],onPress:()=>{c.includes(e.name)?u(c.filter((t=>t!==e.name))):u([...c,e.name])},children:(0,T.jsx)(i.default,{style:or.petOptionText,children:e.name})},e.id))),(0,T.jsx)(i.default,{style:or.label,children:"Summary"}),(0,T.jsx)(q.default,{style:or.summaryInput,multiline:!0,value:h,onChangeText:p,placeholder:"Write a summary of the chronicle",textAlignVertical:"top"}),m.map(((e,t)=>(0,T.jsxs)(r.default,{style:or.questionContainer,children:[(0,T.jsxs)(i.default,{style:or.label,children:["Question ",t+1]}),(0,T.jsx)(er,{value:e.question,onChange:e=>I(t,"question",e)}),(0,T.jsx)(r.default,{style:or.answerInputContainer,children:(0,T.jsx)(q.default,{style:[or.input,or.answerInput],value:e.answer,onChangeText:e=>I(t,"answer",e),placeholder:"Enter answer",multiline:!0})})]},t))),(0,T.jsxs)(s.default,{style:or.addQuestionButton,onPress:()=>{g([...m,{question:"",answer:"",isPreset:!1}])},children:[(0,T.jsx)(S.default,{name:"plus",size:20,color:f.theme.colors.primary}),(0,T.jsx)(i.default,{style:or.addQuestionButtonText,children:"Add Another Question"})]}),(0,T.jsxs)(s.default,{style:or.uploadButton,onPress:async()=>{try{j(!0);const e=await Re.launchImageLibraryAsync({mediaTypes:Pe.MediaTypeOptions.Images,allowsMultipleSelection:!0,quality:1});e.canceled||b([...y,...e.assets])}catch(e){console.error("Error uploading images:",e)}finally{j(!1)}},disabled:x,children:[(0,T.jsx)(S.default,{name:"camera",size:24,color:x?f.theme.colors.disabled:f.theme.colors.primary}),(0,T.jsx)(i.default,{style:[or.uploadButtonText,x&&or.uploadingText],children:x?"Uploading...":"Upload Photos"}),x&&(0,T.jsx)(A.default,{size:"small",color:f.theme.colors.primary,style:or.uploadingSpinner})]}),(0,T.jsx)(H.default,{horizontal:!0,style:or.photoPreview,children:y.map(((e,t)=>(0,T.jsx)(M,{photo:e},t)))})]}),(0,T.jsxs)(r.default,{style:or.modalButtonContainer,children:[(0,T.jsx)(s.default,{style:or.cancelButton,onPress:()=>{o(!1),D()},children:(0,T.jsx)(i.default,{style:or.cancelButtonText,children:"Cancel"})}),(0,T.jsx)(s.default,{style:or.submitButton,onPress:()=>{B(!0);const t={id:Date.now(),owner:l,pets:c,summary:h,questions:m,photos:y,title:"Chronicle for ".concat(l)};setTimeout((()=>{console.log("Sending data to backend:",t),e(t),B(!1),o(!1),D()}),2e3)},disabled:v,children:(0,T.jsx)(i.default,{style:or.submitButtonText,children:v?"Creating Chronicle...":"Create Chronicle"})})]})]})})})]})},nr=l.default.create({safeArea:{flex:1,backgroundColor:f.theme.colors.background,paddingTop:"android"===n.default.OS?Te.default.currentHeight:0},scrollViewContent:{flexGrow:1},container:{flex:1,padding:16,alignItems:"center"},title:{fontSize:24,fontWeight:"bold",marginBottom:16,color:f.theme.colors.primary,textAlign:"center"},tabContainer:{flexDirection:"row",marginBottom:16,width:"100%",maxWidth:500},tab:{flex:1,paddingVertical:12,alignItems:"center",backgroundColor:f.theme.colors.surface,borderRadius:8,marginHorizontal:4},activeTab:{backgroundColor:f.theme.colors.primary},tabText:{color:f.theme.colors.text,fontWeight:"bold"},activeTabText:{color:f.theme.colors.background},contentContainer:{width:"100%",maxWidth:500},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center",minHeight:200},useTemplateButton:{backgroundColor:f.theme.colors.primary,padding:10,borderRadius:5,marginBottom:16,alignItems:"center"},useTemplateButtonText:{color:f.theme.colors.background,fontWeight:"bold"},modalContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0, 0, 0, 0.5)"},modalContent:{width:"80%",backgroundColor:f.theme.colors.surface,borderRadius:10,padding:20,alignItems:"center"},modalTitle:{fontSize:20,fontWeight:"bold",marginBottom:20},templateGrid:{flexDirection:"row",flexWrap:"wrap",justifyContent:"center"},templateBox:{width:100,height:100,backgroundColor:f.theme.colors.primary,margin:10,justifyContent:"center",alignItems:"center",borderRadius:5},templateTitle:{color:f.theme.colors.background,textAlign:"center"},closeButton:{marginTop:20,padding:10,backgroundColor:f.theme.colors.primary,borderRadius:5},closeButtonText:{color:f.theme.colors.background,fontWeight:"bold"}}),rr=()=>{const[e,t]=(0,a.useState)("contracts"),[o,n]=(0,a.useState)([]),[l,d]=(0,a.useState)(!1),[c,u]=(0,a.useState)([]);(0,a.useEffect)((()=>{"chronicles"===e&&m()}),[e]);const m=async()=>{d(!0),await new Promise((e=>setTimeout(e,1e3)));n([{id:1,title:"Fluffy's Adventure",owner:"John Doe",pets:["Fluffy"],summary:"Fluffy had a great time at the park today!"},{id:2,title:"Max's Playdate",owner:"Jane Smith",pets:["Max"],summary:"Max enjoyed playing with other dogs at the beach."}]),d(!1)};(0,a.useEffect)((()=>{(async()=>{try{const e=await x.default.getItem("userToken");if(!e)return void console.error("No token found");const t=await w.default.get("".concat(b.API_BASE_URL,"/api/contracts/templates/"),{headers:{Authorization:"Bearer ".concat(e)}});u(t.data)}catch(e){console.error("Error fetching templates:",e)}})()}),[]);return(0,T.jsx)(Se.default,{style:nr.safeArea,children:(0,T.jsx)(H.default,{contentContainerStyle:nr.scrollViewContent,children:(0,T.jsxs)(r.default,{style:nr.container,children:[(0,T.jsx)(i.default,{style:nr.title,children:"My Contracts & Chronicles"}),(0,T.jsxs)(r.default,{style:nr.tabContainer,children:[(0,T.jsx)(s.default,{style:[nr.tab,"contracts"===e&&nr.activeTab],onPress:()=>t("contracts"),children:(0,T.jsx)(i.default,{style:[nr.tabText,"contracts"===e&&nr.activeTabText],children:"Contracts"})}),(0,T.jsx)(s.default,{style:[nr.tab,"chronicles"===e&&nr.activeTab],onPress:()=>t("chronicles"),children:(0,T.jsx)(i.default,{style:[nr.tabText,"chronicles"===e&&nr.activeTabText],children:"Critter Chronicles"})})]}),"contracts"===e&&(0,T.jsxs)(r.default,{style:nr.contentContainer,children:[(0,T.jsx)($n,{templates:c}),(0,T.jsx)(Vn,{})]}),"chronicles"===e&&(0,T.jsx)(r.default,{style:nr.contentContainer,children:l?(0,T.jsx)(r.default,{style:nr.loadingContainer,children:(0,T.jsx)(A.default,{size:"large",color:f.theme.colors.primary})}):(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(ar,{onCreateChronicle:e=>{n((t=>[...t,e]))}}),(0,T.jsx)(Kn,{chronicles:o})]})})]})})})},ir=l.default.create({container:{flex:1,backgroundColor:f.theme.colors.background,paddingTop:"android"===n.default.OS?Te.default.currentHeight:0},content:{flex:1,padding:20},webContent:{width:"100%",maxWidth:600,alignSelf:"center",padding:20},header:{flexDirection:"row",alignItems:"center",padding:16,borderBottomWidth:1,borderBottomColor:f.theme.colors.border},backButton:{marginRight:16},headerText:{fontSize:20,fontWeight:"bold",color:f.theme.colors.primary},input:{marginBottom:10},button:{marginTop:20},errorText:{color:f.theme.colors.error,marginBottom:10},successText:{color:f.theme.colors.success,marginBottom:10}}),sr=({navigation:e})=>{const[t,o]=(0,a.useState)(""),[i,l]=(0,a.useState)(""),[d,c]=(0,a.useState)(""),[u,m]=(0,a.useState)(""),[g,h]=(0,a.useState)(""),{isSignedIn:y}=(0,a.useContext)(p.AuthContext),[j,C]=(0,a.useState)(null);(0,a.useEffect)((()=>{(async()=>{const e=await x.default.getItem("userToken");C(e)})()}),[]);return(0,T.jsxs)(Se.default,{style:ir.container,children:[(0,T.jsxs)(r.default,{style:ir.header,children:[(0,T.jsx)(s.default,{onPress:()=>e.navigate("Settings"),style:ir.backButton,children:(0,T.jsx)(S.default,{name:"arrow-left",size:24,color:f.theme.colors.primary})}),(0,T.jsx)(Y.default,{style:ir.headerText,children:"Change Password"})]}),(0,T.jsxs)(r.default,{style:"web"===n.default.OS?ir.webContent:ir.content,children:[(0,T.jsx)(ke.default,{label:"Current Password",value:t,onChangeText:o,secureTextEntry:!0,style:ir.input}),(0,T.jsx)(ke.default,{label:"New Password",value:i,onChangeText:l,secureTextEntry:!0,style:ir.input}),(0,T.jsx)(ke.default,{label:"Confirm New Password",value:d,onChangeText:c,secureTextEntry:!0,style:ir.input}),u?(0,T.jsx)(Y.default,{style:ir.errorText,children:u}):null,g?(0,T.jsx)(Y.default,{style:ir.successText,children:g}):null,(0,T.jsx)(_e.default,{mode:"contained",onPress:async()=>{if(m(""),h(""),i===d)if(y&&j)try{console.log("Sending request to:","".concat(b.API_BASE_URL,"/api/users/change-password/")),console.log("Request payload:",{current_password:t,new_password:i}),console.log("Auth token:",j);const e=await w.default.post("".concat(b.API_BASE_URL,"/api/users/change-password/"),{current_password:t,new_password:i},{headers:{Authorization:"Bearer ".concat(j)}});console.log("Response:",e),200===e.status&&(h("Password changed successfully"),o(""),l(""),c(""))}catch(u){console.error("Error details:",u),m(u.response?.data?.error||"Failed to change password")}else m("You are not authenticated. Please log in again.");else m("New passwords do not match")},style:ir.button,children:"Change Password"})]})]})},{width:lr}=v.default.get("window"),dr="web"===n.default.OS?({label:e,value:t,onChangeText:o,type:a="text",style:n})=>(0,T.jsxs)(r.default,{style:cr.inputContainer,children:[(0,T.jsx)(Y.default,{style:cr.label,children:e}),(0,T.jsx)("textarea",{value:t,onChange:e=>{"number"===a&&isNaN(e.target.value)||o(e.target.value)},style:Object.assign({},cr.webInput,n),rows:1,maxLength:"text"===a?1e3:void 0})]}):({label:e,value:t,onChangeText:o,keyboardType:a="default",maxLength:n,style:i})=>(0,T.jsxs)(r.default,{style:cr.inputContainer,children:[(0,T.jsx)(Y.default,{style:cr.label,children:e}),(0,T.jsx)(q.default,{value:t,onChangeText:o,style:[i,cr.input],keyboardType:a,maxLength:n,multiline:!0})]}),cr=l.default.create({container:{flex:1,backgroundColor:"#fff"},scrollContent:{flexGrow:1,alignItems:"center",paddingVertical:16,paddingBottom:"web"===n.default.OS?16:80},formContainer:{width:"web"===n.default.OS&&lr>600?"40%":"90%",alignItems:"center",paddingBottom:16},profileImageContainer:{marginBottom:16},profileImage:{width:80,height:80,borderRadius:40},profileImagePlaceholder:{width:80,height:80,borderRadius:40,borderWidth:2,borderColor:"#ccc",justifyContent:"center",alignItems:"center"},inputContainer:{width:"100%",alignItems:"center",paddingBottom:"web"===n.default.OS?0:40,flex:1},label:{fontSize:16,marginBottom:8,marginTop:16,textAlign:"center"},boldLabel:{fontSize:16,fontWeight:"bold",marginBottom:8,textAlign:"center"},sectionHeader:{fontSize:25,fontWeight:"bold",marginVertical:16,alignSelf:"flex-start",textAlign:"left"},webInput:{width:"100%",minHeight:24,padding:8,fontSize:16,borderColor:"#ccc",borderWidth:1,borderRadius:4,resize:"none"},input:{width:"100%",height:40,padding:8,fontSize:16,borderColor:"#ccc",borderWidth:1,borderRadius:4},descriptionInput:{width:"100%",minHeight:90,padding:8,fontSize:16,borderColor:"#ccc",borderWidth:1,borderRadius:4,textAlignVertical:"center"},customInput:{width:"100%",padding:8,fontSize:16,borderColor:"#ccc",borderWidth:1,borderRadius:4,marginBottom:8},tabContainer:{flexDirection:"row",marginBottom:16},tab:{flex:1,padding:10,alignItems:"center",justifyContent:"center",borderWidth:1,borderColor:"#ccc"},activeTab:{backgroundColor:"#ddd"},leftTab:{borderTopLeftRadius:10,borderBottomLeftRadius:10},rightTab:{borderTopRightRadius:10,borderBottomRightRadius:10},tabText:{fontSize:16},toggleContainer:{width:"100%",marginBottom:8},buttonRow:{flexDirection:"row",flexWrap:"wrap",justifyContent:"center",marginBottom:8},yesNoContainer:{flexDirection:"row",justifyContent:"center",marginBottom:16},yesNoButton:{marginHorizontal:10,padding:10,borderRadius:20,borderWidth:1,borderColor:"#ccc",alignItems:"center",justifyContent:"center",width:80},activeYesNoButton:{backgroundColor:"#ddd"},yesNoText:{fontSize:16},datePicker:{marginBottom:16,padding:10,borderRadius:4,alignItems:"center",justifyContent:"center",width:"100%"},dateText:{fontSize:16,color:f.theme.colors.text,padding:10,borderWidth:1,borderColor:"#ccc",borderRadius:4,textAlign:"center"},saveButton:{marginTop:16,width:"100%"},timePickerContainer:{flexDirection:"row",justifyContent:"center",alignItems:"center",width:"100%",marginBottom:16},webTimePicker:{padding:8,borderWidth:1,borderColor:"#ccc",borderRadius:4,fontSize:16},documentsContainer:{marginVertical:10,width:"100%"},uploadButton:{flexDirection:"row",alignItems:"center",justifyContent:"center",padding:12,borderWidth:1,borderColor:"#ccc",borderRadius:4,borderStyle:"dashed",marginBottom:10},uploadText:{marginLeft:8,color:"#666"},documentsList:{minHeight:120},documentThumbnail:{width:100,height:100,marginRight:10,borderRadius:4},gallerySection:{width:"100%",marginTop:16},galleryContainer:{flexDirection:"row",flexWrap:"wrap",gap:8,width:"100%"},galleryThumbnail:{width:100,height:100,borderRadius:4,marginRight:8,marginBottom:8},header:{flexDirection:"row",alignItems:"center",padding:16,borderBottomWidth:1,borderBottomColor:f.theme.colors.border},backButton:{marginRight:16},headerText:{fontSize:20,fontWeight:"bold",color:f.theme.colors.primary},scrollViewContent:{paddingBottom:100}}),ur=({route:e})=>{const t=(0,j.useNavigation)(),[o]=(0,a.useState)((()=>{if("web"===n.default.OS){const e=sessionStorage.getItem("editPetData");if(e)return JSON.parse(e)}return e.params?.pet||{}}));(0,a.useEffect)((()=>("web"===n.default.OS&&(window.location.search&&window.history.replaceState({},"","/AddPet"),e.params?.pet&&sessionStorage.setItem("editPetData",JSON.stringify(e.params.pet))),()=>{"web"!==n.default.OS||window.location.pathname.includes("AddPet")||sessionStorage.removeItem("editPetData")})),[]);const i=o,[l,d]=(0,a.useState)(""),[c,u]=(0,a.useState)(i&&i.animal_type?i.animal_type:""),[m,g]=(0,a.useState)(i&&i.animal_type?i.animal_type:""),[h,p]=(0,a.useState)(""),[y,b]=(0,a.useState)(""),[x,w]=(0,a.useState)(""),[C,v]=(0,a.useState)(""),[B,k]=(0,a.useState)(null),[_,A]=(0,a.useState)(null),[I,D]=(0,a.useState)(null),[M,R]=(0,a.useState)(null),[P,z]=(0,a.useState)(null),[F,L]=(0,a.useState)(null),[O,E]=(0,a.useState)(null),[W,N]=(0,a.useState)(new Date),[V,q]=(0,a.useState)(""),[G,J]=(0,a.useState)(null),[$,Z]=(0,a.useState)(!1),[K,Q]=(0,a.useState)(!1),[X,ee]=(0,a.useState)(null),[te,oe]=(0,a.useState)(""),[ae,ne]=(0,a.useState)(null),[re,ie]=(0,a.useState)(null),[se,le]=(0,a.useState)(""),[de,ce]=(0,a.useState)(null),[ue,me]=(0,a.useState)(""),[ge,he]=(0,a.useState)(null),[fe,pe]=(0,a.useState)(""),[ye,be]=(0,a.useState)(""),[xe,je]=(0,a.useState)(""),[we,Ce]=(0,a.useState)(""),[ve,Te]=(0,a.useState)(""),[Be,ke]=(0,a.useState)([]),[_e,Ae]=(0,a.useState)(""),[Ie,De]=(0,a.useState)([]),[Me,ze]=(0,a.useState)(new Date),[Fe,Le]=(0,a.useState)(!1);(0,a.useEffect)((()=>{if(Q(!1),i){if(d(i.name?i.name:""),u(i.animal_type?i.animal_type:""),g("Cat"===i.animal_type||"Dog"===i.animal_type?i.animal_type:"Exotic"),b(i.breed?i.breed:""),p(i.weight?i.weight:""),w(i.age&&i.age.years?i.age.years:""),v(i.age&&i.age.months?i.age.months:""),k(i.sex?i.sex:""),A(void 0!==i.friendlyWithChildren?i.friendlyWithChildren:null),D(void 0!==i.friendlyWithCats?i.friendlyWithCats:null),R(void 0!==i.friendlyWithDogs?i.friendlyWithDogs:null),z(void 0!==i.spayedNeutered?i.spayedNeutered:null),L(void 0!==i.houseTrained?i.houseTrained:null),E(void 0!==i.microchipped?i.microchipped:null),N(i.adoptionDate?new Date(i.adoptionDate):new Date),q(i.description?i.description:""),ne(i.energyLevel?i.energyLevel:""),Array.isArray(i.feedingSchedule)?(ie(i.feedingSchedule[0]),le(i.feedingSchedule[1])):(ie(i.feedingSchedule?i.feedingSchedule:""),le("")),ce(i.leftAlone?i.leftAlone:""),he(i.medication?i.medication:""),be(i.additionalInstructions?i.additionalInstructions:""),je(i.vetName?i.vetName:""),Ce(i.vetAddress?i.vetAddress:""),Te(i.vetPhone?i.vetPhone:""),Ae(i.insuranceProvider?i.insuranceProvider:""),ke(i.veterinarian&&i.veterinarian.documents?i.veterinarian.documents:[]),De(i.galleryImages?i.galleryImages:[]),i.age){const e=new Date,t=new Date(e.getFullYear()-i.age.years,e.getMonth()-i.age.months);ze(t)}}else d(""),u(""),g(""),p(""),w(""),v(""),k(""),A(null),D(null),R(null),z(null),L(null),E(null),N(new Date),q(""),ne(""),ie(""),le(""),ce(""),he(""),be(""),je(""),Ce(""),Te(""),Ae(""),ke([]),De([])}),[i]),(0,a.useEffect)((()=>{if(x&&C){const e=new Date,t=new Date(e.getFullYear()-parseInt(x),e.getMonth()-parseInt(C));ze(t)}}),[x,C]);const Oe=e=>(0,T.jsx)(s.default,{style:[cr.tab,m===e&&cr.activeTab,"Dog"===e&&cr.leftTab,"Exotic"===e&&cr.rightTab],onPress:()=>{g(e),Q(!0)},children:(0,T.jsx)(Y.default,{style:cr.tabText,children:e})}),We=(e,t,o,a=!1,i="",l=()=>{})=>(0,T.jsxs)(r.default,{style:cr.toggleContainer,children:[(0,T.jsx)(r.default,{style:cr.buttonRow,children:e.map((e=>(0,T.jsx)(s.default,{style:[cr.yesNoButton,t===e&&cr.activeYesNoButton],onPress:()=>o(e),children:(0,T.jsx)(Y.default,{style:cr.yesNoText,children:e})},e)))}),(a&&"Custom"===t||e.includes("Pill")&&t)&&("web"===n.default.OS?(0,T.jsx)(r.default,{style:cr.inputContainer,children:(0,T.jsx)("textarea",{value:i,onChange:e=>l(e.target.value),style:cr.webInput,placeholder:e.includes("Pill")?"Enter medication details":"Enter custom time"})}):(0,T.jsx)(dr,{value:i,onChangeText:l,style:[cr.customInput,{width:"100%"}],placeholder:e.includes("Pill")?"Enter medication details":"Enter custom time"}))]}),Ne=(e,t)=>(0,T.jsxs)(r.default,{style:cr.yesNoContainer,children:[(0,T.jsx)(s.default,{style:[cr.yesNoButton,!0===e&&cr.activeYesNoButton],onPress:()=>t(!0),children:(0,T.jsx)(Y.default,{style:cr.yesNoText,children:"Yes"})}),(0,T.jsx)(s.default,{style:[cr.yesNoButton,!1===e&&cr.activeYesNoButton],onPress:()=>t(!1),children:(0,T.jsx)(Y.default,{style:cr.yesNoText,children:"No"})})]}),He=e=>t=>{e(t),Q(!0)};return(0,T.jsxs)(Se.default,{style:cr.container,children:[(0,T.jsxs)(r.default,{style:cr.header,children:[(0,T.jsx)(s.default,{onPress:()=>t.navigate("MyPets"),style:cr.backButton,children:(0,T.jsx)(S.default,{name:"arrow-left",size:24,color:f.theme.colors.primary})}),(0,T.jsx)(Y.default,{style:cr.headerText,children:i&&Object.keys(i).length>0?"Edit Pet":"Add a New Pet"})]}),(0,T.jsx)(H.default,{contentContainerStyle:cr.scrollContent,children:(0,T.jsxs)(r.default,{style:cr.formContainer,children:[(0,T.jsxs)(Y.default,{style:cr.sectionHeader,children:[(0,T.jsx)(S.default,{name:"paw",size:20})," Pet Details"]}),(0,T.jsx)(Y.default,{style:cr.label,children:"Profile Photo"}),(0,T.jsx)(s.default,{onPress:async()=>{const e=await Re.launchImageLibraryAsync({mediaTypes:Pe.MediaTypeOptions.Images,allowsEditing:!0,aspect:[1,1],quality:1});e.canceled||J(e.assets[0].uri)},style:cr.profileImageContainer,children:G?(0,T.jsx)(U.default,{source:{uri:G},style:cr.profileImage}):(0,T.jsx)(r.default,{style:cr.profileImagePlaceholder,children:(0,T.jsx)(S.default,{name:"camera",size:40,color:"#ccc"})})}),(0,T.jsxs)(r.default,{style:cr.tabContainer,children:[Oe("Dog"),Oe("Cat"),Oe("Exotic")]}),(0,T.jsx)(dr,{label:"Pet Name",value:l,onChangeText:He(d),placeholder:i?i.name:"Enter pet name"}),"Exotic"===m&&(0,T.jsx)(dr,{label:"Pet Type",value:i.animal_type?i.animal_type:"",onChangeText:He(u),placeholder:i?i.animal_type:"Enter pet type"}),(0,T.jsx)(dr,{label:"Weight (lbs)",value:h.toString(),onChangeText:He(p),keyboardType:"numeric"}),(0,T.jsxs)(r.default,{style:cr.inputContainer,children:[(0,T.jsx)(Y.default,{style:cr.label,children:"Estimated Birthday:"}),(0,T.jsx)(s.default,{onPress:()=>Le(!0),children:(0,T.jsx)(Y.default,{style:cr.dateText,children:(0,ko.format)(Me,"yyyy-MM-dd")})}),Fe&&(0,T.jsx)(pt,{value:Me,onChange:e=>{e&&(ze(e),(e=>{const t=new Date,o=new Date(e);let a=t.getFullYear()-o.getFullYear(),n=t.getMonth()-o.getMonth();n<0&&(a--,n+=12),w(a.toString()),v(n.toString())})(e),Q(!0)),Le(!1)}})]}),(0,T.jsx)(dr,{label:"Age in Years",value:x.toString()?x.toString():"",onChangeText:He(w),keyboardType:"numeric",maxLength:2}),(0,T.jsx)(dr,{label:"Age in Months",value:""===C?"":"0"===C?"0":C.toString(),onChangeText:He(v),keyboardType:"numeric",maxLength:2}),(0,T.jsx)(dr,{label:"Breed",value:y,onChangeText:He(b)}),(0,T.jsx)(Y.default,{style:cr.boldLabel,children:"Sex:"}),(Ue=B,(0,T.jsxs)(r.default,{style:cr.yesNoContainer,children:[(0,T.jsx)(s.default,{style:[cr.yesNoButton,"Male"===Ue&&cr.activeYesNoButton],onPress:()=>{k("Male"),Q(!0)},children:(0,T.jsx)(Y.default,{style:cr.yesNoText,children:"Male"})}),(0,T.jsx)(s.default,{style:[cr.yesNoButton,"Female"===Ue&&cr.activeYesNoButton],onPress:()=>{k("Female"),Q(!0)},children:(0,T.jsx)(Y.default,{style:cr.yesNoText,children:"Female"})})]})),("Dog"===m||"Cat"===m)&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(Y.default,{style:cr.boldLabel,children:"Friendly with Children:"}),Ne(_,A),(0,T.jsx)(Y.default,{style:cr.boldLabel,children:"Friendly with Cats:"}),Ne(I,D),(0,T.jsx)(Y.default,{style:cr.boldLabel,children:"Friendly with Dogs:"}),Ne(M,R),(0,T.jsx)(Y.default,{style:cr.boldLabel,children:"Spayed/Neutered:"}),Ne(P,z),(0,T.jsx)(Y.default,{style:cr.boldLabel,children:"House Trained:"}),Ne(F,L),(0,T.jsx)(Y.default,{style:cr.boldLabel,children:"Microchipped:"}),Ne(O,E)]}),(0,T.jsx)(Y.default,{style:cr.boldLabel,children:"Adoption Date:"}),"web"===n.default.OS?(0,T.jsx)(r.default,{style:cr.timePickerContainer,children:(0,T.jsx)("input",{type:"date",value:(0,ko.format)(W,"yyyy-MM-dd"),onChange:e=>{const t=new Date(e.target.value);N(t)},style:cr.webTimePicker})}):(0,T.jsx)(ht.default,{value:W,mode:"date",display:"default",onChange:(e,t)=>{t&&N(t)}}),(0,T.jsx)(r.default,{style:{height:16}}),(0,T.jsx)(r.default,{style:cr.inputContainer,children:(0,T.jsx)(dr,{label:"Pet Description",value:V,onChangeText:He(q),maxLength:1e3,multiline:!0,style:cr.descriptionInput})}),(0,T.jsxs)(Y.default,{style:cr.sectionHeader,children:[(0,T.jsx)(S.default,{name:"heart",size:20})," Care Information"]}),"Dog"===c&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(Y.default,{style:cr.boldLabel,children:"Potty Break Schedule:"}),We(["2 hours","4 hours","8 hours","Custom"],X,ee,!0,te,oe)]}),(0,T.jsx)(Y.default,{style:cr.boldLabel,children:"Energy Level:"}),We(["High","Moderate","Low"],ae,ne),(0,T.jsx)(Y.default,{style:cr.boldLabel,children:"Feeding Schedule:"}),We(["Morning","Twice a day","Custom"],re,ie,!0,se,le),(0,T.jsx)(Y.default,{style:cr.boldLabel,children:"Can Be Left Alone:"}),We(["<1 hour","1-4 hours","4-8 hours","Custom"],de,ce,!0,ue,me),(0,T.jsx)(Y.default,{style:cr.boldLabel,children:"Medication:"}),We(["Pill","Topical","Injection"],ge,he,!0,fe,pe),(0,T.jsx)(r.default,{style:cr.inputContainer,children:(0,T.jsx)(dr,{label:"Anything Else The Professional Should Know",value:ye,onChangeText:He(be),maxLength:1e3,multiline:!0,style:cr.descriptionInput,placeholder:"Add custom instructions"})}),(0,T.jsxs)(Y.default,{style:cr.sectionHeader,children:[(0,T.jsx)(S.default,{name:"medical-bag",size:20})," Health Information"]}),(0,T.jsx)(dr,{label:"Veterinarian Name",value:xe,onChangeText:He(je)}),(0,T.jsx)(dr,{label:"Veterinarian Address",value:we,onChangeText:He(Ce),multiline:!0}),(0,T.jsx)(dr,{label:"Veterinarian Phone",value:ve,onChangeText:He(Te),keyboardType:"phone-pad"}),(0,T.jsx)(dr,{label:"Pet Insurance Provider",value:_e,onChangeText:He(Ae),style:cr.input}),(0,T.jsx)(Y.default,{style:cr.boldLabel,children:"Veterinary Documents:"}),(0,T.jsxs)(r.default,{style:cr.documentsContainer,children:[(0,T.jsxs)(s.default,{style:cr.uploadButton,onPress:async()=>{const e=await Re.launchImageLibraryAsync({mediaTypes:Pe.MediaTypeOptions.All,allowsMultipleSelection:!0,quality:1});e.canceled||ke([...Be,...e.assets])},children:[(0,T.jsx)(S.default,{name:"file-upload",size:24,color:"#666"}),(0,T.jsx)(Y.default,{style:cr.uploadText,children:"Upload Documents"})]}),Be.length>0&&(0,T.jsx)(H.default,{horizontal:!0,showsHorizontalScrollIndicator:!1,style:cr.documentsList,children:Be.map(((e,t)=>(0,T.jsx)(U.default,{source:{uri:e.uri},style:cr.documentThumbnail},t)))})]}),(0,T.jsxs)(r.default,{style:cr.gallerySection&&cr.scrollViewContent,children:[(0,T.jsxs)(Y.default,{style:cr.sectionHeader,children:[(0,T.jsx)(S.default,{name:"image-multiple",size:20})," Photo Gallery"]}),(0,T.jsxs)(s.default,{style:cr.uploadButton,onPress:async()=>{try{if("web"!==n.default.OS){const{status:e}=await Re.requestMediaLibraryPermissionsAsync();if("granted"!==e)return void alert("Sorry, we need camera roll permissions to make this work!")}const e=await Re.launchImageLibraryAsync({mediaTypes:Pe.MediaTypeOptions.Images,allowsMultipleSelection:!0,quality:1,aspect:[1,1]});e.canceled||De((t=>[...t,...e.assets]))}catch(e){console.error("Error picking images:",e),alert("Error selecting images. Please try again.")}},children:[(0,T.jsx)(S.default,{name:"image-plus",size:24,color:"#666"}),(0,T.jsx)(Y.default,{style:cr.uploadText,children:"Add Photos"})]}),Ie.length>0&&(0,T.jsx)(r.default,{style:cr.galleryContainer,children:Ie.map(((e,t)=>(0,T.jsx)(U.default,{source:{uri:e.uri},style:cr.galleryThumbnail,resizeMode:"cover"},t)))})]})]})}),(0,T.jsx)(Ee,{visible:K,onSave:()=>{Z(!0),Q(!1);const e={petName:l,petType:"Exotic"!==m?m:c,weight:h,breed:y,estimatedBirthday:Me,age:{years:x,months:C},sex:B,profileImage:G,description:V,adoptionDate:(0,ko.format)(W,"yyyy-MM-dd"),friendlyWithChildren:_,friendlyWithCats:I,friendlyWithDogs:M,spayedNeutered:P,houseTrained:F,microchipped:O,pottyBreakSchedule:"Custom"===X?te:X,energyLevel:ae,feedingSchedule:"Custom"===re?se:re,leftAlone:"Custom"===de?ue:de,medication:ge?{type:ge,details:fe}:null,additionalInstructions:ye,veterinarian:{name:xe,address:we,phone:ve,documents:Be.map((e=>({uri:e.uri,type:e.type,name:e.fileName||"document"})))},insuranceProvider:_e,galleryImages:Ie.map((e=>({uri:e.uri,type:e.type,name:e.fileName||"image"})))};console.log("Pet Profile Data:",JSON.stringify(e,null,2)),setTimeout((()=>{Z(!1)}),1e3)},btnText:"Save Profile"})]});var Ue};o(90013);var mr=o(27851),gr=o.n(mr);o(5433),o(31943);l.default.create({container:{position:"relative"},dropdownContainer:{position:"relative"},header:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:6,borderWidth:1,borderColor:f.theme.colors.border,borderRadius:8,backgroundColor:f.theme.colors.background},dropdown:{position:"absolute",top:"100%",left:0,right:0,maxHeight:200,backgroundColor:f.theme.colors.background,borderWidth:1,borderColor:f.theme.colors.border,borderRadius:8,marginTop:4,elevation:1e3,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:3.84,zIndex:9999},scrollView:{maxHeight:200},scrollViewContent:{flexGrow:1},item:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:12,borderBottomWidth:1,borderBottomColor:f.theme.colors.border},itemText:{fontSize:f.theme.fontSizes.medium+2,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily},placeholderText:{color:f.theme.colors.placeholderText,fontSize:f.theme.fontSizes.medium+2,fontFamily:f.theme.fonts.regular.fontFamily},selectedText:{color:f.theme.colors.text,fontSize:f.theme.fontSizes.medium+2,fontFamily:f.theme.fonts.regular.fontFamily},chipsContainer:{flexDirection:"row",flexWrap:"wrap",gap:8,marginTop:8},chip:{flexDirection:"row",alignItems:"center",backgroundColor:f.theme.colors.background,borderWidth:1,borderColor:f.theme.colors.primary,borderRadius:16,paddingVertical:4,paddingHorizontal:8},chipText:{fontSize:f.theme.fontSizes.small+2,color:f.theme.colors.text,marginRight:4,fontFamily:f.theme.fonts.regular.fontFamily},chipRemove:{padding:2},label:{fontSize:f.theme.fontSizes.medium,color:f.theme.colors.text,marginBottom:f.theme.spacing.small,fontFamily:f.theme.fonts.header.fontFamily}});const hr=l.default.create({modalOverlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center"},tooltipContainer:{backgroundColor:f.theme.colors.surface,padding:f.theme.spacing.medium,borderRadius:8,maxWidth:300,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:3.84,elevation:5},tooltipText:{fontSize:f.theme.fontSizes.medium,color:f.theme.colors.text,textAlign:"center"},right:{marginLeft:f.theme.spacing.medium},left:{marginRight:f.theme.spacing.medium},top:{marginBottom:f.theme.spacing.medium},bottom:{marginTop:f.theme.spacing.medium},tooltipHeader:{alignItems:"flex-end",marginBottom:f.theme.spacing.small},closeButton:{width:24,height:24,alignItems:"center",justifyContent:"center",borderRadius:12},closeButtonText:{fontSize:20,color:f.theme.colors.text,lineHeight:20}}),fr=({children:e,content:t,position:o="right"})=>{const[n,l]=(0,a.useState)(!1);return(0,T.jsxs)(r.default,{children:[(0,T.jsx)(s.default,{onPress:()=>l(!0),children:e}),(0,T.jsx)(_.default,{transparent:!0,visible:n,onRequestClose:()=>l(!1),children:(0,T.jsx)(Qe.default,{onPress:()=>l(!1),children:(0,T.jsx)(r.default,{style:hr.modalOverlay,children:(0,T.jsxs)(r.default,{style:[hr.tooltipContainer,hr[o]],children:[(0,T.jsx)(r.default,{style:hr.tooltipHeader,children:(0,T.jsx)(s.default,{onPress:()=>l(!1),style:hr.closeButton,children:(0,T.jsx)(i.default,{style:hr.closeButtonText,children:"\xd7"})})}),(0,T.jsx)(i.default,{style:hr.tooltipText,children:t})]})})})})]})},pr=l.default.create({container:{width:"100%",position:"relative",marginRight:f.theme.spacing.medium,marginBottom:f.theme.spacing.medium,zIndex:1e3},input:{height:48,borderWidth:1,borderColor:f.theme.colors.border,borderRadius:8,paddingHorizontal:f.theme.spacing.medium,backgroundColor:f.theme.colors.surface,width:"100%"},suggestionsWrapper:{position:"absolute",top:"100%",left:0,right:0,maxHeight:200,backgroundColor:f.theme.colors.background,borderWidth:1,borderColor:f.theme.colors.border,borderRadius:8,zIndex:1e3,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:3,elevation:3},suggestionsContainer:{flex:1},suggestionItem:{padding:f.theme.spacing.medium,borderBottomWidth:1,borderBottomColor:f.theme.colors.border}}),yr=({value:e,onChange:t})=>{const[o,n]=(0,a.useState)(!1),[l,d]=(0,a.useState)([]);return(0,T.jsxs)(r.default,{style:pr.container,children:[(0,T.jsx)(q.default,{style:pr.input,placeholder:"Search services...",value:e,onChangeText:e=>{if(t(e),e.length>0){const t=ae.filter((t=>t.toLowerCase().includes(e.toLowerCase())));d(t),n(!0)}else n(!1)},onFocus:()=>e.length>0&&n(!0)}),o&&(0,T.jsx)(r.default,{style:pr.suggestionsWrapper,children:(0,T.jsx)(H.default,{style:pr.suggestionsContainer,keyboardShouldPersistTaps:"always",nestedScrollEnabled:!0,children:l.map(((e,o)=>(0,T.jsx)(s.default,{style:pr.suggestionItem,onPress:()=>(e=>{t(e),n(!1)})(e),children:(0,T.jsx)(i.default,{children:e})},o)))})})]})},br=(["Farm Animals","Domestic","Exotic","Aquatic","Invertibrates"].map((e=>({label:e,value:e.toLowerCase().replace(/\s+/g,"-")}))),({value:e,onChange:t,suggestions:o,onSuggestionSelect:n})=>{const l=(0,a.useRef)(null),[d,c]=(0,a.useState)(!1),u=(0,a.useCallback)((0,la.debounce)((async e=>{if(!(e.length<1))try{const t=await fetch("https://nominatim.openstreetmap.org/search?format=json&q=".concat(e,"&countrycodes=us&limit=5"),{headers:{Accept:"application/json","User-Agent":"ZenExotics Mobile App"}}),o=(await t.json()).map((e=>({display_name:e.display_name,lat:e.lat,lon:e.lon})));n(o)}catch(t){console.error("Error fetching locations:",t),n([])}}),300),[n]);return(0,T.jsxs)(r.default,{style:[jr.locationInputWrapper,{zIndex:2}],children:[(0,T.jsx)(q.default,{ref:l,style:jr.locationInput,placeholder:"Enter city, state, or zip",value:e,onChangeText:e=>{t(e),e.length<1?n([]):u(e)}}),o.length>0&&(0,T.jsx)(r.default,{style:jr.suggestionsWrapper,children:(0,T.jsx)(H.default,{style:jr.suggestionsContainer,keyboardShouldPersistTaps:"always",nestedScrollEnabled:!0,children:o.map(((e,o)=>(0,T.jsx)(s.default,{style:jr.suggestionItem,onPress:()=>{t(e.display_name),n([])},children:(0,T.jsx)(i.default,{children:e.display_name})},o)))})})]})}),xr=({icon:e,label:t,selected:o,onPress:a})=>(0,T.jsxs)(s.default,{style:[jr.animalTypeButton,o&&jr.animalTypeButtonSelected],onPress:a,children:[(0,T.jsx)(S.default,{name:e,size:24,color:o?f.theme.colors.whiteText:f.theme.colors.text}),(0,T.jsx)(i.default,{style:[jr.animalTypeLabel,o&&jr.animalTypeLabelSelected],children:t})]}),jr=l.default.create({container:{padding:f.theme.spacing.medium,backgroundColor:f.theme.colors.surface,height:"100%",width:"100%",overflow:"visible"},header:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:f.theme.spacing.xlarge,gap:f.theme.spacing.small},title:{fontSize:f.theme.fontSizes.xlarge,fontWeight:"600",color:f.theme.colors.text,fontFamily:f.theme.fonts.header.fontFamily},section:{marginBottom:f.theme.spacing.xlarge,position:"relative"},label:{fontSize:f.theme.fontSizes.medium,fontWeight:"500",color:f.theme.colors.text,marginVertical:f.theme.spacing.small,fontFamily:f.theme.fonts.regular.fontFamily},dropdown:{height:48,backgroundColor:f.theme.colors.background,borderRadius:8,padding:f.theme.spacing.medium,borderWidth:1,borderColor:f.theme.colors.border},locationInputWrapper:{position:"relative",marginBottom:f.theme.spacing.small,zIndex:900},locationInput:{height:48,borderWidth:1,borderColor:f.theme.colors.border,borderRadius:8,paddingHorizontal:f.theme.spacing.medium,backgroundColor:f.theme.colors.background,fontSize:f.theme.fontSizes.medium},suggestionsWrapper:{position:"absolute",top:"100%",left:0,right:0,maxHeight:200,backgroundColor:f.theme.colors.background,borderWidth:1,borderColor:f.theme.colors.border,borderRadius:8,zIndex:900,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:3,elevation:3},suggestionsContainer:{flex:1},suggestionItem:{padding:f.theme.spacing.medium,borderBottomWidth:1,borderBottomColor:f.theme.colors.border},datePickersContainer:{flexDirection:"column",gap:f.theme.spacing.medium,marginRight:16,zIndex:500},datePickerWrapper:{width:"100%"},dateLabel:{fontSize:f.theme.fontSizes.medium,color:f.theme.colors.text,marginBottom:8,fontFamily:f.theme.fonts.regular.fontFamily,fontWeight:"500"},dateInput:{height:48,backgroundColor:f.theme.colors.background,borderRadius:8,padding:f.theme.spacing.medium,borderWidth:1,borderColor:f.theme.colors.border,fontSize:f.theme.fontSizes.medium},priceRangeContainer:{flexDirection:"row",alignItems:"center",gap:f.theme.spacing.medium,marginTop:f.theme.spacing.small},slider:{flex:1,height:48,marginHorizontal:f.theme.spacing.medium},priceText:{fontSize:f.theme.fontSizes.medium,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily,minWidth:50},selectedText:{fontSize:f.theme.fontSizes.medium,color:f.theme.colors.text,fontWeight:"500",fontFamily:f.theme.fonts.regular.fontFamily},placeholderText:{fontSize:f.theme.fontSizes.medium,color:f.theme.colors.placeholderText,fontFamily:f.theme.fonts.regular.fontFamily},dropdownContainer:{backgroundColor:f.theme.colors.background,borderRadius:8,borderWidth:1,borderColor:f.theme.colors.border,overflow:"hidden"},dropdownItem:{padding:f.theme.spacing.medium},dropdownItemSelected:{backgroundColor:f.theme.colors.surface,borderWidth:1,borderColor:f.theme.colors.primary,borderRadius:8,margin:4},dropdownItemText:{fontSize:f.theme.fontSizes.medium,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily},dropdownItemTextSelected:{color:f.theme.colors.primary,fontWeight:"500",fontFamily:f.theme.fonts.regular.fontFamily},personButton:{padding:f.theme.spacing.small,borderRadius:8,marginLeft:"auto"},showProfessionalsButton:{backgroundColor:f.theme.colors.primary,padding:f.theme.spacing.medium,borderRadius:8,alignItems:"center",marginTop:f.theme.spacing.large},showProfessionalsText:{color:f.theme.colors.whiteText,fontSize:f.theme.fontSizes.medium,fontWeight:"600",fontFamily:f.theme.fonts.regular.fontFamily},locationContainer:{flexDirection:"column",width:"100%",gap:f.theme.spacing.small,zIndex:900,position:"relative"},useLocationButton:{flexDirection:"row",alignItems:"center",padding:f.theme.spacing.small,backgroundColor:f.theme.colors.surface,borderRadius:8,borderWidth:1,borderColor:f.theme.colors.border,gap:4,alignSelf:"flex-start"},useLocationText:{color:f.theme.colors.text,fontSize:f.theme.fontSizes.small},input:{height:48,borderWidth:1,borderColor:f.theme.colors.border,borderRadius:8,paddingHorizontal:f.theme.spacing.medium,backgroundColor:f.theme.colors.surface},animalTypesContainer:{flexDirection:"row",flexWrap:"wrap",gap:f.theme.spacing.small,marginTop:f.theme.spacing.small,marginBottom:f.theme.spacing.medium,zIndex:800},animalTypeButton:{flexDirection:"row",alignItems:"center",padding:f.theme.spacing.small,backgroundColor:f.theme.colors.surface,borderRadius:20,borderWidth:1,borderColor:f.theme.colors.border,gap:4},animalTypeButtonSelected:{backgroundColor:f.theme.colors.primary,borderColor:f.theme.colors.primary},animalTypeLabel:{color:f.theme.colors.text,fontSize:f.theme.fontSizes.small},animalTypeLabelSelected:{color:f.theme.colors.whiteText},switchContainer:{flexDirection:"row",alignItems:"center",justifyContent:"web"===n.default.OS?"space-between":"flex-start",marginVertical:f.theme.spacing.small,gap:f.theme.spacing.medium,zIndex:700},priceContainer:{flexDirection:"row",alignItems:"center",gap:f.theme.spacing.small,zIndex:600},priceLabel:{fontSize:f.theme.fontSizes.medium,color:f.theme.colors.text,minWidth:50},checkboxContainer:{marginTop:f.theme.spacing.medium,gap:f.theme.spacing.small,zIndex:400},checkboxRow:{flexDirection:"row",alignItems:"center",gap:f.theme.spacing.small},checkbox:{width:24,height:24,borderWidth:1,borderColor:f.theme.colors.border,borderRadius:4,alignItems:"center",justifyContent:"center",backgroundColor:f.theme.colors.surface},checkboxLabel:{flex:1,fontSize:f.theme.fontSizes.medium,color:f.theme.colors.text},headerButtons:{flexDirection:"row",gap:f.theme.spacing.small},iconButton:{padding:f.theme.spacing.small,borderRadius:8},checkboxLabelContainer:{flex:1,flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingRight:f.theme.spacing.small},searchButton:{backgroundColor:f.theme.colors.primary,padding:f.theme.spacing.medium,borderRadius:8,alignItems:"center",marginTop:f.theme.spacing.large,marginBottom:f.theme.spacing.large},searchButtonText:{color:f.theme.colors.whiteText,fontSize:f.theme.fontSizes.medium,fontWeight:"600"}}),wr=({onFiltersChange:e,onShowProfessionals:t,isMobile:o})=>{const[n,l]=(0,a.useState)(""),[d,c]=(0,a.useState)([]),[u,m]=(0,a.useState)(""),[g,h]=(0,a.useState)([]),[y,b]=(0,a.useState)(!1),[x,j]=(0,a.useState)(200),[w,C]=(0,a.useState)(new Date),[v,B]=(0,a.useState)(new Date),[k,_]=(0,a.useState)(!1),[A,I]=(0,a.useState)(!1),{screenWidth:D}=(0,a.useContext)(p.AuthContext),M=e=>{g.includes(e)?h(g.filter((t=>t!==e))):h([...g,e])};return(0,T.jsxs)(H.default,{style:jr.container,children:[(0,T.jsxs)(r.default,{style:jr.header,children:[(0,T.jsx)(i.default,{style:jr.title,children:"Refine Search"}),(0,T.jsx)(s.default,{style:jr.personButton,onPress:t,children:(0,T.jsx)(S.default,{name:"account-group",size:24,color:f.theme.colors.text})}),o&&(0,T.jsx)(r.default,{style:jr.headerButtons,children:(0,T.jsx)(s.default,{style:jr.iconButton,onPress:()=>{t&&t("map")},children:(0,T.jsx)(S.default,{name:"map",size:24,color:f.theme.colors.text})})})]}),(0,T.jsx)(i.default,{style:jr.label,children:"I'm looking for services for my:"}),(0,T.jsxs)(r.default,{style:jr.animalTypesContainer,children:[(0,T.jsx)(xr,{icon:"dog",label:"Dogs",selected:g.includes("dogs"),onPress:()=>M("dogs")}),(0,T.jsx)(xr,{icon:"cat",label:"Cats",selected:g.includes("cats"),onPress:()=>M("cats")}),(0,T.jsx)(xr,{icon:"fish",label:"Fish",selected:g.includes("fish"),onPress:()=>M("fish")}),(0,T.jsx)(xr,{icon:"bird",label:"Birds",selected:g.includes("birds"),onPress:()=>M("birds")})]}),(0,T.jsx)(i.default,{style:jr.label,children:"What service do you need? (e.g., Dog Walking, Pet Sitting)"}),(0,T.jsx)(yr,{value:u,onChange:m}),(0,T.jsx)(i.default,{style:jr.label,children:"Location"}),(0,T.jsxs)(r.default,{style:jr.locationContainer,children:[(0,T.jsx)(br,{value:n,onChange:l,suggestions:d,onSuggestionSelect:c}),(0,T.jsxs)(s.default,{style:[jr.useLocationButton,{marginBottom:16}],children:[(0,T.jsx)(S.default,{name:"crosshairs-gps",size:20,color:f.theme.colors.text}),(0,T.jsx)(i.default,{style:jr.useLocationText,children:"Use My Location"})]})]}),(0,T.jsxs)(r.default,{style:jr.switchContainer,children:[(0,T.jsx)(i.default,{style:jr.label,children:"Overnight Service"}),(0,T.jsx)($e.default,{value:y,onValueChange:b,trackColor:{false:f.theme.colors.border,true:f.theme.colors.primary}})]}),(0,T.jsx)(i.default,{style:jr.label,children:"Price Range"}),(0,T.jsxs)(r.default,{style:jr.priceContainer,children:[(0,T.jsx)(i.default,{style:jr.priceLabel,children:"$0"}),(0,T.jsx)(gr(),{style:jr.slider,minimumValue:0,maximumValue:250,value:x,onValueChange:j,minimumTrackTintColor:f.theme.colors.primary,maximumTrackTintColor:f.theme.colors.border,thumbTintColor:f.theme.colors.primary,step:1}),(0,T.jsxs)(i.default,{style:jr.priceLabel,children:["$",Math.round(x)]})]}),(0,T.jsx)(i.default,{style:jr.label,children:"Date Range"}),(0,T.jsxs)(r.default,{style:jr.datePickersContainer,children:[(0,T.jsx)(pt,{label:"Start Date",value:w,onChange:C}),(0,T.jsx)(pt,{label:"End Date",value:v,onChange:B})]}),(0,T.jsxs)(r.default,{style:jr.checkboxContainer,children:[(0,T.jsxs)(r.default,{style:jr.checkboxRow,children:[(0,T.jsx)(s.default,{style:jr.checkbox,onPress:()=>_(!k),children:k&&(0,T.jsx)(S.default,{name:"check",size:20,color:f.theme.colors.primary})}),(0,T.jsxs)(r.default,{style:jr.checkboxLabelContainer,children:[(0,T.jsx)(i.default,{style:jr.checkboxLabel,children:"Verified Professionals Only"}),(0,T.jsx)(fr,{content:"Verified professionals have completed our background check and identity verification process.",position:"right",children:(0,T.jsx)(S.default,{name:"help-circle-outline",size:20,color:f.theme.colors.text})})]})]}),(0,T.jsxs)(r.default,{style:jr.checkboxRow,children:[(0,T.jsx)(s.default,{style:jr.checkbox,onPress:()=>I(!A),children:A&&(0,T.jsx)(S.default,{name:"check",size:20,color:f.theme.colors.primary})}),(0,T.jsxs)(r.default,{style:jr.checkboxLabelContainer,children:[(0,T.jsx)(i.default,{style:jr.checkboxLabel,children:"Insured Service Providers"}),(0,T.jsx)(fr,{content:"Insured providers maintain current liability insurance coverage for their services.",position:"right",children:(0,T.jsx)(S.default,{name:"help-circle-outline",size:20,color:f.theme.colors.text})})]})]})]}),(0,T.jsx)(s.default,{style:jr.searchButton,onPress:()=>{t()},children:(0,T.jsx)(i.default,{style:jr.searchButtonText,children:"Search"})})]})},Cr=({professional:e,index:t})=>{const a=(0,j.useNavigation)();return(0,T.jsxs)(s.default,{style:vr.listItem,onPress:()=>{a.navigate("ProfessionalProfile",{professional:e})},children:[(0,T.jsxs)(r.default,{style:vr.cardContent,children:[(0,T.jsx)(r.default,{style:vr.leftSection,children:(0,T.jsx)(U.default,{source:e.profilePicture,style:vr.profileImage})}),(0,T.jsx)(r.default,{style:vr.mainContent,children:(0,T.jsxs)(r.default,{style:vr.header,children:[(0,T.jsxs)(r.default,{style:vr.nameSection,children:[(0,T.jsxs)(i.default,{style:vr.name,children:[t+1,". ",e.name]}),(0,T.jsx)(i.default,{style:vr.location,children:e.location}),e.distance&&(0,T.jsx)(i.default,{style:vr.distance,children:e.distance})]}),(0,T.jsxs)(r.default,{style:vr.priceSection,children:[(0,T.jsx)(i.default,{style:vr.fromText,children:"from"}),(0,T.jsxs)(i.default,{style:vr.amount,children:[(0,T.jsx)(i.default,{style:vr.dollarSign,children:"$"}),e.price]}),(0,T.jsx)(i.default,{style:vr.perNight,children:"per night"})]})]})})]}),(0,T.jsxs)(r.default,{style:vr.reviewSection,children:[(0,T.jsxs)(r.default,{style:vr.ratingContainer,children:[(0,T.jsx)(S.default,{name:"star",size:16,color:"#FFD700"}),(0,T.jsx)(i.default,{style:vr.ratingText,children:e.rating}),(0,T.jsx)(i.default,{style:vr.dot,children:" \u2022 "}),(0,T.jsxs)(i.default,{style:vr.reviews,children:[e.reviewCount," reviews"]}),e.repeat_owners&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(i.default,{style:vr.dot,children:" \u2022 "}),(0,T.jsx)(S.default,{name:"sync",size:16,color:f.theme.colors.text}),(0,T.jsxs)(i.default,{style:vr.repeatOwners,children:[" ",e.repeat_owners," repeat owners"]})]})]}),e.bestReview&&(0,T.jsxs)(r.default,{style:vr.bestReviewContainer,children:[(0,T.jsx)(U.default,{source:o(4456),style:vr.reviewerImage}),(0,T.jsx)(r.default,{style:vr.bestReviewTextContainer,children:(0,T.jsxs)(i.default,{style:vr.bestReview,numberOfLines:2,children:['"',e.bestReview,'"',(0,T.jsx)(i.default,{style:vr.readMore,children:" Read more"})]})})]})]})]})},vr=l.default.create({container:{flex:1,width:"100%",backgroundColor:f.theme.colors.surfaceContrast},listContent:{flexGrow:1},listItem:{width:"100%",height:"100%",backgroundColor:f.theme.colors.surfaceContrast,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:3,elevation:3},cardContent:{flexDirection:"row",paddingHorizontal:f.theme.spacing.medium,paddingTop:f.theme.spacing.medium},leftSection:{marginRight:f.theme.spacing.medium},profileImage:{width:80,height:80,borderRadius:40},mainContent:{flex:1},header:{flexDirection:"row",justifyContent:"space-between",alignItems:"flex-start"},nameSection:{flex:1,marginRight:f.theme.spacing.medium},name:{fontSize:f.theme.fontSizes.large,fontWeight:"600",color:f.theme.colors.text,marginBottom:4},location:{fontSize:f.theme.fontSizes.medium,color:f.theme.colors.textSecondary,marginBottom:2},distance:{fontSize:f.theme.fontSizes.small,color:f.theme.colors.textSecondary},priceSection:{alignItems:"flex-end"},fromText:{fontSize:f.theme.fontSizes.small,color:f.theme.colors.textSecondary},amount:{fontSize:f.theme.fontSizes.large+4,fontWeight:"600",color:f.theme.colors.primary,marginVertical:2},dollarSign:{color:f.theme.colors.primary},perNight:{fontSize:f.theme.fontSizes.small,color:f.theme.colors.textSecondary},reviewSection:{paddingHorizontal:f.theme.spacing.medium,paddingVertical:f.theme.spacing.small,borderBottomWidth:1,borderBottomColor:f.theme.colors.border},ratingContainer:{flexDirection:"row",alignItems:"center",marginBottom:f.theme.spacing.small},ratingText:{fontSize:f.theme.fontSizes.medium,color:f.theme.colors.text,fontWeight:"500",marginLeft:4},dot:{fontSize:f.theme.fontSizes.medium,color:f.theme.colors.textSecondary},reviews:{fontSize:f.theme.fontSizes.medium,color:f.theme.colors.textSecondary},repeatOwners:{fontSize:f.theme.fontSizes.medium,color:f.theme.colors.textSecondary},bestReviewContainer:{flexDirection:"row",alignItems:"center"},reviewerImage:{width:32,height:32,borderRadius:16,marginRight:f.theme.spacing.small},bestReviewTextContainer:{flex:1},bestReview:{flex:1,fontSize:f.theme.fontSizes.medium,color:f.theme.colors.text,fontStyle:"italic"},readMore:{color:f.theme.colors.primary,fontStyle:"normal",fontWeight:"500"},header:{flexDirection:"row",justifyContent:"space-between",alignItems:"flex-start",paddingHorizontal:f.theme.spacing.medium,paddingTop:f.theme.spacing.medium,backgroundColor:f.theme.colors.surfaceContrast},mobileHeaderRight:{flexDirection:"row",alignItems:"center"},headerContent:{flex:1,marginRight:f.theme.spacing.medium},headerTitle:{fontSize:f.theme.fontSizes.large,fontWeight:"600",color:f.theme.colors.text,marginBottom:f.theme.spacing.small},filterChips:{flexDirection:"row",flexWrap:"wrap",gap:f.theme.spacing.small},filterChip:{backgroundColor:f.theme.colors.background,paddingHorizontal:f.theme.spacing.medium,paddingVertical:f.theme.spacing.small,borderRadius:16,borderWidth:1,borderColor:f.theme.colors.border},filterChipText:{fontSize:f.theme.fontSizes.small,color:f.theme.colors.text},filterButton:{padding:f.theme.spacing.small,borderRadius:8},headerButtons:{flexDirection:"row",gap:f.theme.spacing.small}}),Sr=({professionals:e,onLoadMore:t,onProfessionalSelect:o,isMobile:a,filters:n,onFilterPress:l})=>(0,T.jsxs)(r.default,{style:vr.container,children:[(0,T.jsxs)(r.default,{style:[vr.header,{borderBottomWidth:1,borderBottomColor:f.theme.colors.border,paddingBottom:f.theme.spacing.medium}],children:[(0,T.jsxs)(r.default,{style:vr.headerContent,children:[(0,T.jsx)(i.default,{style:vr.headerTitle,children:"Pet Care Professionals"}),(0,T.jsx)(r.default,{style:vr.filterChips,children:n?.categories?.map(((e,t)=>(0,T.jsx)(r.default,{style:vr.filterChip,children:(0,T.jsx)(i.default,{style:vr.filterChipText,children:e})},t)))})]}),(0,T.jsxs)(r.default,{style:vr.headerButtons,children:[(0,T.jsx)(s.default,{style:vr.filterButton,onPress:l,children:(0,T.jsx)(S.default,{name:"filter",size:24,color:f.theme.colors.text})}),a&&(0,T.jsx)(s.default,{style:vr.filterButton,onPress:()=>{l&&l("map")},children:(0,T.jsx)(S.default,{name:"map",size:24,color:f.theme.colors.text})})]})]}),(0,T.jsx)(Rt.default,{data:e,renderItem:({item:e,index:t})=>(0,T.jsx)(Cr,{professional:e,index:t,onPress:()=>o(e)}),keyExtractor:e=>e.id.toString(),onEndReached:t,onEndReachedThreshold:.5,contentContainerStyle:vr.listContent})]});var Tr=o(12391),Br=o(72321),kr=o(74400),_r=o(12906),Ar=(o(1297),o(14918)),Ir=o.n(Ar);delete Ir().Icon.Default.prototype._getIconUrl,Ir().Icon.Default.mergeOptions({iconRetinaUrl:o(18249),iconUrl:o(37024),shadowUrl:o(91071)});const Dr=({professionals:e,onMarkerPress:t,region:o,isMobile:a})=>{const n=Ir().divIcon({className:"custom-marker",html:'<div style="\n      width: 32px;\n      height: 32px;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n    ">\n      <svg viewBox="0 0 24 24" width="32" height="32">\n        <path fill="'.concat(f.theme.colors.primary,'" d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>\n      </svg>\n    </div>'),iconSize:[32,32],iconAnchor:[16,32],popupAnchor:[0,-32]});return(0,T.jsx)("div",{style:Rr.mapContainer,children:(0,T.jsxs)(Tr.MapContainer,{center:[o.latitude,o.longitude],zoom:13,style:{height:"100%",width:"100%"},children:[(0,T.jsx)(Br.TileLayer,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'\xa9 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}),e.map(((e,o)=>(0,T.jsx)(kr.Marker,{position:[e.coordinates.latitude,e.coordinates.longitude],icon:n,eventHandlers:{click:()=>t(e)},children:(0,T.jsx)(_r.Popup,{children:(0,T.jsxs)("div",{style:Rr.popupContent,children:[(0,T.jsx)("h3",{style:{margin:"0 0 8px 0",fontSize:"16px",fontWeight:"600",fontFamily:f.theme.fonts.header.fontFamily},children:e.name}),(0,T.jsx)("p",{style:{margin:"0 0 4px 0",fontSize:"14px",color:f.theme.colors.textSecondary},children:e.location}),(0,T.jsxs)("p",{style:{margin:"0",fontSize:"14px",fontWeight:"500",color:f.theme.colors.primary},children:["from $",e.startingRate,"/night"]})]})})},e.id)))]})})},Mr=({professionals:e,onMarkerPress:t,region:o,isMobile:a})=>(0,T.jsx)(r.default,{style:Rr.mapContainer}),Rr=l.default.create({mapContainer:{flex:1,backgroundColor:f.theme.colors.background,height:"100%",width:"100%",overflow:"hidden"},map:{flex:1,height:"100%",width:"100%"},markerContainer:{backgroundColor:f.theme.colors.primary,borderRadius:20,padding:f.theme.spacing.small,borderWidth:2,borderColor:"white"},markerText:{color:f.theme.colors.whiteText,fontWeight:"bold"},calloutContainer:{backgroundColor:f.theme.colors.surface,padding:f.theme.spacing.small,borderRadius:8,borderWidth:1,borderColor:f.theme.colors.border},calloutText:{color:f.theme.colors.text,fontSize:f.theme.fontSizes.small},popupContent:{padding:12,minWidth:200}}),Pr=({professionals:e,onMarkerPress:t,region:o,isMobile:a})=>"web"===n.default.OS?(0,T.jsx)(Dr,{professionals:e,onMarkerPress:t,region:o,isMobile:a}):(0,T.jsx)(Mr,{professionals:e,onMarkerPress:t,region:o,isMobile:a});var zr=o(49377);const Fr=({navigation:e,route:t})=>{const{width:o}=(0,ve.default)(),{screenWidth:n,isCollapsed:i,is_DEBUG:d}=(0,a.useContext)(p.AuthContext),[c,u]=(0,a.useState)(n<=1050),[m,g]=(0,a.useState)(n<=900),[h,y]=(0,a.useState)(c?"filters":"all"),[b,x]=(0,a.useState)(ce),[j,w]=(0,a.useState)({}),[C,v]=(0,a.useState)(!1),[S,B]=(0,a.useState)(!1),[k,_]=(0,a.useState)(!0),[A,I]=(0,a.useState)({latitude:38.8339,longitude:-104.8214,latitudeDelta:.0922,longitudeDelta:.0421}),[D,M]=(0,a.useState)({categories:["Dogs","Within 5 miles"]});(0,a.useEffect)((()=>{u(n<=1050),g(n<=900),y(n<=1050?"filters":"all")}),[n]),(0,a.useEffect)((()=>e.addListener("focus",(()=>{c&&y("filters")}))),[e,c]);const R=e=>{w(e)},P=()=>{},z=t=>{e.navigate("ProfessionalProfile",{professional:t})},F=()=>{v(!C)},L=e=>{_(!1),c&&y("map"===e?"map":"list")},O=()=>{B(!S),S||v(!0)},E=((e,t)=>l.default.create({mainContainer:{flex:1,backgroundColor:f.theme.colors.background,position:"fixed",top:0,left:0,right:0,bottom:0,marginLeft:e>900?t?70:250:0,transition:"margin-left 0.3s ease"},container:{flex:1,display:"flex",flexDirection:"column",height:"100vh",overflow:"hidden"},content:{flex:1,flexDirection:"row",height:m?"100%":"calc(100vh - 64px)",overflow:"hidden"},leftColumn:{height:"100%",borderRightWidth:1,borderRightColor:f.theme.colors.border,backgroundColor:f.theme.colors.background,transition:"width 0.3s ease",position:"relative",zIndex:1},leftColumnToggle:{position:"absolute",top:"50%",right:-16,transform:[{translateY:-20}],zIndex:2e3,backgroundColor:f.theme.colors.surface,padding:f.theme.spacing.small,borderRadius:20,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:3,elevation:3,width:32,height:32,alignItems:"center",justifyContent:"center",borderWidth:1,borderColor:f.theme.colors.border},mapColumn:{flex:1,backgroundColor:f.theme.colors.background,height:"100%",transition:"width 0.3s ease",position:"relative",zIndex:0},toggleButton:{position:"absolute",top:f.theme.spacing.medium,right:f.theme.spacing.medium,zIndex:1e3,backgroundColor:f.theme.colors.surface,padding:f.theme.spacing.small,borderRadius:8,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:3,elevation:3},toggleButtonText:{color:f.theme.colors.primary,fontSize:f.theme.fontSizes.medium,fontFamily:f.theme.fonts.regular.fontFamily,fontWeight:"500"},containerMobile:{flex:1,backgroundColor:f.theme.colors.background,height:"100%",overflow:"hidden"},mobileHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",borderBottomWidth:2,padding:10,marginHorizontal:10,backgroundColor:f.theme.colors.background},mobileHeaderText:{fontSize:f.theme.fontSizes.large,fontWeight:"500",fontFamily:f.theme.fonts.header.fontFamily},headerIcon:{padding:8,marginLeft:16},searchButton:{backgroundColor:f.theme.colors.primary,padding:10,alignItems:"center",borderRadius:5,margin:10},searchButtonText:{color:f.theme.colors.whiteText,fontSize:f.theme.fontSizes.medium+2,fontFamily:f.theme.fonts.regular.fontFamily},mapToggleButton:{position:"absolute",top:f.theme.spacing.medium,right:f.theme.spacing.medium,zIndex:1e3,backgroundColor:f.theme.colors.surface,padding:f.theme.spacing.small,borderRadius:8,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:3,elevation:3}}))(n,i);return(0,T.jsx)(r.default,{style:E.mainContainer,children:(0,T.jsxs)(Se.default,{style:E.container,children:[c&&(0,T.jsx)(bt,{title:"Search Results",onBackPress:()=>e.goBack()}),(0,T.jsx)(r.default,{style:E.content,children:(()=>{if(!c){const e=S?"50%":"33.333%",t=C?"50%":"66.666%";return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)(r.default,{style:[E.leftColumn,{width:e}],children:[(0,T.jsx)(s.default,{style:[E.toggleButton,E.leftColumnToggle],onPress:O,children:(0,T.jsx)(zr.default,{name:S?"chevron-left":"chevron-right",size:24,color:f.theme.colors.primary})}),k?(0,T.jsx)(wr,{onFiltersChange:R,onShowProfessionals:L}):(0,T.jsx)(Sr,{professionals:b,onLoadMore:P,onProfessionalSelect:z,isMobile:m,filters:D,onFilterPress:e=>{y("map"===e?"map":"filters")}})]}),(0,T.jsxs)(r.default,{style:[E.mapColumn,{width:t}],children:[(0,T.jsx)(s.default,{style:[E.toggleButton,E.mapToggleButton],onPress:F,children:(0,T.jsx)(zr.default,{name:C?"arrow-expand":"arrow-collapse",size:24,color:f.theme.colors.primary})}),(0,T.jsx)(Pr,{professionals:b,onMarkerPress:z,region:A,isMobile:m})]})]})}return(0,T.jsxs)(r.default,{style:E.containerMobile,children:["filters"===h&&(0,T.jsx)(T.Fragment,{children:(0,T.jsx)(wr,{onFiltersChange:R,onShowProfessionals:L,isMobile:c})}),"list"===h&&(0,T.jsx)(T.Fragment,{children:(0,T.jsx)(Sr,{professionals:b,onLoadMore:P,onProfessionalSelect:z,isMobile:c,filters:D,onFilterPress:e=>{y("map"===e?"map":"filters")}})}),"map"===h&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(r.default,{style:E.mobileHeader,children:(0,T.jsx)(s.default,{onPress:()=>y("list"),children:(0,T.jsx)(zr.default,{name:"arrow-left",size:24,color:f.theme.colors.primary})})}),(0,T.jsx)(Pr,{professionals:b,onMarkerPress:z,region:A,isMobile:c})]})]})})()})]})})},Lr=l.default.create({container:{flex:1,height:"100vh",backgroundColor:f.theme.colors.surface,position:"fixed",top:0,right:0,bottom:0,left:0,overflow:"hidden",transition:"margin-left 0.3s ease"},content:{flex:1,height:"100%",overflow:"auto"},mainContent:{flex:1,width:"100%",alignSelf:"center",backgroundColor:f.theme.colors.background},headerSection:{width:"100%",backgroundColor:f.theme.colors.surfaceContrast,paddingHorizontal:24,paddingTop:24,zIndex:2},bookingsContent:{flex:1,backgroundColor:f.theme.colors.surface,position:"relative"},title:{fontSize:32,fontWeight:"600",color:f.theme.colors.text,marginBottom:24,fontFamily:f.theme.fonts.header.fontFamily},tabContainer:{flexDirection:"row",gap:32},tab:{paddingBottom:8,borderBottomWidth:2,borderBottomColor:"transparent"},activeTab:{borderBottomColor:f.theme.colors.primary},tabText:{fontSize:16,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily},activeTabText:{color:f.theme.colors.primary,fontWeight:"500"},stickyHeader:{position:"absolute",top:0,left:0,right:0,backgroundColor:f.theme.colors.surfaceContrast,zIndex:2,marginHorizontal:24,marginTop:24,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,borderRadius:8,padding:16},stickyHeaderContent:{width:"100%",gap:16},searchContainer:{flexDirection:"row",alignItems:"center",backgroundColor:f.theme.colors.surfaceContrast,borderRadius:8,padding:12,borderWidth:1,borderColor:"#CCCBC9"},filterScrollContent:{flexGrow:0},filtersWrapper:{flexDirection:"row",justifyContent:"flex-end",marginRight:-16},filterContainer:{flexDirection:"row",gap:8,backgroundColor:f.theme.colors.surfaceContrast,paddingVertical:8,paddingLeft:4,paddingRight:16},filterButton:Object.assign({paddingHorizontal:12,paddingVertical:6,borderRadius:16,justifyContent:"center"},"web"===n.default.OS&&{transition:"all 0.2s ease-in-out",cursor:"pointer"}),filterButtonHovered:{transform:[{scale:1.05}],shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:5},filterContent:{flexDirection:"row",alignItems:"center",justifyContent:"center",gap:6},checkmark:{marginLeft:4},allButton:{backgroundColor:"#EFF9FF"},allButtonText:{color:"#0784C6"},pendingButton:{backgroundColor:f.theme.colors.mybookings.main},pendingButtonText:{color:f.theme.colors.mybookings.secondary},confirmedButton:{backgroundColor:"#E8E9E2"},confirmedButtonText:{color:"#898974"},completedButton:{backgroundColor:"#F5F5F4"},completedButtonText:{color:f.theme.colors.mybookings.completedText},filterText:{fontSize:14,fontFamily:f.theme.fonts.regular.fontFamily,textAlign:"center"},listHeaderSpacing:{paddingTop:16},listContainer:{paddingHorizontal:24,paddingBottom:34},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center"},loadingMoreContainer:{paddingVertical:16,alignItems:"center"},emptyStateContainer:{flex:1,justifyContent:"center",alignItems:"center",paddingHorizontal:24},emptyStateTitle:{fontSize:f.theme.fontSizes.large,fontWeight:"600",color:f.theme.colors.text,marginTop:16,textAlign:"center",fontFamily:f.theme.fonts.header.fontFamily},emptyStateSubtitle:{fontSize:16,color:f.theme.colors.placeholder,textAlign:"center",marginTop:8,marginBottom:24,fontFamily:f.theme.fonts.regular.fontFamily},createServiceButton:{backgroundColor:f.theme.colors.primary,paddingHorizontal:24,paddingVertical:12,borderRadius:8,marginTop:8},createServiceButtonText:{color:f.theme.colors.surface,fontSize:16,fontWeight:"600",fontFamily:f.theme.fonts.regular.fontFamily},retryButton:{backgroundColor:f.theme.colors.error,paddingHorizontal:24,paddingVertical:12,borderRadius:8,marginTop:8},retryButtonText:{color:f.theme.colors.surface,fontSize:16,fontWeight:"600",fontFamily:f.theme.fonts.regular.fontFamily},searchInput:{outlineStyle:"none",outlineWidth:0,outline:"none",marginLeft:8}}),Or=()=>{const e=(0,j.useNavigation)(),{isApprovedProfessional:t,userRole:o,is_DEBUG:l,isCollapsed:d,screenWidth:c}=(0,a.useContext)(p.AuthContext),[u,m]=(0,a.useState)(c<900),[g,y]=(0,a.useState)(c>=1200),[C,B]=(0,a.useState)("professional"===o?"professional":"owner"),[k,_]=(0,a.useState)(""),[I,D]=(0,a.useState)([]),[M,R]=(0,a.useState)(!0),[P,z]=(0,a.useState)(null),[F,L]=(0,a.useState)(1),[O,E]=(0,a.useState)(!0),[W,N]=(0,a.useState)(!1),[U,V]=(0,a.useState)("all"),[Y,G]=(0,a.useState)(null);(0,a.useEffect)((()=>{const e=v.default.addEventListener("change",(()=>{m(v.default.get("window").width<900),y(v.default.get("window").width>=1200)}));return()=>{e?.remove()}}),[]),(0,a.useEffect)((()=>{"professional"===o&&t&&B("professional")}),[o,t]);const J=async(e=1,a=!1)=>{a?N(!0):(R(!0),z(null));try{let r="web"===n.default.OS?sessionStorage.getItem("userToken"):await x.default.getItem("userToken");if(!r)throw new Error("No authentication token found");l&&console.log("MBA1234 Fetching bookings:",{isApprovedProfessional:t,userRole:o,activeTab:C,page:e,status:U});const i=await w.default.get("".concat(b.API_BASE_URL,"/api/bookings/v1/"),{headers:{Authorization:"Bearer ".concat(r)},params:{page:e,page_size:20,status:U}}),s="professional"===C?i.data.bookings.professional_bookings||[]:i.data.bookings.owner_bookings||[];D(a?e=>[...e,...s]:s),E(20===s.length),L(e)}catch(P){console.error("Error fetching bookings:",P),z("Failed to fetch bookings")}finally{R(!1),N(!1)}};(0,a.useEffect)((()=>{l&&console.log("MBA1234 Fetching bookings due to dependency change:",{activeTab:C,userRole:o,isApprovedProfessional:t,activeFilter:U}),L(1),D([]),J(1)}),[C,o,t,U]);return(0,T.jsx)(r.default,{style:[Lr.container,{marginLeft:u?0:d?70:250}],children:(0,T.jsx)(r.default,{style:[Lr.content,{marginTop:u?60:0}],children:(0,T.jsxs)(r.default,{style:Lr.mainContent,children:[(0,T.jsxs)(r.default,{style:Lr.headerSection,children:[(0,T.jsx)(i.default,{style:Lr.title,children:"My Bookings"}),t&&(0,T.jsxs)(r.default,{style:Lr.tabContainer,children:[(0,T.jsx)(s.default,{style:[Lr.tab,"professional"===C&&Lr.activeTab],onPress:()=>B("professional"),children:(0,T.jsx)(i.default,{style:[Lr.tabText,"professional"===C&&Lr.activeTabText],children:"Your Bookings"})}),(0,T.jsx)(s.default,{style:[Lr.tab,"owner"===C&&Lr.activeTab],onPress:()=>B("owner"),children:(0,T.jsx)(i.default,{style:[Lr.tabText,"owner"===C&&Lr.activeTabText],children:"Owner Bookings"})})]})]}),(0,T.jsx)(r.default,{style:Lr.bookingsContent,children:M?(0,T.jsx)(r.default,{style:Lr.loadingContainer,children:(0,T.jsx)(A.default,{size:"large",color:f.theme.colors.primary})}):I.length>0?(0,T.jsxs)(r.default,{style:Lr.bookingsContent,children:[(0,T.jsx)(r.default,{style:Lr.stickyHeader,children:(0,T.jsxs)(r.default,{style:[Lr.stickyHeaderContent,{flexDirection:g?"row":"column"}],children:[(0,T.jsxs)(r.default,{style:[Lr.searchContainer,g?{flex:.4,marginRight:"auto"}:null],children:[(0,T.jsx)(S.default,{name:"magnify",size:24,color:f.theme.colors.mybookings.searchBar}),(0,T.jsx)(q.default,{style:[Lr.searchInput,{color:f.theme.colors.mybookings.searchBar,width:"100%",height:"100%"}],placeholder:"Search by pet name, owner, or date",value:k,onChangeText:e=>{if(_(e),!e.trim())return L(1),D([]),void J(1);const t=e.toLowerCase(),o=I.filter((e=>"professional"===C?e.id.toLowerCase().includes(t)||e.ownerName.toLowerCase().includes(t):e.id.toLowerCase().includes(t)||e.professionalName.toLowerCase().includes(t)));D(o)},outlineStyle:"none"})]}),(0,T.jsx)(r.default,{style:[Lr.filtersWrapper,g?{flex:.6,alignItems:"flex-end"}:null],children:(0,T.jsx)(H.default,{horizontal:!0,showsHorizontalScrollIndicator:!1,contentContainerStyle:Lr.filterScrollContent,children:(0,T.jsxs)(r.default,{style:Lr.filterContainer,children:[(0,T.jsx)(s.default,{style:[Lr.filterButton,Lr.allButton,"web"===n.default.OS&&"all"===Y&&Lr.filterButtonHovered],onPress:()=>V("all"),onMouseEnter:()=>"web"===n.default.OS&&G("all"),onMouseLeave:()=>"web"===n.default.OS&&G(null),children:(0,T.jsxs)(r.default,{style:Lr.filterContent,children:[(0,T.jsx)(S.default,{name:"filter-variant",size:16,color:"#0784C6"}),(0,T.jsx)(i.default,{style:[Lr.filterText,Lr.allButtonText],children:"All"}),"all"===U&&(0,T.jsx)(S.default,{name:"check",size:16,color:"#0784C6",style:Lr.checkmark})]})}),(0,T.jsx)(s.default,{style:[Lr.filterButton,Lr.pendingButton,"web"===n.default.OS&&"pending"===Y&&Lr.filterButtonHovered],onPress:()=>V("pending"),onMouseEnter:()=>"web"===n.default.OS&&G("pending"),onMouseLeave:()=>"web"===n.default.OS&&G(null),children:(0,T.jsxs)(r.default,{style:Lr.filterContent,children:[(0,T.jsx)(S.default,{name:"clock-outline",size:16,color:f.theme.colors.mybookings.secondary}),(0,T.jsx)(i.default,{style:[Lr.filterText,Lr.pendingButtonText],children:"Pending"}),"pending"===U&&(0,T.jsx)(S.default,{name:"check",size:16,color:f.theme.colors.mybookings.secondary,style:Lr.checkmark})]})}),(0,T.jsx)(s.default,{style:[Lr.filterButton,Lr.confirmedButton,"web"===n.default.OS&&"confirmed"===Y&&Lr.filterButtonHovered],onPress:()=>V("confirmed"),onMouseEnter:()=>"web"===n.default.OS&&G("confirmed"),onMouseLeave:()=>"web"===n.default.OS&&G(null),children:(0,T.jsxs)(r.default,{style:Lr.filterContent,children:[(0,T.jsx)(S.default,{name:"check-circle-outline",size:16,color:"#898974"}),(0,T.jsx)(i.default,{style:[Lr.filterText,Lr.confirmedButtonText],children:"Confirmed"}),"confirmed"===U&&(0,T.jsx)(S.default,{name:"check",size:16,color:"#898974",style:Lr.checkmark})]})}),(0,T.jsx)(s.default,{style:[Lr.filterButton,Lr.completedButton,"web"===n.default.OS&&"completed"===Y&&Lr.filterButtonHovered],onPress:()=>V("completed"),onMouseEnter:()=>"web"===n.default.OS&&G("completed"),onMouseLeave:()=>"web"===n.default.OS&&G(null),children:(0,T.jsxs)(r.default,{style:Lr.filterContent,children:[(0,T.jsx)(S.default,{name:"flag-checkered",size:16,color:f.theme.colors.mybookings.completedText}),(0,T.jsx)(i.default,{style:[Lr.filterText,Lr.completedButtonText],children:"Completed"}),"completed"===U&&(0,T.jsx)(S.default,{name:"check",size:16,color:f.theme.colors.mybookings.completedText,style:Lr.checkmark})]})})]})})})]})}),(0,T.jsx)(Rt.default,{data:I,renderItem:({item:t})=>(0,T.jsx)(so,{booking:{id:t.booking_id||t.id,ownerName:t.owner_name||t.ownerName,professionalName:t.professional_name||t.professionalName,serviceName:t.service_type||t.serviceName,date:t.start_date||t.date,time:t.start_time||t.time,status:t.status},type:C,onViewDetails:()=>(async t=>{l&&console.log("MBA1234 Navigating to booking details:",{bookingId:t.booking_id||t.id,isProfessional:"professional"===C}),await(0,h.navigateToFrom)(e,"BookingDetails","MyBookings",{bookingId:t.booking_id||t.id,isProfessional:"professional"===C})})(t),onCancel:()=>(async e=>{l&&console.log("MBA1234 Cancel booking:",e)})(t.booking_id||t.id)}),keyExtractor:e=>(e.booking_id||e.id||Math.random().toString()).toString(),contentContainerStyle:Lr.listContainer,onEndReached:()=>{!W&&O&&J(F+1,!0)},onEndReachedThreshold:.5,ListFooterComponent:()=>W?(0,T.jsx)(r.default,{style:Lr.loadingMoreContainer,children:(0,T.jsx)(A.default,{size:"small",color:f.theme.colors.primary})}):null,ListHeaderComponent:(0,T.jsx)(r.default,{style:[Lr.listHeaderSpacing,{height:g?130:190}]})})]}):(0,T.jsx)((()=>(0,T.jsxs)(r.default,{style:Lr.emptyStateContainer,children:[(0,T.jsx)(S.default,{name:P?"alert-circle-outline":"calendar-blank-outline",size:64,color:P?f.theme.colors.error:f.theme.colors.primary}),(0,T.jsx)(i.default,{style:Lr.emptyStateTitle,children:P?"Error Getting Bookings":"No Bookings Found"}),(0,T.jsx)(i.default,{style:Lr.emptyStateSubtitle,children:P?"There was an error fetching your bookings. Please try again later.":"professional"===C?t?"Create a service to start receiving bookings":"Apply to become a professional to start receiving bookings":"Browse available services to make your first booking"}),!P&&(0,T.jsx)(s.default,{style:Lr.createServiceButton,onPress:()=>e.navigate("professional"===C?t?"ServiceManager":"BecomeProfessional":"SearchProfessionalsListing"),children:(0,T.jsx)(i.default,{style:Lr.createServiceButtonText,children:"professional"===C?t?"Create Service":"Become Professional":"Browse Services"})}),P&&(0,T.jsx)(s.default,{style:Lr.retryButton,onPress:()=>J(1),children:(0,T.jsx)(i.default,{style:Lr.retryButtonText,children:"Retry"})})]})),{})})]})})})},Er=l.default.create({modalOverlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center"},modalContent:{backgroundColor:f.theme.colors.surface,borderRadius:8,padding:20,width:"90%",maxWidth:500},modalHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:20},modalTitle:{fontSize:f.theme.fontSizes.large,fontWeight:"bold",color:f.theme.colors.text},closeButton:{padding:5},inputContainer:{marginBottom:15},label:{marginBottom:5,color:f.theme.colors.text},input:{borderWidth:1,borderColor:f.theme.colors.border,borderRadius:4,padding:10,backgroundColor:f.theme.colors.surface},descriptionInput:{height:100,textAlignVertical:"top"},addButton:{backgroundColor:f.theme.colors.primary,padding:12,borderRadius:4,alignItems:"center",marginTop:10},addButtonText:{color:f.theme.colors.surface,fontWeight:"bold"},disabledButton:{opacity:.5}}),Wr=({visible:e,onClose:t,onAdd:o})=>{const[n,l]=(0,a.useState)(""),[d,c]=(0,a.useState)(""),[u,m]=(0,a.useState)("");return(0,T.jsx)(_.default,{visible:e,transparent:!0,animationType:"fade",onRequestClose:t,children:(0,T.jsx)(r.default,{style:Er.modalOverlay,children:(0,T.jsxs)(r.default,{style:Er.modalContent,children:[(0,T.jsxs)(r.default,{style:Er.modalHeader,children:[(0,T.jsx)(i.default,{style:Er.modalTitle,children:"Add New Rate"}),(0,T.jsx)(s.default,{onPress:t,style:Er.closeButton,children:(0,T.jsx)(S.default,{name:"close",size:24,color:f.theme.colors.text})})]}),(0,T.jsxs)(r.default,{style:Er.inputContainer,children:[(0,T.jsx)(i.default,{style:Er.label,children:"Rate Name *"}),(0,T.jsx)(q.default,{style:Er.input,value:n,onChangeText:l,placeholder:"Enter rate name"})]}),(0,T.jsxs)(r.default,{style:Er.inputContainer,children:[(0,T.jsx)(i.default,{style:Er.label,children:"Amount *"}),(0,T.jsx)(q.default,{style:Er.input,value:d,onChangeText:c,keyboardType:"numeric",placeholder:"Enter amount"})]}),(0,T.jsxs)(r.default,{style:Er.inputContainer,children:[(0,T.jsx)(i.default,{style:Er.label,children:"Description (optional)"}),(0,T.jsx)(q.default,{style:[Er.input,Er.descriptionInput],value:u,onChangeText:m,placeholder:"Enter description",multiline:!0})]}),(0,T.jsx)(s.default,{style:[Er.addButton,(!n||!d)&&Er.disabledButton],onPress:()=>{n&&d&&(o({name:n,amount:parseFloat(d),description:u}),l(""),c(""),m(""),t())},disabled:!n||!d,children:(0,T.jsx)(i.default,{style:Er.addButtonText,children:"Add Rate"})})]})})})},Nr=l.default.create({overlay:{position:"web"===n.default.OS?"fixed":"absolute",top:0,left:0,right:0,justifyContent:"flex-end",alignItems:"center",paddingBottom:40,zIndex:9999,pointerEvents:"none"},container:{width:"90%",maxWidth:300,padding:16,borderRadius:8,elevation:6,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:3.84},message:{color:f.theme.colors.whiteText,fontSize:16,textAlign:"center",fontFamily:f.theme.fonts.regular.fontFamily}}),Hr=({visible:e,message:t,type:o="success"})=>{const[n]=a.useState(new C.default.Value(0)),s=v.default.get("window").height;return a.useEffect((()=>{let t,o,a;return e&&(t=C.default.timing(n,{toValue:1,duration:300,useNativeDriver:!0}),t.start(),a=setTimeout((()=>{o=C.default.timing(n,{toValue:0,duration:300,useNativeDriver:!0}),o.start()}),3e3)),()=>{t&&t.stop(),o&&o.stop(),a&&clearTimeout(a)}}),[e]),e?(0,T.jsx)(r.default,{style:[Nr.overlay,{height:s}],children:(0,T.jsx)(C.default.View,{style:[Nr.container,{backgroundColor:"error"===o?f.theme.colors.error:f.theme.colors.primary,opacity:n,transform:[{translateY:n.interpolate({inputRange:[0,1],outputRange:[50,0]})}]}],children:(0,T.jsx)(i.default,{style:Nr.message,children:t})})}):null},Ur=({visible:e,onClose:t,onSubmit:o,loading:n})=>{const[l,d]=(0,a.useState)("");return(0,T.jsx)(_.default,{visible:e,transparent:!0,animationType:"fade",children:(0,T.jsx)(r.default,{style:Vr.modalContainer,children:(0,T.jsxs)(r.default,{style:Vr.modalContent,children:[(0,T.jsx)(i.default,{style:Vr.modalTitle,children:"Request Changes"}),(0,T.jsx)(q.default,{style:Vr.reasonInput,placeholder:"Enter reason for changes...",value:l,onChangeText:d,multiline:!0,numberOfLines:4}),(0,T.jsxs)(r.default,{style:Vr.modalButtons,children:[(0,T.jsx)(s.default,{style:[Vr.modalButton,Vr.cancelButton],onPress:t,children:(0,T.jsx)(i.default,{style:Vr.cancelButtonText,children:"Cancel"})}),(0,T.jsx)(s.default,{style:[Vr.modalButton,Vr.submitButton],onPress:()=>o(l),disabled:n,children:n?(0,T.jsx)(A.default,{size:"small",color:"#fff"}):(0,T.jsx)(i.default,{style:Vr.submitButtonText,children:"Submit"})})]})]})})})},Vr=l.default.create({container:{flex:1,padding:16},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center"},statusBadge:{alignSelf:"flex-start",paddingHorizontal:12,paddingVertical:6,borderRadius:16},statusText:{fontSize:14,fontWeight:"500",fontFamily:f.theme.fonts.regular.fontFamily},section:{marginBottom:24,backgroundColor:f.theme.colors.surface,padding:16,borderRadius:8,borderWidth:1,borderColor:f.theme.colors.border,position:"relative"},sectionTitle:{fontSize:18,fontWeight:"bold",color:f.theme.colors.primary,marginBottom:12,fontFamily:f.theme.fonts.header.fontFamily},label:{fontSize:f.theme.fontSizes.mediumLarge,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily,alignSelf:"center",fontWeight:"500"},value:{fontSize:f.theme.fontSizes.mediumLarge,color:f.theme.colors.text,fontWeight:"500",fontFamily:f.theme.fonts.regular.fontFamily,alignSelf:"center"},text:{fontSize:16,marginBottom:8,fontFamily:f.theme.fonts.regular.fontFamily},costRow:{flexDirection:"row",justifyContent:"space-between",marginBottom:8},totalRow:{borderTopWidth:1,borderTopColor:f.theme.colors.border,paddingTop:8,marginTop:8},totalLabel:{fontSize:16,fontWeight:"500",fontFamily:f.theme.fonts.regular.fontFamily},totalAmount:{fontSize:16,fontWeight:"500",fontFamily:f.theme.fonts.regular.fontFamily},payoutRow:{marginTop:12,paddingTop:12,borderTopWidth:1,borderTopColor:f.theme.colors.border},payoutLabel:{fontSize:16,fontWeight:"500",color:f.theme.colors.success,fontFamily:f.theme.fonts.regular.fontFamily},payoutAmount:{fontSize:16,fontWeight:"600",color:f.theme.colors.success,fontFamily:f.theme.fonts.regular.fontFamily},policyText:{fontSize:14,lineHeight:20,fontFamily:f.theme.fonts.regular.fontFamily},button:{flex:1,padding:16,borderRadius:8,alignItems:"center",justifyContent:"center"},buttonText:{color:f.theme.colors.surface,fontSize:f.theme.fontSizes.mediumLarge,fontWeight:"500",fontFamily:f.theme.fonts.regular.fontFamily},denybuttonText:{color:f.theme.colors.error,fontSize:f.theme.fontSizes.mediumLarge,fontWeight:"500",fontFamily:f.theme.fonts.regular.fontFamily},primaryButton:{backgroundColor:f.theme.colors.mainColors.main},denyButton:{backgroundColor:f.theme.colors.surface,borderWidth:1,borderColor:f.theme.colors.error,textColor:f.theme.colors.error},approveButton:{backgroundColor:f.theme.colors.mainColors.tertiary},cancelButton:{backgroundColor:f.theme.colors.error,borderWidth:1,borderColor:f.theme.colors.error,padding:8,borderRadius:8,fontFamily:f.theme.fonts.regular.fontFamily},cancelButtonText:{color:f.theme.colors.error,borderWidth:1,borderColor:f.theme.colors.error,padding:8,borderRadius:8,fontFamily:f.theme.fonts.regular.fontFamily},errorContainer:{flex:1,justifyContent:"center",alignItems:"center"},errorText:{fontSize:f.theme.fontSizes.largeLarge,color:f.theme.colors.error,fontFamily:f.theme.fonts.regular.fontFamily},statusContainer:{flexDirection:"row",alignItems:"center",marginBottom:16},statusLabel:{fontSize:16,marginRight:8,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily},modalTitle:{fontSize:18,fontWeight:"bold",marginBottom:16,fontFamily:f.theme.fonts.header.fontFamily},dateText:{fontSize:16,fontWeight:"500",marginBottom:4,fontFamily:f.theme.fonts.regular.fontFamily},timeText:{fontSize:14,color:f.theme.colors.placeholder,fontFamily:f.theme.fonts.regular.fontFamily},addOccurrenceText:{marginLeft:8,color:f.theme.colors.primary,fontSize:16,fontFamily:f.theme.fonts.regular.fontFamily},occurrenceCost:{fontSize:16,fontWeight:"500",fontFamily:f.theme.fonts.regular.fontFamily},petName:{fontSize:16,fontWeight:"500",marginBottom:4,fontFamily:f.theme.fonts.regular.fontFamily},noContentText:{fontSize:14,color:f.theme.colors.placeholder,fontFamily:f.theme.fonts.regular.fontFamily},saveButtonText:{color:"white",fontWeight:"600",fontFamily:f.theme.fonts.regular.fontFamily},editButton:{},editField:{padding:16,borderWidth:1,borderColor:f.theme.colors.border,borderRadius:8,alignItems:"center"},editableServiceRow:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:8},removeServiceButton:{marginLeft:8},editRow:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:12,position:"relative"},editInput:{borderWidth:1,borderColor:f.theme.colors.border,borderRadius:4,padding:8,width:80,textAlign:"right"},addRateButton:{flexDirection:"row",alignItems:"center",padding:12,marginTop:8},addRateText:{marginLeft:8,color:f.theme.colors.primary,fontSize:16},dropdownContainer:{position:"relative",width:150},dropdownInput:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",borderWidth:1,borderColor:f.theme.colors.border,borderRadius:4,padding:4,backgroundColor:f.theme.colors.surface},timeDropdownList:{position:"absolute",top:"100%",left:0,right:0,backgroundColor:"#FFFFFF",borderWidth:1,borderColor:f.theme.colors.border,borderRadius:4,maxHeight:200,zIndex:1001,elevation:5,marginTop:4},dropdownItem:{padding:12,borderBottomWidth:1,borderBottomColor:f.theme.colors.border,backgroundColor:"#FFFFFF"},dropdownText:{color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily},selectedOption:{color:f.theme.colors.primary,fontWeight:"bold",fontFamily:f.theme.fonts.regular.fontFamily},bookingDatesSection:{marginTop:20,marginBottom:20},sectionSubtitle:{fontSize:16,fontWeight:"500",marginBottom:10,fontFamily:f.theme.fonts.regular.fontFamily},dateTimeRow:{flexDirection:"row",justifyContent:"space-between",marginBottom:15},datePickerContainer:{flex:1,marginRight:10},timePickerContainer:{width:120},timePickerButton:{borderWidth:1,borderColor:f.theme.colors.border,borderRadius:4,padding:8,backgroundColor:f.theme.colors.surface},dropdownList:{position:"absolute",left:0,right:0,top:"100%",backgroundColor:f.theme.colors.surface,borderWidth:1,borderColor:f.theme.colors.border,borderRadius:4,elevation:5,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:3.84},rateSection:{marginBottom:20,padding:12,borderWidth:1,borderColor:f.theme.colors.border,borderRadius:8,backgroundColor:f.theme.colors.surface},rateSectionTitle:{fontSize:16,fontWeight:"600",marginBottom:12,color:f.theme.colors.primary,fontFamily:f.theme.fonts.header.fontFamily},rateInputRow:{flexDirection:"row",justifyContent:"space-between",gap:8},rateInputGroup:{flex:1},inputLabel:{fontSize:f.theme.fontSizes.largeLarge,color:f.theme.colors.text,flex:1,fontFamily:f.theme.fonts.regular.fontFamily},rateInput:{borderWidth:1,borderColor:f.theme.colors.border,borderRadius:4,padding:8,fontSize:14},additionalRateRow:{flexDirection:"row",alignItems:"center",gap:8,marginBottom:8,borderBottomWidth:1,borderBottomColor:f.theme.colors.border,paddingBottom:8},removeButton:{padding:4},summarySection:{marginTop:20,paddingTop:20,borderTopWidth:1,borderTopColor:f.theme.colors.border},summaryRow:{flexDirection:"row",justifyContent:"space-between",marginBottom:8},rateHeaderRow:{flexDirection:"row",justifyContent:"space-between",marginBottom:8,paddingHorizontal:4},columnHeader:{fontSize:12,color:f.theme.colors.placeholder,fontWeight:"500",fontFamily:f.theme.fonts.regular.fontFamily},rateAmountColumn:{alignItems:"flex-start"},rateActionButtons:{flexDirection:"row",alignItems:"center",width:72,gap:8},infoButton:{padding:4},actionButtonsContainer:{padding:16,backgroundColor:f.theme.colors.surface,borderTopWidth:1,borderTopColor:f.theme.colors.border,flexDirection:"row",justifyContent:"space-between",gap:12},modalContainer:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",padding:16},modalContent:{backgroundColor:f.theme.colors.surface,borderRadius:8,padding:16},reasonInput:{borderWidth:1,borderColor:f.theme.colors.border,borderRadius:8,padding:12,marginBottom:16,minHeight:100,textAlignVertical:"top"},modalButtons:{flexDirection:"row",justifyContent:"flex-end",gap:12},modalButton:{paddingVertical:8,paddingHorizontal:16,borderRadius:8},submitButton:{backgroundColor:f.theme.colors.primary},submitButtonText:{color:f.theme.colors.surface,fontWeight:"500"},serviceEditContainer:{gap:16},serviceInputRow:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16},inputLabel:{fontSize:f.theme.fontSizes.largeLarge,color:f.theme.colors.text,flex:1},inputContainer:{width:150},numberInput:{height:40,width:150,borderWidth:1,borderColor:f.theme.colors.border,borderRadius:8,paddingHorizontal:12,fontSize:16},serviceDetailsContainer:{gap:12},serviceDetailRow:{flexDirection:"row",alignItems:"center",marginBottom:8},value:{fontSize:f.theme.fontSizes.mediumLarge,color:f.theme.colors.text,fontWeight:"500",fontFamily:f.theme.fonts.regular.fontFamily,alignSelf:"center"},occurrenceActions:{flexDirection:"row",alignItems:"center",gap:12},actionButton:{padding:8},saveButton:{backgroundColor:f.theme.colors.primary,paddingHorizontal:16,paddingVertical:8,borderRadius:8,minWidth:140,justifyContent:"center",alignItems:"center"},saveButtonText:{color:f.theme.colors.surface,fontWeight:"600",fontSize:14,fontFamily:f.theme.fonts.regular.fontFamily},actionButtons:{width:72},additionalRateRow:{flexDirection:"row",alignItems:"center",gap:8,marginBottom:8,borderBottomWidth:1,borderBottomColor:f.theme.colors.border,paddingBottom:8},occurrenceCard:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",padding:12,borderWidth:1,borderColor:f.theme.colors.border,borderRadius:8,marginBottom:8},occurrenceDetails:{flex:1},dateText:{fontSize:16,fontWeight:"500",marginBottom:4,fontFamily:f.theme.fonts.regular.fontFamily},timeText:{fontSize:14,color:f.theme.colors.placeholder,fontFamily:f.theme.fonts.regular.fontFamily},editOccurrenceButton:{flexDirection:"row",alignItems:"center",marginLeft:20},editOccurrenceText:{color:f.theme.colors.primary,marginLeft:5},addOccurrenceButton:{flexDirection:"row",alignItems:"center",justifyContent:"center",padding:16,borderWidth:1,borderColor:f.theme.colors.primary,borderRadius:8,marginTop:12},addOccurrenceText:{marginLeft:8,color:f.theme.colors.primary,fontSize:16},occurrenceCostRow:{borderBottomWidth:1,borderBottomColor:f.theme.colors.border,paddingVertical:12},occurrenceCostHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"},occurrenceCostHeaderText:{fontSize:16,fontFamily:f.theme.fonts.regular.fontFamily},costAndIcon:{flexDirection:"row",alignItems:"center",gap:8},occurrenceCost:{fontSize:16,fontWeight:"500"},costSummary:{marginTop:20,paddingTop:20,borderTopWidth:1,borderTopColor:f.theme.colors.border},expandedCostDetails:{marginTop:10,paddingTop:10,borderTopWidth:1,borderTopColor:f.theme.colors.border},costDetailRow:{flexDirection:"row",justifyContent:"space-between",paddingVertical:4},costDetailText:{fontFamily:f.theme.fonts.regular.fontFamily},sectionHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:12},sectionEditButton:{padding:8},petItem:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingVertical:12,borderBottomWidth:1,borderBottomColor:f.theme.colors.border},petInfo:{flex:1},petDetails:{fontSize:14,color:f.theme.colors.placeholder},addPetButton:{flexDirection:"row",alignItems:"center",padding:12,marginTop:8,borderWidth:1,borderColor:f.theme.colors.border,borderRadius:8,justifyContent:"center"},addPetText:{marginLeft:8,color:f.theme.colors.primary,fontSize:16},petDropdown:{maxHeight:200,borderWidth:1,borderColor:f.theme.colors.border,borderRadius:8,marginTop:8,backgroundColor:f.theme.colors.surface,position:"absolute",top:"100%",left:0,right:0,zIndex:1e3},dropdownItem:{padding:12,borderBottomWidth:1,borderBottomColor:f.theme.colors.border},dropdownPetName:{fontSize:16,fontWeight:"500"},dropdownPetDetails:{fontSize:14,color:f.theme.colors.placeholder,marginTop:2},noPetsText:{fontSize:14,color:f.theme.colors.placeholder,fontStyle:"italic"},petsSection:{zIndex:3,elevation:3},dateTimeSection:{zIndex:1,elevation:1},payoutRow:{marginTop:12,paddingTop:12,borderTopWidth:1,borderTopColor:f.theme.colors.border},payoutLabel:{fontSize:16,fontWeight:"500",color:f.theme.colors.success},payoutAmount:{fontSize:16,fontWeight:"600",color:f.theme.colors.success},ownerName:{fontSize:18,fontWeight:"normal",marginBottom:4,fontFamily:f.theme.fonts.header.fontFamily},proName:{fontSize:18,fontWeight:"normal",marginBottom:4,fontFamily:f.theme.fonts.header.fontFamily},serviceTypeLabel:{fontSize:f.theme.fontSizes.mediumLarge,color:f.theme.colors.text,fontFamily:f.theme.fonts.header.fontFamily,fontWeight:"normal"},petListTitle:{fontSize:16,fontWeight:"900",marginBottom:8,fontFamily:f.theme.fonts.header.fontFamily},petInfo:{fontSize:14,color:f.theme.colors.placeholder,fontFamily:f.theme.fonts.regular.fontFamily},occurrenceTitle:{fontSize:18,fontWeight:"bold",marginBottom:12,fontFamily:f.theme.fonts.header.fontFamily},occurrenceDate:{fontSize:16,fontWeight:"500",fontFamily:f.theme.fonts.regular.fontFamily},occurrenceTime:{fontSize:14,color:f.theme.colors.placeholder,fontFamily:f.theme.fonts.regular.fontFamily},costBreakdownTitle:{fontSize:18,fontWeight:"bold",marginBottom:12,fontFamily:f.theme.fonts.header.fontFamily},costLabel:{fontSize:16,fontFamily:f.theme.fonts.regular.fontFamily},costAmount:{fontSize:16,fontWeight:"500",fontFamily:f.theme.fonts.regular.fontFamily},additionalRateLabel:{fontSize:14,color:f.theme.colors.placeholder,fontFamily:f.theme.fonts.regular.fontFamily},additionalRateAmount:{fontSize:14,fontWeight:"500",fontFamily:f.theme.fonts.regular.fontFamily},serviceDetailLabel:{fontSize:16,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily},serviceDetailValue:{fontSize:16,fontWeight:"500",color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily},occurrenceCardTitle:{fontSize:16,fontWeight:"500",marginBottom:4,fontFamily:f.theme.fonts.header.fontFamily},occurrenceCardDate:{fontSize:16,fontWeight:"500",marginBottom:4,fontFamily:f.theme.fonts.regular.fontFamily},occurrenceCardTime:{fontSize:14,color:f.theme.colors.placeholder,fontFamily:f.theme.fonts.regular.fontFamily},editOccurrenceText:{color:f.theme.colors.primary,marginLeft:5,fontFamily:f.theme.fonts.regular.fontFamily},summaryRow:{flexDirection:"row",justifyContent:"space-between",marginBottom:8},summaryText:{fontSize:16,fontFamily:f.theme.fonts.regular.fontFamily},dropdownText:{color:f.theme.colors.text,fontSize:16,fontFamily:f.theme.fonts.regular.fontFamily},dropdownItem:{padding:12,borderBottomWidth:1,borderBottomColor:f.theme.colors.border},dropdownItemText:{fontSize:16,fontFamily:f.theme.fonts.regular.fontFamily},occurrenceCardText:{fontSize:16,fontFamily:f.theme.fonts.regular.fontFamily},dateTimeText:{fontSize:16,fontWeight:"500",marginBottom:4,fontFamily:f.theme.fonts.regular.fontFamily},errorMessage:{color:f.theme.colors.error,fontSize:14,textAlign:"center",fontFamily:f.theme.fonts.regular.fontFamily,marginTop:8,marginBottom:8}}),qr=()=>{const e=(0,j.useNavigation)(),t=(0,j.useRoute)(),{is_DEBUG:o,timeSettings:l}=(0,a.useContext)(p.AuthContext),[d,c]=(0,a.useState)(null),[u,m]=(0,a.useState)(!0),[g,y]=(0,a.useState)(null),[C,v]=(0,a.useState)(!1),[B,k]=(0,a.useState)(!1),[_,I]=(0,a.useState)(!1),[M,R]=(0,a.useState)([]),[P,z]=(0,a.useState)(null),[F,L]=(0,a.useState)(null),[O,E]=(0,a.useState)(!1),[W,N]=(0,a.useState)(null),[U,V]=(0,a.useState)({serviceDetails:{type:"",animalType:"",numberOfPets:0},rates:{additionalPetRate:0,holidayFee:0,weekendFee:0,extraServices:[]}}),[q,Y]=(0,a.useState)({top:0,left:0,width:0}),[G,J]=((0,a.useRef)(null),(0,a.useState)(!1)),[$,Z]=(0,a.useState)(!1),[K,Q]=(0,a.useState)(!1),[X,ee]=(0,a.useState)([]),[oe,ae]=(0,a.useState)(!1),[ne,re]=(0,a.useState)(!1),[ie,se]=(0,a.useState)(!1),[le,de]=(0,a.useState)(!1),[ce,ue]=(0,a.useState)(!1),[me,ye]=(0,a.useState)(!1),[be,xe]=(0,a.useState)({visible:!1,actionText:"",onConfirm:null,isLoading:!1}),[je,we]=(0,a.useState)([]),[Ce,ve]=(0,a.useState)(!1),[Se,Te]=(0,a.useState)([]),[ke,_e]=(0,a.useState)(!1),[Ae,Ie]=(0,a.useState)({visible:!1,message:"",type:"success"});(0,a.useEffect)((()=>{void 0!==t.params?.isProfessional&&(o&&console.log("MBA44321 Setting isProfessionalView from route params:",t.params.isProfessional),v(t.params.isProfessional))}),[t.params?.isProfessional]),(0,a.useEffect)((()=>{(async()=>{m(!0);try{let a=t.params?.bookingId,r=t.params?.initialData;if(o&&console.log("MBA77123 BookingDetails: Fetching booking with params:",{bookingId:a,initialData:r}),!a)return void e.replace("MyBookings");let i="web"===n.default.OS?sessionStorage.getItem("userToken"):await x.default.getItem("userToken");if(!i)throw new Error("No authentication token found");const s=await w.default.get("".concat(b.API_BASE_URL,"/api/bookings/v1/").concat(a,"/?is_prorated=true"),{headers:{Authorization:"Bearer ".concat(i)}}),d=s.data.occurrences.map((e=>{try{o&&console.log("MBA134njo0vh03 Processing occurrence from backend:",{occurrence:e,timezone:l.timezone,utcTimes:{start:"".concat(e.start_date," ").concat(e.start_time),end:"".concat(e.end_date," ").concat(e.end_time)}});const t=(0,ro.formatOccurrenceFromUTC)(e,l.timezone);return o&&console.log("MBA134njo0vh03 Final formatted occurrence:",t),t}catch(g){return console.error("MBA134njo0vh03 Error formatting occurrence:",g,{occurrence:e,timezone:l.timezone}),Object.assign({},e,{formatted_start:"Error formatting date",formatted_end:"Error formatting date",duration:"Unknown",timezone:l.timezone_abbrev,dst_message:""})}}));o&&console.log("MBA134njo0vh03 All formatted occurrences:",d);const u=Object.assign({},s.data,{id:s.data.booking_id,ownerName:s.data.owner_name,professionalName:s.data.professional_name,serviceType:s.data.service_details.service_type,animalType:s.data.service_details.animal_type,numberOfPets:s.data.service_details.num_pets,costs:s.data.cost_summary,status:s.data.status,occurrences:d});o&&console.log("MBA77123 BookingDetails: Fetched and transformed booking data:",{original:s.data,transformed:u}),c(u)}catch(g){console.error("Error fetching booking details:",g),Be.default.alert("Error","Unable to load booking details. Please try again.",[{text:"OK",onPress:()=>e.replace("MyBookings")}])}finally{m(!1)}})()}),[t.params?.bookingId,e,l]);const De=(e,t="TBD")=>null===e||void 0===e||""===e?t:e;(0,a.useEffect)((()=>{k(!1),I(!1)}),[]),(0,a.useEffect)((()=>{d&&(o&&console.log("BookingDetails: Booking updated, current value:",d),V(Object.assign({},d,{serviceDetails:{type:d.serviceType||"",animalType:d.animalType||"",numberOfPets:(d.pets||[]).length},rates:{additionalPetRate:d.rates?.additionalPetRate??0,holidayFee:d.rates?.holidayFee??0,weekendFee:d.rates?.weekendFee??0,extraServices:d.rates?.extraServices||[]}})))}),[d]);const Me=()=>d?(o&&console.log("Booking edit ability:",d.can_edit),d.can_edit):(console.log("BookingDetails: Booking is undefined"),!1),Re=async()=>{if(B){const e=new Set(d.pets.map((e=>e.pet_id))),t=new Set(X.map((e=>e.pet_id)));if([...e].every((e=>t.has(e)))&&[...t].every((t=>e.has(t))))k(!1),o&&console.log("MBA2573 NO PET CHANGES");else{o&&console.log("MBA2573 Pets have changed, saving...");try{re(!0),o&&console.log("MBA2573 Saving pets:",X);const e="web"===n.default.OS?sessionStorage.getItem("userToken"):await x.default.getItem("userToken");if(!e)throw new Error("No authentication token found");const t=await fetch("".concat(b.API_BASE_URL,"/api/booking_drafts/v1/").concat(d.booking_id,"/update_pets/"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({pets:X.map((e=>e.pet_id))})});if(!t.ok)throw new Error("HTTP error! status: ".concat(t.status));const a=await t.json();if(o&&console.log("MBA2573 Backend response:",a),a.draft_data){o&&console.log("MBA2573 Backend response:",a);const e=a.draft_data.occurrences.map((e=>{try{return o&&console.log("MBA134njo0vh03 Processing occurrence from pets update:",{occurrence:e,timezone:l.timezone}),(0,ro.formatOccurrenceFromUTC)(e,l.timezone)}catch(g){return console.error("MBA134njo0vh03 Error formatting occurrence:",g),Object.assign({},e,{formatted_start:"Error formatting date",formatted_end:"Error formatting date",duration:"Unknown",timezone:l.timezone_abbrev,dst_message:""})}}));c((t=>Object.assign({},t,{status:a.draft_data.status,pets:a.draft_data.pets,occurrences:e,cost_summary:a.draft_data.cost_summary,can_edit:a.draft_data.can_edit}))),R((e=>[...e]))}k(!1)}catch(g){o&&console.error("MBA2573 Error updating pets:",g),Be.default.alert("Error","Failed to update pets")}finally{re(!1)}}}else ee(d.pets||[]),k(!0)},Pe=e=>{const t={Pending:{backgroundColor:f.theme.colors.warning+"20",textColor:f.theme.colors.warning},Confirmed:{backgroundColor:f.theme.colors.success+"20",textColor:f.theme.colors.success},Canceled:{backgroundColor:f.theme.colors.error+"20",textColor:f.theme.colors.error},Completed:{backgroundColor:f.theme.colors.primary+"20",textColor:f.theme.colors.primary}};return t[e]||t.Pending},ze=async()=>{try{const e=U.rates.baseRate*U.quantity,t=U.rates.extraServices.reduce(((e,t)=>e+t.amount),0),o=U.rates.holidayFee||0,a=U.rates.weekendFee||0,n=Math.max(0,U.numberOfPets-1)*(U.rates.additionalPetRate||0),r=e+t+o+a+n,i=.1*r,s=.09*r,l=r+i+s,d=.9*r;V((o=>Object.assign({},o,{costs:{baseTotal:e,extraServicesTotal:t,additionalPetTotal:n,subtotal:r,ownerFee:i,taxes:s,totalOwnerCost:l,professionalPayout:d}})))}catch(g){console.error("Error recalculating totals:",g)}},Fe=e=>{L(null),o&&console.log("MBA9740174 handleDateTimeCardPress - Original occurrence:",e);const t=(e=>{const t=parseFloat(e.rates?.base_rate||0),a=e.rates?.unit_of_time,n=((e,t,o,a,n)=>{const r=new Date("".concat(e,"T").concat(o)),i=new Date("".concat(t,"T").concat(a))-r;switch(n){case"15 Min":return Math.ceil(i/9e5);case"30 Min":return Math.ceil(i/18e5);case"45 Min":return Math.ceil(i/27e5);case"1 Hour":return Math.ceil(i/36e5);case"2 Hour":return Math.ceil(i/72e5);case"3 Hour":return Math.ceil(i/108e5);case"4 Hour":return Math.ceil(i/144e5);case"5 Hour":return Math.ceil(i/18e6);case"6 Hour":return Math.ceil(i/216e5);case"7 Hour":return Math.ceil(i/252e5);case"8 Hour":return Math.ceil(i/288e5);case"24 Hour":case"Per Day":return Math.ceil(i/864e5);default:return 1}})(e.start_date,e.end_date,e.start_time,e.end_time,a);return o&&console.log("MBA9740174 calculateBaseTotal:",{baseRate:t,timeUnit:a,timeUnits:n,total:t*n}),t*n})(e),a=(e,t)=>{o&&console.log("MBA9740174 parseDateTime input:",{dateStr:e,timeStr:t});try{const[a,n,r]=e.split("-").map(Number),[i,s]=t.split(":").map(Number),l=new Date(Date.UTC(a,n-1,r,i,s));o&&console.log("MBA9740174 UTC date created:",l.toISOString());const d=new Date(l);let c=d.getHours();const u=c>=12?"PM":"AM";c=c%12||12;const m="".concat(c.toString().padStart(2,"0"),":").concat(d.getMinutes().toString().padStart(2,"0")," ").concat(u);return o&&console.log("MBA9740174 Converted to local:",{date:e,time:m,originalTime:t}),{date:e,time:m}}catch(g){return console.error("MBA9740174 Error in parseDateTime:",g),{date:e,time:t}}},n=a(e.start_date,e.start_time),r=a(e.end_date,e.end_time),i=e.occurrence_id;o&&console.log("MBA9740174 Using occurrence ID:",i);const s={occurrence_id:i,startDate:n.date,endDate:r.date,startTime:n.time,endTime:r.time,rates:{baseRate:e.rates?.base_rate?.toString()||"0",additionalAnimalRate:e.rates?.additional_animal_rate?.toString()||"0",appliesAfterAnimals:e.rates?.applies_after?.toString()||"1",holidayRate:e.rates?.holiday_rate?.toString()||"0",unit_of_time:e.rates?.unit_of_time,additionalRates:(e.rates?.additional_rates||[]).filter((e=>"Booking Details Cost"!==e.title)).map((e=>({name:e.title,description:e.description||"",amount:(e.amount?.replace(/[^0-9.]/g,"")||"0").toString()})))},totalCost:e.calculated_cost?.toString()||"0",baseTotal:t.toString(),multiple:Le(t.toString(),e.rates?.base_rate)};o&&(console.log("MBA9740174 transformedOccurrence:",s),console.log("MBA9740174 Original occurrence:",e)),z(s),E(!0)},Le=(e,t)=>{if(!t||0===t)return 0;return(parseFloat(e.replace("$",""))/parseFloat(t)).toFixed(2)},Oe=e=>{if(!e)return"";try{if(e.match(/([A-Za-z]{3})\s+(\d{2}),\s+(\d{4})/)){const t=new Date(e.split("(")[0].trim());return(0,ko.format)(t,"MMM dd")}const t=new Date(e);return isNaN(t.getTime())?e:(0,ko.format)(t,"MMM dd")}catch(g){return console.error("Error formatting occurrence date:",g),e}},Ee=async(e,t="",a={})=>{xe((e=>Object.assign({},e,{isLoading:!0})));try{if(e===te.PENDING_CLIENT_APPROVAL){const e=await(async(e,t,a)=>{try{if(!d)throw new Error("No booking data available");o&&console.log("Sending booking message:",{bookingId:e,recipientId:t,messageType:a,booking:d});const n="conv_2";o&&console.log("Using existing conversation:",n);const r={message_id:Date.now().toString(),participant1_id:he,participant2_id:t,sender:he,type:"booking_request",data:{bookingId:e,messageType:a,serviceType:d.serviceType,dates:d.occurrences.map((e=>({startDate:e.start_date,endDate:e.end_date,startTime:e.start_time,endTime:e.end_time}))),totalCost:d.costs.totalOwnerCost,status:d.status},timestamp:(new Date).toISOString(),status:"sent",is_booking_request:!0,metadata:{}};pe[n]||(pe[n]=[]),pe[n].push(r);const i=fe.find((e=>e.id===n));return i&&(i.lastMessage="Approval Request sent",i.timestamp=(new Date).toISOString(),i.unread=!0),o&&(console.log("Message sent successfully to conversation:",n),console.log("Updated conversation messages:",pe[n])),!0}catch(g){return console.error("Error sending booking message:",g),!1}})(d.id,d.ownerId||"owner123","professional_changes");if(!e)throw new Error("Failed to send booking message")}o&&console.log("Updating booking status:",{bookingId:d.id,currentStatus:d.status,newStatus:e,reason:t,metadata:a});const n=await(async(e,t,o="",a={})=>{console.log("updateBookingStatus called with:",{bookingId:e,newStatus:t,reason:o,metadata:a,availableBookings:Object.keys(ge)}),await new Promise((e=>setTimeout(e,1e3)));const n=Object.keys(ge).find((t=>ge[t].id===e));if(!n)throw console.error("Booking not found in mockBookingDetails. Available bookings:",Object.keys(ge),"\nFull mockBookingDetails:",ge),new Error("Booking not found");return ge[n]=Object.assign({},ge[n],{status:t,statusReason:o,updated_at:(new Date).toISOString()},a),console.log("Updated booking:",ge[n]),ge[n]})(d.id,e,t,Object.assign({},a,{occurrences:d.occurrences,costs:d.costs}));c(n),ye(!1),Be.default.alert("Success","Booking ".concat(e.toLowerCase()," successfully"))}catch(g){console.error("Error updating booking status:",g),Be.default.alert("Error","Failed to update booking status")}finally{xe((e=>Object.assign({},e,{isLoading:!1,visible:!1})))}},We=(e,t)=>{xe({visible:!0,actionText:e,onConfirm:t,isLoading:!1})},Ne=async(t,a=null)=>{if(o&&console.log("MBA12345 Action button clicked:",t,a),"Send to Owner"===t)try{xe((e=>Object.assign({},e,{isLoading:!0})));const t=await(0,p.getStorage)("userToken");if(!t)throw new Error("No authentication token found");o&&console.log("MBA12345 Sending booking update to owner for booking:",d.booking_id);const a=await w.default.post("".concat(b.API_BASE_URL,"/api/bookings/v1/").concat(d.booking_id,"/update/"),{},{headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"}});o&&console.log("MBA12345 Update response:",a.data),Ie({visible:!0,message:a.data.message||"Booking sent to owner successfully",type:"success"}),(0,h.navigateToFrom)(e,"MessageHistory","BookingDetails",{messageId:a.data.message_id,conversationId:a.data.conversation_id})}catch(g){console.error("Error in handleActionButtonClick:",g),400===g.response?.status?Ie({visible:!0,message:g.response.data.error||"No draft data found",type:"error"}):Ie({visible:!0,message:"Failed to process action. Please try again.",type:"error"})}finally{xe((e=>Object.assign({},e,{isLoading:!1,visible:!1})))}else if("Deny"===t)try{xe((e=>Object.assign({},e,{isLoading:!0}))),await Ee(te.DENIED),Ie({visible:!0,message:"Booking denied successfully",type:"success"})}catch(g){console.error("Error denying booking:",g),Ie({visible:!0,message:"Failed to deny booking. Please try again.",type:"error"})}finally{xe((e=>Object.assign({},e,{isLoading:!1,visible:!1})))}else if("Approve"===t)try{xe((e=>Object.assign({},e,{isLoading:!0}))),o&&console.log("MBA12345 Approving booking:",d.booking_id);const e=await(0,at.approveBooking)(d.booking_id);o&&console.log("MBA12345 Approve response:",e),c((t=>Object.assign({},t,{status:e.status}))),Ie({visible:!0,message:e.message||"Booking approved successfully",type:"success"})}catch(g){console.error("Error approving booking:",g),Ie({visible:!0,message:g.response?.data?.error||"Failed to approve booking. Please try again.",type:"error"})}finally{xe((e=>Object.assign({},e,{isLoading:!1,visible:!1})))}};(0,a.useEffect)((()=>{d&&V(d)}),[d]);const He=async()=>{if(N(null),d?.pets?.length)if(d?.service_details?.service_type)try{const e=await(0,p.getStorage)("userToken");if(!e)throw new Error("No authentication token found");o&&console.log("MBA565656 Fetching service rates for booking:",d.booking_id);const t=await fetch("".concat(b.API_BASE_URL,"/api/bookings/v1/").concat(d.booking_id,"/service_rates/"),{headers:{Authorization:"Bearer ".concat(e)}});if(!t.ok)throw new Error("HTTP error! status: ".concat(t.status));const a=await t.json();if(o&&console.log("MBA565656 Service rates response:",a),"success"!==a.status||!a.rates)throw new Error("Invalid response format from service rates endpoint");{const e={base_rate:a.rates.base_rate,additional_animal_rate:a.rates.additional_animal_rate,applies_after:a.rates.applies_after,holiday_rate:a.rates.holiday_rate,unit_of_time:a.rates.unit_of_time,additional_rates:a.rates.additional_rates.map((e=>({title:e.title,description:e.description,amount:e.amount}))),calculated_cost:Math.round(100*a.rates.calculated_cost)/100};o&&console.log("MBA565656 Setting defaultOccurrenceRates:",e),L(e),z(null),E(!0)}}catch(g){o&&console.error("MBA565656 Error fetching service rates:",g),N("Failed to load service rates. Please try again.")}else N("Please select and save a service before adding an event");else N("Please add and save pets before adding an event")},Ue=async(e,t)=>{try{o&&console.log("MBA123a73hv - Updating service type:",{bookingId:e,serviceId:t});const a=await(0,p.getStorage)("userToken");if(!a)throw new Error("No authentication token found");const n=await fetch("".concat(b.API_BASE_URL,"/api/booking_drafts/v1/").concat(e,"/update_service_type/"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a)},body:JSON.stringify({service_id:t})});if(!n.ok){const e=await n.json();throw o&&console.error("MBA123a73hv - Error updating service type:",e),new Error(e.error||"Failed to update service type")}const r=await n.json();return o&&console.log("MBA123a73hv - Service type update response:",r),r}catch(g){throw o&&console.error("MBA123a73hv - Error updating service type:",g),g}};return(0,T.jsxs)(jt,{fullWidthHeader:!0,children:[(0,T.jsx)(bt,{title:"Booking Details",onBackPress:()=>(0,h.handleBack)(e)}),u?(0,T.jsx)(r.default,{style:Vr.loadingContainer,children:(0,T.jsx)(A.default,{size:"large",color:f.theme.colors.primary})}):d?(0,T.jsxs)(H.default,{style:Vr.container,children:[(0,T.jsx)((({status:e})=>(0,T.jsxs)(r.default,{style:Vr.statusContainer,children:[(0,T.jsx)(i.default,{style:Vr.statusLabel,children:"Booking Status:"}),(0,T.jsx)(r.default,{style:[Vr.statusBadge,{backgroundColor:Pe(e).backgroundColor}],children:(0,T.jsx)(i.default,{style:[Vr.statusText,{color:Pe(e).textColor}],children:e})})]})),{status:De(d?.status,"Pending Professional Changes")}),(0,T.jsxs)(r.default,{style:Vr.section,children:[(0,T.jsx)(i.default,{style:Vr.sectionTitle,children:"Booking Parties"}),(0,T.jsxs)(r.default,{style:Vr.serviceDetailRow,children:[(0,T.jsx)(i.default,{style:Vr.label,children:"Owner: "}),(0,T.jsx)(i.default,{style:Vr.value,children:De(d?.ownerName)})]}),(0,T.jsxs)(r.default,{style:Vr.serviceDetailRow,children:[(0,T.jsx)(i.default,{style:Vr.label,children:"Professional:  "}),(0,T.jsx)(i.default,{style:Vr.value,children:De(d?.professionalName)})]})]}),(0,T.jsxs)(r.default,{style:[Vr.section,Vr.petsSection],children:[(0,T.jsxs)(r.default,{style:Vr.sectionHeader,children:[(0,T.jsx)(i.default,{style:Vr.sectionTitle,children:"Booking Pets"}),Me()&&(0,T.jsx)(s.default,{onPress:Re,style:[Vr.editButton,B&&Vr.saveButton],testID:"edit-button",disabled:ne,children:ne?(0,T.jsx)(A.default,{size:"small",color:f.theme.colors.primary}):B?(0,T.jsx)(i.default,{style:Vr.saveButtonText,children:"Save Pets"}):(0,T.jsx)(S.default,{name:"pencil",size:24,color:f.theme.colors.primary})})]}),B?(0,T.jsxs)(r.default,{children:[X.map(((e,t)=>(0,T.jsxs)(r.default,{style:Vr.petRow,children:[(0,T.jsxs)(i.default,{style:Vr.petName,children:[e.name," \u2022 ",e.species," ",e.breed&&"\u2022 ".concat(e.breed)]}),(0,T.jsx)(s.default,{onPress:()=>ee((e=>e.filter(((e,o)=>o!==t)))),children:(0,T.jsx)(S.default,{name:"close",size:24,color:f.theme.colors.error})})]},t))),(0,T.jsxs)(s.default,{style:Vr.addPetButton,onPress:async()=>{oe||await(async()=>{o&&console.log("fetching available pets with booking id:",d.booking_id);try{const e="web"===n.default.OS?sessionStorage.getItem("userToken"):await x.default.getItem("userToken");if(!e)throw new Error("No authentication token found");ve(!0);const t=await w.default.get("".concat(b.API_BASE_URL,"/api/booking_drafts/v1/").concat(d.booking_id,"/available_pets/"),{headers:{Authorization:"Bearer ".concat(e)}});we(t.data),o&&console.log("available pets:",t.data)}catch(g){console.error("Error fetching available pets:",g),Be.default.alert("Error","Failed to fetch available pets")}finally{ve(!1)}})(),ae(!oe)},children:[(0,T.jsx)(i.default,{style:Vr.addPetText,children:"Add Pet"}),(0,T.jsx)(S.default,{name:oe?"chevron-up":"chevron-down",size:24,color:f.theme.colors.text})]}),oe&&(0,T.jsx)(r.default,{style:Vr.dropdownList,children:(0,T.jsxs)(H.default,{nestedScrollEnabled:!0,style:{maxHeight:200},children:[Ce?(0,T.jsx)(A.default,{style:{padding:10}}):je.filter((e=>!X.some((t=>t.pet_id===e.pet_id)))).map((e=>(0,T.jsx)(s.default,{style:Vr.dropdownItem,onPress:()=>{ee((t=>[...t,e])),ae(!1)},children:(0,T.jsxs)(i.default,{style:Vr.dropdownText,children:[e.name," \u2022 ",e.species," ",e.breed&&"\u2022 ".concat(e.breed)]})},e.pet_id||e.id))),!Ce&&0===je.length&&(0,T.jsx)(i.default,{style:Vr.noContentText,children:"No pets available"})]})})]}):(0,T.jsx)(r.default,{children:d?.pets?.length>0?d.pets.map(((e,t)=>(0,T.jsx)(r.default,{style:Vr.petRow,children:(0,T.jsxs)(i.default,{style:Vr.petName,children:[e.name," \u2022 ",e.species," ",e.breed&&"\u2022 ".concat(e.breed)]})},t))):(0,T.jsx)(i.default,{style:Vr.noContentText,children:"No pets added to this booking"})})]}),(0,T.jsxs)(r.default,{style:[Vr.section,{zIndex:2}],children:[(0,T.jsxs)(r.default,{style:Vr.sectionHeader,children:[(0,T.jsx)(i.default,{style:Vr.sectionTitle,children:"Service Details"}),Me()&&(0,T.jsx)(s.default,{onPress:async()=>{try{if(_){o&&console.log("MBA123a73hv - Service type change initiated:",U?.service_details?.service_id),se(!0);const e=await Ue(d.booking_id,U?.service_details?.service_id);if(e.draft_data){o&&console.log("MBA123a73hv - Received draft data:",e.draft_data);const t=e.draft_data.occurrences.map((e=>{try{return o&&console.log("MBA134njo0vh03 Processing occurrence from service update:",{occurrence:e,timezone:l.timezone}),(0,ro.formatOccurrenceFromUTC)(e,l.timezone)}catch(g){return console.error("MBA134njo0vh03 Error formatting occurrence:",g),Object.assign({},e,{formatted_start:"Error formatting date",formatted_end:"Error formatting date",duration:"Unknown",timezone:l.timezone_abbrev,dst_message:""})}}));c((o=>Object.assign({},o,e.draft_data,{occurrences:t,service_details:Object.assign({},o.service_details,e.draft_data.service_details),serviceType:e.draft_data.service_details.service_type,status:e.booking_status}))),V((t=>Object.assign({},t,{service_details:e.draft_data.service_details})))}Ie({visible:!0,message:"Service updated successfully",type:"success"})}else V((e=>Object.assign({},e,{service_details:Object.assign({},d.service_details)}))),await(async()=>{o&&console.log("fetching available services with booking id:",d.booking_id);try{const e="web"===n.default.OS?sessionStorage.getItem("userToken"):await x.default.getItem("userToken");if(!e)throw new Error("No authentication token found");_e(!0);const t=await w.default.get("".concat(b.API_BASE_URL,"/api/bookings/v1/").concat(d.booking_id,"/available_services/"),{headers:{Authorization:"Bearer ".concat(e)}});Te(t.data),o&&console.log("available services:",t.data)}catch(g){console.error("Error fetching available services:",g),Be.default.alert("Error","Failed to fetch available services")}finally{_e(!1)}})();I(!_)}catch(g){Ie({visible:!0,message:g.message||"Failed to update service",type:"error"})}finally{se(!1)}},style:[Vr.sectionEditButton,_&&Vr.saveButton],disabled:ie,testID:"edit-button",children:_?ie?(0,T.jsx)(A.default,{size:"small",color:f.theme.colors.surface}):(0,T.jsx)(i.default,{style:Vr.saveButtonText,children:"Save Service Details"}):(0,T.jsx)(S.default,{name:"pencil",size:24,color:f.theme.colors.primary})})]}),_?(0,T.jsx)(r.default,{style:Vr.serviceEditContainer,children:(0,T.jsxs)(r.default,{style:[Vr.serviceInputRow,{zIndex:3}],children:[(0,T.jsx)(i.default,{style:Vr.inputLabel,children:"Service Type:"}),(0,T.jsx)(r.default,{style:Vr.inputContainer,children:(0,T.jsxs)(r.default,{style:Vr.dropdownContainer,children:[(0,T.jsxs)(s.default,{style:Vr.dropdownInput,onPress:()=>Z(!$),children:[(0,T.jsx)(i.default,{children:U?.service_details?.service_type||"Select Service Type"}),(0,T.jsx)(S.default,{name:$?"chevron-up":"chevron-down",size:24,color:f.theme.colors.text})]}),$&&(0,T.jsx)(r.default,{style:Vr.dropdownList,children:(0,T.jsxs)(H.default,{nestedScrollEnabled:!0,children:[ke?(0,T.jsx)(A.default,{style:{padding:10}}):Se.map((e=>(0,T.jsx)(s.default,{style:Vr.dropdownItem,onPress:()=>{V((t=>Object.assign({},t,{service_details:Object.assign({},t.service_details,{service_type:e.service_name,service_id:e.service_id})}))),Z(!1)},children:(0,T.jsx)(i.default,{style:[Vr.dropdownText,U?.service_details?.service_type===e.service_name&&Vr.selectedOption],children:e.service_name})},e.service_id))),!ke&&0===Se.length&&(0,T.jsx)(i.default,{style:Vr.noContentText,children:"No services available"})]})})]})})]})}):(0,T.jsx)(r.default,{style:Vr.serviceDetailsContainer,children:(0,T.jsxs)(r.default,{style:Vr.serviceDetailRow,children:[(0,T.jsx)(i.default,{style:Vr.label,children:"Service Type: "}),(0,T.jsx)(i.default,{style:Vr.value,children:d.service_details.service_type})]})})]}),(0,T.jsx)(r.default,{style:[Vr.section,Vr.dateTimeSection],children:(0,T.jsxs)(r.default,{children:[(0,T.jsx)(i.default,{style:Vr.sectionTitle,children:Me()?"Dates & Times (Set Rates For Dates)":"Dates & Times"}),W&&(0,T.jsx)(i.default,{style:Vr.errorMessage,children:W}),(d?.occurrences||[]).map(((e,t)=>(0,T.jsxs)(s.default,{style:Vr.occurrenceCard,onPress:()=>Me()?Fe(e):null,disabled:!Me(),children:[(0,T.jsxs)(i.default,{style:Vr.dateTimeText,children:[e.formatted_start," - ",e.formatted_end,"\n",(0,T.jsxs)(i.default,{style:[{fontWeight:"525"}],children:["Total: ",e.duration," (",e.timezone,")"]}),e.dst_message&&(0,T.jsxs)(i.default,{style:[{color:f.theme.colors.danger,fontSize:12}],children:["\n",e.dst_message]})]}),Me()&&(0,T.jsx)(S.default,{name:"pencil",size:24,color:f.theme.colors.primary})]},t))),Me()&&(0,T.jsxs)(s.default,{style:Vr.addOccurrenceButton,onPress:He,children:[(0,T.jsx)(S.default,{name:"plus",size:24,color:f.theme.colors.primary}),(0,T.jsx)(i.default,{style:Vr.addOccurrenceText,children:"Add Event"})]})]})}),(0,T.jsxs)(r.default,{style:Vr.section,children:[(0,T.jsx)(i.default,{style:Vr.sectionTitle,children:"Cost Breakdown"}),(d?.occurrences||[]).map(((e,t)=>(o&&(console.log("MBA912341 Full occurrence object:",e),console.log("MBA912341 Rendering occurrence:",{index:t,occurrence_id:e.occurrence_id,expanded:M.includes(e.occurrence_id)})),(0,T.jsxs)(s.default,{style:Vr.occurrenceCostRow,onPress:()=>{var a;o&&console.log("MBA912341 Occurrence being toggled:",e),a=e.id||e.occurrence_id||t,o&&(console.log("MBA912341 ---- Toggle Start ----"),console.log("MBA912341 Clicked occurrence ID:",a),console.log("MBA912341 Current state type:",typeof M),console.log("MBA912341 Current state value:",M)),R((e=>{o&&console.log("MBA912341 Previous state in setter:",e);const t=Array.isArray(e)?e:[];let n;return o&&(console.log("MBA912341 Normalized current IDs:",t),console.log("MBA912341 Does array include ID?",t.includes(a))),t.includes(a)?(n=t.filter((e=>e!==a)),o&&console.log("MBA912341 Removing ID - New state:",n)):(n=[...t,a],o&&console.log("MBA912341 Adding ID - New state:",n)),o&&(console.log("MBA912341 Final new state:",n),console.log("MBA912341 ---- Toggle End ----")),n}))},children:[(0,T.jsxs)(r.default,{style:Vr.occurrenceCostHeader,children:[(0,T.jsxs)(i.default,{style:Vr.occurrenceCostHeaderText,children:[Oe(e.formatted_start)," - ",Oe(e.formatted_end)]}),(0,T.jsxs)(r.default,{style:Vr.costAndIcon,children:[(0,T.jsxs)(i.default,{style:Vr.occurrenceCost,children:["$",parseFloat(e.calculated_cost||0).toFixed(2)]}),(0,T.jsx)(S.default,{name:M.includes(e.id||e.occurrence_id||t)?"chevron-up":"chevron-down",size:20,color:f.theme.colors.text})]})]}),M.includes(e.id||e.occurrence_id||t)&&(0,T.jsxs)(r.default,{style:Vr.expandedCostDetails,children:[(0,T.jsxs)(r.default,{style:Vr.costDetailRow,children:[(0,T.jsxs)(i.default,{style:Vr.costDetailText,children:["Base Rate (",e.rates?.unit_of_time,"):"]}),(0,T.jsxs)(i.default,{style:Vr.costDetailText,children:["$",parseFloat(e.rates?.base_rate||0).toFixed(2)," \xd7 ",parseFloat(e?.multiple||0).toFixed(2)," = $",parseFloat(e.base_total?.replace(/[^0-9.-]/g,"")||0).toFixed(2)]})]}),console.log("MBA12341234 additional_animal_rate_applies:",e.rates?.additional_animal_rate_applies),0!==e.rates?.additional_animal_rate_applies&&parseFloat(e.rates?.additional_animal_rate||0)>0&&(0,T.jsxs)(r.default,{style:Vr.costDetailRow,children:[(0,T.jsxs)(i.default,{style:Vr.costDetailText,children:["Additional Pet Rate (after ",e.rates.applies_after," ",e.rates.applies_after>1?"pets":"pet","):"]}),(0,T.jsxs)(i.default,{style:Vr.costDetailText,children:["$",parseFloat(e.rates.additional_animal_rate||0).toFixed(2)," \xd7 ",d.pets.length-e.rates.applies_after," = $",(parseFloat(e.rates.additional_animal_rate||0)*(d.pets.length-e.rates.applies_after)).toFixed(2)]})]}),e.rates?.holiday_days>0&&parseFloat(e.rates?.holiday_rate||0)>0&&(0,T.jsxs)(r.default,{style:Vr.costDetailRow,children:[(0,T.jsxs)(i.default,{style:Vr.costDetailText,children:["Holiday Rate (",e.rates.holiday_days," day",e.rates.holiday_days>1?"s":"","):"]}),(0,T.jsxs)(i.default,{style:Vr.costDetailText,children:["$",(parseFloat(e.rates.holiday_rate||0)*e.rates.holiday_days).toFixed(2)]})]}),(e.rates?.additional_rates||[]).filter((e=>"Booking Details Cost"!==e.title)).map(((e,t)=>(0,T.jsxs)(r.default,{style:Vr.costDetailRow,children:[(0,T.jsxs)(i.default,{style:Vr.costDetailText,children:[e.title,":"]}),(0,T.jsxs)(i.default,{style:Vr.costDetailText,children:["$",parseFloat(e.amount?.replace(/[^0-9.-]/g,"")||0).toFixed(2)]})]},t)))]})]},t)))),(0,T.jsxs)(r.default,{style:Vr.costSummary,children:[(0,T.jsxs)(r.default,{style:Vr.summaryRow,children:[(0,T.jsx)(i.default,{style:Vr.summaryText,children:"Subtotal:"}),(0,T.jsxs)(i.default,{style:Vr.summaryText,children:["$",parseFloat(d?.cost_summary?.subtotal||0).toFixed(2)]})]}),(0,T.jsxs)(r.default,{style:Vr.summaryRow,children:[(0,T.jsx)(i.default,{style:Vr.summaryText,children:"Platform Fee (10%):"}),(0,T.jsxs)(i.default,{style:Vr.summaryText,children:["$",parseFloat(d?.cost_summary?.platform_fee||0).toFixed(2)]})]}),(0,T.jsxs)(r.default,{style:Vr.summaryRow,children:[(0,T.jsx)(i.default,{style:Vr.summaryText,children:"Taxes (8%):"}),(0,T.jsxs)(i.default,{style:Vr.summaryText,children:["$",parseFloat(d?.cost_summary?.taxes||0).toFixed(2)]})]}),(0,T.jsxs)(r.default,{style:[Vr.summaryRow,Vr.totalRow],children:[(0,T.jsx)(i.default,{style:Vr.totalLabel,children:"Total Cost to Owner:"}),(0,T.jsxs)(i.default,{style:Vr.totalAmount,children:["$",parseFloat(d?.cost_summary?.total_owner_cost||0).toFixed(2)]})]}),(0,T.jsxs)(r.default,{style:[Vr.summaryRow,Vr.payoutRow],children:[(0,T.jsx)(i.default,{style:Vr.payoutLabel,children:"Sitter Payout:"}),(0,T.jsxs)(i.default,{style:Vr.payoutAmount,children:["$",parseFloat(d?.cost_summary?.total_sitter_payout||0).toFixed(2)]})]})]})]}),(0,T.jsxs)(r.default,{style:Vr.section,children:[(0,T.jsx)(i.default,{style:Vr.sectionTitle,children:"Cancellation Policy"}),(0,T.jsxs)(i.default,{style:Vr.policyText,children:["\u2022 No refund if canceled within 1 hour of booking start time","\n","\u2022 50% refund if canceled between 1-24 hours before start time","\n","\u2022 Full refund if canceled more than 24 hours before the booking"]})]}),(()=>{if(!d)return null;const e=[];return C&&(d.status===te.PENDING_INITIAL_PROFESSIONAL_CHANGES&&e.push((0,T.jsx)(s.default,{style:[Vr.button,Vr.denyButton],onPress:()=>We("deny this booking",(()=>Ne("Deny"))),children:(0,T.jsx)(i.default,{style:Vr.denybuttonText,children:"Deny"})},"deny")),[te.PENDING_INITIAL_PROFESSIONAL_CHANGES,te.PENDING_PROFESSIONAL_CHANGES,te.CONFIRMED_PENDING_PROFESSIONAL_CHANGES].includes(d.status)&&e.push((0,T.jsx)(s.default,{style:[Vr.button,Vr.primaryButton],onPress:()=>We("send these changes to the owner",(()=>Ne("Send to Owner"))),children:(0,T.jsx)(i.default,{style:Vr.buttonText,children:"Send to Owner"})},"send"))),[te.PENDING_PROFESSIONAL_CHANGES,te.CONFIRMED,te.CONFIRMED_PENDING_PROFESSIONAL_CHANGES,te.CONFIRMED_PENDING_CLIENT_APPROVAL].includes(d.status)&&e.push((0,T.jsx)(s.default,{style:[Vr.button,Vr.cancelButton],onPress:()=>We("cancel this booking",(()=>Ne("Cancel"))),children:(0,T.jsx)(i.default,{style:Vr.cancelButtonText,children:"Cancel Booking"})},"cancel")),C||[te.PENDING_CLIENT_APPROVAL,te.CONFIRMED_PENDING_CLIENT_APPROVAL].includes(d.status)&&e.push((0,T.jsx)(s.default,{style:[Vr.button,Vr.approveButton],onPress:()=>We("approve this booking",(()=>Ne("Approve"))),children:(0,T.jsx)(i.default,{style:Vr.buttonText,children:"Approve"})},"approve")),(0,T.jsx)(r.default,{style:Vr.actionButtonsContainer,children:e})})(),(0,T.jsx)(Ur,{visible:le,onClose:()=>de(!1),onSubmit:async e=>{await Ee(te.PENDING_PROFESSIONAL_CHANGES,e),de(!1)},loading:ce})]}):(0,T.jsx)(r.default,{style:Vr.errorContainer,children:(0,T.jsx)(i.default,{style:Vr.errorText,children:"Unable to load booking details"})}),(0,T.jsx)(Wr,{visible:G,onClose:()=>J(!1),onAdd:e=>{V((t=>Object.assign({},t,{rates:Object.assign({},t.rates,{extraServices:[...t.rates.extraServices||[],e]})}))),ze(),J(!1)}}),(0,T.jsx)(ma,{visible:O,onClose:()=>{E(!1),L(null),setTimeout((()=>{z(null)}),300)},onAdd:P?e=>(async e=>{try{o&&console.log("MBA9740174 handleSaveOccurrence - Start:",{updatedOccurrence:e,currentBookingOccurrences:d.occurrences});const t=await(0,p.getStorage)("userToken"),a=l.timezone;if(!t)throw new Error("No authentication token found");const n=d.occurrences.findIndex((t=>{if(e.occurrence_id&&t.occurrence_id===e.occurrence_id)return o&&console.log("MBA9740174 Found match by occurrence_id:",t.occurrence_id),!0;const n=(0,ro.convertToUTC)(e.startDate,e.startTime,a),r=(0,ro.convertToUTC)(e.endDate,e.endTime,a);return o&&console.log("MBA9740174 Comparing occurrence:",{original:{start_date:t.start_date,start_time:t.start_time,end_date:t.end_date,end_time:t.end_time},updated:{start_date:e.startDate,start_time:n.time,end_date:e.endDate,end_time:r.time}}),t.start_date===e.startDate&&t.start_time===n.time&&t.end_date===e.endDate&&t.end_time===r.time}));o&&console.log("MBA9740174 Found occurrence at index:",n);let r=n;if(-1===r){const t=(0,ro.convertToUTC)(e.startDate,e.startTime,a);r=d.occurrences.findIndex((o=>o.start_date===e.startDate&&o.start_time===t.time)),o&&console.log("MBA9740174 Fallback search by start time only. Found at index:",r)}if(-1===r)throw new Error("Could not find matching occurrence to update");const i=(0,ro.convertToUTC)(e.startDate,e.startTime,a),s=(0,ro.convertToUTC)(e.endDate,e.endTime,a);o&&console.log("MBA9740174 Converted times to UTC:",{start:i,end:s});const u={occurrence_id:d.occurrences[r]?.occurrence_id,start_date:i.date,end_date:s.date,start_time:i.time,end_time:s.time,rates:{base_rate:e.rates.baseRate,additional_animal_rate:e.rates.additionalAnimalRate,applies_after:e.rates.appliesAfterAnimals,holiday_rate:e.rates.holidayRate,unit_of_time:e.rates.unit_of_time,additional_rates:e.rates.additionalRates.map((e=>({title:e.name,description:e.description||"",amount:e.amount})))},is_updated:!0};o&&console.log("MBA9740174 Formatted updatedOccurrenceData:",u);const m=d.occurrences.map(((e,t)=>t===r?(o&&console.log("MBA9740174 Updating occurrence at index:",t),Object.assign({},u,{occurrence_id:e.occurrence_id})):{occurrence_id:e.occurrence_id,start_date:e.start_date,end_date:e.end_date,start_time:e.start_time,end_time:e.end_time,rates:e.rates}));o&&console.log("MBA9740174 Final request data:",{booking_id:d.booking_id,occurrences:m});const g=await fetch("".concat(b.API_BASE_URL,"/api/booking_drafts/v1/").concat(d.booking_id,"/update_occurrences/"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({booking_id:d.booking_id,occurrences:m})});if(!g.ok)throw new Error("HTTP error! status: ".concat(g.status));const h=await g.json();if(o&&console.log("MBA9740174 Backend response:",h),h.draft_data){o&&console.log("MBA9740174 Updating local state with draft data:",{oldOccurrences:d.occurrences,newOccurrences:h.draft_data.occurrences});const e=h.draft_data.occurrences.map((e=>(0,ro.formatOccurrenceFromUTC)(e,l.timezone)));return c((t=>Object.assign({},t,h.draft_data,{occurrences:e,status:h.draft_data.status}))),Ie({visible:!0,message:"Occurrence updated successfully",type:"success"}),E(!1),!0}throw new Error("Invalid response from server")}catch(g){return o&&console.log("MBA9740174 Error saving occurrence:",g),Ie({visible:!0,message:g.message||"Failed to update occurrence",type:"error"}),!1}})(Object.assign({},e,{occurrence_id:P.occurrence_id})):async e=>{o&&console.log("MBA134njo0vh03 Adding new occurrence:",e);try{let t=await(0,p.getStorage)("userToken");const a=l.timezone;let n;if(e.startDateTime&&e.endDateTime){const t=(0,ko.format)(e.startDateTime,"yyyy-MM-dd"),r=(0,ko.format)(e.startDateTime,"HH:mm"),i=(0,ko.format)(e.endDateTime,"yyyy-MM-dd"),s=(0,ko.format)(e.endDateTime,"HH:mm"),l=(0,ro.convertToUTC)(t,r,a),d=(0,ro.convertToUTC)(i,s,a);o&&console.log("MBA134njo0vh03 Converted owner times to UTC:",{local:{start:"".concat(t," ").concat(r),end:"".concat(i," ").concat(s)},utc:{start:l,end:d}}),n={start_date:l.date,end_date:d.date,start_time:l.time,end_time:d.time}}else{const t=(0,ro.convertToUTC)(e.startDate,e.startTime,a),r=(0,ro.convertToUTC)(e.endDate,e.endTime,a);o&&console.log("MBA134njo0vh03 Converted professional times to UTC:",{local:{start:"".concat(e.startDate," ").concat(e.startTime),end:"".concat(e.endDate," ").concat(e.endTime)},utc:{start:t,end:r}}),n={start_date:t.date,end_date:r.date,start_time:t.time,end_time:r.time}}e.rates&&(n.rates={base_rate:e.rates.baseRate,additional_animal_rate:e.rates.additionalAnimalRate,applies_after:e.rates.appliesAfterAnimals,holiday_rate:e.rates.holidayRate,unit_of_time:e.rates.unit_of_time,additional_rates:e.rates.additionalRates.map((e=>({title:e.name,description:e.description||"",amount:e.amount})))});const r=[...(d?.occurrences||[]).map((e=>({occurrence_id:e.occurrence_id,start_date:e.start_date,end_date:e.end_date,start_time:e.start_time,end_time:e.end_time,rates:e.rates}))),n];o&&console.log("MBA134njo0vh03 Sending all occurrences:",r);const i=await fetch("".concat(b.API_BASE_URL,"/api/booking_drafts/v1/").concat(d.booking_id,"/update_occurrences/"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({booking_id:d.booking_id,occurrences:r})});if(!i.ok)throw new Error("HTTP error! status: ".concat(i.status));const s=await i.json();if(o&&console.log("MBA134njo0vh03 Add event response:",s),s.draft_data.occurrences&&s.draft_data.occurrences.length>0){const e=s.draft_data.occurrences.map((e=>(0,ro.formatOccurrenceFromUTC)(e,l.timezone)));return c((t=>Object.assign({},t,{occurrences:e,cost_summary:s.draft_data.cost_summary}))),o&&console.log("MBA134njo0vh03 Adding Occurrence was Successful",{original:s.draft_data.occurrences,formatted:e}),{status:"success",data:e,message:"New occurrence added successfully"}}return{status:"error",message:"Failed to add event - no data returned"}}catch(g){return console.error("MBA134njo0vh03 Error adding occurrence:",g),{status:"error",message:g.message||"Failed to add event. Please try again."}}},defaultRates:F,initialOccurrence:P,isEditing:!!P,booking:d}),(0,T.jsx)(D,{visible:be.visible,actionText:be.actionText,onClose:()=>{be.isLoading||xe({visible:!1,actionText:be.actionText,onConfirm:null,isLoading:!1})},onConfirm:be.onConfirm,isLoading:be.isLoading}),(0,T.jsx)(Hr,{visible:Ae.visible,message:Ae.message,type:Ae.type})]})},Yr=l.default.create({container:{flex:1,height:"100vh",backgroundColor:f.theme.colors.surface,position:"fixed",top:0,right:0,bottom:0,left:0,overflow:"hidden",transition:"margin-left 0.3s ease"},content:{flex:1,height:"100%",overflow:"auto"},loadingContainer:{justifyContent:"center",alignItems:"center"}}),Gr=()=>{const e=(0,j.useNavigation)(),[t,o]=(0,a.useState)([]),[i,s]=(0,a.useState)(!1),[l,d]=(0,a.useState)(!0),[c,u]=(0,a.useState)(v.default.get("window").width<900),{isCollapsed:m,is_DEBUG:g}=(0,a.useContext)(p.AuthContext),y=E();(0,a.useEffect)((()=>{const e=v.default.addEventListener("change",(()=>{u(v.default.get("window").width<900)}));return()=>{e?.remove()}}),[]);const b=async()=>{try{d(!0);const e=await(0,at.getProfessionalServices)();g&&console.log("MBA7890: Fetched services:",e),o(e)}catch(e){console.error("MBA7890: Error fetching services:",e),y({message:"Failed to load services",type:"error",duration:3e3})}finally{d(!1)}};return(0,a.useEffect)((()=>{b()}),[g]),(0,a.useEffect)((()=>{i&&(b(),s(!1))}),[i]),(0,a.useEffect)((()=>{(async()=>{const e="ServiceManager";let t;"web"===n.default.OS?(t=sessionStorage.getItem("previousRoute"),sessionStorage.setItem("previousRoute",t||""),sessionStorage.setItem("currentRoute",e)):(t=await x.default.getItem("previousRoute"),await x.default.setItem("previousRoute",t||""),await x.default.setItem("currentRoute",e)),t||(t="Dashboard","web"===n.default.OS?(sessionStorage.setItem("previousRoute",t||""),sessionStorage.setItem("currentRoute",e)):(await x.default.setItem("previousRoute",t||""),await x.default.setItem("currentRoute",e)))})()}),[]),l?(0,T.jsx)(r.default,{style:[Yr.container,Yr.loadingContainer],children:(0,T.jsx)(A.default,{size:"large",color:f.theme.colors.primary})}):(0,T.jsxs)(r.default,{style:[Yr.container,{marginLeft:c?0:m?70:250}],children:[c&&(0,T.jsx)(bt,{title:"Service Manager",onBackPress:()=>(0,h.handleBack)(e)}),(0,T.jsx)(r.default,{style:[Yr.content,{marginTop:c?20:0}],children:(0,T.jsx)(gt,{services:t||[],setServices:o,setHasUnsavedChanges:s,isProfessionalTab:!1,isMobile:c})})]})};var Jr=o(71225);const $r=l.default.create({container:{flex:1},searchBarContainer:{margin:16},searchBar:{elevation:4,borderRadius:8,backgroundColor:f.theme.colors.surface,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:3.84,flexDirection:"row",alignItems:"center",padding:8},searchInput:{fontSize:16,color:f.theme.colors.text},scrollView:{flex:1},blogCard:{margin:16,padding:16,borderRadius:12,elevation:4,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:3.84},authorContainer:{flexDirection:"row"},authorImage:{width:40,height:40,borderRadius:20,marginRight:12},blogContent:{flex:1},title:{fontSize:20,fontWeight:"bold",marginBottom:8,fontFamily:f.theme.fonts.header.fontFamily},authorInfo:{flexDirection:"row",alignItems:"center",marginBottom:8},authorName:{fontSize:14,fontWeight:"500",fontFamily:f.theme.fonts.regular.fontFamily},dot:{marginHorizontal:4,fontFamily:f.theme.fonts.regular.fontFamily},readTime:{fontSize:14,color:"#666",fontFamily:f.theme.fonts.regular.fontFamily},preview:{fontSize:14,lineHeight:20,marginBottom:12,color:"#444",fontFamily:f.theme.fonts.regular.fontFamily},tags:{flexDirection:"row",flexWrap:"wrap",marginBottom:12},tag:{paddingHorizontal:8,paddingVertical:4,borderRadius:16,marginRight:8,marginBottom:8},tagText:{fontSize:12,fontWeight:"500",fontFamily:f.theme.fonts.regular.fontFamily},stats:{flexDirection:"row",justifyContent:"flex-start",marginTop:8},stat:{flexDirection:"row",alignItems:"center",marginRight:16},statText:{marginLeft:4,color:"#666",fontFamily:f.theme.fonts.regular.fontFamily},noResultsContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:20,marginTop:40},noResultsText:{fontSize:18,fontWeight:"500",marginTop:16,fontFamily:f.theme.fonts.regular.fontFamily},webSearchInput:{flex:1,padding:8,fontSize:16,color:f.theme.colors.text,border:"none",backgroundColor:"transparent",WebkitTapHighlightColor:"transparent",outlineWidth:0,outlineStyle:"none",boxShadow:"none",borderColor:"transparent",fontFamily:f.theme.fonts.regular.fontFamily}}),Zr=({navigation:e})=>{const t=(0,G.useTheme)(),[o,l]=(0,a.useState)(""),[d,c]=(0,a.useState)(ye),u=(0,a.useCallback)((e=>{l(e);const t=e.toLowerCase(),o=ye.filter((e=>e.title.toLowerCase().includes(t)||e.author.name.toLowerCase().includes(t)||e.content.toLowerCase().includes(t)));c(o)}),[]);return(0,T.jsxs)(r.default,{style:[$r.container,{backgroundColor:t.colors.background}],children:[(0,T.jsx)(bt,{title:"Blog",onBackPress:()=>{e.navigate("More")}}),(0,T.jsx)(r.default,{style:$r.searchBarContainer,children:"web"===n.default.OS?(0,T.jsxs)(r.default,{style:[$r.searchBar,{backgroundColor:t.colors.surface}],children:[(0,T.jsx)(S.default,{name:"magnify",size:24,color:t.colors.primary}),(0,T.jsx)(q.default,{placeholder:"Search by title, author, or content",onChangeText:u,value:o,style:$r.webSearchInput}),o?(0,T.jsx)(s.default,{onPress:()=>u(""),children:(0,T.jsx)(S.default,{name:"close-circle",size:24,color:t.colors.primary})}):null]}):(0,T.jsx)(Jr.default,{placeholder:"Search by title, author, or content",onChangeText:u,value:o,style:$r.searchBar,icon:"magnify",clearIcon:"close-circle"})}),(0,T.jsx)(H.default,{style:$r.scrollView,children:d.length>0?d.map((o=>{const a=o.content.slice(0,200)+"...";return(0,T.jsx)(s.default,{style:[$r.blogCard,{backgroundColor:t.colors.surface}],onPress:()=>(0,h.navigateToFrom)(e,"Blog","BlogPost",{post:o}),children:(0,T.jsxs)(r.default,{style:$r.authorContainer,children:[(0,T.jsx)(U.default,{source:{uri:o.author.profilePicture},style:$r.authorImage}),(0,T.jsxs)(r.default,{style:$r.blogContent,children:[(0,T.jsx)(i.default,{style:[$r.title,{color:t.colors.primary}],children:o.title}),(0,T.jsxs)(r.default,{style:$r.authorInfo,children:[(0,T.jsx)(i.default,{style:[$r.authorName,{color:t.colors.secondary}],children:o.author.name}),(0,T.jsx)(i.default,{style:$r.dot,children:" \u2022 "}),(0,T.jsx)(i.default,{style:$r.readTime,children:o.readTime})]}),(0,T.jsx)(i.default,{style:$r.preview,numberOfLines:3,children:a}),(0,T.jsx)(r.default,{style:$r.tags,children:o.tags.map(((e,o)=>(0,T.jsx)(r.default,{style:[$r.tag,{backgroundColor:t.colors.primary+"20"}],children:(0,T.jsx)(i.default,{style:[$r.tagText,{color:t.colors.primary}],children:e})},o)))}),(0,T.jsxs)(r.default,{style:$r.stats,children:[(0,T.jsxs)(r.default,{style:$r.stat,children:[(0,T.jsx)(S.default,{name:"heart-outline",size:20,color:t.colors.secondary}),(0,T.jsx)(i.default,{style:$r.statText,children:o.likes})]}),(0,T.jsxs)(r.default,{style:$r.stat,children:[(0,T.jsx)(S.default,{name:"comment-outline",size:20,color:t.colors.secondary}),(0,T.jsx)(i.default,{style:$r.statText,children:o.comments})]}),(0,T.jsxs)(r.default,{style:$r.stat,children:[(0,T.jsx)(S.default,{name:"share-outline",size:20,color:t.colors.secondary}),(0,T.jsx)(i.default,{style:$r.statText,children:o.shares})]})]})]})]})},o.id)})):(0,T.jsxs)(r.default,{style:$r.noResultsContainer,children:[(0,T.jsx)(S.default,{name:"magnify-close",size:48,color:t.colors.secondary}),(0,T.jsx)(i.default,{style:[$r.noResultsText,{color:t.colors.secondary}],children:"No blog posts found"})]})})]})},Kr=l.default.create({mainContainer:{flex:1},container:{flex:1},header:{padding:16},authorContainer:{flexDirection:"row",marginBottom:16},authorImage:{width:50,height:50,borderRadius:25,marginRight:12},authorInfo:{flex:1},authorName:{fontSize:16,fontWeight:"600",marginBottom:4,fontFamily:f.theme.fonts.header.fontFamily},authorBio:{fontSize:14,color:"#666",marginBottom:4,fontFamily:f.theme.fonts.regular.fontFamily},postInfo:{flexDirection:"row",alignItems:"center"},date:{fontSize:14,color:"#666",fontFamily:f.theme.fonts.regular.fontFamily},dot:{marginHorizontal:4,color:"#666",fontFamily:f.theme.fonts.regular.fontFamily},readTime:{fontSize:14,color:"#666",fontFamily:f.theme.fonts.regular.fontFamily},tags:{flexDirection:"row",flexWrap:"wrap",padding:16,paddingTop:0},tag:{paddingHorizontal:12,paddingVertical:6,borderRadius:16,marginRight:8,marginBottom:8},tagText:{fontSize:14,fontWeight:"500",fontFamily:f.theme.fonts.regular.fontFamily},content:{fontSize:16,lineHeight:24,padding:16,fontFamily:f.theme.fonts.regular.fontFamily},stats:{flexDirection:"row",justifyContent:"space-around",padding:16,borderTopWidth:1,borderBottomWidth:1,borderColor:"#eee"},stat:{flexDirection:"row",alignItems:"center"},statText:{marginLeft:8,fontSize:16,color:"#666",fontFamily:f.theme.fonts.regular.fontFamily},references:{padding:16},referencesTitle:{fontSize:20,fontWeight:"bold",marginBottom:12,fontFamily:f.theme.fonts.header.fontFamily},reference:{marginBottom:12},referenceText:{fontSize:14,color:"#444",lineHeight:20,fontFamily:f.theme.fonts.regular.fontFamily},errorContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:20},errorText:{fontSize:18,fontWeight:"500",marginTop:16,marginBottom:24,fontFamily:f.theme.fonts.regular.fontFamily},errorButton:{paddingHorizontal:20,paddingVertical:10,borderRadius:8},errorButtonText:{fontSize:16,fontWeight:"500",fontFamily:f.theme.fonts.regular.fontFamily}}),Qr=({route:e,navigation:t})=>{const[o,l]=(0,a.useState)(null),d=(0,G.useTheme)(),c=e=>e&&"object"===typeof e&&e.author&&"object"===typeof e.author&&e.author.name&&e.author.profilePicture&&e.author.bio&&e.title&&e.content&&Array.isArray(e.tags);if((0,a.useEffect)((()=>{(async()=>{try{if(e?.params?.post&&c(e.params.post))return l(e.params.post),void("web"===n.default.OS?sessionStorage.setItem("currentBlogPost",JSON.stringify(e.params.post)):await x.default.setItem("currentBlogPost",JSON.stringify(e.params.post)));let o;if(o="web"===n.default.OS?sessionStorage.getItem("currentBlogPost"):await x.default.getItem("currentBlogPost"),o){const e=JSON.parse(o);if(c(e))return void l(e)}if(e?.params?.postId){const t=ye.find((t=>t.id===e.params.postId));if(t&&c(t))return void l(t)}(0,h.navigateToFrom)(t,"Blog","BlogPost")}catch(o){console.error("Error loading blog post:",o),(0,h.navigateToFrom)(t,"Blog","BlogPost")}})()}),[e?.params]),!o||!c(o))return(0,T.jsxs)(r.default,{style:[Kr.mainContainer,{backgroundColor:d.colors.background}],children:[(0,T.jsx)(bt,{title:"Blog Post",onBackPress:()=>(0,h.handleBack)(t)}),(0,T.jsxs)(r.default,{style:Kr.errorContainer,children:[(0,T.jsx)(S.default,{name:"alert-circle-outline",size:48,color:d.colors.error}),(0,T.jsx)(i.default,{style:[Kr.errorText,{color:d.colors.error}],children:"Blog post not found or invalid"}),(0,T.jsx)(s.default,{style:[Kr.errorButton,{backgroundColor:d.colors.primary}],onPress:()=>(0,h.navigateToFrom)(t,"Blog","BlogPost"),children:(0,T.jsx)(i.default,{style:[Kr.errorButtonText,{color:d.colors.surface}],children:"Go to Blog List"})})]})]});return(0,T.jsxs)(r.default,{style:[Kr.mainContainer,{backgroundColor:d.colors.background}],children:[(0,T.jsx)(bt,{title:o.title,onBackPress:()=>(0,h.handleBack)(t)}),(0,T.jsxs)(H.default,{style:Kr.container,children:[(0,T.jsx)(r.default,{style:Kr.header,children:(0,T.jsxs)(r.default,{style:Kr.authorContainer,children:[(0,T.jsx)(U.default,{source:{uri:o.author.profilePicture},style:Kr.authorImage}),(0,T.jsxs)(r.default,{style:Kr.authorInfo,children:[(0,T.jsx)(i.default,{style:[Kr.authorName,{color:d.colors.secondary}],children:o.author.name}),(0,T.jsx)(i.default,{style:Kr.authorBio,children:o.author.bio}),(0,T.jsxs)(r.default,{style:Kr.postInfo,children:[(0,T.jsx)(i.default,{style:Kr.date,children:o.publishDate}),(0,T.jsx)(i.default,{style:Kr.dot,children:" \u2022 "}),(0,T.jsx)(i.default,{style:Kr.readTime,children:o.readTime})]})]})]})}),(0,T.jsx)(r.default,{style:Kr.tags,children:o.tags.map(((e,t)=>(0,T.jsx)(r.default,{style:[Kr.tag,{backgroundColor:d.colors.primary+"20"}],children:(0,T.jsx)(i.default,{style:[Kr.tagText,{color:d.colors.primary}],children:e})},t)))}),(0,T.jsx)(i.default,{style:[Kr.content,{color:d.colors.text}],children:o.content}),(0,T.jsxs)(r.default,{style:Kr.stats,children:[(0,T.jsxs)(s.default,{style:Kr.stat,children:[(0,T.jsx)(S.default,{name:"heart-outline",size:24,color:d.colors.secondary}),(0,T.jsx)(i.default,{style:Kr.statText,children:o.likes})]}),(0,T.jsxs)(s.default,{style:Kr.stat,children:[(0,T.jsx)(S.default,{name:"comment-outline",size:24,color:d.colors.secondary}),(0,T.jsx)(i.default,{style:Kr.statText,children:o.comments})]}),(0,T.jsxs)(s.default,{style:Kr.stat,children:[(0,T.jsx)(S.default,{name:"share-outline",size:24,color:d.colors.secondary}),(0,T.jsx)(i.default,{style:Kr.statText,children:o.shares})]})]}),(0,T.jsxs)(r.default,{style:Kr.references,children:[(0,T.jsx)(i.default,{style:[Kr.referencesTitle,{color:d.colors.primary}],children:"References"}),o.references.map(((e,t)=>(0,T.jsx)(s.default,{style:Kr.reference,onPress:()=>(e=>{e.url?V.default.openURL(e.url):e.doi&&V.default.openURL("https://doi.org/".concat(e.doi))})(e),children:(0,T.jsxs)(i.default,{style:Kr.referenceText,children:[e.authors," (",e.year||"n.d.","). ",e.title,". ",e.publication,".",e.doi&&" DOI: ".concat(e.doi)]})},t)))]})]})]})};var Xr=o(67146);const ei=({children:e})=>"web"===n.default.OS?(0,T.jsx)(r.default,{style:{width:"100%",maxWidth:550,marginLeft:"auto",marginRight:"auto",paddingHorizontal:15},children:e}):(0,T.jsx)(T.Fragment,{children:e}),ti=l.default.create({scrollView:{flex:1,width:"100%"},scrollViewContent:{flexGrow:1,alignItems:"center",justifyContent:"center",width:"100%"},container:{width:"100%",alignItems:"center",justifyContent:"center",paddingVertical:20},contentWrapper:{padding:20,backgroundColor:"white",borderRadius:10,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3,width:"100%"},title:{fontSize:f.theme.fontSizes.largeLarge,fontWeight:"bold",marginBottom:10,color:f.theme.colors.primary,fontFamily:f.theme.fonts.header.fontFamily,textAlign:"center"},description:{fontSize:f.theme.fontSizes.medium,marginBottom:20,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily,textAlign:"center",lineHeight:24},formSection:{width:"100%"},nameContainer:{flexDirection:"row",gap:10,marginBottom:15},nameField:{flex:1},label:{fontSize:f.theme.fontSizes.medium,marginBottom:5,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily,fontWeight:"500"},input:{backgroundColor:f.theme.colors.surface,borderRadius:5,borderColor:f.theme.colors.border,borderWidth:1,padding:15,marginBottom:15,fontSize:f.theme.fontSizes.medium,width:"100%",fontFamily:f.theme.fonts.regular.fontFamily},textArea:{height:100,textAlignVertical:"top"},checkboxGroup:{marginBottom:15},checkboxContainer:{flexDirection:"row",alignItems:"flex-start",marginBottom:10,paddingRight:10},checkboxIcon:{marginRight:10},checkboxLabel:{flex:1,fontSize:f.theme.fontSizes.medium,fontFamily:f.theme.fonts.regular.fontFamily},radioGroup:{marginBottom:15},radioContainer:{flexDirection:"row",alignItems:"center",marginBottom:10},radio:{width:20,height:20,borderRadius:10,borderWidth:2,borderColor:f.theme.colors.primary,marginRight:10},radioSelected:{backgroundColor:f.theme.colors.primary},radioLabel:{fontSize:f.theme.fontSizes.medium,fontFamily:f.theme.fonts.regular.fontFamily},submitButton:{backgroundColor:f.theme.colors.primary,padding:15,borderRadius:5,alignItems:"center",width:"100%",marginTop:20},submitButtonText:{color:f.theme.colors.whiteText,fontSize:f.theme.fontSizes.mediumLarge,fontWeight:"bold",fontFamily:f.theme.fonts.regular.fontFamily},disabledButton:{opacity:.7},successMessage:{fontSize:f.theme.fontSizes.medium,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily,textAlign:"center",marginBottom:15,lineHeight:24},otherInputContainer:{paddingLeft:34,width:"100%"},otherInput:{marginTop:5,marginBottom:10,width:"90%"},addressSection:{marginBottom:20},cityStateContainer:{flexDirection:"row",justifyContent:"space-between",gap:10},cityInput:{flex:2,marginBottom:0},stateInput:{flex:1,marginBottom:0},zipInput:{flex:1,marginBottom:0},addressNote:{fontSize:f.theme.fontSizes.small,color:f.theme.colors.text,marginBottom:10,paddingHorizontal:5},optional:{color:f.theme.colors.secondary,fontSize:f.theme.fontSizes.small,fontStyle:"italic"},referralSection:{backgroundColor:f.theme.colors.surface,padding:20,borderRadius:10,marginVertical:20,borderWidth:1,borderColor:f.theme.colors.border},buttonContainer:{flexDirection:"row",justifyContent:"flex-start",gap:10,marginBottom:20},button:{paddingVertical:8,paddingHorizontal:24,borderRadius:5,borderWidth:1,borderColor:f.theme.colors.primary,backgroundColor:"white",minWidth:80,alignItems:"center"},buttonSelected:{backgroundColor:f.theme.colors.primary},buttonText:{color:f.theme.colors.primary,fontSize:f.theme.fontSizes.medium,fontFamily:f.theme.fonts.regular.fontFamily,fontWeight:"500"},buttonTextSelected:{color:"white"},requiredFieldNote:{fontSize:f.theme.fontSizes.small,color:f.theme.colors.text,marginBottom:20,fontStyle:"italic"},requiredAsterisk:{color:"#FF0000",fontSize:f.theme.fontSizes.medium},linkContainer:{flexDirection:"row",alignItems:"center",justifyContent:"center",backgroundColor:f.theme.colors.surface,padding:10,borderRadius:5,marginVertical:10},link:{color:f.theme.colors.primary,fontSize:f.theme.fontSizes.medium,fontFamily:f.theme.fonts.regular.fontFamily,marginRight:10},copyButton:{padding:5}}),oi=()=>{const e=(0,j.useNavigation)(),{is_prototype:t,screenWidth:o}=(0,a.useContext)(p.AuthContext),[n,l]=(0,Q.useForm)("mkgobpro"),[d,c]=(0,a.useState)(""),[u,m]=(0,a.useState)(""),[g,h]=(0,a.useState)(""),[y,b]=(0,a.useState)(""),[x,w]=(0,a.useState)(""),[C,v]=(0,a.useState)([]),[B,k]=(0,a.useState)(""),[_,A]=(0,a.useState)(""),[I,D]=(0,a.useState)(""),[M,R]=(0,a.useState)(!1),[P,z]=(0,a.useState)(!1),[F,L]=(0,a.useState)(!1),[O,E]=(0,a.useState)(""),[W,N]=(0,a.useState)(!1),[U,V]=(0,a.useState)(""),[Y,G]=(0,a.useState)(""),[J,$]=(0,a.useState)(""),[Z,K]=(0,a.useState)(""),[X,ee]=(0,a.useState)(""),[te,oe]=(0,a.useState)(""),[ae,ne]=(0,a.useState)(""),re="100%",ie=()=>{e.navigate("SignUp")},se=async()=>{try{await Xr.default.setString("https://crittrcove.com/waitlist"),alert("Link copied to clipboard!")}catch(e){console.error("Failed to copy link:",e)}};return n.succeeded?(0,T.jsxs)(jt,{fullWidthHeader:!0,contentWidth:re,children:[(0,T.jsx)(bt,{title:"Join Waitlist",onBackPress:ie}),(0,T.jsx)(H.default,{style:ti.scrollView,contentContainerStyle:ti.scrollViewContent,children:(0,T.jsx)(ei,{children:(0,T.jsx)(r.default,{style:ti.container,children:(0,T.jsxs)(r.default,{style:ti.contentWrapper,children:[(0,T.jsx)(i.default,{style:[ti.title,{color:f.theme.colors.primary}],children:"Thank you for joining the CrittrCove waitlist!"}),(0,T.jsx)(i.default,{style:ti.successMessage,children:"As a waitlist member, you'll enjoy exclusive early access to the app, priority placement, special gifts, and a unique profile badge to highlight your role as a founding member of CrittrCove."}),(0,T.jsxs)(r.default,{style:ti.referralSection,children:[(0,T.jsx)(i.default,{style:[ti.title,{fontSize:f.theme.fontSizes.large,marginTop:20}],children:"Want Another Custom Pet Sticker? \ud83c\udf81"}),(0,T.jsx)(i.default,{style:ti.successMessage,children:"Share CrittrCove with your pet-loving friends! When they join the waitlist using this link:"}),(0,T.jsxs)(r.default,{style:ti.linkContainer,children:[(0,T.jsx)(i.default,{style:ti.link,children:"https://crittrcove.com/waitlist"}),(0,T.jsx)(s.default,{onPress:se,style:ti.copyButton,children:(0,T.jsx)(S.default,{name:"content-copy",size:20,color:f.theme.colors.primary})})]}),(0,T.jsx)(i.default,{style:ti.successMessage,children:"and mention your name, we'll send you another custom sticker featuring your pet. It's our way of saying thank you for helping grow our community!"}),(0,T.jsx)(i.default,{style:[ti.successMessage,{fontStyle:"italic"}],children:"Simply tell your friends to mention your name when they sign up, and we'll take care of the rest."})]}),(0,T.jsx)(i.default,{style:ti.successMessage,children:"Stay tuned for exciting updates!"})]})})})})]}):(0,T.jsxs)(jt,{fullWidthHeader:!0,contentWidth:re,children:[(0,T.jsx)(bt,{title:"Join Waitlist",onBackPress:ie}),(0,T.jsx)(H.default,{style:ti.scrollView,contentContainerStyle:ti.scrollViewContent,children:(0,T.jsx)(ei,{children:(0,T.jsx)(r.default,{style:ti.container,children:(0,T.jsxs)(r.default,{style:ti.contentWrapper,children:[(0,T.jsx)(i.default,{style:ti.title,children:"Join the CrittrCove Waitlist!"}),(0,T.jsx)(i.default,{style:ti.description,children:"Welcome to Critter Cove's early sign-up, the ultimate pet care marketplace for all pets\u2014whether furry, feathery, or scaly! Our app connects local pet care specialists with pet owners, offering reliable and loving care for your beloved companions."}),(0,T.jsx)(i.default,{style:ti.description,children:"By joining our waitlist, you'll gain early access to exclusive features, special gifts, education, discounts, a custom sticker featuring your pet (if you so wish), and a profile badge as a founding member of the Critter Cove community."}),(0,T.jsxs)(i.default,{style:ti.requiredFieldNote,children:[(0,T.jsx)(i.default,{style:ti.requiredAsterisk,children:"*"})," indicates required field"]}),(0,T.jsxs)(r.default,{style:ti.formSection,children:[(0,T.jsxs)(r.default,{style:ti.nameContainer,children:[(0,T.jsxs)(r.default,{style:ti.nameField,children:[(0,T.jsxs)(i.default,{style:ti.label,children:["First Name ",(0,T.jsx)(i.default,{style:ti.requiredAsterisk,children:"*"})]}),(0,T.jsx)(q.default,{style:ti.input,value:d,onChangeText:c,placeholder:"First Name"})]}),(0,T.jsxs)(r.default,{style:ti.nameField,children:[(0,T.jsxs)(i.default,{style:ti.label,children:["Last Name ",(0,T.jsx)(i.default,{style:ti.requiredAsterisk,children:"*"})]}),(0,T.jsx)(q.default,{style:ti.input,value:u,onChangeText:m,placeholder:"Last Name"})]})]}),(0,T.jsxs)(i.default,{style:ti.label,children:["Email ",(0,T.jsx)(i.default,{style:ti.requiredAsterisk,children:"*"})]}),(0,T.jsx)(q.default,{style:ti.input,value:g,onChangeText:h,placeholder:"Email",keyboardType:"email-address",autoCapitalize:"none"}),(0,T.jsxs)(i.default,{style:ti.label,children:["Phone Number ",(0,T.jsx)(i.default,{style:ti.requiredAsterisk,children:"*"})]}),(0,T.jsx)(q.default,{style:ti.input,value:y,onChangeText:b,placeholder:"Phone Number",keyboardType:"phone-pad"}),(0,T.jsxs)(i.default,{style:ti.label,children:["Do you currently own pets? If yes, tell us all about them! ",(0,T.jsx)(i.default,{style:ti.requiredAsterisk,children:"*"})]}),(0,T.jsx)(q.default,{style:[ti.input,ti.textArea],value:x,onChangeText:w,placeholder:"Tell us about your pets",multiline:!0,numberOfLines:4}),(0,T.jsxs)(i.default,{style:ti.label,children:["What kind of pet care services are you most interested in? ",(0,T.jsx)(i.default,{style:ti.requiredAsterisk,children:"*"})]}),(0,T.jsx)(r.default,{style:ti.checkboxGroup,children:["Pet Sitting","Grooming","Training","Veterinary Services","Farm/Homestead Care","Care Consulting","Other"].map((e=>(0,T.jsxs)(r.default,{children:[(0,T.jsxs)(s.default,{style:ti.checkboxContainer,onPress:()=>(e=>{v((t=>("Other"===e&&N(!t.includes("Other")),t.includes(e)?t.filter((t=>t!==e)):[...t,e])))})(e),children:[(0,T.jsx)(S.default,{name:C.includes(e)?"checkbox-marked":"checkbox-blank-outline",size:24,color:f.theme.colors.primary,style:ti.checkboxIcon}),(0,T.jsx)(i.default,{style:ti.checkboxLabel,children:e})]}),"Other"===e&&C.includes("Other")&&(0,T.jsx)(r.default,{style:ti.otherInputContainer,children:(0,T.jsx)(q.default,{style:[ti.input,ti.otherInput],value:O,onChangeText:E,placeholder:"Please specify other service"})})]},e)))}),(0,T.jsxs)(i.default,{style:ti.label,children:["Are you signing up as a: ",(0,T.jsx)(i.default,{style:ti.requiredAsterisk,children:"*"})]}),(0,T.jsx)(r.default,{style:ti.radioGroup,children:["Pet owner in need of services","Care specialist (sitter, groomer, ferrier, fish tank cleaner, etc)","Both"].map((e=>(0,T.jsxs)(s.default,{style:ti.radioContainer,onPress:()=>k(e),children:[(0,T.jsx)(r.default,{style:[ti.radio,B===e&&ti.radioSelected]}),(0,T.jsx)(i.default,{style:ti.radioLabel,children:e})]},e)))}),(0,T.jsxs)(i.default,{style:ti.label,children:["Where did you hear about us? ",(0,T.jsx)(i.default,{style:ti.requiredAsterisk,children:"*"})]}),(0,T.jsx)(r.default,{style:ti.radioGroup,children:["Nextdoor","Reddit","Google","Other - Enter name of Person who referred you or other referral source for a free sticker"].map((e=>(0,T.jsxs)(s.default,{style:ti.radioContainer,onPress:()=>oe(e),children:[(0,T.jsx)(r.default,{style:[ti.radio,te===e&&ti.radioSelected]}),(0,T.jsx)(i.default,{style:ti.radioLabel,children:e})]},e)))}),"Other - Enter name of Person who referred you or other referral source for a free sticker"===te&&(0,T.jsx)(q.default,{style:ti.input,value:ae,onChangeText:ne,placeholder:"Please specify where you heard about us"}),(0,T.jsxs)(i.default,{style:ti.label,children:["What hesitations do you have about using an app to connect you to local pet care? ",(0,T.jsx)(i.default,{style:ti.optional,children:"(Optional)"})]}),(0,T.jsx)(q.default,{style:[ti.input,ti.textArea],value:_,onChangeText:A,placeholder:"Share your concerns",multiline:!0,numberOfLines:4}),(0,T.jsxs)(i.default,{style:ti.label,children:["What features or tools would make Critter Cove perfect for you? ",(0,T.jsx)(i.default,{style:ti.optional,children:"(Optional)"})]}),(0,T.jsx)(q.default,{style:[ti.input,ti.textArea],value:I,onChangeText:D,placeholder:"Share your ideas",multiline:!0,numberOfLines:4}),(0,T.jsxs)(r.default,{style:ti.addressSection,children:[(0,T.jsxs)(i.default,{style:ti.label,children:["Mailing Address ",(0,T.jsx)(i.default,{style:ti.optional,children:"(Optional)"})]}),(0,T.jsxs)(i.default,{style:ti.addressNote,children:["\ud83c\udf81 ",(0,T.jsx)(i.default,{style:{fontStyle:"italic"},children:" Want a custom sticker featuring your pet? Add your mailing address and we'll send you one for joining the waitlist!"})]}),(0,T.jsx)(q.default,{style:ti.input,value:U,onChangeText:V,placeholder:"Street Address"}),(0,T.jsx)(q.default,{style:ti.input,value:Y,onChangeText:G,placeholder:"Apartment/Unit # (if applicable)"}),(0,T.jsxs)(r.default,{style:ti.cityStateContainer,children:[(0,T.jsx)(q.default,{style:[ti.input,ti.cityInput],value:J,onChangeText:$,placeholder:"City"}),(0,T.jsx)(q.default,{style:[ti.input,ti.stateInput],value:Z,onChangeText:K,placeholder:"State",maxLength:2,autoCapitalize:"characters"}),(0,T.jsx)(q.default,{style:[ti.input,ti.zipInput],value:X,onChangeText:ee,placeholder:"ZIP",keyboardType:"numeric",maxLength:5})]})]}),(0,T.jsxs)(i.default,{style:ti.label,children:["Would you like to be added to the email newsletter for updates on the app, pet care tips, discounts and more? ",(0,T.jsx)(i.default,{style:ti.optional,children:"(Optional)"})]}),(0,T.jsxs)(r.default,{style:ti.buttonContainer,children:[(0,T.jsx)(s.default,{style:[ti.button,M&&ti.buttonSelected],onPress:()=>R(!0),children:(0,T.jsx)(i.default,{style:[ti.buttonText,M&&ti.buttonTextSelected],children:"Yes"})}),(0,T.jsx)(s.default,{style:[ti.button,!M&&ti.buttonSelected],onPress:()=>R(!1),children:(0,T.jsx)(i.default,{style:[ti.buttonText,!M&&ti.buttonTextSelected],children:"No"})})]}),(0,T.jsxs)(i.default,{style:ti.label,children:["I agree to the terms and conditions and understand my data will be used to improve the app experience. ",(0,T.jsx)(i.default,{style:ti.requiredAsterisk,children:"*"})]}),(0,T.jsxs)(r.default,{style:ti.buttonContainer,children:[(0,T.jsx)(s.default,{style:[ti.button,P&&ti.buttonSelected],onPress:()=>z(!0),children:(0,T.jsx)(i.default,{style:[ti.buttonText,P&&ti.buttonTextSelected],children:"Yes"})}),(0,T.jsx)(s.default,{style:[ti.button,!P&&ti.buttonSelected],onPress:()=>z(!1),children:(0,T.jsx)(i.default,{style:[ti.buttonText,!P&&ti.buttonTextSelected],children:"No"})})]}),(0,T.jsx)(s.default,{style:[ti.submitButton,(F||!P)&&ti.disabledButton],onPress:async e=>{if(e.preventDefault(),g&&d&&u&&y&&x&&0!==C.length&&B&&P&&te){L(!0);try{const e={firstName:d,lastName:u,email:g,phone:y,petInfo:x,services:C.includes("Other")?[...C.filter((e=>"Other"!==e)),"Other: ".concat(O)]:C,userType:B,hesitations:_,desiredFeatures:I,newsletter:M,agreeToTerms:P,referralSource:"Other"===te?"Other: ".concat(ae):te,address:U?{street:U,apt_unit:Y,city:J,state:Z,zip_code:X}:null};await l(e),n.succeeded&&(c(""),m(""),h(""),b(""),w(""),v([]),E(""),N(!1),k(""),A(""),D(""),R(!1),z(!1),V(""),G(""),$(""),K(""),ee(""),oe(""),ne(""))}catch(t){console.error("Error submitting form:",t)}finally{L(!1)}}else alert("Please fill in all required fields")},disabled:F||!P,children:(0,T.jsx)(i.default,{style:ti.submitButtonText,children:F?"Submitting...":"Join Waitlist"})})]})]})})})})]})};var ai=o(58180);const ni=l.default.create({container:{flex:1,justifyContent:"center",alignItems:"center",padding:20,backgroundColor:f.theme.colors.background},title:{fontSize:24,fontWeight:"bold",marginBottom:30,color:f.theme.colors.text,fontFamily:f.theme.fonts?.medium?.fontFamily||void 0},buttonContainer:{width:"100%",marginVertical:10,maxWidth:300}}),ri=()=>{const e=E();return(0,T.jsxs)(r.default,{style:ni.container,children:[(0,T.jsx)(i.default,{style:ni.title,children:"Toast Notification Test"}),(0,T.jsx)(r.default,{style:ni.buttonContainer,children:(0,T.jsx)(ai.default,{title:"Show Success Toast",onPress:()=>{e({message:"Success! Operation completed successfully.",type:"success",duration:3e3})},color:f.theme.colors.primary})}),(0,T.jsx)(r.default,{style:ni.buttonContainer,children:(0,T.jsx)(ai.default,{title:"Show Error Toast",onPress:()=>{e({message:"Error! Something went wrong.",type:"error",duration:3e3})},color:f.theme.colors.error})}),(0,T.jsx)(r.default,{style:ni.buttonContainer,children:(0,T.jsx)(ai.default,{title:"Show Info Toast",onPress:()=>{e({message:"Info: This is an informational message.",type:"info",duration:3e3})},color:f.theme.colors.info||"#29B6F6"})}),(0,T.jsx)(r.default,{style:ni.buttonContainer,children:(0,T.jsx)(ai.default,{title:"Show Warning Toast",onPress:()=>{e({message:"Warning: This action may have consequences.",type:"warning",duration:3e3})},color:f.theme.colors.warning||"#FFA726"})}),(0,T.jsx)(r.default,{style:ni.buttonContainer,children:(0,T.jsx)(ai.default,{title:"Show Long Toast",onPress:()=>{e({message:"This is a longer toast message that will stay visible for 5 seconds to demonstrate how longer messages look.",type:"info",duration:5e3})},color:"#9C27B0"})})]})},ii=l.default.create({card:{backgroundColor:f.theme.colors.surfaceContrast,borderRadius:8,padding:16,elevation:2,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,width:"100%"},contentContainer:{width:"100%"},topRow:{flexDirection:"row",justifyContent:"space-between",alignItems:"flex-start",width:"100%",flexWrap:"wrap"},profileInfo:{flexDirection:"row",alignItems:"center",flex:1,minWidth:0},profileInfoWrap:{flexDirection:"row",alignItems:"center",flex:1,minWidth:"70%"},avatar:{width:60,height:60,borderRadius:30,marginRight:16,flexShrink:0},nameContainer:{flex:1,justifyContent:"center",minWidth:0,marginRight:16},nameContainerWide:{maxWidth:"60%"},name:{fontSize:18,fontWeight:"600",color:f.theme.colors.text,fontFamily:f.theme.fonts.header.fontFamily,marginBottom:8},petsContainer:{flexDirection:"row",flexWrap:"wrap",alignItems:"center",marginBottom:8},petsLabel:{fontSize:14,fontWeight:"600",color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily,flexShrink:0},petsText:{fontSize:14,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily,flex:1,minWidth:0},petsTextWide:{maxWidth:"80%",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},servicesContainer:{flexDirection:"row",flexWrap:"wrap",alignItems:"center",marginBottom:8},servicesLabel:{fontSize:14,fontWeight:"600",color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily,flexShrink:0},servicesText:{fontSize:14,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily,flex:1,minWidth:0},servicesTextWide:{maxWidth:"80%",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},statusSection:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingVertical:8,marginTop:8},lastBookingContainer:{flexDirection:"row",alignItems:"center"},lastBookingText:{marginLeft:6,fontSize:14,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily},noBookingsContainer:{flexDirection:"row",alignItems:"center",backgroundColor:"#F2F2F0",borderRadius:4,padding:4,marginTop:8,alignSelf:"flex-start"},noBookingsText:{fontSize:12,color:"#898974",fontFamily:f.theme.fonts.regular.fontFamily,marginLeft:6},pastBookingsContainer:{flexDirection:"row",alignItems:"center",backgroundColor:"#F9F2FC",borderRadius:4,padding:4,marginTop:8,alignSelf:"flex-start"},pastBookingsText:{marginLeft:6,fontSize:12,color:"#9C27B0",fontFamily:f.theme.fonts.regular.fontFamily},upcomingContainer:{flexDirection:"row",alignItems:"center",backgroundColor:"#F0F9E5",padding:6,borderRadius:16},upcomingText:{marginLeft:6,fontSize:14,color:f.theme.colors.primary,fontFamily:f.theme.fonts.regular.fontFamily,fontWeight:"500"},buttonSection:{flexDirection:"row",gap:12,alignItems:"center",justifyContent:"flex-end",flexShrink:0},buttonSectionWrap:{marginTop:12,marginLeft:"auto"},mobileBtnSection:{flexDirection:"row",justifyContent:"flex-end",gap:12,marginTop:12},viewProfileButton:{paddingVertical:8,paddingHorizontal:16,backgroundColor:"#F0F9E5",borderRadius:6,alignItems:"center",justifyContent:"center",transition:"transform 0.2s ease, box-shadow 0.2s ease"},viewProfileText:{color:f.theme.colors.primary,fontSize:14,fontWeight:"600",fontFamily:f.theme.fonts.regular.fontFamily},createBookingButton:{paddingVertical:8,paddingHorizontal:16,backgroundColor:f.theme.colors.primary,borderRadius:6,alignItems:"center",justifyContent:"center",transition:"transform 0.2s ease, box-shadow 0.2s ease"},createBookingText:{color:f.theme.colors.surfaceContrast,fontSize:14,fontWeight:"600",fontFamily:f.theme.fonts.regular.fontFamily},buttonHovered:{transform:[{translateY:-3}],boxShadow:"0px 6px 10px rgba(0, 0, 0, 0.15)"},activeBookingsContainer:{flexDirection:"row",alignItems:"center",backgroundColor:"#F0F9E5",borderRadius:4,padding:4,marginTop:8,alignSelf:"flex-start"},activeBookingsText:{marginLeft:6,fontSize:12,color:"#4CAF50",fontFamily:f.theme.fonts.regular.fontFamily}}),si=({connection:e,type:t,onViewProfile:n,onCreateBooking:l})=>{const d="clients"===t,{screenWidth:c}=(0,a.useContext)(p.AuthContext),u=c<900,m=c>=1200,g=c>=2500,[h,y]=(0,a.useState)(!1),[b,x]=(0,a.useState)(!1),j=e.active_bookings_count>0?{icon:"calendar-check",iconColor:"#4CAF50",text:"Active Bookings",containerStyle:ii.activeBookingsContainer,textStyle:ii.activeBookingsText}:1===e.has_past_booking?{icon:"history",iconColor:"#9C27B0",text:"Past Bookings",containerStyle:ii.pastBookingsContainer,textStyle:ii.pastBookingsText}:{icon:"calendar-remove",iconColor:"#898974",text:"No Bookings Yet",containerStyle:ii.noBookingsContainer,textStyle:ii.noBookingsText};return(0,p.debugLog)("MBA9452: Rendering ConnectionCard:",{connectionId:e.id,connectionName:e.name,connectionType:t,conversationId:e.conversation_id,hasActivePastBooking:e.has_past_booking,activeBookingsCount:e.active_bookings_count,isMobile:u,isWideScreen:m,isExtraWideScreen:g,screenWidth:c}),(0,T.jsx)(r.default,{style:ii.card,children:(0,T.jsxs)(r.default,{style:ii.contentContainer,children:[(0,T.jsxs)(r.default,{style:ii.topRow,children:[(0,T.jsxs)(r.default,{style:[ii.profileInfo,!g&&ii.profileInfoWrap],children:[(0,T.jsx)(U.default,{source:e.avatar?{uri:e.avatar}:o(4456),style:ii.avatar}),(0,T.jsxs)(r.default,{style:[ii.nameContainer,m&&ii.nameContainerWide],children:[(0,T.jsx)(i.default,{style:ii.name,children:e.name}),d?(0,T.jsxs)(r.default,{style:ii.petsContainer,children:[(0,T.jsx)(i.default,{style:ii.petsLabel,children:"Pets: "}),(0,T.jsx)(i.default,{style:[ii.petsText,m&&ii.petsTextWide],children:e.pets?.length>0?e.pets.map((e=>"".concat(e.name," (").concat(e.species,")"))).join(", "):"No pets added yet"})]}):(0,T.jsxs)(r.default,{style:ii.servicesContainer,children:[(0,T.jsx)(i.default,{style:ii.servicesLabel,children:"Services: "}),(0,T.jsx)(i.default,{style:[ii.servicesText,m&&ii.servicesTextWide],children:e.services?.join(", ")||"No services"})]}),(0,T.jsxs)(r.default,{style:j.containerStyle,children:[(0,T.jsx)(S.default,{name:j.icon,size:14,color:j.iconColor}),(0,T.jsx)(i.default,{style:j.textStyle,children:j.text})]})]})]}),!u&&(0,T.jsxs)(r.default,{style:[ii.buttonSection,!g&&ii.buttonSectionWrap],children:[(0,T.jsx)(s.default,{style:[ii.viewProfileButton,h&&ii.buttonHovered],onPress:()=>{(0,p.debugLog)("MBA4321 View Messages button clicked",{connectionName:e.name,conversationId:e.conversation_id}),n(e)},onMouseEnter:()=>y(!0),onMouseLeave:()=>y(!1),children:(0,T.jsx)(i.default,{style:ii.viewProfileText,children:"View Messages"})}),d&&(0,T.jsx)(s.default,{style:[ii.createBookingButton,b&&ii.buttonHovered],onPress:()=>{(0,p.debugLog)("MBA4321 Create Booking button clicked",{connectionName:e.name,conversationId:e.conversation_id}),l(e)},onMouseEnter:()=>x(!0),onMouseLeave:()=>x(!1),children:(0,T.jsx)(i.default,{style:ii.createBookingText,children:"Create Booking"})})]})]}),e.last_booking&&(0,T.jsxs)(r.default,{style:ii.statusSection,children:[(0,T.jsxs)(r.default,{style:ii.lastBookingContainer,children:[(0,T.jsx)(S.default,{name:"calendar-clock",size:16,color:f.theme.colors.text}),(0,T.jsxs)(i.default,{style:ii.lastBookingText,children:["Last booking: ",e.last_booking]})]}),e.upcoming_booking&&(0,T.jsxs)(r.default,{style:ii.upcomingContainer,children:[(0,T.jsx)(S.default,{name:"calendar-check",size:16,color:f.theme.colors.primary}),(0,T.jsx)(i.default,{style:ii.upcomingText,children:"Upcoming Booking"})]})]}),u&&(0,T.jsxs)(r.default,{style:ii.mobileBtnSection,children:[(0,T.jsx)(s.default,{style:[ii.viewProfileButton,h&&ii.buttonHovered],onPress:()=>{(0,p.debugLog)("MBA4321 View Messages button clicked (mobile)",{connectionName:e.name,conversationId:e.conversation_id}),n(e)},onMouseEnter:()=>y(!0),onMouseLeave:()=>y(!1),children:(0,T.jsx)(i.default,{style:ii.viewProfileText,children:"View Messages"})}),d&&(0,T.jsx)(s.default,{style:[ii.createBookingButton,b&&ii.buttonHovered],onPress:()=>{(0,p.debugLog)("MBA4321 Create Booking button clicked (mobile)",{connectionName:e.name,conversationId:e.conversation_id}),l(e)},onMouseEnter:()=>x(!0),onMouseLeave:()=>x(!1),children:(0,T.jsx)(i.default,{style:ii.createBookingText,children:"Create Booking"})})]})]})})},li=l.default.create({container:{flex:1,height:"100vh",backgroundColor:f.theme.colors.surface,position:"fixed",top:0,right:0,bottom:0,left:0,overflow:"hidden",transition:"margin-left 0.3s ease"},content:{flex:1,height:"100%",overflow:"auto"},mainContent:{flex:1,width:"100%",alignSelf:"center",backgroundColor:f.theme.colors.background,position:"relative"},headerSection:{width:"100%",backgroundColor:f.theme.colors.surfaceContrast,paddingHorizontal:24,paddingTop:24,zIndex:2},connectionsContent:{flex:1,backgroundColor:f.theme.colors.surface,position:"relative"},title:{fontSize:32,fontWeight:"600",color:f.theme.colors.text,marginBottom:24,fontFamily:f.theme.fonts.header.fontFamily},tabContainer:{flexDirection:"row",gap:32},tab:{paddingBottom:8,borderBottomWidth:2,borderBottomColor:"transparent"},activeTab:{borderBottomColor:f.theme.colors.primary},tabText:{fontSize:16,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily},activeTabText:{color:f.theme.colors.primary,fontWeight:"500"},stickyHeader:{position:"absolute",top:0,left:0,right:0,backgroundColor:f.theme.colors.surfaceContrast,zIndex:2,marginHorizontal:24,marginTop:24,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,borderRadius:8,padding:16},stickyHeaderContent:{width:"100%",gap:16},searchAndInviteContainer:{flexDirection:"row",alignItems:"center",gap:12},searchContainer:{flex:1,flexDirection:"row",alignItems:"center",backgroundColor:f.theme.colors.surfaceContrast,borderRadius:8,padding:12,borderWidth:1,borderColor:"#CCCBC9",minHeight:48},searchContainerFocused:{borderColor:f.theme.colors.primary,borderWidth:2,shadowColor:f.theme.colors.primary,shadowOffset:{width:0,height:0},shadowOpacity:.1,shadowRadius:4},searchInput:Object.assign({flex:1,color:"#666",fontSize:16,marginLeft:8,fontFamily:f.theme.fonts.regular.fontFamily,outlineStyle:"none",outlineWidth:0,WebkitAppearance:"none",padding:0,minHeight:24},"web"===n.default.OS&&{caretColor:f.theme.colors.primary}),inviteButtonSmall:Object.assign({flexDirection:"row",alignItems:"center",paddingVertical:10,paddingHorizontal:12,borderRadius:8,backgroundColor:f.theme.colors.primary,gap:6},"web"===n.default.OS&&{transition:"all 0.2s ease",cursor:"pointer"}),inviteButtonSmallText:{color:f.theme.colors.surface,fontSize:14,fontWeight:"600",fontFamily:f.theme.fonts.regular.fontFamily},filtersWrapper:{flexDirection:"row",justifyContent:"flex-end",marginRight:-16},filterScrollContent:{flexGrow:0},filterContainer:{flexDirection:"row",gap:8,backgroundColor:f.theme.colors.surfaceContrast,paddingVertical:8,paddingLeft:4,paddingRight:16},filterButton:Object.assign({paddingHorizontal:12,paddingVertical:6,borderRadius:16,justifyContent:"center"},"web"===n.default.OS&&{transition:"all 0.2s ease-in-out",cursor:"pointer"}),filterButtonHovered:{transform:[{scale:1.05}],shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:5},filterContent:{flexDirection:"row",alignItems:"center",justifyContent:"center",gap:6},checkmark:{marginLeft:4},allButton:{backgroundColor:"#EFF9FF"},allButtonText:{color:"#0784C6"},activeBookingsButton:{backgroundColor:"#E8F5E9"},activeBookingsButtonText:{color:"#4CAF50"},noBookingsButton:{backgroundColor:"#E8E9E2"},noBookingsButtonText:{color:"#898974"},pastBookingsButton:{backgroundColor:"#F3E5F5"},pastBookingsButtonText:{color:"#9C27B0"},filterText:{fontSize:14,fontFamily:f.theme.fonts.regular.fontFamily,textAlign:"center"},listHeaderSpacing:{paddingTop:16},listContainer:{paddingHorizontal:24,paddingBottom:34,alignItems:"stretch",width:"100%"},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center"},loadingMoreContainer:{paddingVertical:16,alignItems:"center"},emptyContainer:{flex:1,justifyContent:"center",alignItems:"center",paddingHorizontal:24},emptyText:{fontSize:16,color:f.theme.colors.placeholder,textAlign:"center",marginTop:8,marginBottom:24,fontFamily:f.theme.fonts.regular.fontFamily},inviteButton:{backgroundColor:f.theme.colors.primary,paddingHorizontal:24,paddingVertical:12,borderRadius:8,marginTop:8},inviteButtonText:{color:f.theme.colors.surface,fontSize:16,fontWeight:"600",fontFamily:f.theme.fonts.regular.fontFamily},footer:{paddingVertical:16,alignItems:"center",justifyContent:"center",width:"100%"},footerText:{color:f.theme.colors.placeholder,fontSize:16,fontFamily:f.theme.fonts.regular.fontFamily,textAlign:"center",marginBottom:12},createServiceButton:Object.assign({paddingVertical:10,paddingHorizontal:16,backgroundColor:f.theme.colors.primary,borderRadius:8,marginTop:8},"web"===n.default.OS&&{transition:"all 0.2s ease",cursor:"pointer"}),createServiceButtonText:{color:f.theme.colors.surface,fontSize:16,fontWeight:"600",fontFamily:f.theme.fonts.regular.fontFamily},modalOverlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center"},modalContent:{backgroundColor:f.theme.colors.surface,borderRadius:12,padding:24,width:"90%",maxWidth:500,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:4,elevation:5},modalHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16},modalTitle:{fontSize:20,fontWeight:"600",color:f.theme.colors.text,fontFamily:f.theme.fonts.header.fontFamily},closeButton:{padding:4},modalText:{fontSize:16,color:f.theme.colors.text,marginBottom:24,fontFamily:f.theme.fonts.regular.fontFamily,lineHeight:24},inviteTypeToggle:{flexDirection:"row",gap:12,marginBottom:24},inviteTypeButton:Object.assign({flex:1,padding:12,borderWidth:1,borderColor:"#CCCBC9",borderRadius:8,flexDirection:"row",alignItems:"center",justifyContent:"center",gap:6},"web"===n.default.OS&&{cursor:"pointer"}),inviteTypeButtonActive:{borderColor:f.theme.colors.primary,backgroundColor:"rgba(7, 132, 198, 0.05)"},inviteTypeText:{fontSize:16,color:"#666",fontFamily:f.theme.fonts.regular.fontFamily},inviteTypeTextActive:{color:f.theme.colors.primary,fontWeight:"500"},inputContainer:{marginBottom:24},inputLabel:{fontSize:16,fontWeight:"500",color:f.theme.colors.text,marginBottom:8,fontFamily:f.theme.fonts.regular.fontFamily},emailInput:{borderWidth:1,borderColor:"#CCCBC9",borderRadius:8,padding:12,fontSize:16,fontFamily:f.theme.fonts.regular.fontFamily},linkContainer:{marginBottom:24},generatedLinkContainer:{flexDirection:"row",alignItems:"center",gap:12,padding:12,borderWidth:1,borderColor:"#CCCBC9",borderRadius:8,backgroundColor:"rgba(0, 0, 0, 0.02)"},generatedLink:{flex:1,color:f.theme.colors.text,fontSize:16,fontFamily:f.theme.fonts.regular.fontFamily},copyButton:Object.assign({padding:8},"web"===n.default.OS&&{cursor:"pointer"}),errorText:{color:f.theme.colors.error||"#D32F2F",fontSize:16,marginBottom:16,fontFamily:f.theme.fonts.regular.fontFamily},successText:{color:f.theme.colors.success||"#4CAF50",fontSize:16,marginBottom:16,fontFamily:f.theme.fonts.regular.fontFamily},modalButtons:{flexDirection:"row",justifyContent:"flex-end",gap:12,marginTop:8},cancelButton:Object.assign({paddingVertical:10,paddingHorizontal:16,borderRadius:8,borderWidth:1,borderColor:"#CCCBC9",backgroundColor:f.theme.colors.surface},"web"===n.default.OS&&{cursor:"pointer"}),cancelButtonText:{color:f.theme.colors.text,fontSize:16,fontWeight:"500",fontFamily:f.theme.fonts.regular.fontFamily},sendInviteButton:Object.assign({paddingVertical:10,paddingHorizontal:16,borderRadius:8,backgroundColor:f.theme.colors.primary,minWidth:140,alignItems:"center",justifyContent:"center"},"web"===n.default.OS&&{cursor:"pointer"}),sendInviteButtonText:{color:f.theme.colors.surface,fontSize:16,fontWeight:"600",fontFamily:f.theme.fonts.regular.fontFamily},disabledButton:Object.assign({backgroundColor:"#CCCCCC",opacity:.7},"web"===n.default.OS&&{cursor:"not-allowed"}),columnWrapper:{flexWrap:"wrap",justifyContent:"space-between",gap:16,width:"100%"},cardWrapper:{flex:1,width:"100%",marginBottom:16},mobileCardWrapper:{maxWidth:"100%"},wideScreenCardWrapper:{maxWidth:"calc(50% - 11px)"},buttonHovered:{transform:[{translateY:-3}],shadowColor:"#000",shadowOffset:{width:0,height:6},shadowOpacity:.15,shadowRadius:10,elevation:5}}),di=()=>{const e=(0,j.useNavigation)(),{isApprovedProfessional:t,userRole:o,isCollapsed:l,screenWidth:d}=(0,a.useContext)(p.AuthContext),[c,u]=(0,a.useState)(d<900),[m,g]=(0,a.useState)(d>=1500),[y,b]=(0,a.useState)("clients"),[w,C]=(0,a.useState)(""),[B,k]=(0,a.useState)([]),[I,D]=(0,a.useState)(!0),[M,R]=(0,a.useState)(null),[P,z]=(0,a.useState)(1),[F,L]=(0,a.useState)(!0),[O,E]=(0,a.useState)(!1),[W,N]=(0,a.useState)("all"),[U,V]=(0,a.useState)(null),[Y,G]=(0,a.useState)(!1),[J,$]=(0,a.useState)(""),[Z,K]=(0,a.useState)(!1),[Q,X]=(0,a.useState)(!1),ee=(0,a.useRef)(null),[te,oe]=(0,a.useState)([]),[ae,ne]=(0,a.useState)("email"),[re,ie]=(0,a.useState)(""),[se,le]=(0,a.useState)(""),[de,ce]=(0,a.useState)(""),[ue,me]=(0,a.useState)(!1),[ge,he]=(0,a.useState)(!1);(0,a.useEffect)((()=>{const e=v.default.addEventListener("change",(()=>{u(v.default.get("window").width<900),g(v.default.get("window").width>=1200)}));return()=>{e?.remove()}}),[]),(0,a.useEffect)((()=>{b("professional"===o?"clients":"professionals")}),[o]),(0,a.useEffect)((()=>{(async()=>{(0,p.debugLog)("MBA4321 Checking user role for navigation",{userRole:o}),"petOwner"===o&&("web"===n.default.OS?(sessionStorage.setItem("previousRoute",""),sessionStorage.setItem("currentRoute","Dashboard")):(await x.default.setItem("previousRoute",""),await x.default.setItem("currentRoute","Dashboard")),(0,p.debugLog)("MBA4321 User is pet owner, navigating to Dashboard"),e.navigate("Dashboard"))})()}),[o,e]);const fe=async(e=1,t=!1)=>{D(!t),t&&E(!0),(0,p.debugLog)("MBA4321 Fetching connections:",{page:e,isLoadMore:t});try{const o=await(0,at.getUserConnections)(e);(0,p.debugLog)("MBA4321 Response from API:",o);const a=o.connections||[];if(t){const e=[...B,...a];k(e),oe(e)}else k(a),oe(a);L(20===a.length),z(e)}catch(M){(0,p.debugLog)("MBA4321 Error fetching connections:",M),R("Failed to fetch connections")}finally{D(!1),E(!1)}};(0,a.useEffect)((()=>{(0,p.debugLog)("MBA4321 Fetching connections due to dependency change:",{activeTab:y,userRole:o}),z(1),k([]),fe(1)}),[y,o]),(0,a.useEffect)((()=>{(0,p.debugLog)("MBA4321 Filtering connections locally based on:",{activeFilter:W}),te.length>0&&pe()}),[W,te]);const pe=()=>{if(!te.length)return;if((0,p.debugLog)("MBA9452: Filtering connections locally with filter:",W),"all"===W)return void k(te);let e=[];switch(W){case"active_bookings":e=te.filter((e=>e.active_bookings_count>0));break;case"no_bookings":e=te.filter((e=>0===e.active_bookings_count&&0===e.has_past_booking));break;case"past_bookings":e=te.filter((e=>0===e.active_bookings_count&&1===e.has_past_booking));break;default:e=te}k(e)},ye=()=>{(0,p.debugLog)("MBA4321 Opening invite client modal"),$(""),ie(""),le(""),ce(""),ne("email"),G(!0)};return(0,T.jsx)(r.default,{style:[li.container,{marginLeft:c?0:l?70:250}],children:(0,T.jsxs)(r.default,{style:[li.content,{marginTop:c?60:0}],children:[(0,T.jsxs)(r.default,{style:li.mainContent,children:[(0,T.jsxs)(r.default,{style:li.headerSection,children:[(0,T.jsx)(i.default,{style:li.title,children:"Connections"}),(0,T.jsx)(r.default,{style:li.tabContainer,children:"professional"===o&&(0,T.jsx)(s.default,{style:[li.tab,"clients"===y&&li.activeTab],onPress:()=>b("clients"),children:(0,T.jsx)(i.default,{style:[li.tabText,"clients"===y&&li.activeTabText],children:"My Clients"})})})]}),(0,T.jsx)(r.default,{style:li.connectionsContent,children:I?(0,T.jsx)(r.default,{style:li.loadingContainer,children:(0,T.jsx)(A.default,{size:"large",color:f.theme.colors.primary})}):(0,T.jsxs)(r.default,{style:li.connectionsContent,children:[(0,T.jsx)(r.default,{style:li.stickyHeader,children:(0,T.jsxs)(r.default,{style:[li.stickyHeaderContent,{flexDirection:m?"row":"column"}],children:[(0,T.jsxs)(r.default,{style:[li.searchAndInviteContainer,m?{flex:.4,marginRight:"auto",flexDirection:"row",alignItems:"center"}:{flexDirection:"row",alignItems:"center"}],children:[(0,T.jsxs)(r.default,{style:[li.searchContainer,Q&&li.searchContainerFocused],children:[(0,T.jsx)(S.default,{name:"magnify",size:24,color:Q?f.theme.colors.primary:"#666"}),(0,T.jsx)(q.default,{ref:ee,style:li.searchInput,placeholder:"clients"===y?"Search by client name or pet":"Search by professional name or service",value:w,onChangeText:e=>{if(C(e),!e.trim())return(0,p.debugLog)("MBA9452: Empty search query, reapplying current filter"),void pe();(0,p.debugLog)("MBA9452: Searching connections with query:",e);let t=[];if("all"===W)t=te;else switch(W){case"active_bookings":t=te.filter((e=>e.active_bookings_count>0));break;case"no_bookings":t=te.filter((e=>0===e.active_bookings_count&&0===e.has_past_booking));break;case"past_bookings":t=te.filter((e=>0===e.active_bookings_count&&1===e.has_past_booking));break;default:t=te}const o=e.toLowerCase(),a=t.filter((e=>e.name.toLowerCase().includes(o)||"clients"===y&&e.pets?.some((e=>e.name?.toLowerCase().includes(o)||e.species?.toLowerCase().includes(o)))));k(a)},onFocus:()=>X(!0),onBlur:()=>X(!1)}),w?(0,T.jsx)(s.default,{onPress:()=>{C(""),pe()},children:(0,T.jsx)(S.default,{name:"close-circle",size:20,color:"#777"})}):null]}),"clients"===y&&"professional"===o&&(0,T.jsxs)(s.default,{style:[li.inviteButtonSmall,ue&&li.buttonHovered],onPress:ye,onMouseEnter:()=>me(!0),onMouseLeave:()=>me(!1),children:[(0,T.jsx)(S.default,{name:"account-plus",size:16,color:f.theme.colors.surface}),(0,T.jsx)(i.default,{style:li.inviteButtonSmallText,children:"Invite"})]})]}),(0,T.jsx)(r.default,{style:[li.filtersWrapper,m?{flex:.6,alignItems:"flex-end"}:null],children:(0,T.jsx)(H.default,{horizontal:!0,showsHorizontalScrollIndicator:!1,contentContainerStyle:li.filterScrollContent,children:(0,T.jsxs)(r.default,{style:li.filterContainer,children:[(0,T.jsx)(s.default,{style:[li.filterButton,li.allButton,"web"===n.default.OS&&"all"===U&&li.filterButtonHovered],onPress:()=>N("all"),onMouseEnter:()=>"web"===n.default.OS&&V("all"),onMouseLeave:()=>"web"===n.default.OS&&V(null),children:(0,T.jsxs)(r.default,{style:li.filterContent,children:[(0,T.jsx)(S.default,{name:"filter-variant",size:16,color:"#0784C6"}),(0,T.jsx)(i.default,{style:[li.filterText,li.allButtonText],children:"All"}),"all"===W&&(0,T.jsx)(S.default,{name:"check",size:16,color:"#0784C6",style:li.checkmark})]})}),(0,T.jsx)(s.default,{style:[li.filterButton,li.activeBookingsButton,"web"===n.default.OS&&"active_bookings"===U&&li.filterButtonHovered],onPress:()=>N("active_bookings"),onMouseEnter:()=>"web"===n.default.OS&&V("active_bookings"),onMouseLeave:()=>"web"===n.default.OS&&V(null),children:(0,T.jsxs)(r.default,{style:li.filterContent,children:[(0,T.jsx)(S.default,{name:"calendar-check",size:16,color:"#4CAF50"}),(0,T.jsx)(i.default,{style:[li.filterText,li.activeBookingsButtonText],children:"Active Bookings"}),"active_bookings"===W&&(0,T.jsx)(S.default,{name:"check",size:16,color:"#4CAF50",style:li.checkmark})]})}),(0,T.jsx)(s.default,{style:[li.filterButton,li.noBookingsButton,"web"===n.default.OS&&"no_bookings"===U&&li.filterButtonHovered],onPress:()=>N("no_bookings"),onMouseEnter:()=>"web"===n.default.OS&&V("no_bookings"),onMouseLeave:()=>"web"===n.default.OS&&V(null),children:(0,T.jsxs)(r.default,{style:li.filterContent,children:[(0,T.jsx)(S.default,{name:"calendar-remove",size:16,color:"#898974"}),(0,T.jsx)(i.default,{style:[li.filterText,li.noBookingsButtonText],children:"No Bookings"}),"no_bookings"===W&&(0,T.jsx)(S.default,{name:"check",size:16,color:"#898974",style:li.checkmark})]})}),(0,T.jsx)(s.default,{style:[li.filterButton,li.pastBookingsButton,"web"===n.default.OS&&"past_bookings"===U&&li.filterButtonHovered],onPress:()=>N("past_bookings"),onMouseEnter:()=>"web"===n.default.OS&&V("past_bookings"),onMouseLeave:()=>"web"===n.default.OS&&V(null),children:(0,T.jsxs)(r.default,{style:li.filterContent,children:[(0,T.jsx)(S.default,{name:"history",size:16,color:"#9C27B0"}),(0,T.jsx)(i.default,{style:[li.filterText,li.pastBookingsButtonText],children:"Past Bookings"}),"past_bookings"===W&&(0,T.jsx)(S.default,{name:"check",size:16,color:"#9C27B0",style:li.checkmark})]})})]})})})]})}),B.length>0?(0,T.jsx)(Rt.default,{data:B,renderItem:({item:t})=>((0,p.debugLog)("MBA4321 Rendering connection item:",t),(0,T.jsx)(r.default,{style:[li.cardWrapper,c&&li.mobileCardWrapper,m&&li.wideScreenCardWrapper],children:(0,T.jsx)(si,{connection:t,type:y,onViewProfile:()=>(async t=>{(0,p.debugLog)("MBA4321 Navigating to messages with connection:",{connectionId:t.id,connectionName:t.name,conversationId:t.conversation_id}),await(0,h.navigateToFrom)(e,"MessageHistory","Connections",{conversationId:t.conversation_id,otherUserName:t.name})})(t),onCreateBooking:"clients"===y?()=>(async t=>{(0,p.debugLog)("MBA4321 Creating booking with client:",{clientId:t.id,clientName:t.name,conversationId:t.conversation_id}),await(0,h.navigateToFrom)(e,"MessageHistory","Connections",{conversationId:t.conversation_id,otherUserName:t.name,clientId:t.client_id,isProfessional:!0})})(t):null})})),keyExtractor:e=>e.client_id.toString(),contentContainerStyle:li.listContainer,onEndReached:()=>{!O&&F&&fe(P+1,!0)},onEndReachedThreshold:.5,ListFooterComponent:()=>O?((0,p.debugLog)("MBA4321 Loading more connections"),(0,T.jsx)(r.default,{style:li.footer,children:(0,T.jsx)(A.default,{size:"small",color:f.theme.colors.primary})})):!F&&B.length>0?((0,p.debugLog)("MBA4321 No more connections to load"),(0,T.jsxs)(r.default,{style:li.footer,children:[(0,T.jsxs)(i.default,{style:li.footerText,children:["No more ",y," to load"]}),"professional"===o&&"clients"===y&&(0,T.jsx)(s.default,{style:[li.createServiceButton,ge&&li.buttonHovered],onPress:()=>{(0,p.debugLog)("MBA4321 Create Service button clicked in footer"),(0,h.navigateToFrom)(e,"ServiceManager","Connections")},onMouseEnter:()=>he(!0),onMouseLeave:()=>he(!1),children:(0,T.jsx)(i.default,{style:li.createServiceButtonText,children:"Create a Service to Get More Clients"})})]})):null,ListHeaderComponent:(0,T.jsx)(r.default,{style:[li.listHeaderSpacing,{height:m?130:190}]}),numColumns:m?3:c?1:2,columnWrapperStyle:!c&&li.columnWrapper},m?"three-columns":c?"one-column":"two-columns"):w?(0,T.jsxs)(r.default,{style:li.emptyContainer,children:[(0,T.jsx)(r.default,{style:[li.listHeaderSpacing,{height:m?130:190}]}),(0,T.jsx)(S.default,{name:"magnify-close",size:80,color:f.theme.colors.placeholder}),(0,T.jsxs)(i.default,{style:li.emptyText,children:["No ",y,' found matching "',w,'"']}),(0,T.jsx)(s.default,{style:li.inviteButton,onPress:()=>{C(""),pe()},children:(0,T.jsx)(i.default,{style:li.inviteButtonText,children:"Clear Search"})})]}):(0,T.jsx)((({type:e})=>(0,T.jsxs)(r.default,{style:li.emptyContainer,children:[(0,T.jsx)(S.default,{name:"clients"===e?"account-group-outline":"account-tie-outline",size:80,color:f.theme.colors.primary}),(0,T.jsx)(i.default,{style:li.emptyText,children:{clients:{all:"You don't have any clients yet. Invite a client to get started!",active:"You don't have any active clients.",pending:"You don't have any pending client requests.",past:"You don't have any past clients."},professionals:{all:"You're not connected with any professionals yet.",active:"You don't have any active professionals.",pending:"You don't have any pending professional connections.",past:"You don't have any past professional connections."}}[e][W]}),"clients"===e&&"professional"===o&&(0,T.jsx)(s.default,{style:li.inviteButton,onPress:ye,children:(0,T.jsx)(i.default,{style:li.inviteButtonText,children:"Invite Client"})})]})),{type:y})]})})]}),(0,T.jsx)(_.default,{visible:Y,transparent:!0,animationType:"fade",onRequestClose:()=>G(!1),children:(0,T.jsx)(r.default,{style:li.modalOverlay,children:(0,T.jsxs)(r.default,{style:li.modalContent,children:[(0,T.jsxs)(r.default,{style:li.modalHeader,children:[(0,T.jsx)(i.default,{style:li.modalTitle,children:"Invite Client"}),(0,T.jsx)(s.default,{style:li.closeButton,onPress:()=>G(!1),children:(0,T.jsx)(S.default,{name:"close",size:24,color:"#666"})})]}),(0,T.jsx)(i.default,{style:li.modalText,children:"Invite a client to connect with you on CrittrCove. You can either send them an email invitation or generate a link to share."}),(0,T.jsxs)(r.default,{style:li.inviteTypeToggle,children:[(0,T.jsxs)(s.default,{style:[li.inviteTypeButton,"email"===ae&&li.inviteTypeButtonActive],onPress:()=>{ne("email"),le(""),ce("")},children:[(0,T.jsx)(S.default,{name:"email-outline",size:20,color:"email"===ae?f.theme.colors.primary:"#666"}),(0,T.jsx)(i.default,{style:[li.inviteTypeText,"email"===ae&&li.inviteTypeTextActive],children:"Email Invitation"})]}),(0,T.jsxs)(s.default,{style:[li.inviteTypeButton,"link"===ae&&li.inviteTypeButtonActive],onPress:()=>{ne("link"),le(""),ce("")},children:[(0,T.jsx)(S.default,{name:"link-variant",size:20,color:"link"===ae?f.theme.colors.primary:"#666"}),(0,T.jsx)(i.default,{style:[li.inviteTypeText,"link"===ae&&li.inviteTypeTextActive],children:"Generate Link"})]})]}),"email"===ae?(0,T.jsxs)(r.default,{style:li.inputContainer,children:[(0,T.jsx)(i.default,{style:li.inputLabel,children:"Client's Email Address"}),(0,T.jsx)(q.default,{style:li.emailInput,placeholder:"client@example.com",value:J,onChangeText:$,keyboardType:"email-address",autoCapitalize:"none"})]}):re?(0,T.jsxs)(r.default,{style:li.linkContainer,children:[(0,T.jsx)(i.default,{style:li.inputLabel,children:"Shareable Invitation Link"}),(0,T.jsxs)(r.default,{style:li.generatedLinkContainer,children:[(0,T.jsx)(i.default,{style:li.generatedLink,numberOfLines:1,ellipsizeMode:"middle",children:re}),"web"===n.default.OS&&(0,T.jsx)(s.default,{style:li.copyButton,onPress:()=>{re&&(navigator.clipboard.writeText(re),ce("Link copied to clipboard!"))},children:(0,T.jsx)(S.default,{name:"content-copy",size:20,color:f.theme.colors.primary})})]})]}):null,se?(0,T.jsx)(i.default,{style:li.errorText,children:se}):null,de?(0,T.jsx)(i.default,{style:li.successText,children:de}):null,(0,T.jsxs)(r.default,{style:li.modalButtons,children:[(0,T.jsx)(s.default,{style:li.cancelButton,onPress:()=>G(!1),children:(0,T.jsx)(i.default,{style:li.cancelButtonText,children:"Close"})}),re&&"email"!==ae?null:(0,T.jsx)(s.default,{style:[li.sendInviteButton,"email"===ae&&(!J||!J.includes("@"))&&li.disabledButton,Z&&li.disabledButton],onPress:async()=>{if(le(""),ce(""),"email"===ae&&(!J||!J.includes("@")))return le("Please enter a valid email address"),void(0,p.debugLog)("MBA4321 Invalid email format:",J);K(!0),(0,p.debugLog)("MBA4321 Creating invitation:",{type:ae,email:"email"===ae?J:null});try{const e=await(0,at.inviteClient)(ae,"email"===ae?J:null);(0,p.debugLog)("MBA4321 Invitation created successfully:",e),"email"===ae?(ce("Invitation sent to ".concat(J)),$("")):(ie(e.invitation_link),ce("Invitation link created successfully!")),"pending"!==W&&"all"!==W||fe(1)}catch(M){(0,p.debugLog)("MBA4321 Error creating invitation:",M),le(M.response?.data?.error||"Failed to send invitation. Please try again.")}finally{K(!1)}},disabled:Z||"email"===ae&&(!J||!J.includes("@")),children:Z?(0,T.jsx)(A.default,{size:"small",color:f.theme.colors.surface}):(0,T.jsx)(i.default,{style:li.sendInviteButtonText,children:"email"===ae?"Send Invitation":"Generate Link"})})]})]})})})]})})},ci=(0,u.default)(),ui=(0,g.default)(),mi=[{name:"Home",component:function({navigation:e}){const{colors:t}=(0,G.useTheme)(),{screenWidth:i}=(0,a.useContext)(p.AuthContext),l=i<660,[d,c]=(0,a.useState)(!1),u=({data:e,renderItem:t,title:o,cardWidth:i=320})=>{const l=a.useRef(null),[d,c]=(0,a.useState)(0),[u,m]=(0,a.useState)(!1),g=a.useRef(null);(0,a.useEffect)((()=>(u||(g.current=setInterval((()=>{if(l.current){const t=(d+1)%e.length;h(t)}}),3e3)),()=>{g.current&&clearInterval(g.current)})),[d,u,e.length]);const h=e=>{l.current&&(l.current.scrollTo({x:e*i,animated:!0}),c(e))},p=()=>{setTimeout((()=>{m(!1)}),1e3)};return(0,T.jsxs)(r.default,{style:Ce.section,children:[(0,T.jsx)(Y.default,{style:Ce.sectionTitle,children:o}),(0,T.jsxs)(r.default,{style:Ce.scrollContainer,children:[(0,T.jsx)(H.default,{ref:l,horizontal:!0,showsHorizontalScrollIndicator:!0,style:[Ce.scrollContainer,{WebkitOverflowScrolling:"touch"}],contentContainerStyle:Ce.scrollContent,onScroll:e=>{const t=e.nativeEvent.contentOffset.x,o=Math.round(t/i);c(o)},scrollEventThrottle:16,pagingEnabled:"web"!==n.default.OS,onScrollBeginDrag:()=>{m(!0),g.current&&clearInterval(g.current)},onScrollEndDrag:p,onMomentumScrollEnd:p,children:e.map(((e,o)=>t(e,o)))}),(0,T.jsx)(r.default,{style:Ce.scrollIndicators,children:e.map(((e,t)=>(0,T.jsx)(s.default,{onPress:()=>(e=>{m(!0),h(e),setTimeout((()=>{m(!1)}),1e3)})(t),style:Ce.scrollIndicatorButton,children:(0,T.jsx)(r.default,{style:[Ce.scrollIndicator,d===t&&Ce.scrollIndicatorActive]})},t)))}),"web"!==n.default.OS&&(0,T.jsxs)(r.default,{style:Ce.scrollHint,children:[(0,T.jsx)(Y.default,{style:Ce.scrollHintText,children:"Swipe for more"}),(0,T.jsx)(S.default,{name:"gesture-swipe-horizontal",size:24,color:f.theme.colors.primary})]})]})]})},m=({icon:e,title:t,description:o,color:a})=>{const n={container:{width:l?"90%":"45%",minWidth:l?"auto":300,maxWidth:500,padding:20,backgroundColor:"#fff",borderRadius:10,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3,marginBottom:20,alignSelf:"center"},header:{flexDirection:"column",alignItems:"center",marginBottom:15},iconContainer:{width:60,height:60,borderRadius:30,backgroundColor:"".concat(f.theme.colors.primary,"15"),justifyContent:"center",alignItems:"center",marginBottom:15},title:{fontSize:20,fontWeight:"bold",color:f.theme.colors.text,fontFamily:f.theme.fonts.header.fontFamily,textAlign:"center",marginBottom:10},description:{fontSize:16,lineHeight:24,color:f.theme.colors.text,fontFamily:f.theme.fonts.regular.fontFamily,textAlign:"center"}};return(0,T.jsxs)(r.default,{style:n.container,children:[(0,T.jsxs)(r.default,{style:n.header,children:[(0,T.jsx)(r.default,{style:n.iconContainer,children:(0,T.jsx)(S.default,{name:e,size:32,color:a})}),(0,T.jsx)(Y.default,{style:n.title,children:t})]}),(0,T.jsx)(Y.default,{style:n.description,children:o})]})};return(0,T.jsxs)(H.default,{style:Ce.container,children:[(0,T.jsxs)(r.default,{style:Ce.heroSection,children:[(0,T.jsx)(U.default,{source:o(32571),style:Ce.heroImage,resizeMode:"cover"}),(0,T.jsx)(Y.default,{style:Ce.heroText,children:"Welcome to CrittrCove"})]}),(0,T.jsxs)(r.default,{style:Ce.serviceHighlightsSection,children:[(0,T.jsx)(Y.default,{style:Ce.mainServiceTitle,children:"Marketplace for Pet Owners and Care Professionals"}),(0,T.jsxs)(r.default,{style:[Ce.servicesGrid,{flexDirection:l?"column":"row",alignItems:l?"center":"flex-start"}],children:[(0,T.jsx)(m,{icon:"paw",title:"All Animals Welcome",description:"From common pets to exotic animals, we connect you with professionals experienced in caring for any type of animal companion.",color:f.theme.colors.mainColors.senary}),(0,T.jsx)(m,{icon:"calendar-clock",title:"Flexible Booking Options",description:"Book single visits, multiple days, or set up recurring services. Create subscription plans or schedule services months in advance.",color:f.theme.colors.mainColors.quinary}),(0,T.jsx)(m,{icon:"shield-check",title:"Verified Professionals",description:"All professionals are thoroughly vetted and must maintain active insurance coverage to provide services through our platform.",color:f.theme.colors.mainColors.main}),(0,T.jsx)(m,{icon:"tune-variant",title:"Customizable Services",description:"Professionals can create custom service packages and pricing plans tailored to your specific needs and preferences.",color:f.theme.colors.mainColors.quaternary})]})]}),(0,T.jsx)((()=>{const[t,o]=(0,a.useState)("owners"),n=["#515d6c","#516a6c","#516C61","#6A6C51"],i={flexDirection:"row",marginBottom:20,alignItems:"flex-start",width:"100%"},l={flex:1,marginLeft:5};return(0,T.jsxs)(r.default,{style:Ce.featuresSection,children:[(0,T.jsx)(Y.default,{style:Ce.sectionTitle,children:"How It Works"}),(0,T.jsxs)(r.default,{style:Ce.toggleContainer,children:[(0,T.jsx)(s.default,{style:[Ce.toggleButton,"owners"===t&&Ce.toggleButtonActive],onPress:()=>o("owners"),children:(0,T.jsx)(Y.default,{style:[Ce.toggleButtonText,"owners"===t&&Ce.toggleButtonTextActive],children:"For Pet Owners"})}),(0,T.jsx)(s.default,{style:[Ce.toggleButton,"sitters"===t&&Ce.toggleButtonActive],onPress:()=>o("sitters"),children:(0,T.jsx)(Y.default,{style:[Ce.toggleButtonText,"sitters"===t&&Ce.toggleButtonTextActive],children:"For Pet Professionals"})})]}),(0,T.jsxs)(r.default,{style:Ce.featuresContainer,children:["owners"===t&&(0,T.jsxs)(r.default,{style:Ce.featureColumn,children:[(0,T.jsx)(Y.default,{style:Ce.columnTitle,children:"For Pet Owners"}),(0,T.jsxs)(r.default,{style:Ce.featuresList,children:[(0,T.jsxs)(r.default,{style:i,children:[(0,T.jsx)(r.default,{style:[Ce.featureIconCircle,{backgroundColor:n[0]}],children:(0,T.jsx)(X.default,{name:"person-running",size:24,color:"white"})}),(0,T.jsxs)(r.default,{style:l,children:[(0,T.jsx)(Y.default,{style:Ce.featureTitle,children:"Complete Your Profile"}),(0,T.jsx)(Y.default,{style:Ce.featureText,children:"Submit details about you and your requirements."})]})]}),(0,T.jsxs)(r.default,{style:i,children:[(0,T.jsx)(r.default,{style:[Ce.featureIconCircle,{backgroundColor:n[1]}],children:(0,T.jsx)(S.default,{name:"horse-human",size:24,color:"white"})}),(0,T.jsxs)(r.default,{style:l,children:[(0,T.jsx)(Y.default,{style:Ce.featureTitle,children:"Complete Pet Profile"}),(0,T.jsx)(Y.default,{style:Ce.featureText,children:"Submit details about your pet and sitting requirements."})]})]}),(0,T.jsxs)(r.default,{style:i,children:[(0,T.jsx)(r.default,{style:[Ce.featureIconCircle,{backgroundColor:n[2]}],children:(0,T.jsx)(S.default,{name:"professional-hexagon",size:24,color:"white"})}),(0,T.jsxs)(r.default,{style:l,children:[(0,T.jsx)(Y.default,{style:Ce.featureTitle,children:"Search for Pro's"}),(0,T.jsx)(Y.default,{style:Ce.featureText,children:"You can use our marketplace to find the best pro for your desired service."})]})]}),(0,T.jsxs)(r.default,{style:i,children:[(0,T.jsx)(r.default,{style:[Ce.featureIconCircle,{backgroundColor:n[3]}],children:(0,T.jsx)($.default,{name:"calendar-check",size:24,color:"white"})}),(0,T.jsxs)(r.default,{style:l,children:[(0,T.jsx)(Y.default,{style:Ce.featureTitle,children:"Confirm Your Booking"}),(0,T.jsx)(Y.default,{style:Ce.featureText,children:"Coordinate directly with your professional to finalize details."})]})]})]}),(0,T.jsx)(r.default,{style:Ce.buttonContainer,children:(0,T.jsx)(s.default,{style:Ce.actionButton,onPress:()=>(0,h.navigateToFrom)(e,"Waitlist","Home"),children:(0,T.jsx)(Y.default,{style:Ce.buttonText,children:"Sign up Today!"})})})]}),"sitters"===t&&(0,T.jsxs)(r.default,{style:Ce.featureColumn,children:[(0,T.jsx)(Y.default,{style:Ce.columnTitle,children:"For Pet Professionals"}),(0,T.jsxs)(r.default,{style:Ce.featuresList,children:[(0,T.jsxs)(r.default,{style:i,children:[(0,T.jsx)(r.default,{style:[Ce.featureIconCircle,{backgroundColor:n[0]}],children:(0,T.jsx)(J.default,{name:"sign-in",size:24,color:"white"})}),(0,T.jsxs)(r.default,{style:l,children:[(0,T.jsx)(Y.default,{style:Ce.featureTitle,children:"Apply to Join Pro Community"}),(0,T.jsx)(Y.default,{style:Ce.featureText,children:"Submit your specialties, documents, bio, and availability to begin."})]})]}),(0,T.jsxs)(r.default,{style:i,children:[(0,T.jsx)(r.default,{style:[Ce.featureIconCircle,{backgroundColor:n[1]}],children:(0,T.jsx)(S.default,{name:"plus-circle",size:24,color:"white"})}),(0,T.jsxs)(r.default,{style:l,children:[(0,T.jsx)(Y.default,{style:Ce.featureTitle,children:"Create Services"}),(0,T.jsx)(Y.default,{style:Ce.featureText,children:"Create services to offer to pet owners."})]})]}),(0,T.jsxs)(r.default,{style:i,children:[(0,T.jsx)(r.default,{style:[Ce.featureIconCircle,{backgroundColor:n[2]}],children:(0,T.jsx)(X.default,{name:"handshake-simple",size:24,color:"white"})}),(0,T.jsxs)(r.default,{style:l,children:[(0,T.jsx)(Y.default,{style:Ce.featureTitle,children:"Get Matched with Owners"}),(0,T.jsx)(Y.default,{style:Ce.featureText,children:"Pet owners in your area will reach out to you for yourservices."})]})]}),(0,T.jsxs)(r.default,{style:i,children:[(0,T.jsx)(r.default,{style:[Ce.featureIconCircle,{backgroundColor:n[3]}],children:(0,T.jsx)(ee.default,{name:"auto-graph",size:24,color:"white"})}),(0,T.jsxs)(r.default,{style:l,children:[(0,T.jsx)(Y.default,{style:Ce.featureTitle,children:"Grow Your Business"}),(0,T.jsx)(Y.default,{style:Ce.featureText,children:"Manage bookings and get support as you build your pet service business."})]})]})]}),(0,T.jsx)(r.default,{style:Ce.buttonContainer,children:(0,T.jsx)(s.default,{style:Ce.actionButton,onPress:()=>(0,h.navigateToFrom)(e,"Waitlist","Home"),children:(0,T.jsx)(Y.default,{style:Ce.buttonText,children:"Become a Professional"})})})]})]})]})}),{}),(0,T.jsx)((()=>(0,T.jsx)(u,{data:je,renderItem:(e,t)=>(0,T.jsxs)(r.default,{style:Ce.reviewCard,children:[(0,T.jsx)(Y.default,{style:Ce.reviewText,children:e.text}),(0,T.jsxs)(r.default,{style:Ce.reviewAuthorContainer,children:[(0,T.jsx)(we,{source:e.image,style:Ce.reviewerImage}),(0,T.jsxs)(r.default,{children:[(0,T.jsx)(Y.default,{style:Ce.reviewAuthorName,children:e.author}),(0,T.jsx)(Y.default,{style:Ce.reviewAuthorTitle,children:"Owner Review"}),(0,T.jsx)(r.default,{style:Ce.starsContainer,children:[1,2,3,4,5].map(((e,t)=>(0,T.jsx)(S.default,{name:"star",size:16,color:f.theme.colors.primary,style:Ce.starIcon},t)))})]})]})]},t),title:"Kind Words From Users"})),{}),(0,T.jsx)((()=>(0,T.jsx)(u,{data:ye,renderItem:(t,o)=>(0,T.jsx)(s.default,{style:[Ce.blogCard,{marginRight:o===ye.length-1?0:10}],onPress:()=>(0,h.navigateToFrom)(e,"BlogPost","Home",{post:t}),children:(0,T.jsxs)(r.default,{style:Ce.authorContainer,children:[(0,T.jsx)(U.default,{source:{uri:t.author.profilePicture},style:Ce.authorImage}),(0,T.jsxs)(r.default,{style:Ce.blogContent,children:[(0,T.jsx)(Y.default,{style:[Ce.title,{color:f.theme.colors.primary}],numberOfLines:2,children:t.title}),(0,T.jsxs)(r.default,{style:Ce.authorInfo,children:[(0,T.jsx)(Y.default,{style:[Ce.authorName,{color:f.theme.colors.secondary}],children:t.author.name}),(0,T.jsx)(Y.default,{style:Ce.dot,children:" \u2022 "}),(0,T.jsx)(Y.default,{style:Ce.readTime,children:t.readTime})]}),(0,T.jsxs)(Y.default,{style:Ce.preview,numberOfLines:3,children:[t.content.slice(0,100),"..."]}),(0,T.jsx)(r.default,{style:Ce.tags,children:t.tags.slice(0,2).map(((e,t)=>(0,T.jsx)(r.default,{style:[Ce.tag,{backgroundColor:f.theme.colors.primary+"20"}],children:(0,T.jsx)(Y.default,{style:[Ce.tagText,{color:f.theme.colors.primary}],children:e})},t)))}),(0,T.jsxs)(r.default,{style:Ce.stats,children:[(0,T.jsxs)(r.default,{style:Ce.stat,children:[(0,T.jsx)(S.default,{name:"heart-outline",size:16,color:f.theme.colors.secondary}),(0,T.jsx)(Y.default,{style:Ce.statText,children:t.likes})]}),(0,T.jsxs)(r.default,{style:Ce.stat,children:[(0,T.jsx)(S.default,{name:"comment-outline",size:16,color:f.theme.colors.secondary}),(0,T.jsx)(Y.default,{style:Ce.statText,children:t.comments})]}),(0,T.jsxs)(r.default,{style:Ce.stat,children:[(0,T.jsx)(S.default,{name:"share-outline",size:16,color:f.theme.colors.secondary}),(0,T.jsx)(Y.default,{style:Ce.statText,children:t.shares})]})]})]})]})},t.id),title:"Blog",cardWidth:320})),{}),(0,T.jsx)(K,{}),(0,T.jsxs)(r.default,{style:[Ce.section,Ce.waitlistSection],children:[(0,T.jsx)(Y.default,{style:Ce.sectionTitle,children:"Join Our Waitlist"}),(0,T.jsx)(Y.default,{style:Ce.waitlistDescription,children:"Get exclusive bonus offers, promotions, and discounts when the app and website launches by signing up on our waitlist today!"}),(0,T.jsx)(s.default,{style:[Ce.actionButton,Ce.waitlistButton],onPress:()=>(0,h.navigateToFrom)(e,"Waitlist","Home"),children:(0,T.jsx)(Y.default,{style:Ce.buttonText,children:"Join Waitlist"})})]}),(0,T.jsx)((()=>{const[e,t]=(0,Q.useForm)("mkgobpro"),[o,n]=(0,a.useState)(""),[i,l]=(0,a.useState)(""),[d,c]=(0,a.useState)("");return e.succeeded?(0,T.jsx)(r.default,{style:Ce.contactSection,children:(0,T.jsxs)(r.default,{style:Ce.contactContainer,children:[(0,T.jsx)(Y.default,{style:[Ce.sectionTitle,{color:f.theme.colors.primary}],children:"Thanks for reaching out!"}),(0,T.jsx)(Y.default,{style:Ce.successMessage,children:"We'll get back to you soon."})]})}):(0,T.jsx)(r.default,{style:Ce.contactSection,children:(0,T.jsxs)(r.default,{style:Ce.contactContainer,children:[(0,T.jsx)(Y.default,{style:Ce.sectionTitle,children:"Contact Us"}),(0,T.jsx)(q.default,{placeholder:"Your Name",style:Ce.input,value:o,onChangeText:n,name:"name"}),(0,T.jsx)(Q.ValidationError,{prefix:"Name",field:"name",errors:e.errors}),(0,T.jsx)(q.default,{placeholder:"Your Email",style:Ce.input,value:i,onChangeText:l,keyboardType:"email-address",name:"email",autoCapitalize:"none"}),(0,T.jsx)(Q.ValidationError,{prefix:"Email",field:"email",errors:e.errors}),(0,T.jsx)(q.default,{placeholder:"Your Message",style:[Ce.input,Ce.messageInput],value:d,onChangeText:c,multiline:!0,name:"message"}),(0,T.jsx)(Q.ValidationError,{prefix:"Message",field:"message",errors:e.errors}),(0,T.jsx)(r.default,{style:Ce.buttonContainer,children:(0,T.jsx)(s.default,{style:[Ce.actionButton,e.submitting&&Ce.disabledButton],onPress:async a=>{a.preventDefault();const r={name:o,email:i,message:d};await t(r),e.succeeded&&(n(""),l(""),c(""))},disabled:e.submitting,children:(0,T.jsx)(Y.default,{style:Ce.buttonText,children:e.submitting?"Sending...":"Send"})})})]})})}),{}),(0,T.jsxs)(r.default,{style:Ce.footer,children:[(0,T.jsxs)(r.default,{style:Ce.socialIconsRow,children:[(0,T.jsx)(s.default,{style:Ce.socialIcon,onPress:()=>V.default.openURL("https://www.instagram.com/thezensitter"),children:(0,T.jsx)(J.default,{name:"instagram",size:24,color:"white"})}),(0,T.jsx)(s.default,{style:Ce.socialIcon,onPress:()=>V.default.openURL("https://discord.com/your-profile"),children:(0,T.jsx)($.default,{name:"discord",size:24,color:"white"})})]}),(0,T.jsxs)(r.default,{style:Ce.footerLinksRow,children:[(0,T.jsx)(Y.default,{style:Ce.footerLink,onPress:()=>(0,h.navigateToFrom)(e,"PrivacyPolicy","Home"),children:"Privacy Policy"}),(0,T.jsx)(Y.default,{style:Ce.footerLink,onPress:()=>(0,h.navigateToFrom)(e,"TermsOfService","Home"),children:"Terms of Service"})]})]})]})}},{name:"About",component:function(){return(0,T.jsx)(r.default,{style:{flex:1,justifyContent:"center",alignItems:"center"},children:(0,T.jsx)(Y.default,{children:"About Screen"})})}},{name:"OwnerProfile",component:Fe},{name:"MyProfile",component:Et},{name:"SignIn",component:function(){const[e,t]=(0,a.useState)(""),[o,l]=(0,a.useState)(""),[d,c]=(0,a.useState)(""),[u,m]=(0,a.useState)(""),[g,y]=(0,a.useState)(!1),[x,C]=(0,a.useState)(""),[v,B]=(0,a.useState)(!1),[k,_]=(0,a.useState)(!1),I=(0,j.useNavigation)(),{signIn:D,is_prototype:M,is_DEBUG:R}=(0,a.useContext)(p.AuthContext),P=async()=>{if("ios"!==n.default.OS&&"android"!==n.default.OS||Wt.default.dismiss(),(()=>{let t=!0;const a=Ut(e);c(a.message),a.isValid||(t=!1);const n=qt(o);return m(n.message),n.isValid||(t=!1),t})()){y(!0);try{(0,p.debugLog)("MBA67890 Starting login process"),(0,p.debugLog)("MBA67890 API Base URL:",b.API_BASE_URL),(0,p.debugLog)("MBA67890 Login request details:",{url:"".concat(b.API_BASE_URL,"/api/token/"),method:"POST",data:{email:e.toLowerCase(),password:"***"}}),(0,p.debugLog)("MBA67890 Attempting to authenticate with backend");const n=await w.default.post("".concat(b.API_BASE_URL,"/api/token/"),{email:e.toLowerCase(),password:o});(0,p.debugLog)("MBA67890 Login response:",{status:n.status,statusText:n.statusText,headers:n.headers});const{access:r,refresh:i}=n.data;(0,p.debugLog)("MBA67890 Authentication successful, received tokens");const s=await D(r,i,I);(0,p.debugLog)("MBA67890 Sign in status:",s);try{const e=Intl.DateTimeFormat().resolvedOptions().timeZone;(0,p.debugLog)("MBA67890 Detected timezone:",e),console.log("MBA67890 Detected timezone:",e),await(0,at.updateTimeSettings)(e),(0,p.debugLog)("MBA67890 Successfully updated timezone in backend")}catch(t){(0,p.debugLog)("MBA67890 Error updating timezone:",t)}try{const e=await w.default.get("".concat(b.API_BASE_URL,"/api/users/v1/tutorial-status/current/")),t=e.data.first_time_logging_in||e.data.first_time_logging_in_after_signup;(0,p.debugLog)("MBA67890 Tutorial status:",e.data),(0,p.debugLog)("MBA67890 Needs tutorial:",t),t?((0,p.debugLog)("MBA67890 Navigating to MyProfile for tutorial"),(0,h.navigateToFrom)(I,"MyProfile","SignIn")):((0,p.debugLog)("MBA67890 Navigating to Dashboard"),(0,h.navigateToFrom)(I,"Dashboard","SignIn"))}catch(a){(0,p.debugLog)("MBA67890 Error checking tutorial status:",a),(0,h.navigateToFrom)(I,"Dashboard","SignIn")}}catch(r){(0,p.debugLog)("MBA67890 Login failed",r.response?.data||r.message);const e=r.response&&401===r.response.status?"Invalid credentials. Please try again.":"An unexpected error occurred.";"ios"===n.default.OS||"android"===n.default.OS?Be.default.alert("Login Failed",e):C("Login Failed: ".concat(e)),c("Invalid email or password"),m("Invalid email or password")}finally{y(!1)}}};(0,a.useEffect)((()=>{if("web"===n.default.OS){const e=e=>{"Enter"===e.key&&P()};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}}}),[e,o]);const z=e=>{"web"===n.default.OS&&"Enter"===e.nativeEvent.key&&P()};return(0,a.useEffect)((()=>{if("web"===n.default.OS){const e=window.location.pathname;if((0,p.debugLog)("MBA5555 SignIn screen - Current URL path:",e),e.includes("/invite/")){const t=e.split("/"),o=t.findIndex((e=>"invite"===e));if(-1!==o&&t.length>o+1){const e=t[o+1];(0,p.debugLog)("MBA5555 SignIn detected invite token, redirecting to SignUp:",e),I.navigate("SignUp",{token:e})}}}}),[]),(0,T.jsx)(r.default,{style:Gt.container,children:(0,T.jsxs)(r.default,{style:Gt.card,children:[(0,T.jsx)(i.default,{style:Gt.title,children:"Log in"}),M&&(0,T.jsx)(i.default,{style:Gt.prototypeWarning,children:"Prototype Mode: You can sign in with anything for email and password"}),(0,T.jsxs)(r.default,{style:Gt.createAccountContainer,children:[(0,T.jsx)(i.default,{style:Gt.createAccountText,children:"Need a CrittrCove account?"}),(0,T.jsx)(s.default,{onPress:()=>I.navigate("SignUp"),children:(0,T.jsx)(i.default,{style:Gt.createAccountLink,children:"Create an account"})})]}),(0,T.jsxs)(r.default,{style:Gt.inputLabelContainer,children:[(0,T.jsx)(i.default,{style:Gt.inputLabel,children:"Username or Email"}),(0,T.jsx)(q.default,{style:[Gt.input,d?Gt.errorInput:null],value:e,onChangeText:e=>{t(e),c("")},autoCapitalize:"none",onKeyPress:"web"===n.default.OS?z:void 0}),d?(0,T.jsx)(i.default,{style:Gt.errorText,children:d}):null]}),(0,T.jsxs)(r.default,{style:Gt.inputLabelContainer,children:[(0,T.jsxs)(r.default,{style:Gt.passwordLabelContainer,children:[(0,T.jsx)(i.default,{style:Gt.inputLabel,children:"Password"}),(0,T.jsx)(s.default,{onPress:()=>{B(!v)},children:(0,T.jsx)(i.default,{style:Gt.showHideText,children:v?"Hide":"Show"})})]}),(0,T.jsx)(q.default,{style:[Gt.input,u?Gt.errorInput:null],secureTextEntry:!v,value:o,onChangeText:e=>{l(e),m("")},onKeyPress:"web"===n.default.OS?z:void 0}),u?(0,T.jsx)(i.default,{style:Gt.errorText,children:u}):null]}),(0,T.jsxs)(r.default,{style:Gt.rememberMeContainer,children:[(0,T.jsx)(s.default,{style:Gt.checkbox,onPress:()=>_(!k),children:k&&(0,T.jsx)(r.default,{style:Gt.checkboxInner,children:(0,T.jsx)(S.default,{name:"check",size:14,color:f.theme.colors.whiteText})})}),(0,T.jsx)(i.default,{style:Gt.rememberMeText,children:"Keep me logged in"})]}),(0,T.jsx)(s.default,{style:Gt.loginButton,onPress:P,children:(0,T.jsx)(i.default,{style:Gt.loginButtonText,children:"Log in"})}),g&&(0,T.jsx)(A.default,{size:"large",color:f.theme.colors.primary}),x?(0,T.jsx)(i.default,{style:Gt.message,children:x}):null,(0,T.jsx)(s.default,{onPress:()=>I.navigate("ResetPassword"),style:Gt.forgotPasswordContainer,children:(0,T.jsx)(i.default,{style:Gt.link,children:"Forgot Password?"})})]})})}},{name:"SignUp",component:Zt},{name:"Invite",component:Zt},{name:"ResetPassword",component:function(){const[e,t]=(0,a.useState)(""),[o,s]=(0,a.useState)(!1),[l,d]=(0,a.useState)(!1),[c,u]=(0,a.useState)(""),m=(0,j.useNavigation)();return(0,T.jsxs)(r.default,{style:Xt.container,children:[(0,T.jsx)(i.default,{style:Xt.title,children:"Reset Password"}),(0,T.jsx)(q.default,{style:[Xt.input,o&&Xt.inputError],placeholder:"Email",value:e,onChangeText:e=>{t(e),s(!1)},keyboardType:"email-address",autoCapitalize:"none"}),(0,T.jsx)(Nt,{title:"Reset Password",onPress:async()=>{if(e){d(!0);try{await w.default.post("".concat(b.API_BASE_URL,"/api/users/v1/reset-password/"),{email:e});"ios"===n.default.OS||"android"===n.default.OS?Be.default.alert("Success","A reset password link has been sent to your email.",[{text:"OK",onPress:()=>m.navigate("Home")}]):(u("A reset password link has been sent to your email."),setTimeout((()=>{m.navigate("Home")}),2e3))}catch(t){t.response&&404===t.response.status?(s(!0),"ios"===n.default.OS||"android"===n.default.OS?Be.default.alert("Error","Email is not associated with any user."):u("Error: Email is not associated with any user.")):"ios"===n.default.OS||"android"===n.default.OS?Be.default.alert("Error","Failed to send reset password email. Please try again later."):u("Error: Failed to send reset password email. Please try again later.")}finally{d(!1)}}else"ios"===n.default.OS||"android"===n.default.OS?Be.default.alert("Error","Please enter your email address."):u("Error: Please enter your email address.")}}),l&&(0,T.jsx)(A.default,{size:"large",color:f.theme.colors.primary}),c?(0,T.jsx)(i.default,{style:Xt.message,children:c}):null]})}},{name:"ResetPasswordConfirm",component:function({route:e}){const{uid:t,token:o}=e.params,[s,l]=(0,a.useState)(""),[d,c]=(0,a.useState)(""),[u,m]=(0,a.useState)(!1),[g,p]=(0,a.useState)(""),y=(0,j.useNavigation)();return(0,T.jsxs)(r.default,{style:to.container,children:[(0,T.jsx)(i.default,{style:to.title,children:"Reset Password"}),(0,T.jsx)(q.default,{style:to.input,placeholder:"New Password",value:s,onChangeText:l,secureTextEntry:!0}),(0,T.jsx)(q.default,{style:to.input,placeholder:"Confirm Password",value:d,onChangeText:c,secureTextEntry:!0}),(0,T.jsx)(Nt,{title:"Reset Password",onPress:async()=>{if(s===d){m(!0);try{await w.default.post("".concat(b.API_BASE_URL,"/api/users/v1/reset-password-confirm/").concat(t,"/").concat(o,"/"),{new_password:s});"ios"===n.default.OS||"android"===n.default.OS?Be.default.alert("Success","Your password has been reset.",[{text:"OK",onPress:()=>(0,h.navigateToFrom)(y,"SignIn","ResetPasswordConfirm")}]):(p("Your password has been reset."),setTimeout((()=>{(0,h.navigateToFrom)(y,"SignIn","ResetPasswordConfirm")}),2e3))}catch(e){const t="Failed to reset password. Please try again later.";"ios"===n.default.OS||"android"===n.default.OS?Be.default.alert("Error",t):p(t)}finally{m(!1)}}else"ios"===n.default.OS||"android"===n.default.OS?Be.default.alert("Error","Passwords do not match."):p("Passwords do not match.")}}),u&&(0,T.jsx)(A.default,{size:"large",color:f.theme.colors.primary}),g?(0,T.jsx)(i.default,{style:to.message,children:g}):null]})}},{name:"SearchProfessionalsListing",component:Fr},{name:"OwnerHistory",component:aa},{name:"MessageHistory",component:Ga},{name:"Dashboard",component:po},{name:"BecomeProfessional",component:yo},{name:"More",component:Co},{name:"Owners",component:Pn},{name:"AvailabilitySettings",component:Zo},{name:"MyPets",component:ta},{name:"PaymentMethods",component:hn},{name:"Settings",component:pn},{name:"PrivacyPolicy",component:xn},{name:"ProfessionalSettings",component:wn},{name:"TermsOfService",component:Sn},{name:"HelpFAQ",component:Bn},{name:"ContactUs",component:_n},{name:"ProfessionalProfile",component:Hn},{name:"MyContracts",component:rr},{name:"ChangePassword",component:sr},{name:"AddPet",component:ur},{name:"MyBookings",component:Or},{name:"BookingDetails",component:qr},{name:"ServiceManager",component:Gr},{name:"Blog",component:Zr},{name:"BlogPost",component:Qr},{name:"Waitlist",component:oi},{name:"TestToast",component:ri},{name:"Connections",component:di}],gi={enabled:!0,prefixes:["https://staging.crittrcove.com","http://staging.crittrcove.com","".concat(b.API_BASE_URL)],config:{screens:{Home:"*",About:"about",OwnerProfile:"owner-profile",MyProfile:"my-profile",SignIn:"signin",SignUp:{path:"signup/:token?",parse:{token:e=>e||null}},Invite:{path:"invite/:token",exact:!0,parse:{token:e=>e},stringify:{token:e=>e}},ResetPassword:"reset-password",ResetPasswordConfirm:"reset-password/:uid/:token",SearchProfessionalsListing:"search-professionals-listing",OwnerHistory:"owner-history",MessageHistory:{path:"message-history",parse:{messageId:e=>e||null,senderName:e=>e||"Unknown User"}},Dashboard:"Dashboard",BecomeProfessional:"become-professional",More:"more",Owners:"owners",AvailabilitySettings:"availability-settings",MyPets:"my-pets",PaymentMethods:"payment-methods",Settings:"settings",PrivacyPolicy:"privacy-policy",ProfessionalSettings:"professional-settings",TermsOfService:"terms-of-service",HelpFAQ:"help-faq",ContactUs:"contact-us",ProfessionalProfile:{path:"professional-profile",parse:{professional:e=>{}}},MyContracts:"my-contracts",ChangePassword:"change-password",AddPet:{path:"add-pet",parse:{pet:()=>{}}},MyBookings:"my-bookings",BookingDetails:"booking-details",ServiceManager:"service-manager",Blog:"blog",BlogPost:"blog-post",Waitlist:"waitlist",TestToast:"test-toast",Connections:"connections"}}},hi=(0,j.createNavigationContainerRef)();function fi(e,t){hi.isReady()&&hi.navigate(e,t)}function pi(){return(0,T.jsx)(ui.Navigator,{tabBar:e=>(0,T.jsx)(h.default,Object.assign({},e)),children:mi.map((e=>(0,T.jsx)(ui.Screen,{name:e.name,component:e.component,options:{headerShown:!1}},e.name)))})}const yi=()=>{const[e,t]=(0,a.useState)(!0),o=(0,j.useNavigation)();(0,a.useEffect)((()=>{(async()=>{if("web"===n.default.OS){"true"===sessionStorage.getItem("mvp_banner_hidden")&&t(!1)}else{"true"===await x.default.getItem("mvp_banner_hidden")&&t(!1)}})()}),[]);return e?(0,T.jsx)(r.default,{style:xi.warningBanner,children:(0,T.jsxs)(r.default,{style:xi.warningContent,children:[(0,T.jsx)(s.default,{style:xi.closeButton,onPress:async()=>{"web"===n.default.OS?sessionStorage.setItem("mvp_banner_hidden","true"):await x.default.setItem("mvp_banner_hidden","true"),t(!1)},children:(0,T.jsx)(i.default,{style:xi.closeButtonText,children:"\u2715"})}),(0,T.jsx)(i.default,{style:xi.warningText,children:"\ud83d\udea7 MVP MODE: Features are still under development."}),(0,T.jsx)(s.default,{style:xi.waitlistButton,onPress:()=>(0,h.navigateToFrom)(o,"Waitlist","Home"),children:(0,T.jsx)(i.default,{style:xi.waitlistButtonText,children:"Join Waitlist"})})]})}):null};function bi(){const e=(0,a.useContext)(p.AuthContext),{checkAuthStatus:t,is_DEBUG:o}=e,[r,i]=(0,a.useState)(null),[s,l]=(0,a.useState)(!0),[d,c]=(0,a.useState)(!0),[u,g]=(0,a.useState)(null);if((0,a.useEffect)((()=>{if("web"===n.default.OS){const t=window.location.pathname;if(e.debugLog&&e.debugLog("MBA6666 App - Current URL path:",t),t.includes("/invite/")){const o=t.split("/"),a=o.findIndex((e=>"invite"===e));if(-1!==a&&o.length>a+1){const t=o[a+1];e.debugLog&&e.debugLog("MBA6666 Found invitation token in URL:",t),g(t)}}}}),[]),(0,a.useEffect)((()=>{(async()=>{try{const o=await t();let a="Home";u?(e.debugLog&&e.debugLog("MBA6666 Setting initial route to SignUp with token:",u),a="SignUp"):o.isAuthenticated&&(a="professional"===o.userRole?"Dashboard":"Home"),i(a)}catch(o){console.error("Error initializing app:",o),i(u?"SignUp":"Home")}finally{l(!1)}})()}),[u]),(0,a.useEffect)((()=>{!s&&r&&"web"!==n.default.OS&&x.default.setItem("lastRoute",r).catch((e=>console.error("Error storing route:",e)))}),[r,s]),s||!r)return null;return(0,T.jsxs)(T.Fragment,{children:[d&&(0,T.jsx)(yi,{}),"web"===n.default.OS?(0,T.jsx)(ci.Navigator,{initialRouteName:r,screenOptions:Object.assign({headerShown:!0,header:({navigation:e})=>(0,T.jsx)(h.default,{navigation:e})},m.SlideFromRightIOS,{presentation:"card",animation:"slide_from_right"}),children:mi.map((e=>(0,T.jsx)(ci.Screen,{name:e.name,component:e.component,options:{headerShown:!0,animation:"slide_from_right"}},e.name)))}):(0,T.jsx)(pi,{})]})}const xi=l.default.create({container:{flex:1,display:"flex",flexDirection:"column",height:"100%"},warningBanner:{backgroundColor:"#ffebee",padding:"web"===n.default.OS?12:10,borderBottomWidth:1,borderBottomColor:"#ef5350",width:"100%",flexShrink:0},warningContent:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:10,maxWidth:1200,marginHorizontal:"auto",width:"100%"},warningText:{color:"#c62828",textAlign:"center",fontSize:"web"===n.default.OS?15:14,flexShrink:1,flex:1,marginHorizontal:15},waitlistButton:{backgroundColor:"#ef5350",paddingHorizontal:15,paddingVertical:8,borderRadius:20,marginLeft:"auto"},waitlistButtonText:{color:"white",fontSize:"web"===n.default.OS?14:13,fontWeight:"600"},closeButton:{width:24,height:24,justifyContent:"center",alignItems:"center",marginRight:5},closeButtonText:{color:"#c62828",fontSize:18,fontWeight:"600"}});function ji(){return(0,T.jsx)(c.default,{ref:hi,linking:gi,onStateChange:async e=>{if("web"!==n.default.OS&&e?.routes?.length>0){const t=e.routes[e.routes.length-1].name;await x.default.setItem("lastRoute",t).catch((e=>console.error("Error storing route:",e)))}},children:(0,T.jsx)(p.AuthProvider,{children:(0,T.jsx)(y.MessageNotificationProvider,{children:(0,T.jsx)(z,{children:(0,T.jsx)(d.default,{theme:f.theme,children:(0,T.jsx)(W,{children:(0,T.jsx)(bi,{})})})})})})})}},50294:(e,t,o)=>{"use strict";o.r(t),o.d(t,{acceptInvitation:()=>O,addPet:()=>T,approveBooking:()=>g,createBookingFromDraft:()=>H,createDraftFromBooking:()=>q,createService:()=>_,deleteInvitation:()=>E,deleteService:()=>A,fixPetOwner:()=>k,getBookingAvailablePets:()=>m,getBookingAvailableServices:()=>u,getBookingDetails:()=>h,getBookingDraftDatesAndTimes:()=>V,getConnectionProfile:()=>M,getInvitationDetails:()=>F,getInvitations:()=>z,getProfessionalServices:()=>c,getTimeSettings:()=>j,getUnreadMessageCount:()=>U,getUserConnections:()=>D,getUserName:()=>C,inviteClient:()=>R,requestBookingChanges:()=>f,resendInvitation:()=>W,sendReferral:()=>P,updateBookingDraftMultipleDays:()=>b,updateBookingDraftPetsAndServices:()=>p,updateBookingDraftRates:()=>N,updateBookingDraftRecurring:()=>x,updateBookingDraftTimeAndDate:()=>y,updatePet:()=>B,updateProfileInfo:()=>S,updateService:()=>I,updateTimeSettings:()=>w,userProfile:()=>v,verifyInvitation:()=>L});var a=o(77109),n=o(19620),r=o(38432),i=o(95991),s=o(32160);const l=e=>{if(401===e.response?.status&&"token_not_valid"===e.response?.data?.code){if((0,r.debugLog)("MBA54321","Auth error handler: Token invalid detected"),"web"===i.default.OS)sessionStorage.removeItem("userToken"),sessionStorage.removeItem("refreshToken"),sessionStorage.setItem("explicitSignOut","true");else{o(91087).default.multiRemove(["userToken","refreshToken"])}return setTimeout((()=>{const{navigate:e}=o(36009);e("SignIn")}),0),new Error("Your session has expired. Please sign in again to continue.")}return e},d=async()=>await(async()=>{const e=await(0,r.getStorage)("userToken");return a.default.create({baseURL:n.API_BASE_URL,headers:{Authorization:e?"Bearer ".concat(e):"","Content-Type":"application/json"}})})(),c=async()=>{try{(0,r.debugLog)("MBA7890: Fetching professional services");const e=await d();return(await e.get("/api/services/v1/professional/services/")).data}catch(e){throw(0,r.debugLog)("MBA7890: Error fetching professional services:",e),(0,r.debugLog)("MBA7890: Error details:",e.response?.data||e.message),e}},u=async e=>{try{const t=await(0,r.getStorage)("userToken");return(await a.default.get("".concat(n.API_BASE_URL,"/api/booking_drafts/v1/").concat(e,"/available_services/"),{headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"}})).data}catch(t){throw(0,r.debugLog)("MBA12345 Error fetching available services:",t),t}},m=async e=>{try{const t=await(0,r.getStorage)("userToken");return(await a.default.get("".concat(n.API_BASE_URL,"/api/booking_drafts/v1/").concat(e,"/available_pets/"),{headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"}})).data}catch(t){throw(0,r.debugLog)("MBA12345 Error fetching available pets:",t),t}},g=async e=>{try{const t=await(0,r.getStorage)("userToken");return(await a.default.post("".concat(n.API_BASE_URL,"/api/bookings/v1/").concat(e,"/approve/"),{},{headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"}})).data}catch(t){throw(0,r.debugLog)("Error approving booking:",t),t}},h=async e=>{try{const t=await(0,r.getStorage)("userToken");if(!t)throw new Error("No authentication token found");(0,r.debugLog)("MBA88899","Fetching booking details for ID:",e);const o=await a.default.get("".concat(n.API_BASE_URL,"/api/bookings/v1/").concat(e,"/details/"),{headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"}});return(0,r.debugLog)("MBA88899","Booking details fetched successfully"),o.data}catch(t){throw(0,r.debugLog)("MBA88899","Error fetching booking details:",t.response?.data||t.message),t}},f=async(e,t)=>{try{const o=await(0,r.getStorage)("userToken");if(!o)throw new Error("No authentication token found");(0,r.debugLog)("MBA88899 Requesting changes for booking ID:",e),(0,r.debugLog)("MBA88899 Change request message:",t);const i=await a.default.post("".concat(n.API_BASE_URL,"/api/bookings/v1/").concat(e,"/request-changes/"),{message:t},{headers:{Authorization:"Bearer ".concat(o),"Content-Type":"application/json"}});return(0,r.debugLog)("MBA88899 Change request submitted successfully"),i.data}catch(o){throw(0,r.debugLog)("MBA88899 Error requesting booking changes:",o),o}},p=async(e,t)=>{try{const o=await(0,r.getStorage)("userToken");if(!o)throw new Error("No authentication token found");const i=await a.default.patch("".concat(n.API_BASE_URL,"/api/booking_drafts/v1/").concat(e,"/update_pets_and_services/"),t,{headers:{Authorization:"Bearer ".concat(o),"Content-Type":"application/json"}});return(0,r.debugLog)("MBA12345 Draft update response:",i.data),i.data}catch(o){throw(0,r.debugLog)("MBA12345 Error updating booking draft:",o),o}},y=async(e,t,o,i,s)=>{try{(0,r.debugLog)("MBA5asdt3f4321 - Updating booking draft time and date:",{draftId:e,startDate:t,endDate:o,startTime:i,endTime:s});const l=await a.default.post("".concat(n.API_BASE_URL,"/api/booking_drafts/v1/update-time-and-date/").concat(e,"/"),{start_date:t,end_date:o,start_time:i,end_time:s},{headers:{Authorization:"Bearer ".concat(await(0,r.getStorage)("userToken")),"Content-Type":"application/json"}});return(0,r.debugLog)("MBA5asdt3f4321 - Booking draft time and date update response:",l.data),l.data}catch(l){throw(0,r.debugLog)("MBA5asdt3f4321 Error updating booking draft time and date:",l),l}},b=async(e,t,o)=>{try{const i=o?.timezone||"US/Mountain";(0,r.debugLog)("MBA8800: Updating booking draft multiple days:",{draftId:e,data:t,userTimezone:i});const l=t.dates.map((e=>{let o,a,n,l,d=!1;if(e.date&&e.start_time&&e.end_time)return(0,r.debugLog)("MBA8800: Using provided occurrence data format",e),{date:e.date,startTime:e.start_time,endDate:e.end_date||e.date,endTime:e.end_time,is_overnight:e.is_overnight||!1};if(e.date&&e.startTime&&e.endTime)return(0,r.debugLog)("MBA8800: Using provided date and times",e),{date:e.date,startTime:e.startTime,endDate:e.endDate||e.date,endTime:e.endTime,is_overnight:e.is_overnight||!1};if(!(e instanceof Date))throw(0,r.debugLog)("MBA8800: Unexpected date format",e),new Error("Unexpected date format");{o=(0,s.formatDateForAPI)(e);let i=t.times;const c=e.toISOString().split("T")[0];t.times[c]&&t.times.hasIndividualTimes&&(i=t.times[c]),a="string"===typeof i.startTime?i.startTime:void 0!==i.startTime?.hours?"".concat(String(i.startTime.hours).padStart(2,"0"),":").concat(String(i.startTime.minutes||0).padStart(2,"0")):"09:00",n="string"===typeof i.endTime?i.endTime:void 0!==i.endTime?.hours?"".concat(String(i.endTime.hours).padStart(2,"0"),":").concat(String(i.endTime.minutes||0).padStart(2,"0")):"17:00",(0,r.debugLog)("MBA8800: Formatted times for date:",c,{startTimeStr:a,endTimeStr:n});const u="00:00"===n,m=parseInt(n.split(":")[0],10)<parseInt(a.split(":")[0],10)||parseInt(n.split(":")[0],10)===parseInt(a.split(":")[0],10)&&parseInt(n.split(":")[1],10)<parseInt(a.split(":")[1],10),g=u||m,h=g?new Date(e.getTime()+864e5):new Date(e);l=(0,s.formatDateForAPI)(h),(0,r.debugLog)("MBA8800: End date calculation in API.js:",{needsNextDayDate:g,isMidnightEnd:u,isTimeBeforeStart:m,startTimeStr:a,endTimeStr:n,originalDate:o,calculatedEndDate:l}),d=i.isOvernightForced||!1}const{date:c,time:u}=(0,s.convertToUTC)(o,a,i),{date:m,time:g}=(0,s.convertToUTC)(l||o,n,i);return{date:c,startTime:u,endDate:m,endTime:g,is_overnight:d}}));(0,r.debugLog)("MBA8800: Converted UTC dates:",l);const d=await a.default.post("".concat(n.API_BASE_URL,"/api/booking_drafts/v1/update-multiple-days/").concat(e,"/"),{dates:l},{headers:{Authorization:"Bearer ".concat(await(0,r.getStorage)("userToken")),"Content-Type":"application/json"}});return(0,r.debugLog)("MBA8800: Booking draft multiple days update response:",d.data),d.data}catch(i){throw(0,r.debugLog)("MBA8800: Error updating booking draft multiple days:",i),i}},x=async(e,t)=>{try{(0,r.debugLog)("MBA5asdt3f4321 - Updating booking draft recurring dates:",{draftId:e,recurringData:t});const o=await a.default.post("".concat(n.API_BASE_URL,"/api/booking_drafts/v1/update-recurring/").concat(e,"/"),t,{headers:{Authorization:"Bearer ".concat(await(0,r.getStorage)("userToken")),"Content-Type":"application/json"}});return(0,r.debugLog)("MBA5asdt3f4321 - Booking draft recurring update response:",o.data),o.data}catch(o){throw(0,r.debugLog)("MBA5asdt3f4321 Error updating booking draft recurring dates:",o),o}},j=async()=>{try{const e=await(0,r.getStorage)("userToken");if(!e)throw new Error("No authentication token found");return(await a.default.get("".concat(n.API_BASE_URL,"/api/users/v1/time-settings/"),{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}})).data}catch(e){throw(0,r.debugLog)("MBA12345 Error fetching time settings",e),e}},w=async e=>{try{const t=await(0,r.getStorage)("userToken");if(!t)throw new Error("No authentication token found");const o="object"===typeof e?e:{timezone:e};(0,r.debugLog)("MBA12345 Sending time settings update",o);return(await a.default.post("".concat(n.API_BASE_URL,"/api/users/v1/update-time-settings/"),o,{headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"}})).data}catch(t){throw(0,r.debugLog)("MBA12345 Error updating time settings",t),t}},C=async()=>{try{const e=await(0,r.getStorage)("userToken");if(!e)throw new Error("No authentication token found");return(await a.default.get("".concat(n.API_BASE_URL,"/api/users/v1/get-name/"),{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}})).data}catch(e){throw(0,r.debugLog)("MBA12345 Error fetching user name",e),e}},v=async()=>{const e="".concat(n.API_BASE_URL,"/api/users/v1/profile/");try{const t=await(0,r.getStorage)("userToken");if(!t)throw new Error("No authentication token found");(0,r.debugLog)("MBA12345","Fetching user profile data");const o=await fetch(e,{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)}});if(!o.ok)throw new Error("HTTP error! status: ".concat(o.status));const a=await o.json();return(0,r.debugLog)("MBA12345","User profile data fetched successfully:",{name:a.name,email:a.email,address:a.address}),a}catch(t){throw(0,r.debugLog)("MBA12345","Error in userProfile:",t),t}},S=async e=>{try{(0,r.debugLog)("MBA76543","Updating profile info with data:",e);const t=await(0,r.getStorage)("userToken");if(!t)throw new Error("No authentication token found");const o=e instanceof FormData;(0,r.debugLog)("MBA76543","Making ".concat(o?"FormData":"JSON"," request to update profile"));const a=await fetch("".concat(n.API_BASE_URL,"/api/users/v1/update-profile/"),{method:"PATCH",headers:Object.assign({Authorization:"Bearer ".concat(t)},o?{}:{"Content-Type":"application/json"}),body:o?e:JSON.stringify(e)});if(!a.ok){const e=await a.text();throw new Error("HTTP error! status: ".concat(a.status,", message: ").concat(e))}const i=await a.json();return(0,r.debugLog)("MBA76543","Profile updated successfully with response:",i),i}catch(t){throw(0,r.debugLog)("MBA76543","Error updating profile info:",t),t}},T=async e=>{try{const t=await(0,r.getStorage)("userToken");if(!t)throw new Error("No authentication token found");(0,r.debugLog)("MBA789","Adding new pet with data:",e);const o=await a.default.post("".concat(n.API_BASE_URL,"/api/pets/v1/add-pet/"),e,{headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"}});return(0,r.debugLog)("MBA789","Pet added successfully:",o.data),o.data}catch(t){throw(0,r.debugLog)("MBA789","Error adding pet:",t),t}},B=async(e,t)=>{try{const o=await(0,r.getStorage)("userToken");if(!o)throw new Error("No authentication token found");(0,r.debugLog)("MBA789","Updating pet with ID:",e,"and data:",t);const i=await a.default.patch("".concat(n.API_BASE_URL,"/api/pets/v1/").concat(e,"/"),t,{headers:{Authorization:"Bearer ".concat(o),"Content-Type":"application/json"}});return(0,r.debugLog)("MBA789","Pet updated successfully:",i.data),i.data}catch(o){throw(0,r.debugLog)("MBA789","Error updating pet:",o),o}},k=async e=>{try{const t=await(0,r.getStorage)("userToken");if(!t)throw new Error("No authentication token found");(0,r.debugLog)("MBA789","Fixing owner for pet with ID:",e);const o=await a.default.post("".concat(n.API_BASE_URL,"/api/pets/v1/").concat(e,"/fix-owner/"),{},{headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"}});return(0,r.debugLog)("MBA789","Pet owner fixed successfully:",o.data),o.data}catch(t){throw(0,r.debugLog)("MBA789","Error fixing pet owner:",t),t}},_=async e=>{try{(0,r.debugLog)("MBA54321","Creating new service - sending data to backend:",e);let t={};e.animal_types&&Array.isArray(e.animal_types)?e.animal_types.forEach((e=>{"object"===typeof e&&e.name&&e.category?t[e.name]=e.category:"string"===typeof e&&(t[e]="Other")})):e.animal_types&&"object"===typeof e.animal_types?t=e.animal_types:e.animal_type?t[e.animal_type]="Other":t.Other="Other";const o=(e.additional_rates||[]).map((e=>Object.assign({},e,{rate:String(e.rate)}))),a=Object.assign({},e,{base_rate:String(e.base_rate),additional_animal_rate:String(e.additional_animal_rate||0),holiday_rate:String(e.holiday_rate||0),animal_types:t,additional_rates:o});(0,r.debugLog)("MBA54321","Sending additional rates to backend:",a.additional_rates);const n=await d(),i=await n.post("/api/services/v1/create/",a);return(0,r.debugLog)("MBA54321","Service created successfully - backend response:",i.data),i.data}catch(t){(0,r.debugLog)("MBA54321","Error creating service:",t),(0,r.debugLog)("MBA54321","Error response data:",t.response?.data);const e=l(t);if(e!==t)throw e;throw t}},A=async e=>{try{(0,r.debugLog)("MBA7890: Deleting service with ID:",e);const t=await d(),o=await t.delete("/api/services/v1/delete/".concat(e,"/"));return(0,r.debugLog)("MBA7890: Service deleted successfully - backend response:",o.data),o.data}catch(t){throw(0,r.debugLog)("MBA7890: Error deleting service:",t),(0,r.debugLog)("MBA7890: Error response data:",t.response?.data),t}},I=async e=>{try{const t=await d();(0,r.debugLog)("API updateService","Updating service with data:",e);const o=await t.patch("/api/services/v1/update/".concat(e.service_id,"/"),e);return(0,r.debugLog)("API updateService Response:",o.data),o.data}catch(t){throw(0,r.debugLog)("API updateService Error:",t.response?.data||t.message),t}},D=async(e=1)=>{try{(0,r.debugLog)("MBA4321 Fetching client connections, page:",e);const t=await d(),o=await t.get("/api/bookings/v1/connections/",{params:{page:e}});return(0,r.debugLog)("MBA4321 Connections response:",o.data),o.data}catch(t){if((0,r.debugLog)("MBA4321 Error fetching connections:",t),(0,r.debugLog)("MBA4321 Error details:",t.response?.data||t.message),401===t.response?.status)throw l(t);throw t}},M=async(e,t="client")=>{try{(0,r.debugLog)("MBA4321 Fetching connection profile:",{userId:e,type:t});const o=await d(),a=await o.get("/api/connections/v1/profile/".concat(e,"/"),{params:{type:t}});return(0,r.debugLog)("MBA4321 Connection profile response:",a.data),a.data}catch(o){if((0,r.debugLog)("MBA4321 Error fetching connection profile:",o),(0,r.debugLog)("MBA4321 Error details:",o.response?.data||o.message),401===o.response?.status)throw l(o);throw o}},R=async(e="email",t=null)=>{try{(0,r.debugLog)("MBA4321 Inviting client:",{type:e,email:t});const o=await d(),a=await o.post("/api/users/v1/invitations/",{type:e,email:t,is_professional_invite:!0});return(0,r.debugLog)("MBA4321 Invite client response:",a.data),a.data}catch(o){if((0,r.debugLog)("MBA4321 Error inviting client:",o),(0,r.debugLog)("MBA4321 Error details:",o.response?.data||o.message),401===o.response?.status)throw l(o);throw o}},P=async(e="email",t=null,o)=>{try{(0,r.debugLog)("MBA4321 Sending referral:",{type:e,email:t,referralType:o});const a=await d(),n=await a.post("/api/users/v1/invitations/",{type:e,email:t,is_professional_invite:!1,referral_type:o});return(0,r.debugLog)("MBA4321 Send referral response:",n.data),n.data}catch(a){if((0,r.debugLog)("MBA4321 Error sending referral:",a),(0,r.debugLog)("MBA4321 Error details:",a.response?.data||a.message),401===a.response?.status)throw l(a);throw a}},z=async(e="all")=>{try{(0,r.debugLog)("MBA4321 Getting invitations:",{type:e});const t=await d(),o=await t.get("/api/users/v1/invitations/?type=".concat(e));return(0,r.debugLog)("MBA4321 Get invitations response:",o.data),o.data}catch(t){if((0,r.debugLog)("MBA4321 Error getting invitations:",t),(0,r.debugLog)("MBA4321 Error details:",t.response?.data||t.message),401===t.response?.status)throw l(t);throw t}},F=async e=>{try{(0,r.debugLog)("MBA4321 Getting invitation details:",{token:e});const t=await d(),o=await t.get("/api/users/v1/invitations/".concat(e,"/"));return(0,r.debugLog)("MBA4321 Get invitation details response:",o.data),o.data}catch(t){if((0,r.debugLog)("MBA4321 Error getting invitation details:",t),(0,r.debugLog)("MBA4321 Error details:",t.response?.data||t.message),401===t.response?.status)throw l(t);throw t}},L=async e=>{try{(0,r.debugLog)("MBA4321 Verifying invitation:",{token:e}),(0,r.debugLog)("MBA4321 Verification endpoint:","".concat(n.API_BASE_URL,"/api/users/v1/invitations/").concat(e,"/verify/"));const t=await a.default.get("".concat(n.API_BASE_URL,"/api/users/v1/invitations/").concat(e,"/verify/"));return(0,r.debugLog)("MBA4321 Verify invitation response:",t.data),t.data}catch(t){throw(0,r.debugLog)("MBA4321 Error verifying invitation:",t),(0,r.debugLog)("MBA4321 Error details:",t.response?.data||t.message),t}},O=async e=>{try{(0,r.debugLog)("MBA4321 Accepting invitation:",{token:e});const t=await d(),o=await t.post("/api/users/v1/invitations/".concat(e,"/accept/"));return(0,r.debugLog)("MBA4321 Accept invitation response:",o.data),o.data}catch(t){if((0,r.debugLog)("MBA4321 Error accepting invitation:",t),(0,r.debugLog)("MBA4321 Error details:",t.response?.data||t.message),401===t.response?.status)throw l(t);throw t}},E=async e=>{try{(0,r.debugLog)("MBA4321 Deleting invitation:",{token:e});const t=await d();return await t.delete("/api/users/v1/invitations/".concat(e,"/")),(0,r.debugLog)("MBA4321 Delete invitation success"),!0}catch(t){if((0,r.debugLog)("MBA4321 Error deleting invitation:",t),(0,r.debugLog)("MBA4321 Error details:",t.response?.data||t.message),401===t.response?.status)throw l(t);throw t}},W=async e=>{try{(0,r.debugLog)("MBA4321 Resending invitation:",{token:e});const t=await d(),o=await t.post("/api/users/v1/invitations/".concat(e,"/resend/"));return(0,r.debugLog)("MBA4321 Resend invitation response:",o.data),o.data}catch(t){if((0,r.debugLog)("MBA4321 Error resending invitation:",t),(0,r.debugLog)("MBA4321 Error details:",t.response?.data||t.message),401===t.response?.status)throw l(t);throw t}},N=async(e,t)=>{try{(0,r.debugLog)("MBA98765 - Updating booking draft rates:",{draftId:e,occurrences:t});const o=await a.default.post("".concat(n.API_BASE_URL,"/api/booking_drafts/v1/update-rates/").concat(e,"/"),{occurrences:t},{headers:{Authorization:"Bearer ".concat(await(0,r.getStorage)("userToken")),"Content-Type":"application/json"}});return(0,r.debugLog)("MBA98765 - Booking draft rates update response:",o.data),o.data}catch(o){throw(0,r.debugLog)("MBA98765 Error updating booking draft rates:",o),o}},H=async e=>{try{(0,r.debugLog)("MBA66777 - Creating booking from draft:",{conversationId:e});const t=await a.default.post("".concat(n.API_BASE_URL,"/api/bookings/v1/create-from-draft/"),{conversation_id:e},{headers:{Authorization:"Bearer ".concat(await(0,r.getStorage)("userToken")),"Content-Type":"application/json"}});return(0,r.debugLog)("MBA66777 - Booking created from draft:",t.data),t.data}catch(t){throw(0,r.debugLog)("MBA66777 Error creating booking from draft:",t),t}},U=async()=>{try{const e=await d();(0,r.debugLog)("MBA4321: Fetching unread message count");const t=await e.get("/api/messages/v1/unread-count/");return(0,r.debugLog)("MBA4321: Unread count fetched:",t.data),t.data}catch(e){if((0,r.debugLog)("MBA4321: Error with unread message count:",e.message),401===e.response?.status)throw l(e);return{unread_count:0,unread_conversations:0}}},V=async e=>{try{const t=await(0,r.getStorage)("userToken");if(!t)throw new Error("No authentication token found");(0,r.debugLog)("MBA9876: Fetching booking draft dates and times:",e);const o=await a.default.get("".concat(n.API_BASE_URL,"/api/booking_drafts/v1/").concat(e,"/dates_and_times/"),{headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"}});return(0,r.debugLog)("MBA9876: Draft dates and times fetched successfully"),o.data}catch(t){throw(0,r.debugLog)("MBA9876: Error fetching booking draft dates and times:",t),t}},q=async e=>{try{(0,r.debugLog)("MBA6428: Creating draft from booking:",{bookingId:e});const t=await(0,r.getStorage)("userToken");if(!t)throw new Error("No authentication token found");const o=await a.default.post("".concat(n.API_BASE_URL,"/api/booking_drafts/v1/create-from-booking/").concat(e,"/"),{},{headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"}});return(0,r.debugLog)("MBA6428: Draft created successfully:",o.data),o.data}catch(t){if((0,r.debugLog)("MBA6428: Error creating draft from booking:",t),t.response?.data)return{error:!0,status:t.response.status,message:t.response.data.error||"Failed to create draft from booking",data:t.response.data};throw t}}},45010:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>v,handleBack:()=>w,navigateToFrom:()=>C});var a=o(36665),n=o(73929),r=o(6283),i=o(14732),s=o(15648),l=o(26725),d=o(95991),c=o(40484),u=o(7869),m=o(6541),g=o(38432),h=o(59742),f=o(91087),p=o(16204),y=o(15558),b=o(60397);let x,j;const w=async e=>{try{if("web"===d.default.OS)if(x=sessionStorage.getItem("previousRoute"),j=sessionStorage.getItem("currentRoute"),x){console.log("MBA98386196v Previous Route Before:",x),console.log("MBA98386196v Current Route Before:",j);const t=sessionStorage.getItem("prevPrevRoute");e.navigate(x),sessionStorage.setItem("currentRoute",x),sessionStorage.setItem("previousRoute",t||""),console.log("MBA98386196v Previous Route After:",sessionStorage.getItem("previousRoute")),console.log("MBA98386196v Current Route After:",sessionStorage.getItem("currentRoute"))}else console.log("MBA98386196v No Previous Route"),e.navigate("More");else if(x=await f.default.getItem("previousRoute"),j=await f.default.getItem("currentRoute"),x){const t=await f.default.getItem("prevPrevRoute");e.navigate(x),await f.default.setItem("currentRoute",x),await f.default.setItem("previousRoute",t||""),console.log("MBA98386196v Previous Route:",x),console.log("MBA98386196v Current Route:",j)}else e.navigate("More");if(x===j)return void e.navigate("More")}catch(t){console.error("Error handling back navigation:",t),e.navigate("More")}},C=async(e,t,o,a={})=>{try{if("web"===d.default.OS){const e=sessionStorage.getItem("previousRoute");e&&sessionStorage.setItem("prevPrevRoute",e),sessionStorage.setItem("previousRoute",o),sessionStorage.setItem("currentRoute",t),console.log("MBA98386196v Web - Set previousRoute:",o),console.log("MBA98386196v Web - Set currentRoute:",t)}else{const e=await f.default.getItem("previousRoute");e&&await f.default.setItem("prevPrevRoute",e),await f.default.setItem("previousRoute",o),await f.default.setItem("currentRoute",t),console.log("MBA98386196v Mobile - Set previousRoute:",o),console.log("MBA98386196v Mobile - Set currentRoute:",t)}a.screen?(console.log("MBA98386196v Navigating to tab:",a.screen,"within screen:",t),"MyProfile"===t?(console.log("MBA98386196v Special handling for MyProfile screen"),"web"===d.default.OS?sessionStorage.setItem("myProfileActiveTab",a.screen):await f.default.setItem("myProfileActiveTab",a.screen),e.reset({index:0,routes:[{name:t,params:Object.assign({},a,{initialTab:a.screen})}]})):e.reset({index:0,routes:[{name:t,params:a}]})):e.navigate(t,a)}catch(n){console.error("Error navigating:",n),e.navigate(t,a)}};function v({state:e,descriptors:t,navigation:i}){const[x,j]=(0,a.useState)(!1),[w,v]=(0,a.useState)(l.default.get("window").width<900),[T,B]=(0,a.useState)(!1),{colors:k}=(0,p.useTheme)(),{isSignedIn:_,is_DEBUG:A,userRole:I,isCollapsed:D,setIsCollapsed:M,switchRole:R,screenWidth:P,signOut:z,isApprovedProfessional:F}=(0,a.useContext)(g.AuthContext),{hasUnreadMessages:L,unreadCount:O,resetNotifications:E,updateRoute:W}=(0,a.useContext)(h.default),[N,H]=(0,a.useState)(""),[U,V]=(0,a.useState)(3);(0,a.useEffect)((()=>{A&&console.log("MBA98386196v Navigation State Update:",{isSignedIn:_,userRole:I,isApprovedProfessional:F,currentRoute:N})}),[_,I,F,N]);const q=()=>B(!T);(0,a.useEffect)((()=>{const e=l.default.addEventListener("change",(()=>{v(l.default.get("window").width<900)}));return()=>{e?.remove()}}),[]),(0,a.useEffect)((()=>{const e=async()=>{try{let e;e="web"===d.default.OS?sessionStorage.getItem("currentRoute"):await f.default.getItem("currentRoute"),A&&e!==N&&console.log("MBA98386196v Current Route Updated:",e),e&&e!==N&&(H(e),W&&W(e),"MessageHistory"===e&&L&&E&&E(e))}catch(e){console.error("Error updating current route:",e)}};e();return i.addListener("state",e)}),[i,E,W,L,A]);d.default.OS;const Y=async(e,t=null)=>{j(!1),A&&(console.log("MBA98386196v Navigating to:",e,t?"with tab: ".concat(t):""),console.log("MBA98386196v Current route before:",N));try{if(e===N)return void("MessageHistory"===e&&L&&E&&E());"web"===d.default.OS?(sessionStorage.setItem("previousRoute",N),sessionStorage.setItem("currentRoute",e)):(await f.default.setItem("previousRoute",N),await f.default.setItem("currentRoute",e)),H(e),W&&W(e),"MessageHistory"===e&&L&&E&&E(),t?C(i,e,N,{screen:t}):C(i,e,N),A&&console.log("MBA98386196v Current route after:",e)}catch(o){console.error("Error handling navigation:",o),C(i,e,N)}};(0,a.useEffect)((()=>{(async()=>{try{if("web"===d.default.OS){if(!sessionStorage.getItem("currentRoute")){const e=_?"Dashboard":"Home";sessionStorage.setItem("currentRoute",e)}}else{if(!await f.default.getItem("currentRoute")){const e=_?"Dashboard":"Home";await f.default.setItem("currentRoute",e)}}}catch(e){console.error("Error initializing route tracking:",e)}})()}),[_,I]);const G=async e=>{try{const t=N;switch(A&&console.log("MBA98386196v Role switch initiated:",{from:I,to:e,currentScreen:t}),await R(e),"web"===d.default.OS?sessionStorage.setItem("userRole",e):await f.default.setItem("userRole",e),t){case"MyProfile":const o=i.getState().routes.find((e=>"MyProfile"===e.name))?.params,a=o?.screen||o?.initialTab||"profile_info";A&&console.log("MBA98386196v MyProfile tab preservation:",{currentTab:a,newRole:e});let n=a;"owner"===e&&"services_availability"===a&&(n="profile_info"),C(i,"MyProfile",t,{screen:n});break;case"MessageHistory":C(i,"MessageHistory",t);break;case"MyBookings":const r="professional"===e?"professional":"owner";A&&console.log("MBA98386196v MyBookings tab switch:",{newRole:e,activeTab:r}),C(i,"MyBookings",t,{screen:r});break;case"Connections":const s="professional"===e?"clients":"professionals";A&&console.log("MBA98386196v Connections tab switch:",{newRole:e,connectionsTab:s}),C(i,"Connections",t,{screen:s});break;case"Dashboard":C(i,"Dashboard",t);break;case"SearchProfessionalsListing":C(i,"professional"===e?"Dashboard":t,t);break;case"ServiceManager":C(i,"owner"===e?"Dashboard":t,t);break;default:C(i,t,t)}}catch(t){console.error("Error switching role:",t)}},J=async()=>{try{A&&console.log("MBA98386196v Logging out user"),await z(),"web"===d.default.OS?(sessionStorage.removeItem("currentRoute"),sessionStorage.removeItem("previousRoute"),sessionStorage.removeItem("userRole")):(await f.default.removeItem("currentRoute"),await f.default.removeItem("previousRoute"),await f.default.removeItem("userRole")),H(""),i.navigate("SignIn")}catch(e){console.error("Error during logout:",e)}},$=()=>_?"professional"===I?[{title:"Dashboard",icon:"view-dashboard",route:"Dashboard"},{title:"Messages",icon:"message-text",route:"MessageHistory"},{title:"Services",icon:"briefcase",route:"ServiceManager"},{title:"Connections",icon:"account-group",route:"Connections"},{title:"Profile",icon:"account",route:"MyProfile",tab:"profile_info"}]:[{title:"Dashboard",icon:"view-dashboard",route:"Dashboard"},{title:"Messages",icon:"message-text",route:"MessageHistory"},{title:"Profile",icon:"account",route:"MyProfile",tab:"profile_info"}]:w?[{title:"Sign In",icon:"login",route:"SignIn"},{title:"Sign Up",icon:"account-plus",route:"SignUp"},{title:"Become a Pro",icon:"account-heart",route:"BecomeProfessional"},{title:"Search Pros",icon:"magnify",route:"SearchProfessionalsListing"},{title:"More",icon:"dots-horizontal",route:"More"}]:[{title:"Sign In",icon:"login",route:"SignIn"},{title:"Sign Up",icon:"account-plus",route:"SignUp"},{title:"More",icon:"dots-horizontal",route:"More"}];return(0,b.jsx)(b.Fragment,{children:"web"===d.default.OS?(0,b.jsxs)(b.Fragment,{children:[!w&&_&&(0,b.jsx)(n.default,{style:S.navContainer,children:(()=>{const e=$(),t=D?70:250,a="professional"===I,i="petOwner"===I;return A&&console.log("MBA98386196v Rendering Sidebar:",{userRole:I,isApprovedProfessional:F,currentRoute:N,isProfessionalRole:a,isOwnerRole:i}),(0,b.jsxs)(n.default,{style:[S.sidebarContainer,{width:t}],children:[(0,b.jsx)(n.default,{style:S.sidebarLogoContainer,children:(0,b.jsx)(s.default,{onPress:()=>Y("Home","Overview"),style:S.logoButton,children:(0,b.jsx)(c.default,{source:o(18827),style:[S.sidebarLogo,{width:D?40:150,tintColor:m.theme.colors.primary}],resizeMode:"contain"})})}),(0,b.jsx)(s.default,{style:S.collapseButton,onPress:()=>M(!D),children:(0,b.jsx)(u.default,{name:D?"chevron-right":"chevron-left",size:24,color:m.theme.colors.primary})}),(0,b.jsxs)(n.default,{style:S.menuItems,children:[!D&&(0,b.jsxs)(n.default,{style:S.roleToggleContainer,children:[(0,b.jsx)(r.default,{style:S.roleToggleTitle,children:"Switch Role:"}),(0,b.jsxs)(n.default,{style:S.roleButtonsContainer,children:[(0,b.jsx)(s.default,{style:[S.roleButton,i&&S.roleButtonActive],onPress:()=>{A&&console.log("MBA98386196v Owner Role Button Press:",{currentRole:I,isApprovedProfessional:F}),a&&G("owner")},activeOpacity:.7,children:(0,b.jsx)(r.default,{style:[S.roleButtonText,i&&S.roleButtonTextActive],children:"Owner"})}),(0,b.jsx)(s.default,{style:[S.roleButton,a&&S.roleButtonActive,!F&&S.roleButtonDisabled],onPress:()=>{A&&console.log("MBA98386196v Professional Role Button Press:",{currentRole:I,isApprovedProfessional:F}),i&&F&&G("professional")},disabled:!F,activeOpacity:F?.7:1,children:(0,b.jsx)(r.default,{style:[S.roleButtonText,a&&S.roleButtonTextActive,!F&&S.roleButtonTextDisabled],children:"Professional"})})]})]}),e.map(((e,t)=>{const o=N===e.route||"More"===e.route&&"Settings"===e.title&&"More"===N,a="Messages"===e.title&&L;return(0,b.jsxs)(s.default,{style:[S.sidebarItem,o&&S.activeItem],onPress:()=>Y(e.route,e.tab||"Overview"),children:[(0,b.jsxs)(n.default,{style:{position:"relative"},children:[(0,b.jsx)(u.default,{name:e.icon,size:24,color:o?m.theme.colors.primary:"#4B5563"}),a&&(0,b.jsx)(n.default,{style:S.messageNotificationBadge,children:O>0&&(0,b.jsx)(r.default,{style:S.messageNotificationText,children:O})})]}),!D&&(0,b.jsxs)(r.default,{style:[S.sidebarItemText,{color:o?m.theme.colors.primary:"#4B5563"}],children:[e.title,"Messages"===e.title&&L&&O>0&&(0,b.jsx)(r.default,{style:{color:m.theme.colors.error},children:" (".concat(O,")")})]})]},t)}))]}),(0,b.jsxs)(s.default,{style:[S.logoutButton,{width:t}],onPress:J,children:[(0,b.jsx)(u.default,{name:"logout",size:24,color:"#F26969"}),!D&&(0,b.jsx)(r.default,{style:S.logoutText,children:"Logout"})]})]})})()}),(w||!_)&&(()=>{const e=P<=470?{width:100,height:30}:{width:150,height:40},t="professional"===I,a="petOwner"===I;return(0,b.jsxs)(n.default,{style:[S.mobileHeader,{backgroundColor:m.theme.colors.surfaceContrast}],children:[(0,b.jsxs)(n.default,{style:S.mobileHeaderContent,children:[(0,b.jsx)(s.default,{onPress:()=>Y("Home","Overview"),style:S.logoButton,children:(0,b.jsx)(c.default,{source:o(18827),style:[S.mobileLogo,{tintColor:m.theme.colors.primary},e]})}),(0,b.jsx)(n.default,{style:S.mobileRightContent,children:(0,b.jsx)(s.default,{onPress:q,style:S.profileContainer,children:_?(0,b.jsx)(y.default,{size:40,source:o(4456)}):(0,b.jsx)(u.default,{name:"menu",size:28,color:m.theme.colors.text})})})]}),T&&(0,b.jsxs)(n.default,{style:[S.mobileMenu,{backgroundColor:m.theme.colors.surfaceContrast}],children:[_&&(0,b.jsxs)(n.default,{style:S.mobileRoleToggleContainer,children:[(0,b.jsx)(r.default,{style:S.mobileRoleToggleTitle,children:"Switch Role:"}),(0,b.jsxs)(n.default,{style:S.mobileRoleButtonsContainer,children:[(0,b.jsx)(s.default,{style:[S.mobileRoleButton,a&&S.mobileRoleButtonActive],onPress:()=>{A&&console.log("MBA98386196v Mobile Owner Role Button Press:",{currentRole:I,isApprovedProfessional:F}),t&&(G("owner"),B(!1))},activeOpacity:.7,children:(0,b.jsx)(r.default,{style:[S.mobileRoleButtonText,a&&S.mobileRoleButtonTextActive],children:"Owner"})}),(0,b.jsx)(s.default,{style:[S.mobileRoleButton,t&&S.mobileRoleButtonActive,!F&&S.mobileRoleButtonDisabled],onPress:()=>{A&&console.log("MBA98386196v Mobile Professional Role Button Press:",{currentRole:I,isApprovedProfessional:F}),a&&F&&(G("professional"),B(!1))},disabled:!F,activeOpacity:F?.7:1,children:(0,b.jsx)(r.default,{style:[S.mobileRoleButtonText,t&&S.mobileRoleButtonTextActive,!F&&S.mobileRoleButtonTextDisabled],children:"Professional"})})]})]}),$().map(((e,t)=>{const o="Messages"===e.title&&L;return(0,b.jsxs)(s.default,{style:S.mobileMenuItem,onPress:()=>{Y(e.route,e.tab||"Overview"),B(!1)},children:[(0,b.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",position:"relative"},children:[(0,b.jsx)(u.default,{name:e.icon,size:24,color:m.theme.colors.text}),o&&(0,b.jsx)(n.default,{style:S.mobileMessageNotificationBadge,children:O>0&&(0,b.jsx)(r.default,{style:S.mobileMessageNotificationText,children:O})})]}),(0,b.jsxs)(r.default,{style:S.mobileMenuItemText,children:[e.title,"Messages"===e.title&&L&&O>0&&(0,b.jsx)(r.default,{style:{color:m.theme.colors.error},children:" (".concat(O,")")})]})]},t)})),_&&(0,b.jsxs)(s.default,{style:[S.mobileMenuItem,S.mobileLogoutItem],onPress:()=>{J(),B(!1)},children:[(0,b.jsx)(u.default,{name:"logout",size:24,color:"#F26969"}),(0,b.jsx)(r.default,{style:[S.mobileMenuItemText,S.mobileLogoutText],children:"Logout"})]})]})]})})()]}):(0,b.jsx)(n.default,{style:S.container,children:(()=>{const e=$(),t=l.default.get("window").width/e.length;return(0,b.jsx)(n.default,{style:[S.customNavBar,{backgroundColor:m.theme.colors.surfaceContrast}],children:e.map(((e,o)=>(0,b.jsxs)(s.default,{style:[S.navButton,{width:t}],onPress:()=>Y(e.route,e.tab),children:[(0,b.jsx)(u.default,{name:e.icon,size:24,color:m.theme.colors.text}),(0,b.jsx)(r.default,{style:[S.navText,{color:m.theme.colors.text}],numberOfLines:2,ellipsizeMode:"tail",children:e.title})]},o)))})})()})})}const S=i.default.create({container:{display:"flex",backgroundColor:m.theme.colors.primary},content:{flex:1},header:{backgroundColor:m.theme.colors.primary},titleContainer:{justifyContent:"center"},titleContainer2:{flex:1,justifyContent:"center",flexDirection:"row",justifyContent:"flex-start"},title:{textAlign:"left",marginLeft:m.theme.spacing.medium,fontSize:m.theme.fontSizes.large,color:m.theme.colors.text,fontWeight:"bold",fontFamily:m.theme.fonts.header.fontFamily},desktopNav:{flexDirection:"row",justifyContent:"flex-end",alignItems:"center"},navItem:{marginHorizontal:m.theme.spacing.medium,fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,cursor:"pointer",fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"600"},customNavBar:{flexDirection:"row",justifyContent:"space-around",alignItems:"center",backgroundColor:m.theme.colors.primary,position:"absolute",bottom:0,left:0,right:0,paddingVertical:10,borderTopWidth:1,borderTopColor:m.theme.colors.border},navButton:{alignItems:"center",justifyContent:"center",height:60,paddingHorizontal:5},navText:{color:m.theme.colors.whiteText,fontSize:m.theme.fontSizes.small,marginTop:5,textAlign:"center",fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"600"},webNavItem:{marginHorizontal:m.theme.spacing.medium},webNavText:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.whiteText,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"600"},navLinkContainer:{flexDirection:"row",alignItems:"center",marginHorizontal:6},sidebarContainer:{height:"100%",minHeight:"100vh",backgroundColor:m.theme.colors.surfaceContrast,borderRightWidth:0,position:"fixed",left:0,top:0,bottom:0,zIndex:1e3,display:"flex",flexDirection:"column",transition:"width 0.3s ease",borderTopRightRadius:24,borderBottomRightRadius:24},sidebarLogoContainer:{padding:16,borderBottomWidth:3,borderBottomColor:m.theme.colors.surface,alignItems:"center",backgroundColor:m.theme.colors.surfaceContrast},logoButton:{alignItems:"center"},sidebarLogo:{height:50,resizeMode:"contain"},collapseButton:{position:"absolute",right:-16,top:"50%",transform:[{translateY:-20}],width:32,height:40,backgroundColor:m.theme.colors.surfaceContrast,borderWidth:0,borderRadius:8,justifyContent:"center",alignItems:"center",zIndex:1001},menuItems:{flex:1,padding:16,backgroundColor:m.theme.colors.surfaceContrast},sidebarItem:{flexDirection:"row",alignItems:"center",padding:12,marginBottom:8,borderRadius:8,backgroundColor:"transparent",cursor:"pointer"},sidebarItemText:{marginLeft:12,fontSize:m.theme.fontSizes.medium,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"500"},logoutButton:{width:"100%",padding:16,flexDirection:"row",alignItems:"center",borderTopWidth:0,backgroundColor:m.theme.colors.surfaceContrast,borderBottomRightRadius:24},logoutText:{marginLeft:12,fontSize:m.theme.fontSizes.medium,color:"#F26969",fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"500"},headerRight:{flexDirection:"row",alignItems:"center",gap:16,marginRight:16},notificationButton:{position:"relative",padding:8},notificationBadge:{position:"absolute",top:4,right:4,backgroundColor:m.theme.colors.error,borderRadius:10,minWidth:20,height:20,justifyContent:"center",alignItems:"center"},notificationCount:{color:m.theme.colors.whiteText,fontSize:12,fontWeight:"bold"},profileButton:{borderRadius:20,overflow:"hidden"},menuContent:{marginTop:45},mobileHeader:{width:"100%",paddingVertical:10,paddingHorizontal:20,borderBottomWidth:1,borderBottomColor:"rgba(255,255,255,0.1)",position:"relative"},mobileHeaderContent:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:"100%"},mobileLogo:{resizeMode:"contain"},mobileRightContent:{flexDirection:"row",alignItems:"center",gap:15},mobileMenu:{position:"absolute",top:"100%",right:20,backgroundColor:m.theme.colors.surface,borderRadius:8,padding:8,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:3.84,elevation:5,zIndex:1e3,minWidth:200},mobileMenuItem:{flexDirection:"row",alignItems:"center",padding:12,borderRadius:8},mobileMenuItemText:{marginLeft:12,fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},profileContainer:{width:40,height:40,borderRadius:20,overflow:"hidden"},iconButton:{padding:8,position:"relative"},notificationText:{color:m.theme.colors.whiteText,fontSize:12,fontWeight:"bold"},navContainer:{position:"fixed",top:0,left:0,bottom:0,zIndex:1e3,backgroundColor:m.theme.colors.surface,borderRightWidth:1,borderRightColor:m.theme.colors.border},activeItem:{backgroundColor:"#F0F9E5"},roleToggleContainer:{padding:12,marginBottom:16,borderRadius:8,backgroundColor:"#F0F9E5"},roleToggleTitle:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"600",marginBottom:8},roleButtonsContainer:{flexDirection:"row",gap:8},roleButton:{flex:1,padding:8,borderRadius:6,alignItems:"center",justifyContent:"center",borderWidth:1,borderColor:m.theme.colors.primary,cursor:"pointer"},roleButtonDisabled:{opacity:.5,borderColor:m.theme.colors.border,cursor:"not-allowed"},roleButtonText:{fontSize:m.theme.fontSizes.small,fontFamily:m.theme.fonts.regular.fontFamily,color:m.theme.colors.primary},roleButtonTextDisabled:{color:m.theme.colors.border},roleButtonActive:{backgroundColor:m.theme.colors.primary},roleButtonTextActive:{color:m.theme.colors.surface},mobileRoleToggleContainer:{padding:16,marginBottom:8,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},mobileRoleToggleTitle:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"600",marginBottom:8},mobileRoleButtonsContainer:{flexDirection:"row",gap:8},mobileRoleButton:{flex:1,padding:8,borderRadius:6,alignItems:"center",justifyContent:"center",borderWidth:1,borderColor:m.theme.colors.primary},mobileRoleButtonDisabled:{opacity:.5,borderColor:m.theme.colors.border},mobileRoleButtonText:{fontSize:m.theme.fontSizes.small,fontFamily:m.theme.fonts.regular.fontFamily,color:m.theme.colors.primary},mobileRoleButtonTextDisabled:{color:m.theme.colors.border},mobileRoleButtonActive:{backgroundColor:m.theme.colors.primary},mobileRoleButtonTextActive:{color:m.theme.colors.surface},mobileLogoutItem:{borderTopWidth:1,borderTopColor:m.theme.colors.border,marginTop:8},mobileLogoutText:{color:"#F26969"},messageNotificationDot:{position:"absolute",top:-2,right:-2,width:10,height:10,borderRadius:5,backgroundColor:m.theme.colors.error,borderWidth:1,borderColor:m.theme.colors.surface},mobileMessageNotificationDot:{position:"absolute",top:-2,right:-2,width:8,height:8,borderRadius:4,backgroundColor:m.theme.colors.error,borderWidth:1,borderColor:m.theme.colors.surfaceContrast},messageNotificationBadge:{position:"absolute",top:-8,right:-8,minWidth:18,height:18,borderRadius:9,backgroundColor:m.theme.colors.error,borderWidth:1,borderColor:m.theme.colors.surface,justifyContent:"center",alignItems:"center",paddingHorizontal:2},messageNotificationText:{color:"white",fontSize:10,fontWeight:"bold"},mobileMessageNotificationBadge:{position:"absolute",top:-8,right:-8,minWidth:16,height:16,borderRadius:8,backgroundColor:m.theme.colors.error,borderWidth:1,borderColor:m.theme.colors.surfaceContrast,justifyContent:"center",alignItems:"center",paddingHorizontal:2},mobileMessageNotificationText:{color:"white",fontSize:9,fontWeight:"bold"}})},19620:(e,t,o)=>{"use strict";o.r(t),o.d(t,{API_BASE_URL:()=>s});var a=o(95991);const n=(e,t)=>{console.log("MBA1234: Current process.env.NODE_ENV:","staging"),t?console.log(e,t):console.log(e)};console.log("MBA1234: All environment variables:",{NODE_ENV:"staging",process_env_NODE_ENV:"staging",STAGING_API_BASE_URL_ANDROID:"https://staging-eb.crittrcove.com",STAGING_API_BASE_URL_IOS:"https://staging-eb.crittrcove.com",STAGING_API_BASE_URL_WEB:"https://staging-eb.crittrcove.com",PRODUCTION_API_BASE_URL_ANDROID:"http://localhost:8000",PRODUCTION_API_BASE_URL_IOS:"http://localhost:8000",PRODUCTION_API_BASE_URL_WEB:"http://localhost:8000",DEV_API_BASE_URL_ANDROID:"http://10.0.2.2:8000",DEV_API_BASE_URL_IOS:"http://127.0.0.1:8000",DEV_API_BASE_URL_WEB:"http://localhost:8000",platform:a.default.OS}),n("MBA1234: Environment Variables Loaded",{NODE_ENV:"staging",STAGING_API_BASE_URL_ANDROID:"https://staging-eb.crittrcove.com",STAGING_API_BASE_URL_IOS:"https://staging-eb.crittrcove.com",STAGING_API_BASE_URL_WEB:"https://staging-eb.crittrcove.com",PRODUCTION_API_BASE_URL_ANDROID:"http://localhost:8000",PRODUCTION_API_BASE_URL_IOS:"http://localhost:8000",PRODUCTION_API_BASE_URL_WEB:"http://localhost:8000",DEV_API_BASE_URL_ANDROID:"http://10.0.2.2:8000",DEV_API_BASE_URL_IOS:"http://127.0.0.1:8000",DEV_API_BASE_URL_WEB:"http://localhost:8000",platform:a.default.OS});const r=!1,i=!0;let s;n("MBA1234: Environment Configuration",{NODE_ENV:"staging",isDevelopment:r,isStaging:i,isProduction:!1,platform:a.default.OS}),s=("android"===a.default.OS||a.default.OS,"https://staging-eb.crittrcove.com"),n("MBA1234: Selected API Base URL",{API_BASE_URL:s})},38432:(e,t,o)=>{"use strict";o.r(t),o.d(t,{AuthContext:()=>j,AuthProvider:()=>S,IsProduction:()=>v,SCREEN_HEIGHT:()=>f,SCREEN_WIDTH:()=>h,debugLog:()=>b,getStorage:()=>w,setDebugEnabled:()=>y});var a=o(36665),n=o(91087),r=o(77109),i=o(19620),s=o(26725),l=o(95991),d=o(36009),c=o(45010),u=o(92844),m=o(50294),g=o(60397);const h=s.default.get("window").width,f=s.default.get("window").height;let p=!0;const y=e=>{p=e},b=(e,...t)=>{p&&!e.includes("MBA3210")&&(t.length>0?console.log("".concat(e,":"),...t):console.log("".concat(e)))};class x{constructor(){this.accessToken=null,this.refreshToken=null,this.isRefreshing=!1,this.refreshSubscribers=[],this.is_DEBUG=!1,this.tokenExpiryTime=null,this.lastValidation=null}setDebug(e){this.is_DEBUG=e,console.log("MBA98765 AuthService debug mode:",e)}parseJwt(e){try{if(!e)return null;const t=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/");let o;return o="function"===typeof atob?decodeURIComponent(atob(t).split("").map((e=>"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2))).join("")):decodeURIComponent(Buffer.from(t,"base64").toString("binary").split("").map((e=>"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2))).join("")),JSON.parse(o)}catch(t){return console.error("MBA54321 Error parsing JWT:",t),null}}getTimeUntilExpiry(e){const t=this.parseJwt(e);if(!t||!t.exp)return 0;const o=1e3*t.exp;return this.tokenExpiryTime=o,o-Date.now()}async checkTokenFreshnessOnReturn(){const e=Date.now();if(this.lastValidation&&e-this.lastValidation<6e4)return void console.log("MBA54321 Skipping token check - checked recently");if(this.lastValidation=e,!this.accessToken)return void console.log("MBA54321 No access token, skipping check");const t=this.getTimeUntilExpiry(this.accessToken);if(t<3e5){console.log("MBA54321 Token expires in ".concat(Math.round(t/1e3)," seconds, refreshing"));try{await this.refreshTokens()}catch(o){console.error("MBA54321 Error refreshing token on return:",o)}}else console.log("MBA54321 Token still valid for ".concat(Math.round(t/6e4)," minutes, no refresh needed"))}async initialize(){console.log("MBA98765 Starting AuthService.initialize()");try{let e,t;if("web"===l.default.OS?(console.log("MBA98765 Web platform detected, using sessionStorage"),e=sessionStorage.getItem("userToken"),t=sessionStorage.getItem("refreshToken")):(console.log("MBA98765 Mobile platform detected, using AsyncStorage"),[e,t]=await n.default.multiGet(["userToken","refreshToken"])),this.accessToken=e,this.refreshToken=t,console.log("MBA98765 Tokens retrieved:",{hasAccessToken:!!this.accessToken,hasRefreshToken:!!this.refreshToken}),this.accessToken){this.getTimeUntilExpiry(this.accessToken)<3e5&&(console.log("MBA54321 Token close to expiry during init, refreshing"),await this.refreshTokens().catch((e=>{console.log("MBA54321 Failed to refresh token during init:",e)})))}return{hasAccessToken:!!this.accessToken,hasRefreshToken:!!this.refreshToken}}catch(e){return console.error("MBA98765 Error in AuthService.initialize():",e),{hasAccessToken:!1,hasRefreshToken:!1}}}async getAccessToken(){if(this.accessToken){const e=this.getTimeUntilExpiry(this.accessToken);e<12e4&&e>0&&(console.log("MBA54321 Token about to expire, refreshing"),await this.refreshTokens().catch((e=>{console.log("MBA54321 Failed to refresh token in getAccessToken:",e)})))}else this.refreshToken&&(console.log("MBA98765 No access token but has refresh token, attempting refresh"),await this.refreshTokens().catch((e=>{console.log("MBA54321 Failed to refresh token in getAccessToken:",e)})));return this.accessToken}async refreshTokens(){if(console.log("MBA98765 refreshTokens called"),this.isRefreshing)return console.log("MBA98765 Token refresh already in progress, subscribing"),new Promise((e=>{this.refreshSubscribers.push((t=>e(t)))}));if(!this.refreshToken)return console.log("MBA98765 No refresh token available"),null;try{this.isRefreshing=!0,console.log("MBA98765 Starting token refresh"),this.lastValidation=Date.now();const e=await r.default.post("".concat(i.API_BASE_URL,"/api/token/refresh/"),{refresh:this.refreshToken});this.accessToken=e.data.access,"web"===l.default.OS?sessionStorage.setItem("userToken",this.accessToken):await n.default.setItem("userToken",this.accessToken);const t=this.getTimeUntilExpiry(this.accessToken);return console.log("MBA98765 Token refresh successful, new token valid for ".concat(Math.round(t/6e4)," minutes")),this.refreshSubscribers.forEach((e=>e(this.accessToken))),this.refreshSubscribers=[],this.accessToken}catch(e){console.error("MBA98765 Token refresh failed:",e.response?.status,e.response?.data);throw"token_not_valid"===e.response?.data?.code&&"refresh"===e.response?.data?.messages?.[0]?.token_type&&console.log("MBA98765 Refresh token expired, clearing tokens"),this.clearTokens(),e}finally{this.isRefreshing=!1}}async validateToken(e){const t=Date.now();if(this.lastValidation&&t-this.lastValidation<3e5){console.log("MBA54321 Using cached token validation");return this.getTimeUntilExpiry(e)>0}console.log("MBA98765 validateToken called");try{const o=await r.default.post("".concat(i.API_BASE_URL,"/api/token/verify/"),{token:e});return this.lastValidation=t,console.log("MBA98765 Token validation successful"),200===o.status}catch(o){return console.error("MBA98765 Token validation failed:",o.response?.status),!1}}async clearTokens(){console.log("MBA98765 clearTokens called");try{"web"===l.default.OS?(sessionStorage.removeItem("userToken"),sessionStorage.removeItem("refreshToken")):await n.default.multiRemove(["userToken","refreshToken"]),this.accessToken=null,this.refreshToken=null,console.log("MBA98765 Tokens cleared")}catch(e){console.error("MBA98765 Error clearing tokens:",e)}}async setTokens(e,t){console.log("MBA98765 setTokens called");try{this.accessToken=e,this.refreshToken=t,"web"===l.default.OS?(sessionStorage.setItem("userToken",e),sessionStorage.setItem("refreshToken",t)):await n.default.multiSet([["userToken",e],["refreshToken",t]]),console.log("MBA98765 Tokens set successfully")}catch(o){throw console.error("MBA98765 Error setting tokens:",o),o}}}const j=(0,a.createContext)(),w=async e=>{try{return"web"===l.default.OS?sessionStorage.getItem(e):await n.default.getItem(e)}catch(t){return console.error("Error getting from storage:",t),null}},C=!1,v=()=>C,S=({children:e})=>{const t=(0,a.useRef)(new x),h=(0,a.useRef)(!1),[f,p]=(0,a.useState)(!1),[y,w]=(0,a.useState)(null),[v,S]=(0,a.useState)(!1),[T,B]=(0,a.useState)(!0),[k,_]=(0,a.useState)(s.default.get("window").width),[A,I]=(0,a.useState)(""),[D,M]=(0,a.useState)(""),[R,P]=(0,a.useState)(!1),[z,F]=(0,a.useState)({timezone:"UTC",timezone_abbrev:"UTC",use_military_time:!1}),[L,O]=(0,a.useState)(!1),[E,W]=(0,a.useState)(!0);(0,a.useEffect)((()=>{console.log("MBA98765 Setting up debug mode"),t.current.setDebug(E)}),[E]),(0,a.useEffect)((()=>{console.log("MBA98765 Setting up axios interceptors");const e=r.default.interceptors.request.use((async e=>{if(!L)try{const o=await t.current.getAccessToken();o&&(e.headers.Authorization="Bearer ".concat(o))}catch(o){console.error("MBA98765 Error getting access token for request:",o)}return e}),(e=>Promise.reject(e))),o=r.default.interceptors.response.use((e=>e),(async e=>{const o=e.config;if(401===e.response?.status&&!o._retry){o._retry=!0;try{if("token_not_valid"===e.response?.data?.code){b("MBA54321 Token invalid error detected",e.response?.data);if(await t.current.refreshTokens().then((()=>!0)).catch((()=>!1))){const e=t.current.accessToken;return o.headers.Authorization="Bearer ".concat(e),(0,r.default)(o)}return b("MBA54321 Could not refresh token, forcing sign out"),await U(),Promise.reject(new Error("Session expired. Please sign in again."))}{const e=await t.current.refreshTokens();if(e)return o.headers.Authorization="Bearer ".concat(e),(0,r.default)(o)}}catch(a){return console.error("MBA98765 Token refresh failed:",a),await U(),Promise.reject(a)}}return Promise.reject(e)}));return()=>{r.default.interceptors.request.eject(e),r.default.interceptors.response.eject(o)}}),[L]),(0,a.useEffect)((()=>{if(!f||L)return;const e=()=>{b("MBA54321 Window regained focus, scheduling token refresh check"),t.current&&t.current.checkTokenFreshnessOnReturn()};return window.addEventListener("focus",e),document.addEventListener("visibilitychange",(()=>{"visible"===document.visibilityState&&e()})),()=>{window.removeEventListener("focus",e),document.removeEventListener("visibilitychange",e)}}),[f,L]),(0,a.useEffect)((()=>{(async()=>{if(!h.current)try{console.log("MBA98765 Initializing auth state");const{hasAccessToken:e,hasRefreshToken:o}=await t.current.initialize();if(e||o){const e=await t.current.getAccessToken();if(e){if(await t.current.validateToken(e)){p(!0),await N();const t=await H(e);w(t.suggestedRole),S(t.isApprovedProfessional),await V()}else await U()}}else await U()}catch(e){console.error("MBA98765 Error initializing auth state:",e),await U()}finally{B(!1),h.current=!0}})()}),[]),(0,a.useEffect)((()=>{f&&!L&&(0,u.initStripe)()}),[f,L]),(0,a.useEffect)((()=>{const e=s.default.addEventListener("change",(({window:e})=>{_(e.width)}));return()=>{e?.remove&&e.remove()}}),[]);const N=async()=>{try{b("MBA98765 Fetching user name");const e=await(0,m.getUserName)();b("MBA98765 User name response:",e),I(e.first_name),M(e.name)}catch(e){console.error("MBA98765 Error fetching user name:",e.response?e.response.data:e.message),I(""),M("")}},H=async e=>{try{const t=await r.default.get("".concat(i.API_BASE_URL,"/api/professional-status/v1/"),{headers:{Authorization:"Bearer ".concat(e)}});E&&b("MBA98765 Professional status response:",t.data);const{is_approved:o}=t.data;return S(o),await n.default.setItem("isApprovedProfessional",String(o)),{isApprovedProfessional:o,suggestedRole:o?"professional":"petOwner"}}catch(t){return console.error("Error getting professional status:",t.response?.data||t),{isApprovedProfessional:!1,suggestedRole:"petOwner"}}},U=async()=>{try{(await Promise.resolve().then(o.bind(o,65688))).default.disconnect(),b("MBA3210: WebSocket disconnected during signOut"),await t.current.clearTokens(),await n.default.multiRemove(["userRole","isApprovedProfessional"]),await sessionStorage.removeItem("userRole"),await sessionStorage.removeItem("isApprovedProfessional")}catch(e){b("Error during sign out:",e)}p(!1),S(!1),w(null),I(""),M(""),setTimeout((()=>{"web"===l.default.OS&&sessionStorage.setItem("explicitSignOut","true"),(0,d.navigate)("SignIn")}),0)},V=async()=>{if(!L)try{const e=await(0,m.getTimeSettings)();F(e),b("MBA98765 Time settings response:",e)}catch(e){console.error("MBA98765 Error fetching time settings:",e.response?e.response.data:e.message)}};return(0,g.jsx)(j.Provider,{value:{isSignedIn:f,userRole:y,isApprovedProfessional:v,loading:T,screenWidth:k,firstName:A,name:D,is_prototype:L,is_DEBUG:E,is_PRODUCTION:C,timeSettings:z,isCollapsed:R,setIsCollapsed:P,signIn:async(e,o,a)=>{try{b("MBA98765 Starting sign in process"),await t.current.setTokens(e,o),p(!0);try{const e=await(0,m.getTimeSettings)();F(e),b("MBA98765 Time settings fetched during sign in:",e)}catch(r){console.error("MBA98765 Error fetching time settings during sign in:",r)}const i=await H(e),s=i.suggestedRole;return w(s),S(i.isApprovedProfessional),"web"===l.default.OS?sessionStorage.setItem("userRole",s):await n.default.setItem("userRole",s),b("MBA98765 Sign in successful:",{initialRole:s,isApprovedProfessional:i.isApprovedProfessional}),a&&setTimeout((()=>{(0,c.navigateToFrom)(a,"Dashboard","SignIn")}),0),{userRole:s,isApprovedProfessional:i.isApprovedProfessional}}catch(i){throw E&&b("MBA98765 Sign in error:",i),console.error("Error during sign in:",i),i}},signOut:U,switchRole:async e=>{if(v){b("MBA98765 Switching role, current role:",y);const o="professional"===y?"petOwner":"professional";w(o);try{"web"===l.default.OS?sessionStorage.setItem("userRole",o):await n.default.setItem("userRole",o);const t=e?.getCurrentRoute?.()?.name;"petOwner"===o&&"Connections"===t&&(b("MBA98765 Navigating to Dashboard from Connections when switching to pet owner"),(0,d.navigate)("Dashboard")),b("MBA98765 Role switched to:",o)}catch(t){console.error("Error updating role in storage:",t)}}else console.log("User is not an approved professional, cannot switch roles")},setIsDebug:W,setIsPrototype:O,checkAuthStatus:async()=>{try{const e=await t.current.getAccessToken();if(!e)return{isAuthenticated:!1};return await t.current.validateToken(e)?(b("MBA54321 checkAuthStatus",{isAuthenticated:!0,userRole:y,isApprovedProfessional:v}),{isAuthenticated:!0,userRole:y,isApprovedProfessional:v}):(await U(),{isAuthenticated:!1})}catch(e){return console.error("MBA98765 Error checking auth status:",e),{isAuthenticated:!1}}},fetchTimeSettings:V},children:e})}},59742:(e,t,o)=>{"use strict";o.r(t),o.d(t,{MessageNotificationContext:()=>l,MessageNotificationProvider:()=>d,default:()=>c});var a=o(36665),n=o(38432),r=o(50294),i=o(65688),s=o(60397);const l=(0,a.createContext)(),d=({children:e})=>{const[t,o]=(0,a.useState)(!1),[d,c]=(0,a.useState)(0),[u,m]=(0,a.useState)({}),[g,h]=(0,a.useState)(""),[f,p]=(0,a.useState)(!1),[y,b]=(0,a.useState)(0),{isSignedIn:x}=(0,a.useContext)(n.AuthContext),j=(0,a.useRef)(!1),w=(0,a.useRef)(!1),C=(0,a.useRef)(null),v=(0,a.useRef)(null),S=(0,a.useRef)(!1),T=(0,a.useRef)(0),B=(0,a.useRef)(null),k=(0,a.useRef)(0),_=(0,a.useRef)(0),A=(0,a.useRef)(0),I=(0,a.useRef)(null),D=(0,a.useRef)(!0),M=(0,a.useRef)(!1),[R,P]=(0,a.useState)(null),z=(0,a.useRef)(0),F=async(e=!1)=>{try{if(w.current)return(0,n.debugLog)("MBA4321: Skipping unread check - another check is already in progress"),t;const o=(new Error).stack;if((0,n.debugLog)("MBA4321: checkUnreadMessages called from:\n".concat(o)),w.current=!0,e)return(0,n.debugLog)("MBA432wihe21: Forced API call for unread messages"),await O();const a=i.default&&i.default.isWebSocketConnected();return(0,n.debugLog)("MBA4321: WebSocket connected: ".concat(a)),a&&S.current?((0,n.debugLog)("MBA4321: WebSocket is connected and data received, using current state"),w.current=!1,t):M.current?((0,n.debugLog)("MBA4321: Using existing state, we already made an initial API call"),w.current=!1,t):((0,n.debugLog)("MBA4321: First check on page load, implementing progressive WebSocket wait"),B.current&&clearTimeout(B.current),await L())}catch(o){return(0,n.debugLog)("MBA4321: Error in checkUnreadMessages:",o),w.current=!1,t}},L=async()=>(k.current=0,M.current?new Promise((e=>{const o=()=>{const a=i.default&&i.default.isWebSocketConnected();return S.current?((0,n.debugLog)("MBA4321: WebSocket data received during wait, using current state"),w.current=!1,void e(t)):(k.current++,(0,n.debugLog)("MBA4321: WebSocket wait attempt ".concat(k.current,"/").concat(12,", connected: ").concat(a)),a&&((0,n.debugLog)("MBA4321: WebSocket is connected, sending heartbeat request"),i.default.send("heartbeat",{timestamp:Date.now()}),A.current=Date.now()),k.current>=12?((0,n.debugLog)("MBA432wihe21: Max WebSocket wait attempts reached, falling back to API"),void O().then((t=>e(t)))):void(B.current=setTimeout(o,5e3)))};o()})):((0,n.debugLog)("MBA432wihe21: Fresh page load - making initial API call to get accurate unread count"),await O())),O=async()=>{(0,n.debugLog)("MBA432wihe21: makeApiCall called, checking if necessary");const e=Date.now();if(e-z.current<6e4&&S.current&&D.current)return(0,n.debugLog)("MBA432wihe21: Skipping API call - checked recently and connection is healthy"),t;(0,n.debugLog)("MBA432wihe21: Making API call for unread messages");try{const t=await(0,r.getUnreadMessageCount)(),a=t.unread_count||0,i=t.conversation_counts||{};return(0,n.debugLog)("MBA432wihe21: Unread message count from API:",a),P({unread_count:a,conversation_counts:i,timestamp:e}),c(a),o(a>0),m(i),b(e),T.current=e,z.current=e,j.current=!0,M.current=!0,S.current=!0,w.current=!1,a>0}catch(a){return(0,n.debugLog)("MBA432wihe21: Error in API call:",a),w.current=!1,t}},E=(e=!1)=>{v.current&&clearTimeout(v.current),v.current=setTimeout((()=>{F(e),v.current=null}),300)},W=e=>{if((0,n.debugLog)("MBA4321: onNewMessage called with data:",e),e&&e.sent_by_other_user){const t=e.conversation_id;if("MessageHistory"===g&&t&&String(t)===String(window.selectedConversationId))return void(0,n.debugLog)("MBA4321: User is viewing this specific conversation, not creating notification");if((0,n.debugLog)("MBA4321: New message from ".concat(e.sender_name||"unknown"," in conversation ").concat(t)),((e=null)=>{(0,n.debugLog)("MBA4321: Adding unread message notification for conversation ".concat(e)),o(!0),c((e=>{const t=e+1;return(0,n.debugLog)("MBA4321: Increasing total unread count from ".concat(e," to ").concat(t)),t})),e&&m((t=>{const o=t[e]||0,a=o+1;return(0,n.debugLog)("MBA4321: Conversation ".concat(e," unread count: ").concat(o," \u2192 ").concat(a)),Object.assign({},t,{[e]:a})}))})(t),S.current=!0,R){const e=Object.assign({},R.conversation_counts);e[t]=(e[t]||0)+1,P({unread_count:R.unread_count+1,conversation_counts:e,timestamp:Date.now()})}}};(0,a.useEffect)((()=>{window.selectedConversationId=null}),[]);const N=async e=>{if((0,n.debugLog)("MBA4321: Marking conversation as read:",e),window.selectedConversationId=e,e&&u[e]){const t=u[e]||0;c((o=>{const a=Math.max(0,o-t);return(0,n.debugLog)("MBA4321: Reducing total unread count from ".concat(o," to ").concat(a," after reading conversation ").concat(e)),a}));const a=Object.assign({},u);if(delete a[e],m(a),R){const o=Object.assign({},R.conversation_counts);delete o[e],P({unread_count:Math.max(0,R.unread_count-t),conversation_counts:o,timestamp:Date.now()})}const r=Object.keys(a).length>0;if(o(r),(0,n.debugLog)("MBA4321: After marking conversation ".concat(e," as read, still have unread messages: ").concat(r)),r){const e=Object.keys(a).map((e=>"".concat(e,":").concat(a[e]))).join(", ");(0,n.debugLog)("MBA4321: Remaining unread conversations: ".concat(e))}}(0,n.debugLog)("MBA4321: Updated unread state after marking conversation as read")};(0,a.useEffect)((()=>((async()=>{if(x)try{const e=await(0,n.getStorage)("userToken");if(!e)return void(0,n.debugLog)("MBA4321: No token available for WebSocket connection");(0,n.debugLog)("MBA4321: Initializing WebSocket connection"),i.default.init(e),p(!0),k.current=0,setTimeout((()=>{(0,n.debugLog)("MBA432wihe21: Forcing initial API check on page load to get accurate count"),O()}),500)}catch(e){(0,n.debugLog)("MBA4321: Error initializing WebSocket:",e)}else f&&((0,n.debugLog)("MBA4321: User signed out, force disconnecting WebSocket"),i.default.disconnect(!0),p(!1),C.current&&(clearInterval(C.current),C.current=null),B.current&&(clearTimeout(B.current),B.current=null),I.current&&(clearTimeout(I.current),I.current=null),k.current=0,S.current=!1,D.current=!1,M.current=!1)})(),()=>{C.current&&((0,n.debugLog)("MBA4321: Cleaning up WebSocket reconnect interval"),clearInterval(C.current),C.current=null),v.current&&(clearTimeout(v.current),v.current=null),B.current&&(clearTimeout(B.current),B.current=null),I.current&&(clearTimeout(I.current),I.current=null)})),[x]),(0,a.useEffect)((()=>{if(!x||!f)return;(0,n.debugLog)("MBA4321: Setting up WebSocket message handler");const e=i.default.registerHandler("message",(e=>{if((0,n.debugLog)("MBA4321: Message notification received via WebSocket:",e),_.current=Date.now(),D.current=!0,!M.current)return(0,n.debugLog)("MBA432wihe21: No initial API call made yet, making one now to ensure correct state"),void O();W(e)}),"notification-context"),t=i.default.registerHandler("unread_update",(e=>{(0,n.debugLog)("MBA4321: Unread update received via WebSocket:",e),_.current=Date.now(),D.current=!0,e&&"undefined"!==typeof e.unread_count&&(c(e.unread_count),o(e.unread_count>0),m(e.conversation_counts||{}),P({unread_count:e.unread_count,conversation_counts:e.conversation_counts||{},timestamp:Date.now()}),b(Date.now()),S.current=!0,j.current=!0)}),"unread-update-context"),a=i.default.registerHandler("heartbeat_ack",(e=>{(0,n.debugLog)("MBA4321: Heartbeat acknowledgment received"),_.current=Date.now(),D.current=!0,S.current=!0}),"heartbeat-context"),r=i.default.registerHandler("connection",(e=>{(0,n.debugLog)("MBA4321: WebSocket connection event:",e),"connected"===e.status?(_.current=Date.now(),D.current=!0):e.forced&&(S.current=!1,D.current=!1,(0,n.debugLog)("MBA4321: Connection forcibly closed, resetting WebSocket data flag")),"connected"!==e.status||j.current||setTimeout((()=>{S.current||((0,n.debugLog)("MBA432wihe21: in connection handler"),F(!0))}),1e3)}),"connection-context");return()=>{(0,n.debugLog)("MBA4321: Cleaning up WebSocket handlers"),e(),t(),r(),a()}}),[x,f]),(0,a.useEffect)((()=>{if(!x)return;const e=()=>{if("visible"===document.visibilityState){(0,n.debugLog)("MBA4321: Tab became visible, ensuring WebSocket connection");const e=i.default&&i.default.isWebSocketConnected();if((0,n.debugLog)("MBA4321: WebSocket connection status on visibility change: ".concat(e?"Connected":"Disconnected")),e)return(0,n.debugLog)("MBA4321: WebSocket is already connected, no reconnection needed"),i.default.send("heartbeat",{timestamp:Date.now()}),A.current=Date.now(),S.current=!0,void(D.current=!0);if(i.default&&"function"===typeof i.default.reconnectIfNeeded){(0,n.debugLog)("MBA4321: WebSocket not connected, attempting reconnection"),i.default.reconnectIfNeeded(),k.current=0;const e=()=>i.default&&i.default.isWebSocketConnected()||S.current?((0,n.debugLog)("MBA4321: WebSocket reconnected successfully, stopping retry process"),void(B.current&&(clearTimeout(B.current),B.current=null))):(k.current++,(0,n.debugLog)("MBA4321: WebSocket reconnection attempt ".concat(k.current,"/").concat(12)),k.current>=12?((0,n.debugLog)("MBA432wihe21: Max retries reached, fall back to API"),void E(!0)):void(B.current=setTimeout(e,5e3)));setTimeout(e,1e3)}}};return"undefined"!==typeof document&&document.addEventListener("visibilitychange",e),()=>{"undefined"!==typeof document&&document.removeEventListener("visibilitychange",e),B.current&&(clearTimeout(B.current),B.current=null),I.current&&(clearTimeout(I.current),I.current=null)}}),[x]),(0,a.useEffect)((()=>{if(!x)return o(!1),c(0),m({}),S.current=!1,M.current=!1,void(B.current&&(clearTimeout(B.current),B.current=null));if(!M.current){(0,n.debugLog)("MBA4321: Ensuring we get fresh unread count on page load/sign-in");const e=setTimeout((()=>{M.current||((0,n.debugLog)("MBA432wihe21: Making initial API call to get fresh unread count"),O())}),1e3);return()=>clearTimeout(e)}return()=>{}}),[x]);const H={hasUnreadMessages:t,unreadCount:d,conversationCounts:u,getConversationUnreadCount:e=>e&&u[e]||0,updateRoute:e=>{e&&e!==g&&((0,n.debugLog)("MBA4321: Updating route to:",e),h(e))},checkUnreadMessages:E,onNewMessage:W,markConversationAsRead:N,resetNotifications:(e,t)=>{if(e&&e!==g&&h(e),t)return(0,n.debugLog)("MBA4321: Resetting notifications for specific conversation: ".concat(t)),void N(t);"RESET_ALL"===e&&((0,n.debugLog)("MBA4321: Explicitly resetting ALL message notifications"),o(!1),c(0),m({}))}};return(0,s.jsx)(l.Provider,{value:H,children:e})},c=l},6541:(e,t,o)=>{"use strict";o.r(t),o.d(t,{theme:()=>n});var a=o(16204);const n=Object.assign({},a.DefaultTheme,{fonts:Object.assign({},a.DefaultTheme.fonts,{regular:{fontFamily:"PlayfairDisplay"},medium:{fontFamily:"PlayfairDisplay-Medium"},header:{fontFamily:"Futura"}}),typography:{header:{fontFamily:"Futura"},body:{fontFamily:"PlayfairDisplay"}},colors:Object.assign({},a.DefaultTheme.colors,{mainColors:{main:"#6A6C51",secondary:"#5D6C51",tertiary:"#516C53",quaternary:"#516C61",quinary:"#516A6C",senary:"#515D6C"},proDashboard:{main:"#F0F9E5",secondary:"#E7F3F8",tertiary:"#FEF0DA",quaternary:"#E1E2DB"},mybookings:{main:"#FFF7ED",secondary:"#EA580E",tertiary:"#6A6C51",ownerName:"#4B4C3B",metaText:"#959885",confirmedBg:"#E8E9E2",confirmedText:"#898974",completedBg:"#F5F5F4",completedText:"#898983",searchBar:"rgb(183, 183, 183)"},primary:"#6A6C51",secondary:"#516C61",background:"#f6f6f6",backgroundContrast:"#F6F3FC",calendarColor:"#A99E6B",calendarColorYellowBrown:"#8A8C6D",text:"black",whiteText:"white",placeHolderText:"#A9A9A9",accent:"#03dac4",error:"#B00020",warning:"#FFA726",info:"#29B6F6",surface:"#F9FAFB",surfaceContrast:"#FFFFFF",border:"rgb(183, 183, 183)",bgColorModern:"rgb(239, 239, 239)",modernBorder:"#E0E0E0",inputBackground:"#f6f6f6",receivedMessage:"#e7eae6",danger:"#A52A2A"}),fontSizes:{small:12,smallMedium:14,medium:16,mediumLarge:18,large:20,largeLarge:24,extraLarge:26},spacing:{small:8,medium:16,large:24}})},92844:(e,t,o)=>{"use strict";o.r(t),o.d(t,{createPaymentMethod:()=>i,initStripe:()=>r,useStripe:()=>s});var a=o(95991);let n=null;const r=async()=>(n||(n=await(async()=>{if("web"===a.default.OS){const{loadStripe:e}=await o.e(210).then(o.bind(o,79210)),t=await e(void 0);if(!t)throw new Error("Failed to initialize Stripe");return t}{const{useStripe:e}=await o.e(210).then(o.bind(o,79210));return e()}})()),n),i=async e=>{try{if("web"===a.default.OS)throw new Error("Web platform should use stripe.createPaymentMethod directly");const t=await r(),o=await t.createPaymentMethod({type:"card",card:e.card});if(o.error)throw console.error("Stripe error:",o.error),new Error(o.error.message);return{paymentMethod:{id:o.paymentMethod.id,last4:o.paymentMethod.card.last4,brand:o.paymentMethod.card.brand,type:"card"},error:null}}catch(t){return console.error("Payment method creation error:",t),{paymentMethod:null,error:{message:t.message||"Failed to create payment method"}}}},s=()=>"web"===a.default.OS?{createPaymentMethod:async e=>(await r()).createPaymentMethod(e)}:n},32160:(e,t,o)=>{"use strict";o.r(t),o.d(t,{FORMAT_TYPES:()=>x,checkDSTChange:()=>f,convertDateTimeFromUTC:()=>g,convertTo12Hour:()=>u,convertTo24Hour:()=>c,convertToUTC:()=>m,formatDate:()=>d,formatDateForAPI:()=>y,formatDateTimeRangeFromUTC:()=>w,formatFromUTC:()=>j,formatOccurrenceFromUTC:()=>p,formatTimeForAPI:()=>b,getFormattedTimes:()=>h,parseOccurrencesForBookingSteps:()=>v});var a=o(32724),n=o(9307),r=o(72302),i=o.n(r),s=o(38432),l=o(5977);const d=e=>{if(!e)return"";(0,s.debugLog)("MBA5677: Formatting date input",e);try{const t=(0,l.parseISO)(e);if(!isNaN(t.getTime())){const e=t.toLocaleString("default",{month:"short"}),o=t.getDate();return(0,s.debugLog)("MBA5677: Parsed as ISO date",{parsedDate:t,month:e,day:o}),"".concat(e," ").concat(o)}const o=(0,a.parse)(e,"yyyy-MM-dd",new Date);if(!isNaN(o.getTime())){const e=o.toLocaleString("default",{month:"short"}),t=o.getDate();return(0,s.debugLog)("MBA5677: Parsed with date-fns",{date:o,month:e,day:t}),"".concat(e," ").concat(t)}const n=i()(e);if(n.isValid()){const e=n.format("MMM D");return(0,s.debugLog)("MBA5677: Parsed with moment",{momentDate:n,formatted:e}),e}return(0,s.debugLog)("MBA5677: Failed to parse date",e),e}catch(t){return(0,s.debugLog)("MBA5677: Error formatting date",{dateString:e,error:t}),e}},c=e=>{if(!e.includes(" "))return e;const[t,o]=e.split(" ");let[a,n]=t.split(":");return a=parseInt(a,10),"PM"===o&&a<12?a+=12:"AM"===o&&12===a&&(a=0),"".concat(a.toString().padStart(2,"0"),":").concat(n)},u=e=>{if(e.includes(" "))return e;const[t,o]=e.split(":"),a=parseInt(t,10);let n=a>=12?"PM":"AM",r=a%12;return r=0===r?12:r,"".concat(r,":").concat(o," ").concat(n)},m=(e,t,o)=>{try{(0,s.debugLog)("MBA12345: Converting to UTC - Input:",{date:e,time:t,fromTimezone:o});const a=i().tz("".concat(e," ").concat(t),o),n=a.utc(),r=n.format("YYYY-MM-DD"),l=n.format("HH:mm");return(0,s.debugLog)("MBA12345: UTC conversion result:",{input:{date:e,time:t,fromTimezone:o},output:{utcDate:r,utcTime:l,originalMoment:a.format(),utcMoment:n.format()}}),{date:r,time:l}}catch(a){return(0,s.debugLog)("MBA12345: Error converting to UTC:",a),{date:e,time:t}}},g=(e,t,o,a=!1)=>{try{if((0,s.debugLog)("MBA5677: Converting UTC to local:",{date:e,time:t,timezone:o,useMilitaryTime:a}),!e||!t)return(0,s.debugLog)("MBA5677: Invalid input for conversion",{date:e,time:t}),{date:e,time:t};let r=null;try{let o=t;t.includes(".")&&(o=t.split(".")[0]);const a="".concat(e,"T").concat(o).concat(o.includes("Z")?"":"Z");(0,s.debugLog)("MBA5677: Trying ISO string format",a),r=new Date(a),isNaN(r.getTime())?((0,s.debugLog)("MBA5677: ISO format parsing failed"),r=null):(0,s.debugLog)("MBA5677: ISO format parsing succeeded")}catch(n){(0,s.debugLog)("MBA5677: Error in ISO format parsing",n)}if(!r)try{(0,s.debugLog)("MBA5677: Trying date-fns parsing");const o="".concat(e," ").concat(t);r=i().utc(o).toDate(),isNaN(r.getTime())?((0,s.debugLog)("MBA5677: date-fns parsing failed"),r=null):(0,s.debugLog)("MBA5677: date-fns parsing succeeded")}catch(n){(0,s.debugLog)("MBA5677: Error in date-fns parsing",n)}if(!r)try{(0,s.debugLog)("MBA5677: Trying manual parsing");const[o,a,n]=e.split("-").map(Number);let i=0,l=0;if(t.includes(":")){const e=t.split(":");i=parseInt(e[0],10),l=parseInt(e[1],10)}r=new Date(Date.UTC(o,a-1,n,i,l)),isNaN(r.getTime())?((0,s.debugLog)("MBA5677: Manual parsing failed"),r=null):(0,s.debugLog)("MBA5677: Manual parsing succeeded")}catch(n){(0,s.debugLog)("MBA5677: Error in manual parsing",n)}if(!r)return(0,s.debugLog)("MBA5677: All parsing strategies failed, returning original"),{date:e,time:t};(0,s.debugLog)("MBA5677: Valid UTC Date created:",r.toISOString());const l=i().utc(r),d=l.tz(o||"UTC"),c=d.format("YYYY-MM-DD"),u=d.format(a?"HH:mm":"h:mm A");return(0,s.debugLog)("MBA5677: Date conversion result:",{input:{date:e,time:t,timezone:o},utc:r.toISOString(),utcMoment:l.format(),localMoment:d.format(),output:{date:c,time:u}}),{date:c,time:u}}catch(r){return(0,s.debugLog)("MBA5677: Error in convertDateTimeFromUTC:",r,{date:e,time:t,timezone:o}),{date:e,time:t}}},h=(e,t,o,a,r)=>{try{console.log("MBA134njo0vh032 getFormattedTimes input:",{startDate:e,startTime:t,endDate:o,endTime:a,timezone:r});const[i,s,l]=e.split("-").map(Number),[d,c]=t.split(":").map(Number),[u,m,g]=o.split("-").map(Number),[h,f]=a.split(":").map(Number);console.log("MBA134njo0vh032 Parsed components:",{start:{year:i,month:s,day:l,hours:d,minutes:c},end:{year:u,month:m,day:g,hours:h,minutes:f}});const p="".concat(i,"-").concat(String(s).padStart(2,"0"),"-").concat(String(l).padStart(2,"0"),"T").concat(String(d).padStart(2,"0"),":").concat(String(c).padStart(2,"0"),":00"),y="".concat(u,"-").concat(String(m).padStart(2,"0"),"-").concat(String(g).padStart(2,"0"),"T").concat(String(h).padStart(2,"0"),":").concat(String(f).padStart(2,"0"),":00");console.log("MBA134njo0vh032 Created date strings:",{startDateStr:p,endDateStr:y,timezone:r});const b=(0,n.formatInTimeZone)(p,r,"MMM dd, yyyy (h:mm a)"),x=(0,n.formatInTimeZone)(y,r,"MMM dd, yyyy (h:mm a)");console.log("MBA134njo0vh032 Formatted dates:",{formatted_start:b,formatted_end:x});const j=new Date(p),w=new Date(y)-j,C=Math.floor(w/864e5),v=w%864e5,S=Math.floor(v/36e5);let T="";return C>0?(T+="".concat(C," day").concat(C>1?"s":""),S>0&&(T+=", ".concat(S," hour").concat(S>1?"s":""))):S>0&&(T+="".concat(S," hour").concat(S>1?"s":"")),console.log("MBA134njo0vh032 Final formatted output:",{formatted_start:b,formatted_end:x,duration:T,timezone:r.split("/")[1]||r}),{formatted_start:b,formatted_end:x,duration:T||"0 hours",timezone:r.split("/")[1]||r}}catch(i){throw console.error("Error in getFormattedTimes:",i),i}},f=(e,t,o,a,r)=>{try{const[i,s,l]=e.split("-").map(Number),[d,u]=c(t).split(":").map(Number),[m,g,h]=o.split("-").map(Number),[f,p]=c(a).split(":").map(Number),y=new Date(i,s-1,l,d,u),b=new Date(m,g-1,h,f,p),x=(0,n.fromZonedTime)((0,n.toZonedTime)(y,r)),j=(0,n.fromZonedTime)((0,n.toZonedTime)(b,r)),w=(0,n.toZonedTime)(x,r),C=(0,n.toZonedTime)(j,r);return w.getTimezoneOffset()!==C.getTimezoneOffset()}catch(i){throw console.error("Error in checkDSTChange:",i),i}},p=(e,t)=>{try{const o=t.includes("/")?t:"US/Mountain";console.log("MBA134njo0vh03 Formatting occurrence from UTC:",{occurrence:e,userTimezone:t,fullTimezone:o});const a=g(e.start_date,e.start_time,o),n=g(e.end_date,e.end_time,o);console.log("MBA134njo0vh03 Local start:",a),console.log("MBA134njo0vh03 Local end:",n),console.log("MBA134njo0vh03 Full timezone:",o);const r=h(a.date,a.time,n.date,n.time,o);console.log("MBA134njo0vh03 Formatted times from getFormattedTimes:",r);const i=f(a.date,a.time,n.date,n.time,o),s=t.includes("/")?t.split("/")[1]:t;return Object.assign({},e,{formatted_start:r.formatted_start,formatted_end:r.formatted_end,duration:r.duration,timezone:s,dst_message:i?"Elapsed time may be different than expected due to Daylight Savings Time.":""})}catch(o){return console.error("Error in formatOccurrenceFromUTC:",o),Object.assign({},e,{formatted_start:e.start_date,formatted_end:e.end_date,duration:"Unknown",timezone:t.includes("/")?t.split("/")[1]:t,dst_message:""})}},y=e=>{if(!e)return null;let t;(0,s.debugLog)("MBA12345 formatDateForAPI input:",e,typeof e);try{if("string"===typeof e&&/^\d{4}-\d{2}-\d{2}$/.test(e))return(0,s.debugLog)("MBA12345 formatDateForAPI: already in YYYY-MM-DD format:",e),e;if("object"===typeof e&&e.date&&e.startTime&&e.endTime)return(0,s.debugLog)("MBA12345 formatDateForAPI: extracting date from date item:",e.date),e.date;if(e instanceof Date?(t=e,(0,s.debugLog)("MBA12345 formatDateForAPI: using Date object")):(t=new Date(e),(0,s.debugLog)("MBA12345 formatDateForAPI: created Date from input:",t)),isNaN(t.getTime()))throw(0,s.debugLog)("MBA12345 formatDateForAPI: invalid date:",e),new Error("Invalid date format");const o=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0"),r="".concat(o,"-").concat(a,"-").concat(n);return(0,s.debugLog)("MBA12345 formatDateForAPI result:",r),r}catch(o){throw(0,s.debugLog)("MBA12345 formatDateForAPI error:",o,"for input:",e),o}},b=e=>{if(!e)return(0,s.debugLog)("MBA12345 formatTimeForAPI received null/undefined time:",e),null;let t,o;if((0,s.debugLog)("MBA12345 formatTimeForAPI input:",e),"object"===typeof e&&void 0!==e.hours)t=e.hours,o=e.minutes,(0,s.debugLog)("MBA12345 formatTimeForAPI processing time object:",{hours:t,minutes:o});else{if("string"!==typeof e)throw(0,s.debugLog)("MBA12345 formatTimeForAPI invalid time format:",typeof e),new Error("Invalid time format");[t,o]=e.split(":").map(Number),(0,s.debugLog)("MBA12345 formatTimeForAPI processing time string:",{hours:t,minutes:o})}if(t=parseInt(t),o=parseInt(o),isNaN(t)||isNaN(o))throw(0,s.debugLog)("MBA12345 formatTimeForAPI invalid time values:",{hours:t,minutes:o}),new Error("Invalid time values");const a="".concat(String(t).padStart(2,"0"),":").concat(String(o).padStart(2,"0"));return(0,s.debugLog)("MBA12345 formatTimeForAPI result:",a),a},x={SHORT_DATE:"SHORT_DATE",MEDIUM_DATE:"MEDIUM_DATE",LONG_DATE:"LONG_DATE",TIME_ONLY:"TIME_ONLY",TIME_ONLY_24H:"TIME_ONLY_24H",DATE_TIME:"DATE_TIME",DATE_TIME_WITH_TZ:"DATE_TIME_WITH_TZ",DATE_RANGE:"DATE_RANGE",DATE_TIME_RANGE:"DATE_TIME_RANGE"},j=(e,t=null,o,a=x.MEDIUM_DATE)=>{try{console.log("MBA134njo0vh02c23 formatFromUTC input:",{dateStr:e,timeStr:t,userTimezone:o,formatType:a});const n=i().utc("".concat(e,"T").concat(t||"00:00",":00Z"));console.log("MBA134njo0vh02c23 UTC moment:",n.format());const r=n.tz(o);console.log("MBA134njo0vh02c23 Local moment:",r.format());const s=r.zoneAbbr();switch(console.log("MBA134njo0vh02c23 Timezone abbreviation:",s),a){case x.SHORT_DATE:return r.format("MMM D");case x.MEDIUM_DATE:return r.format("MMM D, YYYY");case x.LONG_DATE:return r.format("MMMM D, YYYY");case x.TIME_ONLY:return r.format("h:mm A");case x.TIME_ONLY_24H:return r.format("HH:mm");case x.DATE_TIME:return r.format("MMM D, YYYY 'at' h:mm A");case x.DATE_TIME_WITH_TZ:return"".concat(r.format("MMM D, YYYY 'at' h:mm A")," ").concat(s);default:return r.format("MMM D, YYYY")}}catch(n){return console.error("MBA134njo0vh02c23 Error in formatFromUTC:",n),""}},w=({startDate:e,startTime:t,endDate:o,endTime:a,userTimezone:n,includeTimes:r=!0,includeTimezone:l=!0})=>{try{if((0,s.debugLog)("MBA134njo: formatDateTimeRangeFromUTC input:",{startDate:e,startTime:t,endDate:o,endTime:a,userTimezone:n,includeTimes:r,includeTimezone:l}),r){const r=i().utc("".concat(e,"T").concat(t,":00Z")),d=i().utc("".concat(o,"T").concat(a,":00Z"));(0,s.debugLog)("MBA134njo: UTC moments:",{start:r.format(),end:d.format()});const c=r.tz(n),u=d.tz(n);(0,s.debugLog)("MBA134njo: Local moments:",{start:c.format(),end:u.format()});const m=c.zoneAbbr();(0,s.debugLog)("MBA134njo: Timezone abbreviation:",m);const g=c.format("MMM D, YYYY h:mm A"),h=u.format("MMM D, YYYY h:mm A"),f=l?"".concat(g," ").concat(m):g,p=l?"".concat(h," ").concat(m):h;return(0,s.debugLog)("MBA134njo: Formatted dates:",{startFormatted:f,endFormatted:p,tzAbbrev:m}),"".concat(f," - ").concat(p)}{const t=i().utc("".concat(e,"T00:00:00Z")).tz(n),a=i().utc("".concat(o,"T00:00:00Z")).tz(n);return"".concat(t.format("MMM D, YYYY")," - ").concat(a.format("MMM D, YYYY"))}}catch(d){return(0,s.debugLog)("MBA134njo: Error in formatDateTimeRangeFromUTC:",d),""}};function C(e,t,o="US/Mountain"){try{const a="".concat(e,"T").concat(t,":00Z"),n=i().utc(a).tz(o),r=n.hours(),l=n.minutes(),d=n.format("YYYY-MM-DD"),c=d!==e;return(0,s.debugLog)("MBA2j3kbr9hve4: Time conversion details:",{utc:{date:e,time:t,fullDateTime:a},local:{date:d,time:"".concat(r,":").concat(l),fullDateTime:n.format(),dateChanged:c}}),{hours:r,minutes:l,adjustedDate:c?d:null}}catch(a){(0,s.debugLog)("MBA2j3kbr9hve4: Error converting time from UTC:",a);const[e,o]=t.split(":").map(Number);return{hours:e||0,minutes:o||0,adjustedDate:null}}}const v=e=>{if((0,s.debugLog)("MBA2j3kbr9hve4: Parsing occurrences for booking steps:",e),!e||!Array.isArray(e)||0===e.length)return(0,s.debugLog)("MBA2j3kbr9hve4: No occurrences to parse"),{dates:[],dateRange:null,individualTimes:{},defaultTimes:{startTime:{hours:9,minutes:0},endTime:{hours:17,minutes:0}}};const t=new Set,o={},a=[...e].sort(((e,t)=>new Date(e.start_date)-new Date(t.start_date)));(0,s.debugLog)("MBA2j3kbr9hve4: Sorted occurrences:",a);const n="US/Mountain";a.forEach((e=>{const{start_date:a,end_date:r,start_time:i,end_time:l}=e;if(!a||!i||!l)return void(0,s.debugLog)("MBA2j3kbr9hve4: Invalid occurrence data, missing required fields:",e);const d=C(a,i,n),c=C(r||a,l,n),u=d.adjustedDate||a,m=c.adjustedDate||r||a;(0,s.debugLog)("MBA2j3kbr9hve4: Converted times with date adjustments:",{utc:{startDate:a,startTime:i,endDate:r||a,endTime:l},local:{startDate:u,startTime:d,endDate:m,endTime:c}}),t.add(u),m!==u&&t.add(m),o[u]={startTime:{hours:d.hours,minutes:d.minutes},endTime:{hours:c.hours,minutes:c.minutes},isOvernightForced:u!==m}}));const r=Array.from(t).map((e=>{const[t,o,a]=e.split("-").map(Number);return new Date(t,o-1,a)}));(0,s.debugLog)("MBA2j3kbr9hve4: Parsed dates after timezone adjustment:",r.map((e=>e.toISOString().split("T")[0])));let i=null;if(r.length>0){const e=[...r].sort(((e,t)=>e-t));i={startDate:e[0],endDate:e[e.length-1]},(0,s.debugLog)("MBA2j3kbr9hve4: Created date range after timezone adjustment:",{startDate:i.startDate.toISOString().split("T")[0],endDate:i.endDate.toISOString().split("T")[0]})}let l={startTime:{hours:9,minutes:0},endTime:{hours:17,minutes:0}};if(Object.keys(o).length>0){const e=Object.keys(o)[0];l={startTime:o[e].startTime,endTime:o[e].endTime}}const d={dates:r,dateRange:i,individualTimes:o,defaultTimes:l,allTimesAreTheSame:Object.keys(o).length<=1||Object.values(o).every((e=>e.startTime.hours===l.startTime.hours&&e.startTime.minutes===l.startTime.minutes&&e.endTime.hours===l.endTime.hours&&e.endTime.minutes===l.endTime.minutes))};return(0,s.debugLog)("MBA2j3kbr9hve4: Parsed result with timezone adjustments:",d),d}},65688:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>r});var a=o(19620),n=o(38432);const r=new class{constructor(){this.socket=null,this.isConnected=!1,this.token=null,this.connectionAttempts=0,this.maxConnectionAttempts=5,this.heartbeatInterval=null,this.disconnectTimeout=null,this.messageHandlers=new Map,this.connectionId=null,this.wsUrl=a.API_BASE_URL.replace("http://","ws://").replace("https://","wss://"),this._reconnectTimeout=null,this.forceDisconnect=!1,this._hasVisibilityListener=!1,(0,n.debugLog)("MBA4321: WebSocketManager initialized, wsUrl is "+this.wsUrl)}init(e){e?this.token===e&&this.isConnected&&this.socket&&this.socket.readyState===WebSocket.OPEN?(0,n.debugLog)("MBA4321: WebSocket already connected with this token"):(this.token&&this.token!==e&&((0,n.debugLog)("MBA4321: Token changed, force disconnecting before reconnecting"),this.disconnect(!0)),this.token=e,this.forceDisconnect=!1,!this.socket||this.socket.readyState!==WebSocket.CLOSING&&this.socket.readyState!==WebSocket.CLOSED||((0,n.debugLog)("MBA4321: Closing existing non-functional socket"),this.disconnect(!1)),this.connect(),this.resetDisconnectTimeout(),this.setupVisibilityListener()):(0,n.debugLog)("MBA4321: Cannot initialize WebSocket without a valid token")}setupVisibilityListener(){if("undefined"===typeof document)return;if(this._hasVisibilityListener)return;(0,n.debugLog)("MBA4321: Setting up visibility change listener");document.addEventListener("visibilitychange",(()=>{"visible"===document.visibilityState&&((0,n.debugLog)("MBA4321: Document became visible, checking WebSocket connection"),this.token&&!this.forceDisconnect&&this.reconnectIfNeeded())})),this._hasVisibilityListener=!0,window.addEventListener("beforeunload",(()=>{(0,n.debugLog)("MBA4321: Page unloading, connection may persist for session restore")}))}connect(){if(!this.token)return(0,n.debugLog)("MBA4321: Cannot connect WebSocket without a valid token"),!1;if(this.isConnected&&this.socket&&this.socket.readyState===WebSocket.OPEN)return(0,n.debugLog)("MBA4321: WebSocket already connected and open"),!0;if(this.socket&&this.socket.readyState===WebSocket.CONNECTING)return(0,n.debugLog)("MBA4321: WebSocket already connecting, skipping duplicate connect"),!0;if(this.heartbeatInterval&&(clearInterval(this.heartbeatInterval),this.heartbeatInterval=null),this.connectionAttempts>=this.maxConnectionAttempts)return(0,n.debugLog)("MBA4321: Too many connection attempts (".concat(this.connectionAttempts,"), backing off")),setTimeout((()=>{this.connectionAttempts=0,this.connect()}),6e4),!1;try{this.connectionAttempts++;const e="".concat(this.wsUrl,"/ws/messages/?token=").concat(this.token);return(0,n.debugLog)("MBA4321: [MY CONNECTION] Connecting WebSocket at ".concat(e," (attempt ").concat(this.connectionAttempts,")")),this.socket=new WebSocket(e),(0,n.debugLog)("MBA4321: [MY CONNECTION] WebSocket instance created"),this.socket.onopen=this.handleOpen.bind(this),this.socket.onclose=this.handleClose.bind(this),this.socket.onmessage=this.handleMessage.bind(this),this.socket.onerror=this.handleError.bind(this),!0}catch(e){return(0,n.debugLog)("MBA4321: [MY CONNECTION] WebSocket connection error: ".concat(e.message)),this.scheduleReconnect(),!1}}handleOpen(e){(0,n.debugLog)("MBA4321: [MY CONNECTION] WebSocket connection established"),this.isConnected=!0,this.connectionAttempts=0,this.startHeartbeat(),(0,n.debugLog)("MBA4321: [MY CONNECTION] isConnected set to ".concat(this.isConnected,", socket state: ").concat(this.socket?.readyState)),this.notifyHandlers("connection",{status:"connected",timestamp:(new Date).toISOString()}),setTimeout((()=>{this.isConnected&&((0,n.debugLog)("MBA4321: [MY CONNECTION] Sending initial heartbeat after connection"),this.send("heartbeat"))}),500)}handleClose(e){if(!this.isConnected&&!this.socket)return;const t=this.isConnected;this.isConnected=!1,this.socket=null,(0,n.debugLog)("MBA4321: [MY CONNECTION] WebSocket connection closed: code=".concat(e.code,", reason=").concat(e.reason)),this.heartbeatInterval&&(clearInterval(this.heartbeatInterval),this.heartbeatInterval=null),t&&this.notifyHandlers("disconnection",{code:e.code,reason:e.reason,timestamp:(new Date).toISOString()}),this.scheduleReconnect()}handleMessage(e){try{const t=JSON.parse(e.data);if((0,n.debugLog)("MBA4321: [MY CONNECTION] WebSocket message received: ".concat(t.type)),(0,n.debugLog)("MBA4321: [MY CONNECTION] WebSocket message content: ".concat(e.data)),"heartbeat_ack"===t.type)return;this.notifyHandlers(t.type,t.data||{}),this.notifyHandlers("all",{type:t.type,data:t.data||{}})}catch(t){(0,n.debugLog)("MBA4321: [MY CONNECTION] Error handling WebSocket message: ".concat(t.message))}}handleError(e){(0,n.debugLog)("MBA4321: [MY CONNECTION] WebSocket error: ".concat(e.message||"Unknown error")),this.notifyHandlers("error",{error:e.message||"Unknown error",timestamp:(new Date).toISOString()}),this.scheduleReconnect()}send(e,t={}){if(!this.isConnected||!this.socket)return(0,n.debugLog)("MBA4321: [MY CONNECTION] Cannot send message, WebSocket not connected"),!1;try{const o=JSON.stringify({type:e,data:t,timestamp:Date.now()});return this.socket.send(o),(0,n.debugLog)("MBA4321: [MY CONNECTION] Sent ".concat(e," message through connection")),!0}catch(o){return(0,n.debugLog)("MBA4321: [MY CONNECTION] Error sending message through connection: ".concat(o.message)),!1}}scheduleReconnect(){if(this._reconnectTimeout)return void(0,n.debugLog)("MBA4321: Reconnect already scheduled, skipping duplicate");const e=Math.min(1e3*Math.pow(2,this.connectionAttempts-1),3e4);(0,n.debugLog)("MBA4321: Scheduling reconnect in ".concat(e,"ms (attempt ").concat(this.connectionAttempts,")")),this._reconnectTimeout=setTimeout((()=>{this._reconnectTimeout=null,this.isConnected||this.connect()}),e)}startHeartbeat(){this.heartbeatInterval&&clearInterval(this.heartbeatInterval),this.heartbeatInterval=setInterval((()=>{this.isConnected?(this.send("heartbeat",{timestamp:Date.now()}),(0,n.debugLog)("MBA4321: Heartbeat sent")):((0,n.debugLog)("MBA4321: Skipping heartbeat, not connected"),clearInterval(this.heartbeatInterval),this.heartbeatInterval=null)}),3e4),(0,n.debugLog)("MBA4321: Heartbeat mechanism started")}disconnect(e=!1){(0,n.debugLog)("MBA4321: [MY CONNECTION] Disconnecting WebSocket connection (force=".concat(e,")")),this.forceDisconnect=e;const t=!e,o=t?this.token:null;if(this.heartbeatInterval&&(clearInterval(this.heartbeatInterval),this.heartbeatInterval=null),this.disconnectTimeout&&(clearTimeout(this.disconnectTimeout),this.disconnectTimeout=null),this.socket)try{this.socket.onopen=null,this.socket.onclose=null,this.socket.onmessage=null,this.socket.onerror=null,this.socket.close(),this.socket=null,(0,n.debugLog)("MBA4321: [MY CONNECTION] WebSocket connection closed successfully")}catch(a){(0,n.debugLog)("MBA4321: [MY CONNECTION] Error closing WebSocket: ".concat(a.message))}return this.isConnected=!1,t&&o&&(this.token=o,(0,n.debugLog)("MBA4321: [MY CONNECTION] Preserved token for reconnection on tab visibility change")),this.notifyHandlers("connection",{status:"disconnected",forced:e,timestamp:(new Date).toISOString()}),!0}resetDisconnectTimeout(){this.disconnectTimeout&&clearTimeout(this.disconnectTimeout),this.disconnectTimeout=setTimeout((()=>{(0,n.debugLog)("MBA4321: Disconnecting due to inactivity"),this.disconnect()}),6e5)}isWebSocketConnected(){return this.isConnected&&this.socket&&this.socket.readyState===WebSocket.OPEN}registerHandler(e,t,o){return this.messageHandlers.has(e)||this.messageHandlers.set(e,new Map),this.messageHandlers.get(e).set(o,t),(0,n.debugLog)("MBA4321: Registered handler ".concat(o," for ").concat(e," messages")),()=>this.unregisterHandler(e,o)}unregisterHandler(e,t){this.messageHandlers.has(e)&&(this.messageHandlers.get(e).delete(t),(0,n.debugLog)("MBA4321: Unregistered handler ".concat(t," for ").concat(e," messages")))}notifyHandlers(e,t){if(this.messageHandlers.has(e)){this.messageHandlers.get(e).forEach(((o,a)=>{try{o(t)}catch(r){(0,n.debugLog)("MBA4321: Error in ".concat(e," handler ").concat(a,": ").concat(r.message))}}))}if("all"!==e&&this.messageHandlers.has("all")){this.messageHandlers.get("all").forEach(((o,a)=>{try{o({type:e,data:t})}catch(r){(0,n.debugLog)("MBA4321: Error in global handler ".concat(a,": ").concat(r.message))}}))}}markMessagesAsRead(e,t){return!(!Array.isArray(t)||0===t.length)&&this.send("mark_read",{conversation_id:e,message_ids:t})}reconnectIfNeeded(){if((0,n.debugLog)("MBA4321: [MY CONNECTION] Checking if WebSocket reconnection needed"),!this.token||this.forceDisconnect)return(0,n.debugLog)("MBA4321: [MY CONNECTION] Cannot reconnect - ".concat(this.token?"force disconnected":"no token")),!1;if(!this.isConnected||!this.socket||this.socket&&(this.socket.readyState===WebSocket.CLOSED||this.socket.readyState===WebSocket.CLOSING)){if((0,n.debugLog)("MBA4321: [MY CONNECTION] WebSocket needs reconnection, attempting now"),this.forceDisconnect=!1,this.socket)try{this.socket.onclose=null,this.socket.close(),this.socket=null}catch(e){(0,n.debugLog)("MBA4321: [MY CONNECTION] Error closing existing socket: ".concat(e.message))}return this.isConnected=!1,setTimeout((()=>{this.connect()}),100),!0}return this.isConnected&&this.socket&&this.socket.readyState===WebSocket.OPEN&&((0,n.debugLog)("MBA4321: [MY CONNECTION] WebSocket appears connected, sending heartbeat to verify"),this.send("heartbeat"),this.resetDisconnectTimeout()),!1}}},35358:(e,t,o)=>{var a={"./af":17582,"./af.js":17582,"./ar":93042,"./ar-dz":54265,"./ar-dz.js":54265,"./ar-kw":92553,"./ar-kw.js":92553,"./ar-ly":85352,"./ar-ly.js":85352,"./ar-ma":67097,"./ar-ma.js":67097,"./ar-ps":76150,"./ar-ps.js":76150,"./ar-sa":84427,"./ar-sa.js":84427,"./ar-tn":7221,"./ar-tn.js":7221,"./ar.js":93042,"./az":60458,"./az.js":60458,"./be":17596,"./be.js":17596,"./bg":93830,"./bg.js":93830,"./bm":27044,"./bm.js":27044,"./bn":58573,"./bn-bd":13296,"./bn-bd.js":13296,"./bn.js":58573,"./bo":25614,"./bo.js":25614,"./br":62041,"./br.js":62041,"./bs":91786,"./bs.js":91786,"./ca":75833,"./ca.js":75833,"./cs":52711,"./cs.js":52711,"./cv":71036,"./cv.js":71036,"./cy":84977,"./cy.js":84977,"./da":8770,"./da.js":8770,"./de":67342,"./de-at":81566,"./de-at.js":81566,"./de-ch":87544,"./de-ch.js":87544,"./de.js":67342,"./dv":82875,"./dv.js":82875,"./el":78536,"./el.js":78536,"./en-au":38617,"./en-au.js":38617,"./en-ca":79227,"./en-ca.js":79227,"./en-gb":59754,"./en-gb.js":59754,"./en-ie":37217,"./en-ie.js":37217,"./en-il":85418,"./en-il.js":85418,"./en-in":80800,"./en-in.js":80800,"./en-nz":67299,"./en-nz.js":67299,"./en-sg":76305,"./en-sg.js":76305,"./eo":8673,"./eo.js":8673,"./es":71301,"./es-do":3187,"./es-do.js":3187,"./es-mx":48223,"./es-mx.js":48223,"./es-us":37634,"./es-us.js":37634,"./es.js":71301,"./et":4976,"./et.js":4976,"./eu":11847,"./eu.js":11847,"./fa":74372,"./fa.js":74372,"./fi":41628,"./fi.js":41628,"./fil":56802,"./fil.js":56802,"./fo":42874,"./fo.js":42874,"./fr":9853,"./fr-ca":87170,"./fr-ca.js":87170,"./fr-ch":22825,"./fr-ch.js":22825,"./fr.js":9853,"./fy":68876,"./fy.js":68876,"./ga":93533,"./ga.js":93533,"./gd":82770,"./gd.js":82770,"./gl":98602,"./gl.js":98602,"./gom-deva":63059,"./gom-deva.js":63059,"./gom-latn":48212,"./gom-latn.js":48212,"./gu":23409,"./gu.js":23409,"./he":17210,"./he.js":17210,"./hi":4750,"./hi.js":4750,"./hr":51315,"./hr.js":51315,"./hu":47626,"./hu.js":47626,"./hy-am":91317,"./hy-am.js":91317,"./id":26892,"./id.js":26892,"./is":97577,"./is.js":97577,"./it":57628,"./it-ch":3046,"./it-ch.js":3046,"./it.js":57628,"./ja":92504,"./ja.js":92504,"./jv":25917,"./jv.js":25917,"./ka":64513,"./ka.js":64513,"./kk":94935,"./kk.js":94935,"./km":96661,"./km.js":96661,"./kn":89964,"./kn.js":89964,"./ko":98067,"./ko.js":98067,"./ku":61165,"./ku-kmr":85158,"./ku-kmr.js":85158,"./ku.js":61165,"./ky":11177,"./ky.js":11177,"./lb":2967,"./lb.js":2967,"./lo":81972,"./lo.js":81972,"./lt":58469,"./lt.js":58469,"./lv":33155,"./lv.js":33155,"./me":87935,"./me.js":87935,"./mi":74483,"./mi.js":74483,"./mk":32501,"./mk.js":32501,"./ml":73120,"./ml.js":73120,"./mn":20266,"./mn.js":20266,"./mr":19406,"./mr.js":19406,"./ms":80109,"./ms-my":90864,"./ms-my.js":90864,"./ms.js":80109,"./mt":22904,"./mt.js":22904,"./my":44067,"./my.js":44067,"./nb":21301,"./nb.js":21301,"./ne":81152,"./ne.js":81152,"./nl":76735,"./nl-be":97761,"./nl-be.js":97761,"./nl.js":76735,"./nn":37569,"./nn.js":37569,"./oc-lnc":20833,"./oc-lnc.js":20833,"./pa-in":3044,"./pa-in.js":3044,"./pl":34249,"./pl.js":34249,"./pt":87585,"./pt-br":26826,"./pt-br.js":26826,"./pt.js":87585,"./ro":62526,"./ro.js":62526,"./ru":62204,"./ru.js":62204,"./sd":43270,"./sd.js":43270,"./se":61541,"./se.js":61541,"./si":71921,"./si.js":71921,"./sk":49935,"./sk.js":49935,"./sl":46254,"./sl.js":46254,"./sq":59897,"./sq.js":59897,"./sr":42496,"./sr-cyrl":11135,"./sr-cyrl.js":11135,"./sr.js":42496,"./ss":32215,"./ss.js":32215,"./sv":84716,"./sv.js":84716,"./sw":50803,"./sw.js":50803,"./ta":31538,"./ta.js":31538,"./te":2302,"./te.js":2302,"./tet":25280,"./tet.js":25280,"./tg":14100,"./tg.js":14100,"./th":95385,"./th.js":95385,"./tk":736,"./tk.js":736,"./tl-ph":79726,"./tl-ph.js":79726,"./tlh":41873,"./tlh.js":41873,"./tr":36463,"./tr.js":36463,"./tzl":27491,"./tzl.js":27491,"./tzm":29500,"./tzm-latn":80196,"./tzm-latn.js":80196,"./tzm.js":29500,"./ug-cn":91287,"./ug-cn.js":91287,"./uk":35341,"./uk.js":35341,"./ur":36246,"./ur.js":36246,"./uz":55550,"./uz-latn":77254,"./uz-latn.js":77254,"./uz.js":55550,"./vi":78796,"./vi.js":78796,"./x-pseudo":22736,"./x-pseudo.js":22736,"./yo":28621,"./yo.js":28621,"./zh-cn":67601,"./zh-cn.js":67601,"./zh-hk":39053,"./zh-hk.js":39053,"./zh-mo":71248,"./zh-mo.js":71248,"./zh-tw":74725,"./zh-tw.js":74725};function n(e){var t=r(e);return o(t)}function r(e){if(!o.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}n.keys=function(){return Object.keys(a)},n.resolve=r,e.exports=n,n.id=35358},58162:(e,t,o)=>{"use strict";e.exports=o.p+"static/media/ZEGN_USER.ab7ee48e98c0856bd407.jpeg"},18827:(e,t,o)=>{"use strict";e.exports=o.p+"static/media/crittrcove-high-resolution-logo-transparent.761085745bd386bf07cb.png"},65460:(e,t,o)=>{"use strict";e.exports=o.p+"static/media/default-pet-image.3b5628b61ce454d19bca.png"},4456:(e,t,o)=>{"use strict";e.exports=o.p+"static/media/default-profile.0695878757dbc86fae81.png"},32571:(e,t,o)=>{"use strict";e.exports=o.p+"static/media/hero-image.87d2e51026c41214df0e.jpg"},81029:(e,t,o)=>{"use strict";e.exports=o.p+"static/media/user1.7a2574d2f5544235a6c5.png"},24289:(e,t,o)=>{"use strict";e.exports=o.p+"static/media/user10.55bbb564f3b12d6a736e.png"},53198:(e,t,o)=>{"use strict";e.exports=o.p+"static/media/user2.2356c55dbde8d97f60f2.png"},52695:(e,t,o)=>{"use strict";e.exports=o.p+"static/media/user3.ceef543650ca617d5e9e.png"},30552:(e,t,o)=>{"use strict";e.exports=o.p+"static/media/user4.58378ed25cf9bc79aeb4.png"},51681:(e,t,o)=>{"use strict";e.exports=o.p+"static/media/user5.6e041c0f826063afc158.png"},10602:(e,t,o)=>{"use strict";e.exports=o.p+"static/media/user6.943d36e020756a238d35.png"},26163:(e,t,o)=>{"use strict";e.exports=o.p+"static/media/user7.1431674f298a9f88bd16.png"},244:(e,t,o)=>{"use strict";e.exports=o.p+"static/media/user8.fb62e9c497f7a3d39de8.png"},21373:(e,t,o)=>{"use strict";e.exports=o.p+"static/media/user9.fdb12560d3f0a8511959.png"}},t={};function o(a){var n=t[a];if(void 0!==n)return n.exports;var r=t[a]={id:a,loaded:!1,exports:{}};return e[a].call(r.exports,r,r.exports,o),r.loaded=!0,r.exports}o.m=e,(()=>{var e=[];o.O=(t,a,n,r)=>{if(!a){var i=1/0;for(c=0;c<e.length;c++){for(var[a,n,r]=e[c],s=!0,l=0;l<a.length;l++)(!1&r||i>=r)&&Object.keys(o.O).every((e=>o.O[e](a[l])))?a.splice(l--,1):(s=!1,r<i&&(i=r));if(s){e.splice(c--,1);var d=n();void 0!==d&&(t=d)}}return t}r=r||0;for(var c=e.length;c>0&&e[c-1][2]>r;c--)e[c]=e[c-1];e[c]=[a,n,r]}})(),o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;o.t=function(a,n){if(1&n&&(a=this(a)),8&n)return a;if("object"===typeof a&&a){if(4&n&&a.__esModule)return a;if(16&n&&"function"===typeof a.then)return a}var r=Object.create(null);o.r(r);var i={};e=e||[null,t({}),t([]),t(t)];for(var s=2&n&&a;"object"==typeof s&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach((e=>i[e]=()=>a[e]));return i.default=()=>a,o.d(r,i),r}})(),o.d=(e,t)=>{for(var a in t)o.o(t,a)&&!o.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},o.f={},o.e=e=>Promise.all(Object.keys(o.f).reduce(((t,a)=>(o.f[a](e,t),t)),[])),o.u=e=>"static/js/"+e+".aaed7a5a.chunk.js",o.miniCssF=e=>{},o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="web:";o.l=(a,n,r,i)=>{if(e[a])e[a].push(n);else{var s,l;if(void 0!==r)for(var d=document.getElementsByTagName("script"),c=0;c<d.length;c++){var u=d[c];if(u.getAttribute("src")==a||u.getAttribute("data-webpack")==t+r){s=u;break}}s||(l=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,o.nc&&s.setAttribute("nonce",o.nc),s.setAttribute("data-webpack",t+r),s.src=a),e[a]=[n];var m=(t,o)=>{s.onerror=s.onload=null,clearTimeout(g);var n=e[a];if(delete e[a],s.parentNode&&s.parentNode.removeChild(s),n&&n.forEach((e=>e(o))),t)return t(o)},g=setTimeout(m.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=m.bind(null,s.onerror),s.onload=m.bind(null,s.onload),l&&document.head.appendChild(s)}}})(),o.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),o.p="/",(()=>{var e={792:0};o.f.j=(t,a)=>{var n=o.o(e,t)?e[t]:void 0;if(0!==n)if(n)a.push(n[2]);else{var r=new Promise(((o,a)=>n=e[t]=[o,a]));a.push(n[2]=r);var i=o.p+o.u(t),s=new Error;o.l(i,(a=>{if(o.o(e,t)&&(0!==(n=e[t])&&(e[t]=void 0),n)){var r=a&&("load"===a.type?"missing":a.type),i=a&&a.target&&a.target.src;s.message="Loading chunk "+t+" failed.\n("+r+": "+i+")",s.name="ChunkLoadError",s.type=r,s.request=i,n[1](s)}}),"chunk-"+t,t)}},o.O.j=t=>0===e[t];var t=(t,a)=>{var n,r,[i,s,l]=a,d=0;if(i.some((t=>0!==e[t]))){for(n in s)o.o(s,n)&&(o.m[n]=s[n]);if(l)var c=l(o)}for(t&&t(a);d<i.length;d++)r=i[d],o.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return o.O(c)},a=self.webpackChunkweb=self.webpackChunkweb||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})();var a=o.O(void 0,[894],(()=>o(55819)));a=o.O(a)})();
//# sourceMappingURL=main.66d60c01.js.map