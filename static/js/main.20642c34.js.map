{"version":3,"file":"static/js/main.20642c34.js","mappings":"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","sources":["src/components/TutorialModal.js","src/components/ConfirmationModal.js","src/context/TutorialContext.js","src/components/Toast.js","src/components/ToastProvider.js","src/components/RoadmapSection.js","src/data/mockData.js","src/screens/HomeScreen.js","src/components/FloatingSaveButton.js","src/components/common/StepProgressIndicator.js","src/components/serviceCreation/CategorySelectionStep.js","src/components/serviceCreation/ServiceDetailsStep.js","src/components/serviceCreation/RatesAndReviewStep.js","src/components/ServiceCreationModal.js","src/components/ProfessionalServiceCard.js","src/utils/deviceUtils.js","src/components/ServiceManager.js","src/components/RecordedPets.js","src/components/EditableSection.js","src/components/ProfessionalTab.js","src/components/DatePicker.js","src/components/BackHeader.js","src/components/CrossPlatformView.js","src/utils/geocoding.js","src/components/AddressAutocomplete.js","src/components/profile/ProfileInfoTab.js","src/components/profile/ServicesAvailabilityTab.js","src/data/calculations.js","src/components/profile/PetsPreferencesTab.js","src/components/profile/SettingsPaymentsTab.js","src/components/TabBar.js","src/screens/MyProfile.js","src/components/CustomButton.js","src/validation/validation.js","src/screens/SignIn.js","src/screens/SignUp.js","src/screens/ResetPassword.js","src/screens/ResetPasswordConfirm.js","src/components/BookingCard.js","src/components/bookingComponents/ReviewAndRatesCard.js","src/components/BookingApprovalModal.js","src/utils/formatStrings.js","src/screens/Dashboard.js","src/screens/BecomeProfessional.js","src/screens/MoreScreen.js","src/components/UnavailableTimeSlot.js","src/components/AvailabilityBookingCard.js","src/components/TimePicker.js","src/components/AddAvailabilityModal.js","src/components/ui/datetime-picker.js","src/components/DefaultSettingsModal.js","src/components/AvailabilityBottomSheet.js","src/components/UnavailableTimesModal.js","src/screens/AvailabilitySettings.js","src/screens/OwnerHistory.js","src/components/DateTimePicker.js","src/utils/dateTimeValidation.js","src/components/AddOccurrenceModal.js","src/components/RequestBookingModal.js","src/components/bookingComponents/ServiceAndPetsCard.js","src/components/bookingComponents/DateSelectionCard.js","src/components/bookingComponents/TimePickerDropdown.js","src/components/bookingComponents/NewTimeRangeSelector.js","src/components/bookingComponents/DayTimeSelector.js","src/components/bookingComponents/TimeSelectionCard.js","src/components/BookingStepModal.js","src/components/BookingMessageCard.js","src/components/DraftConfirmationModal.js","src/hooks/useWebSocket.js","src/screens/MessageHistory.js","src/screens/Settings.js","src/screens/PrivacyPolicy.js","src/screens/ProfessionalSettings.js","src/screens/TermsOfService.js","src/screens/HelpFAQ.js","src/screens/ContactUs.js","src/components/SearchBar.js","src/screens/Owners.js","src/components/CostCalculationModal.js","src/components/ServiceCard.js","src/screens/ProfessionalProfile.js","src/components/ContractList.js","src/components/OwnerPicker.js","src/components/ContractTemplate.js","src/components/ChronicleSummary.js","src/components/QuestionInput.js","src/components/ChronicleForm.js","src/screens/MyContracts.js","src/screens/ChangePassword.js","src/components/CustomMultiSelect.js","src/components/Tooltip.js","src/components/ServiceTypeSelect.js","src/components/SearchRefiner.js","src/components/ProfessionalList.js","src/components/MapView.js","src/components/ProfessionalServicesModal.js","src/screens/SearchProfessionalsListing.js","src/screens/MyBookings.js","src/screens/ServiceManagerScreen.js","src/screens/BlogScreen.js","src/screens/BlogPost.js","src/screens/Waitlist.js","src/screens/TestToast.js","src/components/ConnectionCard.js","src/screens/Connections.js","App.js","src/screens/AboutScreen.js","src/api/API.js","src/components/Navigation.js","src/utils/logging.js","src/config/config.js","src/context/AuthContext.js","src/context/MessageNotificationContext.js","src/styles/theme.js","src/utils/time_utils.js","src/utils/websocket.js","node_modules/moment/locale|sync|/^/.*$","webpack/bootstrap","webpack/runtime/chunk loaded","webpack/runtime/compat get default export","webpack/runtime/define property getters","webpack/runtime/global","webpack/runtime/hasOwnProperty shorthand","webpack/runtime/make namespace object","webpack/runtime/node module decorator","webpack/runtime/publicPath","webpack/runtime/jsonp chunk loading","webpack/startup"],"sourcesContent":["import React, { useEffect, useState, useRef } from 'react';\r\nimport { View, Text, TouchableOpacity, StyleSheet, Platform, Alert, Animated, Dimensions } from 'react-native';\r\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\r\nimport { theme } from '../styles/theme';\r\nimport { debugLog } from '../context/AuthContext';\r\nimport { useNavigation } from '@react-navigation/native';\r\n\r\nconst TutorialModal = ({\r\n  step,\r\n  totalSteps,\r\n  title,\r\n  description,\r\n  onNext,\r\n  onPrevious,\r\n  onSkip,\r\n  onClose,\r\n  onFinish,\r\n  position = 'bottomRight', // bottomRight, bottomLeft, topRight, topLeft\r\n  userRole,\r\n  is_DEBUG = false\r\n}) => {\r\n  const isFirstStep = step === 1;\r\n  const isLastStep = step === totalSteps;\r\n  const [isVisible, setIsVisible] = useState(true);\r\n  const [currentScreen, setCurrentScreen] = useState(null);\r\n  const navigation = useNavigation();\r\n  \r\n  // Animation values\r\n  const fadeAnim = useRef(new Animated.Value(0)).current;\r\n  const slideAnim = useRef(new Animated.Value(0)).current;\r\n  const overlayAnim = useRef(new Animated.Value(1)).current;\r\n  const { width, height } = Dimensions.get('window');\r\n\r\n  useEffect(() => {\r\n    if (is_DEBUG) {\r\n      debugLog('MBA54321 TutorialModal mounted/updated', {\r\n        isVisible,\r\n        currentStep: step,\r\n        userRole,\r\n        screen: currentScreen\r\n      });\r\n    }\r\n  }, [isVisible, step, userRole, currentScreen]);\r\n\r\n  useEffect(() => {\r\n    // Ensure the tutorial stays visible during screen changes\r\n    if (isVisible) {\r\n      debugLog('MBA54321 Tutorial is visible, ensuring it stays visible on screen change');\r\n      const timer = setTimeout(() => {\r\n        setIsVisible(true);\r\n      }, 100);\r\n      return () => clearTimeout(timer);\r\n    }\r\n  }, [isVisible]);\r\n\r\n  // Add a focus listener to ensure the tutorial stays visible when the screen changes\r\n  useEffect(() => {\r\n    const unsubscribe = navigation.addListener('focus', () => {\r\n      if (isVisible) {\r\n        debugLog('MBA54321 Screen focused, ensuring tutorial stays visible');\r\n        setIsVisible(true);\r\n      }\r\n    });\r\n\r\n    return unsubscribe;\r\n  }, [navigation, isVisible]);\r\n\r\n  // Animation effect\r\n  useEffect(() => {\r\n    // Fade in animation for modal\r\n    Animated.timing(fadeAnim, {\r\n      toValue: 1,\r\n      duration: 500,\r\n      useNativeDriver: true,\r\n    }).start();\r\n\r\n    // Animate from center to final position\r\n    Animated.timing(slideAnim, {\r\n      toValue: 1,\r\n      duration: 800,\r\n      useNativeDriver: true,\r\n    }).start();\r\n\r\n    // Fade out the overlay as the modal slides\r\n    Animated.timing(overlayAnim, {\r\n      toValue: 0,\r\n      duration: 800,\r\n      useNativeDriver: true,\r\n    }).start();\r\n  }, []);\r\n\r\n  const handleNext = () => {\r\n    if (is_DEBUG) {\r\n      debugLog('MBA54321 TutorialModal handleNext called', { step, totalSteps });\r\n    }\r\n    onNext();\r\n  };\r\n\r\n  const handlePrevious = () => {\r\n    if (is_DEBUG) {\r\n      debugLog('MBA54321 TutorialModal handlePrevious called', { step, totalSteps });\r\n    }\r\n    onPrevious();\r\n  };\r\n\r\n  const handleSkip = () => {\r\n    if (is_DEBUG) {\r\n      debugLog('MBA54321 TutorialModal handleSkip called');\r\n    }\r\n    onSkip();\r\n  };\r\n\r\n  const handleClose = () => {\r\n    if (is_DEBUG) {\r\n      debugLog('MBA54321 TutorialModal handleClose called');\r\n    }\r\n    onClose();\r\n  };\r\n\r\n  const handleFinish = () => {\r\n    if (is_DEBUG) {\r\n      debugLog('MBA54321 TutorialModal handleFinish called');\r\n    }\r\n    onFinish();\r\n  };\r\n\r\n  const getPositionStyles = () => {\r\n    switch (position) {\r\n      case 'bottomRight':\r\n        return {\r\n          bottom: 20,\r\n          right: 20,\r\n        };\r\n      case 'bottomLeft':\r\n        return {\r\n          bottom: 20,\r\n          left: 20,\r\n        };\r\n      case 'topRight':\r\n        return {\r\n          top: 20,\r\n          right: 20,\r\n        };\r\n      case 'topLeft':\r\n        return {\r\n          top: 20,\r\n          left: 20,\r\n        };\r\n      default:\r\n        return {\r\n          bottom: 20,\r\n          right: 20,\r\n        };\r\n    }\r\n  };\r\n\r\n  // Calculate the initial position (center of screen)\r\n  const initialPosition = {\r\n    top: (height + 60) / 2 - 150,\r\n    left: (width - 15) / 2 - 160,\r\n  };\r\n\r\n  // Get the final position\r\n  const finalPosition = getPositionStyles();\r\n\r\n  // Calculate the slide animation values\r\n  const slideStyle = {\r\n    transform: [\r\n      {\r\n        translateX: slideAnim.interpolate({\r\n          inputRange: [0, 1],\r\n          outputRange: [0, finalPosition.right ? width/2 - 160 : -width/2 + 160],\r\n        }),\r\n      },\r\n      {\r\n        translateY: slideAnim.interpolate({\r\n          inputRange: [0, 1],\r\n          outputRange: [0, finalPosition.bottom ? height/2 - 150 : -height/2 + 150],\r\n        }),\r\n      },\r\n    ],\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Animated.View \r\n        style={[\r\n          styles.overlay,\r\n          { opacity: overlayAnim }\r\n        ]}\r\n        pointerEvents=\"none\"\r\n      />\r\n      <Animated.View \r\n        style={[\r\n          styles.container, \r\n          initialPosition,\r\n          { opacity: fadeAnim },\r\n          slideStyle\r\n        ]}\r\n      >\r\n        <View style={styles.pulseBorder} />\r\n        <TouchableOpacity style={styles.closeButton} onPress={handleClose}>\r\n          <MaterialCommunityIcons name=\"close\" size={20} color={theme.colors.text} />\r\n        </TouchableOpacity>\r\n\r\n        <View style={styles.content}>\r\n          <Text style={styles.title}>{title}</Text>\r\n          <Text style={styles.description}>{description}</Text>\r\n\r\n          <View style={styles.footer}>\r\n            <View style={styles.leftButtons}>\r\n              {isFirstStep ? (\r\n                <TouchableOpacity style={styles.skipButton} onPress={handleSkip}>\r\n                  <Text style={styles.skipText}>Skip Tutorial</Text>\r\n                </TouchableOpacity>\r\n              ) : (\r\n                <TouchableOpacity style={styles.navigationButton} onPress={handlePrevious}>\r\n                  <MaterialCommunityIcons name=\"chevron-left\" size={20} color={theme.colors.primary} />\r\n                  <Text style={styles.navigationText}>Previous</Text>\r\n                </TouchableOpacity>\r\n              )}\r\n            </View>\r\n\r\n            <View style={styles.stepIndicator}>\r\n              <Text style={styles.stepText}>{step}/{totalSteps}</Text>\r\n            </View>\r\n\r\n            {isLastStep ? (\r\n              <TouchableOpacity style={styles.finishButton} onPress={handleFinish}>\r\n                <Text style={styles.finishText}>Finish Tutorial</Text>\r\n              </TouchableOpacity>\r\n            ) : (\r\n              <TouchableOpacity style={styles.navigationButton} onPress={handleNext}>\r\n                <Text style={styles.navigationText}>Next</Text>\r\n                <MaterialCommunityIcons name=\"chevron-right\" size={20} color={theme.colors.primary} />\r\n              </TouchableOpacity>\r\n            )}\r\n          </View>\r\n        </View>\r\n      </Animated.View>\r\n    </>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  overlay: {\r\n    position: Platform.OS === 'web' ? 'fixed' : 'absolute',\r\n    top: 0,\r\n    left: 0,\r\n    right: 0,\r\n    bottom: 0,\r\n    backgroundColor: 'rgba(0, 0, 0, 0.5)',\r\n    zIndex: 999,\r\n  },\r\n  container: {\r\n    position: Platform.OS === 'web' ? 'fixed' : 'absolute',\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 12,\r\n    padding: 20,\r\n    width: 320,\r\n    shadowColor: '#000',\r\n    shadowOffset: {\r\n      width: 0,\r\n      height: 4,\r\n    },\r\n    shadowOpacity: 0.3,\r\n    shadowRadius: 5,\r\n    elevation: 8,\r\n    zIndex: 1000,\r\n    borderWidth: 2,\r\n    borderColor: theme.colors.primary,\r\n  },\r\n  pulseBorder: {\r\n    position: 'absolute',\r\n    top: -4,\r\n    left: -4,\r\n    right: -4,\r\n    bottom: -4,\r\n    borderRadius: 14,\r\n    opacity: 0.7,\r\n  },\r\n  closeButton: {\r\n    position: 'absolute',\r\n    top: 12,\r\n    right: 12,\r\n    padding: 8,\r\n    zIndex: 1,\r\n  },\r\n  content: {\r\n    marginTop: 12,\r\n  },\r\n  title: {\r\n    fontSize: 20,\r\n    fontWeight: '700',\r\n    color: theme.colors.primary,\r\n    marginBottom: 8,\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n  },\r\n  description: {\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n    marginBottom: 20,\r\n    lineHeight: 22,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  footer: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    marginTop: 16,\r\n  },\r\n  leftButtons: {\r\n    flex: 1,\r\n  },\r\n  skipButton: {\r\n    paddingVertical: 8,\r\n    paddingHorizontal: 12,\r\n  },\r\n  skipText: {\r\n    color: theme.colors.secondary,\r\n    fontSize: 14,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  navigationButton: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    paddingVertical: 8,\r\n    paddingHorizontal: 12,\r\n  },\r\n  navigationText: {\r\n    color: theme.colors.primary,\r\n    fontSize: 14,\r\n    fontWeight: '500',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  finishButton: {\r\n    backgroundColor: theme.colors.primary,\r\n    paddingVertical: 8,\r\n    paddingHorizontal: 16,\r\n    borderRadius: 4,\r\n  },\r\n  finishText: {\r\n    color: theme.colors.surface,\r\n    fontSize: 14,\r\n    fontWeight: '500',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  stepIndicator: {\r\n    paddingHorizontal: 12,\r\n  },\r\n  stepText: {\r\n    color: theme.colors.secondary,\r\n    fontSize: 14,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n});\r\n\r\nexport default TutorialModal; ","import React from 'react';\r\nimport { Modal, View, Text, TouchableOpacity, StyleSheet, ActivityIndicator } from 'react-native';\r\nimport { theme } from '../styles/theme';\r\n\r\nconst ConfirmationModal = ({ \r\n  visible, \r\n  onClose, \r\n  onConfirm, \r\n  actionText,\r\n  isLoading = false\r\n}) => {\r\n  return (\r\n    <Modal\r\n      visible={visible}\r\n      transparent\r\n      animationType=\"fade\"\r\n      onRequestClose={onClose}\r\n    >\r\n      <View style={styles.modalOverlay}>\r\n        <View style={styles.modalContent}>\r\n          <Text style={styles.modalText}>\r\n            Are you sure you want to {actionText}?\r\n          </Text>\r\n          \r\n          <View style={styles.buttonContainer}>\r\n            <TouchableOpacity\r\n              style={[styles.button, styles.cancelButton]}\r\n              onPress={onClose}\r\n              disabled={isLoading}\r\n            >\r\n              <Text style={[\r\n                styles.cancelButtonText,\r\n                isLoading && styles.disabledText\r\n              ]}>\r\n                Cancel\r\n              </Text>\r\n            </TouchableOpacity>\r\n            \r\n            <TouchableOpacity\r\n              style={[\r\n                styles.button, \r\n                styles.confirmButton,\r\n                isLoading && styles.disabledButton\r\n              ]}\r\n              onPress={onConfirm}\r\n              disabled={isLoading}\r\n            >\r\n              {isLoading ? (\r\n                <ActivityIndicator size=\"small\" color={theme.colors.surface} />\r\n              ) : (\r\n                <Text style={styles.confirmButtonText}>Confirm</Text>\r\n              )}\r\n            </TouchableOpacity>\r\n          </View>\r\n        </View>\r\n      </View>\r\n    </Modal>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  modalOverlay: {\r\n    flex: 1,\r\n    backgroundColor: 'rgba(0, 0, 0, 0.5)',\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n  },\r\n  modalContent: {\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 8,\r\n    padding: 20,\r\n    width: '90%',\r\n    maxWidth: 400,\r\n  },\r\n  modalText: {\r\n    fontSize: theme.fontSizes.medium,\r\n    marginBottom: 20,\r\n    textAlign: 'center',\r\n    color: theme.colors.text,\r\n  },\r\n  buttonContainer: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    gap: 10,\r\n  },\r\n  button: {\r\n    flex: 1,\r\n    paddingVertical: 12,\r\n    borderRadius: 8,\r\n    alignItems: 'center',\r\n  },\r\n  cancelButton: {\r\n    backgroundColor: theme.colors.surface,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n  },\r\n  confirmButton: {\r\n    backgroundColor: theme.colors.primary,\r\n  },\r\n  cancelButtonText: {\r\n    color: theme.colors.text,\r\n    fontWeight: '500',\r\n  },\r\n  confirmButtonText: {\r\n    color: theme.colors.surface,\r\n    fontWeight: '500',\r\n  },\r\n  disabledButton: {\r\n    opacity: 0.7,\r\n  },\r\n  disabledText: {\r\n    opacity: 0.5,\r\n  },\r\n});\r\n\r\nexport default ConfirmationModal;","import React, { createContext, useState, useContext, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport { API_BASE_URL } from '../config/config';\r\nimport { AuthContext } from './AuthContext';\r\nimport { debugLog } from './AuthContext';\r\nimport { navigateToFrom } from '../components/Navigation';\r\nimport TutorialModal from '../components/TutorialModal';\r\nimport ConfirmationModal from '../components/ConfirmationModal';\r\nimport { useNavigation } from '@react-navigation/native';\r\n\r\nexport const TutorialContext = createContext();\r\n\r\nconst defaultTutorialStatus = {\r\n  done_client_tutorial: false,\r\n  done_pro_tutorial: false,\r\n};\r\n\r\nconst tutorialSteps = {\r\n  client: [\r\n    {\r\n      screen: 'MyProfile',\r\n      tab: 'profile_info',\r\n      title: 'Welcome to Your Profile',\r\n      description: 'This is where you can manage your personal information. Start by completing your profile to help professionals understand your needs better.',\r\n      position: 'bottomRight',\r\n    },\r\n    {\r\n      screen: 'MyProfile',\r\n      tab: 'pets_preferences',\r\n      title: 'Add Pets & Home Info',\r\n      description: 'Add information about your pets and their care preferences along with your home information. This helps professionals provide the best care possible.',\r\n      position: 'bottomRight',\r\n    },\r\n    {\r\n      screen: 'MyProfile',\r\n      tab: 'settings_payments',\r\n      title: 'Payment & Settings',\r\n      description: 'Set up your settings, payment methods, and subscription preferences to easily book services.',\r\n      position: 'bottomRight',\r\n    },\r\n    {\r\n      screen: 'Dashboard',\r\n      title: 'Your Dashboard',\r\n      description: 'Here you can view your upcoming bookings, track ongoing services, and manage your account.',\r\n      position: 'bottomRight',\r\n      onStepEnter: (navigation) => {\r\n        if (navigation) {\r\n          navigation.navigate('Dashboard');\r\n        }\r\n      }\r\n    },\r\n    {\r\n      screen: 'SearchProfessionalsListing',\r\n      title: 'Find Professionals',\r\n      description: 'Search for qualified professionals in your area. Filter by service type, availability, and more.',\r\n      position: 'bottomRight',\r\n    },\r\n    {\r\n      screen: 'BecomeProfessional',\r\n      title: 'Become a Professional',\r\n      description: 'Want to offer your services? You can apply to become a professional anytime.',\r\n      position: 'bottomRight',\r\n    },\r\n  ],\r\n  professional: [\r\n    {\r\n      screen: 'MyProfile',\r\n      tab: 'profile_info',\r\n      title: 'Welcome to Your Professional Profile',\r\n      description: 'This is where you can manage your professional information. Start by completing your profile to help clients find you.',\r\n      position: 'bottomRight',\r\n    },\r\n    {\r\n      screen: 'MyProfile',\r\n      tab: 'services',\r\n      title: 'Your Services',\r\n      description: 'Add and manage the services you offer. Set your rates, availability, and service areas.',\r\n      position: 'bottomRight',\r\n    },\r\n    {\r\n      screen: 'MyProfile',\r\n      tab: 'settings_payments',\r\n      title: 'Payment Settings',\r\n      description: 'Set up your payment methods and subscription preferences to receive payments from clients.',\r\n      position: 'bottomRight',\r\n    },\r\n    {\r\n      screen: 'Dashboard',\r\n      title: 'Your Dashboard',\r\n      description: 'Here you can view your upcoming bookings, track ongoing services, and manage your account.',\r\n      position: 'bottomRight',\r\n      onStepEnter: (navigation) => {\r\n        if (navigation) {\r\n          navigation.navigate('Dashboard');\r\n        }\r\n      }\r\n    },\r\n    {\r\n      screen: 'SearchClients',\r\n      title: 'Find Clients',\r\n      description: 'Search for potential clients in your area. Filter by service type, pet type, and more.',\r\n      position: 'bottomRight',\r\n    },\r\n  ],\r\n  // Default steps for when userRole is not set\r\n  default: [\r\n    {\r\n      screen: 'Home',\r\n      title: 'Welcome',\r\n      description: 'Welcome to CrittrCove! Let\\'s get started with a quick tour.',\r\n      position: 'bottomRight',\r\n    }\r\n  ]\r\n};\r\n\r\nexport const TutorialProvider = ({ children }) => {\r\n  const { isSignedIn, userRole, is_DEBUG } = useContext(AuthContext);\r\n  const navigation = useNavigation();\r\n  const [tutorialStatus, setTutorialStatus] = useState(defaultTutorialStatus);\r\n  const [currentStep, setCurrentStep] = useState(1);\r\n  const [isVisible, setIsVisible] = useState(false);\r\n  const [hasError, setHasError] = useState(false);\r\n  const [errorMessage, setErrorMessage] = useState('');\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [skipConfirmationVisible, setSkipConfirmationVisible] = useState(false);\r\n  const [closeConfirmationVisible, setCloseConfirmationVisible] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (isSignedIn && userRole) {\r\n      debugLog(\"MBA54321 Both isSignedIn and userRole are available, fetching tutorial status\", { isSignedIn, userRole });\r\n      fetchTutorialStatus();\r\n    } else {\r\n      debugLog(\"MBA54321 Waiting for auth data\", { isSignedIn, userRole });\r\n      setIsLoading(false);\r\n    }\r\n  }, [isSignedIn, userRole]);\r\n\r\n  const fetchTutorialStatus = async () => {\r\n    try {\r\n      setIsLoading(true);\r\n      const response = await axios.get(`${API_BASE_URL}/api/users/v1/tutorial-status/current/`);\r\n      if (is_DEBUG) {\r\n        debugLog('MBA54321 Tutorial status:', response.data);\r\n      }\r\n      setTutorialStatus(response.data);\r\n      setHasError(false);\r\n      setErrorMessage('');\r\n      \r\n      // Show tutorial if it's not completed\r\n      if ((userRole === 'professional' && !response.data.done_pro_tutorial) ||\r\n          (userRole === 'petOwner' && !response.data.done_client_tutorial)) {\r\n        setIsVisible(true);\r\n        \r\n        // Redirect new users to MyProfile screen\r\n        if (is_DEBUG) {\r\n          debugLog('MBA54321 Redirecting new user to MyProfile screen');\r\n        }\r\n        // Use navigateToFrom instead of navigation.navigate to ensure proper tab highlighting\r\n        navigateToFrom(navigation, 'MyProfile', 'Dashboard', { screen: 'profile_info' });\r\n        \r\n        if (is_DEBUG) {\r\n          debugLog('MBA54321 Tutorial should be visible:', {\r\n            userRole,\r\n            done_client_tutorial: response.data.done_client_tutorial,\r\n            done_pro_tutorial: response.data.done_pro_tutorial\r\n          });\r\n        }\r\n      } else {\r\n        if (is_DEBUG) {\r\n          debugLog('MBA54321 Tutorial should NOT be visible');\r\n        }\r\n        setIsVisible(false);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching tutorial status:', error);\r\n      setHasError(true);\r\n      setErrorMessage('We had trouble loading your tutorial settings, but you can still proceed with the tutorial.');\r\n      // Show tutorial with default settings if there's an error\r\n      setTutorialStatus(defaultTutorialStatus);\r\n      setIsVisible(true);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const updateTutorialStatus = async (updates) => {\r\n    try {\r\n      const response = await axios.patch(\r\n        `${API_BASE_URL}/api/users/v1/tutorial-status/update_status/`,\r\n        updates\r\n      );\r\n      if (is_DEBUG) {\r\n        debugLog('MBA54321 Tutorial status updated:', response.data);\r\n      }\r\n      setTutorialStatus(response.data);\r\n      setHasError(false);\r\n      setErrorMessage('');\r\n    } catch (error) {\r\n      console.error('Error updating tutorial status:', error);\r\n      setHasError(true);\r\n      setErrorMessage('We had trouble saving your tutorial progress, but you can continue using the app.');\r\n      // Continue with local state even if server update fails\r\n      setTutorialStatus(prev => ({ ...prev, ...updates }));\r\n    }\r\n  };\r\n\r\n  const getCurrentStepData = () => {\r\n    // Determine which steps to use based on userRole\r\n    let roleKey = 'default';\r\n    if (userRole === 'professional') {\r\n      roleKey = 'professional';\r\n    } else if (userRole === 'petOwner' || userRole === 'client') {\r\n      roleKey = 'client';\r\n    }\r\n    \r\n    const steps = tutorialSteps[roleKey] || tutorialSteps.default;\r\n    \r\n    // Make sure currentStep is within bounds\r\n    const safeCurrentStep = Math.min(Math.max(1, currentStep), steps.length);\r\n    \r\n    // Get the step data\r\n    const stepData = steps[safeCurrentStep - 1];\r\n    \r\n    // If there's an error, add it to the first step's description\r\n    if (hasError && safeCurrentStep === 1) {\r\n      return {\r\n        ...stepData,\r\n        description: `${errorMessage}\\n\\n${stepData.description}`\r\n      };\r\n    }\r\n    \r\n    return stepData;\r\n  };\r\n\r\n  const handleNext = async () => {\r\n    debugLog(\"MBA54321 handleNext called\", { currentStep, userRole });\r\n    \r\n    // Check if we're at the last step\r\n    const roleKey = userRole === 'professional' ? 'professional' : 'client';\r\n    const steps = tutorialSteps[roleKey];\r\n    \r\n    if (currentStep >= steps.length) {\r\n      debugLog(\"MBA54321 At last step, completing tutorial\", { currentStep, totalSteps: steps.length });\r\n      // Don't complete the tutorial here, just move to the next step\r\n      // The tutorial will be completed when the user clicks the \"Finish Tutorial\" button\r\n      return;\r\n    }\r\n    \r\n    // Get the next step data before incrementing the step counter\r\n    const nextStep = steps[currentStep];\r\n    const currentStepData = steps[currentStep - 1];\r\n    \r\n    debugLog(\"MBA54321 Current step data\", currentStepData);\r\n    debugLog(\"MBA54321 Next step data\", nextStep);\r\n    \r\n    // Increment the step counter first\r\n    setCurrentStep(prevStep => prevStep + 1);\r\n    \r\n    // If we're navigating to a different screen or tab\r\n    if (nextStep.screen !== currentStepData.screen || (nextStep.tab && nextStep.tab !== currentStepData.tab)) {\r\n      debugLog(\"MBA54321 Navigating to different screen/tab\", { \r\n        from: currentStepData.screen, \r\n        to: nextStep.screen,\r\n        fromTab: currentStepData.tab,\r\n        toTab: nextStep.tab\r\n      });\r\n      \r\n      // Use navigateToFrom for consistent navigation behavior\r\n      if (nextStep.tab) {\r\n        // If we have a tab parameter, pass it in the params\r\n        navigateToFrom(navigation, nextStep.screen, currentStepData.screen, { screen: nextStep.tab });\r\n      } else {\r\n        // For screens without tabs\r\n        navigateToFrom(navigation, nextStep.screen, currentStepData.screen);\r\n      }\r\n      \r\n      // Keep the tutorial visible after navigation\r\n      setTimeout(() => {\r\n        setIsVisible(true);\r\n      }, 700);\r\n    }\r\n  };\r\n\r\n  const handlePrevious = () => {\r\n    debugLog(\"MBA54321 handlePrevious called\", { currentStep, userRole });\r\n    \r\n    if (currentStep > 1) {\r\n      // Get the previous step data before decrementing the step counter\r\n      const roleKey = userRole === 'professional' ? 'professional' : 'client';\r\n      const steps = tutorialSteps[roleKey];\r\n      const previousStep = steps[currentStep - 2]; // -2 because currentStep is 1-indexed\r\n      const currentStepData = steps[currentStep - 1];\r\n      \r\n      debugLog(\"MBA54321 Previous step data\", previousStep);\r\n      debugLog(\"MBA54321 Current step data\", currentStepData);\r\n      \r\n      // Decrement the step counter\r\n      setCurrentStep(prevStep => prevStep - 1);\r\n      \r\n      // If we're navigating to a different screen or tab\r\n      if (previousStep.screen !== currentStepData.screen || (previousStep.tab && previousStep.tab !== currentStepData.tab)) {\r\n        debugLog(\"MBA54321 Navigating back to different screen/tab\", { \r\n          from: currentStepData.screen, \r\n          to: previousStep.screen,\r\n          fromTab: currentStepData.tab,\r\n          toTab: previousStep.tab\r\n        });\r\n        \r\n        // Use navigateToFrom for consistent navigation behavior\r\n        if (previousStep.tab) {\r\n          // If we have a tab parameter, pass it in the params\r\n          navigateToFrom(navigation, previousStep.screen, currentStepData.screen, { screen: previousStep.tab });\r\n        } else {\r\n          // For screens without tabs\r\n          navigateToFrom(navigation, previousStep.screen, currentStepData.screen);\r\n        }\r\n        \r\n        // Keep the tutorial visible after navigation\r\n        setTimeout(() => {\r\n          setIsVisible(true);\r\n        }, 700);\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleSkip = () => {\r\n    debugLog('MBA54321 handleSkip called through the later');\r\n    // Show confirmation modal before skipping\r\n    setSkipConfirmationVisible(true);\r\n  };\r\n\r\n  const handleSkipConfirm = () => {\r\n    debugLog('MBA54321 handleSkipConfirm called');\r\n    setSkipConfirmationVisible(false);\r\n    completeTutorial();\r\n  };\r\n\r\n  const handleSkipCancel = () => {\r\n    debugLog('MBA54321 handleSkipCancel called');\r\n    setSkipConfirmationVisible(false);\r\n  };\r\n\r\n  const handleClose = () => {\r\n    debugLog('MBA54321 handleClose called');\r\n    setCloseConfirmationVisible(true);\r\n  };\r\n\r\n  const handleCloseConfirm = () => {\r\n    debugLog('MBA54321 handleCloseConfirm called');\r\n    setCloseConfirmationVisible(false);\r\n    completeTutorial();\r\n  };\r\n\r\n  const handleCloseCancel = () => {\r\n    debugLog('MBA54321 handleCloseCancel called');\r\n    setCloseConfirmationVisible(false);\r\n  };\r\n\r\n  const completeTutorial = async () => {\r\n    debugLog(\"MBA54321 Completing tutorial\", { userRole });\r\n    \r\n    try {\r\n      // Update the tutorial status in the backend based on user role\r\n      const updates = {};\r\n      \r\n      // Set the appropriate tutorial completion flag based on user role\r\n      if (userRole === 'professional') {\r\n        updates.done_pro_tutorial = true;\r\n      } else if (userRole === 'petOwner' || userRole === 'client') {\r\n        updates.done_client_tutorial = true;\r\n      }\r\n      \r\n      // Update the tutorial status in the backend\r\n      await axios.patch(`${API_BASE_URL}/api/users/v1/tutorial-status/update_status/`, updates);\r\n      \r\n      debugLog(\"MBA54321 Tutorial status updated in backend\");\r\n      \r\n      // Hide the tutorial modal\r\n      setIsVisible(false);\r\n      \r\n      // Navigate to the Dashboard\r\n      debugLog(\"MBA54321 Navigating to Dashboard\");\r\n      navigateToFrom(navigation, 'Dashboard', getCurrentStepData().screen);\r\n      \r\n    } catch (error) {\r\n      debugLog(\"MBA54321 Error completing tutorial\", { error: error.message });\r\n      console.error('Error completing tutorial:', error);\r\n      \r\n      // Even if there's an error, try to navigate to Dashboard\r\n      navigateToFrom(navigation, 'Dashboard', getCurrentStepData().screen);\r\n    }\r\n  };\r\n\r\n  // If still loading, return a loading state\r\n  if (isLoading) {\r\n    return (\r\n      <TutorialContext.Provider\r\n        value={{\r\n          isVisible: false,\r\n          currentStep: 1,\r\n          totalSteps: 1,\r\n          stepData: tutorialSteps.default[0],\r\n          tutorialStatus: defaultTutorialStatus,\r\n          hasError: false,\r\n          errorMessage: '',\r\n          handleNext: () => {},\r\n          handlePrevious: () => {},\r\n          handleSkip: () => {},\r\n          completeTutorial: () => {},\r\n          setIsVisible: () => {},\r\n          isLoading: true\r\n        }}\r\n      >\r\n        {children}\r\n      </TutorialContext.Provider>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <TutorialContext.Provider\r\n      value={{\r\n        isVisible,\r\n        setIsVisible,\r\n        currentStep,\r\n        setCurrentStep,\r\n        handleNext,\r\n        handlePrevious,\r\n        handleSkip,\r\n        completeTutorial,\r\n        isLoading,\r\n      }}\r\n    >\r\n      {children}\r\n      {isVisible && getCurrentStepData() && (\r\n        <TutorialModal\r\n          step={currentStep}\r\n          totalSteps={tutorialSteps[userRole === 'professional' ? 'professional' : \r\n                     (userRole === 'petOwner' || userRole === 'client') ? 'client' : 'default'].length}\r\n          title={getCurrentStepData().title}\r\n          description={getCurrentStepData().description}\r\n          onNext={handleNext}\r\n          onPrevious={handlePrevious}\r\n          onSkip={handleSkip}\r\n          onClose={handleClose}\r\n          onFinish={completeTutorial}\r\n          position={getCurrentStepData().position}\r\n          userRole={userRole}\r\n          is_DEBUG={is_DEBUG}\r\n        />\r\n      )}\r\n      <ConfirmationModal\r\n        visible={skipConfirmationVisible}\r\n        onClose={handleSkipCancel}\r\n        onConfirm={handleSkipConfirm}\r\n        actionText=\"skip the tutorial\"\r\n        isLoading={false}\r\n      />\r\n      <ConfirmationModal\r\n        visible={closeConfirmationVisible}\r\n        onClose={handleCloseCancel}\r\n        onConfirm={handleCloseConfirm}\r\n        actionText=\"close the tutorial\"\r\n        isLoading={false}\r\n      />\r\n    </TutorialContext.Provider>\r\n  );\r\n}; ","import React, { useEffect, useRef } from 'react';\r\nimport { View, Text, StyleSheet, Animated, TouchableOpacity, Dimensions, Platform } from 'react-native';\r\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\r\nimport { theme } from '../styles/theme';\r\n\r\n/**\r\n * Toast notification component that slides in from the right corner\r\n * \r\n * @param {Object} props Component props\r\n * @param {boolean} props.visible Whether the toast is visible\r\n * @param {string} props.message The message to display in the toast\r\n * @param {string} props.type The type of toast: 'success', 'error', 'info', 'warning'\r\n * @param {Function} props.onDismiss Callback when toast is dismissed\r\n * @param {number} props.duration Duration in ms to show toast before auto-dismissing (default: 3000ms)\r\n */\r\nconst Toast = ({ \r\n  visible, \r\n  message, \r\n  type = 'success', \r\n  onDismiss,\r\n  duration = 3000\r\n}) => {\r\n  const animation = useRef(new Animated.Value(Dimensions.get('window').width)).current;\r\n  const opacity = useRef(new Animated.Value(0)).current;\r\n  const timeoutRef = useRef(null);\r\n\r\n  const getBackgroundColor = () => {\r\n    switch (type) {\r\n      case 'error':\r\n        return theme.colors.error;\r\n      case 'warning':\r\n        return theme.colors.warning || '#FFA726';\r\n      case 'info':\r\n        return theme.colors.info || '#29B6F6';\r\n      case 'success':\r\n      default:\r\n        return theme.colors.primary;\r\n    }\r\n  };\r\n\r\n  const getIcon = () => {\r\n    switch (type) {\r\n      case 'error':\r\n        return 'alert-circle';\r\n      case 'warning':\r\n        return 'alert';\r\n      case 'info':\r\n        return 'information';\r\n      case 'success':\r\n      default:\r\n        return 'check-circle';\r\n    }\r\n  };\r\n\r\n  const animateIn = () => {\r\n    Animated.parallel([\r\n      Animated.timing(animation, {\r\n        toValue: 0,\r\n        duration: 300,\r\n        useNativeDriver: true,\r\n      }),\r\n      Animated.timing(opacity, {\r\n        toValue: 1,\r\n        duration: 300,\r\n        useNativeDriver: true,\r\n      })\r\n    ]).start();\r\n  };\r\n\r\n  const animateOut = (callback) => {\r\n    Animated.parallel([\r\n      Animated.timing(animation, {\r\n        toValue: Dimensions.get('window').width,\r\n        duration: 300,\r\n        useNativeDriver: true,\r\n      }),\r\n      Animated.timing(opacity, {\r\n        toValue: 0,\r\n        duration: 300,\r\n        useNativeDriver: true,\r\n      })\r\n    ]).start(callback);\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (visible) {\r\n      // Clear any existing timer\r\n      if (timeoutRef.current) {\r\n        clearTimeout(timeoutRef.current);\r\n      }\r\n      \r\n      // Animate in\r\n      animateIn();\r\n      \r\n      // Set timer to automatically dismiss\r\n      timeoutRef.current = setTimeout(() => {\r\n        handleDismiss();\r\n      }, duration);\r\n    }\r\n\r\n    // Cleanup\r\n    return () => {\r\n      if (timeoutRef.current) {\r\n        clearTimeout(timeoutRef.current);\r\n      }\r\n    };\r\n  }, [visible, duration]);\r\n\r\n  const handleDismiss = () => {\r\n    if (timeoutRef.current) {\r\n      clearTimeout(timeoutRef.current);\r\n    }\r\n    \r\n    animateOut(() => {\r\n      if (onDismiss) {\r\n        onDismiss();\r\n      }\r\n    });\r\n  };\r\n\r\n  if (!visible) return null;\r\n\r\n  return (\r\n    <View style={styles.container} pointerEvents=\"box-none\">\r\n      <Animated.View\r\n        style={[\r\n          styles.toast,\r\n          {\r\n            backgroundColor: getBackgroundColor(),\r\n            transform: [{ translateX: animation }],\r\n            opacity: opacity\r\n          }\r\n        ]}\r\n      >\r\n        <View style={styles.content}>\r\n          <MaterialCommunityIcons name={getIcon()} size={24} color=\"white\" style={styles.icon} />\r\n          <Text style={styles.message} numberOfLines={3} ellipsizeMode=\"tail\">{message}</Text>\r\n        </View>\r\n        <TouchableOpacity onPress={handleDismiss} style={styles.closeButton} hitSlop={{ top: 10, bottom: 10, left: 10, right: 10 }}>\r\n          <MaterialCommunityIcons name=\"close\" size={18} color=\"white\" />\r\n        </TouchableOpacity>\r\n      </Animated.View>\r\n    </View>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    position: Platform.OS === 'web' ? 'fixed' : 'absolute',\r\n    bottom: 20,\r\n    right: 0,\r\n    zIndex: 9999,\r\n    paddingHorizontal: 16,\r\n    width: '100%',\r\n    alignItems: 'flex-end',\r\n  },\r\n  toast: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    justifyContent: 'space-between',\r\n    paddingVertical: 12,\r\n    paddingHorizontal: 12, \r\n    borderRadius: 8,\r\n    minWidth: 200,\r\n    maxWidth: 300,\r\n    elevation: 6,\r\n    shadowColor: '#000',\r\n    shadowOffset: { width: 0, height: 2 },\r\n    shadowOpacity: 0.25,\r\n    shadowRadius: 3.84,\r\n  },\r\n  content: {\r\n    flex: 1,\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n  },\r\n  icon: {\r\n    marginRight: 8,\r\n  },\r\n  message: {\r\n    color: '#fff',\r\n    fontSize: 14,\r\n    fontFamily: Platform.OS === 'web' ? undefined : theme.fonts?.regular?.fontFamily,\r\n    flex: 1,\r\n  },\r\n  closeButton: {\r\n    padding: 4,\r\n  }\r\n});\r\n\r\nexport default Toast; ","import React, { createContext, useState, useContext, useCallback } from 'react';\r\nimport { View, StyleSheet } from 'react-native';\r\nimport Toast from './Toast';\r\n\r\n// Create context\r\nconst ToastContext = createContext();\r\n\r\n/**\r\n * Hook to use the toast functionality\r\n * @returns {Function} showToast - Function to show a toast\r\n */\r\nexport const useToast = () => {\r\n  const context = useContext(ToastContext);\r\n  if (!context) {\r\n    throw new Error('useToast must be used within a ToastProvider');\r\n  }\r\n  return context;\r\n};\r\n\r\n/**\r\n * Provider component that wraps your app and provides toast functionality\r\n */\r\nexport const ToastProvider = ({ children }) => {\r\n  const [toast, setToast] = useState({\r\n    visible: false,\r\n    message: '',\r\n    type: 'success',\r\n    duration: 3000,\r\n  });\r\n\r\n  // Function to show a toast notification\r\n  const showToast = useCallback(({ message, type = 'success', duration = 3000 }) => {\r\n    setToast({\r\n      visible: true,\r\n      message,\r\n      type,\r\n      duration,\r\n    });\r\n  }, []);\r\n\r\n  // Function to hide the toast\r\n  const hideToast = useCallback(() => {\r\n    setToast(prev => ({\r\n      ...prev,\r\n      visible: false,\r\n    }));\r\n  }, []);\r\n\r\n  return (\r\n    <ToastContext.Provider value={showToast}>\r\n      <View style={styles.container}>\r\n        {children}\r\n        <Toast\r\n          visible={toast.visible}\r\n          message={toast.message}\r\n          type={toast.type}\r\n          duration={toast.duration}\r\n          onDismiss={hideToast}\r\n        />\r\n      </View>\r\n    </ToastContext.Provider>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    position: 'relative',\r\n  }\r\n});\r\n\r\nexport default ToastProvider; ","import React, { useState, useEffect, useContext } from 'react';\r\nimport { View, Text, TouchableOpacity, StyleSheet, Modal, Platform } from 'react-native';\r\nimport { FontAwesome5 } from '@expo/vector-icons';\r\nimport { theme } from '../styles/theme';\r\nimport { AuthContext } from '../context/AuthContext';\r\n\r\nconst RoadmapSection = () => {\r\n  const [selectedMilestone, setSelectedMilestone] = useState(null);\r\n  const [modalVisible, setModalVisible] = useState(false);\r\n  const { screenWidth } = useContext(AuthContext);\r\n  const isMobile = screenWidth < 768;\r\n\r\n  const roadmapData = [\r\n    {\r\n      id: 1,\r\n    //   number: '01',\r\n      title: 'Prototype Launch',\r\n      description: 'Initial release of CrittrCove webpage and landing page with no signup or app functionality.',\r\n      icon: 'dog',\r\n      color: theme.colors.mainColors.senary // Royal Blue\r\n    },\r\n    {\r\n      id: 2,\r\n    //   number: '02',\r\n      title: 'Launch of MVP',\r\n      description: 'This is when users will be able to sign up and use the app fully for the first time on the website! For a full feature list, please check our blog or discord.',\r\n      icon: 'dragon',\r\n      color: theme.colors.mainColors.quinary // Medium Purple\r\n    },\r\n    {\r\n      id: 3,\r\n    //   number: '03',\r\n      title: 'Launch of App',\r\n      description: 'Mobile app release with real-time messaging, notifications, and payment integration. For a full feature list, please check our blog or discord.',\r\n      icon: 'cat',\r\n      color: theme.colors.mainColors.quaternary // Royal Blue\r\n    },\r\n    {\r\n      id: 4,\r\n    //   number: '04',\r\n      title: 'Community Features',\r\n      description: 'Adding social features, pet communities, and expert advice forums.',\r\n      icon: 'fish',\r\n      color: theme.colors.mainColors.main // Medium Purple\r\n    }\r\n  ];\r\n\r\n  const handleMilestonePress = (milestone) => {\r\n    setSelectedMilestone(milestone);\r\n    setModalVisible(true);\r\n  };\r\n\r\n  return (\r\n    <View style={styles.container}>\r\n      <Text style={styles.title}>Roadmap</Text>\r\n      \r\n      {isMobile ? (\r\n        // Mobile Layout\r\n        <View style={styles.mobileContainer}>\r\n          {roadmapData.map((milestone, index) => (\r\n            <View key={milestone.id} style={[\r\n              styles.mobileItemContainer,\r\n              index === roadmapData.length - 1 ? { marginBottom: 0 } : null\r\n            ]}>\r\n              <TouchableOpacity\r\n                style={styles.mobileMarker}\r\n                onPress={() => handleMilestonePress(milestone)}\r\n              >\r\n                <View style={[styles.markerContainer, { backgroundColor: milestone.color }]}>\r\n                  <FontAwesome5 name={milestone.icon} size={24} color=\"white\" />\r\n                </View>\r\n              </TouchableOpacity>\r\n              <Text style={styles.mobileMilestoneTitle}>{milestone.title}</Text>\r\n              {index < roadmapData.length - 1 && (\r\n                <View style={styles.mobileDashedLine} />\r\n              )}\r\n            </View>\r\n          ))}\r\n        </View>\r\n      ) : (\r\n        // Web Layout\r\n        <View style={styles.webContainer}>\r\n          <View style={[styles.dashedLine, {\r\n            width: '80%',\r\n            left: '10%'\r\n          }]} />\r\n          {roadmapData.map((milestone, index) => (\r\n            <TouchableOpacity\r\n              key={milestone.id}\r\n              style={[\r\n                styles.webMarker,\r\n                { \r\n                  left: `${10 + (index * (80 / (roadmapData.length - 1)))}%`,\r\n                }\r\n              ]}\r\n              onPress={() => handleMilestonePress(milestone)}\r\n            >\r\n              <View style={[styles.markerContainer, { backgroundColor: milestone.color }]}>\r\n                <FontAwesome5 name={milestone.icon} size={24} color=\"white\" />\r\n              </View>\r\n              <Text style={styles.webMilestoneTitle}>{milestone.title}</Text>\r\n            </TouchableOpacity>\r\n          ))}\r\n        </View>\r\n      )}\r\n\r\n      {/* Modal for milestone details */}\r\n      <Modal\r\n        visible={modalVisible}\r\n        transparent={true}\r\n        animationType=\"fade\"\r\n        onRequestClose={() => setModalVisible(false)}\r\n      >\r\n        <View style={styles.modalOverlay}>\r\n          <View style={styles.modalContent}>\r\n            {selectedMilestone && (\r\n              <>\r\n                <View style={[styles.modalIconContainer, { backgroundColor: selectedMilestone.color }]}>\r\n                  <Text style={styles.modalNumber}>{selectedMilestone.number}</Text>\r\n                  <FontAwesome5 \r\n                    name={selectedMilestone.icon} \r\n                    size={40} \r\n                    color=\"white\"\r\n                  />\r\n                </View>\r\n                <Text style={styles.modalTitle}>{selectedMilestone.title}</Text>\r\n                <Text style={styles.modalDescription}>\r\n                  {selectedMilestone.description}\r\n                </Text>\r\n                <TouchableOpacity\r\n                  style={[styles.closeButton, { backgroundColor: selectedMilestone.color }]}\r\n                  onPress={() => setModalVisible(false)}\r\n                >\r\n                  <Text style={styles.closeButtonText}>Close</Text>\r\n                </TouchableOpacity>\r\n              </>\r\n            )}\r\n          </View>\r\n        </View>\r\n      </Modal>\r\n    </View>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    padding: 20,\r\n    width: '100%',\r\n    maxWidth: 1200,\r\n    marginLeft: 'auto',\r\n    marginRight: 'auto',\r\n  },\r\n  title: {\r\n    fontSize: 24,\r\n    fontWeight: 'bold',\r\n    textAlign: 'center',\r\n    marginBottom: 40,\r\n    color: 'black',\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n  },\r\n  mobileContainer: {\r\n    width: '100%',\r\n    alignItems: 'center',\r\n    paddingVertical: 20,\r\n  },\r\n  mobileItemContainer: {\r\n    width: '100%',\r\n    alignItems: 'center',\r\n    marginBottom: 80,\r\n    position: 'relative',\r\n  },\r\n  mobileMarker: {\r\n    alignItems: 'center',\r\n    marginBottom: 20,\r\n  },\r\n  mobileMilestoneTitle: {\r\n    fontSize: 16,\r\n    fontWeight: 'bold',\r\n    color: 'black',\r\n    marginTop: 15,\r\n    textAlign: 'center',\r\n    marginBottom: 30,\r\n  },\r\n  mobileDashedLine: {\r\n    position: 'absolute',\r\n    width: 2,\r\n    height: 60,\r\n    bottom: -50,\r\n    borderStyle: 'dashed',\r\n    borderWidth: 1,\r\n    borderColor: '#333',\r\n  },\r\n  webContainer: {\r\n    // height: 200,\r\n    position: 'relative',\r\n    marginTop: 20,\r\n    marginBottom: 120,\r\n    width: '100%',\r\n  },\r\n  dashedLine: {\r\n    position: 'absolute',\r\n    height: 2,\r\n    top: 30,\r\n    borderStyle: 'dashed',\r\n    borderWidth: 1,\r\n    borderColor: '#333',\r\n  },\r\n  webMarker: {\r\n    position: 'absolute',\r\n    alignItems: 'center',\r\n    width: 120,\r\n    transform: [{ translateX: -60 }], // Center the marker\r\n  },\r\n  webMilestoneTitle: {\r\n    marginTop: 10,\r\n    fontSize: 16,\r\n    fontWeight: 'bold',\r\n    color: 'black',\r\n    textAlign: 'center',\r\n  },\r\n  markerContainer: {\r\n    width: 60,\r\n    height: 60,\r\n    borderRadius: 30,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    shadowColor: '#000',\r\n    shadowOffset: { width: 0, height: 2 },\r\n    shadowOpacity: 0.25,\r\n    shadowRadius: 4,\r\n    elevation: 5,\r\n  },\r\n  modalOverlay: {\r\n    flex: 1,\r\n    backgroundColor: 'rgba(0, 0, 0, 0.5)',\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    padding: 20,\r\n  },\r\n  modalContent: {\r\n    backgroundColor: 'white',\r\n    padding: 20,\r\n    borderRadius: 15,\r\n    width: '90%',\r\n    maxWidth: 400,\r\n    alignItems: 'center',\r\n  },\r\n  modalIconContainer: {\r\n    width: 80,\r\n    height: 80,\r\n    borderRadius: 40,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    marginBottom: 20,\r\n  },\r\n  modalNumber: {\r\n    color: 'white',\r\n    fontSize: 20,\r\n    fontWeight: 'bold',\r\n    position: 'absolute',\r\n    top: 10,\r\n  },\r\n  modalTitle: {\r\n    fontSize: 24,\r\n    fontWeight: 'bold',\r\n    marginBottom: 15,\r\n    color: 'black',\r\n    textAlign: 'center',\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n  },\r\n  modalDescription: {\r\n    fontSize: 18,\r\n    textAlign: 'center',\r\n    marginBottom: 20,\r\n    color: 'black',\r\n    lineHeight: 24,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  closeButton: {\r\n    padding: 12,\r\n    borderRadius: 8,\r\n    width: '100%',\r\n    alignItems: 'center',\r\n  },\r\n  closeButtonText: {\r\n    color: 'white',\r\n    fontSize: 16,\r\n    fontWeight: 'bold',\r\n  },\r\n});\r\n\r\nexport default RoadmapSection; ","// First, declare the BOOKING_STATES constant\r\nexport const BOOKING_STATES = {\r\n  // # Initial States\r\n  DRAFT: 'Draft',\r\n  PENDING_INITIAL_PROFESSIONAL_CHANGES: 'Pending Initial Professional Changes',\r\n    \r\n  // # Review States\r\n  PENDING_PROFESSIONAL_CHANGES: 'Pending Professional Changes',\r\n  PENDING_CLIENT_APPROVAL: 'Pending Owner Approval',\r\n    \r\n  // # Active States\r\n  CONFIRMED: 'Confirmed',\r\n  CONFIRMED_PENDING_PROFESSIONAL_CHANGES: 'Confirmed Pending Professional Changes',\r\n  CONFIRMED_PENDING_CLIENT_APPROVAL: 'Confirmed Pending Owner Approval',\r\n    \r\n  // # Terminal States\r\n  COMPLETED: 'Completed',\r\n  DENIED: 'Denied',\r\n  CANCELLED: 'Cancelled',\r\n\r\n  // # States where professionals can edit\r\n  PROFESSIONAL_EDITABLE_STATES: [\r\n    'Draft',\r\n    'Pending Initial Professional Changes',\r\n    'Pending Professional Changes',\r\n    'Confirmed Pending Professional Changes',\r\n    'Confirmed'\r\n  ]\r\n};\r\n\r\nexport const ALL_SERVICES = \"All Services\";\r\nexport const SERVICE_TYPES = [\r\n  ALL_SERVICES,\r\n  \"Overnight Cat Sitting (Owner's Home)\",\r\n  \"Cat Boarding\",\r\n  \"Drop-In Visits (30 min)\",\r\n  \"Drop-In Visits (60 min)\",\r\n  \"Dog Walking\",\r\n  \"Doggy Day Care\",\r\n  \"Pet Boarding\",\r\n  \"Exotic Pet Care\",\r\n  \"Daytime Pet Sitting\",\r\n  \"Ferrier\",\r\n];\r\n\r\nexport const TIME_OPTIONS = [\r\n  '15 Min',\r\n  '30 Min',\r\n  '45 Min',\r\n  '1 Hour',\r\n  '2 Hour',\r\n  '3 Hour',\r\n  '4 Hour',\r\n  '5 Hour',\r\n  '6 Hour',\r\n  '7 Hour',\r\n  '8 Hour',\r\n  '24 Hour',\r\n  'Per Day',\r\n  'Per Visit',\r\n  'Week'\r\n];\r\n\r\n// Mapping of user-friendly time unit labels to backend constants\r\nexport const TIME_UNIT_MAPPING = {\r\n  // User-friendly labels mapped to backend constants\r\n  'Per Visit': 'Per Visit',\r\n  'Per Day (24 Hours)': 'Per Day',\r\n  'Per Night': 'Per Night',\r\n  'Every 15 Minutes': '15 Min',\r\n  'Every 30 Minutes': '30 Min',\r\n  'Every 45 Minutes': '45 Min',\r\n  'Per Hour': '1 Hour',\r\n  'Every 2 Hours': '2 Hour',\r\n  'Every 3 Hours': '3 Hour',\r\n  'Every 4 Hours': '4 Hour',\r\n  'Every 5 Hours': '5 Hour',\r\n  'Every 6 Hours': '6 Hour',\r\n  'Every 7 Hours': '7 Hour',\r\n  'Every 8 Hours': '8 Hour',\r\n  'Per Week': 'Week'\r\n};\r\n\r\n// Reverse mapping for display purposes\r\nexport const BACKEND_TO_FRONTEND_TIME_UNIT = Object.entries(TIME_UNIT_MAPPING).reduce((acc, [key, value]) => {\r\n  acc[value] = key;\r\n  return acc;\r\n}, {});\r\n\r\nexport const mockAdditionalRates = {\r\n  'Fish Tank Cleaning': [\r\n    { title: 'Extended Stay (7+ days)', amount: 15 },\r\n    { title: 'Pickup/Dropoff Service', amount: 25 },\r\n    { title: 'Special Diet Handling', amount: 10 },\r\n    { title: 'Medication Administration', amount: 15 },\r\n  ],\r\n  'Ferrier': [\r\n    { title: 'Extended Hours', amount: 20 },\r\n    { title: 'Training Session', amount: 30 },\r\n    { title: 'Grooming', amount: 25 },\r\n  ],\r\n  'Dog Walking': [\r\n    { title: 'Extra 15 Minutes', amount: 10 },\r\n    { title: 'Plant Watering', amount: 5 },\r\n    { title: 'Photo Updates', amount: 5 },\r\n  ],\r\n  'Reptile Boarding & Habitat Maintenance': [\r\n    { title: 'Plant Watering', amount: 10 },\r\n    { title: 'Mail Collection', amount: 5 },\r\n    { title: 'Extended Visit (4+ hrs)', amount: 30 },\r\n  ],\r\n  'Bird Feeding': [\r\n    { title: 'Extra 15 Minutes', amount: 10 },\r\n    { title: 'Multiple Route Options', amount: 5 },\r\n    { title: 'Training During Walk', amount: 20 },\r\n  ],\r\n};\r\n\r\nexport const mockServicesForCards = [\r\n  {\r\n    id: 1,\r\n    name: 'Fish Tank Cleaning',\r\n    startingPrice: 25,\r\n    animalTypes: ['Fish'],\r\n    icon: 'fish',\r\n    additionalRates: mockAdditionalRates['Fish Tank Cleaning']\r\n  },\r\n  {\r\n    id: 2,\r\n    name: 'Ferrier',\r\n    startingPrice: 30,\r\n    animalTypes: ['Dogs'],\r\n    icon: 'horse',\r\n    additionalRates: mockAdditionalRates['Ferrier']\r\n  },\r\n  {\r\n    id: 3,\r\n    name: 'Dog Walking',\r\n    startingPrice: 40,\r\n    animalTypes: ['Dogs'],\r\n    icon: 'dog',\r\n    additionalRates: mockAdditionalRates['Dog Walking']\r\n  },\r\n  {\r\n    id: 4,\r\n    name: 'Reptile Boarding & Habitat Maintenance',\r\n    startingPrice: 35,\r\n    animalTypes: ['Reptiles'],\r\n    icon: 'snake',\r\n    additionalRates: mockAdditionalRates['Reptile Boarding & Habitat Maintenance']\r\n  },\r\n  {\r\n    id: 5,\r\n    name: 'Bird Feeding',\r\n    startingPrice: 45,\r\n    animalTypes: ['Birds'],\r\n    icon: 'bird',\r\n    additionalRates: mockAdditionalRates['Bird Feeding']\r\n  }\r\n];\r\n\r\nexport const GENERAL_CATEGORIES = [\r\n  'Farm Animals', \r\n  'Domestic',\r\n  'Exotic',\r\n  'Aquatic',\r\n  'Invertibrates',\r\n];\r\n\r\nexport const mockPets = [\r\n  {\r\n    id: '1',\r\n    name: 'Max',\r\n    animal_type: 'Dog',\r\n    breed: 'border collie',\r\n    age: {\r\n      months: 0,\r\n      years: 5,\r\n    },\r\n    weight: 32,\r\n    sex: 'Male',\r\n    friendlyWithChildren: true,\r\n    friendlyWithCats: false,\r\n    friendlyWithDogs: true,\r\n    spayedNeutered: true,\r\n    houseTrained: true,\r\n    microchipped: true,\r\n    adoptionDate: '2020-01-15',\r\n    description: 'Loves to play fetch and go for walks.',\r\n    energyLevel: 'High',\r\n    feedingSchedule: 'Morning',\r\n    leftAlone: '1-4 hours',\r\n    medication: null,\r\n    additionalInstructions: 'Needs daily exercise.',\r\n    vetName: 'Dr. Smith',\r\n    vetAddress: '123 Vet St.',\r\n    vetPhone: '555-1234',\r\n    insuranceProvider: 'Pet Insurance Co.',\r\n    vetDocuments: [],\r\n    galleryImages: [],\r\n  },\r\n  {\r\n    id: '2',\r\n    name: 'Whiskers',\r\n    animal_type: 'Cat',\r\n    breed: 'tammy ammy',\r\n    age: {\r\n      months: 3,\r\n      years: 4,\r\n    },\r\n    weight: 16,\r\n    sex: 'Female',\r\n    friendlyWithChildren: true,\r\n    friendlyWithCats: true,\r\n    friendlyWithDogs: false,\r\n    spayedNeutered: true,\r\n    houseTrained: true,\r\n    microchipped: false,\r\n    adoptionDate: '2019-05-20',\r\n    description: 'Enjoys lounging in the sun.',\r\n    energyLevel: 'Low',\r\n    feedingSchedule: 'Twice a day',\r\n    leftAlone: '4-8 hours',\r\n    medication: null,\r\n    additionalInstructions: 'Prefers quiet environments.',\r\n    vetName: 'Dr. Jones',\r\n    vetAddress: '456 Vet Ave.',\r\n    vetPhone: '555-5678',\r\n    insuranceProvider: 'Pet Health Insurance',\r\n    vetDocuments: [],\r\n    galleryImages: [],\r\n  },\r\n  {\r\n    id: '3',\r\n    name: 'Buddy',\r\n    animal_type: 'snake',\r\n    breed: 'leopard gecko',\r\n    age: {\r\n      months: 0,\r\n      years: 2,\r\n    },\r\n    weight: 1,\r\n    sex: 'Male',\r\n    friendlyWithChildren: false,\r\n    friendlyWithCats: false,\r\n    friendlyWithDogs: false,\r\n    spayedNeutered: false,\r\n    houseTrained: false,\r\n    microchipped: false,\r\n    adoptionDate: '2021-08-10',\r\n    description: 'A calm and quiet pet.',\r\n    energyLevel: 'Low',\r\n    feedingSchedule: ['Custom', '3 times a day with liquid food.'],\r\n    leftAlone: 'Can be left alone indefinitely',\r\n    medication: null,\r\n    additionalInstructions: 'Keep in a warm environment.',\r\n    vetName: 'Dr. Green',\r\n    vetAddress: '789 Vet Blvd.',\r\n    vetPhone: '555-9012',\r\n    insuranceProvider: 'Reptile Insurance Co.',\r\n    vetDocuments: [],\r\n    galleryImages: [],\r\n  },\r\n];\r\n\r\nexport const mockProfessionals = [\r\n  {\r\n    id: 1,\r\n    name: \"Mike V.\",\r\n    profilePicture: require('../../assets/user1.png'),\r\n    location: \"Briargate, Colorado Springs, CO, 80920\",\r\n    rating: 5.0,\r\n    reviewCount: 72,\r\n    price: 35,\r\n    distance: \"5.7 mi. away\",\r\n    coordinates: {\r\n      latitude: 38.8339,\r\n      longitude: -104.8214,\r\n    },\r\n    services: [\"Dog Walking\", \"Pet Sitting\", \"Grooming\"],\r\n    experience: \"5 years\",\r\n    description: \"Professional pet sitter with extensive experience in dog walking and pet sitting. Certified in pet first aid and CPR.\",\r\n    repeat_owners: 18,\r\n    verified: true,\r\n    bestReview: \"Benny's stay with Mike was outstanding! I would not hesitate to have Benny stay with them again. I would highly recommend Mike to anyone needing pet care services.\"\r\n  },\r\n  {\r\n    id: 2,\r\n    name: \"Sarah Johnson\",\r\n    profilePicture: require('../../assets/user2.png'),\r\n    location: \"Colorado Springs, CO\",\r\n    rating: 4.8,\r\n    reviewCount: 127,\r\n    price: 45,\r\n    coordinates: {\r\n      latitude: 38.8340,\r\n      longitude: -104.8215,\r\n    },\r\n    services: [\"Dog Walking\", \"Pet Sitting\", \"Training\"],\r\n    experience: \"8 years\",\r\n    description: \"Experienced dog trainer and pet sitter. Specializes in working with large breeds and puppies.\",\r\n    verified: true,\r\n    bestReview: \"Sarah is amazing with pets! She took great care of my dog and sent regular updates.\"\r\n  },\r\n  {\r\n    id: 3,\r\n    name: \"Emily Rodriguez\",\r\n    profilePicture: require('../../assets/user3.png'),\r\n    location: \"Colorado Springs, CO\",\r\n    rating: 4.7,\r\n    reviewCount: 156,\r\n    price: 40,\r\n    coordinates: {\r\n      latitude: 38.8341,\r\n      longitude: -104.8216,\r\n    },\r\n    services: [\"Dog Walking\", \"Pet Sitting\", \"Grooming\", \"Training\"],\r\n    experience: \"6 years\",\r\n    description: \"Professional pet sitter and groomer. Available for both short-term and long-term pet care needs.\",\r\n    verified: true\r\n  },\r\n  {\r\n    id: 4,\r\n    name: \"David Kim\",\r\n    profilePicture: require('../../assets/user4.png'),\r\n    location: \"Colorado Springs, CO\",\r\n    rating: 4.9,\r\n    reviewCount: 98,\r\n    price: 55,\r\n    coordinates: {\r\n      latitude: 38.8342,\r\n      longitude: -104.8217,\r\n    },\r\n    services: [\"Dog Walking\", \"Pet Sitting\", \"Training\", \"Grooming\"],\r\n    experience: \"10 years\",\r\n    description: \"Certified dog trainer and experienced pet sitter. Specializes in working with rescue dogs and behavioral training.\",\r\n    verified: true\r\n  },\r\n  {\r\n    id: 5,\r\n    name: \"Lisa Thompson\",\r\n    profilePicture: require('../../assets/user5.png'),\r\n    location: \"Colorado Springs, CO\",\r\n    rating: 4.8,\r\n    reviewCount: 143,\r\n    price: 45,\r\n    coordinates: {\r\n      latitude: 38.8343,\r\n      longitude: -104.8218,\r\n    },\r\n    services: [\"Dog Walking\", \"Pet Sitting\", \"Grooming\"],\r\n    experience: \"7 years\",\r\n    description: \"Professional pet sitter with a passion for animal care. Available for both regular and occasional pet sitting needs.\",\r\n    verified: true\r\n  },\r\n  {\r\n    id: 6,\r\n    name: \"John Martinez\",\r\n    profilePicture: require('../../assets/user6.png'),\r\n    location: \"Colorado Springs, CO\",\r\n    rating: 4.6,\r\n    reviewCount: 89,\r\n    price: 42,\r\n    coordinates: {\r\n      latitude: 38.8344,\r\n      longitude: -104.8219,\r\n    },\r\n    services: [\"Dog Walking\", \"Pet Sitting\"],\r\n    experience: \"4 years\",\r\n    description: \"Dedicated pet care professional specializing in dog walking and pet sitting services.\",\r\n    verified: true\r\n  },\r\n  {\r\n    id: 7,\r\n    name: \"Rachel White\",\r\n    profilePicture: require('../../assets/user7.png'),\r\n    location: \"Colorado Springs, CO\",\r\n    rating: 4.9,\r\n    reviewCount: 167,\r\n    price: 48,\r\n    coordinates: {\r\n      latitude: 38.8345,\r\n      longitude: -104.8220,\r\n    },\r\n    services: [\"Dog Walking\", \"Pet Sitting\", \"Training\"],\r\n    experience: \"9 years\",\r\n    description: \"Experienced pet trainer and caregiver with a focus on positive reinforcement techniques.\",\r\n    verified: true\r\n  },\r\n  {\r\n    id: 8,\r\n    name: \"Michael Chen\",\r\n    profilePicture: require('../../assets/user8.png'),\r\n    location: \"Colorado Springs, CO\",\r\n    rating: 4.7,\r\n    reviewCount: 112,\r\n    price: 38,\r\n    coordinates: {\r\n      latitude: 38.8346,\r\n      longitude: -104.8221,\r\n    },\r\n    services: [\"Dog Walking\", \"Pet Sitting\", \"Grooming\"],\r\n    experience: \"5 years\",\r\n    description: \"Professional pet groomer and sitter with expertise in handling various breeds.\",\r\n    verified: true\r\n  },\r\n  {\r\n    id: 9,\r\n    name: \"Amanda Foster\",\r\n    profilePicture: require('../../assets/user9.png'),\r\n    location: \"Colorado Springs, CO\",\r\n    rating: 4.8,\r\n    reviewCount: 134,\r\n    price: 44,\r\n    coordinates: {\r\n      latitude: 38.8347,\r\n      longitude: -104.8222,\r\n    },\r\n    services: [\"Dog Walking\", \"Pet Sitting\", \"Training\"],\r\n    experience: \"7 years\",\r\n    description: \"Certified pet trainer with extensive experience in behavioral modification.\",\r\n    verified: true\r\n  },\r\n  {\r\n    id: 10,\r\n    name: \"Robert Taylor\",\r\n    profilePicture: require('../../assets/user10.png'),\r\n    location: \"Colorado Springs, CO\",\r\n    rating: 4.9,\r\n    reviewCount: 178,\r\n    price: 50,\r\n    coordinates: {\r\n      latitude: 38.8348,\r\n      longitude: -104.8223,\r\n    },\r\n    services: [\"Dog Walking\", \"Pet Sitting\", \"Training\", \"Grooming\"],\r\n    experience: \"11 years\",\r\n    description: \"Comprehensive pet care professional offering a full range of services.\",\r\n    verified: true\r\n  }\r\n];\r\n\r\nexport const mockOwners = [\r\n  {\r\n    id: '1',\r\n    name: 'Alice Johnson',\r\n    pet_types: ['Dog', 'Cat'],\r\n    last_booking: '2024-01-15',\r\n    pets: ['1', '2'], // References to pet IDs\r\n    email: 'alice@example.com',\r\n    phone: '555-0101',\r\n    address: '123 Pine St, Colorado Springs, CO',\r\n  },\r\n  {\r\n    id: '2',\r\n    name: 'Bob Wilson',\r\n    pet_types: ['Dog'],\r\n    last_booking: '2024-02-01',\r\n    pets: ['3'],\r\n    email: 'bob@example.com',\r\n    phone: '555-0102',\r\n    address: '456 Oak Ave, Colorado Springs, CO',\r\n  },\r\n  {\r\n    id: '3',\r\n    name: 'Carol Martinez',\r\n    pet_types: ['Cat', 'Exotic'],\r\n    last_booking: '2024-01-28',\r\n    pets: ['4', '5'],\r\n    email: 'carol@example.com',\r\n    phone: '555-0103',\r\n    address: '789 Maple Dr, Colorado Springs, CO',\r\n  },\r\n  {\r\n    id: '4',\r\n    name: 'David Brown',\r\n    pet_types: ['Dog'],\r\n    last_booking: '2024-02-05',\r\n    pets: ['6'],\r\n    email: 'david@example.com',\r\n    phone: '555-0104',\r\n    address: '321 Elm St, Colorado Springs, CO',\r\n  },\r\n  {\r\n    id: '5',\r\n    name: 'Eva Garcia',\r\n    pet_types: ['Exotic'],\r\n    last_booking: '2024-01-20',\r\n    pets: ['7'],\r\n    email: 'eva@example.com',\r\n    phone: '555-0105',\r\n    address: '654 Birch Ln, Colorado Springs, CO',\r\n  }\r\n];\r\n\r\n// Availability Tab\r\nexport const fetchAvailabilityData = () => {\r\n  return new Promise((resolve) => {\r\n    // to get the bookings, we need to fetch the booking table on backend\r\n    // to get available/unavailable dates we need to fetch the availability table on backend\r\n    setTimeout(() => {\r\n      resolve({\r\n        availableDates: {\r\n          '2025-02-01': { startTime: '09:00', endTime: '17:00' },\r\n          '2025-02-02': { startTime: '10:00', endTime: '18:00' },\r\n          '2025-02-03': { startTime: '09:00', endTime: '17:00' },\r\n        },\r\n        unavailableDates: {\r\n          '2025-02-04': { startTime: '00:00', endTime: '24:00' },\r\n          '2025-02-05': { startTime: '10:00', endTime: '18:00' },\r\n        },\r\n        bookings: {\r\n          '2025-02-06': [\r\n            { id: 'bk1', startTime: '14:00', endTime: '16:00', owner_name: 'Charlie', service_type: 'Dog Walking' },\r\n            { id: 'bk2', startTime: '16:00', endTime: '18:00', owner_name: 'Bob', service_type: 'Dog Walking' },\r\n            { id: 'bk3', startTime: '18:00', endTime: '20:00', owner_name: 'Nick', service_type: 'Pet Boarding' },\r\n            { id: 'bk4', startTime: '20:00', endTime: '22:00', owner_name: 'Alfred', service_type: 'Drop-In Visits (30 min)' }\r\n          ],\r\n          '2025-02-07': [\r\n            { id: 'bk5', startTime: '10:00', endTime: '12:00', owner_name: 'Uhtred', service_type: 'Dog Walking' }\r\n          ],\r\n        },\r\n      });\r\n    }, 1000);\r\n  });\r\n};\r\n\r\n// Add mock update functions\r\nexport const updateAvailability = (updates) => {\r\n  console.log(\"updateAvailability\", updates);\r\n  return new Promise((resolve) => {\r\n    setTimeout(() => {\r\n      resolve({ success: true, data: updates });\r\n    }, 500);\r\n  });\r\n};\r\n\r\nexport const updateBooking = (bookingData) => {\r\n  console.log(\"updateBooking\", bookingData);\r\n  return new Promise((resolve) => {\r\n    setTimeout(() => {\r\n      resolve({ success: true, data: bookingData });\r\n    }, 500);\r\n  });\r\n};\r\n\r\nconst sharedBookingDetails = {\r\n  booking_id: 'bk1',\r\n  status: 'Confirmed',\r\n  owner_name: 'matt aertker',\r\n  professional_name: 'matt2 aertker2',\r\n  service_details: {\r\n    service_type: 'Ferrier'\r\n  },\r\n  pets: [\r\n    {\r\n      pet_id: 3,\r\n      name: 'Jack',\r\n      species: 'DOG',\r\n      breed: 'Golden'\r\n    }\r\n  ],\r\n  occurrences: [\r\n    {\r\n      occurrence_id: 10,\r\n      start_date: '2025-02-01',\r\n      end_date: '2025-02-02',\r\n      start_time: '15:06',\r\n      end_time: '16:06',\r\n      calculated_cost: '61.04',\r\n      base_total: '$26.04',\r\n      rates: {\r\n        base_rate: '25.00',\r\n        additional_animal_rate: '5.00',\r\n        additional_animal_rate_applies: false,\r\n        applies_after: 2,\r\n        unit_of_time: 'PER_DAY',\r\n        holiday_rate: '35.00',\r\n        holiday_days: 0,\r\n        additional_rates: [\r\n          {\r\n            title: 'Extra Travel Time Rate',\r\n            description: 'Far Drive rate for service',\r\n            amount: '$25.00'\r\n          },\r\n          {\r\n            title: 'Dog Poops Inside Rate',\r\n            description: 'Dog Poops Inside rate for service',\r\n            amount: '$5.00'\r\n          },\r\n          {\r\n            title: 'Dog Separation rate',\r\n            description: 'When we need to separate the dog from other animals in the house',\r\n            amount: '$5.00'\r\n          }\r\n        ]\r\n      }\r\n    },\r\n    {\r\n      occurrence_id: 9,\r\n      start_date: '2025-03-13',\r\n      end_date: '2025-03-14',\r\n      start_time: '09:00',\r\n      end_time: '14:00',\r\n      calculated_cost: '120.08',\r\n      base_total: '$35.04',\r\n      rates: {\r\n        base_rate: '29.00',\r\n        additional_animal_rate: '8.00',\r\n        additional_animal_rate_applies: false,\r\n        applies_after: 1,\r\n        unit_of_time: 'PER_DAY',\r\n        holiday_rate: '40.00',\r\n        holiday_days: 0,\r\n        additional_rates: [\r\n          {\r\n            title: 'Extra Travel Time Rate',\r\n            description: 'Far Drive rate for service',\r\n            amount: '$25.00'\r\n          },\r\n          {\r\n            title: 'Dog Poops Inside Rate',\r\n            description: 'Dog Poops Inside rate for service',\r\n            amount: '$25.00'\r\n          },\r\n          {\r\n            title: 'Dog Separation rate',\r\n            description: 'When we need to separate the dog from other animals in the house',\r\n            amount: '$35.04'\r\n          }\r\n        ]\r\n      }\r\n    }\r\n  ],\r\n  cost_summary: {\r\n    subtotal: 181.12,\r\n    platform_fee: 18.11,\r\n    taxes: 15.94,\r\n    total_owner_cost: 215.17,\r\n    total_sitter_payout: 163.01,\r\n    is_prorated: true\r\n  }\r\n};\r\n\r\n// Initialize mockBookingDetails with existing mock data\r\nconst mockBookingDetails = {\r\n  '1234': {\r\n    ...sharedBookingDetails,\r\n    id: '1234',\r\n    ownerName: 'John Doe',\r\n    status: BOOKING_STATES.CONFIRMED,\r\n    startDate: '2024-02-20',\r\n    startTime: '14:00',\r\n  },\r\n  '5678': {\r\n    ...sharedBookingDetails,\r\n    id: '5678',\r\n    ownerName: 'Margarett Laporte',\r\n    status: BOOKING_STATES.CANCELLED,\r\n    startDate: '2024-02-21',\r\n    startTime: '15:30',\r\n  },\r\n  '56782': {\r\n    ...sharedBookingDetails,\r\n    id: '56782',\r\n    ownerName: 'Zoe Aerial',\r\n    status: BOOKING_STATES.DENIED,\r\n    startDate: '2024-02-21',\r\n    startTime: '15:30',\r\n  },\r\n  '5673': {\r\n    ...sharedBookingDetails,\r\n    id: '5673',\r\n    ownerName: 'Matt Clark',\r\n    status: BOOKING_STATES.PENDING_INITIAL_PROFESSIONAL_CHANGES,\r\n    startDate: '2024-02-21',\r\n    startTime: '15:30',\r\n  },\r\n  '5674': {\r\n    ...sharedBookingDetails,\r\n    id: '5674',\r\n    ownerName: 'Mark Smith',\r\n    status: BOOKING_STATES.PENDING_CLIENT_APPROVAL,\r\n    startDate: '2024-02-21',\r\n    startTime: '15:30',\r\n  },\r\n  '5675': {\r\n    ...sharedBookingDetails,\r\n    id: '5675',\r\n    ownerName: 'Lauren Smith',\r\n    status: BOOKING_STATES.PENDING_PROFESSIONAL_CHANGES,\r\n    startDate: '2024-02-21',\r\n    startTime: '15:30',\r\n  },\r\n  '5675': {\r\n    ...sharedBookingDetails,\r\n    id: '56712',\r\n    ownerName: 'Matt Smith',\r\n    status: BOOKING_STATES.CONFIRMED_PENDING_PROFESSIONAL_CHANGES,\r\n    startDate: '2024-02-21',\r\n    startTime: '15:30',\r\n  },\r\n  '56713': {\r\n    ...sharedBookingDetails,\r\n    id: '567123',\r\n    ownerName: 'Albert Einstein',\r\n    status: BOOKING_STATES.PENDING_INITIAL_PROFESSIONAL_CHANGES,\r\n    startDate: '2025-02-21',\r\n    startTime: '15:30',\r\n  },\r\n  '3749': {...sharedBookingDetails,\r\n    id: '567132',\r\n    ownerName: 'Dr. Mike Johnson',\r\n    status: BOOKING_STATES.PENDING_INITIAL_PROFESSIONAL_CHANGES,\r\n    startDate: '2025-02-21',\r\n    startTime: '15:30',\r\n  },\r\n  '91011': {\r\n    ...sharedBookingDetails,\r\n    id: '91011',\r\n    ownerName: 'Dr. Bla Johnson',\r\n    status: BOOKING_STATES.PENDING_INITIAL_PROFESSIONAL_CHANGES,\r\n    startDate: '2025-02-21',\r\n    startTime: '15:30',\r\n  },\r\n  '91012': {\r\n    ...sharedBookingDetails,\r\n    id: '91012',\r\n    ownerName: 'Dr. Blabla Johnson',\r\n    status: BOOKING_STATES.PENDING_INITIAL_PROFESSIONAL_CHANGES,\r\n    startDate: '2025-02-21',\r\n    startTime: '15:30',\r\n  }\r\n};\r\n\r\n// Map mockProfessionalBookings from mockBookingDetails\r\nexport const mockProfessionalBookings = Object.values(mockBookingDetails)\r\n  .map(booking => ({\r\n    id: booking.id,\r\n    ownerName: booking.ownerName,\r\n    status: booking.status,\r\n    date: booking.startDate,\r\n    time: booking.startTime,\r\n    serviceType: booking.serviceType,\r\n    numberOfPets: booking.numberOfPets || 1,\r\n    totalCost: booking.costs?.totalOwnerCost || 0,\r\n    professionalPayout: booking.costs?.professionalPayout || 0\r\n  }));\r\n\r\n// Add the createBooking function\r\nexport const createBooking = async (ownerId, freelancerId, initialData = {}) => {\r\n  const newBookingId = `booking_${Date.now()}`;\r\n  \r\n  const newBooking = {\r\n    id: newBookingId,\r\n    ownerId: ownerId,\r\n    freelancerId: freelancerId,\r\n    status: BOOKING_STATES.PENDING_INITIAL_PROFESSIONAL_CHANGES,\r\n    ownerName: initialData.ownerName || 'TBD',\r\n    professionalName: initialData.professionalName || 'TBD',\r\n    serviceType: initialData.serviceType || 'TBD',\r\n    animalType: initialData.animalType || 'TBD',\r\n    numberOfPets: initialData.numberOfPets || 0,\r\n    duration: initialData.duration || 0,\r\n    occurrences: initialData.occurrences || [],\r\n    rates: {\r\n      baseRate: 0,\r\n      additionalPetRate: 0,\r\n      extraServices: []\r\n    },\r\n    costs: {\r\n      baseTotal: 0,\r\n      additionalPetTotal: 0,\r\n      extraServicesTotal: 0,\r\n      subtotal: 0,\r\n      ownerFee: 0,\r\n      taxes: 0,\r\n      totalOwnerCost: 0,\r\n      professionalPayout: 0\r\n    },\r\n    created_at: new Date().toISOString(),\r\n    updated_at: new Date().toISOString(),\r\n    ...initialData\r\n  };\r\n\r\n  // Add to mock database\r\n  mockBookingDetails[newBookingId] = newBooking;\r\n  \r\n  console.log('Created new booking:', {\r\n    bookingId: newBookingId,\r\n    booking: newBooking,\r\n    allBookings: Object.keys(mockBookingDetails)\r\n  });\r\n\r\n  // Simulate API delay\r\n  await new Promise(resolve => setTimeout(resolve, 500));\r\n  return newBookingId;\r\n};\r\n\r\n// Export mockBookingDetails for debugging\r\nexport const _mockBookingDetails = mockBookingDetails;\r\n\r\n// Add new mock function for updating booking status\r\nexport const updateBookingStatus = async (bookingId, newStatus, reason = '', metadata = {}) => {\r\n  console.log('updateBookingStatus called with:', {\r\n    bookingId,\r\n    newStatus,\r\n    reason,\r\n    metadata,\r\n    availableBookings: Object.keys(mockBookingDetails)\r\n  });\r\n  \r\n  // Simulate API delay\r\n  await new Promise(resolve => setTimeout(resolve, 1000));\r\n  \r\n  // Find the booking by ID regardless of the key\r\n  const bookingKey = Object.keys(mockBookingDetails).find(key => \r\n    mockBookingDetails[key].id === bookingId\r\n  );\r\n  \r\n  if (!bookingKey) {\r\n    console.error('Booking not found in mockBookingDetails. Available bookings:', \r\n      Object.keys(mockBookingDetails),\r\n      '\\nFull mockBookingDetails:', mockBookingDetails\r\n    );\r\n    throw new Error('Booking not found');\r\n  }\r\n  \r\n  // Create updated booking object\r\n  mockBookingDetails[bookingKey] = {\r\n    ...mockBookingDetails[bookingKey],\r\n    status: newStatus,\r\n    statusReason: reason,\r\n    updated_at: new Date().toISOString(),\r\n    ...metadata\r\n  };\r\n\r\n  console.log('Updated booking:', mockBookingDetails[bookingKey]);\r\n  return mockBookingDetails[bookingKey];\r\n};\r\n\r\n// Make sure to update MyBookings.js to use the same BOOKING_STATES constant\r\nexport const mockOwnerBookings = [\r\n  {\r\n    id: '91011',\r\n    professionalName: 'Sarah Wilson',\r\n    status: BOOKING_STATES.CONFIRMED,\r\n    date: '2024-02-22',\r\n    time: '10:00',\r\n    serviceType: 'Dog Walking',\r\n    numberOfPets: 2,\r\n    totalCost: 75.00,\r\n  },\r\n  {\r\n    id: '91012',\r\n    professionalName: 'Mike Johnson',\r\n    status: BOOKING_STATES.PENDING_CLIENT_APPROVAL,\r\n    date: '2024-02-23',\r\n    time: '11:00',\r\n    serviceType: 'Pet Sitting',\r\n    numberOfPets: 1,\r\n    totalCost: 50.00,\r\n  },\r\n];\r\n\r\n// Assuming current user ID is 101 for testing\r\nexport const CURRENT_USER_ID = 101;\r\n\r\nexport const mockConversations = [\r\n  {\r\n    id: 'conv_1',\r\n    participant1_id: CURRENT_USER_ID,\r\n    participant2_id: 202,\r\n    name: \"Dr. Sarah Smith\",\r\n    role_map: {\r\n      participant1_role: \"owner\",\r\n      participant2_role: \"professional\"\r\n    },\r\n    lastMessage: \"I'd be happy to help! What kind of pet do you have?\",\r\n    timestamp: \"2024-02-21T07:05:00Z\",\r\n    unread: false\r\n  },\r\n  {\r\n    id: 'conv_2',\r\n    participant1_id: 303,\r\n    participant2_id: CURRENT_USER_ID,\r\n    name: \"Dr. Mike Johnson\",\r\n    role_map: {\r\n      participant1_role: \"owner\",\r\n      participant2_role: \"professional\"\r\n    },\r\n    lastMessage: \"I'm available! Let's set up a booking\",\r\n    timestamp: \"2024-02-21T15:35:00Z\",\r\n    unread: false\r\n  },\r\n  {\r\n    id: 'conv_3',\r\n    participant1_id: CURRENT_USER_ID,\r\n    participant2_id: 204,\r\n    name: \"Dr. Emily Wilson\",\r\n    role_map: {\r\n      participant1_role: \"owner\",\r\n      participant2_role: \"professional\"\r\n    },\r\n    lastMessage: \"Your cat's checkup is scheduled\",\r\n    timestamp: \"2024-02-20T10:15:00Z\",\r\n    unread: true\r\n  },\r\n  {\r\n    id: 'conv_4',\r\n    participant1_id: CURRENT_USER_ID,\r\n    participant2_id: 205,\r\n    name: \"Dr. James Anderson\",\r\n    role_map: {\r\n      participant1_role: \"owner\",\r\n      participant2_role: \"professional\"\r\n    },\r\n    lastMessage: \"See you tomorrow at 2 PM\",\r\n    timestamp: \"2024-02-19T16:45:00Z\",\r\n    unread: false\r\n  },\r\n  {\r\n    id: 'conv_5',\r\n    participant1_id: CURRENT_USER_ID,\r\n    participant2_id: 206,\r\n    name: \"Dr. Lisa Brown\",\r\n    role_map: {\r\n      participant1_role: \"owner\",\r\n      participant2_role: \"professional\"\r\n    },\r\n    lastMessage: \"How is Max doing today?\",\r\n    timestamp: \"2024-02-18T09:30:00Z\",\r\n    unread: false\r\n  },\r\n  {\r\n    id: 'conv_6',\r\n    participant1_id: CURRENT_USER_ID,\r\n    participant2_id: 207,\r\n    name: \"Dr. Robert Taylor\",\r\n    role_map: {\r\n      participant1_role: \"owner\",\r\n      participant2_role: \"professional\"\r\n    },\r\n    lastMessage: \"The medication has been prescribed\",\r\n    timestamp: \"2024-02-17T14:20:00Z\",\r\n    unread: false\r\n  },\r\n  {\r\n    id: 'conv_7',\r\n    participant1_id: CURRENT_USER_ID,\r\n    participant2_id: 208,\r\n    name: \"Dr. Maria Garcia\",\r\n    role_map: {\r\n      participant1_role: \"owner\",\r\n      participant2_role: \"professional\"\r\n    },\r\n    lastMessage: \"Your appointment is confirmed\",\r\n    timestamp: \"2024-02-16T11:25:00Z\",\r\n    unread: true\r\n  },\r\n  {\r\n    id: 'conv_8',\r\n    participant1_id: CURRENT_USER_ID,\r\n    participant2_id: 209,\r\n    name: \"Dr. David Lee\",\r\n    role_map: {\r\n      participant1_role: \"owner\",\r\n      participant2_role: \"professional\"\r\n    },\r\n    lastMessage: \"Let's schedule a follow-up\",\r\n    timestamp: \"2024-02-15T13:40:00Z\",\r\n    unread: false\r\n  },\r\n  {\r\n    id: 'conv_9',\r\n    participant1_id: CURRENT_USER_ID,\r\n    participant2_id: 210,\r\n    name: \"Dr. Sarah Martinez\",\r\n    role_map: {\r\n      participant1_role: \"owner\",\r\n      participant2_role: \"professional\"\r\n    },\r\n    lastMessage: \"The test results are ready\",\r\n    timestamp: \"2024-02-14T15:55:00Z\",\r\n    unread: false\r\n  },\r\n  {\r\n    id: 'conv_10',\r\n    participant1_id: CURRENT_USER_ID,\r\n    participant2_id: 211,\r\n    name: \"Dr. John White\",\r\n    role_map: {\r\n      participant1_role: \"owner\",\r\n      participant2_role: \"professional\"\r\n    },\r\n    lastMessage: \"How's the new diet working?\",\r\n    timestamp: \"2024-02-13T08:15:00Z\",\r\n    unread: false\r\n  },\r\n  {\r\n    id: 'conv_11',\r\n    participant1_id: CURRENT_USER_ID,\r\n    participant2_id: 212,\r\n    name: \"Dr. Anna Clark\",\r\n    role_map: {\r\n      participant1_role: \"owner\",\r\n      participant2_role: \"professional\"\r\n    },\r\n    lastMessage: \"Vaccination reminder\",\r\n    timestamp: \"2024-02-12T10:30:00Z\",\r\n    unread: true\r\n  },\r\n  {\r\n    id: 'conv_12',\r\n    participant1_id: CURRENT_USER_ID,\r\n    participant2_id: 213,\r\n    name: \"Dr. Thomas Wright\",\r\n    role_map: {\r\n      participant1_role: \"owner\",\r\n      participant2_role: \"professional\"\r\n    },\r\n    lastMessage: \"Surgery scheduled for next week\",\r\n    timestamp: \"2024-02-11T12:45:00Z\",\r\n    unread: false\r\n  },\r\n  {\r\n    id: 'conv_13',\r\n    participant1_id: CURRENT_USER_ID,\r\n    participant2_id: 214,\r\n    name: \"Dr. Patricia Moore\",\r\n    role_map: {\r\n      participant1_role: \"owner\",\r\n      participant2_role: \"professional\"\r\n    },\r\n    lastMessage: \"Emergency consultation available\",\r\n    timestamp: \"2024-02-10T17:20:00Z\",\r\n    unread: false\r\n  },\r\n  {\r\n    id: 'conv_14',\r\n    participant1_id: CURRENT_USER_ID,\r\n    participant2_id: 215,\r\n    name: \"Dr. Kevin Hall\",\r\n    role_map: {\r\n      participant1_role: \"owner\",\r\n      participant2_role: \"professional\"\r\n    },\r\n    lastMessage: \"Treatment plan updated\",\r\n    timestamp: \"2024-02-09T14:10:00Z\",\r\n    unread: false\r\n  },\r\n  {\r\n    id: 'conv_15',\r\n    participant1_id: CURRENT_USER_ID,\r\n    participant2_id: 216,\r\n    name: \"Dr. Rachel Green\",\r\n    role_map: {\r\n      participant1_role: \"owner\",\r\n      participant2_role: \"professional\"\r\n    },\r\n    lastMessage: \"Prescription ready for pickup\",\r\n    timestamp: \"2024-02-08T16:35:00Z\",\r\n    unread: true\r\n  }\r\n];\r\n\r\nexport const mockMessages = {\r\n  'conv_1': [\r\n    {\r\n      message_id: 1,\r\n      participant1_id: CURRENT_USER_ID,\r\n      participant2_id: 202,\r\n      sender: CURRENT_USER_ID,\r\n      role_map: {\r\n        participant1_role: \"owner\",\r\n        participant2_role: \"professional\"\r\n      },\r\n      content: \"Hi, I'm interested in your pet sitting services\",\r\n      timestamp: \"2024-02-21T14:00:00Z\",\r\n      booking_id: null,\r\n      status: \"read\",\r\n      is_booking_request: false,\r\n      metadata: {}\r\n    },\r\n    {\r\n      message_id: 2,\r\n      participant1_id: CURRENT_USER_ID,\r\n      participant2_id: 202,\r\n      sender: 202,\r\n      role_map: {\r\n        participant1_role: \"owner\",\r\n        participant2_role: \"professional\"\r\n      },\r\n      content: \"I'd be happy to help! What kind of pet do you have?\",\r\n      timestamp: \"2024-02-21T14:05:00Z\",\r\n      booking_id: null,\r\n      status: \"sent\",\r\n      is_booking_request: false,\r\n      metadata: {}\r\n    }\r\n  ],\r\n  'conv_2': [\r\n    {\r\n      message_id: 3,\r\n      participant1_id: 303,\r\n      participant2_id: CURRENT_USER_ID,\r\n      sender: 303,\r\n      role_map: {\r\n        participant1_role: \"owner\",\r\n        participant2_role: \"professional\"\r\n      },\r\n      content: \"Looking for a dog walker next week\",\r\n      timestamp: \"2024-02-21T15:30:00Z\",\r\n      booking_id: null,\r\n      status: \"read\",\r\n      is_booking_request: false,\r\n      metadata: {}\r\n    },\r\n    {\r\n      message_id: 4,\r\n      participant1_id: 303,\r\n      participant2_id: CURRENT_USER_ID,\r\n      sender: 303,\r\n      role_map: {\r\n        participant1_role: \"owner\",\r\n        participant2_role: \"professional\"\r\n      },\r\n      type: 'booking_request',\r\n      data: {\r\n        serviceType: \"Dog Walking\",\r\n        pets: [\r\n          { id: '1', name: 'Max', type: 'Dog', breed: 'Golden Retriever' }\r\n        ],\r\n        occurrences: [\r\n          {\r\n            startDate: '2024-02-28',\r\n            endDate: '2024-02-28',\r\n            startTime: '14:00',\r\n            endTime: '15:00'\r\n          }\r\n        ]\r\n      },\r\n      timestamp: \"2024-02-21T15:35:00Z\",\r\n      status: \"sent\",\r\n      is_booking_request: true,\r\n      metadata: {}\r\n    },\r\n    {\r\n      message_id: 5,\r\n      participant1_id: 303,\r\n      participant2_id: CURRENT_USER_ID,\r\n      sender: CURRENT_USER_ID,\r\n      role_map: {\r\n        participant1_role: \"owner\",\r\n        participant2_role: \"professional\"\r\n      },\r\n      content: \"I'll take a look!\",\r\n      timestamp: \"2024-02-21T15:30:00Z\",\r\n      booking_id: null,\r\n      status: \"read\",\r\n      is_booking_request: false,\r\n      metadata: {}\r\n    },\r\n  ]\r\n};\r\n\r\n// Helper function to create a new conversation\r\nexport const createNewConversation = (professionalId, professionalName, ownerId, ownerName) => {\r\n  const conversationId = `conv_${Date.now()}`;\r\n  const isCurrentUserOwner = ownerId === CURRENT_USER_ID;\r\n  \r\n  return {\r\n    id: conversationId,\r\n    participant1_id: isCurrentUserOwner ? ownerId : professionalId,\r\n    participant2_id: isCurrentUserOwner ? professionalId : ownerId,\r\n    role_map: {\r\n      participant1_role: isCurrentUserOwner ? \"owner\" : \"professional\",\r\n      participant2_role: isCurrentUserOwner ? \"professional\" : \"owner\"\r\n    },\r\n    lastMessage: \"\",\r\n    timestamp: new Date().toISOString(),\r\n    unread: false,\r\n    bookingStatus: null\r\n  };\r\n};\r\n\r\nexport const DEFAULT_SERVICES = [\r\n  {\r\n    serviceName: 'Dog Walking',\r\n    animalTypes: 'Dogs',\r\n    rates: { base_rate: '20' },\r\n    additionalAnimalRate: '10',\r\n  },\r\n  {\r\n    serviceName: 'Cat Sitting',\r\n    animalTypes: 'Cats',\r\n    rates: { base_rate: '20' },\r\n    additionalAnimalRate: '5',\r\n  },\r\n  {\r\n    serviceName: 'Exotic Pet Care',\r\n    animalTypes: 'Lizards, Birds',\r\n    rates: { base_rate: '25' },\r\n    additionalAnimalRate: '15',\r\n  },\r\n];\r\n\r\nexport const SERVICE_TYPE_SUGGESTIONS = [\r\n  \"Overnight Cat Sitting (Owner's Home)\",\r\n  \"Cat Boarding\",\r\n  \"Drop-In Visits (30 min)\",\r\n  \"Drop-In Visits (60 min)\",\r\n  \"Dog Walking\",\r\n  \"Doggy Day Care\",\r\n  \"Pet Boarding\",\r\n  \"Exotic Pet Care\",\r\n  \"Daytime Pet Sitting\",\r\n  \"Ferrier\", \r\n];\r\n\r\nexport const ANIMAL_TYPE_SUGGESTIONS = [\r\n  'Dog',\r\n  'Cat',\r\n  'Cow',\r\n  'Calf',\r\n  'Lizard',\r\n  'Bird',\r\n  'Rabbit',\r\n  'Fish',\r\n];\r\n\r\nexport const BLOG_POSTS = [\r\n  {\r\n    id: 'blog_1',\r\n    title: 'What Your Dog is Really Saying',\r\n    author: {\r\n      id: 'author_1',\r\n      name: 'Zoe Neale',\r\n      profilePicture: require('../../assets/ZEGN_USER.jpeg'),\r\n      bio: 'Professional dog trainer and animal behavior specialist with over 10 years of experience.'\r\n    },\r\n    publishDate: '2024-02-22',\r\n    readTime: '8 min',\r\n    tags: ['Dogs', 'Behavior', 'Training', 'Pet Care'],\r\n    content: `You know that moment when your dog tilts their head at you like you just asked them to solve a calculus problem? Turns out, they're not the only ones trying to understand you—they've been communicating with you this whole time, and you probably didn't even realize it.\r\n\r\nDogs may not speak English (yet—give them time), but they have an entire language built on tail wags, ear positions, and those big, soulful eyes they use to manipulate you into giving them extra treats. Learning to read their body language isn't just a party trick—it can help prevent stress, deepen your bond, and maybe even stop your dog from embarrassing you at the dog park. So, let's finally crack the code on what your dog has been trying to tell you.\r\n\r\nTail Wagging: Not Always a Sign of Happiness\r\nOne of the biggest myths out there is that a wagging tail means a happy dog. Nope. Not always. A dog's tail is basically their mood ring, and the way they wag tells a whole different story.\r\nLoose, full-body wag (with bonus butt wiggles): This is the classic \"OMG YOU'RE HOME!!\" happy dance. A+ vibes.\r\nSlow wag, tail held high: The \"I'm analyzing this situation\" wag. Suspicious, calculating, possibly deciding if you're worth their energy.\r\nStiff, fast wag with a raised tail: Yikes. This is \"I'm on edge, don't mess with me\" energy. Proceed with caution.\r\nLow, fast wag: \"I'm nervous, and I don't know what's happening, so I'm just gonna keep wiggling and hope for the best.\"\r\nTucked tail: Fear. If the tail is all the way tucked under, your dog is basically saying, \"I regret everything, please don't yell at me.\"\r\nEven the direction of the wag matters—researchers found that dogs wag more to the right when they're happy and to the left when they're unsure or stressed (Quaranta et al., 2007). Yes, your dog's tail literally has anxiety tells.\r\n\r\nEars and Eyes: The Silent Storytellers\r\nDogs don't just talk with their tails—they also use their ears and eyes like tiny, furry actors in a silent film.\r\nSoft eyes, relaxed ears: Your dog is living their best life. No stress, just vibes.\r\nWide eyes, whites showing (a.k.a. \"whale eye\"): \"I am uncomfortable with the energy we have created in this room.\" This is a warning sign—your dog feels uneasy or trapped.\r\nPerked-up ears: \"I heard something, and I will investigate.\" Could be excitement, curiosity, or them preparing to bark at absolutely nothing.\r\nEars pinned back: \"I'm nervous\" or \"I did something bad, and I hope you don't notice.\" Classic guilty dog move.\r\nEver notice how some dogs do a little squint when they're happy? It's their version of a smile. On the flip side, prolonged direct eye contact—especially with an unfamiliar dog—can be a challenge. So, if you're having a staring contest with a dog you just met…maybe don't.\r\n\r\nThe Freeze: When Your Dog Hits Pause (And You Should Pay Attention)\r\nIf a dog suddenly stops moving and stiffens, pay attention. Freezing is often their last warning before things escalate to growling, snapping, or biting. A lot of people miss this and then wonder why their dog \"suddenly\" lashed out.\r\nYou might see this when:\r\nA child is hugging a dog (which, fun fact, most dogs hate).\r\nSomeone is petting a dog too aggressively.\r\nThe dog feels cornered and has no escape route.\r\nResearch by Rooney Clark and Casey (2016) helped show that when a dog freezes, in some way or another they are stressed, its best to give them space in that moment and take a mental note of your newest training goal! Sometimes, they just need a minute to de-escalate, like when you have to breathe through a customer service call that's not going well.\r\n\r\nMouth Matters: Smiles vs. Stress\r\nDogs can technically smile, but it's not always what you think.\r\nLoose, open mouth, tongue hanging out: Happy, relaxed, living their best life.\r\nClosed mouth, tight lips: Alert or unsure. They're analyzing the situation.\r\nLips pulled back, slight teeth showing: Some dogs do a \"submissive grin,\" which isn't aggression—it's their way of saying, \"Hey, I'm friendly!\"\r\nWrinkled nose, full teeth bared: This is aggression. Back off.\r\nExcessive yawning in a new situation: Dogs don't just yawn when they're tired—they also yawn when they're stressed. To put it simply, they are overstimulated. (Glenk, 2020) Don't be fooled by the parrot dog, sometimes they yawn because they saw you yawn first! (D'Aniello, 2019)\r\n\r\nConclusion: Your Dog Has Been Sending You Texts—Now You Can Finally Read Them\r\nDogs may not be able to talk (yet), but they've been communicating loud and clear this whole time. That tail wag? Could be excitement, could be stress. That little squint? Doggy love. The full-body freeze? That's a big ol' \"DO NOT DISTURB\" sign.\r\nThe more you pay attention, the better you'll understand your dog—and the fewer awkward misunderstandings you'll have (like mistaking a stress yawn for a nap cue). As we said in the beginning, your dog already knows exactly how to read you. They know your routine, when you're about to leave the house, and how to guilt-trip you into sharing your snacks. The least you can do is return the favor.\r\nSo next time your dog gives you the side-eye, perks their ears, or flops over dramatically after a single walk, you'll finally know what they're saying. And let's be honest—it's probably, \"I love you… now give me a treat.\"`,\r\n    references: [\r\n      {\r\n        title: '7 tips for canine body language',\r\n        authors: 'American Society for the Prevention of Cruelty to Animals (ASPCA)',\r\n        publication: 'ASPCApro',\r\n        url: 'https://www.aspcapro.org/resource/7-tips-canine-body-language'\r\n      },\r\n      {\r\n        title: \"Therapy dogs' salivary cortisol levels vary during animal-assisted interventions\",\r\n        authors: 'Glenk, L. M., Kothgassner, O. D., Stetina, B. U., Palme, R., & Kepplinger, B.',\r\n        publication: 'Frontiers in Veterinary Science',\r\n        year: 2020,\r\n        doi: '10.3389/fvets.2020.564201'\r\n      },\r\n      {\r\n        title: 'The importance of associative learning in cross-species social bonding: Dogs and humans',\r\n        authors: \"D'Aniello, B., Scandurra, A., Alterisio, A., Aria, M., & Siniscalchi, M.\",\r\n        publication: 'Frontiers in Psychology',\r\n        year: 2019,\r\n        doi: '10.3389/fpsyg.2019.01678'\r\n      },\r\n      {\r\n        title: 'Oxytocin-gaze positive loop and the coevolution of human-dog bonds',\r\n        authors: 'Nagasawa, M., Mitsui, S., En, S., Ohtani, N., Ohta, M., Sakuma, Y., Onaka, T., Mogi, K., & Kikusui, T.',\r\n        publication: 'Science',\r\n        year: 2015,\r\n        doi: '10.1126/science.1261022'\r\n      },\r\n      {\r\n        title: 'Asymmetric tail-wagging responses by dogs to different emotive stimuli',\r\n        authors: 'Quaranta, A., Siniscalchi, M., & Vallortigara, G.',\r\n        publication: 'Current Biology',\r\n        year: 2007,\r\n        doi: '10.1016/j.cub.2007.02.008'\r\n      },\r\n      {\r\n        title: 'Minimizing fear and anxiety in working dogs: A review',\r\n        authors: 'Rooney, N. J., Clark, C. C. A., & Casey, R. A.',\r\n        publication: 'Journal of Veterinary Behavior',\r\n        year: 2016,\r\n        doi: '10.1016/j.jveb.2016.11.001'\r\n      }\r\n    ],\r\n    likes: 245,\r\n    comments: 56,\r\n    shares: 89\r\n  },\r\n  {\r\n    id: 'blog_2',\r\n    title: 'What Your Cat is Really Saying',\r\n    author: {\r\n      id: 'author_2',\r\n      name: 'Zoe Neale',\r\n      profilePicture: require('../../assets/ZEGN_USER.jpeg'),\r\n      bio: 'Feline behavior specialist and veterinarian with a focus on cat-human relationships.'\r\n    },\r\n    publishDate: '2024-02-23',\r\n    readTime: '7 min',\r\n    tags: ['Cats', 'Behavior', 'Pet Care', 'Communication'],\r\n    content: `Ever wonder why your cat stares at you before slowly blinking or why they randomly sprint across the house at 2 AM? While cats may seem mysterious, they actually have a complex system of communication—if you know what to look for. Unlike dogs, who wear their emotions on their tails (literally), cats are more subtle. But once you learn their signals, you'll start to see what your cat has been trying to tell you all along.\r\n\r\nThe Myth of the Aloof Cat: Do They Actually Care About You?\r\nMany people think cats are independent and don't bond with their owners the way dogs do. But research suggests otherwise. A study by Vitale et al. (2019) found that cats form secure attachments to their owners, much like infants do with their caregivers. In an experiment where cats were briefly separated from their owners, many showed signs of distress when left alone and relief upon their owner's return. So yes, your cat does care about you—they just have their own way of showing it.\r\n\r\nThe Slow Blink: A Feline \"I Love You\"\r\nOne of the best-kept secrets of cat communication is the slow blink. If your cat locks eyes with you and then slowly closes and opens their eyes, congratulations! You've just received a cat's version of a smile. Research completed in 2020 (Humphrey) found that when humans slowly blink at their cats, the cats are more likely to return the gesture and approach them in a friendly manner. So, next time you want to say \"I love you\" to your cat, skip the baby talk and try a slow blink instead.\r\n\r\nTail Talk: Not Just for Dogs\r\nA cat's tail is like a built-in mood ring. Learning to read tail signals can help you avoid scratches and strengthen your bond.\r\nTail up, tip curved: A friendly, confident cat greeting. If your cat walks toward you with their tail high, they're happy to see you.\r\nPuffed-up tail: This is a defensive reaction. Your cat is startled or feels threatened.\r\nLow, slow-wagging tail: Unlike dogs, a slow-wagging cat tail isn't a good sign—it often signals irritation or mild aggression.\r\nTail wrapped around you or another cat: This is a sign of affection, almost like holding hands.\r\n\r\nPurring: More Than Just Happiness\r\nEveryone loves the soothing sound of a purring cat, but did you know cats don't just purr when they're happy? While contentment is a common reason, studies suggest cats also purr when they're stressed, in pain, or even trying to heal themselves. The frequency of cat purrs (between 25 and 150 Hz) has been linked to tissue regeneration and bone healing in studies on vibrational therapy (Muggenthaler, 2001). So, if your cat is purring at the vet's office, they may not be enjoying themselves—they might just be self-soothing.\r\n\r\nHeadbutting and Kneading: Strange but Sweet Gestures\r\nHeadbutting (bunting): When your cat gently bumps their head against you, they're not just being cute—they're marking you with their scent glands, claiming you as their own (Rodan, 2015).\r\nKneading: The rhythmic pressing of paws against a soft surface (or your lap) is a behavior kittens use to stimulate milk flow. In adult cats, it's a sign of comfort and contentment (Brown & Bradshaw, 2016).\r\n\r\nDo Cats Really Ignore Their Names?\r\nIf you've ever called your cat and been met with a flick of the ear but no movement, you might think they don't recognize their name. But research says otherwise. A study by Saito & Shinozuka (2013) found that cats can distinguish their names from other words, even in a household with multiple cats. They just don't always feel the need to respond. Unlike dogs, who evolved to seek human approval, cats evolved as solitary hunters. They hear you—they're just deciding whether you're worth getting up for.\r\n\r\nThe Zoomies: Science Behind the 2 AM Sprints\r\nThose sudden, chaotic bursts of energy—also known as \"zoomies\"—are actually a by normal part of feline behavior. Cats are natural hunters, and their instincts tell them to be most active at dawn and dusk. If your cat has zoomies at odd hours, they might just be burning off excess energy. Providing interactive play during the day can help prevent nighttime sprints (Turner, 2021).\r\n\r\nConclusion: The More You Watch, the More You Understand\r\nCats may seem mysterious, but once you learn their language, they're basically tiny, furry drama queens with very specific ways of expressing love (and judgment). That slow blink? A kiss. That tail flick? A warning. The 2 AM zoomies? Either pent-up energy or an exorcism—we may never know.\r\n\r\nThe more you pay attention to their signals, the better you'll understand them. And honestly your cat already understands you. They know exactly how to guilt-trip you into giving extra treats, how to wake you up precisely one minute before your alarm, and how to act like they don't care—right before curling up in your lap.\r\n\r\nAt the end of the day, cats aren't ignoring us. They're just selectively participating. And now that you can read their signals, you're officially part of their very exclusive club.`,\r\n    references: [\r\n      {\r\n        title: 'Communication in the domestic cat: within- and between-species',\r\n        authors: 'Brown, S. L., & Bradshaw, J. W. S.',\r\n        publication: 'Animal Behaviour',\r\n        year: 2016,\r\n        doi: '10.1016/j.anbehav.2016.05.015'\r\n      },\r\n      {\r\n        title: 'Feline Behavioral Health and Welfare',\r\n        authors: 'Rodan, I., & Heath, S.',\r\n        publication: 'Elsevier Health Sciences',\r\n        year: 2015\r\n      },\r\n      {\r\n        title: 'The felid purr: A healing mechanism?',\r\n        authors: 'Muggenthaler, E. von.',\r\n        publication: 'Proceedings of the 12th International Conference on Low Frequency Noise and Vibration',\r\n        year: 2001,\r\n        url: 'https://www.researchgate.net/publication/272259095_The_felid_purr_A_healing_mechanism'\r\n      },\r\n      {\r\n        title: 'Vocal recognition of owners by domestic cats (Felis catus)',\r\n        authors: 'Saito, A., & Shinozuka, K.',\r\n        publication: 'Animal Cognition',\r\n        year: 2013,\r\n        doi: '10.1007/s10071-013-0620-4'\r\n      },\r\n      {\r\n        title: 'The mechanics of social interactions between cats and their owners',\r\n        authors: 'Turner, D. C.',\r\n        publication: 'Frontiers in Veterinary Science',\r\n        year: 2021,\r\n        doi: '10.3389/fvets.2021.650143'\r\n      },\r\n      {\r\n        title: 'Attachment bonds between domestic cats and humans',\r\n        authors: 'Vitale, K. R., Behnke, A. C., & Udell, M. A. R.',\r\n        publication: 'Current Biology',\r\n        year: 2019,\r\n        doi: '10.1016/j.cub.2019.08.036'\r\n      },\r\n      {\r\n        title: 'The role of cat eye narrowing movements in cat–human communication',\r\n        authors: 'Humphrey, T., Proops, L., & McComb, K.',\r\n        publication: 'Scientific Reports',\r\n        year: 2020,\r\n        doi: '10.1038/s41598-020-73426-0'\r\n      }\r\n    ],\r\n    likes: 312,\r\n    comments: 78,\r\n    shares: 102\r\n  },\r\n  {\r\n    id: 'blog_3',\r\n    title: 'What Your Bird is Really Saying',\r\n    author: {\r\n      id: 'author_3',\r\n      name: 'Zoe Neale',\r\n      profilePicture: require('../../assets/ZEGN_USER.jpeg'),\r\n      bio: 'Avian specialist and researcher focusing on bird behavior and communication.'\r\n    },\r\n    publishDate: '2024-02-24',\r\n    readTime: '6 min',\r\n    tags: ['Birds', 'Behavior', 'Pet Care', 'Avian Communication'],\r\n    content: `Ever look at your bird and think, What's going on in that tiny dinosaur brain of yours? Well, good news—birds may not text, but they do have an entire language made up of wing flutters, tail flicks, and the occasional judgmental stare. And if you learn to read these signals, you'll finally understand what your feathered friend has been trying to tell you all along.\r\n\r\nLet's break down the mysterious world of bird body language so you can stop guessing and start actually communicating with your avian BFF.\r\n\r\nThe Head Tilt: Curious or Plotting Something?\r\nThat adorable head tilt your bird does isn't just to make you go aww—it's actually their way of getting a better look at something. Birds process images differently than we do, so when they tilt their head, they're adjusting their angle to see more clearly (Massen et al., 2014).\r\n\r\nSlow, curious head tilt: They're interested in what's happening and trying to analyze the situation. Basically, they're bird detectives.\r\nFrequent or extreme tilting: Could indicate a vision issue or neurological problem—if it looks excessive, a vet visit is a good idea (Massen et al., 2014).\r\nOne-eye stare, body stiffened: A sign they're feeling cautious or potentially threatened. If they were a human, this would be the equivalent of side-eye.\r\n\r\nFeather Fluffing: Cozy or Cranky?\r\nFeather movements say a lot about how a bird is feeling. Think of them as mood indicators, kind of like how we use facial expressions—except, you know, with more feathers.\r\n\r\nFluffed-up feathers for a few seconds: Just getting comfortable. If your bird puffs up and then smooths back down, they're basically stretching.\r\nConstantly fluffed-up feathers: Not good. This can be a sign of illness, stress, or even feeling cold (Massen et al., 2014).\r\nFeathers sleeked back tight to the body: Your bird is nervous or possibly feeling aggressive. Approach with caution (Pika & Bugnyar, 2011).\r\n\r\nThe Wing Flutter: Excitement or Back Off?\r\nBirds use their wings for way more than just flying—they also use them to communicate. Unfortunately, no sign language because birds dont have thumbs\r\n\r\nExcited, quick flutters: Happiness! Your bird is basically doing a little happy dance (Osaka University, 2023).\r\nSlow, controlled wing movements: This can be a \"stay away\" signal, kind of like putting up a hand to say \"not now.\"\r\nOne wing slightly drooped: Could be a sign of injury—time to check in with your vet.\r\n\r\nBunting: Love, Not a Headbutt Attack\r\nIf your bird presses or rubs their beak against you, congratulations—they're bunting, which is a sign of affection (Pika & Bugnyar, 2011).\r\n\r\nGentle beak rubbing: They're marking you as part of their flock. You're officially theirs now.\r\nAggressive, sudden beak nudging: Might mean \"Hey, stop that\" or \"Give me attention NOW.\"\r\n\r\nThe Stare-Down: Challenge or Trust?\r\nUnlike with dogs, where prolonged eye contact can be a dominance move, birds love staring at their favorite humans. It's actually a good thing—eye contact helps strengthen bonds (Osaka University, 2023).\r\n\r\nSoft, relaxed eyes: A sign of trust and comfort. They're chilling.\r\nWide eyes with pinning pupils: Intense excitement—or potential aggression. If they suddenly go from relaxed to laser-focused, read the room.\r\n\r\nTail Wagging: A Whole Different Story Than Dogs\r\nIf you thought tail wagging only meant happiness (like with dogs), think again—birds have their own unique tail signals.\r\n\r\nFast, side-to-side tail wagging: Happy and excited! Your bird is feeling good.\r\nSlow, deliberate tail flick: Annoyed or getting ready to give you a warning. Think of this as their way of saying \"I'm this close to losing it.\"\r\nTail fanned out: Displaying dominance or excitement—this is common in birds like parrots when they're trying to show off.\r\n\r\nThe Playful Side: Hanging Upside Down & Wing Spreading\r\nSome birds (especially parrots) love hanging upside down like little acrobats. This is usually a sign of happiness and playfulness. If your bird does this often, they're feeling safe and confident.\r\n\r\nUpside-down hanging: Your bird is comfortable with you and their surroundings. They trust you.\r\nOne wing slightly lifted while playing: This can be an invitation to interact—kind of like a bird's version of waving at you.\r\n\r\nConclusion: Your Bird Has Been Speaking—Now You're Fluent\r\nBirds may not use words the way we do (unless you have a talkative parrot), but their body language speaks volumes. From fluffed feathers to head tilts and beak bunts, every little movement is a clue to how they're feeling.\r\n\r\nThe more you watch and learn, the better you'll understand their unique way of communicating. And let's be real—your bird already knows exactly how to get your attention. Whether it's staring at you until you feel guilty enough to offer a treat or flapping their wings dramatically for no reason, they've got you trained.\r\n\r\nNow that you can finally read their signals, you're one step closer to becoming the ultimate bird whisperer. Just don't be surprised if they start giving you even more attitude now that you know what's up.`,\r\n    references: [\r\n      {\r\n        title: 'Facial display and blushing: Means of visual communication in blue-and-yellow macaws',\r\n        authors: 'Massen, J. J. M., Vermunt, D. A., & Sterck, E. H. M.',\r\n        publication: 'PLoS ONE',\r\n        year: 2014,\r\n        doi: '10.1371/journal.pone.0108794'\r\n      },\r\n      {\r\n        title: 'The use of referential gestures in ravens (Corvus corax) in the wild',\r\n        authors: 'Pika, S., & Bugnyar, T.',\r\n        publication: 'Nature Communications',\r\n        year: 2011,\r\n        doi: '10.1038/ncomms1567'\r\n      },\r\n      {\r\n        title: 'Wild birds gesture \"after you\" to insist their mate go first',\r\n        authors: 'Osaka University',\r\n        publication: 'Scientific American',\r\n        year: 2023,\r\n        url: 'https://www.scientificamerican.com/article/wild-birds-gesture-after-you-to-insist-their-mate-go-first/'\r\n      }\r\n    ],\r\n    likes: 198,\r\n    comments: 45,\r\n    shares: 67\r\n  }\r\n];","import React, { useState, useEffect, useContext } from 'react';\r\nimport { View, ScrollView, Image, StyleSheet, Linking, Dimensions, Platform, TouchableOpacity, TextInput } from 'react-native';\r\nimport { Button, Text, Card, Title, Paragraph, useTheme } from 'react-native-paper';\r\nimport { ImageBackground } from 'react-native';\r\nimport { theme } from '../styles/theme';\r\nimport { SCREEN_WIDTH } from '../context/AuthContext';\r\nimport { useNavigation } from '@react-navigation/native';\r\nimport { navigateToFrom } from '../components/Navigation';\r\nimport { FontAwesome } from '@expo/vector-icons';\r\nimport { FontAwesome5 } from '@expo/vector-icons';\r\nimport RoadmapSection from '../components/RoadmapSection';\r\nimport { useForm, ValidationError } from '@formspree/react';\r\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\r\nimport { FontAwesome6 } from '@expo/vector-icons';\r\nimport { MaterialIcons } from '@expo/vector-icons';\r\nimport { BLOG_POSTS } from '../data/mockData';\r\nimport { AuthContext } from '../context/AuthContext';\r\n\r\nconst { width: windowWidth, height: windowHeight } = Dimensions.get('window');\r\n\r\n// Define a sample reviews array\r\nconst reviews = [\r\n  {\r\n    image: require('../../assets/user1.png'),\r\n    text: \"\\\"CrittrCove has been amazing for finding reliable pet professionals!\",\r\n    author: \"John Smith\"\r\n  },\r\n  {\r\n    image: require('../../assets/user2.png'),\r\n    text: \"\\\"Great experience with pet sitting services!\",\r\n    author: \"Jane Doe\"\r\n  },\r\n  {\r\n    image: require('../../assets/user3.png'),\r\n    text: \"\\\"Found the perfect sitter for my exotic pets!\",\r\n    author: \"Sudhakar Vuluvala\"\r\n  },\r\n  {\r\n    image: require('../../assets/user4.png'),\r\n    text: \"\\\"I've had a fantastic experience with CrittrCove's pet grooming services!\",\r\n    author: \"Alice Brown\"\r\n  }\r\n];\r\n\r\n// Define the ReviewImage component\r\nconst ReviewImage = ({ source, style }) => {\r\n  if (Platform.OS === 'web') {\r\n    return <img src={source} style={style} alt=\"\" />;\r\n  }\r\n  return <Image source={source} style={style} />;\r\n};\r\n\r\nexport default function HomeScreen({ navigation }) {\r\n  const { colors } = useTheme();\r\n  const { screenWidth } = useContext(AuthContext);\r\n  const isMobileView = screenWidth < 660;\r\n  const openAppStore = (url) => {\r\n    Linking.openURL(url);\r\n  };\r\n\r\n  // Add state for social media popup visibility\r\n  const [isUserScrolling, setIsUserScrolling] = useState(false);\r\n\r\n  const AutoScrollSection = ({ data, renderItem, title, cardWidth = 320 }) => {\r\n    const scrollViewRef = React.useRef(null);\r\n    const [currentIndex, setCurrentIndex] = useState(0);\r\n    const [userScrolling, setUserScrolling] = useState(false);\r\n    const autoScrollTimerRef = React.useRef(null);\r\n\r\n    // Auto-scroll effect\r\n    useEffect(() => {\r\n      if (!userScrolling) {\r\n        autoScrollTimerRef.current = setInterval(() => {\r\n          if (scrollViewRef.current) {\r\n            const nextIndex = (currentIndex + 1) % data.length;\r\n            scrollToIndex(nextIndex);\r\n          }\r\n        }, 3000);\r\n      }\r\n\r\n      return () => {\r\n        if (autoScrollTimerRef.current) {\r\n          clearInterval(autoScrollTimerRef.current);\r\n        }\r\n      };\r\n    }, [currentIndex, userScrolling, data.length]);\r\n\r\n    const scrollToIndex = (index) => {\r\n      if (scrollViewRef.current) {\r\n        scrollViewRef.current.scrollTo({\r\n          x: index * cardWidth,\r\n          animated: true\r\n        });\r\n        setCurrentIndex(index);\r\n      }\r\n    };\r\n\r\n    const handleScroll = (event) => {\r\n      const contentOffset = event.nativeEvent.contentOffset.x;\r\n      const index = Math.round(contentOffset / cardWidth);\r\n      setCurrentIndex(index);\r\n    };\r\n\r\n    const handleScrollBegin = () => {\r\n      setUserScrolling(true);\r\n      if (autoScrollTimerRef.current) {\r\n        clearInterval(autoScrollTimerRef.current);\r\n      }\r\n    };\r\n\r\n    const handleScrollEnd = () => {\r\n      // Reset after a short delay to prevent immediate auto-scroll\r\n      setTimeout(() => {\r\n        setUserScrolling(false);\r\n      }, 1000);\r\n    };\r\n\r\n    const handleDotPress = (index) => {\r\n      setUserScrolling(true);\r\n      scrollToIndex(index);\r\n      // Reset auto-scroll after a delay\r\n      setTimeout(() => {\r\n        setUserScrolling(false);\r\n      }, 1000);\r\n    };\r\n\r\n    return (\r\n      <View style={styles.section}>\r\n        <Text style={styles.sectionTitle}>{title}</Text>\r\n        <View style={styles.scrollContainer}>\r\n          <ScrollView\r\n            ref={scrollViewRef}\r\n            horizontal\r\n            showsHorizontalScrollIndicator={true}\r\n            style={[styles.scrollContainer, { WebkitOverflowScrolling: 'touch' }]}\r\n            contentContainerStyle={styles.scrollContent}\r\n            onScroll={handleScroll}\r\n            scrollEventThrottle={16}\r\n            pagingEnabled={Platform.OS !== 'web'}\r\n            onScrollBeginDrag={handleScrollBegin}\r\n            onScrollEndDrag={handleScrollEnd}\r\n            onMomentumScrollEnd={handleScrollEnd}\r\n          >\r\n            {data.map((item, index) => renderItem(item, index))}\r\n          </ScrollView>\r\n          {/* Clickable scroll indicators */}\r\n          <View style={styles.scrollIndicators}>\r\n            {data.map((_, index) => (\r\n              <TouchableOpacity\r\n                key={index}\r\n                onPress={() => handleDotPress(index)}\r\n                style={styles.scrollIndicatorButton}\r\n              >\r\n                <View\r\n                  style={[\r\n                    styles.scrollIndicator,\r\n                    currentIndex === index && styles.scrollIndicatorActive\r\n                  ]}\r\n                />\r\n              </TouchableOpacity>\r\n            ))}\r\n          </View>\r\n          {/* Scroll hint for mobile */}\r\n          {Platform.OS !== 'web' && (\r\n            <View style={styles.scrollHint}>\r\n              <Text style={styles.scrollHintText}>Swipe for more</Text>\r\n              <MaterialCommunityIcons name=\"gesture-swipe-horizontal\" size={24} color={theme.colors.primary} />\r\n            </View>\r\n          )}\r\n        </View>\r\n      </View>\r\n    );\r\n  };\r\n\r\n  const ReviewsSection = () => {\r\n    const renderReview = (review, index) => (\r\n      <View key={index} style={styles.reviewCard}>\r\n        <Text style={styles.reviewText}>{review.text}</Text>\r\n        <View style={styles.reviewAuthorContainer}>\r\n          <ReviewImage\r\n            source={review.image}\r\n            style={styles.reviewerImage}\r\n          />\r\n          <View>\r\n            <Text style={styles.reviewAuthorName}>{review.author}</Text>\r\n            <Text style={styles.reviewAuthorTitle}>Owner Review</Text>\r\n            <View style={styles.starsContainer}>\r\n              {[1, 2, 3, 4, 5].map((_, index) => (\r\n                <MaterialCommunityIcons \r\n                  key={index}\r\n                  name=\"star\"\r\n                  size={16}\r\n                  color={theme.colors.primary}\r\n                  style={styles.starIcon}\r\n                />\r\n              ))}\r\n            </View>\r\n          </View>\r\n        </View>\r\n      </View>\r\n    );\r\n\r\n    return (\r\n      <AutoScrollSection\r\n        data={reviews}\r\n        renderItem={renderReview}\r\n        title=\"Kind Words From Users\"\r\n      />\r\n    );\r\n  };\r\n\r\n  const BlogSection = () => {\r\n    const renderBlogPost = (post, index) => (\r\n      <TouchableOpacity \r\n        key={post.id} \r\n        style={[\r\n          styles.blogCard,\r\n          { marginRight: index === BLOG_POSTS.length - 1 ? 0 : 10 }\r\n        ]} \r\n        onPress={() => navigateToFrom(navigation, 'BlogPost', 'Home', { post })}\r\n      >\r\n        <View style={styles.authorContainer}>\r\n          <Image\r\n            source={{ uri: post.author.profilePicture }}\r\n            style={styles.authorImage}\r\n          />\r\n          <View style={styles.blogContent}>\r\n            <Text style={[styles.title, { color: theme.colors.primary }]} numberOfLines={2}>\r\n              {post.title}\r\n            </Text>\r\n            <View style={styles.authorInfo}>\r\n              <Text style={[styles.authorName, { color: theme.colors.secondary }]}>\r\n                {post.author.name}\r\n              </Text>\r\n              <Text style={styles.dot}> • </Text>\r\n              <Text style={styles.readTime}>{post.readTime}</Text>\r\n            </View>\r\n            <Text style={styles.preview} numberOfLines={3}>\r\n              {post.content.slice(0, 100)}...\r\n            </Text>\r\n            <View style={styles.tags}>\r\n              {post.tags.slice(0, 2).map((tag, tagIndex) => (\r\n                <View \r\n                  key={tagIndex} \r\n                  style={[styles.tag, { backgroundColor: theme.colors.primary + '20' }]}\r\n                >\r\n                  <Text style={[styles.tagText, { color: theme.colors.primary }]}>{tag}</Text>\r\n                </View>\r\n              ))}\r\n            </View>\r\n            <View style={styles.stats}>\r\n              <View style={styles.stat}>\r\n                <MaterialCommunityIcons name=\"heart-outline\" size={16} color={theme.colors.secondary} />\r\n                <Text style={styles.statText}>{post.likes}</Text>\r\n              </View>\r\n              <View style={styles.stat}>\r\n                <MaterialCommunityIcons name=\"comment-outline\" size={16} color={theme.colors.secondary} />\r\n                <Text style={styles.statText}>{post.comments}</Text>\r\n              </View>\r\n              <View style={styles.stat}>\r\n                <MaterialCommunityIcons name=\"share-outline\" size={16} color={theme.colors.secondary} />\r\n                <Text style={styles.statText}>{post.shares}</Text>\r\n              </View>\r\n            </View>\r\n          </View>\r\n        </View>\r\n      </TouchableOpacity>\r\n    );\r\n\r\n    return (\r\n      <AutoScrollSection\r\n        data={BLOG_POSTS}\r\n        renderItem={renderBlogPost}\r\n        title=\"Blog\"\r\n        cardWidth={320}\r\n      />\r\n    );\r\n  };\r\n\r\n  const Features = () => {\r\n    const [activeTab, setActiveTab] = useState('owners'); // Default to owners tab\r\n\r\n    // Add roadmap colors array\r\n    const roadmapColors = ['#515d6c', '#516a6c', '#516C61', '#6A6C51'];\r\n\r\n    // Update the feature item structure and styles\r\n    const featureItemStyle = {\r\n      flexDirection: 'row',\r\n      marginBottom: 20,\r\n      alignItems: 'flex-start',\r\n      width: '100%',\r\n    };\r\n\r\n    const featureContentStyle = {\r\n      flex: 1,\r\n      marginLeft: 5,\r\n    };\r\n\r\n    return (\r\n      <View style={styles.featuresSection}>\r\n        <Text style={styles.sectionTitle}>How It Works</Text>\r\n        <View style={styles.toggleContainer}>\r\n          <TouchableOpacity \r\n            style={[styles.toggleButton, activeTab === 'owners' && styles.toggleButtonActive]}\r\n            onPress={() => setActiveTab('owners')}\r\n          >\r\n            <Text style={[styles.toggleButtonText, activeTab === 'owners' && styles.toggleButtonTextActive]}>For Pet Owners</Text>\r\n          </TouchableOpacity>\r\n          <TouchableOpacity \r\n            style={[styles.toggleButton, activeTab === 'sitters' && styles.toggleButtonActive]}\r\n            onPress={() => setActiveTab('sitters')}\r\n          >\r\n            <Text style={[styles.toggleButtonText, activeTab === 'sitters' && styles.toggleButtonTextActive]}>For Pet Professionals</Text>\r\n          </TouchableOpacity>\r\n        </View>\r\n\r\n        <View style={styles.featuresContainer}>\r\n          {activeTab === 'owners' && (\r\n            <View style={styles.featureColumn}>\r\n              <Text style={styles.columnTitle}>For Pet Owners</Text>\r\n              <View style={styles.featuresList}>\r\n                <View style={featureItemStyle}>\r\n                  <View style={[styles.featureIconCircle, { backgroundColor: roadmapColors[0] }]}>\r\n                    <FontAwesome6 name=\"person-running\" size={24} color=\"white\" />\r\n                  </View>\r\n                  <View style={featureContentStyle}>\r\n                    <Text style={styles.featureTitle}>Complete Your Profile</Text>\r\n                    <Text style={styles.featureText}>Submit details about you and your requirements.</Text>\r\n                  </View>\r\n                </View>\r\n                <View style={featureItemStyle}>\r\n                  <View style={[styles.featureIconCircle, { backgroundColor: roadmapColors[1] }]}>\r\n                    <MaterialCommunityIcons name=\"horse-human\" size={24} color=\"white\" />\r\n                  </View>\r\n                  <View style={featureContentStyle}>\r\n                    <Text style={styles.featureTitle}>Complete Pet Profile</Text>\r\n                    <Text style={styles.featureText}>Submit details about your pet and sitting requirements.</Text>\r\n                  </View>\r\n                </View>\r\n                <View style={featureItemStyle}>\r\n                  <View style={[styles.featureIconCircle, { backgroundColor: roadmapColors[2] }]}>\r\n                    <MaterialCommunityIcons name=\"professional-hexagon\" size={24} color=\"white\" />\r\n                  </View>\r\n                  <View style={featureContentStyle}>\r\n                    <Text style={styles.featureTitle}>Search for Pro's</Text>\r\n                    <Text style={styles.featureText}>You can use our marketplace to find the best pro for your desired service.</Text>\r\n                  </View>\r\n                </View>\r\n                <View style={featureItemStyle}>\r\n                  <View style={[styles.featureIconCircle, { backgroundColor: roadmapColors[3] }]}>\r\n                    <FontAwesome5 name=\"calendar-check\" size={24} color=\"white\" />\r\n                  </View>\r\n                  <View style={featureContentStyle}>\r\n                    <Text style={styles.featureTitle}>Confirm Your Booking</Text>\r\n                    <Text style={styles.featureText}>Coordinate directly with your professional to finalize details.</Text>\r\n                  </View>\r\n                </View>\r\n              </View>\r\n              <View style={styles.buttonContainer}>\r\n                <TouchableOpacity style={styles.actionButton} onPress={() => navigateToFrom(navigation, 'SignUp', 'Home')}>\r\n                  <Text style={styles.buttonText}>Sign up Today!</Text>\r\n                </TouchableOpacity>\r\n              </View>\r\n            </View>\r\n          )}\r\n          {activeTab === 'sitters' && (\r\n            <View style={styles.featureColumn}>\r\n              <Text style={styles.columnTitle}>For Pet Professionals</Text>\r\n              <View style={styles.featuresList}>\r\n                <View style={featureItemStyle}>\r\n                  <View style={[styles.featureIconCircle, { backgroundColor: roadmapColors[0] }]}>\r\n                    <FontAwesome name=\"sign-in\" size={24} color=\"white\" />\r\n                  </View>\r\n                  <View style={featureContentStyle}>\r\n                    <Text style={styles.featureTitle}>Apply to Join Pro Community</Text>\r\n                    <Text style={styles.featureText}>Submit your specialties, documents, bio, and availability to begin.</Text>\r\n                  </View>\r\n                </View>\r\n                <View style={featureItemStyle}>\r\n                  <View style={[styles.featureIconCircle, { backgroundColor: roadmapColors[1] }]}>\r\n                    <MaterialCommunityIcons name=\"plus-circle\" size={24} color=\"white\" />\r\n                  </View>\r\n                  <View style={featureContentStyle}>\r\n                    <Text style={styles.featureTitle}>Create Services</Text>\r\n                    <Text style={styles.featureText}>Create services to offer to pet owners.</Text>\r\n                  </View>\r\n                </View>\r\n                <View style={featureItemStyle}>\r\n                  <View style={[styles.featureIconCircle, { backgroundColor: roadmapColors[2] }]}>\r\n                    <FontAwesome6 name=\"handshake-simple\" size={24} color=\"white\" />\r\n                  </View>\r\n                  <View style={featureContentStyle}>\r\n                    <Text style={styles.featureTitle}>Get Matched with Owners</Text>\r\n                    <Text style={styles.featureText}>Pet owners in your area will reach out to you for yourservices.</Text>\r\n                  </View>\r\n                </View>\r\n                <View style={featureItemStyle}>\r\n                  <View style={[styles.featureIconCircle, { backgroundColor: roadmapColors[3] }]}>\r\n                    <MaterialIcons name=\"auto-graph\" size={24} color=\"white\" />\r\n                  </View>\r\n                  <View style={featureContentStyle}>\r\n                    <Text style={styles.featureTitle}>Grow Your Business</Text>\r\n                    <Text style={styles.featureText}>Manage bookings and get support as you build your pet service business.</Text>\r\n                  </View>\r\n                </View>\r\n              </View>\r\n              <View style={styles.buttonContainer}>\r\n                <TouchableOpacity style={styles.actionButton} onPress={() => navigateToFrom(navigation, 'SignUp', 'Home')}>\r\n                  <Text style={styles.buttonText}>Become a Professional</Text>\r\n                </TouchableOpacity>\r\n              </View>\r\n            </View>\r\n          )}\r\n        </View>\r\n      </View>\r\n    );\r\n  };\r\n\r\n  const ContactSection = () => {\r\n    const [state, handleSubmit] = useForm(\"mkgobpro\");\r\n    const [name, setName] = useState('');\r\n    const [email, setEmail] = useState('');\r\n    const [message, setMessage] = useState('');\r\n\r\n    const handleFormSubmit = async (e) => {\r\n      e.preventDefault();\r\n      const formData = {\r\n        name: name,\r\n        email: email,\r\n        message: message\r\n      };\r\n      \r\n      await handleSubmit(formData);\r\n      \r\n      if (state.succeeded) {\r\n        setName('');\r\n        setEmail('');\r\n        setMessage('');\r\n      }\r\n    };\r\n\r\n    if (state.succeeded) {\r\n      return (\r\n        <View style={styles.contactSection}>\r\n          <View style={styles.contactContainer}>\r\n            <Text style={[styles.sectionTitle, { color: theme.colors.primary }]}>\r\n              Thanks for reaching out!\r\n            </Text>\r\n            <Text style={styles.successMessage}>\r\n              We'll get back to you soon.\r\n            </Text>\r\n          </View>\r\n        </View>\r\n      );\r\n    }\r\n\r\n    return (\r\n      <View style={styles.contactSection}>\r\n        <View style={styles.contactContainer}>\r\n          <Text style={styles.sectionTitle}>Contact Us</Text>\r\n          <TextInput\r\n            placeholder=\"Your Name\"\r\n            style={styles.input}\r\n            value={name}\r\n            onChangeText={setName}\r\n            name=\"name\"\r\n          />\r\n          <ValidationError prefix=\"Name\" field=\"name\" errors={state.errors} />\r\n          \r\n          <TextInput\r\n            placeholder=\"Your Email\"\r\n            style={styles.input}\r\n            value={email}\r\n            onChangeText={setEmail}\r\n            keyboardType=\"email-address\"\r\n            name=\"email\"\r\n            autoCapitalize=\"none\"\r\n          />\r\n          <ValidationError prefix=\"Email\" field=\"email\" errors={state.errors} />\r\n          \r\n          <TextInput\r\n            placeholder=\"Your Message\"\r\n            style={[styles.input, styles.messageInput]}\r\n            value={message}\r\n            onChangeText={setMessage}\r\n            multiline\r\n            name=\"message\"\r\n          />\r\n          <ValidationError prefix=\"Message\" field=\"message\" errors={state.errors} />\r\n          \r\n          <View style={styles.buttonContainer}>\r\n            <TouchableOpacity\r\n              style={[\r\n                styles.actionButton,\r\n                state.submitting && styles.disabledButton\r\n              ]}\r\n              onPress={handleFormSubmit}\r\n              disabled={state.submitting}\r\n            >\r\n              <Text style={styles.buttonText}>\r\n                {state.submitting ? 'Sending...' : 'Send'}\r\n              </Text>\r\n            </TouchableOpacity>\r\n          </View>\r\n        </View>\r\n      </View>\r\n    );\r\n  };\r\n\r\n  const ServiceCard = ({ icon, title, description, color }) => {\r\n    const cardStyles = {\r\n      container: {\r\n        width: isMobileView ? '90%' : '45%',\r\n        minWidth: isMobileView ? 'auto' : 300,\r\n        maxWidth: 500,\r\n        padding: 20,\r\n        backgroundColor: '#fff',\r\n        borderRadius: 10,\r\n        shadowColor: '#000',\r\n        shadowOffset: { width: 0, height: 2 },\r\n        shadowOpacity: 0.1,\r\n        shadowRadius: 4,\r\n        elevation: 3,\r\n        marginBottom: 20,\r\n        alignSelf: 'center',\r\n      },\r\n      header: {\r\n        flexDirection: 'column',\r\n        alignItems: 'center',\r\n        marginBottom: 15,\r\n      },\r\n      iconContainer: {\r\n        width: 60,\r\n        height: 60,\r\n        borderRadius: 30,\r\n        backgroundColor: `${theme.colors.primary}15`,\r\n        justifyContent: 'center',\r\n        alignItems: 'center',\r\n        marginBottom: 15,\r\n      },\r\n      title: {\r\n        fontSize: 20,\r\n        fontWeight: 'bold',\r\n        color: theme.colors.text,\r\n        fontFamily: theme.fonts.header.fontFamily,\r\n        textAlign: 'center',\r\n        marginBottom: 10,\r\n      },\r\n      description: {\r\n        fontSize: 16,\r\n        lineHeight: 24,\r\n        color: theme.colors.text,\r\n        fontFamily: theme.fonts.regular.fontFamily,\r\n        textAlign: 'center',\r\n      },\r\n    };\r\n\r\n    return (\r\n      <View style={cardStyles.container}>\r\n        <View style={cardStyles.header}>\r\n          <View style={cardStyles.iconContainer}>\r\n            <MaterialCommunityIcons name={icon} size={32} color={color} />\r\n          </View>\r\n          <Text style={cardStyles.title}>{title}</Text>\r\n        </View>\r\n        <Text style={cardStyles.description}>{description}</Text>\r\n      </View>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <ScrollView \r\n      style={styles.container}\r\n      contentContainerStyle={styles.contentContainer}\r\n      showsVerticalScrollIndicator={true}\r\n      bounces={false}\r\n      overScrollMode=\"never\"\r\n    >\r\n      <View style={styles.heroSection}>\r\n        <Image\r\n          source={require('../../assets/hero-image.jpg')}\r\n          style={styles.heroImage}\r\n          resizeMode=\"cover\"\r\n        />\r\n        <View style={styles.heroContent}>\r\n          <Text style={styles.heroText}>Welcome to CrittrCove</Text>\r\n          <TouchableOpacity \r\n            style={styles.heroSignupButton} \r\n            onPress={() => navigateToFrom(navigation, 'SignUp', 'Home')}\r\n          >\r\n            <Text style={styles.heroSignupButtonText}>Sign Up Today</Text>\r\n          </TouchableOpacity>\r\n        </View>\r\n      </View>\r\n\r\n      {/* Service Highlights Section */}\r\n      <View style={styles.serviceHighlightsSection}>\r\n        <Text style={styles.mainServiceTitle}>Marketplace for Pet Owners and Care Professionals</Text>\r\n        \r\n        <View style={[styles.servicesGrid, { \r\n          flexDirection: isMobileView ? 'column' : 'row',\r\n          alignItems: isMobileView ? 'center' : 'flex-start',\r\n        }]}>\r\n          <ServiceCard\r\n            icon=\"paw\"\r\n            title=\"All Animals Welcome\"\r\n            description=\"From common pets to exotic animals, we connect you with professionals experienced in caring for any type of animal companion.\"\r\n            color={theme.colors.mainColors.senary}\r\n          />\r\n          <ServiceCard\r\n            icon=\"calendar-clock\"\r\n            title=\"Flexible Booking Options\"\r\n            description=\"Book single visits, multiple days, or set up recurring services. Create subscription plans or schedule services months in advance.\"\r\n            color={theme.colors.mainColors.quinary}\r\n          />\r\n          <ServiceCard\r\n            icon=\"shield-check\"\r\n            title=\"Verified Professionals\"\r\n            description=\"All professionals are thoroughly vetted and must maintain active insurance coverage to provide services through our platform.\"\r\n            color={theme.colors.mainColors.main}\r\n          />\r\n          <ServiceCard\r\n            icon=\"tune-variant\"\r\n            title=\"Customizable Services\"\r\n            description=\"Professionals can create custom service packages and pricing plans tailored to your specific needs and preferences.\"\r\n            color={theme.colors.mainColors.quaternary}\r\n          />\r\n        </View>\r\n      </View>\r\n\r\n      <Features />\r\n      <ReviewsSection />\r\n      <BlogSection />\r\n\r\n      {/* Roadmap Section */}\r\n      <RoadmapSection />\r\n\r\n      {/* FAQ Section */}\r\n      {/* <View style={styles.section}>\r\n        <Text style={styles.sectionTitle}>FAQs</Text>\r\n         {faqs.map((faq, index) => (\r\n          <View key={index} style={styles.faqItem}>\r\n            <TouchableOpacity \r\n              style={styles.faqButton}\r\n              onPress={() => setSelectedFaq(selectedFaq === index ? null : index)}\r\n            >\r\n              <Text style={styles.faqQuestion}>{faq.question}</Text>\r\n              <Text style={styles.faqToggle}>{selectedFaq === index ? '-' : '+'}</Text>\r\n            </TouchableOpacity>\r\n            {selectedFaq === index && (\r\n              <Text style={styles.faqAnswer}>{faq.answer}</Text>\r\n            )}\r\n          </View>\r\n        ))} \r\n      </View> */}\r\n\r\n      {/* Contact Us Section */}\r\n      <ContactSection />\r\n\r\n      {/* Footer */}\r\n      <View style={styles.footer}>\r\n        <View style={styles.socialIconsRow}>\r\n          <TouchableOpacity \r\n            style={styles.socialIcon} \r\n            onPress={() => Linking.openURL('https://www.instagram.com/thezensitter')}\r\n          >\r\n            <FontAwesome name=\"instagram\" size={24} color=\"white\" />\r\n          </TouchableOpacity>\r\n          <TouchableOpacity \r\n            style={styles.socialIcon} \r\n            onPress={() => Linking.openURL('https://discord.com/your-profile')}\r\n          >\r\n            <FontAwesome5 name=\"discord\" size={24} color=\"white\" />\r\n          </TouchableOpacity>\r\n        </View>\r\n        <View style={styles.footerLinksRow}>\r\n          <Text style={styles.footerLink} onPress={() => navigateToFrom(navigation, 'PrivacyPolicy', 'Home')}>Privacy Policy</Text>\r\n          <Text style={styles.footerLink} onPress={() => navigateToFrom(navigation, 'TermsOfService', 'Home')}>Terms of Service</Text>\r\n        </View>\r\n      </View>\r\n    </ScrollView>\r\n  );\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n  },\r\n  contentContainer: {\r\n    flexGrow: 1,\r\n  },\r\n  heroSection: {\r\n    height: Platform.OS === 'web' ? '70vh' : windowHeight * 0.5,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    overflow: 'hidden',\r\n    position: 'relative',\r\n  },\r\n  heroImage: {\r\n    width: '100%',\r\n    height: '100%',\r\n    position: 'absolute',\r\n  },\r\n  heroContent: {\r\n    position: 'absolute',\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    width: '100%',\r\n    height: '100%',\r\n    paddingHorizontal: 20,\r\n  },\r\n  heroText: {\r\n    fontSize: 32,\r\n    fontWeight: 'bold',\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n    textAlign: 'center',\r\n    color: 'white',\r\n    textShadowColor: 'rgba(0, 0, 0, 0.75)',\r\n    textShadowOffset: {width: -1, height: 1},\r\n    textShadowRadius: 10,\r\n    marginBottom: 20,\r\n  },\r\n  heroSignupButton: {\r\n    backgroundColor: 'white',\r\n    paddingHorizontal: 30,\r\n    paddingVertical: 15,\r\n    borderRadius: 25,\r\n    shadowColor: '#000',\r\n    shadowOffset: { width: 0, height: 2 },\r\n    shadowOpacity: 0.25,\r\n    shadowRadius: 4,\r\n    elevation: 5,\r\n  },\r\n  heroSignupButtonText: {\r\n    fontSize: 18,\r\n    fontWeight: 'bold',\r\n    color: theme.colors.primary,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  section: {\r\n    padding: 20,\r\n    width: '100%',\r\n    maxWidth: 1200,\r\n    marginLeft: 'auto',\r\n    marginRight: 'auto',\r\n    alignItems: 'center',\r\n  },\r\n  sectionTitle: {\r\n    fontSize: theme.fontSizes.largeLarge,\r\n    fontWeight: 'bold',\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n    marginBottom: 10,\r\n    textAlign: 'center',\r\n    color: 'black',\r\n  },\r\n  card: {\r\n    marginBottom: 10,\r\n  },\r\n  appButtons: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-around',\r\n    marginTop: 10,\r\n  },\r\n  appButton: {\r\n    width: '45%',\r\n  },\r\n  reviewsSection: {\r\n    // height: 350,\r\n    marginBottom: 20,\r\n  },\r\n  reviewsBackground: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n  },\r\n  reviewsOverlay: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    padding: 20,\r\n  },\r\n  reviewsSubtitle: {\r\n    fontSize: theme.fontSizes.mediumLarge,\r\n    fontWeight: 'bold',\r\n    color: 'black',\r\n    marginBottom: 10,\r\n    textAlign: 'center',\r\n    width: '100%',\r\n  },\r\n  reviewsTitle: {\r\n    fontSize: theme.fontSizes.largeLarge,\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n    fontWeight: 'bold',\r\n    color: 'black',\r\n    marginBottom: 20,\r\n    textAlign: 'center',\r\n    width: '100%',\r\n  },\r\n  reviewsContainer: {\r\n    width: '100%',\r\n    maxWidth: 1200,\r\n    marginLeft: 'auto',\r\n    marginRight: 'auto',\r\n    overflowX: 'auto',\r\n    WebkitOverflowScrolling: 'touch',\r\n    msOverflowStyle: 'auto',\r\n    scrollbarWidth: 'auto',\r\n    scrollbarColor: `${theme.colors.primary} transparent`,\r\n  },\r\n  reviewsContent: {\r\n    flexDirection: 'row',\r\n    minWidth: 'min-content',\r\n    gap: 10,\r\n    padding: 20,\r\n    paddingBottom: 40, // Add space for indicators\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n  },\r\n  reviewCard: {\r\n    width: 300,\r\n    height: 200,\r\n    padding: 20,\r\n    backgroundColor: 'white',\r\n    borderRadius: 10,\r\n    shadowColor: '#000',\r\n    shadowOffset: { width: 0, height: 2 },\r\n    shadowOpacity: 0.1,\r\n    shadowRadius: 4,\r\n    elevation: 3,\r\n    marginRight: 10,\r\n  },\r\n  reviewCardMobile: {\r\n    width: '100%',\r\n    height: '100%',\r\n  },\r\n  reviewQuote: {\r\n    fontSize: 24,\r\n    fontWeight: 'bold',\r\n    color: 'black',\r\n    marginBottom: 10,\r\n  },\r\n  reviewText: {\r\n    fontSize: 18,\r\n    color: 'black',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    marginBottom: 15,\r\n    flex: 1,\r\n  },\r\n  reviewAuthorContainer: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n  },\r\n  reviewerImage: {\r\n    width: 45,\r\n    height: 60,\r\n    borderRadius: 8,\r\n    marginRight: 10,\r\n    objectFit: 'cover',\r\n  },\r\n  reviewAuthorName: {\r\n    fontSize: 16,\r\n    fontWeight: 'bold',\r\n    color: 'black',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  reviewAuthorTitle: {\r\n    fontSize: 14,\r\n    color: '#666',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    marginTop: 2,\r\n  },\r\n  paginationDots: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'center',\r\n    marginTop: 10,\r\n  },\r\n  paginationDot: {\r\n    width: 10,\r\n    height: 10,\r\n    borderRadius: 5,\r\n    backgroundColor: 'white',\r\n    margin: 5,\r\n  },\r\n  paginationDotActive: {\r\n    backgroundColor: 'black',\r\n  },\r\n  featuresSection: {\r\n    marginBottom: 80,\r\n    marginTop: 20,\r\n  },\r\n  toggleContainer: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'center',\r\n    marginBottom: 10,\r\n  },\r\n  toggleButton: {\r\n    padding: 10,\r\n    backgroundColor: 'white',\r\n    borderWidth: 2,\r\n    borderColor: theme.colors.primary,\r\n  },\r\n  toggleButtonActive: {\r\n    backgroundColor: theme.colors.primary,\r\n  },\r\n  toggleButtonText: {\r\n    fontSize: 18,\r\n    fontWeight: 'bold',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  toggleButtonTextActive: {\r\n    color: theme.colors.whiteText,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  featuresContainer: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n  },\r\n  featureColumn: {\r\n    width: SCREEN_WIDTH < 768 ? '90%' : '100%',\r\n    maxWidth: 600,\r\n    padding: 20,\r\n    backgroundColor: 'white',\r\n    borderRadius: 10,\r\n    shadowColor: '#000',\r\n    shadowOffset: { width: 0, height: 2 },\r\n    shadowOpacity: 0.1,\r\n    shadowRadius: 4,\r\n    elevation: 3,\r\n  },\r\n  columnTitle: {\r\n    fontSize: 24,\r\n    fontWeight: 'bold',\r\n    marginBottom: 20,\r\n    color: 'black',\r\n    textAlign: 'center',\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n  },\r\n  featuresList: {\r\n    width: '100%',\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n    marginBottom: 20,\r\n  },\r\n  featureItem: {\r\n    flexDirection: 'row',\r\n    marginBottom: 20,\r\n    alignItems: 'flex-start',\r\n    width: '100%',\r\n  },\r\n  featureIconCircle: {\r\n    width: 50,\r\n    height: 50,\r\n    borderRadius: 25,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    marginTop: 5,\r\n  },\r\n  featureIcon: {\r\n    fontSize: 40,\r\n  },\r\n  featureTitle: {\r\n    fontSize: theme.fontSizes.mediumLarge,\r\n    fontWeight: 'bold',\r\n    marginBottom: 5,\r\n    color: 'black',\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n  },\r\n  featureText: {\r\n    fontSize: theme.fontSizes.mediumLarge + 2,\r\n    color: 'black',\r\n    lineHeight: 22,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  actionButton: {\r\n    backgroundColor: '#6A6C51',\r\n    width: '50%',\r\n    padding: 5,\r\n    borderRadius: 5,\r\n    alignItems: 'center',\r\n  },\r\n  buttonContainer: {\r\n    display: 'flex',\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n  },\r\n  buttonText: {\r\n    fontSize: 18,\r\n    fontWeight: 'bold',\r\n    color: 'white',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  blogSection: {\r\n    marginBottom: 20,\r\n    alignItems: 'center',\r\n  },\r\n  blogCard: {\r\n    width: 300,\r\n    backgroundColor: 'white',\r\n    borderRadius: 10,\r\n    shadowColor: '#000',\r\n    shadowOffset: { width: 0, height: 2 },\r\n    shadowOpacity: 0.1,\r\n    shadowRadius: 4,\r\n    elevation: 3,\r\n    padding: 15,\r\n    marginRight: 10,\r\n  },\r\n  authorContainer: {\r\n    flexDirection: 'column',\r\n  },\r\n  authorImage: {\r\n    width: 40,\r\n    height: 40,\r\n    borderRadius: 20,\r\n    marginBottom: 10,\r\n  },\r\n  blogContent: {\r\n    flex: 1,\r\n  },\r\n  title: {\r\n    fontSize: 18,\r\n    fontWeight: 'bold',\r\n    marginBottom: 8,\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n  },\r\n  authorInfo: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    marginBottom: 8,\r\n  },\r\n  authorName: {\r\n    fontSize: 16,\r\n    fontWeight: '500',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  dot: {\r\n    marginHorizontal: 4,\r\n    color: '#666',\r\n  },\r\n  readTime: {\r\n    fontSize: 16,\r\n    color: '#666',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  preview: {\r\n    fontSize: 16,\r\n    lineHeight: 20,\r\n    marginBottom: 12,\r\n    color: '#444',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  tags: {\r\n    flexDirection: 'row',\r\n    flexWrap: 'wrap',\r\n    marginBottom: 12,\r\n  },\r\n  tag: {\r\n    paddingHorizontal: 8,\r\n    paddingVertical: 4,\r\n    borderRadius: 16,\r\n    marginRight: 8,\r\n    marginBottom: 8,\r\n  },\r\n  tagText: {\r\n    fontSize: 14,\r\n    fontWeight: '500',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  stats: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'flex-start',\r\n    marginTop: 8,\r\n  },\r\n  stat: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    marginRight: 16,\r\n  },\r\n  statText: {\r\n    marginLeft: 4,\r\n    fontSize: 14,\r\n    color: '#666',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  roadmapSection: {\r\n    marginBottom: 20,\r\n  },\r\n  roadmapImage: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n  },\r\n  roadmapOverlayText: {\r\n    fontSize: 24,\r\n    fontWeight: 'bold',\r\n    color: 'black',\r\n  },\r\n  faqSection: {\r\n    marginBottom: 20,\r\n  },\r\n  faqItem: {\r\n    marginBottom: 10,\r\n  },\r\n  faqButton: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n  },\r\n  faqQuestion: {\r\n    fontSize: 16,\r\n    fontWeight: 'bold',\r\n  },\r\n  faqToggle: {\r\n    fontSize: 14,\r\n    color: 'gray',\r\n  },\r\n  faqAnswer: {\r\n    fontSize: 16,\r\n  },\r\n  contactSection: {\r\n    // maxWidth: 800,\r\n    width: '100%',\r\n    // display: 'flex',\r\n    // flexDirection: 'column',\r\n    // alignItems: 'center',\r\n    // justifyContent: 'center',\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    alignItems: 'center',\r\n    padding: 20,\r\n  },\r\n  contactContainer: {\r\n    width: '100%',\r\n    maxWidth: 600,\r\n  },\r\n  input: {\r\n    padding: 10,\r\n    marginBottom: 10,\r\n    borderWidth: 1,\r\n    borderColor: 'gray',\r\n    borderRadius: 5,\r\n  },\r\n  footer: {\r\n    padding: 20,\r\n    backgroundColor: theme.colors.primary,\r\n    alignItems: 'center',\r\n  },\r\n  socialIconsRow: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'center',\r\n    marginBottom: 15,\r\n  },\r\n  socialIcon: {\r\n    marginHorizontal: 15,\r\n    padding: 5,\r\n  },\r\n  footerLinksRow: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'center',\r\n    flexWrap: 'wrap',\r\n  },\r\n  footerLink: {\r\n    color: 'white',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    marginHorizontal: 15,\r\n    textDecorationLine: 'underline',\r\n  },\r\n  successMessage: {\r\n    fontSize: 18,\r\n    textAlign: 'center',\r\n    marginTop: 10,\r\n    color: 'black',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  messageInput: {\r\n    height: 100,\r\n    textAlignVertical: 'top',\r\n    paddingTop: 10,\r\n  },\r\n  disabledButton: {\r\n    opacity: 0.7,\r\n  },\r\n  validationError: {\r\n    color: 'red',\r\n    fontSize: 16,\r\n    marginTop: -5,\r\n    marginBottom: 10,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  starsContainer: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    marginTop: 4,\r\n  },\r\n  starIcon: {\r\n    marginRight: 2,\r\n  },\r\n  waitlistSection: {\r\n    // backgroundColor: '#f5f5f5',\r\n    marginVertical: 20,\r\n    borderRadius: 10,\r\n  },\r\n  waitlistDescription: {\r\n    fontSize: 18,\r\n    textAlign: 'center',\r\n    marginBottom: 20,\r\n    color: 'black',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    paddingHorizontal: 20,\r\n    lineHeight: 24,\r\n  },\r\n  waitlistButton: {\r\n    marginTop: 10,\r\n    width: '80%',\r\n    maxWidth: 300,\r\n    padding: 15,\r\n  },\r\n  scrollIndicators: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    marginTop: 10,\r\n    marginBottom: 20,\r\n  },\r\n  scrollIndicatorButton: {\r\n    padding: 10, // Increase touch target\r\n    marginHorizontal: -6, // Compensate for padding while maintaining visual spacing\r\n  },\r\n  scrollIndicator: {\r\n    width: 8,\r\n    height: 8,\r\n    borderRadius: 4,\r\n    backgroundColor: theme.colors.border,\r\n    marginHorizontal: 4,\r\n  },\r\n  scrollIndicatorActive: {\r\n    backgroundColor: theme.colors.primary,\r\n    width: 24,\r\n  },\r\n  scrollHint: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    paddingVertical: 10,\r\n  },\r\n  scrollHintText: {\r\n    color: theme.colors.primary,\r\n    marginRight: 5,\r\n    fontSize: theme.fontSizes.medium,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  scrollContainer: {\r\n    width: '100%',\r\n    maxWidth: 1200,\r\n    marginLeft: 'auto',\r\n    marginRight: 'auto',\r\n    overflowX: 'auto',\r\n    WebkitOverflowScrolling: 'touch',\r\n    msOverflowStyle: 'auto',\r\n    scrollbarWidth: 'auto',\r\n    scrollbarColor: `${theme.colors.primary} transparent`,\r\n  },\r\n  scrollContent: {\r\n    flexDirection: 'row',\r\n    minWidth: 'min-content',\r\n    gap: 10,\r\n    padding: 20,\r\n    paddingBottom: 40,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n  },\r\n  serviceHighlightsSection: {\r\n    padding: 20,\r\n    width: '100%',\r\n    maxWidth: 1200,\r\n    marginLeft: 'auto',\r\n    marginRight: 'auto',\r\n    alignItems: 'center',\r\n  },\r\n  mainServiceTitle: {\r\n    fontSize: 32,\r\n    fontWeight: 'bold',\r\n    textAlign: 'center',\r\n    marginBottom: 40,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n  },\r\n  servicesGrid: {\r\n    flexWrap: 'wrap',\r\n    justifyContent: 'center',\r\n    gap: 20,\r\n    width: '100%',\r\n  },\r\n});\r\n","import React from 'react';\r\nimport { View, StyleSheet, Platform } from 'react-native';\r\nimport { Button } from 'react-native-paper';\r\nimport { theme } from '../styles/theme';\r\nimport { AuthContext, debugLog } from '../context/AuthContext';\r\n\r\nconst FloatingSaveButton = ({ visible, onSave, btnText = \"Save Changes\" }) => {\r\n  const { screenWidth, isCollapsed } = React.useContext(AuthContext);\r\n  \r\n  // Don't render anything if not visible\r\n  if (!visible) {\r\n    return null;\r\n  }\r\n  \r\n  // Simple logging only when visible\r\n  React.useEffect(() => {\r\n    if (visible) {\r\n      debugLog('MBA230uvj0834h9', 'FloatingSaveButton is visible');\r\n    }\r\n  }, [visible]);\r\n\r\n  // Calculate marginLeft to match sidebar on desktop\r\n  const marginLeft = screenWidth > 900 ? (isCollapsed ? 70 : 250) : 0;\r\n\r\n  return (\r\n    <View \r\n      style={[\r\n        styles.floatingButtonContainer,\r\n        Platform.OS === 'web' ? styles.webButton : styles.mobileButton,\r\n        { marginLeft }\r\n      ]}\r\n    >\r\n      <Button \r\n        mode=\"contained\" \r\n        onPress={onSave}\r\n        style={styles.floatingButton}\r\n        labelStyle={styles.buttonLabel}\r\n      >\r\n        {btnText}\r\n      </Button>\r\n    </View>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  floatingButtonContainer: {\r\n    position: 'fixed',\r\n    bottom: 20,\r\n    left: 0,\r\n    right: 0,\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    zIndex: 9999,\r\n    backgroundColor: 'transparent',\r\n  },\r\n  webButton: {\r\n    position: 'fixed',\r\n    bottom: 20,\r\n    backgroundColor: 'transparent',\r\n  },\r\n  mobileButton: {\r\n    position: 'fixed',\r\n    bottom: 20,\r\n    backgroundColor: 'transparent',\r\n    width: '100%',\r\n  },\r\n  floatingButton: {\r\n    backgroundColor: theme.colors.primary,\r\n    borderRadius: 25,\r\n    paddingHorizontal: 24,\r\n    paddingVertical: 8,\r\n    elevation: 5,\r\n    shadowColor: '#000',\r\n    shadowOffset: {\r\n      width: 0,\r\n      height: 2,\r\n    },\r\n    shadowOpacity: 0.25,\r\n    shadowRadius: 3.84,\r\n    maxWidth: 600,\r\n    minWidth: 200,\r\n  },\r\n  buttonLabel: {\r\n    fontSize: 16,\r\n    fontWeight: 'bold',\r\n    color: '#fff',\r\n  },\r\n});\r\n\r\nexport default FloatingSaveButton;","import React, { useContext } from 'react';\r\nimport {\r\n  View,\r\n  Text,\r\n  StyleSheet,\r\n  ScrollView,\r\n} from 'react-native';\r\nimport { theme } from '../../styles/theme';\r\nimport { AuthContext } from '../../context/AuthContext';\r\n\r\n/**\r\n * @typedef {Object} StepProgressIndicatorProps\r\n * @property {string[]} steps - Array of step names\r\n * @property {number} currentStep - Current active step (0-based index)\r\n * @property {function} [onStepPress] - Optional callback when a step is pressed\r\n * @property {Object} [style] - Optional style overrides\r\n */\r\n\r\nconst StepProgressIndicator = props => {\r\n  const {\r\n    steps,\r\n    currentStep,\r\n    onStepPress,\r\n    style,\r\n  } = props;\r\n  \r\n  const { screenWidth, is_DEBUG } = useContext(AuthContext);\r\n  const isDesktop = screenWidth > 768;\r\n\r\n  if (is_DEBUG) {\r\n    console.log(\"MBA1234 - Screen width:\", screenWidth);\r\n    console.log(\"MBA1234 - Is desktop:\", isDesktop);\r\n    console.log(\"MBA1234 - Steps:\", steps);\r\n    console.log(\"MBA1234 - Current step:\", currentStep);\r\n  }\r\n\r\n  // Helper function to determine what type of line to render between steps\r\n  const renderLine = (stepIndex) => {\r\n    if (stepIndex < currentStep) {\r\n      // Line between completed steps\r\n      return (\r\n        <View style={[styles.line, styles.completedLine]} />\r\n      );\r\n    } else if (stepIndex === currentStep) {\r\n      // Line after the active step - show progress indicator\r\n      return (\r\n        <View style={styles.progressLine}>\r\n          <View style={styles.progressFilled} />\r\n          <View style={styles.progressEmpty} />\r\n        </View>\r\n      );\r\n    } else {\r\n      // Line between future steps\r\n      return (\r\n        <View style={styles.line} />\r\n      );\r\n    }\r\n  };\r\n\r\n  // Render a single step\r\n  const renderStep = (stepName, index) => {\r\n    const isActive = index === currentStep;\r\n    const isCompleted = index < currentStep;\r\n\r\n    return (\r\n      <View key={`step-${index}`} style={styles.step}>\r\n        <View style={[\r\n          styles.stepCircle,\r\n          isActive && styles.activeStepCircle,\r\n          isCompleted && styles.completedStepCircle\r\n        ]}>\r\n          <Text style={[\r\n            styles.stepNumber,\r\n            isActive && styles.activeStepNumber,\r\n            isCompleted && styles.completedStepNumber,\r\n          ]}>{index + 1}</Text>\r\n        </View>\r\n        \r\n        {(isActive || isDesktop) && (\r\n          <Text style={[\r\n            styles.stepName,\r\n            isActive && styles.activeStepName,\r\n          ]}>{stepName}</Text>\r\n        )}\r\n      </View>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <View style={[styles.wrapper, style]}>\r\n      <View style={styles.container}>\r\n        {steps.map((step, index) => (\r\n          <React.Fragment key={`step-fragment-${index}`}>\r\n            {renderStep(step, index)}\r\n            {index < steps.length - 1 && renderLine(index)}\r\n          </React.Fragment>\r\n        ))}\r\n      </View>\r\n    </View>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  wrapper: {\r\n    backgroundColor: theme.colors.background,\r\n    paddingVertical: 12,\r\n    width: '100%',\r\n    zIndex: 1,\r\n  },\r\n  container: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    width: '100%',\r\n    paddingHorizontal: 16,\r\n    justifyContent: 'space-between',\r\n  },\r\n  step: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    zIndex: 2,\r\n  },\r\n  stepCircle: {\r\n    width: 32,\r\n    height: 32,\r\n    borderRadius: 16,\r\n    backgroundColor: theme.colors.surface,\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.modernBorder,\r\n    zIndex: 3,\r\n  },\r\n  activeStepCircle: {\r\n    backgroundColor: theme.colors.mainColors.main,\r\n    borderColor: theme.colors.mainColors.main,\r\n  },\r\n  completedStepCircle: {\r\n    backgroundColor: theme.colors.mainColors.main,\r\n    borderColor: theme.colors.mainColors.main,\r\n    opacity: 0.8,\r\n  },\r\n  stepNumber: {\r\n    fontSize: 14,\r\n    color: theme.colors.text,\r\n    opacity: 0.5,\r\n  },\r\n  activeStepNumber: {\r\n    color: theme.colors.surface,\r\n    opacity: 1,\r\n  },\r\n  completedStepNumber: {\r\n    color: theme.colors.surface,\r\n  },\r\n  stepName: {\r\n    fontSize: 14,\r\n    color: theme.colors.text,\r\n    opacity: 0.7,\r\n    marginLeft: 8,\r\n    whiteSpace: 'nowrap',\r\n  },\r\n  activeStepName: {\r\n    color: theme.colors.mainColors.main,\r\n    opacity: 1,\r\n  },\r\n  line: {\r\n    height: 2,\r\n    backgroundColor: theme.colors.border,\r\n    opacity: 0.2,\r\n    flex: 1,\r\n    marginHorizontal: 4,\r\n    zIndex: 1,\r\n  },\r\n  completedLine: {\r\n    backgroundColor: theme.colors.mainColors.main,\r\n    opacity: 1,\r\n  },\r\n  progressLine: {\r\n    flex: 1,\r\n    flexDirection: 'row',\r\n    height: 2,\r\n    marginHorizontal: 4,\r\n    zIndex: 1,\r\n  },\r\n  progressFilled: {\r\n    flex: 1,\r\n    backgroundColor: theme.colors.mainColors.main,\r\n    height: 2,\r\n  },\r\n  progressEmpty: {\r\n    flex: 1,\r\n    backgroundColor: theme.colors.border,\r\n    opacity: 0.2,\r\n    height: 2,\r\n  },\r\n});\r\n\r\nexport default StepProgressIndicator; ","import React, { useState, useEffect } from 'react';\r\nimport {\r\n  View,\r\n  Text,\r\n  StyleSheet,\r\n  TouchableOpacity,\r\n  ScrollView,\r\n  Modal,\r\n  TextInput,\r\n  Platform,\r\n  Dimensions,\r\n  Picker\r\n} from 'react-native';\r\nimport { theme } from '../../styles/theme';\r\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\r\nimport { debugLog } from '../../context/AuthContext';\r\n\r\nconst GENERAL_CATEGORIES = [\r\n  {\r\n    id: 'all',\r\n    name: 'All',\r\n    icon: 'paw-outline',\r\n    animalTypes: [] // Will be populated with all animal types\r\n  },\r\n  {\r\n    id: 'farm_animals',\r\n    name: 'Farm Animals',\r\n    icon: 'horse',\r\n    animalTypes: ['Horse', 'Cow', 'Sheep', 'Goat', 'Pig', 'Other']\r\n  },\r\n  {\r\n    id: 'domestic',\r\n    name: 'Domestic',\r\n    icon: 'paw',\r\n    animalTypes: ['Dogs', 'Cats', 'Birds', 'Rabbits', 'Hamsters', 'Other']\r\n  },\r\n  {\r\n    id: 'reptiles',\r\n    name: 'Reptiles',\r\n    icon: 'snake',\r\n    animalTypes: ['Snake', 'Lizard', 'Turtle', 'Gecko', 'Chameleon', 'Other']\r\n  },\r\n  {\r\n    id: 'aquatic',\r\n    name: 'Aquatic',\r\n    icon: 'fish',\r\n    animalTypes: ['Fish', 'Frog', 'Newt', 'Axolotl', 'Other']\r\n  },\r\n  {\r\n    id: 'invertebrates',\r\n    name: 'Invertebrates',\r\n    icon: 'spider',\r\n    animalTypes: ['Spider', 'Scorpion', 'Crab', 'Snail', 'Millipede', 'Other']\r\n  }\r\n];\r\n\r\n// Animal icons lookup\r\nconst ANIMAL_ICONS = {\r\n  // Farm animals\r\n  'Horse': 'horse',\r\n  'Cow': 'cow',\r\n  'Sheep': 'sheep',\r\n  'Goat': 'cow',\r\n  'Pig': 'pig',\r\n  \r\n  // Domestic\r\n  'Dogs': 'dog',\r\n  'Cats': 'cat',\r\n  'Birds': 'bird',\r\n  'Rabbits': 'rabbit',\r\n  'Hamsters': 'rodent',\r\n  \r\n  // Reptiles\r\n  'Snake': 'snake',\r\n  'Lizard': 'snake',\r\n  'Turtle': 'turtle',\r\n  'Gecko': 'snake',\r\n  'Chameleon': 'snake',\r\n  \r\n  // Aquatic\r\n  'Fish': 'fish',\r\n  'Frog': 'snake',\r\n  'Newt': 'fish',\r\n  'Axolotl': 'fish',\r\n  \r\n  // Invertebrates\r\n  'Spider': 'spider',\r\n  'Scorpion': 'spider',\r\n  'Crab': 'fish',\r\n  'Snail': 'snail',\r\n  'Millipede': 'bug',\r\n  \r\n  // Default\r\n  'Other': 'help-circle-outline'\r\n};\r\n\r\n// Animal categories lookup - hardcoded mapping of each animal to its proper category\r\nconst ANIMAL_CATEGORIES = {\r\n  // Farm animals\r\n  'Horse': 'Farm Animals',\r\n  'Cow': 'Farm Animals',\r\n  'Sheep': 'Farm Animals',\r\n  'Goat': 'Farm Animals',\r\n  'Pig': 'Farm Animals',\r\n  \r\n  // Domestic\r\n  'Dogs': 'Domestic',\r\n  'Cats': 'Domestic',\r\n  'Birds': 'Domestic',\r\n  'Rabbits': 'Domestic',\r\n  'Hamsters': 'Domestic',\r\n  \r\n  // Reptiles\r\n  'Snake': 'Reptiles',\r\n  'Lizard': 'Reptiles',\r\n  'Turtle': 'Reptiles',\r\n  'Gecko': 'Reptiles',\r\n  'Chameleon': 'Reptiles',\r\n  \r\n  // Aquatic\r\n  'Fish': 'Aquatic',\r\n  'Frog': 'Aquatic',\r\n  'Newt': 'Aquatic',\r\n  'Axolotl': 'Aquatic',\r\n  \r\n  // Invertebrates\r\n  'Spider': 'Invertebrates',\r\n  'Scorpion': 'Invertebrates',\r\n  'Crab': 'Invertebrates',\r\n  'Snail': 'Invertebrates',\r\n  'Millipede': 'Invertebrates'\r\n};\r\n\r\n// Get all animal types from all categories\r\nconst getAllAnimalTypes = () => {\r\n  const allTypes = [];\r\n  GENERAL_CATEGORIES.forEach(category => {\r\n    if (category.id !== 'all') {\r\n      category.animalTypes.forEach(type => {\r\n        if (type !== 'Other' && !allTypes.includes(type)) {\r\n          allTypes.push(type);\r\n        }\r\n      });\r\n    }\r\n  });\r\n  return allTypes;\r\n};\r\n\r\n// Populate the 'all' category with all animal types\r\nGENERAL_CATEGORIES[0].animalTypes = getAllAnimalTypes();\r\n\r\nconst DEFAULT_ANIMAL_TYPES = [\r\n  'Dogs',\r\n  'Cats',\r\n  'Fish',\r\n  'Birds',\r\n  'Rabbits',\r\n  'Snake'\r\n];\r\n\r\n// Most common pets to display first when \"All\" is selected\r\nconst COMMON_PETS = [\r\n  'Dogs',\r\n  'Cats',\r\n  'Fish',\r\n  'Birds',\r\n  'Hamsters',\r\n  'Rabbits',\r\n  'Snake',\r\n  'Turtle'\r\n];\r\n\r\n// Get the appropriate icon for an animal type\r\nconst getAnimalIcon = (animalName, categoryId = null) => {\r\n  // If the animal has a predefined icon, use it\r\n  if (ANIMAL_ICONS[animalName]) {\r\n    return ANIMAL_ICONS[animalName];\r\n  }\r\n  \r\n  // For custom animals, use the category icon if available\r\n  if (categoryId) {\r\n    const category = GENERAL_CATEGORIES.find(cat => cat.id === categoryId);\r\n    if (category) {\r\n      return category.icon;\r\n    }\r\n  }\r\n  \r\n  // Default to paw icon\r\n  return 'paw';\r\n};\r\n\r\nconst getCategoryIcon = (categoryName) => {\r\n  const category = GENERAL_CATEGORIES.find(cat => cat.name === categoryName);\r\n  return category ? category.icon : 'paw-outline';\r\n};\r\n\r\nconst CategorySelectionStep = ({ serviceData, setServiceData }) => {\r\n  const [customAnimalInput, setCustomAnimalInput] = useState('');\r\n  const [customAnimalCategory, setCustomAnimalCategory] = useState('');\r\n  const [showCustomAnimalInput, setShowCustomAnimalInput] = useState(false);\r\n  const [selectedCategoryFilter, setSelectedCategoryFilter] = useState('all');\r\n  const [screenWidth, setScreenWidth] = useState(Dimensions.get('window').width);\r\n  const isMobile = Platform.OS !== 'web';\r\n\r\n  useEffect(() => {\r\n    const updateLayout = () => {\r\n      setScreenWidth(Dimensions.get('window').width);\r\n    };\r\n\r\n    Dimensions.addEventListener('change', updateLayout);\r\n    return () => {\r\n      // Remove listener on cleanup\r\n      if (Dimensions.removeEventListener) {\r\n        Dimensions.removeEventListener('change', updateLayout);\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    // Initialize with first category selected\r\n    if (!customAnimalCategory && GENERAL_CATEGORIES.length > 1) {\r\n      setCustomAnimalCategory(GENERAL_CATEGORIES[1].id);\r\n    }\r\n    \r\n    // Debug log to check what animal types we're receiving\r\n    debugLog('MBA456789', 'CategorySelectionStep received serviceData:', serviceData);\r\n    if (serviceData.animalTypes && serviceData.animalTypes.length > 0) {\r\n      debugLog('MBA456789', 'Initial animal types in CategorySelectionStep:', serviceData.animalTypes);\r\n    }\r\n  }, []);\r\n\r\n  const isAnimalTypeSelected = (animalName) => {\r\n    if (!serviceData.animalTypes || !serviceData.animalTypes.length) {\r\n      return false;\r\n    }\r\n    \r\n    // Check all possible formats of animal types\r\n    return serviceData.animalTypes.some(animal => {\r\n      if (typeof animal === 'string') {\r\n        return animal === animalName;\r\n      } else if (typeof animal === 'object' && animal !== null) {\r\n        return animal.name === animalName;\r\n      }\r\n      return false;\r\n    });\r\n  };\r\n\r\n  const getCategoryForAnimal = (animalName) => {\r\n    const animal = serviceData.animalTypes.find(a => a.name === animalName);\r\n    if (animal && animal.categoryId) {\r\n      const category = GENERAL_CATEGORIES.find(cat => cat.id === animal.categoryId);\r\n      return category ? category.name : 'Other';\r\n    }\r\n    return 'Other';\r\n  };\r\n\r\n  const handleCategoryFilterSelect = (categoryId) => {\r\n    setSelectedCategoryFilter(categoryId);\r\n  };\r\n\r\n  const handleAnimalTypeSelect = (animalName, categoryId = null) => {\r\n    debugLog('MBA456789', `Selecting animal: ${animalName}, categoryId: ${categoryId}`);\r\n    \r\n    if (animalName === 'Other') {\r\n      setShowCustomAnimalInput(true);\r\n      setCustomAnimalCategory(categoryId || (GENERAL_CATEGORIES[1] && GENERAL_CATEGORIES[1].id));\r\n      return;\r\n    }\r\n\r\n    setServiceData(prev => {\r\n      const prevAnimalTypes = prev.animalTypes || [];\r\n      debugLog('MBA456789', 'Current animal types before update:', prevAnimalTypes);\r\n      \r\n      // Check if this animal is already selected\r\n      const existingAnimalIndex = prevAnimalTypes.findIndex(animal => {\r\n        if (typeof animal === 'string') {\r\n          return animal === animalName;\r\n        } else if (typeof animal === 'object' && animal !== null) {\r\n          return animal.name === animalName;\r\n        }\r\n        return false;\r\n      });\r\n      \r\n      debugLog('MBA456789', `Animal ${animalName} is ${existingAnimalIndex !== -1 ? 'already selected' : 'not selected'}`);\r\n      \r\n      if (existingAnimalIndex !== -1) {\r\n        // If already selected, remove it\r\n        const updatedTypes = [...prevAnimalTypes];\r\n        updatedTypes.splice(existingAnimalIndex, 1);\r\n        debugLog('MBA456789', 'Animal types after removal:', updatedTypes);\r\n        \r\n        return {\r\n          ...prev,\r\n          animalTypes: updatedTypes\r\n        };\r\n      } else {\r\n        // If not selected, add it with the hardcoded category\r\n        // Get the proper category from our mapping\r\n        const hardcodedCategory = ANIMAL_CATEGORIES[animalName] || 'Other';\r\n        \r\n        // Find the category ID from the name if needed\r\n        let categoryToUse = categoryId;\r\n        if (!categoryToUse) {\r\n          const foundCategory = GENERAL_CATEGORIES.find(cat => cat.name === hardcodedCategory);\r\n          categoryToUse = foundCategory ? foundCategory.id : 'other';\r\n        }\r\n        \r\n        const newAnimal = {\r\n          name: animalName,\r\n          categoryId: categoryToUse,\r\n          categoryName: hardcodedCategory, // Always use the hardcoded category name\r\n          isCustom: false\r\n        };\r\n        \r\n        debugLog('MBA456789', 'Adding new animal:', newAnimal);\r\n        debugLog('MBA456789', 'Animal types after addition:', [...prevAnimalTypes, newAnimal]);\r\n        \r\n        return {\r\n          ...prev,\r\n          animalTypes: [...prevAnimalTypes, newAnimal]\r\n        };\r\n      }\r\n    });\r\n  };\r\n\r\n  const handleAddCustomAnimal = () => {\r\n    if (!customAnimalInput.trim()) return;\r\n\r\n    // Find the category name for the custom animal\r\n    let categoryName = 'Other';\r\n    if (customAnimalCategory) {\r\n      const categoryInfo = GENERAL_CATEGORIES.find(cat => cat.id === customAnimalCategory);\r\n      if (categoryInfo) {\r\n        categoryName = categoryInfo.name;\r\n      }\r\n    }\r\n\r\n    setServiceData(prev => ({\r\n      ...prev,\r\n      animalTypes: [...prev.animalTypes, { \r\n        name: customAnimalInput.trim(),\r\n        categoryId: customAnimalCategory || 'other',\r\n        categoryName: categoryName, // Add the category name\r\n        isCustom: true\r\n      }]\r\n    }));\r\n    \r\n    // Also add the category to generalCategories if it's not already there\r\n    if (customAnimalCategory) {\r\n      const categoryExists = serviceData.generalCategories.some(cat => cat.id === customAnimalCategory);\r\n      if (!categoryExists) {\r\n        const categoryToAdd = GENERAL_CATEGORIES.find(cat => cat.id === customAnimalCategory);\r\n        if (categoryToAdd) {\r\n          setServiceData(prev => ({\r\n            ...prev,\r\n            generalCategories: [...prev.generalCategories, {\r\n              id: categoryToAdd.id,\r\n              name: categoryToAdd.name,\r\n              icon: categoryToAdd.icon\r\n            }]\r\n          }));\r\n        }\r\n      }\r\n    }\r\n    \r\n    setCustomAnimalInput('');\r\n    setShowCustomAnimalInput(false);\r\n  };\r\n\r\n  const handleSelectAll = () => {\r\n    let allAnimalTypes = [];\r\n    \r\n    if (selectedCategoryFilter && selectedCategoryFilter !== 'all') {\r\n      // If a category filter is selected, get all animals from that category\r\n      const categoryData = GENERAL_CATEGORIES.find(cat => cat.id === selectedCategoryFilter);\r\n      if (categoryData) {\r\n        allAnimalTypes = categoryData.animalTypes\r\n          .filter(type => type !== 'Other')\r\n          .map(type => ({ \r\n            name: type, \r\n            categoryId: selectedCategoryFilter \r\n          }));\r\n      }\r\n    } else {\r\n      // Otherwise get animal types from all categories\r\n      GENERAL_CATEGORIES.forEach(category => {\r\n        if (category.id !== 'all') {\r\n          category.animalTypes\r\n            .filter(type => type !== 'Other')\r\n            .forEach(type => {\r\n              allAnimalTypes.push({ \r\n                name: type, \r\n                categoryId: category.id \r\n              });\r\n            });\r\n        }\r\n      });\r\n    }\r\n    \r\n    setServiceData(prev => ({\r\n      ...prev,\r\n      animalTypes: allAnimalTypes\r\n    }));\r\n  };\r\n\r\n  const handleClearAll = () => {\r\n    setServiceData(prev => ({\r\n      ...prev,\r\n      animalTypes: []\r\n    }));\r\n  };\r\n\r\n  const getFilteredAnimalTypes = () => {\r\n    debugLog('MBA456789', 'Getting filtered animal types with filter:', selectedCategoryFilter);\r\n    debugLog('MBA456789', 'Current serviceData.animalTypes:', serviceData.animalTypes);\r\n    \r\n    let animalTypesToShow = [];\r\n    let categoriesUsed = new Set();\r\n    \r\n    if (selectedCategoryFilter && selectedCategoryFilter !== 'all') {\r\n      // If a specific category is selected as filter, show only animals from that category\r\n      const categoryData = GENERAL_CATEGORIES.find(cat => cat.id === selectedCategoryFilter);\r\n      if (categoryData) {\r\n        animalTypesToShow = categoryData.animalTypes\r\n          .filter(type => type !== 'Other')\r\n          .map(type => ({\r\n            name: type,\r\n            categoryId: selectedCategoryFilter,\r\n            categoryName: categoryData.name,\r\n            icon: getAnimalIcon(type, selectedCategoryFilter)\r\n          }));\r\n        categoriesUsed.add(categoryData.name);\r\n      }\r\n    } else {\r\n      // Show all animal types from all categories (except 'all' category)\r\n      GENERAL_CATEGORIES.forEach(category => {\r\n        if (category.id !== 'all') {\r\n          category.animalTypes\r\n            .filter(type => type !== 'Other')\r\n            .forEach(type => {\r\n              animalTypesToShow.push({\r\n                name: type,\r\n                categoryId: category.id,\r\n                categoryName: category.name,\r\n                icon: getAnimalIcon(type, category.id)\r\n              });\r\n              categoriesUsed.add(category.name);\r\n            });\r\n        }\r\n      });\r\n    }\r\n    \r\n    // Add custom animals that match the filter\r\n    if (serviceData.animalTypes && serviceData.animalTypes.length > 0) {\r\n      serviceData.animalTypes.forEach(animal => {\r\n        // Skip if not an object or has no name\r\n        if (typeof animal !== 'object' || !animal || !animal.name) {\r\n          return;\r\n        }\r\n        \r\n        // Check if it's a custom animal or if its name doesn't match any predefined animal types\r\n        const isCustomOrUnknown = animal.isCustom || \r\n          !GENERAL_CATEGORIES.some(cat => \r\n            cat.animalTypes && cat.animalTypes.includes(animal.name)\r\n          );\r\n        \r\n        if (isCustomOrUnknown) {\r\n          let categoryId = animal.categoryId;\r\n          let categoryName = animal.categoryName || 'Other';\r\n          \r\n          // If we have a categoryName but no categoryId, try to find the corresponding categoryId\r\n          if (!categoryId && categoryName) {\r\n            const category = GENERAL_CATEGORIES.find(cat => cat.name === categoryName);\r\n            if (category) {\r\n              categoryId = category.id;\r\n            }\r\n          }\r\n          \r\n          // If we still don't have a categoryName, try to derive from categoryId\r\n          if (!categoryName && categoryId) {\r\n            const category = GENERAL_CATEGORIES.find(cat => cat.id === categoryId);\r\n            if (category) {\r\n              categoryName = category.name;\r\n            }\r\n          }\r\n          \r\n          // Check if this animal should be shown based on the selected filter\r\n          if (selectedCategoryFilter === 'all' || categoryId === selectedCategoryFilter) {\r\n            // Check if this animal is already in the list\r\n            const existing = animalTypesToShow.find(a => a.name === animal.name);\r\n            if (!existing) {\r\n              debugLog('MBA456789', `Adding custom/unknown animal to filtered list: ${animal.name}, category: ${categoryName}`);\r\n              \r\n              animalTypesToShow.push({\r\n                name: animal.name,\r\n                categoryId: categoryId,\r\n                categoryName: categoryName,\r\n                icon: getAnimalIcon(animal.name, categoryId),\r\n                isCustom: true\r\n              });\r\n              categoriesUsed.add(categoryName);\r\n            }\r\n          }\r\n        }\r\n      });\r\n    }\r\n    \r\n    // Sort with common pets first, then alphabetically\r\n    animalTypesToShow.sort((a, b) => {\r\n      const aCommonIndex = COMMON_PETS.indexOf(a.name);\r\n      const bCommonIndex = COMMON_PETS.indexOf(b.name);\r\n      \r\n      // If both are common pets, sort by common pet order\r\n      if (aCommonIndex !== -1 && bCommonIndex !== -1) {\r\n        return aCommonIndex - bCommonIndex;\r\n      }\r\n      \r\n      // If only a is a common pet, it comes first\r\n      if (aCommonIndex !== -1) {\r\n        return -1;\r\n      }\r\n      \r\n      // If only b is a common pet, it comes first\r\n      if (bCommonIndex !== -1) {\r\n        return 1;\r\n      }\r\n      \r\n      // Otherwise sort alphabetically\r\n      return a.name.localeCompare(b.name);\r\n    });\r\n    \r\n    debugLog('MBA456789', 'Filtered animal types to show:', animalTypesToShow);\r\n    \r\n    return { animalTypes: animalTypesToShow, categories: Array.from(categoriesUsed) };\r\n  };\r\n\r\n  const { animalTypes: filteredAnimalTypes } = getFilteredAnimalTypes();\r\n  \r\n  const styles = StyleSheet.create({\r\n    container: {\r\n      flex: 1,\r\n      padding: 16,\r\n    },\r\n    title: {\r\n      fontSize: 24,\r\n      fontWeight: '600',\r\n      color: theme.colors.text,\r\n      marginBottom: 16,\r\n      fontFamily: theme.fonts.header.fontFamily,\r\n    },\r\n    subtitle: {\r\n      fontSize: 20,\r\n      fontWeight: '600',\r\n      color: theme.colors.text,\r\n      marginTop: 24,\r\n      marginBottom: 16,\r\n      fontFamily: theme.fonts.header.fontFamily,\r\n    },\r\n    instructions: {\r\n      fontSize: 16,\r\n      color: theme.colors.textSecondary,\r\n      marginBottom: 16,\r\n      fontFamily: theme.fonts.regular.fontFamily,\r\n    },\r\n    categoryFiltersContainer: {\r\n      flexDirection: 'row',\r\n      marginBottom: 24,\r\n      paddingLeft: 2,\r\n      paddingRight: 20, // Extra padding at the end for better scrolling\r\n    },\r\n    categoryFiltersScrollView: {\r\n      maxHeight: 60,\r\n    },\r\n    categoryFilterButton: {\r\n      paddingVertical: 12,\r\n      paddingHorizontal: 20,\r\n      borderRadius: 50,\r\n      borderWidth: 1,\r\n      borderColor: theme.colors.border,\r\n      backgroundColor: theme.colors.surface,\r\n      flexDirection: 'row',\r\n      alignItems: 'center',\r\n      gap: 8,\r\n      minHeight: 46,\r\n      marginRight: 10,\r\n    },\r\n    selectedCategoryFilter: {\r\n      backgroundColor: theme.colors.mainColors.mainLight,\r\n      borderColor: theme.colors.mainColors.main,\r\n    },\r\n    categoryFilterText: {\r\n      fontSize: 16,\r\n      color: theme.colors.text,\r\n      fontFamily: theme.fonts.regular.fontFamily,\r\n    },\r\n    selectedCategoryFilterText: {\r\n      color: theme.colors.mainColors.main,\r\n      fontWeight: '600',\r\n    },\r\n    actionsContainer: {\r\n      flexDirection: 'row',\r\n      justifyContent: 'flex-end',\r\n      marginBottom: 24,\r\n      // gap: 16,\r\n    },\r\n    actionButton: {\r\n      paddingVertical: 8,\r\n      paddingHorizontal: 12,\r\n    },\r\n    actionButtonText: {\r\n      fontSize: 16,\r\n      color: theme.colors.mainColors.main,\r\n      fontFamily: theme.fonts.regular.fontFamily,\r\n    },\r\n    animalTypesGrid: {\r\n      flexDirection: 'row',\r\n      flexWrap: 'wrap',\r\n      gap: 16,\r\n    },\r\n    animalTypeItem: {\r\n      flex: 1,\r\n      minWidth: Platform.OS === 'web' ? (screenWidth <= 420 ? '45%' : '30%') : '45%',\r\n      marginBottom: 12,\r\n    },\r\n    animalTypeCard: {\r\n      borderRadius: 12,\r\n      borderWidth: 1,\r\n      borderColor: theme.colors.border,\r\n      backgroundColor: theme.colors.surface,\r\n      padding: 16,\r\n      height: 70,\r\n      justifyContent: 'center',\r\n    },\r\n    selectedAnimalCard: {\r\n      borderColor: theme.colors.mainColors.main,\r\n      backgroundColor: theme.colors.mainColors.mainLight,\r\n    },\r\n    animalTypeRow: {\r\n      flexDirection: 'row',\r\n      justifyContent: 'space-between',\r\n      alignItems: 'center',\r\n    },\r\n    animalIconAndName: {\r\n      flexDirection: 'row',\r\n      alignItems: 'center',\r\n      gap: 12,\r\n    },\r\n    animalTypeName: {\r\n      fontSize: 16,\r\n      fontWeight: '500',\r\n      color: theme.colors.text,\r\n      fontFamily: theme.fonts.regular.fontFamily,\r\n    },\r\n    customInputContainer: {\r\n      marginVertical: 24,\r\n      padding: 16,\r\n      borderRadius: 12,\r\n      borderWidth: 1,\r\n      borderColor: theme.colors.border,\r\n      backgroundColor: theme.colors.backgroundContrast,\r\n    },\r\n    customInputTitle: {\r\n      fontSize: 16,\r\n      fontWeight: '600',\r\n      color: theme.colors.text,\r\n      marginBottom: 12,\r\n      fontFamily: theme.fonts.regular.fontFamily,\r\n    },\r\n    inputRow: {\r\n      flexDirection: 'row',\r\n      gap: 8,\r\n      marginBottom: 12,\r\n    },\r\n    textInput: {\r\n      flex: 1,\r\n      height: 48,\r\n      borderWidth: 1,\r\n      borderColor: theme.colors.border,\r\n      borderRadius: 8,\r\n      paddingHorizontal: 12,\r\n      backgroundColor: theme.colors.surface,\r\n      color: theme.colors.text,\r\n      fontFamily: theme.fonts.regular.fontFamily,\r\n    },\r\n    pickerContainer: {\r\n      flex: 1,\r\n      height: 48,\r\n      borderWidth: 1,\r\n      borderColor: theme.colors.border,\r\n      borderRadius: 8,\r\n      backgroundColor: theme.colors.surface,\r\n      justifyContent: 'center',\r\n    },\r\n    picker: {\r\n      height: 48,\r\n      color: theme.colors.text,\r\n    },\r\n    addButton: {\r\n      backgroundColor: theme.colors.mainColors.main,\r\n      borderRadius: 8,\r\n      paddingVertical: 12,\r\n      paddingHorizontal: 16,\r\n      alignItems: 'center',\r\n    },\r\n    addButtonText: {\r\n      color: theme.colors.surface,\r\n      fontSize: 16,\r\n      fontWeight: '600',\r\n      fontFamily: theme.fonts.regular.fontFamily,\r\n    },\r\n    selectedAnimalsSection: {\r\n      marginTop: 24,\r\n      padding: 16,\r\n      backgroundColor: theme.colors.backgroundContrast,\r\n      borderRadius: 12,\r\n      borderWidth: 1,\r\n      borderColor: theme.colors.border,\r\n    },\r\n    selectedAnimalsTitle: {\r\n      fontSize: 16,\r\n      fontWeight: '600',\r\n      color: theme.colors.text,\r\n      marginBottom: 12,\r\n      fontFamily: theme.fonts.regular.fontFamily,\r\n    },\r\n    selectedAnimalsList: {\r\n      flexDirection: 'row',\r\n      flexWrap: 'wrap',\r\n      gap: 8,\r\n    },\r\n    animalBubble: {\r\n      flexDirection: 'row',\r\n      alignItems: 'center',\r\n      backgroundColor: theme.colors.surface,\r\n      borderRadius: 20,\r\n      paddingVertical: 6,\r\n      paddingHorizontal: 12,\r\n      borderWidth: 1,\r\n      borderColor: theme.colors.border,\r\n      marginBottom: 8,\r\n      marginRight: 8,\r\n      gap: 8,\r\n    },\r\n    animalBubbleText: {\r\n      fontSize: 14,\r\n      color: theme.colors.text,\r\n      fontFamily: theme.fonts.regular.fontFamily,\r\n    },\r\n    removeAnimalButton: {\r\n      padding: 2,\r\n    },\r\n  });\r\n\r\n  return (\r\n    <ScrollView style={styles.container}>\r\n      <Text style={styles.title}>Select Animal Types for Your Service</Text>\r\n      <Text style={styles.instructions}>\r\n        Choose the animal types your service will cover. You can filter by category or add custom animals.\r\n      </Text>\r\n      \r\n      {/* Category filters */}\r\n      <ScrollView \r\n        horizontal={true}\r\n        showsHorizontalScrollIndicator={false}\r\n        contentContainerStyle={styles.categoryFiltersContainer}\r\n        style={styles.categoryFiltersScrollView}\r\n      >\r\n        {GENERAL_CATEGORIES.map((category) => (\r\n          <TouchableOpacity\r\n            key={category.id}\r\n            style={[\r\n              styles.categoryFilterButton,\r\n              selectedCategoryFilter === category.id && styles.selectedCategoryFilter\r\n            ]}\r\n            onPress={() => handleCategoryFilterSelect(category.id)}\r\n          >\r\n            <MaterialCommunityIcons\r\n              name={category.icon}\r\n              size={22}\r\n              color={selectedCategoryFilter === category.id ? theme.colors.mainColors.main : theme.colors.text}\r\n            />\r\n            <Text style={[\r\n              styles.categoryFilterText,\r\n              selectedCategoryFilter === category.id && styles.selectedCategoryFilterText\r\n            ]}>\r\n              {category.name}\r\n            </Text>\r\n          </TouchableOpacity>\r\n        ))}\r\n      </ScrollView>\r\n      \r\n      {/* Actions */}\r\n      <View style={styles.actionsContainer}>\r\n        <TouchableOpacity style={styles.actionButton} onPress={handleSelectAll}>\r\n          <Text style={styles.actionButtonText}>Select All</Text>\r\n        </TouchableOpacity>\r\n        <TouchableOpacity style={styles.actionButton} onPress={handleClearAll}>\r\n          <Text style={styles.actionButtonText}>Clear All</Text>\r\n        </TouchableOpacity>\r\n        <TouchableOpacity \r\n          style={styles.actionButton}\r\n          onPress={() => setShowCustomAnimalInput(true)}\r\n        >\r\n          <Text style={styles.actionButtonText}>Add Custom Pet</Text>\r\n        </TouchableOpacity>\r\n      </View>\r\n      \r\n      {/* Custom Animal Input */}\r\n      {showCustomAnimalInput && (\r\n        <View style={styles.customInputContainer}>\r\n          <Text style={styles.customInputTitle}>Add a Custom Animal Type</Text>\r\n          <View style={styles.inputRow}>\r\n            <TextInput\r\n              style={styles.textInput}\r\n              placeholder=\"Animal Type (e.g. Hamster)\"\r\n              value={customAnimalInput}\r\n              onChangeText={setCustomAnimalInput}\r\n              placeholderTextColor={theme.colors.placeHolderText}\r\n            />\r\n            <View style={styles.pickerContainer}>\r\n              {Platform.OS === 'ios' || Platform.OS === 'android' ? (\r\n                <Picker\r\n                  selectedValue={customAnimalCategory}\r\n                  style={styles.picker}\r\n                  onValueChange={(itemValue) => setCustomAnimalCategory(itemValue)}\r\n                >\r\n                  {GENERAL_CATEGORIES.filter(cat => cat.id !== 'all').map(category => (\r\n                    <Picker.Item \r\n                      key={category.id} \r\n                      label={category.name} \r\n                      value={category.id} \r\n                    />\r\n                  ))}\r\n                </Picker>\r\n              ) : (\r\n                <select\r\n                  value={customAnimalCategory}\r\n                  onChange={(e) => setCustomAnimalCategory(e.target.value)}\r\n                  style={styles.picker}\r\n                >\r\n                  {GENERAL_CATEGORIES.filter(cat => cat.id !== 'all').map(category => (\r\n                    <option key={category.id} value={category.id}>\r\n                      {category.name}\r\n                    </option>\r\n                  ))}\r\n                </select>\r\n              )}\r\n            </View>\r\n          </View>\r\n          <TouchableOpacity \r\n            style={styles.addButton}\r\n            onPress={handleAddCustomAnimal}\r\n            disabled={!customAnimalInput.trim()}\r\n          >\r\n            <Text style={styles.addButtonText}>Add Animal</Text>\r\n          </TouchableOpacity>\r\n        </View>\r\n      )}\r\n      \r\n      {/* Animal Types Grid */}\r\n      {filteredAnimalTypes.length > 0 ? (\r\n        <View style={styles.animalTypesGrid}>\r\n          {filteredAnimalTypes.map((animalType) => (\r\n            <View key={`${animalType.categoryId}-${animalType.name}`} style={styles.animalTypeItem}>\r\n              <TouchableOpacity\r\n                style={[\r\n                  styles.animalTypeCard,\r\n                  isAnimalTypeSelected(animalType.name) && styles.selectedAnimalCard\r\n                ]}\r\n                onPress={() => handleAnimalTypeSelect(animalType.name, animalType.categoryId)}\r\n              >\r\n                <View style={styles.animalTypeRow}>\r\n                  <View style={styles.animalIconAndName}>\r\n                    <MaterialCommunityIcons\r\n                      name={animalType.icon}\r\n                      size={24}\r\n                      color={theme.colors.text}\r\n                    />\r\n                    <Text style={styles.animalTypeName}>{animalType.name}</Text>\r\n                  </View>\r\n                  {isAnimalTypeSelected(animalType.name) && (\r\n                    <MaterialCommunityIcons\r\n                      name=\"check-circle\"\r\n                      size={24}\r\n                      color={theme.colors.mainColors.main}\r\n                    />\r\n                  )}\r\n                </View>\r\n              </TouchableOpacity>\r\n            </View>\r\n          ))}\r\n        </View>\r\n      ) : (\r\n        <Text style={styles.instructions}>\r\n          No animal types match your current filter. Try selecting a different category or add a custom animal.\r\n        </Text>\r\n      )}\r\n      \r\n      {/* Selected Animals Summary */}\r\n      {serviceData.animalTypes.length > 0 && (\r\n        <View style={styles.selectedAnimalsSection}>\r\n          <Text style={styles.selectedAnimalsTitle}>\r\n            Selected Animals ({serviceData.animalTypes.length})\r\n          </Text>\r\n          <View style={styles.selectedAnimalsList}>\r\n            {serviceData.animalTypes.map((animal, index) => {\r\n              const animalName = animal.name;\r\n              const icon = getAnimalIcon(animalName, animal.categoryId);\r\n              \r\n              return (\r\n                <View key={index} style={styles.animalBubble}>\r\n                  <MaterialCommunityIcons\r\n                    name={icon}\r\n                    size={18}\r\n                    color={theme.colors.text}\r\n                  />\r\n                  <Text style={styles.animalBubbleText}>{animalName}</Text>\r\n                  <TouchableOpacity \r\n                    onPress={() => handleAnimalTypeSelect(animalName)}\r\n                    style={styles.removeAnimalButton}\r\n                  >\r\n                    <MaterialCommunityIcons \r\n                      name=\"close-circle\" \r\n                      size={16} \r\n                      color={theme.colors.text} \r\n                    />\r\n                  </TouchableOpacity>\r\n                </View>\r\n              );\r\n            })}\r\n          </View>\r\n        </View>\r\n      )}\r\n    </ScrollView>\r\n  );\r\n};\r\n\r\nexport default CategorySelectionStep; ","import React, { useState } from 'react';\r\nimport {\r\n  View,\r\n  Text,\r\n  StyleSheet,\r\n  TextInput,\r\n  TouchableOpacity,\r\n  Switch\r\n} from 'react-native';\r\nimport { theme } from '../../styles/theme';\r\nimport { debugLog } from '../../context/AuthContext';\r\n\r\nconst MAX_SERVICE_NAME_LENGTH = 30;\r\nconst MAX_DESCRIPTION_LENGTH = 300;\r\n\r\nconst ServiceDetailsStep = ({ serviceData, setServiceData }) => {\r\n  const [nameError, setNameError] = useState('');\r\n  const [descriptionError, setDescriptionError] = useState('');\r\n\r\n  const validateInput = (text, isName = true) => {\r\n    // Allow only letters, numbers, spaces and & symbol\r\n    const validRegex = /^[a-zA-Z0-9\\s&\\.\\-\\,!]*$/;\r\n    \r\n    if (!validRegex.test(text)) {\r\n      if (isName) {\r\n        setNameError('Service name can only contain letters, numbers, spaces, &, and !');\r\n      } else {\r\n        setDescriptionError('Description can only contain letters, numbers, spaces, periods, commas, dashes, &, and !');\r\n      }\r\n      return false;\r\n    }\r\n    \r\n    if (isName) {\r\n      setNameError('');\r\n    } else {\r\n      setDescriptionError('');\r\n    }\r\n    return true;\r\n  };\r\n\r\n  const handleServiceNameChange = (text) => {\r\n    // Limit to MAX_SERVICE_NAME_LENGTH characters\r\n    const truncatedText = text.slice(0, MAX_SERVICE_NAME_LENGTH);\r\n    \r\n    if (validateInput(truncatedText, true)) {\r\n      setServiceData(prev => ({\r\n        ...prev,\r\n        serviceName: truncatedText\r\n      }));\r\n    }\r\n  };\r\n\r\n  const handleDescriptionChange = (text) => {\r\n    // Limit to MAX_DESCRIPTION_LENGTH characters\r\n    const truncatedText = text.slice(0, MAX_DESCRIPTION_LENGTH);\r\n    \r\n    if (validateInput(truncatedText, false)) {\r\n      setServiceData(prev => ({\r\n        ...prev,\r\n        serviceDescription: truncatedText\r\n      }));\r\n    }\r\n  };\r\n\r\n  const handleOvernightToggle = (value) => {\r\n    setServiceData(prev => ({\r\n      ...prev,\r\n      isOvernight: value\r\n    }));\r\n  };\r\n\r\n  return (\r\n    <View style={styles.container}>\r\n      <Text style={styles.title}>Service Details</Text>\r\n      \r\n      <View style={styles.inputGroup}>\r\n        <Text style={styles.label}>Service Name</Text>\r\n        <TextInput\r\n          style={styles.input}\r\n          value={serviceData.serviceName}\r\n          onChangeText={handleServiceNameChange}\r\n          placeholder=\"e.g. Premium Pet Grooming\"\r\n          placeholderTextColor={theme.colors.placeHolderText}\r\n          maxLength={MAX_SERVICE_NAME_LENGTH}\r\n        />\r\n        <Text style={styles.characterCount}>\r\n          {serviceData.serviceName.length}/{MAX_SERVICE_NAME_LENGTH}\r\n        </Text>\r\n        {nameError ? <Text style={styles.errorText}>{nameError}</Text> : null}\r\n      </View>\r\n      \r\n      <View style={styles.inputGroup}>\r\n        <Text style={styles.label}>Service Description</Text>\r\n        <TextInput\r\n          style={[styles.input, styles.textArea]}\r\n          value={serviceData.serviceDescription}\r\n          onChangeText={handleDescriptionChange}\r\n          placeholder=\"Describe your service in detail...\"\r\n          placeholderTextColor={theme.colors.placeHolderText}\r\n          multiline={true}\r\n          numberOfLines={6}\r\n          textAlignVertical=\"top\"\r\n          maxLength={MAX_DESCRIPTION_LENGTH}\r\n        />\r\n        <Text style={styles.characterCount}>\r\n          {serviceData.serviceDescription.length}/{MAX_DESCRIPTION_LENGTH}\r\n        </Text>\r\n        {descriptionError ? <Text style={styles.errorText}>{descriptionError}</Text> : null}\r\n      </View>\r\n      \r\n      <View style={styles.switchContainer}>\r\n        <View style={styles.switchGroup}>\r\n          <Text style={styles.switchLabel}>Overnight Service</Text>\r\n          <Text style={styles.switchSubLabel}>Does this service require overnight stay?</Text>\r\n        </View>\r\n        <Switch\r\n          value={serviceData.isOvernight}\r\n          onValueChange={handleOvernightToggle}\r\n          trackColor={{ false: theme.colors.border, true: theme.colors.mainColors.main }}\r\n          thumbColor={theme.colors.surface}\r\n          ios_backgroundColor={theme.colors.border}\r\n        />\r\n      </View>\r\n    </View>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    padding: 16,\r\n  },\r\n  title: {\r\n    fontSize: 24,\r\n    fontWeight: '600',\r\n    color: theme.colors.text,\r\n    marginBottom: 24,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  inputGroup: {\r\n    marginBottom: 24,\r\n  },\r\n  label: {\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n    marginBottom: 8,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  input: {\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    borderRadius: 12,\r\n    padding: 16,\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n    backgroundColor: theme.colors.surface,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  textArea: {\r\n    height: 120,\r\n    textAlignVertical: 'top',\r\n  },\r\n  switchContainer: {\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 12,\r\n    padding: 16,\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    justifyContent: 'space-between',\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n  },\r\n  switchGroup: {\r\n    flex: 1,\r\n    marginRight: 16,\r\n  },\r\n  switchLabel: {\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    marginBottom: 4,\r\n  },\r\n  switchSubLabel: {\r\n    fontSize: 14,\r\n    color: theme.colors.placeHolderText,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  errorText: {\r\n    color: theme.colors.error,\r\n    fontSize: 14,\r\n    marginTop: 4,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  characterCount: {\r\n    color: theme.colors.textSecondary,\r\n    fontSize: 12,\r\n    marginTop: 4,\r\n    textAlign: 'right',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n});\r\n\r\nexport default ServiceDetailsStep; ","import React, { useState, useEffect } from 'react';\r\nimport {\r\n  View,\r\n  Text,\r\n  StyleSheet,\r\n  TextInput,\r\n  TouchableOpacity,\r\n  Switch,\r\n  ScrollView,\r\n  TouchableWithoutFeedback,\r\n  Modal\r\n} from 'react-native';\r\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\r\nimport { theme } from '../../styles/theme';\r\nimport { TIME_UNIT_MAPPING, BACKEND_TO_FRONTEND_TIME_UNIT } from '../../data/mockData';\r\nimport { debugLog } from '../../context/AuthContext';\r\n\r\nconst TIME_UNITS = Object.keys(TIME_UNIT_MAPPING);\r\nconst ANIMAL_THRESHOLDS = ['1', '2', '3', '4', '5'];\r\n\r\nconst RatesAndReviewStep = ({ serviceData, setServiceData, isUpdatingService, setIsUpdatingService, onProceedWithUpdate }) => {\r\n  // Debug log for tracking isOvernight status\r\n  debugLog('MBA5931', 'RatesAndReviewStep render - isOvernight status:', serviceData.isOvernight);\r\n  \r\n  const [showTimeUnitDropdown, setShowTimeUnitDropdown] = useState(false);\r\n  const [showThresholdDropdown, setShowThresholdDropdown] = useState(false);\r\n  const [customChargeVisible, setCustomChargeVisible] = useState(false);\r\n  const [isHolidayRatePercent, setIsHolidayRatePercent] = useState(true);\r\n  const [isEditingExistingRate, setIsEditingExistingRate] = useState(false);\r\n  const [showUnsavedRateWarning, setShowUnsavedRateWarning] = useState(false);\r\n  const [newCustomRate, setNewCustomRate] = useState({\r\n    title: '',\r\n    rate: '',\r\n    description: ''\r\n  });\r\n\r\n  // Filter available time units based on isOvernight flag\r\n  const availableTimeUnits = serviceData.isOvernight ? \r\n    ['Per Night'] : \r\n    TIME_UNITS;\r\n\r\n  // Check if we need to convert existing data on component mount\r\n  useEffect(() => {\r\n    // Initialize isPercent property based on the state\r\n    setServiceData(prev => ({\r\n      ...prev,\r\n      rates: {\r\n        ...prev.rates,\r\n        isPercent: isHolidayRatePercent\r\n      }\r\n    }));\r\n    \r\n    // If service is overnight, ensure the base_rate_unit is 'Per Night'\r\n    if (serviceData.isOvernight) {\r\n      debugLog('MBA5931', 'Service is overnight, setting rate unit to Per Night');\r\n      setServiceData(prev => ({\r\n        ...prev,\r\n        rates: {\r\n          ...prev.rates,\r\n          base_rate_unit: 'Per Night'\r\n        }\r\n      }));\r\n    }\r\n    // If we have a base_rate_unit from backend but it's not in our mapping, initialize with default\r\n    else if (serviceData.rates?.base_rate_unit && !BACKEND_TO_FRONTEND_TIME_UNIT[serviceData.rates.base_rate_unit]) {\r\n      debugLog('MBA5931', 'Converting initial base_rate_unit to mapped value');\r\n      const frontendKey = Object.keys(TIME_UNIT_MAPPING).find(\r\n        key => TIME_UNIT_MAPPING[key] === serviceData.rates.base_rate_unit\r\n      );\r\n      \r\n      if (!frontendKey && serviceData.rates.base_rate_unit) {\r\n        // If we don't have a mapping for this value, keep the backend value\r\n        debugLog('MBA5931', 'No mapping found for:', serviceData.rates.base_rate_unit);\r\n      }\r\n    }\r\n\r\n    // Check if existing holiday rate has a % sign\r\n    if (serviceData.rates?.holidayRate) {\r\n      const holidayRateString = serviceData.rates.holidayRate.toString();\r\n      if (holidayRateString.includes('%')) {\r\n        setIsHolidayRatePercent(true);\r\n        // Strip the % sign for the input field\r\n        setServiceData(prev => ({\r\n          ...prev,\r\n          rates: {\r\n            ...prev.rates,\r\n            holidayRate: holidayRateString.replace('%', ''),\r\n            isPercent: true\r\n          }\r\n        }));\r\n      } else if (holidayRateString.includes('$')) {\r\n        setIsHolidayRatePercent(false);\r\n        // Strip the $ sign for the input field\r\n        setServiceData(prev => ({\r\n          ...prev,\r\n          rates: {\r\n            ...prev.rates,\r\n            holidayRate: holidayRateString.replace('$', ''),\r\n            isPercent: false\r\n          }\r\n        }));\r\n      }\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    debugLog('MBA5931', 'Available TIME_UNITS:', TIME_UNITS);\r\n    debugLog('MBA5931', 'TIME_UNIT_MAPPING:', TIME_UNIT_MAPPING);\r\n    debugLog('MBA5931', 'Current base_rate_unit:', serviceData.rates?.base_rate_unit);\r\n    debugLog('MBA5931', 'Displayed unit text:', serviceData.rates?.base_rate_unit ? \r\n      (BACKEND_TO_FRONTEND_TIME_UNIT[serviceData.rates.base_rate_unit] || serviceData.rates.base_rate_unit) : \r\n      TIME_UNITS[0]);\r\n  }, [serviceData.rates?.base_rate_unit]);\r\n\r\n  // Watch for changes to isOvernight and update rate unit accordingly\r\n  useEffect(() => {\r\n    if (serviceData.isOvernight) {\r\n      debugLog('MBA5931', 'Overnight service detected, forcing Per Night rate unit');\r\n      setServiceData(prev => ({\r\n        ...prev,\r\n        rates: {\r\n          ...prev.rates,\r\n          base_rate_unit: 'Per Night'\r\n        }\r\n      }));\r\n    }\r\n  }, [serviceData.isOvernight]);\r\n\r\n  // Helper function to check if there's an unsaved custom rate\r\n  const hasUnsavedCustomRate = () => {\r\n    // If the custom rate form is open, we consider it as unsaved\r\n    // regardless of whether fields have content\r\n    const result = customChargeVisible;\r\n    \r\n    debugLog('MBAno34othg0v', 'hasUnsavedCustomRate check:', { \r\n      customChargeVisible, \r\n      title: newCustomRate.title,\r\n      rate: newCustomRate.rate,\r\n      description: newCustomRate.description,\r\n      result \r\n    });\r\n    \r\n    return result;\r\n  };\r\n\r\n  // Add effect to check if trying to update service while custom rate is being added\r\n  useEffect(() => {\r\n    debugLog('MBAno34othg0v', 'isUpdatingService changed:', {\r\n      isUpdatingService,\r\n      hasUnsaved: hasUnsavedCustomRate()\r\n    });\r\n    \r\n    if (!isUpdatingService) {\r\n      // Skip processing when isUpdatingService becomes false\r\n      return;\r\n    }\r\n    \r\n    // Check if there's an unsaved rate\r\n    const hasUnsaved = hasUnsavedCustomRate();\r\n    \r\n    // Only show warning if isUpdatingService becomes true while there's an unsaved rate\r\n    if (hasUnsaved) {\r\n      debugLog('MBAno34othg0v', 'Showing unsaved rate warning modal');\r\n      // Show the modal\r\n      setShowUnsavedRateWarning(true);\r\n      // Reset the isUpdatingService flag after showing the modal\r\n      if (setIsUpdatingService) {\r\n        debugLog('MBAno34othg0v', 'Setting isUpdatingService to FALSE to prevent API call');\r\n        setIsUpdatingService(false);\r\n      }\r\n    } else {\r\n      debugLog('MBAno34othg0v', 'No unsaved custom rate, allowing update to proceed');\r\n      // Here we would directly call the API, but we need to add that functionality to props\r\n      if (setIsUpdatingService) {\r\n        // Signal to parent that it's OK to proceed\r\n        debugLog('MBAno34othg0v', 'Setting isUpdatingService to TRUE to allow parent to call API');\r\n        setIsUpdatingService(true);\r\n        \r\n        // This will trigger the parent component to call its callServiceApi function\r\n        if (typeof onProceedWithUpdate === 'function') {\r\n          debugLog('MBAno34othg0v', 'Calling onProceedWithUpdate directly');\r\n          onProceedWithUpdate();\r\n        }\r\n      }\r\n    }\r\n  }, [isUpdatingService]);\r\n\r\n  // Close dropdowns when clicking outside\r\n  const handlePressOutside = () => {\r\n    if (showTimeUnitDropdown) setShowTimeUnitDropdown(false);\r\n    if (showThresholdDropdown) setShowThresholdDropdown(false);\r\n  };\r\n\r\n  const formatNumericInput = (text) => {\r\n    // Remove any non-numeric characters except decimal point\r\n    let numericValue = text.replace(/[^0-9.]/g, '');\r\n    \r\n    // Ensure only one decimal point\r\n    const parts = numericValue.split('.');\r\n    if (parts.length > 2) {\r\n      numericValue = parts[0] + '.' + parts.slice(1).join('');\r\n    }\r\n    \r\n    // Limit to 2 decimal places\r\n    if (parts[1]?.length > 2) {\r\n      numericValue = parts[0] + '.' + parts[1].slice(0, 2);\r\n    }\r\n\r\n    return numericValue;\r\n  };\r\n\r\n  const handleBaseRateChange = (text) => {\r\n    const numericValue = formatNumericInput(text);\r\n    setServiceData(prev => ({\r\n      ...prev,\r\n      rates: {\r\n        ...prev.rates,\r\n        base_rate: numericValue\r\n      }\r\n    }));\r\n  };\r\n\r\n  const handleTimeUnitSelect = (unit) => {\r\n    // If this is an overnight service, always use 'Per Night'\r\n    // Otherwise, map the user-friendly display value to the backend value\r\n    const selectedUnit = serviceData.isOvernight ? \r\n      'Per Night' : \r\n      TIME_UNIT_MAPPING[unit];\r\n    \r\n    setServiceData(prev => ({\r\n      ...prev,\r\n      rates: {\r\n        ...prev.rates,\r\n        base_rate_unit: selectedUnit\r\n      }\r\n    }));\r\n    setShowTimeUnitDropdown(false);\r\n  };\r\n\r\n  const handleAdditionalAnimalRateChange = (text) => {\r\n    const numericValue = formatNumericInput(text);\r\n    setServiceData(prev => ({\r\n      ...prev,\r\n      rates: {\r\n        ...prev.rates,\r\n        additionalAnimalRate: numericValue\r\n      }\r\n    }));\r\n  };\r\n\r\n  const handleThresholdSelect = (threshold) => {\r\n    setServiceData(prev => ({\r\n      ...prev,\r\n      rates: {\r\n        ...prev.rates,\r\n        additionalAnimalThreshold: threshold\r\n      }\r\n    }));\r\n    setShowThresholdDropdown(false);\r\n  };\r\n\r\n  const handleHolidayRateChange = (text) => {\r\n    const numericValue = formatNumericInput(text);\r\n    setServiceData(prev => ({\r\n      ...prev,\r\n      rates: {\r\n        ...prev.rates,\r\n        holidayRate: numericValue\r\n      }\r\n    }));\r\n  };\r\n\r\n  const toggleHolidayRateType = (isPercent) => {\r\n    setIsHolidayRatePercent(isPercent);\r\n    // Update the serviceData with the new holiday rate type\r\n    setServiceData(prevData => ({\r\n      ...prevData,\r\n      rates: {\r\n        ...prevData.rates,\r\n        isPercent: isPercent\r\n      }\r\n    }));\r\n  };\r\n\r\n  // Calculate the dollar amount for percentage holiday rate\r\n  const calculateHolidayRateDollarValue = () => {\r\n    const baseRate = parseFloat(serviceData.rates?.base_rate) || 0;\r\n    const holidayRatePercent = parseFloat(serviceData.rates?.holidayRate) || 0;\r\n    \r\n    if (baseRate > 0 && holidayRatePercent > 0) {\r\n      const dollarValue = (baseRate * holidayRatePercent / 100).toFixed(2);\r\n      return `$${dollarValue}`;\r\n    }\r\n    return null;\r\n  };\r\n\r\n  // Format holiday rate based on type (% or $)\r\n  const getFormattedHolidayRate = () => {\r\n    const value = serviceData.rates?.holidayRate || '';\r\n    if (!value) return '';\r\n    \r\n    return isHolidayRatePercent ? `${value}%` : `$${value}`;\r\n  };\r\n\r\n  const handleCustomRateChange = (field, value) => {\r\n    if (field === 'rate') {\r\n      value = formatNumericInput(value);\r\n    }\r\n    setNewCustomRate(prev => ({\r\n      ...prev,\r\n      [field]: value\r\n    }));\r\n  };\r\n\r\n  const handleAddCustomRate = () => {\r\n    if (!customChargeVisible) {\r\n      debugLog('MBAno34othg0v', 'Opening custom rate form');\r\n      setCustomChargeVisible(true);\r\n      setIsEditingExistingRate(false);\r\n      return;\r\n    }\r\n\r\n    // Check for title\r\n    if (!newCustomRate.title.trim()) {\r\n      debugLog('MBAno34othg0v', 'Missing custom rate title');\r\n      return;\r\n    }\r\n    \r\n    // Check for rate value\r\n    if (!newCustomRate.rate) {\r\n      debugLog('MBAno34othg0v', 'Missing custom rate value');\r\n      return;\r\n    }\r\n\r\n    // Validate rate value\r\n    const rateValue = parseFloat(newCustomRate.rate);\r\n    if (isNaN(rateValue) || rateValue <= 0) {\r\n      debugLog('MBAno34othg0v', 'Invalid rate value:', newCustomRate.rate);\r\n      return;\r\n    }\r\n\r\n    debugLog('MBAno34othg0v', 'Saving custom rate successfully:', newCustomRate);\r\n    \r\n    // Save the custom rate to the service data\r\n    setServiceData(prev => ({\r\n      ...prev,\r\n      additionalRates: [...(prev.additionalRates || []), newCustomRate]\r\n    }));\r\n    \r\n    // Reset the form state\r\n    setNewCustomRate({\r\n      title: '',\r\n      rate: '',\r\n      description: ''\r\n    });\r\n    \r\n    // Close the form\r\n    setCustomChargeVisible(false);\r\n    setIsEditingExistingRate(false);\r\n  };\r\n\r\n  const handleEditCustomRate = (index) => {\r\n    // Get the rate to edit\r\n    const rateToEdit = serviceData.additionalRates[index];\r\n    \r\n    // Set the form with existing values\r\n    setNewCustomRate({\r\n      title: rateToEdit.title,\r\n      rate: rateToEdit.rate,\r\n      description: rateToEdit.description || ''\r\n    });\r\n    \r\n    // Show the custom charge form and indicate we're editing\r\n    setCustomChargeVisible(true);\r\n    setIsEditingExistingRate(true);\r\n    \r\n    // Remove the old item\r\n    setServiceData(prev => ({\r\n      ...prev,\r\n      additionalRates: prev.additionalRates.filter((_, i) => i !== index)\r\n    }));\r\n  };\r\n\r\n  const handleDeleteCustomRate = (index) => {\r\n    setServiceData(prev => ({\r\n      ...prev,\r\n      additionalRates: prev.additionalRates.filter((_, i) => i !== index)\r\n    }));\r\n  };\r\n\r\n  const renderDropdown = (options, selectedValue, onSelect, visible, containerStyle) => {\r\n    if (!visible) return null;\r\n\r\n    return (\r\n      <View style={[styles.dropdownContainer, containerStyle]}>\r\n        <ScrollView style={styles.dropdownScroll} contentContainerStyle={styles.dropdownScrollContent}>\r\n          {options.map((option) => (\r\n            <TouchableOpacity\r\n              key={option}\r\n              style={[\r\n                styles.dropdownItem,\r\n                selectedValue === option && styles.selectedDropdownItem\r\n              ]}\r\n              onPress={() => onSelect(option)}\r\n            >\r\n              <Text style={[\r\n                styles.dropdownText,\r\n                selectedValue === option && styles.selectedDropdownText\r\n              ]}>\r\n                {option}\r\n              </Text>\r\n            </TouchableOpacity>\r\n          ))}\r\n        </ScrollView>\r\n      </View>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <TouchableWithoutFeedback onPress={handlePressOutside}>\r\n      <ScrollView style={styles.container}>\r\n        <Text style={styles.title}>Set Your Rates</Text>\r\n\r\n        {/* Error Modal */}\r\n        <Modal\r\n          visible={showUnsavedRateWarning}\r\n          transparent={true}\r\n          animationType=\"fade\"\r\n          onRequestClose={() => setShowUnsavedRateWarning(false)}\r\n        >\r\n          <View style={styles.modalOverlay}>\r\n            <View style={styles.modalContent}>\r\n              <MaterialCommunityIcons\r\n                name=\"alert-circle\"\r\n                size={48}\r\n                color={theme.colors.error}\r\n                style={styles.modalIcon}\r\n              />\r\n              <Text style={styles.modalTitle}>Unsaved Custom Rate</Text>\r\n              <Text style={styles.modalText}>\r\n                Please save or cancel your custom rate before updating the service.\r\n              </Text>\r\n              <TouchableOpacity\r\n                style={styles.modalButton}\r\n                onPress={() => {\r\n                  debugLog('MBAno34othg0v', 'Modal OK button clicked');\r\n                  // Just close the modal, keep the form open for editing\r\n                  setShowUnsavedRateWarning(false);\r\n                }}\r\n              >\r\n                <Text style={styles.modalButtonText}>OK</Text>\r\n              </TouchableOpacity>\r\n            </View>\r\n          </View>\r\n        </Modal>\r\n\r\n        <View style={[styles.rateContainer, { zIndex: 3 }]}>\r\n          <Text style={styles.label}>Base Rate <Text style={{ color: theme.colors.placeHolderText }}>(Required)</Text></Text>\r\n          <View style={styles.rateInputGroup}>\r\n            <View style={[styles.currencyInputContainer, { flex: 1 }]}>\r\n              <Text style={styles.currencySymbol}>$</Text>\r\n              <TextInput\r\n                style={styles.currencyInput}\r\n                placeholder=\"0.00\"\r\n                keyboardType=\"decimal-pad\"\r\n                value={serviceData.rates?.base_rate || ''}\r\n                onChangeText={handleBaseRateChange}\r\n                placeholderTextColor={theme.colors.placeHolderText}\r\n              />\r\n            </View>\r\n            <View style={{ flex: 1, zIndex: 1 }}>\r\n              <TouchableOpacity\r\n                style={[\r\n                  styles.unitSelector,\r\n                  serviceData.isOvernight && styles.disabledUnitSelector\r\n                ]}\r\n                onPress={() => {\r\n                  if (!serviceData.isOvernight) {\r\n                    setShowThresholdDropdown(false);\r\n                    setShowTimeUnitDropdown(!showTimeUnitDropdown);\r\n                  }\r\n                }}\r\n                disabled={serviceData.isOvernight}\r\n              >\r\n                <Text style={styles.unitText}>\r\n                  {serviceData.isOvernight ? \r\n                    'Per Night' : \r\n                    (serviceData.rates?.base_rate_unit ? \r\n                      (BACKEND_TO_FRONTEND_TIME_UNIT[serviceData.rates.base_rate_unit] || serviceData.rates.base_rate_unit) : \r\n                      TIME_UNITS[0])}\r\n                </Text>\r\n                {!serviceData.isOvernight && (\r\n                  <MaterialCommunityIcons\r\n                    name={showTimeUnitDropdown ? 'chevron-up' : 'chevron-down'}\r\n                    size={24}\r\n                    color={theme.colors.text}\r\n                  />\r\n                )}\r\n              </TouchableOpacity>\r\n              {renderDropdown(\r\n                availableTimeUnits,\r\n                serviceData.rates?.base_rate_unit,\r\n                handleTimeUnitSelect,\r\n                showTimeUnitDropdown && !serviceData.isOvernight,\r\n                { width: '100%' }\r\n              )}\r\n            </View>\r\n          </View>\r\n        </View>\r\n\r\n        <View style={[styles.rateContainer, { zIndex: 2 }]}>\r\n          <Text style={styles.label}>Additional Animal Rate <Text style={{ color: theme.colors.placeHolderText }}>(Optional)</Text></Text>\r\n          <View style={styles.rateInputGroup}>\r\n            <View style={[styles.currencyInputContainer, { flex: 1 }]}>\r\n              <Text style={styles.currencySymbol}>$</Text>\r\n              <TextInput\r\n                style={styles.currencyInput}\r\n                placeholder=\"0.00\"\r\n                keyboardType=\"decimal-pad\"\r\n                value={serviceData.rates?.additionalAnimalRate || ''}\r\n                onChangeText={handleAdditionalAnimalRateChange}\r\n                placeholderTextColor={theme.colors.placeHolderText}\r\n              />\r\n            </View>\r\n            <View style={{ flex: 1, zIndex: 1 }}>\r\n              <TouchableOpacity\r\n                style={styles.unitSelector}\r\n                onPress={() => {\r\n                  setShowTimeUnitDropdown(false);\r\n                  setShowThresholdDropdown(!showThresholdDropdown);\r\n                }}\r\n              >\r\n                <Text style={styles.unitText}>\r\n                  After {serviceData.rates?.additionalAnimalThreshold || '1'} animals\r\n                </Text>\r\n                <MaterialCommunityIcons\r\n                  name={showThresholdDropdown ? 'chevron-up' : 'chevron-down'}\r\n                  size={24}\r\n                  color={theme.colors.text}\r\n                />\r\n              </TouchableOpacity>\r\n              {renderDropdown(\r\n                ANIMAL_THRESHOLDS,\r\n                serviceData.rates?.additionalAnimalThreshold,\r\n                handleThresholdSelect,\r\n                showThresholdDropdown,\r\n                { width: '100%' }\r\n              )}\r\n            </View>\r\n          </View>\r\n        </View>\r\n\r\n        <View style={styles.holidayRateContainer}>\r\n          <View style={styles.holidayRateHeader}>\r\n            <Text style={styles.label}>Holiday Rate <Text style={{ color: theme.colors.placeHolderText }}>(Optional)</Text></Text>\r\n            <View style={styles.rateTypeToggleContainer}>\r\n              <TouchableOpacity\r\n                style={[\r\n                  styles.toggleButton,\r\n                  isHolidayRatePercent ? styles.activeToggleButton : styles.inactiveToggleButton,\r\n                  {\r\n                    borderTopLeftRadius: 8,\r\n                    borderBottomLeftRadius: 8,\r\n                    borderTopRightRadius: 0,\r\n                    borderBottomRightRadius: 0\r\n                  }\r\n                ]}\r\n                onPress={() => toggleHolidayRateType(true)}\r\n              >\r\n                <Text style={[\r\n                  styles.toggleButtonText,\r\n                  isHolidayRatePercent ? styles.activeToggleText : styles.inactiveToggleText\r\n                ]}>%</Text>\r\n              </TouchableOpacity>\r\n              <TouchableOpacity\r\n                style={[\r\n                  styles.toggleButton,\r\n                  !isHolidayRatePercent ? styles.activeToggleButton : styles.inactiveToggleButton,\r\n                  {\r\n                    borderTopLeftRadius: 0,\r\n                    borderBottomLeftRadius: 0,\r\n                    borderTopRightRadius: 8,\r\n                    borderBottomRightRadius: 8\r\n                  }\r\n                ]}\r\n                onPress={() => toggleHolidayRateType(false)}\r\n              >\r\n                <Text style={[\r\n                  styles.toggleButtonText,\r\n                  !isHolidayRatePercent ? styles.activeToggleText : styles.inactiveToggleText\r\n                ]}>$</Text>\r\n              </TouchableOpacity>\r\n            </View>\r\n          </View>\r\n          <View style={[\r\n            styles.holidayRateInputWrapper, \r\n            { marginBottom: isHolidayRatePercent && serviceData.rates?.base_rate && serviceData.rates?.holidayRate ? 28 : 0 }\r\n          ]}>\r\n            <View style={isHolidayRatePercent ? styles.percentageInputContainer : styles.currencyInputContainer}>\r\n              {!isHolidayRatePercent && <Text style={styles.currencySymbol}>$</Text>}\r\n              <TextInput\r\n                style={styles.currencyInput}\r\n                placeholder=\"0\"\r\n                keyboardType=\"decimal-pad\"\r\n                value={serviceData.rates?.holidayRate === '0' ? '' : serviceData.rates?.holidayRate}\r\n                onChangeText={handleHolidayRateChange}\r\n                placeholderTextColor={theme.colors.placeHolderText}\r\n              />\r\n              {isHolidayRatePercent && <Text style={styles.percentageSymbol}>%</Text>}\r\n            </View>\r\n            {isHolidayRatePercent && serviceData.rates?.base_rate && serviceData.rates?.holidayRate && (\r\n              <Text style={styles.calculatedHolidayRate}>\r\n                {calculateHolidayRateDollarValue()}\r\n              </Text>\r\n            )}\r\n          </View>\r\n        </View>\r\n\r\n        <View style={styles.customRatesContainer}>\r\n          <Text style={styles.label}>Custom Charges <Text style={{ color: theme.colors.placeHolderText }}>(Optional)</Text></Text>\r\n          {serviceData.additionalRates?.length > 0 ? (\r\n            serviceData.additionalRates.map((rate, index) => (\r\n              <View key={index} style={styles.customRateItem}>\r\n                <View style={styles.customRateContent}>\r\n                  <View style={styles.customRateTitleContainer}>\r\n                    <Text style={styles.customRateTitle}>{rate.title}</Text>\r\n                    {rate.description ? (\r\n                      <Text style={styles.customRateDescription} numberOfLines={1}>\r\n                        {rate.description}\r\n                      </Text>\r\n                    ) : null}\r\n                  </View>\r\n                  <Text style={styles.customRateAmount}>${rate.rate}</Text>\r\n                </View>\r\n                <View style={styles.customRateActions}>\r\n                  <TouchableOpacity\r\n                    onPress={() => handleEditCustomRate(index)}\r\n                    style={styles.customRateAction}\r\n                    activeOpacity={0.7}\r\n                  >\r\n                    <MaterialCommunityIcons\r\n                      name=\"pencil\"\r\n                      size={20}\r\n                      color={theme.colors.mainColors.main}\r\n                    />\r\n                  </TouchableOpacity>\r\n                  <TouchableOpacity\r\n                    onPress={() => handleDeleteCustomRate(index)}\r\n                    style={styles.customRateAction}\r\n                    activeOpacity={0.7}\r\n                  >\r\n                    <MaterialCommunityIcons\r\n                      name=\"delete\"\r\n                      size={20}\r\n                      color=\"#F26969\"\r\n                    />\r\n                  </TouchableOpacity>\r\n                </View>\r\n              </View>\r\n            ))\r\n          ) : customChargeVisible ? null : (\r\n            <Text style={styles.noCustomRatesText}>\r\n              No custom charges added yet. Use the button below to add one.\r\n            </Text>\r\n          )}\r\n          \r\n          {/* Custom charge form or Add button */}\r\n          {customChargeVisible ? (\r\n            <View style={styles.newCustomRateContainer}>\r\n              <Text style={styles.customRateFormHeading}>\r\n                {isEditingExistingRate ? 'Edit Custom Rate' : 'New Custom Rate'}\r\n              </Text>\r\n              <TextInput\r\n                style={styles.customRateInput}\r\n                placeholder=\"Charge Title\"\r\n                value={newCustomRate.title}\r\n                onChangeText={(text) => handleCustomRateChange('title', text)}\r\n                placeholderTextColor={theme.colors.placeHolderText}\r\n              />\r\n              <View style={styles.currencyInputContainer}>\r\n                <Text style={styles.currencySymbol}>$</Text>\r\n                <TextInput\r\n                  style={styles.currencyInput}\r\n                  placeholder=\"0.00\"\r\n                  keyboardType=\"decimal-pad\"\r\n                  value={newCustomRate.rate}\r\n                  onChangeText={(text) => handleCustomRateChange('rate', text)}\r\n                  placeholderTextColor={theme.colors.placeHolderText}\r\n                />\r\n              </View>\r\n              <TextInput\r\n                style={[styles.customRateInput, styles.textArea]}\r\n                placeholder=\"Description\"\r\n                value={newCustomRate.description}\r\n                onChangeText={(text) => handleCustomRateChange('description', text)}\r\n                placeholderTextColor={theme.colors.placeHolderText}\r\n                multiline={true}\r\n                numberOfLines={3}\r\n              />\r\n              <View style={styles.customRateButtonContainer}>\r\n                <TouchableOpacity\r\n                  style={styles.cancelRateButton}\r\n                  onPress={() => {\r\n                    debugLog('MBAno34othg0v', 'Cancel button pressed for custom rate form');\r\n                    // Reset all form-related state\r\n                    setCustomChargeVisible(false);\r\n                    setNewCustomRate({\r\n                      title: '',\r\n                      rate: '',\r\n                      description: ''\r\n                    });\r\n                    setIsEditingExistingRate(false);\r\n                    // Ensure any warning modal is also closed\r\n                    setShowUnsavedRateWarning(false);\r\n                  }}\r\n                >\r\n                  <MaterialCommunityIcons\r\n                    name=\"close\"\r\n                    size={20}\r\n                    color={theme.colors.text}\r\n                  />\r\n                  <Text style={styles.cancelRateText}>Cancel</Text>\r\n                </TouchableOpacity>\r\n                <TouchableOpacity\r\n                  style={[\r\n                    styles.addRateButton, \r\n                    styles.saveRateButton,\r\n                    (!newCustomRate.title.trim() || !newCustomRate.rate || \r\n                      isNaN(parseFloat(newCustomRate.rate)) || parseFloat(newCustomRate.rate) <= 0) \r\n                      ? styles.disabledSaveButton : {}\r\n                  ]}\r\n                  onPress={handleAddCustomRate}\r\n                  disabled={!newCustomRate.title.trim() || !newCustomRate.rate || \r\n                    isNaN(parseFloat(newCustomRate.rate)) || parseFloat(newCustomRate.rate) <= 0}\r\n                >\r\n                  <MaterialCommunityIcons\r\n                    name=\"content-save\"\r\n                    size={20}\r\n                    color={theme.colors.surface}\r\n                  />\r\n                  <Text style={styles.saveRateText}>\r\n                    {isEditingExistingRate ? 'Update Custom Rate' : 'Save Custom Rate'}\r\n                  </Text>\r\n                </TouchableOpacity>\r\n              </View>\r\n            </View>\r\n          ) : (\r\n            <TouchableOpacity\r\n              style={styles.addRateButton}\r\n              onPress={handleAddCustomRate}\r\n            >\r\n              <MaterialCommunityIcons\r\n                name=\"plus\"\r\n                size={20}\r\n                color={theme.colors.mainColors.main}\r\n              />\r\n              <Text style={styles.addRateText}>Add Rate</Text>\r\n            </TouchableOpacity>\r\n          )}\r\n        </View>\r\n      </ScrollView>\r\n    </TouchableWithoutFeedback>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    padding: 16,\r\n  },\r\n  title: {\r\n    fontSize: 24,\r\n    fontWeight: '600',\r\n    color: theme.colors.text,\r\n    marginBottom: 24,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  rateContainer: {\r\n    marginBottom: 24,\r\n  },\r\n  label: {\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n    marginBottom: 8,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  rateInputGroup: {\r\n    flexDirection: 'row',\r\n    gap: 12,\r\n  },\r\n  currencyInputContainer: {\r\n    flex: 1,\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    borderRadius: 8,\r\n    paddingHorizontal: 12,\r\n    backgroundColor: theme.colors.surface,\r\n  },\r\n  currencySymbol: {\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n    marginRight: 4,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  currencyInput: {\r\n    flex: 1,\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n    padding: 12,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    outlineStyle: 'none',\r\n  },\r\n  unitSelector: {\r\n    flex: 1,\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    justifyContent: 'space-between',\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    borderRadius: 8,\r\n    paddingHorizontal: 12,\r\n    paddingVertical: 12,\r\n    backgroundColor: theme.colors.surface,\r\n  },\r\n  unitText: {\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  dropdownContainer: {\r\n    position: 'absolute',\r\n    top: '100%',\r\n    backgroundColor: theme.colors.surface,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    borderRadius: 8,\r\n    marginTop: 4,\r\n    zIndex: 1000,\r\n    elevation: 5,\r\n    shadowColor: '#000',\r\n    shadowOffset: { width: 0, height: 2 },\r\n    shadowOpacity: 0.25,\r\n    shadowRadius: 3.84,\r\n    maxHeight: 200,\r\n  },\r\n  dropdownScroll: {\r\n    width: '100%',\r\n  },\r\n  dropdownScrollContent: {\r\n    flexGrow: 1,\r\n  },\r\n  dropdownItem: {\r\n    padding: 12,\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: theme.colors.border,\r\n  },\r\n  selectedDropdownItem: {\r\n    backgroundColor: theme.colors.mainColors.mainLight,\r\n  },\r\n  dropdownText: {\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  selectedDropdownText: {\r\n    color: theme.colors.mainColors.main,\r\n    fontWeight: '600',\r\n  },\r\n  holidayRateContainer: {\r\n    marginBottom: 24,\r\n  },\r\n  holidayRateHeader: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    marginBottom: 8,\r\n  },\r\n  rateTypeToggleContainer: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    overflow: 'hidden',\r\n    borderRadius: 8,\r\n  },\r\n  toggleButton: {\r\n    paddingVertical: 8,\r\n    paddingHorizontal: 14,\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    minWidth: 40,\r\n    width: 44,\r\n    height: 36,\r\n  },\r\n  activeToggleButton: {\r\n    backgroundColor: theme.colors.mainColors.main,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.mainColors.main,\r\n  },\r\n  inactiveToggleButton: {\r\n    backgroundColor: theme.colors.surface,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n  },\r\n  toggleButtonText: {\r\n    fontSize: 16,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    fontWeight: '500',\r\n  },\r\n  activeToggleText: {\r\n    color: theme.colors.surface,\r\n    fontWeight: '600',\r\n  },\r\n  inactiveToggleText: {\r\n    color: theme.colors.text,\r\n  },\r\n  holidayRateInputWrapper: {\r\n    position: 'relative',\r\n  },\r\n  percentageInputContainer: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    borderRadius: 8,\r\n    paddingHorizontal: 12,\r\n    backgroundColor: theme.colors.surface,\r\n  },\r\n  percentageInput: {\r\n    flex: 1,\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n    padding: 12,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    outlineStyle: 'none',\r\n  },\r\n  percentageSymbol: {\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n    marginRight: 8,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  calculatedHolidayRate: {\r\n    position: 'absolute',\r\n    bottom: -24,\r\n    right: 4,\r\n    fontSize: 14,\r\n    color: theme.colors.placeHolderText,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    paddingTop: 4,\r\n  },\r\n  customRatesContainer: {\r\n    // marginTop: 24,\r\n  },\r\n  customRateItem: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    justifyContent: 'space-between',\r\n    padding: 12,\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 8,\r\n    marginBottom: 8,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n  },\r\n  customRateContent: {\r\n    flex: 1,\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    marginRight: 12,\r\n  },\r\n  customRateActions: {\r\n    flexDirection: 'row',\r\n    gap: 8,\r\n  },\r\n  customRateTitleContainer: {\r\n    flex: 1,\r\n    marginRight: 16,\r\n  },\r\n  customRateTitle: {\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  customRateDescription: {\r\n    fontSize: 14,\r\n    color: theme.colors.placeHolderText,\r\n    marginTop: 2,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  customRateAmount: {\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n    fontWeight: '600',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  newCustomRateContainer: {\r\n    gap: 12,\r\n    marginBottom: 16,\r\n  },\r\n  customRateInput: {\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    borderRadius: 8,\r\n    padding: 12,\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n    backgroundColor: theme.colors.surface,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    outlineStyle: 'none',\r\n  },\r\n  textArea: {\r\n    height: 80,\r\n    textAlignVertical: 'top',\r\n  },\r\n  addRateButton: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    gap: 8,\r\n    padding: 12,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.mainColors.main,\r\n    borderRadius: 8,\r\n    justifyContent: 'center',\r\n  },\r\n  addRateText: {\r\n    color: theme.colors.mainColors.main,\r\n    fontSize: 16,\r\n    fontWeight: '600',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  customRateButtonContainer: {\r\n    flexDirection: 'row',\r\n    gap: 12,\r\n    marginTop: 12,\r\n  },\r\n  cancelRateButton: {\r\n    flex: 1,\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    gap: 8,\r\n    padding: 12,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    borderRadius: 8,\r\n    justifyContent: 'center',\r\n    backgroundColor: theme.colors.surface,\r\n  },\r\n  cancelRateText: {\r\n    color: theme.colors.text,\r\n    fontSize: 16,\r\n    fontWeight: '500',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  saveRateButton: {\r\n    flex: 2,\r\n    backgroundColor: theme.colors.mainColors.main,\r\n    borderColor: theme.colors.mainColors.main,\r\n  },\r\n  disabledSaveButton: {\r\n    backgroundColor: theme.colors.placeHolderText,\r\n    borderColor: theme.colors.placeHolderText,\r\n  },\r\n  saveRateText: {\r\n    color: theme.colors.surface,\r\n    fontSize: 16,\r\n    fontWeight: '600',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  customRateFormHeading: {\r\n    fontSize: 16,\r\n    fontWeight: '600',\r\n    color: theme.colors.text,\r\n    marginBottom: 12,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  noCustomRatesText: {\r\n    fontSize: 14,\r\n    color: theme.colors.placeHolderText,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    marginBottom: 16,\r\n    fontStyle: 'italic',\r\n  },\r\n  customRateAction: {\r\n    padding: 8,\r\n    borderRadius: 4,\r\n  },\r\n  modalOverlay: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    backgroundColor: 'rgba(0, 0, 0, 0.5)',\r\n  },\r\n  modalContent: {\r\n    backgroundColor: theme.colors.surface,\r\n    padding: 24,\r\n    borderRadius: 12,\r\n    maxWidth: '85%',\r\n    minWidth: 280,\r\n    alignItems: 'center',\r\n    shadowColor: '#000',\r\n    shadowOffset: { width: 0, height: 2 },\r\n    shadowOpacity: 0.25,\r\n    shadowRadius: 3.84,\r\n    elevation: 5,\r\n  },\r\n  modalIcon: {\r\n    marginBottom: 16,\r\n  },\r\n  modalTitle: {\r\n    fontSize: 20,\r\n    fontWeight: '600',\r\n    color: theme.colors.text,\r\n    marginBottom: 12,\r\n    textAlign: 'center',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  modalText: {\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    marginBottom: 24,\r\n    textAlign: 'center',\r\n    lineHeight: 22,\r\n  },\r\n  modalButton: {\r\n    backgroundColor: theme.colors.mainColors.main,\r\n    paddingVertical: 12,\r\n    paddingHorizontal: 24,\r\n    borderRadius: 8,\r\n  },\r\n  modalButtonText: {\r\n    color: theme.colors.surface,\r\n    fontSize: 16,\r\n    fontWeight: '600',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    textAlign: 'center',\r\n  },\r\n  disabledUnitSelector: {\r\n    backgroundColor: theme.colors.surface,\r\n    opacity: 0.8,\r\n    borderColor: theme.colors.modernBorder,\r\n  },\r\n});\r\n\r\nexport default RatesAndReviewStep; ","import React, { useState, useContext, useEffect } from 'react';\r\nimport {\r\n  View,\r\n  Text,\r\n  StyleSheet,\r\n  TouchableOpacity,\r\n  Modal,\r\n  SafeAreaView,\r\n  Platform,\r\n  ScrollView,\r\n  ActivityIndicator\r\n} from 'react-native';\r\nimport { theme } from '../styles/theme';\r\nimport { AuthContext } from '../context/AuthContext';\r\nimport StepProgressIndicator from './common/StepProgressIndicator';\r\nimport { debugLog } from '../context/AuthContext';\r\nimport CategorySelectionStep from './serviceCreation/CategorySelectionStep';\r\nimport ServiceDetailsStep from './serviceCreation/ServiceDetailsStep';\r\nimport RatesAndReviewStep from './serviceCreation/RatesAndReviewStep';\r\nimport { createService, updateService } from '../api/API';\r\nimport { useToast } from './ToastProvider';\r\n\r\nconst STEPS = {\r\n  CATEGORY_SELECTION: {\r\n    id: 0,\r\n    name: 'Categories & Types'\r\n  },\r\n  SERVICE_DETAILS: {\r\n    id: 1,\r\n    name: 'Service Details'\r\n  },\r\n  RATES_AND_REVIEW: {\r\n    id: 2,\r\n    name: 'Rates & Review'\r\n  }\r\n};\r\n\r\n// Import the hardcoded animal categories directly\r\nconst ANIMAL_CATEGORIES = {\r\n  // Farm animals\r\n  'Horse': 'Farm Animals',\r\n  'Cow': 'Farm Animals',\r\n  'Sheep': 'Farm Animals',\r\n  'Goat': 'Farm Animals',\r\n  'Pig': 'Farm Animals',\r\n  \r\n  // Domestic\r\n  'Dogs': 'Domestic',\r\n  'Cats': 'Domestic',\r\n  'Birds': 'Domestic',\r\n  'Rabbits': 'Domestic',\r\n  'Hamsters': 'Domestic',\r\n  \r\n  // Reptiles\r\n  'Snake': 'Reptiles',\r\n  'Lizard': 'Reptiles',\r\n  'Turtle': 'Reptiles',\r\n  'Gecko': 'Reptiles',\r\n  'Chameleon': 'Reptiles',\r\n  \r\n  // Aquatic\r\n  'Fish': 'Aquatic',\r\n  'Frog': 'Aquatic',\r\n  'Newt': 'Aquatic',\r\n  'Axolotl': 'Aquatic',\r\n  \r\n  // Invertebrates\r\n  'Spider': 'Invertebrates',\r\n  'Scorpion': 'Invertebrates',\r\n  'Crab': 'Invertebrates',\r\n  'Snail': 'Invertebrates',\r\n  'Millipede': 'Invertebrates'\r\n};\r\n\r\n// Also define GENERAL_CATEGORIES so we can look up category IDs from names\r\nconst GENERAL_CATEGORIES = [\r\n  {\r\n    id: 'all',\r\n    name: 'All',\r\n    icon: 'paw-outline',\r\n  },\r\n  {\r\n    id: 'farm_animals',\r\n    name: 'Farm Animals',\r\n    icon: 'horse',\r\n  },\r\n  {\r\n    id: 'domestic',\r\n    name: 'Domestic',\r\n    icon: 'paw',\r\n  },\r\n  {\r\n    id: 'reptiles',\r\n    name: 'Reptiles',\r\n    icon: 'snake',\r\n  },\r\n  {\r\n    id: 'aquatic',\r\n    name: 'Aquatic',\r\n    icon: 'fish',\r\n  },\r\n  {\r\n    id: 'invertebrates',\r\n    name: 'Invertebrates',\r\n    icon: 'spider',\r\n  }\r\n];\r\n\r\nconst ServiceCreationModal = ({ \r\n  visible, \r\n  onClose,\r\n  onSave,\r\n  initialService = null,\r\n  setHasUnsavedChanges \r\n}) => {\r\n  const { is_DEBUG } = useContext(AuthContext);\r\n  const [currentStep, setCurrentStep] = useState(STEPS.CATEGORY_SELECTION.id);\r\n  const [serviceData, setServiceData] = useState({\r\n    generalCategories: [],\r\n    animalTypes: [],\r\n    serviceName: '',\r\n    serviceDescription: '',\r\n    isOvernight: false,\r\n    rates: {\r\n      base_rate: '',\r\n      base_rate_unit: 'Per Visit',\r\n      additionalAnimalRate: '',\r\n      additionalAnimalThreshold: '1',\r\n      hasHolidayRate: false,\r\n      holidayRate: '0',\r\n      isPercent: true\r\n    },\r\n    additionalRates: []\r\n  });\r\n  const [error, setError] = useState(null);\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  const [isEditMode, setIsEditMode] = useState(false);\r\n  const [isAddingCustomRate, setIsAddingCustomRate] = useState(false);\r\n  const showToast = useToast();\r\n\r\n  // Reset state when modal is opened\r\n  useEffect(() => {\r\n    if (visible) {\r\n      setCurrentStep(STEPS.CATEGORY_SELECTION.id);\r\n      setError(null);\r\n      \r\n      if (initialService) {\r\n        debugLog('MBA123456', 'Initializing with service data:', initialService);\r\n        setIsEditMode(true);\r\n        \r\n        // Extract animal types from the object\r\n        let animalTypesArray = [];\r\n        \r\n        // Log the animal types we're working with\r\n        if (initialService.animalTypes && initialService.animalTypes.length > 0) {\r\n          // If animalTypes is already provided in the expected format, use it directly\r\n          debugLog('MBA123456', 'Using pre-formatted animalTypes array:', initialService.animalTypes);\r\n          animalTypesArray = initialService.animalTypes;\r\n        } else if (initialService.animal_types) {\r\n          debugLog('MBA123456', 'Using animal_types from backend:', initialService.animal_types);\r\n          \r\n          // Handle if animal_types is a dictionary mapping animal types to categories\r\n          if (typeof initialService.animal_types === 'object' && !Array.isArray(initialService.animal_types)) {\r\n            debugLog('MBA123456', 'Processing animal_types as dictionary');\r\n            Object.entries(initialService.animal_types).forEach(([animalName, categoryName]) => {\r\n              // Find the category ID for this category name\r\n              const category = GENERAL_CATEGORIES.find(cat => cat.name === categoryName);\r\n              debugLog('MBA123456', `Adding animal: ${animalName}, category: ${categoryName}, categoryId: ${category?.id || 'not found'}`);\r\n              \r\n              animalTypesArray.push({\r\n                name: animalName,\r\n                categoryName: categoryName,\r\n                categoryId: category ? category.id : null, \r\n                isCustom: false\r\n              });\r\n            });\r\n          }\r\n        } else {\r\n          debugLog('MBA123456', 'No animal types found in data');\r\n        }\r\n        \r\n        debugLog('MBA123456', 'Final converted animal types:', animalTypesArray);\r\n        \r\n        // Parse holiday rate\r\n        let holidayRate = '0';\r\n        let isPercent = true;\r\n        \r\n        if (initialService.holiday_rate) {\r\n          if (typeof initialService.holiday_rate === 'string') {\r\n            if (initialService.holiday_rate.includes('%')) {\r\n              holidayRate = initialService.holiday_rate.replace('%', '');\r\n              isPercent = true;\r\n            } else if (initialService.holiday_rate.includes('$')) {\r\n              holidayRate = initialService.holiday_rate.replace('$', '');\r\n              isPercent = false;\r\n            } else {\r\n              holidayRate = initialService.holiday_rate;\r\n              isPercent = initialService.holiday_rate_is_percent !== undefined \r\n                ? initialService.holiday_rate_is_percent \r\n                : true;\r\n            }\r\n          } else {\r\n            holidayRate = initialService.holiday_rate.toString();\r\n            isPercent = initialService.holiday_rate_is_percent !== undefined \r\n              ? initialService.holiday_rate_is_percent \r\n              : true;\r\n          }\r\n        }\r\n        \r\n        // Format additional rates\r\n        let additionalRates = [];\r\n        if (initialService.additional_rates && Array.isArray(initialService.additional_rates)) {\r\n          additionalRates = initialService.additional_rates.map(rate => ({\r\n            title: rate.title,\r\n            rate: rate.rate,\r\n            description: rate.description || ''\r\n          }));\r\n        }\r\n        \r\n        // Set the service data with the provided initial values\r\n        setServiceData({\r\n          service_id: initialService.service_id,\r\n          generalCategories: [], // We don't need to populate this as it's derived from animalTypes\r\n          animalTypes: animalTypesArray,\r\n          serviceName: initialService.service_name || '',\r\n          serviceDescription: initialService.description || '',\r\n          isOvernight: initialService.is_overnight || false,\r\n          rates: {\r\n            base_rate: initialService.base_rate || '',\r\n            base_rate_unit: initialService.unit_of_time || 'Per Visit',\r\n            additionalAnimalRate: initialService.additional_animal_rate || '',\r\n            additionalAnimalThreshold: initialService.applies_after?.toString() || '1',\r\n            hasHolidayRate: holidayRate !== '0',\r\n            holidayRate: holidayRate,\r\n            isPercent: isPercent\r\n          },\r\n          additionalRates: additionalRates\r\n        });\r\n      } else {\r\n        // Reset to default state if not in edit mode\r\n        setIsEditMode(false);\r\n        setServiceData({\r\n          generalCategories: [],\r\n          animalTypes: [],\r\n          serviceName: '',\r\n          serviceDescription: '',\r\n          isOvernight: false,\r\n          rates: {\r\n            base_rate: '',\r\n            base_rate_unit: 'Per Visit',\r\n            additionalAnimalRate: '',\r\n            additionalAnimalThreshold: '1',\r\n            hasHolidayRate: false,\r\n            holidayRate: '0',\r\n            isPercent: true\r\n          },\r\n          additionalRates: []\r\n        });\r\n      }\r\n    }\r\n  }, [visible, initialService]);\r\n\r\n  const canProceedToNextStep = () => {\r\n    switch (currentStep) {\r\n      case STEPS.CATEGORY_SELECTION.id:\r\n        return serviceData.animalTypes?.length > 0;\r\n      \r\n      case STEPS.SERVICE_DETAILS.id:\r\n        return (\r\n          serviceData.serviceName?.trim() &&\r\n          serviceData.serviceDescription?.trim()\r\n        );\r\n      \r\n      case STEPS.RATES_AND_REVIEW.id:\r\n        const hasValidBaseRate = serviceData.rates?.base_rate && \r\n          parseFloat(serviceData.rates.base_rate) > 0;\r\n        const hasValidAdditionalRate = !serviceData.rates?.additionalAnimalRate || \r\n          parseFloat(serviceData.rates.additionalAnimalRate) >= 0;\r\n        const hasValidHolidayRate = !serviceData.rates?.hasHolidayRate || \r\n          (serviceData.rates.holidayRate && parseFloat(serviceData.rates.holidayRate) >= 0);\r\n        \r\n        return hasValidBaseRate && hasValidAdditionalRate && hasValidHolidayRate;\r\n      \r\n      default:\r\n        return false;\r\n    }\r\n  };\r\n\r\n  // Direct API call function that doesn't depend on state\r\n  const callServiceApi = async () => {\r\n    debugLog('MBAno34othg0v', 'Directly calling API without state dependencies');\r\n    \r\n    debugLog('MBA54321', 'Original serviceData:', serviceData);\r\n    setIsSubmitting(true);\r\n    \r\n    try {\r\n      // Format animal types as a dictionary mapping animal types to their categories\r\n      const animalTypesDict = {};\r\n      \r\n      serviceData.animalTypes.forEach(animalType => {\r\n        const animalName = typeof animalType === 'string' ? animalType : animalType.name;\r\n        \r\n        // Use the hardcoded ANIMAL_CATEGORIES mapping\r\n        if (ANIMAL_CATEGORIES[animalName]) {\r\n          animalTypesDict[animalName] = ANIMAL_CATEGORIES[animalName];\r\n        } else {\r\n          // For custom animals, use the category name if it exists\r\n          if (typeof animalType === 'object' && animalType.categoryName) {\r\n            animalTypesDict[animalName] = animalType.categoryName;\r\n          } else {\r\n            animalTypesDict[animalName] = 'Other';\r\n          }\r\n        }\r\n      });\r\n      \r\n      // Log animal types dictionary for debugging\r\n      debugLog('MBA54321', 'Animal types dictionary created:', animalTypesDict);\r\n      \r\n      // Check what type of data we have for generalCategories (for backward compatibility)\r\n      const categories = serviceData.generalCategories.map(cat => \r\n        typeof cat === 'string' ? cat : (cat.name || 'Uncategorized')\r\n      );\r\n      \r\n      // Format holiday rate with appropriate symbol based on type\r\n      const holidayRateValue = serviceData.rates.holidayRate || '0';\r\n      const holidayRateString = holidayRateValue && holidayRateValue !== '0' ? \r\n        (serviceData.rates.isPercent ? `${holidayRateValue}%` : `$${holidayRateValue}`) : \r\n        '0';\r\n      \r\n      // Format the data according to the backend's expected format\r\n      const formattedData = {\r\n        service_name: serviceData.serviceName,\r\n        description: serviceData.serviceDescription,\r\n        animal_types: animalTypesDict,\r\n        base_rate: serviceData.rates.base_rate,\r\n        additional_animal_rate: serviceData.rates.additionalAnimalRate || '0',\r\n        holiday_rate: holidayRateString,\r\n        applies_after: parseInt(serviceData.rates.additionalAnimalThreshold) || 1,\r\n        unit_of_time: serviceData.rates.base_rate_unit,\r\n        is_overnight: serviceData.isOvernight || false,\r\n        additional_rates: serviceData.additionalRates.map(rate => ({\r\n          title: rate.title,\r\n          description: rate.description || '',\r\n          rate: rate.rate\r\n        }))\r\n      };\r\n      \r\n      // If in edit mode, include the service_id in the formatted data\r\n      if (isEditMode && serviceData.service_id) {\r\n        formattedData.service_id = serviceData.service_id;\r\n      }\r\n      \r\n      debugLog('MBA54321', 'Formatted data for backend:', formattedData);\r\n      \r\n      let response;\r\n      \r\n      // Call the appropriate API based on edit mode\r\n      if (isEditMode && serviceData.service_id) {\r\n        response = await updateService(formattedData);\r\n        debugLog('MBA54321', 'Service updated successfully, response:', response);\r\n      } else {\r\n        response = await createService(formattedData);\r\n        debugLog('MBA54321', 'Service created successfully, response:', response);\r\n      }\r\n      \r\n      // Show success toast\r\n      showToast({\r\n        message: isEditMode ? 'Service updated successfully!' : 'Service created successfully!',\r\n        type: 'success',\r\n        duration: 3000\r\n      });\r\n      \r\n      // Format the data according to what ServiceManager expects\r\n      const serviceManagerData = {\r\n        // Use the service_id from the response\r\n        service_id: response.service_id,\r\n        // Use the formatted service_name from the response if available\r\n        serviceName: response.service_name || serviceData.serviceName,\r\n        serviceDescription: serviceData.serviceDescription,\r\n        // Use the formatted unit_of_time from the response if available\r\n        lengthOfService: response.unit_of_time || serviceData.rates.base_rate_unit,\r\n        isOvernight: serviceData.isOvernight || false,\r\n        is_active: response.is_active !== undefined ? response.is_active : true,\r\n        rates: {\r\n          base_rate: serviceData.rates.base_rate,\r\n          additionalAnimalRate: serviceData.rates.additionalAnimalRate || '0',\r\n          holidayRate: holidayRateString\r\n        },\r\n        generalCategories: serviceData.generalCategories.map(cat => {\r\n          if (typeof cat === 'string') {\r\n            return {\r\n              id: cat.toLowerCase().replace(/\\s+/g, '_'),\r\n              name: cat,\r\n              isCustom: false\r\n            };\r\n          }\r\n          return {\r\n            id: cat.id || cat.name.toLowerCase().replace(/\\s+/g, '_'),\r\n            name: cat.name,\r\n            isCustom: cat.isCustom || false\r\n          };\r\n        }),\r\n        animalTypes: serviceData.animalTypes.map(type => {\r\n          if (typeof type === 'string') {\r\n            return {\r\n              name: type,\r\n              categoryId: null,\r\n              isCustom: false\r\n            };\r\n          }\r\n          \r\n          // Use the categoryName if it exists, otherwise we need to include it\r\n          return {\r\n            name: type.name,\r\n            categoryId: type.categoryId,\r\n            categoryName: type.categoryName || 'Other', // Ensure categoryName is included\r\n            isCustom: type.isCustom || false\r\n          };\r\n        }),\r\n        additionalRates: serviceData.additionalRates.map(rate => ({\r\n          label: rate.title,\r\n          value: rate.rate,\r\n          description: rate.description || ''\r\n        }))\r\n      };\r\n      \r\n      // If the response has additional_rates, use those instead\r\n      if (response.additional_rates && Array.isArray(response.additional_rates)) {\r\n        serviceManagerData.additionalRates = response.additional_rates.map(rate => ({\r\n          label: rate.title,\r\n          value: rate.rate,\r\n          description: rate.description || ''\r\n        }));\r\n      }\r\n      \r\n      debugLog('MBA54321', 'Formatted data for ServiceManager:', serviceManagerData);\r\n      \r\n      // Call the onSave prop with properly formatted data\r\n      if (onSave) {\r\n        onSave(serviceManagerData);\r\n      }\r\n      \r\n      // Reset form and close modal\r\n      setServiceData({\r\n        generalCategories: [],\r\n        animalTypes: [],\r\n        serviceName: '',\r\n        serviceDescription: '',\r\n        isOvernight: false,\r\n        rates: {\r\n          base_rate: '',\r\n          base_rate_unit: 'Per Visit',\r\n          additionalAnimalRate: '',\r\n          additionalAnimalThreshold: '1',\r\n          hasHolidayRate: false,\r\n          holidayRate: '0',\r\n          isPercent: true\r\n        },\r\n        additionalRates: []\r\n      });\r\n      \r\n      setCurrentStep(STEPS.CATEGORY_SELECTION.id);\r\n      setHasUnsavedChanges(true);\r\n      onClose();\r\n    } catch (error) {\r\n      debugLog('MBA54321', 'Error saving service:', error);\r\n      debugLog('MBA54321', 'Error response:', error.response?.data);\r\n      \r\n      // Show error toast\r\n      showToast({\r\n        message: `Failed to ${isEditMode ? 'update' : 'create'} service: ${error.response?.data?.error || error.message}`,\r\n        type: 'error',\r\n        duration: 4000\r\n      });\r\n      \r\n      setError(`Failed to ${isEditMode ? 'update' : 'create'} service. Please try again.`);\r\n    } finally {\r\n      setIsSubmitting(false);\r\n    }\r\n  };\r\n\r\n  const handleNext = () => {\r\n    debugLog('MBAno34othg0v', 'handleNext called, currentStep:', currentStep);\r\n    \r\n    if (!canProceedToNextStep()) {\r\n      setError('Please complete all required fields before proceeding');\r\n      return;\r\n    }\r\n\r\n    setError(null);\r\n    if (currentStep < STEPS.RATES_AND_REVIEW.id) {\r\n      setCurrentStep(prev => prev + 1);\r\n    } else {\r\n      // We're on the final step (Rates & Review)\r\n      debugLog('MBAno34othg0v', 'Final step, checking for unsaved custom rates');\r\n      \r\n      // Signal to RatesAndReviewStep that we're attempting to update\r\n      setIsAddingCustomRate(true);\r\n      \r\n      // Don't even call handleSaveService\r\n      // We'll call the API directly from the RatesAndReviewStep when appropriate\r\n    }\r\n  };\r\n\r\n  const handleSaveService = async () => {\r\n    debugLog('MBAno34othg0v', 'DEPRECATED: handleSaveService called, this should not happen');\r\n  };\r\n\r\n  const handleBack = () => {\r\n    if (currentStep > STEPS.CATEGORY_SELECTION.id) {\r\n      setCurrentStep(prev => prev - 1);\r\n    } else {\r\n      onClose();\r\n    }\r\n  };\r\n\r\n  const renderCurrentStep = () => {\r\n    debugLog('MBA54321 Rendering step:', currentStep, 'with serviceData:', serviceData);\r\n    \r\n    switch (currentStep) {\r\n      case STEPS.CATEGORY_SELECTION.id:\r\n        return (\r\n          <CategorySelectionStep\r\n            serviceData={serviceData}\r\n            setServiceData={setServiceData}\r\n          />\r\n        );\r\n      case STEPS.SERVICE_DETAILS.id:\r\n        return (\r\n          <ServiceDetailsStep\r\n            serviceData={serviceData}\r\n            setServiceData={setServiceData}\r\n          />\r\n        );\r\n      case STEPS.RATES_AND_REVIEW.id:\r\n        return (\r\n          <RatesAndReviewStep\r\n            serviceData={serviceData}\r\n            setServiceData={setServiceData}\r\n            isUpdatingService={isAddingCustomRate}\r\n            setIsUpdatingService={setIsAddingCustomRate}\r\n            onProceedWithUpdate={callServiceApi}\r\n          />\r\n        );\r\n      default:\r\n        return null;\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Modal\r\n      visible={visible}\r\n      animationType=\"fade\"\r\n      onRequestClose={handleBack}\r\n      transparent={true}\r\n    >\r\n      <View style={styles.modalOverlay}>\r\n        <SafeAreaView style={styles.modalContent}>\r\n          <View style={styles.stepIndicatorContainer}>\r\n            <StepProgressIndicator\r\n              steps={Object.values(STEPS).map(step => step.name)}\r\n              currentStep={currentStep}\r\n            />\r\n          </View>\r\n          <ScrollView style={styles.scrollContent} contentContainerStyle={styles.scrollContentContainer}>\r\n            <View style={styles.content}>\r\n              {renderCurrentStep()}\r\n            </View>\r\n            {error && (\r\n              <Text style={styles.errorText}>{error}</Text>\r\n            )}\r\n          </ScrollView>\r\n          <View style={styles.footer}>\r\n            <TouchableOpacity\r\n              style={styles.cancelButton}\r\n              onPress={handleBack}\r\n              disabled={isSubmitting}\r\n            >\r\n              <Text style={styles.cancelButtonText}>\r\n                {currentStep > STEPS.CATEGORY_SELECTION.id ? 'Back' : 'Cancel'}\r\n              </Text>\r\n            </TouchableOpacity>\r\n            <TouchableOpacity\r\n              style={[\r\n                styles.nextButton,\r\n                (!canProceedToNextStep() || isSubmitting) && styles.disabledButton\r\n              ]}\r\n              onPress={handleNext}\r\n              disabled={!canProceedToNextStep() || isSubmitting}\r\n            >\r\n              {isSubmitting && currentStep === STEPS.RATES_AND_REVIEW.id ? (\r\n                <ActivityIndicator color={theme.colors.surface} size=\"small\" />\r\n              ) : (\r\n                <Text style={[\r\n                  styles.nextButtonText,\r\n                  !canProceedToNextStep() && styles.disabledButtonText\r\n                ]}>\r\n                  {currentStep === STEPS.RATES_AND_REVIEW.id ? \r\n                    (isEditMode ? 'Update Service' : 'Create Service') : \r\n                    'Next'}\r\n                </Text>\r\n              )}\r\n            </TouchableOpacity>\r\n          </View>\r\n        </SafeAreaView>\r\n      </View>\r\n    </Modal>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  modalOverlay: {\r\n    flex: 1,\r\n    backgroundColor: 'rgba(0, 0, 0, 0.5)',\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    width: '100%',\r\n  },\r\n  modalContent: {\r\n    width: '95%',\r\n    maxWidth: Platform.OS === 'web' ? 550 : '100%',\r\n    maxHeight: '90%',\r\n    backgroundColor: theme.colors.background,\r\n    borderRadius: 12,\r\n    overflow: 'hidden',\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n  },\r\n  stepIndicatorContainer: {\r\n    width: '100%',\r\n    paddingVertical: 12,\r\n    backgroundColor: theme.colors.background,\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: theme.colors.modernBorder,\r\n  },\r\n  scrollContent: {\r\n    flex: 1,\r\n  },\r\n  scrollContentContainer: {\r\n    flexGrow: 1,\r\n  },\r\n  content: {\r\n    flex: 1,\r\n    backgroundColor: theme.colors.background,\r\n  },\r\n  footer: {\r\n    flexDirection: 'row',\r\n    padding: 16,\r\n    justifyContent: 'space-between',\r\n    gap: 12,\r\n    backgroundColor: theme.colors.background,\r\n    borderTopWidth: 1,\r\n    borderTopColor: theme.colors.modernBorder,\r\n  },\r\n  cancelButton: {\r\n    flex: 1,\r\n    backgroundColor: theme.colors.surface,\r\n    paddingVertical: 16,\r\n    borderRadius: 8,\r\n    alignItems: 'center',\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n  },\r\n  cancelButtonText: {\r\n    color: theme.colors.text,\r\n    fontSize: 16,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  nextButton: {\r\n    flex: 1,\r\n    backgroundColor: theme.colors.mainColors.main,\r\n    paddingVertical: 16,\r\n    borderRadius: 8,\r\n    alignItems: 'center',\r\n  },\r\n  disabledButton: {\r\n    backgroundColor: theme.colors.placeHolderText,\r\n  },\r\n  nextButtonText: {\r\n    color: theme.colors.surface,\r\n    fontSize: 16,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    fontWeight: '600',\r\n  },\r\n  disabledButtonText: {\r\n    color: theme.colors.surface,\r\n  },\r\n  errorText: {\r\n    color: theme.colors.error,\r\n    textAlign: 'center',\r\n    marginBottom: 16,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n});\r\n\r\nexport default ServiceCreationModal; ","import React, { useContext, useState, useEffect } from 'react';\r\nimport { View, Text, TouchableOpacity, StyleSheet, Switch } from 'react-native';\r\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\r\nimport { theme } from '../styles/theme';\r\nimport { AuthContext } from '../context/AuthContext';\r\nimport { debugLog } from '../context/AuthContext';\r\n\r\nconst ProfessionalServiceCard = ({ \r\n  item, \r\n  index, \r\n  onEdit, \r\n  onDelete \r\n}) => {\r\n  const { screenWidth } = useContext(AuthContext);\r\n  const [isActive, setIsActive] = useState(item.is_active !== false); // Default to true if not specified\r\n  \r\n  // Log the item data when it changes\r\n  useEffect(() => {\r\n    debugLog('MBA3377', 'ProfessionalServiceCard Item Data:', item);\r\n  }, [item]);\r\n\r\n  const handleToggleActive = () => {\r\n    setIsActive(!isActive);\r\n    // Here you would normally update this to the backend\r\n  };\r\n\r\n  // Determine background color for pricing section based on service type\r\n  const getPricingBackgroundColor = () => {\r\n    // This will cycle through different colors based on the index\r\n    const colors = [\r\n      // theme.colors.proDashboard.main, // Light green\r\n      // theme.colors.proDashboard.secondary, // Light blue\r\n      // theme.colors.proDashboard.tertiary, // Light orange\r\n    ];\r\n    return colors[index % colors.length];\r\n  };\r\n\r\n  // Format the display of unit of time in a user-friendly way\r\n  const formatUnitOfTime = (unitOfTime) => {\r\n    if (!unitOfTime) return 'visit';\r\n    \r\n    // If we receive a nicely formatted unit of time from the backend, use it\r\n    return unitOfTime;\r\n  };\r\n\r\n  return (\r\n    <View style={styles.serviceCard}>\r\n      <View style={styles.cardHeader}>\r\n        <Text style={styles.serviceName} numberOfLines={2} ellipsizeMode=\"tail\">{item.serviceName}</Text>\r\n        <View style={styles.activeToggleContainer}>\r\n          <Text style={isActive ? styles.activeText : styles.inactiveText}>\r\n            {isActive ? 'Active' : 'Inactive'}\r\n          </Text>\r\n          <Switch\r\n            value={isActive}\r\n            onValueChange={handleToggleActive}\r\n            trackColor={{\r\n              false: theme.colors.quaternary, \r\n              true: theme.colors.primary\r\n            }}\r\n            thumbColor={theme.colors.surfaceContrast}\r\n            style={styles.switch}\r\n          />\r\n        </View>\r\n      </View>\r\n\r\n      <View style={[styles.ratesContainer, { backgroundColor: getPricingBackgroundColor() }]}>\r\n        <View style={styles.rateRow}>\r\n          <Text style={styles.rateLabel}>Base Rate</Text>\r\n          <Text style={styles.rateValue}>${item.rates.base_rate || 'N/A'}/{formatUnitOfTime(item.lengthOfService)}</Text>\r\n        </View>\r\n        \r\n        {item.rates.additionalAnimalRate && (\r\n          <View style={styles.rateRow}>\r\n            <Text style={styles.rateLabel}>Additional Animal</Text>\r\n            <Text style={styles.rateValue}>${item.rates.additionalAnimalRate}</Text>\r\n          </View>\r\n        )}\r\n        {item.rates.holidayRate && (\r\n          <View style={styles.rateRow}>\r\n            <Text style={styles.rateLabel}>Holiday Rate</Text>\r\n            <Text style={styles.rateValue}>{item.rates.holidayRate}</Text>\r\n          </View>\r\n        )}\r\n        {item.additionalRates && item.additionalRates.map((rate, idx) => (\r\n          <View key={idx} style={styles.rateRow}>\r\n            <Text style={styles.rateLabel}>{rate.label}</Text>\r\n            <Text style={styles.rateValue}>${rate.value}</Text>\r\n          </View>\r\n        ))}\r\n      </View>\r\n      \r\n      <View style={styles.buttonContainer}>\r\n        <TouchableOpacity onPress={() => onDelete(index)} style={styles.deleteButton}>\r\n          <MaterialCommunityIcons name=\"trash-can\" size={20} color={'#F26969'} />\r\n          <Text style={styles.deleteButtonText}>Delete</Text>\r\n        </TouchableOpacity>\r\n        <TouchableOpacity onPress={() => onEdit(index)} style={styles.editButton}>\r\n          <MaterialCommunityIcons name=\"pencil\" size={20} color={theme.colors.surfaceContrast} />\r\n          <Text style={styles.buttonText}>Edit</Text>\r\n        </TouchableOpacity>\r\n      </View>\r\n    </View>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  serviceCard: {\r\n    backgroundColor: theme.colors.surfaceContrast,\r\n    borderRadius: 12,\r\n    padding: 16,\r\n    marginBottom: 16,\r\n    shadowColor: \"#000\",\r\n    display: 'flex',\r\n    justifyContent: 'center',\r\n    shadowOffset: {\r\n      width: 0,\r\n      height: 2,\r\n    },\r\n    shadowOpacity: 0.1,\r\n    shadowRadius: 3,\r\n    elevation: 3,\r\n  },\r\n  cardHeader: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'flex-start',\r\n    marginBottom: 16,\r\n  },\r\n  serviceName: {\r\n    fontSize: theme.fontSizes.large,\r\n    fontWeight: '600',\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n    flex: 1,\r\n    flexWrap: 'wrap',\r\n    marginRight: 8,\r\n  },\r\n  activeToggleContainer: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    gap: 8,\r\n  },\r\n  activeText: {\r\n    fontSize: theme.fontSizes.smallMedium,\r\n    color: theme.colors.primary,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    fontWeight: '600',\r\n  },\r\n  inactiveText: {\r\n    fontSize: theme.fontSizes.smallMedium,\r\n    color: theme.colors.textSecondary,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  switch: {\r\n    transform: [{ scaleX: 0.8 }, { scaleY: 0.8 }],\r\n  },\r\n  ratesContainer: {\r\n    gap: 12,\r\n    padding: 16,\r\n    borderRadius: 8,\r\n    marginBottom: 16,\r\n  },\r\n  rateRow: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    paddingVertical: 4,\r\n  },\r\n  rateLabel: {\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    fontWeight: '500',\r\n  },\r\n  rateValue: {\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.text,\r\n    fontWeight: '500',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  buttonContainer: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    gap: 8,\r\n  },\r\n  editButton: {\r\n    flex: 1,\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    backgroundColor: theme.colors.primary,\r\n    paddingVertical: 10,\r\n    borderRadius: 8,\r\n    gap: 8,\r\n  },\r\n  deleteButton: {\r\n    flex: 1,\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    borderColor: '#F26969',\r\n    borderWidth: 1,\r\n    paddingVertical: 10,\r\n    borderRadius: 8,\r\n    gap: 8,\r\n  },\r\n  buttonText: {\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.surfaceContrast,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  deleteButtonText: {\r\n    fontSize: theme.fontSizes.medium,\r\n    fontWeight: '600',\r\n    color: '#F26969',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n});\r\n\r\nexport default ProfessionalServiceCard;","import { Platform } from 'react-native';\r\n\r\n/**\r\n * Detects if the device supports hover interactions properly\r\n * Returns false for touch devices (mobile, tablets) even when on web browsers\r\n */\r\nexport const supportsHover = () => {\r\n  // Return false for React Native app\r\n  if (Platform.OS !== 'web') {\r\n    return false;\r\n  }\r\n\r\n  // For web, check if device supports hover\r\n  if (typeof window !== 'undefined') {\r\n    // Check for touch capability\r\n    const hasTouchScreen = 'ontouchstart' in window || \r\n                          navigator.maxTouchPoints > 0 || \r\n                          navigator.msMaxTouchPoints > 0;\r\n    \r\n    // Use CSS media query to check hover capability\r\n    const supportsHoverQuery = window.matchMedia('(hover: hover)').matches;\r\n    \r\n    // Return true only if device supports hover AND is not primarily a touch device\r\n    return supportsHoverQuery && !hasTouchScreen;\r\n  }\r\n\r\n  return false;\r\n};\r\n\r\n/**\r\n * Hook to get hover support status\r\n */\r\nexport const useHoverSupport = () => {\r\n  return supportsHover();\r\n}; ","import React, { useState, useRef, useContext, useEffect } from 'react';\r\nimport { View, Text, StyleSheet, TouchableOpacity, FlatList, Platform } from 'react-native';\r\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\r\nimport { theme } from '../styles/theme';\r\nimport ServiceCreationModal from './ServiceCreationModal';\r\nimport ProfessionalServiceCard from './ProfessionalServiceCard';\r\nimport ConfirmationModal from './ConfirmationModal';\r\nimport { Portal } from 'react-native-paper';\r\nimport { AuthContext, debugLog } from '../context/AuthContext';\r\nimport { deleteService } from '../api/API';\r\nimport { useToast } from './ToastProvider';\r\nimport { supportsHover } from '../utils/deviceUtils';\r\n\r\n// Define GENERAL_CATEGORIES for mapping category names to IDs\r\nconst GENERAL_CATEGORIES = [\r\n  {\r\n    id: 'all',\r\n    name: 'All',\r\n    icon: 'paw-outline',\r\n  },\r\n  {\r\n    id: 'farm_animals',\r\n    name: 'Farm Animals',\r\n    icon: 'horse',\r\n  },\r\n  {\r\n    id: 'domestic',\r\n    name: 'Domestic',\r\n    icon: 'paw',\r\n  },\r\n  {\r\n    id: 'reptiles',\r\n    name: 'Reptiles',\r\n    icon: 'snake',\r\n  },\r\n  {\r\n    id: 'aquatic',\r\n    name: 'Aquatic',\r\n    icon: 'fish',\r\n  },\r\n  {\r\n    id: 'invertebrates',\r\n    name: 'Invertebrates',\r\n    icon: 'spider',\r\n  }\r\n];\r\n\r\nconst ServiceManager = ({ services, setServices, setHasUnsavedChanges, isProfessionalTab = false, isMobile = false }) => {\r\n  const [showModal, setShowModal] = useState(false);\r\n  const [editingService, setEditingService] = useState(null);\r\n  const [collapsedServices, setCollapsedServices] = useState([]);\r\n  const [allCollapsed, setAllCollapsed] = useState(false);\r\n  const [showDeleteModal, setShowDeleteModal] = useState(false);\r\n  const [serviceToDelete, setServiceToDelete] = useState(null);\r\n  const [hoveredButton, setHoveredButton] = useState(null);\r\n  const [tooltipPosition, setTooltipPosition] = useState(null);\r\n  const { screenWidth, is_DEBUG } = useContext(AuthContext);\r\n  const [collapseTooltipPosition, setCollapseTooltipPosition] = useState(null);\r\n  const buttonRef = useRef(null);\r\n  const collapseButtonRef = useRef(null);\r\n  const showToast = useToast();\r\n\r\n  // Check if device supports hover\r\n  const deviceSupportsHover = supportsHover();\r\n\r\n  // Reset local state when services change (e.g., when user changes)\r\n  useEffect(() => {\r\n    setCollapsedServices([]);\r\n    setAllCollapsed(false);\r\n    setEditingService(null);\r\n    setShowModal(false);\r\n    setShowDeleteModal(false);\r\n    setServiceToDelete(null);\r\n  }, [services]);\r\n\r\n  const toggleCollapseAll = () => {\r\n    if (allCollapsed) {\r\n      setCollapsedServices([]);\r\n    } else {\r\n      setCollapsedServices(services.map((_, index) => index));\r\n    }\r\n    setAllCollapsed(!allCollapsed);\r\n  };\r\n\r\n  const handleEditService = (index) => {\r\n    const serviceToEdit = services[index];\r\n    debugLog('MBA87654', 'Original service for editing:', serviceToEdit);\r\n    \r\n    // Convert animal_types from object format to array format if needed\r\n    let formattedAnimalTypes = [];\r\n    \r\n    if (serviceToEdit.animal_types && typeof serviceToEdit.animal_types === 'object' && !Array.isArray(serviceToEdit.animal_types)) {\r\n      // Convert from backend format {animalName: categoryName} to array of objects\r\n      formattedAnimalTypes = Object.entries(serviceToEdit.animal_types).map(([animalName, categoryName]) => {\r\n        // Find category ID from category name\r\n        const category = GENERAL_CATEGORIES.find(cat => cat.name === categoryName);\r\n        const categoryId = category ? category.id : null;\r\n        \r\n        return {\r\n          name: animalName,\r\n          categoryName: categoryName,\r\n          categoryId: categoryId,\r\n          isCustom: false\r\n        };\r\n      });\r\n      \r\n      debugLog('MBA87654', 'Converted animal_types to array format:', formattedAnimalTypes);\r\n    } else if (serviceToEdit.animalTypes) {\r\n      // If we already have animalTypes in the expected format, use it\r\n      formattedAnimalTypes = serviceToEdit.animalTypes;\r\n      debugLog('MBA87654', 'Using existing animalTypes array:', formattedAnimalTypes);\r\n    }\r\n    \r\n    // Transform to the format expected by ServiceCreationModal\r\n    const formattedService = {\r\n      service_id: serviceToEdit.service_id,\r\n      service_name: serviceToEdit.service_name || serviceToEdit.serviceName,\r\n      description: serviceToEdit.description || serviceToEdit.serviceDescription,\r\n      animal_types: serviceToEdit.animal_types,  // Keep the original format for API calls\r\n      animalTypes: formattedAnimalTypes,        // Add the formatted version for the UI\r\n      base_rate: serviceToEdit.base_rate || (serviceToEdit.rates ? serviceToEdit.rates.base_rate : ''),\r\n      additional_animal_rate: serviceToEdit.additional_animal_rate || (serviceToEdit.rates ? serviceToEdit.rates.additionalAnimalRate : '0'),\r\n      holiday_rate: serviceToEdit.holiday_rate || (serviceToEdit.rates ? serviceToEdit.rates.holidayRate : '0'),\r\n      applies_after: serviceToEdit.applies_after || 1,\r\n      unit_of_time: serviceToEdit.unit_of_time || serviceToEdit.lengthOfService || 'Per Visit',\r\n      is_overnight: serviceToEdit.is_overnight || serviceToEdit.isOvernight || false,\r\n      is_active: serviceToEdit.is_active !== undefined ? serviceToEdit.is_active : true,\r\n      holiday_rate_is_percent: serviceToEdit.holiday_rate_is_percent,\r\n      additional_rates: serviceToEdit.additional_rates || \r\n        (serviceToEdit.additionalRates ? serviceToEdit.additionalRates.map(rate => ({\r\n          title: rate.label || rate.title,\r\n          rate: rate.value || rate.rate,\r\n          description: rate.description || ''\r\n        })) : [])\r\n    };\r\n    \r\n    debugLog('MBA87654', 'Formatted service for editing modal:', formattedService);\r\n    setEditingService(formattedService);\r\n    setShowModal(true);\r\n  };\r\n\r\n  const handleDeleteService = (index) => {\r\n    setServiceToDelete(index);\r\n    setShowDeleteModal(true);\r\n  };\r\n\r\n  const handleSaveService = (updatedService) => {\r\n    // Add debugging log for service data received\r\n    debugLog('MBA8765', 'Service data received from modal:', updatedService);\r\n    \r\n    // Check if we're updating an existing service\r\n    const isEditingExisting = editingService && updatedService.service_id;\r\n    \r\n    if (isEditingExisting) {\r\n      debugLog('MBA8765', 'Updating existing service with ID:', updatedService.service_id);\r\n      \r\n      // Find the index of this service in our list by service_id\r\n      const serviceIndex = services.findIndex(s => s.service_id === updatedService.service_id);\r\n      \r\n      if (serviceIndex !== -1) {\r\n        // Update the service in the array\r\n        setServices(prev => {\r\n          const newServices = [...prev];\r\n          newServices[serviceIndex] = updatedService;\r\n          return newServices;\r\n        });\r\n        \r\n        debugLog('MBA8765', 'Service updated at index:', serviceIndex);\r\n      } else {\r\n        // If not found by ID, just add it\r\n        debugLog('MBA8765', 'Service ID not found in existing list, adding as new');\r\n        setServices(prev => [...prev, updatedService]);\r\n      }\r\n      \r\n      setHasUnsavedChanges(true);\r\n      setEditingService(null);\r\n      return;\r\n    }\r\n    \r\n    // For new services\r\n    if (updatedService.service_id) {\r\n      debugLog('MBA8765', 'New service created on backend with ID:', updatedService.service_id);\r\n      \r\n      // Add the new service to the list\r\n      setServices(prev => [...prev, updatedService]);\r\n      setHasUnsavedChanges(true);\r\n      setEditingService(null);\r\n      return;\r\n    }\r\n    \r\n    // Legacy support for old-format services (should not reach here with new code)\r\n    debugLog('MBA8765', 'Warning: Falling back to legacy service format handling');\r\n    \r\n    // Create animal_types dictionary from animalTypes array\r\n    const animalTypesDict = {};\r\n    if (updatedService.animalTypes && Array.isArray(updatedService.animalTypes)) {\r\n      updatedService.animalTypes.forEach(animal => {\r\n        if (animal && animal.name) {\r\n          // Use the categoryName directly from the animal object if available\r\n          if (animal.categoryName) {\r\n            animalTypesDict[animal.name] = animal.categoryName;\r\n          } \r\n          // Fallback if no categoryName is available\r\n          else {\r\n            animalTypesDict[animal.name] = animal.category || 'Other';\r\n          }\r\n        }\r\n      });\r\n    }\r\n\r\n    // Transform the service data to match the backend structure\r\n    const transformedService = {\r\n      service_name: updatedService.serviceName,\r\n      description: updatedService.serviceDescription,\r\n      unit_of_time: updatedService.lengthOfService,\r\n      is_overnight: updatedService.isOvernight || false,\r\n      base_rate: updatedService.rates.base_rate,\r\n      additional_animal_rate: updatedService.rates.additionalAnimalRate,\r\n      holiday_rate: updatedService.rates.holidayRate,\r\n      animal_types: animalTypesDict,\r\n      additional_rates: updatedService.additionalRates.map(rate => ({\r\n        title: rate.label,\r\n        rate: rate.value,\r\n        description: rate.description\r\n      }))\r\n    };\r\n\r\n    // Legacy code for handling legacy editing\r\n    if (editingService) {\r\n      const existingIndex = services.findIndex(s => \r\n        s.service_id === editingService.service_id\r\n      );\r\n      \r\n      if (existingIndex !== -1) {\r\n        setServices(prev => {\r\n          const newServices = [...prev];\r\n          newServices[existingIndex] = transformedService;\r\n          return newServices;\r\n        });\r\n      } else {\r\n        setServices(prev => [...prev, transformedService]);\r\n      }\r\n    } else {\r\n      setServices(prev => [...prev, transformedService]);\r\n    }\r\n    \r\n    setHasUnsavedChanges(true);\r\n    setEditingService(null);\r\n  };\r\n\r\n  const toggleCollapse = (index) => {\r\n    setCollapsedServices((prev) =>\r\n      prev.includes(index)\r\n        ? prev.filter((i) => i !== index)\r\n        : [...prev, index]\r\n    );\r\n  };\r\n\r\n  const confirmDelete = async () => {\r\n    try {\r\n      // Get the service ID from the selected service\r\n      const serviceToRemove = services[serviceToDelete];\r\n      if (!serviceToRemove || !serviceToRemove.service_id) {\r\n        showToast({\r\n          message: 'Unable to identify service for deletion',\r\n          type: 'error',\r\n          duration: 3000\r\n        });\r\n        setShowDeleteModal(false);\r\n        return;\r\n      }\r\n\r\n      // Call the API to delete the service\r\n      await deleteService(serviceToRemove.service_id);\r\n\r\n      // Remove from UI if successful\r\n      setServices(prevServices => \r\n        prevServices.filter((_, i) => i !== serviceToDelete)\r\n      );\r\n      \r\n      setHasUnsavedChanges(true);\r\n      setShowDeleteModal(false);\r\n      \r\n      showToast({\r\n        message: 'Service deleted successfully',\r\n        type: 'success',\r\n        duration: 3000\r\n      });\r\n    } catch (error) {\r\n      // Handle the error case\r\n      const errorMessage = error.response?.data?.error || 'Failed to delete service';\r\n      \r\n      showToast({\r\n        message: errorMessage,\r\n        type: 'error',\r\n        duration: 3000\r\n      });\r\n      \r\n      setShowDeleteModal(false);\r\n    }\r\n  };\r\n\r\n  const showTooltip = (ref, tooltipText, setPosition) => {\r\n    if (ref && ref.current) {\r\n      try {\r\n        setTimeout(() => {\r\n          // Get the button's DOM element\r\n          const element = ref.current;\r\n          // Get the button's bounding rectangle relative to the viewport\r\n          if (element.getBoundingOwnerRect) {\r\n            const rect = element.getBoundingOwnerRect();\r\n            \r\n            setPosition({\r\n              x: rect.left + (rect.width / 2),\r\n              y: rect.top, // Position tooltip at the top of the button\r\n              text: tooltipText\r\n            });\r\n            \r\n            setHoveredButton(tooltipText);\r\n          } else {\r\n            console.error('Error: getBoundingOwnerRect method not found on element');\r\n          }\r\n        }, 0);\r\n      } catch (error) {\r\n        console.error('Error showing tooltip:', error);\r\n      }\r\n    }\r\n  };\r\n\r\n  const renderService = ({ item, index }) => {\r\n    if (!item || typeof item !== 'object') {\r\n      console.warn('Invalid item detected:', item);\r\n      return null;\r\n    }\r\n\r\n    debugLog('MBA8765', 'Rendering service item:', item);\r\n\r\n    // Check if this is a service that already has a service_id (created on backend)\r\n    if (item.service_id) {\r\n      debugLog('MBA8765', 'This is a backend-created service with ID:', item.service_id);\r\n      \r\n      // If the item structure already matches what ProfessionalServiceCard expects, use it directly\r\n      if (item.serviceName && item.rates) {\r\n        return (\r\n          <ProfessionalServiceCard\r\n            key={`service-${index}`}\r\n            item={item}\r\n            index={index}\r\n            onEdit={() => handleEditService(index)}\r\n            onDelete={() => handleDeleteService(index)}\r\n            isCollapsed={collapsedServices.includes(index)}\r\n            onToggleCollapse={() => toggleCollapse(index)}\r\n            isProfessionalTab={isProfessionalTab}\r\n          />\r\n        );\r\n      }\r\n    }\r\n\r\n    // Convert animal_types from dictionary to array format\r\n    let animalTypesArray = [];\r\n    if (item.animal_types && typeof item.animal_types === 'object' && !Array.isArray(item.animal_types)) {\r\n      // Convert dictionary format to array format\r\n      animalTypesArray = Object.entries(item.animal_types).map(([name, category]) => ({\r\n        name: name,\r\n        categoryId: undefined, // We don't have exact category IDs, just names\r\n        category: category,    // Store the category name\r\n        isCustom: false        // Default to false as we don't know\r\n      }));\r\n    } else if (Array.isArray(item.animal_types)) {\r\n      // If it's already an array, use it directly\r\n      animalTypesArray = item.animal_types;\r\n    }\r\n    \r\n    // Transform the service data to match the frontend structure\r\n    const serviceData = {\r\n      service_id: item.service_id,\r\n      serviceName: item.service_name,\r\n      description: item.description,\r\n      lengthOfService: item.unit_of_time,\r\n      is_active: item.is_active,\r\n      generalCategories: item.categories?.map(cat => ({\r\n        id: cat.id,\r\n        name: cat.name,\r\n        isCustom: cat.is_custom\r\n      })) || [],\r\n      animalTypes: animalTypesArray,\r\n      rates: {\r\n        base_rate: item.base_rate,\r\n        additionalAnimalRate: item.additional_animal_rate,\r\n        holidayRate: item.holiday_rate\r\n      },\r\n      additionalRates: item.additional_rates?.map(rate => ({\r\n        label: rate.title,\r\n        value: rate.rate,\r\n        description: rate.description\r\n      })) || []\r\n    };\r\n\r\n    return (\r\n      <ProfessionalServiceCard\r\n        key={`service-${index}`}\r\n        item={serviceData}\r\n        index={index}\r\n        onEdit={() => handleEditService(index)}\r\n        onDelete={() => handleDeleteService(index)}\r\n        isCollapsed={collapsedServices.includes(index)}\r\n        onToggleCollapse={() => toggleCollapse(index)}\r\n        isProfessionalTab={isProfessionalTab}\r\n      />\r\n    );\r\n  };\r\n\r\n  // {console.log('Services:', services)}\r\n\r\n  return (\r\n    <View style={styles.container}>\r\n      <View style={[\r\n        styles.serviceListContainer,\r\n        {\r\n          maxWidth: 1200,\r\n          marginHorizontal: 'auto',\r\n          width: '100%',\r\n          paddingHorizontal: isMobile ? 20 : 24,\r\n          paddingTop: isMobile ? 0 : 44,\r\n        }\r\n      ]}>\r\n        <View style={styles.headerContainer}>\r\n          <Text style={styles.sectionTitle}>Service Manager</Text>\r\n          <View style={styles.headerActions}>\r\n            {/* <TouchableOpacity\r\n              ref={collapseButtonRef}\r\n              onPress={toggleCollapseAll} \r\n              style={styles.collapseButton}\r\n              onMouseEnter={() => {\r\n                try {\r\n                  if (deviceSupportsHover) {\r\n                    showTooltip(\r\n                      collapseButtonRef, \r\n                      allCollapsed ? 'Expand All' : 'Collapse All', \r\n                      setCollapseTooltipPosition\r\n                    );\r\n                  }\r\n                } catch (error) {\r\n                  console.error('Error showing collapse tooltip:', error);\r\n                }\r\n              }}\r\n              onMouseLeave={() => {\r\n                if (deviceSupportsHover) {\r\n                  setHoveredButton(null);\r\n                  setCollapseTooltipPosition(null);\r\n                }\r\n              }}\r\n            >\r\n              <MaterialCommunityIcons \r\n                name={allCollapsed ? \"chevron-down\" : \"chevron-up\"} \r\n                size={24} \r\n                color={theme.colors.text} \r\n              />\r\n            </TouchableOpacity> */}\r\n            \r\n            <TouchableOpacity\r\n              ref={buttonRef}\r\n              style={styles.addServiceButton}\r\n              onMouseEnter={() => {\r\n                try {\r\n                  if (deviceSupportsHover) {\r\n                    showTooltip(buttonRef, 'Add Service', setTooltipPosition);\r\n                  }\r\n                } catch (error) {\r\n                  console.error('Error showing add tooltip:', error);\r\n                }\r\n              }}\r\n              onMouseLeave={() => {\r\n                if (deviceSupportsHover) {\r\n                  setHoveredButton(null);\r\n                  setTooltipPosition(null);\r\n                }\r\n              }}\r\n              onPress={() => {\r\n                setEditingService(null);\r\n                setShowModal(true);\r\n              }}\r\n            >\r\n              <MaterialCommunityIcons \r\n                name=\"plus\" \r\n                size={20} \r\n                color={theme.colors.surface} \r\n              />\r\n              <Text style={styles.addServiceText}>Add New Service</Text>\r\n            </TouchableOpacity>\r\n          </View>\r\n        </View>\r\n\r\n        {(Array.isArray(services) && services.length > 0) ? (\r\n          <View style={[styles.servicesGrid, { justifyContent: screenWidth > 600 ? '' : 'center' }]}>\r\n            {services.map((item, index) => (\r\n              <View key={`service-wrapper-${index}`} style={styles.serviceCardWrapper}>\r\n                {renderService({ item, index })}\r\n              </View>\r\n            ))}\r\n          </View>\r\n        ) : (\r\n          <View style={styles.emptyContainer}>\r\n            <Text style={styles.emptyText}>No services yet</Text>\r\n            <TouchableOpacity \r\n              style={styles.addButton}\r\n              onPress={() => setShowModal(true)}\r\n            >\r\n              <Text style={styles.addButtonText}>Add Services</Text>\r\n            </TouchableOpacity>\r\n          </View>\r\n        )}\r\n      </View>\r\n      \r\n\r\n      <ServiceCreationModal\r\n        visible={showModal}\r\n        onClose={() => {\r\n          setShowModal(false);\r\n          setEditingService(null);\r\n        }}\r\n        onSave={handleSaveService}\r\n        initialService={editingService}\r\n        setHasUnsavedChanges={setHasUnsavedChanges}\r\n      />\r\n\r\n      <ConfirmationModal\r\n        visible={showDeleteModal}\r\n        onClose={() => setShowDeleteModal(false)}\r\n        onConfirm={confirmDelete}\r\n        actionText=\"delete this service\"\r\n      />\r\n\r\n      {tooltipPosition && (\r\n        <Portal>\r\n          <View \r\n            style={[\r\n              styles.portalTooltip,\r\n              {\r\n                position: 'fixed',\r\n                top: tooltipPosition.y - 40,\r\n                left: tooltipPosition.x - 35,\r\n              }\r\n            ]}\r\n          >\r\n            <Text style={styles.tooltipText}>{tooltipPosition.text}</Text>\r\n          </View>\r\n        </Portal>\r\n      )}\r\n\r\n      {collapseTooltipPosition && (\r\n        <Portal>\r\n          <View \r\n            style={[\r\n              styles.portalTooltip,\r\n              {\r\n                position: 'fixed',\r\n                top: collapseTooltipPosition.y - 40,\r\n                left: collapseTooltipPosition.x - 35,\r\n              }\r\n            ]}\r\n          >\r\n            <Text style={styles.tooltipText}>{collapseTooltipPosition.text}</Text>\r\n          </View>\r\n        </Portal>\r\n      )}\r\n      \r\n    </View>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    position: 'relative',\r\n    zIndex: 9998,\r\n    elevation: 9998,\r\n    backgroundColor: theme.colors.surface,\r\n  },\r\n  serviceListContainer: {\r\n    flex: 1,\r\n    paddingVertical: 0,\r\n  },\r\n  servicesGrid: {\r\n    display: 'flex',\r\n    flexDirection: 'row',\r\n    flexWrap: 'wrap',\r\n    gap: 16,\r\n    paddingBottom: 24,\r\n  },\r\n  serviceCardWrapper: {\r\n    flex: 1,\r\n    minWidth: 300,\r\n    maxWidth: 375,\r\n  },\r\n  headerContainer: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    marginBottom: 24,\r\n    position: 'relative',\r\n    zIndex: 9999,\r\n    elevation: 9999,\r\n  },\r\n  headerActions: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    gap: 12,\r\n  },\r\n  collapseButton: {\r\n    padding: 8,\r\n    borderRadius: 8,\r\n    backgroundColor: theme.colors.surface,\r\n  },\r\n  sectionTitle: {\r\n    fontSize: theme.fontSizes.large,\r\n    fontWeight: 'bold',\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n  },\r\n  addServiceButton: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    gap: 8,\r\n    backgroundColor: theme.colors.primary,\r\n    paddingHorizontal: 16,\r\n    paddingVertical: 10,\r\n    borderRadius: 50,\r\n  },\r\n  addServiceText: {\r\n    color: theme.colors.surface,\r\n    fontSize: theme.fontSizes.medium,\r\n    fontWeight: '500',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  emptyContainer: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    padding: 20,\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 8,\r\n    marginBottom: 24,\r\n  },\r\n  emptyText: {\r\n    fontSize: theme.fontSizes.mediumLarge,\r\n    color: theme.colors.text,\r\n    marginBottom: 20,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  addButton: {\r\n    backgroundColor: theme.colors.primary,\r\n    paddingHorizontal: 20,\r\n    paddingVertical: 10,\r\n    borderRadius: 50,\r\n  },\r\n  addButtonText: {\r\n    color: theme.colors.surface,\r\n    fontSize: theme.fontSizes.medium,\r\n    fontWeight: '500',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  portalTooltip: {\r\n    backgroundColor: theme.colors.surface,\r\n    padding: 8,\r\n    borderRadius: 4,\r\n    width: 70,\r\n    shadowColor: \"#000\",\r\n    shadowOffset: {\r\n      width: 0,\r\n      height: 2,\r\n    },\r\n    shadowOpacity: 0.25,\r\n    shadowRadius: 3.84,\r\n    elevation: 5,\r\n  },\r\n  tooltipText: {\r\n    fontSize: theme.fontSizes.small,\r\n    color: theme.colors.text,\r\n    textAlign: 'center',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n});\r\n\r\nexport default ServiceManager;\r\n","import React from 'react';\r\nimport { View, Text, Image, TouchableOpacity, StyleSheet } from 'react-native';\r\nimport { theme } from '../styles/theme';\r\n\r\nconst RecordedPets = ({ pets }) => {\r\n  return (\r\n    <View style={styles.section}>\r\n      <Text style={styles.sectionTitle}>My Pets</Text>\r\n      {pets.map((pet) => (\r\n        <TouchableOpacity key={pet.id} style={styles.petItem}>\r\n          <View style={styles.petItemContent}>\r\n            <Image source={{ uri: pet.photo }} style={styles.petPhoto} />\r\n            <View style={styles.petInfo}>\r\n              <Text style={styles.petName}>{pet.name}</Text>\r\n              <Text style={styles.petDetails}>{pet.type} • {pet.breed} • {pet.age} years old</Text>\r\n            </View>\r\n          </View>\r\n        </TouchableOpacity>\r\n      ))}\r\n    </View>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  section: {\r\n    width: '100%',\r\n    maxWidth: 600,\r\n    marginBottom: 20,\r\n    paddingVertical: 20,\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: theme.colors.border,\r\n  },\r\n  sectionTitle: {\r\n    fontSize: theme.fontSizes.large,\r\n    fontWeight: 'bold',\r\n    color: theme.colors.primary,\r\n    marginBottom: 10,\r\n  },\r\n  petItem: {\r\n    marginBottom: 10,\r\n    padding: 10,\r\n    backgroundColor: theme.colors.surface,\r\n    borderColor: theme.colors.border,\r\n    borderWidth: 1,\r\n    borderRadius: 5,\r\n    width: '100%',\r\n    maxWidth: 600,\r\n  },\r\n  petItemContent: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n  },\r\n  petPhoto: {\r\n    width: 50,\r\n    height: 50,\r\n    borderRadius: 25,\r\n    marginRight: 10,\r\n  },\r\n  petName: {\r\n    fontSize: theme.fontSizes.medium,\r\n    fontWeight: 'bold',\r\n  },\r\n  petInfo: {\r\n    flex: 1,\r\n  },\r\n  petDetails: {\r\n    fontSize: theme.fontSizes.smallMedium,\r\n    color: theme.colors.placeholder,\r\n    flexWrap: 'wrap',\r\n  },\r\n});\r\n\r\nexport default RecordedPets;","import React from 'react';\r\nimport { View, Text, TextInput, TouchableOpacity, StyleSheet } from 'react-native';\r\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\r\nimport { theme } from '../styles/theme';\r\n\r\nconst EditableSection = ({ \r\n  title, \r\n  value, \r\n  onChangeText, \r\n  editMode, \r\n  toggleEditMode, \r\n  setHasUnsavedChanges,\r\n  getContentWidth,\r\n  multiline = true \r\n}) => {\r\n  const renderEditableField = () => {\r\n    return editMode ? (\r\n      <TextInput\r\n        value={value}\r\n        onChangeText={(text) => {\r\n          onChangeText(text);\r\n          setHasUnsavedChanges(true);\r\n        }}\r\n        style={[\r\n          styles.input,\r\n          { width: getContentWidth() },\r\n          multiline && { height: 100, textAlignVertical: 'top' }\r\n        ]}\r\n        multiline={multiline}\r\n        numberOfLines={multiline ? 4 : 1}\r\n      />\r\n    ) : (\r\n      <Text style={[styles.fieldText, { width: getContentWidth() }]}>\r\n        {value || `No ${title.toLowerCase()} provided`}\r\n      </Text>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <View style={styles.section}>\r\n      <View style={styles.sectionHeader}>\r\n        <Text style={styles.sectionTitle}>{title}</Text>\r\n        <TouchableOpacity onPress={toggleEditMode}>\r\n          <MaterialCommunityIcons name=\"pencil\" size={20} color={theme.colors.primary} />\r\n        </TouchableOpacity>\r\n      </View>\r\n      {renderEditableField()}\r\n    </View>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  section: {\r\n    width: '100%',\r\n    maxWidth: 600,\r\n    // marginBottom: 20,\r\n    paddingVertical: 20,\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: theme.colors.border,\r\n  },\r\n  sectionHeader: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    width: '100%',\r\n    marginBottom: 10,\r\n  },\r\n  sectionTitle: {\r\n    fontSize: theme.fontSizes.large,\r\n    marginBottom: 10,\r\n    fontWeight: 'bold',\r\n    color: theme.colors.primary,\r\n  },\r\n  input: {\r\n    width: '100%',\r\n    maxWidth: 600,\r\n    marginBottom: 10,\r\n    backgroundColor: theme.colors.surface,\r\n    padding: 10,\r\n    borderRadius: 5,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n  },\r\n  fieldText: {\r\n    width: '100%',\r\n    maxWidth: 600,\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.text,\r\n    marginBottom: 10,\r\n  },\r\n});\r\n\r\nexport default EditableSection;","import React, { useState } from 'react';\r\nimport {\r\n  View,\r\n  Text,\r\n  Image,\r\n  TouchableOpacity,\r\n  ScrollView,\r\n  StyleSheet,\r\n  Modal,\r\n} from 'react-native';\r\nimport { MaterialCommunityIcons, Ionicons } from '@expo/vector-icons';\r\nimport ServiceManager from './ServiceManager';\r\nimport { theme } from '../styles/theme';\r\nimport RecordedPets from './RecordedPets';\r\nimport EditableSection from './EditableSection';\r\nimport * as ImagePicker from 'expo-image-picker';\r\n\r\nconst ProfessionalTab = ({ \r\n  services, \r\n  setServices, \r\n  setHasUnsavedChanges,\r\n  getContentWidth,\r\n  pets,\r\n  editMode,\r\n  toggleEditMode\r\n}) => {\r\n  const [professionalPhoto, setProfessionalPhoto] = useState(null);\r\n  const [professionalBio, setProfessionalBio] = useState('');\r\n  const [portfolioPhotos, setPortfolioPhotos] = useState([]);\r\n  const [facilities, setFacilities] = useState('');\r\n  const [skills, setSkills] = useState({\r\n    certifications: [],\r\n    experience: '',\r\n    specialties: [],\r\n  });\r\n  const [selectedFacilities, setSelectedFacilities] = useState([]);\r\n  const [facilitiesModalVisible, setFacilitiesModalVisible] = useState(false);\r\n  const [tempSelectedFacilities, setTempSelectedFacilities] = useState([]);\r\n\r\n  const FACILITY_OPTIONS = [\r\n    // Living Situation\r\n    { id: 'apartment', label: 'Lives in an apartment' },\r\n    { id: 'house', label: 'Lives in a house' },\r\n    { id: 'fenced_yard', label: 'Has a fenced yard' },\r\n    \r\n    // Household Environment\r\n    { id: 'non_smoking', label: 'Non-smoking household' },\r\n    { id: 'no_children', label: 'No children present' },\r\n    { id: 'has_children', label: 'Children present' },\r\n    { id: 'security_system', label: 'Has security system' },\r\n    \r\n    // Pet Policies\r\n    { id: 'dogs_bed', label: 'Dogs allowed on bed' },\r\n    { id: 'dogs_furniture', label: 'Dogs allowed on furniture' },\r\n    { id: 'crate_available', label: 'Crate available' },\r\n    { id: 'separate_areas', label: 'Can separate pets' },\r\n    \r\n    // Care Details\r\n    { id: 'potty_0_2', label: 'Potty breaks every 0-2 hours' },\r\n    { id: 'potty_2_4', label: 'Potty breaks every 2-4 hours' },\r\n    { id: 'potty_4_6', label: 'Potty breaks every 4-6 hours' },\r\n    \r\n    // Resident Pets\r\n    { id: 'no_pets', label: 'No resident pets' },\r\n    { id: 'has_dogs', label: 'Has resident dogs' },\r\n    { id: 'has_cats', label: 'Has resident cats' },\r\n    \r\n    // Additional Features\r\n    { id: 'air_conditioned', label: 'Air-conditioned' },\r\n    { id: 'outdoor_area', label: 'Has outdoor play area' },\r\n    { id: 'emergency_transport', label: 'Emergency transport available' },\r\n  ];\r\n\r\n  const pickProfessionalPhoto = async () => {\r\n    let result = await ImagePicker.launchImageLibraryAsync({\r\n      mediaTypes: ImagePicker.MediaTypeOptions.Images,\r\n      allowsEditing: true,\r\n      aspect: [1, 1],\r\n      quality: 1,\r\n    });\r\n\r\n    if (!result.canceled) {\r\n      setProfessionalPhoto(result.assets[0].uri);\r\n      setHasUnsavedChanges(true);\r\n    }\r\n  };\r\n\r\n  const addPortfolioPhoto = async () => {\r\n    let result = await ImagePicker.launchImageLibraryAsync({\r\n      mediaTypes: ImagePicker.MediaTypeOptions.Images,\r\n      allowsEditing: false,\r\n      quality: 1,\r\n      aspect: [4, 3],\r\n      allowsMultipleSelection: true,\r\n      selectionLimit: 10,\r\n    });\r\n\r\n    if (!result.canceled) {\r\n      const newPhotos = result.assets.map(asset => ({\r\n        id: Date.now().toString() + Math.random().toString(36).substr(2, 9),\r\n        uri: asset.uri,\r\n        caption: 'New portfolio photo'\r\n      }));\r\n      \r\n      setPortfolioPhotos(prev => [...prev, ...newPhotos]);\r\n      setHasUnsavedChanges(true);\r\n    }\r\n  };\r\n\r\n  const renderEditableField = (label, value, onChangeText, section, multiline = false) => {\r\n    return editMode[section] ? (\r\n      <TextInput\r\n        value={value}\r\n        onChangeText={(text) => {\r\n          onChangeText(text);\r\n          setHasUnsavedChanges(true);\r\n        }}\r\n        style={[\r\n          styles.input,\r\n          { width: getContentWidth() },\r\n          multiline && { height: 100, textAlignVertical: 'top' }\r\n        ]}\r\n        multiline={multiline}\r\n        numberOfLines={multiline ? 4 : 1}\r\n      />\r\n    ) : (\r\n      <Text style={[styles.fieldText, { width: getContentWidth() }]}>\r\n        {value || `No ${label.toLowerCase()} provided`}\r\n      </Text>\r\n    );\r\n  };\r\n\r\n  const toggleFacility = (facilityId) => {\r\n    setSelectedFacilities(prev => {\r\n      if (prev.includes(facilityId)) {\r\n        return prev.filter(id => id !== facilityId);\r\n      } else {\r\n        return [...prev, facilityId];\r\n      }\r\n    });\r\n    setHasUnsavedChanges(true);\r\n  };\r\n\r\n  const openFacilitiesModal = () => {\r\n    setTempSelectedFacilities([...selectedFacilities]);\r\n    setFacilitiesModalVisible(true);\r\n  };\r\n\r\n  const saveFacilities = () => {\r\n    setSelectedFacilities(tempSelectedFacilities);\r\n    setFacilitiesModalVisible(false);\r\n    setHasUnsavedChanges(true);\r\n  };\r\n\r\n  const toggleTempFacility = (facilityId) => {\r\n    setTempSelectedFacilities(prev => {\r\n      if (prev.includes(facilityId)) {\r\n        return prev.filter(id => id !== facilityId);\r\n      } else {\r\n        return [...prev, facilityId];\r\n      }\r\n    });\r\n  };\r\n\r\n  return (\r\n    <View style={styles.centeredContent}>\r\n      {/* Professional Photo Section */}\r\n      <View style={styles.section}>\r\n        <View style={styles.sectionHeader}>\r\n          <Text style={styles.sectionTitle}>Profile Photo (Professional)</Text>\r\n        </View>\r\n        <View style={styles.profileHeader}>\r\n          <TouchableOpacity onPress={pickProfessionalPhoto}>\r\n            {professionalPhoto ? (\r\n              <Image source={{ uri: professionalPhoto }} style={styles.profilePhoto} />\r\n            ) : (\r\n              <View style={[styles.profilePhoto, styles.profilePhotoPlaceholder]}>\r\n                <Ionicons name=\"person\" size={60} color={theme.colors.placeholder} />\r\n              </View>\r\n            )}\r\n          </TouchableOpacity>\r\n        </View>\r\n      </View>\r\n\r\n      {/* Professional Bio Section */}\r\n      <EditableSection\r\n        title=\"Professional Bio\"\r\n        value={professionalBio}\r\n        onChangeText={setProfessionalBio}\r\n        editMode={editMode.professionalBio}\r\n        toggleEditMode={() => toggleEditMode('professionalBio')}\r\n        setHasUnsavedChanges={setHasUnsavedChanges}\r\n        getContentWidth={getContentWidth}\r\n      />\r\n\r\n      {/* Services Section */}\r\n      <View style={styles.section}>\r\n        <ServiceManager\r\n          services={services || []}\r\n          setServices={setServices}\r\n          setHasUnsavedChanges={setHasUnsavedChanges}\r\n          isProfessionalTab={true}\r\n        />\r\n      </View>\r\n\r\n      {/* Portfolio Photos Section */}\r\n      <View style={styles.section}>\r\n        <View style={styles.sectionHeader}>\r\n          <Text style={styles.sectionTitle}>Portfolio Photos</Text>\r\n          <TouchableOpacity onPress={addPortfolioPhoto}>\r\n            <MaterialCommunityIcons \r\n              name=\"plus\" \r\n              size={24} \r\n              color={theme.colors.primary} \r\n            />\r\n          </TouchableOpacity>\r\n        </View>\r\n        <View style={styles.portfolioGrid}>\r\n          {portfolioPhotos.map((photo) => (\r\n            <TouchableOpacity \r\n              key={photo.id} \r\n              style={styles.portfolioCard}\r\n              onPress={() => {\r\n                // Handle photo edit/view\r\n                // Could add modal to edit caption or view full size\r\n              }}\r\n            >\r\n              <View style={styles.portfolioImageContainer}>\r\n                <Image \r\n                  source={{ uri: photo.uri }} \r\n                  style={styles.portfolioPhoto} \r\n                />\r\n              </View>\r\n              <Text style={styles.portfolioCaption}>{photo.caption}</Text>\r\n            </TouchableOpacity>\r\n          ))}\r\n        </View>\r\n        {portfolioPhotos.length === 0 && (\r\n          <Text style={styles.emptyText}>\r\n            No portfolio photos added yet\r\n          </Text>\r\n        )}\r\n      </View>\r\n        \r\n      { /* My Pets Section (Read-Only) */}\r\n      <RecordedPets pets={pets} />\r\n\r\n      {/* Home & Facilities Section */}\r\n      <View style={styles.section}>\r\n        <View style={styles.sectionHeader}>\r\n          <Text style={styles.sectionTitle}>Home & Facilities</Text>\r\n          <TouchableOpacity onPress={openFacilitiesModal}>\r\n            <MaterialCommunityIcons \r\n              name=\"pencil\" \r\n              size={24} \r\n              color={theme.colors.primary} \r\n            />\r\n          </TouchableOpacity>\r\n        </View>\r\n        <View style={styles.facilitiesContainer}>\r\n          {selectedFacilities.map((facilityId) => {\r\n            const facility = FACILITY_OPTIONS.find(f => f.id === facilityId);\r\n            return (\r\n              <View key={facilityId} style={styles.facilityTag}>\r\n                <Text style={styles.facilityTagText}>{facility.label}</Text>\r\n              </View>\r\n            );\r\n          })}\r\n          {selectedFacilities.length === 0 && (\r\n            <Text style={styles.emptyText}>No facilities selected</Text>\r\n          )}\r\n        </View>\r\n\r\n        {/* Facilities Selection Modal */}\r\n        <Modal\r\n          visible={facilitiesModalVisible}\r\n          transparent={true}\r\n          animationType=\"slide\"\r\n          onRequestClose={() => setFacilitiesModalVisible(false)}\r\n        >\r\n          <View style={styles.modalOverlay}>\r\n            <View style={styles.modalContent}>\r\n              <View style={styles.modalHeader}>\r\n                <Text style={styles.modalTitle}>Select Home & Facilities</Text>\r\n                <TouchableOpacity onPress={() => setFacilitiesModalVisible(false)}>\r\n                  <MaterialCommunityIcons name=\"close\" size={24} color={theme.colors.text} />\r\n                </TouchableOpacity>\r\n              </View>\r\n              \r\n              <ScrollView style={styles.modalScroll}>\r\n                {FACILITY_OPTIONS.map((facility) => (\r\n                  <TouchableOpacity\r\n                    key={facility.id}\r\n                    style={[\r\n                      styles.modalFacilityTag,\r\n                      tempSelectedFacilities.includes(facility.id) && styles.facilityTagSelected\r\n                    ]}\r\n                    onPress={() => toggleTempFacility(facility.id)}\r\n                  >\r\n                    <Text style={[\r\n                      styles.modalFacilityText,\r\n                      tempSelectedFacilities.includes(facility.id) && styles.facilityTagTextSelected\r\n                    ]}>\r\n                      {facility.label}\r\n                    </Text>\r\n                  </TouchableOpacity>\r\n                ))}\r\n              </ScrollView>\r\n\r\n              <View style={styles.modalFooter}>\r\n                <TouchableOpacity \r\n                  style={[styles.modalButton, styles.cancelButton]}\r\n                  onPress={() => setFacilitiesModalVisible(false)}\r\n                >\r\n                  <Text style={styles.modalButtonText}>Cancel</Text>\r\n                </TouchableOpacity>\r\n                <TouchableOpacity \r\n                  style={[styles.modalButton, styles.saveButton]}\r\n                  onPress={saveFacilities}\r\n                >\r\n                  <Text style={styles.modalButtonText2}>Save</Text>\r\n                </TouchableOpacity>\r\n              </View>\r\n            </View>\r\n          </View>\r\n        </Modal>\r\n      </View>\r\n\r\n      {/* Skills & Experience Section */}\r\n      {/* <View style={styles.section}>\r\n        <View style={styles.sectionHeader}>\r\n          <Text style={styles.sectionTitle}>Skills & Experience</Text>\r\n          <TouchableOpacity onPress={() => toggleEditMode('skills')}>\r\n            <MaterialCommunityIcons name=\"pencil\" size={20} color={theme.colors.primary} />\r\n          </TouchableOpacity>\r\n        </View>\r\n        {renderEditableField('Experience', skills.experience, \r\n          (text) => setSkills(prev => ({ ...prev, experience: text })), \r\n          'skills', \r\n          true\r\n        )}\r\n      </View> */}\r\n    </View>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  centeredContent: {\r\n    width: '100%',\r\n    maxWidth: 600,\r\n    alignItems: 'center',\r\n    alignSelf: 'center',\r\n  },\r\n  section: {\r\n    width: '100%',\r\n    maxWidth: 600,\r\n    marginBottom: 20,\r\n    paddingVertical: 20,\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: theme.colors.border,\r\n  },\r\n  sectionHeader: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    width: '100%',\r\n    marginBottom: 10,\r\n  },\r\n  sectionTitle: {\r\n    fontSize: theme.fontSizes.large,\r\n    marginBottom: 10,\r\n    fontWeight: 'bold',\r\n    color: theme.colors.primary,\r\n  },\r\n  profileHeader: {\r\n    alignItems: 'center',\r\n    marginBottom: 20,\r\n    width: '100%',\r\n    maxWidth: 600,\r\n  },\r\n  profilePhoto: {\r\n    width: 120,\r\n    height: 120,\r\n    borderRadius: 60,\r\n  },\r\n  profilePhotoPlaceholder: {\r\n    backgroundColor: theme.colors.surface,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n  },\r\n  input: {\r\n    width: '100%',\r\n    maxWidth: 600,\r\n    marginBottom: 10,\r\n    backgroundColor: theme.colors.surface,\r\n    padding: 10,\r\n    borderRadius: 5,\r\n  },\r\n  fieldText: {\r\n    width: '100%',\r\n    maxWidth: 600,\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.text,\r\n    marginBottom: 10,\r\n  },\r\n  portfolioGrid: {\r\n    width: '100%',\r\n    flexDirection: 'row',\r\n    flexWrap: 'wrap',\r\n    justifyContent: 'space-between',\r\n    gap: 16,\r\n  },\r\n  portfolioCard: {\r\n    width: '48%',\r\n    marginBottom: 16,\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 8,\r\n    overflow: 'hidden',\r\n    elevation: 2,\r\n    shadowColor: \"#000\",\r\n    shadowOffset: {\r\n      width: 0,\r\n      height: 2,\r\n    },\r\n    shadowOpacity: 0.23,\r\n    shadowRadius: 2.62,\r\n  },\r\n  portfolioImageContainer: {\r\n    aspectRatio: 4/3,\r\n    width: '100%',\r\n  },\r\n  portfolioPhoto: {\r\n    width: '100%',\r\n    height: '100%',\r\n    borderTopLeftRadius: 8,\r\n    borderTopRightRadius: 8,\r\n  },\r\n  portfolioCaption: {\r\n    fontSize: theme.fontSizes.small,\r\n    color: theme.colors.text,\r\n    padding: 8,\r\n  },\r\n  emptyText: {\r\n    textAlign: 'center',\r\n    color: theme.colors.placeholder,\r\n    marginTop: 16,\r\n  },\r\n  facilitiesContainer: {\r\n    flexDirection: 'row',\r\n    flexWrap: 'wrap',\r\n    gap: 8,\r\n    paddingHorizontal: 4,\r\n  },\r\n  facilityTag: {\r\n    paddingHorizontal: 16,\r\n    paddingVertical: 8,\r\n    borderRadius: 20,\r\n    backgroundColor: theme.colors.surface,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.primary,\r\n    marginBottom: 8,\r\n  },\r\n  facilityTagSelected: {\r\n    backgroundColor: theme.colors.primary,\r\n  },\r\n  facilityTagText: {\r\n    color: theme.colors.primary,\r\n    fontSize: theme.fontSizes.small,\r\n  },\r\n  facilityTagTextSelected: {\r\n    color: theme.colors.surface,\r\n  },\r\n  modalOverlay: {\r\n    flex: 1,\r\n    backgroundColor: 'rgba(0, 0, 0, 0.5)',\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n  },\r\n  modalContent: {\r\n    width: '90%',\r\n    maxWidth: 500,\r\n    backgroundColor: theme.colors.background,\r\n    borderRadius: 10,\r\n    padding: 20,\r\n    maxHeight: '80%',\r\n  },\r\n  modalHeader: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    marginBottom: 20,\r\n  },\r\n  modalTitle: {\r\n    fontSize: theme.fontSizes.large,\r\n    fontWeight: 'bold',\r\n  },\r\n  modalScroll: {\r\n    maxHeight: '70%',\r\n  },\r\n  modalFacilityTag: {\r\n    padding: 16,\r\n    borderRadius: 8,\r\n    backgroundColor: theme.colors.surface,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.primary,\r\n    marginBottom: 8,\r\n  },\r\n  modalFacilityText: {\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.primary,\r\n  },\r\n  modalFooter: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    marginTop: 20,\r\n  },\r\n  modalButton: {\r\n    padding: 12,\r\n    borderRadius: 8,\r\n    width: '48%',\r\n    alignItems: 'center',\r\n  },\r\n  saveButton: {\r\n    backgroundColor: theme.colors.primary,\r\n  },\r\n  cancelButton: {\r\n    backgroundColor: theme.colors.surface,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.primary,\r\n  },\r\n  modalButtonText: {\r\n    color: theme.colors.primary,\r\n    fontSize: theme.fontSizes.medium,\r\n    fontWeight: 'bold',\r\n  },\r\n  modalButtonText2: {\r\n    color: theme.colors.whiteText,\r\n    fontSize: theme.fontSizes.medium,\r\n    fontWeight: 'bold',\r\n  },\r\n});\r\n\r\nexport default ProfessionalTab;","import React, { useState } from 'react';\r\nimport { Platform, TouchableOpacity, Text, StyleSheet } from 'react-native';\r\nimport DateTimePicker from '@react-native-community/datetimepicker';\r\nimport { theme } from '../styles/theme';\r\n\r\n// Called in DefaultSettingsModal.js\r\n// Called in MyProfile.js\r\n\r\nconst DatePicker = ({ \r\n  value, \r\n  onChange, \r\n  placeholder = 'Select Date',\r\n  displayFormat = (date) => date, // Optional custom display format\r\n  disabled = false,\r\n  isInModal = false // New prop to handle modal context differently\r\n}) => {\r\n  const [showDatePicker, setShowDatePicker] = useState(false);\r\n  const dateValue = value ? new Date(value) : new Date();\r\n\r\n  const handleChange = (event, selectedDate) => {\r\n    const currentDate = selectedDate || dateValue;\r\n    \r\n    // Only close picker on Android after selection\r\n    if (Platform.OS === 'android') {\r\n      setShowDatePicker(false);\r\n    }\r\n    \r\n    if (selectedDate) {\r\n      onChange(currentDate.toISOString().split('T')[0]);\r\n    }\r\n  };\r\n\r\n  if (Platform.OS === 'web') {\r\n    const handleWrapperEvents = (e) => {\r\n      if (isInModal) {\r\n        e.stopPropagation();\r\n        e.preventDefault();\r\n      }\r\n    };\r\n\r\n    const handleInputChange = (e) => {\r\n      if (!disabled) {\r\n        onChange(e.target.value);\r\n      }\r\n    };\r\n\r\n    return (\r\n      <div \r\n        onClick={handleWrapperEvents}\r\n        onMouseDown={handleWrapperEvents}\r\n      >\r\n        <input\r\n          type=\"date\"\r\n          value={value || ''}\r\n          onChange={handleInputChange}\r\n          style={{\r\n            ...styles.webDatePicker,\r\n            ...(disabled ? styles.disabledInput : {}),\r\n            cursor: disabled ? 'default' : 'pointer'\r\n          }}\r\n          placeholder={placeholder}\r\n          disabled={disabled}\r\n        />\r\n      </div>\r\n    );\r\n  } else if (Platform.OS === 'ios') {\r\n    return (\r\n      <DateTimePicker\r\n        value={dateValue}\r\n        mode=\"date\"\r\n        display=\"default\"\r\n        onChange={handleChange}\r\n        disabled={disabled}\r\n      />\r\n    );\r\n  } else {\r\n    return (\r\n      <>\r\n        <TouchableOpacity \r\n          onPress={() => !disabled && setShowDatePicker(true)}\r\n          style={[\r\n            styles.androidButton,\r\n            disabled && styles.disabledInput\r\n          ]}\r\n          disabled={disabled}\r\n        >\r\n          <Text style={[\r\n            styles.dateText,\r\n            disabled && styles.disabledText\r\n          ]}>\r\n            {value ? displayFormat(value) : placeholder}\r\n          </Text>\r\n        </TouchableOpacity>\r\n        {Platform.OS === 'android' && showDatePicker && (\r\n          <DateTimePicker\r\n            value={dateValue}\r\n            mode=\"date\"\r\n            display=\"default\"\r\n            onChange={handleChange}\r\n            disabled={disabled}\r\n          />\r\n        )}\r\n      </>\r\n    );\r\n  }\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  webDatePicker: {\r\n    padding: 8,\r\n    borderRadius: 8,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    fontSize: theme.fontSizes.medium,\r\n    width: '100%',\r\n    backgroundColor: theme.colors.background,\r\n  },\r\n  androidButton: {\r\n    padding: 8,\r\n    borderRadius: 4,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    backgroundColor: theme.colors.background,\r\n  },\r\n  dateText: {\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.text,\r\n  },\r\n  disabledInput: {\r\n    backgroundColor: theme.colors.disabled,\r\n    opacity: 0.7,\r\n  },\r\n  disabledText: {\r\n    color: theme.colors.placeholder,\r\n  }\r\n});\r\n\r\nexport default DatePicker;","import React from 'react';\r\nimport { View, Text, TouchableOpacity, StyleSheet } from 'react-native';\r\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\r\nimport { theme } from '../styles/theme';\r\nimport { useNavigation } from '@react-navigation/native';\r\n\r\nconst BackHeader = ({ \r\n  title, \r\n  onBackPress, \r\n  rightIcon = null, // Optional right icon\r\n  onRightPress = null, // Optional right icon press handler\r\n  rightComponent = null, // Add this prop\r\n  customStyles = {} \r\n}) => {\r\n  const navigation = useNavigation();\r\n\r\n  return (\r\n    <View style={[styles.header, customStyles]}>\r\n      <TouchableOpacity onPress={onBackPress} style={styles.backButton}>\r\n        <MaterialCommunityIcons \r\n          name=\"arrow-left\" \r\n          size={24} \r\n          color={theme.colors.primary} \r\n        />\r\n      </TouchableOpacity>\r\n      \r\n      <Text style={styles.headerText}>{title}</Text>\r\n      \r\n      {rightComponent ? rightComponent : (\r\n        rightIcon && (\r\n          <TouchableOpacity \r\n            onPress={onRightPress} \r\n            style={styles.rightButton}\r\n          >\r\n            <MaterialCommunityIcons \r\n              name={rightIcon} \r\n              size={24} \r\n              color={theme.colors.primary} \r\n            />\r\n          </TouchableOpacity>\r\n        )\r\n      )}\r\n    </View>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  header: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    padding: 16,\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: theme.colors.border,\r\n    backgroundColor: theme.colors.background,\r\n    zIndex: 100,\r\n    elevation: 100,\r\n  },\r\n  backButton: {\r\n    marginRight: 16,\r\n  },\r\n  headerText: {\r\n    fontSize: theme.fontSizes.large,\r\n    fontWeight: 'bold',\r\n    color: theme.colors.primary,\r\n    flex: 1, // This allows the title to take up remaining space\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n  },\r\n  rightButton: {\r\n    marginLeft: 16,\r\n  },\r\n});\r\n\r\nexport default BackHeader;","import React, { useState, useEffect } from 'react';\r\nimport { View, SafeAreaView, Platform, StatusBar, StyleSheet, Dimensions } from 'react-native';\r\nimport { theme } from '../styles/theme';\r\n\r\nconst CrossPlatformView = ({ \r\n  children, \r\n  style,\r\n  useSafeArea = true,\r\n  backgroundColor = theme.colors.background,\r\n  fullWidthHeader = false,\r\n  contentWidth = '800px'\r\n}) => {\r\n  const [windowWidth, setWindowWidth] = useState(Dimensions.get('window').width);\r\n\r\n  useEffect(() => {\r\n    if (Platform.OS === 'web') {\r\n      const updateDimensions = () => {\r\n        setWindowWidth(Dimensions.get('window').width);\r\n      };\r\n\r\n      window.addEventListener('resize', updateDimensions);\r\n      return () => {\r\n        window.removeEventListener('resize', updateDimensions);\r\n      };\r\n    }\r\n  }, []);\r\n\r\n  // For web platform\r\n  if (Platform.OS === 'web') {\r\n    // Split children into header and content if fullWidthHeader is true\r\n    const headerContent = fullWidthHeader ? children[0] : null;\r\n    const mainContent = fullWidthHeader ? children.slice(1) : children;\r\n\r\n    return (\r\n      <div style={{ \r\n        backgroundColor,\r\n        width: '100%',\r\n        maxWidth: '100%',\r\n        minHeight: '100vh',\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        ...style,\r\n      }}>\r\n        {fullWidthHeader && (\r\n          <div style={{ \r\n            width: '100%', \r\n            backgroundColor,\r\n          }}>\r\n            {headerContent}\r\n          </div>\r\n        )}\r\n        <div style={{\r\n          ...styles.webContainer,\r\n          maxWidth: contentWidth,\r\n          width: '100%',\r\n          flex: 1,\r\n          overflow: 'hidden',\r\n        }}>\r\n          {mainContent}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // For iOS\r\n  if (Platform.OS === 'ios' && useSafeArea) {\r\n    return (\r\n      <SafeAreaView style={[styles.container, { backgroundColor }, style]}>\r\n        {children}\r\n      </SafeAreaView>\r\n    );\r\n  }\r\n\r\n  // For Android or when SafeAreaView is disabled\r\n  return (\r\n    <View style={[\r\n      styles.container,\r\n      { \r\n        paddingTop: useSafeArea ? StatusBar.currentHeight : 0,\r\n        backgroundColor \r\n      },\r\n      style\r\n    ]}>\r\n      {children}\r\n    </View>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    backgroundColor: theme.colors.background,\r\n    paddingTop: Platform.OS === 'android' ? StatusBar.currentHeight : 0,\r\n    width: '100%',\r\n    maxWidth: '100%',\r\n    overflow: 'hidden',\r\n  },\r\n  webContainer: {\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    minHeight: '85vh',\r\n    width: '100%',\r\n    maxWidth: '100%',\r\n    overflow: 'hidden',\r\n  },\r\n});\r\n\r\nexport default CrossPlatformView;","import { debugLog } from '../context/AuthContext';\r\n\r\n// Colorado bounds for validation\r\nconst COLORADO_BOUNDS = {\r\n  north: 41.0,\r\n  south: 37.0,\r\n  east: -102.0,\r\n  west: -109.0\r\n};\r\n\r\nclass GeocodingQueue {\r\n  constructor() {\r\n    this.queue = [];\r\n    this.processing = false;\r\n    this.lastRequest = 0;\r\n    this.minInterval = 1100; // 1.1 seconds to be safe with Nominatim rate limit\r\n  }\r\n\r\n  async geocode(address) {\r\n    return new Promise((resolve, reject) => {\r\n      this.queue.push({ address, resolve, reject });\r\n      this.processQueue();\r\n    });\r\n  }\r\n\r\n  async processQueue() {\r\n    if (this.processing || this.queue.length === 0) {\r\n      return;\r\n    }\r\n\r\n    this.processing = true;\r\n\r\n    while (this.queue.length > 0) {\r\n      const { address, resolve, reject } = this.queue.shift();\r\n      \r\n      try {\r\n        // Ensure we don't exceed rate limit\r\n        const now = Date.now();\r\n        const timeSinceLastRequest = now - this.lastRequest;\r\n        \r\n        if (timeSinceLastRequest < this.minInterval) {\r\n          const waitTime = this.minInterval - timeSinceLastRequest;\r\n          debugLog('MBA7890', `Rate limiting: waiting ${waitTime}ms before next geocoding request`);\r\n          await new Promise(resolve => setTimeout(resolve, waitTime));\r\n        }\r\n\r\n        this.lastRequest = Date.now();\r\n        const result = await this.performGeocode(address);\r\n        resolve(result);\r\n      } catch (error) {\r\n        reject(error);\r\n      }\r\n    }\r\n\r\n    this.processing = false;\r\n  }\r\n\r\n  async performGeocode(address) {\r\n    const { street, apartment, city, state, zip } = address;\r\n    \r\n    // Build the address string\r\n    let addressString = street;\r\n    if (apartment) {\r\n      addressString += ` ${apartment}`;\r\n    }\r\n    addressString += `, ${city}, ${state}`;\r\n    if (zip) {\r\n      addressString += ` ${zip}`;\r\n    }\r\n    addressString += ', USA';\r\n\r\n    debugLog('MBA7890', 'Geocoding address:', addressString);\r\n\r\n    const url = 'https://nominatim.openstreetmap.org/search';\r\n    const params = new URLSearchParams({\r\n      q: addressString,\r\n      format: 'json',\r\n      limit: '1',\r\n      countrycodes: 'us',\r\n      addressdetails: '1'\r\n    });\r\n\r\n    const response = await fetch(`${url}?${params}`, {\r\n      headers: {\r\n        'User-Agent': 'CrittrCove/1.0 (contact@crittrcove.com)' // Required by Nominatim\r\n      }\r\n    });\r\n\r\n    if (response.status === 429) {\r\n      throw new Error('RATE_LIMITED');\r\n    }\r\n\r\n    if (!response.ok) {\r\n      throw new Error(`Geocoding failed: ${response.status}`);\r\n    }\r\n\r\n    const data = await response.json();\r\n    \r\n    if (!data || data.length === 0) {\r\n      throw new Error('No results found');\r\n    }\r\n\r\n    const result = data[0];\r\n    const lat = parseFloat(result.lat);\r\n    const lng = parseFloat(result.lon);\r\n\r\n    // Validate coordinates are within Colorado\r\n    if (!this.isInColorado(lat, lng)) {\r\n      debugLog('MBA7890', 'Address is outside Colorado bounds:', { lat, lng, address: addressString });\r\n      throw new Error('Address must be within Colorado');\r\n    }\r\n\r\n    debugLog('MBA7890', 'Geocoding successful:', { lat, lng, address: addressString });\r\n    \r\n    return {\r\n      latitude: lat,\r\n      longitude: lng,\r\n      formatted_address: result.display_name\r\n    };\r\n  }\r\n\r\n  isInColorado(lat, lng) {\r\n    return lat >= COLORADO_BOUNDS.south && \r\n           lat <= COLORADO_BOUNDS.north && \r\n           lng >= COLORADO_BOUNDS.west && \r\n           lng <= COLORADO_BOUNDS.east;\r\n  }\r\n}\r\n\r\n// Create a singleton instance\r\nconst geocodingQueue = new GeocodingQueue();\r\n\r\n/**\r\n * Geocode an address with retry logic and rate limiting\r\n * @param {Object} address - Address object with street, city, state, zip\r\n * @param {number} maxRetries - Maximum number of retry attempts\r\n * @returns {Promise<Object>} - Coordinates object with latitude/longitude\r\n */\r\nexport const geocodeAddress = async (address, maxRetries = 3) => {\r\n  for (let attempt = 1; attempt <= maxRetries; attempt++) {\r\n    try {\r\n      const result = await geocodingQueue.geocode(address);\r\n      return result;\r\n    } catch (error) {\r\n      debugLog('MBA7890', `Geocoding attempt ${attempt} failed:`, error.message);\r\n      \r\n      if (error.message === 'RATE_LIMITED' && attempt < maxRetries) {\r\n        // Exponential backoff for rate limiting\r\n        const waitTime = Math.pow(2, attempt) * 1000;\r\n        debugLog('MBA7890', `Rate limited, waiting ${waitTime}ms before retry`);\r\n        await new Promise(resolve => setTimeout(resolve, waitTime));\r\n        continue;\r\n      }\r\n      \r\n      if (attempt === maxRetries) {\r\n        throw error;\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\n/**\r\n * Geocode an address with graceful fallback\r\n * Returns coordinates if successful, null if failed (but doesn't throw)\r\n * @param {Object} address - Address object\r\n * @returns {Promise<Object|null>} - Coordinates or null\r\n */\r\nexport const geocodeAddressGraceful = async (address) => {\r\n  try {\r\n    return await geocodeAddress(address);\r\n  } catch (error) {\r\n    debugLog('MBA7890', 'Geocoding failed gracefully:', error.message);\r\n    return null;\r\n  }\r\n};\r\n\r\n/**\r\n * Validate if coordinates are within Colorado bounds\r\n * @param {number} lat - Latitude\r\n * @param {number} lng - Longitude\r\n * @returns {boolean} - True if within Colorado\r\n */\r\nexport const isInColorado = (lat, lng) => {\r\n  return lat >= COLORADO_BOUNDS.south && \r\n         lat <= COLORADO_BOUNDS.north && \r\n         lng >= COLORADO_BOUNDS.west && \r\n         lng <= COLORADO_BOUNDS.east;\r\n}; ","import React, { useState, useEffect, useRef } from 'react';\r\nimport { View, TextInput, TouchableOpacity, Text, StyleSheet, FlatList, ActivityIndicator } from 'react-native';\r\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\r\nimport { theme } from '../styles/theme';\r\nimport { debugLog } from '../context/AuthContext';\r\n\r\n// Colorado bounds for validation\r\nconst COLORADO_BOUNDS = {\r\n  north: 41.0,\r\n  south: 37.0,\r\n  east: -102.0,\r\n  west: -109.0\r\n};\r\n\r\nclass AddressSearchQueue {\r\n  constructor() {\r\n    this.queue = [];\r\n    this.processing = false;\r\n    this.lastRequest = 0;\r\n    this.minInterval = 1100; // 1.1 seconds for Nominatim rate limit\r\n  }\r\n\r\n  async search(query) {\r\n    return new Promise((resolve, reject) => {\r\n      this.queue.push({ query, resolve, reject });\r\n      this.processQueue();\r\n    });\r\n  }\r\n\r\n  async processQueue() {\r\n    if (this.processing || this.queue.length === 0) {\r\n      return;\r\n    }\r\n\r\n    this.processing = true;\r\n\r\n    while (this.queue.length > 0) {\r\n      const { query, resolve, reject } = this.queue.shift();\r\n      \r\n      try {\r\n        // Ensure we don't exceed rate limit\r\n        const now = Date.now();\r\n        const timeSinceLastRequest = now - this.lastRequest;\r\n        \r\n        if (timeSinceLastRequest < this.minInterval) {\r\n          const waitTime = this.minInterval - timeSinceLastRequest;\r\n          await new Promise(resolve => setTimeout(resolve, waitTime));\r\n        }\r\n\r\n        this.lastRequest = Date.now();\r\n        const result = await this.performSearch(query);\r\n        resolve(result);\r\n      } catch (error) {\r\n        reject(error);\r\n      }\r\n    }\r\n\r\n    this.processing = false;\r\n  }\r\n\r\n  async performSearch(query) {\r\n    debugLog('MBA8901', 'Searching addresses for:', query);\r\n\r\n    const url = 'https://nominatim.openstreetmap.org/search';\r\n    const params = new URLSearchParams({\r\n      q: `${query}, Colorado, USA`,\r\n      format: 'json',\r\n      limit: '5',\r\n      countrycodes: 'us',\r\n      addressdetails: '1',\r\n      bounded: '1',\r\n      viewbox: `${COLORADO_BOUNDS.west},${COLORADO_BOUNDS.south},${COLORADO_BOUNDS.east},${COLORADO_BOUNDS.north}`\r\n    });\r\n\r\n    const response = await fetch(`${url}?${params}`, {\r\n      headers: {\r\n        'User-Agent': 'CrittrCove/1.0 (contact@crittrcove.com)'\r\n      }\r\n    });\r\n\r\n    if (response.status === 429) {\r\n      throw new Error('RATE_LIMITED');\r\n    }\r\n\r\n    if (!response.ok) {\r\n      throw new Error(`Search failed: ${response.status}`);\r\n    }\r\n\r\n    const data = await response.json();\r\n    \r\n    if (!data || data.length === 0) {\r\n      return [];\r\n    }\r\n\r\n    // Filter and format results\r\n    return data\r\n      .filter(result => {\r\n        const lat = parseFloat(result.lat);\r\n        const lng = parseFloat(result.lon);\r\n        return this.isInColorado(lat, lng);\r\n      })\r\n      .map(result => ({\r\n        id: result.place_id,\r\n        formatted_address: result.display_name,\r\n        components: {\r\n          street: result.address?.house_number && result.address?.road \r\n            ? `${result.address.house_number} ${result.address.road}`\r\n            : result.address?.road || '',\r\n          apartment: '',\r\n          city: result.address?.city || result.address?.town || result.address?.village || '',\r\n          state: result.address?.state || 'Colorado',\r\n          zip: result.address?.postcode || ''\r\n        },\r\n        coordinates: {\r\n          latitude: parseFloat(result.lat),\r\n          longitude: parseFloat(result.lon),\r\n          formatted_address: result.display_name\r\n        }\r\n      }));\r\n  }\r\n\r\n  isInColorado(lat, lng) {\r\n    return lat >= COLORADO_BOUNDS.south && \r\n           lat <= COLORADO_BOUNDS.north && \r\n           lng >= COLORADO_BOUNDS.west && \r\n           lng <= COLORADO_BOUNDS.east;\r\n  }\r\n}\r\n\r\n// Create singleton instance\r\nconst searchQueue = new AddressSearchQueue();\r\n\r\nconst AddressAutocomplete = ({ \r\n  value = '', \r\n  onAddressSelect, \r\n  placeholder = \"Enter your address...\",\r\n  style = {},\r\n  disabled = false \r\n}) => {\r\n  const [inputValue, setInputValue] = useState(value);\r\n  const [suggestions, setSuggestions] = useState([]);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [showSuggestions, setShowSuggestions] = useState(false);\r\n  const [selectedAddress, setSelectedAddress] = useState(null);\r\n  const searchTimeoutRef = useRef(null);\r\n\r\n  // Update input value when prop changes\r\n  useEffect(() => {\r\n    setInputValue(value);\r\n  }, [value]);\r\n\r\n  // Debounced search function\r\n  const searchAddresses = async (query) => {\r\n    if (query.length < 3) {\r\n      setSuggestions([]);\r\n      setShowSuggestions(false);\r\n      return;\r\n    }\r\n\r\n    setIsLoading(true);\r\n    \r\n    try {\r\n      const results = await searchQueue.search(query);\r\n      setSuggestions(results);\r\n      setShowSuggestions(results.length > 0);\r\n      debugLog('MBA8901', `Found ${results.length} address suggestions`);\r\n    } catch (error) {\r\n      debugLog('MBA8901', 'Address search failed:', error.message);\r\n      setSuggestions([]);\r\n      setShowSuggestions(false);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  // Handle input change with debouncing\r\n  const handleInputChange = (text) => {\r\n    setInputValue(text);\r\n    setSelectedAddress(null);\r\n\r\n    // Clear previous timeout\r\n    if (searchTimeoutRef.current) {\r\n      clearTimeout(searchTimeoutRef.current);\r\n    }\r\n\r\n    // Set new timeout for search\r\n    searchTimeoutRef.current = setTimeout(() => {\r\n      searchAddresses(text);\r\n    }, 500); // 500ms debounce\r\n  };\r\n\r\n  // Handle address selection\r\n  const handleAddressSelect = (address) => {\r\n    setInputValue(address.formatted_address);\r\n    setSelectedAddress(address);\r\n    setShowSuggestions(false);\r\n    setSuggestions([]);\r\n\r\n    // Notify parent component\r\n    if (onAddressSelect) {\r\n      onAddressSelect(address);\r\n    }\r\n\r\n    debugLog('MBA8901', 'Address selected:', address);\r\n  };\r\n\r\n  // Clear suggestions when input loses focus\r\n  const handleBlur = () => {\r\n    // Delay hiding suggestions to allow for selection\r\n    setTimeout(() => {\r\n      setShowSuggestions(false);\r\n    }, 200);\r\n  };\r\n\r\n  // Render suggestion item\r\n  const renderSuggestion = ({ item, index }) => (\r\n    <TouchableOpacity\r\n      style={[\r\n        styles.suggestionItem,\r\n        index === suggestions.length - 1 && styles.lastSuggestionItem\r\n      ]}\r\n      onPress={() => handleAddressSelect(item)}\r\n      activeOpacity={0.7}\r\n    >\r\n      <MaterialCommunityIcons \r\n        name=\"map-marker\" \r\n        size={20} \r\n        color={theme.colors.primary} \r\n        style={styles.suggestionIcon}\r\n      />\r\n      <View style={styles.suggestionContent}>\r\n        <Text style={styles.suggestionText} numberOfLines={2}>\r\n          {item.formatted_address}\r\n        </Text>\r\n      </View>\r\n    </TouchableOpacity>\r\n  );\r\n\r\n  return (\r\n    <View style={[styles.container, style]}>\r\n      <View style={styles.inputContainer}>\r\n        <TextInput\r\n          style={[\r\n            styles.input,\r\n            selectedAddress && styles.inputValid,\r\n            disabled && styles.inputDisabled\r\n          ]}\r\n          value={inputValue}\r\n          onChangeText={handleInputChange}\r\n          onBlur={handleBlur}\r\n          placeholder={placeholder}\r\n          placeholderTextColor={theme.colors.placeholder}\r\n          editable={!disabled}\r\n        />\r\n        \r\n        {isLoading && (\r\n          <ActivityIndicator \r\n            size=\"small\" \r\n            color={theme.colors.primary} \r\n            style={styles.loadingIndicator}\r\n          />\r\n        )}\r\n        \r\n        {selectedAddress && (\r\n          <MaterialCommunityIcons \r\n            name=\"check-circle\" \r\n            size={20} \r\n            color={theme.colors.success} \r\n            style={styles.validIcon}\r\n          />\r\n        )}\r\n      </View>\r\n\r\n      {showSuggestions && suggestions.length > 0 && (\r\n        <View style={styles.suggestionsContainer}>\r\n          <FlatList\r\n            data={suggestions}\r\n            renderItem={renderSuggestion}\r\n            keyExtractor={(item) => item.id.toString()}\r\n            style={styles.suggestionsList}\r\n            keyboardShouldPersistTaps=\"handled\"\r\n            showsVerticalScrollIndicator={false}\r\n          />\r\n        </View>\r\n      )}\r\n\r\n      {inputValue.length >= 3 && !isLoading && suggestions.length === 0 && showSuggestions && (\r\n        <View style={styles.noResultsContainer}>\r\n          <Text style={styles.noResultsText}>\r\n            No addresses found. Please check your spelling or try a different address.\r\n          </Text>\r\n        </View>\r\n      )}\r\n    </View>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    position: 'relative',\r\n    zIndex: 1000, // High enough to appear above modal buttons (which are at -1)\r\n  },\r\n  inputContainer: {\r\n    position: 'relative',\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n  },\r\n  input: {\r\n    flex: 1,\r\n    backgroundColor: theme.colors.background,\r\n    borderRadius: 8,\r\n    padding: 12,\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    minHeight: 44,\r\n  },\r\n  inputValid: {\r\n    borderColor: theme.colors.success,\r\n    backgroundColor: theme.colors.success + '10',\r\n  },\r\n  inputDisabled: {\r\n    backgroundColor: theme.colors.surface,\r\n    color: theme.colors.placeholder,\r\n  },\r\n  loadingIndicator: {\r\n    position: 'absolute',\r\n    right: 12,\r\n  },\r\n  validIcon: {\r\n    position: 'absolute',\r\n    right: 12,\r\n  },\r\n  suggestionsContainer: {\r\n    position: 'absolute',\r\n    top: '100%',\r\n    left: 0,\r\n    right: 0,\r\n    backgroundColor: theme.colors.background,\r\n    borderRadius: 8,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    borderTopWidth: 0,\r\n    borderTopLeftRadius: 0,\r\n    borderTopRightRadius: 0,\r\n    maxHeight: 200,\r\n    zIndex: 1001, // Higher than container, much higher than modal buttons (-1)\r\n    elevation: 10, // Reasonable elevation for Android\r\n    shadowColor: '#000',\r\n    shadowOffset: { width: 0, height: 4 },\r\n    shadowOpacity: 0.3,\r\n    shadowRadius: 6,\r\n  },\r\n  suggestionsList: {\r\n    maxHeight: 200,\r\n  },\r\n  suggestionItem: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    padding: 16,\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: theme.colors.border,\r\n    minHeight: 56,\r\n  },\r\n  lastSuggestionItem: {\r\n    borderBottomWidth: 0,\r\n  },\r\n  suggestionIcon: {\r\n    marginRight: 12,\r\n  },\r\n  suggestionContent: {\r\n    flex: 1,\r\n  },\r\n  suggestionText: {\r\n    fontSize: 14,\r\n    color: theme.colors.text,\r\n    lineHeight: 20,\r\n  },\r\n  noResultsContainer: {\r\n    position: 'absolute',\r\n    top: '100%',\r\n    left: 0,\r\n    right: 0,\r\n    backgroundColor: theme.colors.background,\r\n    borderRadius: 8,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    borderTopWidth: 0,\r\n    borderTopLeftRadius: 0,\r\n    borderTopRightRadius: 0,\r\n    padding: 16,\r\n    zIndex: 1001, // Same z-index as suggestions\r\n  },\r\n  noResultsText: {\r\n    fontSize: 14,\r\n    color: theme.colors.secondary,\r\n    textAlign: 'center',\r\n    fontStyle: 'italic',\r\n  },\r\n});\r\n\r\nexport default AddressAutocomplete; ","import React, { useState, useEffect, useContext } from 'react';\r\nimport { View, Text, TextInput, TouchableOpacity, StyleSheet, Image, Modal, Alert, ScrollView, ActivityIndicator, Platform } from 'react-native';\r\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\r\nimport { theme } from '../../styles/theme';\r\nimport * as Location from 'expo-location';\r\nimport * as ImagePicker from 'expo-image-picker';\r\nimport { AuthContext, debugLog } from '../../context/AuthContext';\r\nimport { updateProfileInfo } from '../../api/API';\r\nimport { useToast } from '../../components/ToastProvider';\r\nimport { geocodeAddressGraceful } from '../../utils/geocoding';\r\nimport AddressAutocomplete from '../AddressAutocomplete';\r\n\r\nconst FACILITY_PRESETS = [\r\n  { id: 'fenced_yard', icon: 'fence', title: 'Fenced Yard', description: 'Secure outdoor space for pets' },\r\n  { id: 'pet_door', icon: 'door', title: 'Pet Door', description: 'Easy access to outdoor areas' },\r\n  { id: 'air_conditioning', icon: 'air-conditioner', title: 'Climate Control', description: 'Temperature controlled environment' },\r\n  { id: 'security_cameras', icon: 'cctv', title: 'Security Cameras', description: '24/7 monitoring capability' },\r\n  { id: 'separate_room', icon: 'door-closed', title: 'Separate Pet Room', description: 'Dedicated space for pets' },\r\n  { id: 'pet_gates', icon: 'gate', title: 'Pet Gates', description: 'Indoor barriers for pet safety' },\r\n  { id: 'pool', icon: 'pool', title: 'Pool', description: 'Swimming area (with safety features)' },\r\n  { id: 'cleaning_station', icon: 'shower-head', title: 'Pet Cleaning Station', description: 'Dedicated pet washing area' },\r\n  { id: 'first_aid', icon: 'medical-bag', title: 'Pet First Aid Kit', description: 'Emergency medical supplies' },\r\n  { id: 'food_storage', icon: 'food-variant', title: 'Pet Food Storage', description: 'Dedicated food storage area' },\r\n];\r\n\r\nconst INSURANCE_OPTIONS = [\r\n  { id: 'none', label: 'No Insurance', description: 'I do not have insurance' },\r\n  { id: 'petplan', label: 'PetPlan Insurance', description: 'Comprehensive pet insurance coverage' },\r\n  { id: 'trupanion', label: 'Trupanion', description: 'Lifetime coverage for your pets' },\r\n  { id: 'custom', label: 'Custom Insurance', description: 'Upload my own insurance card' }\r\n];\r\n\r\n// Legacy AddressForm - keeping for reference but not used\r\nconst AddressForm = ({ address, setAddress }) => (\r\n  <View style={styles.addressForm}>\r\n    <TextInput\r\n      style={styles.addressInput}\r\n      value={address.street}\r\n      onChangeText={(text) => setAddress(prev => ({ ...prev, street: text }))}\r\n      placeholder=\"Street Address\"\r\n    />\r\n    <TextInput\r\n      style={styles.addressInput}\r\n      value={address.apartment}\r\n      onChangeText={(text) => setAddress(prev => ({ ...prev, apartment: text }))}\r\n      placeholder=\"Apartment/Suite (optional)\"\r\n    />\r\n    <View style={styles.addressRow}>\r\n      <TextInput\r\n        style={[styles.addressInput, { flex: 2 }]}\r\n        value={address.city}\r\n        onChangeText={(text) => setAddress(prev => ({ ...prev, city: text }))}\r\n        placeholder=\"City\"\r\n      />\r\n      <TextInput\r\n        style={[styles.addressInput, { flex: 1 }]}\r\n        value={address.state || 'Colorado'}\r\n        onChangeText={(text) => setAddress(prev => ({ ...prev, state: text }))}\r\n        placeholder=\"State\"\r\n      />\r\n    </View>\r\n    <TextInput\r\n      style={styles.addressInput}\r\n      value={address.zip}\r\n      onChangeText={(text) => setAddress(prev => ({ ...prev, zip: text }))}\r\n      placeholder=\"ZIP Code\"\r\n      keyboardType=\"numeric\"\r\n    />\r\n  </View>\r\n);\r\n\r\nconst EditOverlay = ({ visible, onClose, title, value, onSave, isLocation, isMultiline, isProfessional, isInsurance, selectedInsurance = { type: 'none', card: null }, onInsuranceChange }) => {\r\n  const [localValue, setLocalValue] = useState('');\r\n  const [localInsurance, setLocalInsurance] = useState(selectedInsurance);\r\n  const [isLoadingLocation, setIsLoadingLocation] = useState(false);\r\n  const [selectedAddress, setSelectedAddress] = useState(null);\r\n  const [currentAddressValue, setCurrentAddressValue] = useState('');\r\n  const [insuranceStep, setInsuranceStep] = useState(1); // 1: Choose type, 2: Upload/Select insurance\r\n  const [insuranceType, setInsuranceType] = useState(null); // 'own' or 'platform'\r\n\r\n  useEffect(() => {\r\n    if (visible) {\r\n      if (isInsurance) {\r\n        setLocalInsurance(selectedInsurance);\r\n        setInsuranceStep(1);\r\n        setInsuranceType(null);\r\n      } else if (isLocation) {\r\n        // Initialize address autocomplete with current value\r\n        setCurrentAddressValue(value || '');\r\n        setSelectedAddress(null);\r\n      } else {\r\n        setLocalValue(value || '');\r\n      }\r\n    }\r\n  }, [visible]); // Only depend on visibility changing - nothing else\r\n\r\n  const handleSave = () => {\r\n    if (isInsurance) {\r\n      onSave(localInsurance);\r\n    } else if (isLocation) {\r\n      if (!selectedAddress) {\r\n        // Show error - address must be validated\r\n        Alert.alert('Invalid Address', 'Please select a valid address from the suggestions.');\r\n        return;\r\n      }\r\n      // Pass the selected address object with all components and coordinates\r\n      debugLog('MBA8901', 'Saving location with selected address:', selectedAddress);\r\n      onSave(selectedAddress);\r\n    } else {\r\n      onSave(localValue);\r\n    }\r\n    onClose();\r\n  };\r\n\r\n  const handleInsuranceTypeSelect = (type) => {\r\n    setInsuranceType(type);\r\n    setInsuranceStep(2);\r\n  };\r\n\r\n  const handleInsuranceChange = async (insuranceType) => {\r\n    if (insuranceType === 'custom') {\r\n      const result = await ImagePicker.launchImageLibraryAsync({\r\n        mediaTypes: ImagePicker.MediaTypeOptions.Images,\r\n        allowsEditing: true,\r\n        aspect: [16, 9],\r\n        quality: 1,\r\n      });\r\n\r\n      if (!result.canceled) {\r\n        const newInsurance = { type: 'custom', card: result.assets[0].uri };\r\n        setLocalInsurance(newInsurance);\r\n        onInsuranceChange(insuranceType);\r\n      }\r\n    } else {\r\n      const newInsurance = { type: insuranceType, card: null };\r\n      setLocalInsurance(newInsurance);\r\n      onInsuranceChange(insuranceType);\r\n    }\r\n  };\r\n\r\n  const handleGetCurrentLocation = async () => {\r\n    setIsLoadingLocation(true);\r\n    try {\r\n      let { status } = await Location.requestForegroundPermissionsAsync();\r\n      if (status !== 'granted') {\r\n        if (Platform.OS === 'web') {\r\n          Alert.alert('Permission denied: Please enable location services to use this feature.');\r\n        }\r\n        return;\r\n      }\r\n      \r\n      const location = await Location.getCurrentPositionAsync({});\r\n      const { latitude, longitude } = location.coords;\r\n      \r\n      // Get the address from coordinates\r\n      const [address] = await Location.reverseGeocodeAsync({ latitude, longitude });\r\n      \r\n      if (address) {\r\n        setAddressForm({\r\n          street: address.street || '',\r\n          apartment: '',\r\n          city: address.city || '',\r\n          state: address.region || '',\r\n          zip: address.postalCode || '',\r\n          country: address.country || ''\r\n        });\r\n      }\r\n    } catch (error) {\r\n      Alert.alert('Error', 'Failed to get current location. Please enter address manually.');\r\n    } finally {\r\n      setIsLoadingLocation(false);\r\n    }\r\n  };\r\n\r\n  const renderInsuranceContent = () => {\r\n    if (insuranceStep === 1) {\r\n      return (\r\n        <View style={styles.insuranceStepContent}>\r\n          <Text style={styles.insuranceStepTitle}>Choose Insurance Type</Text>\r\n          <TouchableOpacity \r\n            style={styles.insuranceTypeButton}\r\n            onPress={() => handleInsuranceTypeSelect('own')}\r\n          >\r\n            <MaterialCommunityIcons name=\"file-document\" size={24} color={theme.colors.primary} />\r\n            <View style={styles.insuranceTypeContent}>\r\n              <Text style={styles.insuranceTypeTitle}>Use My Own Insurance</Text>\r\n              <Text style={styles.insuranceTypeDescription}>Upload your existing insurance card</Text>\r\n            </View>\r\n          </TouchableOpacity>\r\n          {/* TODO: Implement after MVP\r\n           <TouchableOpacity \r\n            style={styles.insuranceTypeButton}\r\n            onPress={() => handleInsuranceTypeSelect('platform')}\r\n          >\r\n            <MaterialCommunityIcons name=\"shield-check\" size={24} color={theme.colors.primary} />\r\n            <View style={styles.insuranceTypeContent}>\r\n              <Text style={styles.insuranceTypeTitle}>Use Platform Insurance</Text>\r\n              <Text style={styles.insuranceTypeDescription}>Select from our insurance providers</Text>\r\n            </View>\r\n          </TouchableOpacity> */}\r\n        </View>\r\n      );\r\n    }\r\n\r\n    if (insuranceStep === 2) {\r\n      if (insuranceType === 'own') {\r\n        return (\r\n          <View style={styles.insuranceStepContent}>\r\n            <Text style={styles.insuranceStepTitle}>Upload Insurance Card</Text>\r\n            <TouchableOpacity \r\n              style={styles.uploadButton}\r\n              onPress={() => handleInsuranceChange('custom')}\r\n            >\r\n              <MaterialCommunityIcons name=\"file-upload\" size={24} color={theme.colors.primary} />\r\n              <Text style={styles.uploadText}>Upload Insurance Card</Text>\r\n            </TouchableOpacity>\r\n            {localInsurance.type === 'custom' && localInsurance.card && (\r\n              <View style={styles.customInsuranceCard}>\r\n                <Image \r\n                  source={{ uri: localInsurance.card }} \r\n                  style={styles.insuranceCardImage}\r\n                />\r\n                <Text style={styles.insuranceCardText}>Custom Insurance Card</Text>\r\n              </View>\r\n            )}\r\n          </View>\r\n        );\r\n      }\r\n\r\n      return (\r\n        <View style={styles.insuranceStepContent}>\r\n          <Text style={styles.insuranceStepTitle}>Select Insurance Provider</Text>\r\n          {INSURANCE_OPTIONS.filter(opt => opt.id !== 'custom').map((option) => (\r\n            <TouchableOpacity\r\n              key={option.id}\r\n              style={[\r\n                styles.insuranceOption,\r\n                localInsurance.type === option.id && styles.selectedInsuranceOption\r\n              ]}\r\n              onPress={() => {\r\n                const newInsurance = { type: option.id, card: null };\r\n                setLocalInsurance(newInsurance);\r\n                onInsuranceChange(option.id);\r\n              }}\r\n            >\r\n              <MaterialCommunityIcons \r\n                name={option.id === 'none' ? 'shield-off' : 'shield-check'} \r\n                size={24} \r\n                color={theme.colors.primary} \r\n              />\r\n              <View style={styles.insuranceOptionContent}>\r\n                <Text style={styles.insuranceOptionTitle}>{option.label}</Text>\r\n                <Text style={styles.insuranceOptionDescription}>{option.description}</Text>\r\n              </View>\r\n            </TouchableOpacity>\r\n          ))}\r\n        </View>\r\n      );\r\n    }\r\n\r\n    return null;\r\n  };\r\n\r\n  return (\r\n    <Modal\r\n      visible={visible}\r\n      transparent\r\n      animationType=\"fade\"\r\n      onRequestClose={onClose}\r\n    >\r\n      <View style={styles.modalOverlay}>\r\n        <View style={[\r\n          styles.modalContent,\r\n          isInsurance && styles.insuranceModalContent\r\n        ]}>\r\n          <View style={styles.modalHeader}>\r\n            {isInsurance && insuranceStep === 2 && (\r\n              <TouchableOpacity \r\n                style={styles.backButton}\r\n                onPress={() => setInsuranceStep(1)}\r\n              >\r\n                <MaterialCommunityIcons name=\"arrow-left\" size={24} color={theme.colors.primary} />\r\n                <Text style={styles.backButtonText}>Back</Text>\r\n              </TouchableOpacity>\r\n            )}\r\n            <Text style={[\r\n              styles.modalTitle,\r\n              isInsurance && insuranceStep === 2 && styles.modalTitleCentered\r\n            ]}>{title}</Text>\r\n          </View>\r\n          \r\n          {isInsurance ? renderInsuranceContent() : (\r\n            isLocation ? (\r\n              <View style={styles.locationContent}>\r\n                <Text style={styles.addressInstructions}>\r\n                Enter your complete street address (e.g., \"123 Main Street\"). Only valid street addresses will appear in suggestions.\r\n                </Text>\r\n                <AddressAutocomplete\r\n                  value={currentAddressValue}\r\n                  onAddressSelect={(address) => {\r\n                    setSelectedAddress(address);\r\n                    setCurrentAddressValue(address.formatted_address);\r\n                    debugLog('MBA8901', 'Address selected in modal:', address);\r\n                  }}\r\n                  placeholder=\"Enter address in Colorado Springs...\"\r\n                  style={styles.addressAutocomplete}\r\n                />\r\n                {selectedAddress && (\r\n                  <View style={styles.selectedAddressInfo}>\r\n                    <MaterialCommunityIcons \r\n                      name=\"check-circle\" \r\n                      size={16} \r\n                      color={theme.colors.success} \r\n                    />\r\n                    <Text style={styles.selectedAddressText}>\r\n                      Address validated and ready to save\r\n                    </Text>\r\n                  </View>\r\n                )}\r\n              </View>\r\n            ) : (\r\n              <TextInput\r\n                style={[styles.modalInput, isMultiline && styles.multilineInput]}\r\n                value={localValue}\r\n                onChangeText={setLocalValue}\r\n                multiline={isMultiline}\r\n                numberOfLines={isMultiline ? 4 : 1}\r\n                autoFocus\r\n              />\r\n            )\r\n          )}\r\n          \r\n          <View style={[styles.modalButtons, { zIndex: -1 }]}>\r\n            <TouchableOpacity style={styles.modalCancelButton} onPress={onClose}>\r\n              <Text style={styles.modalCancelText}>Cancel</Text>\r\n            </TouchableOpacity>\r\n            <TouchableOpacity \r\n              style={[\r\n                styles.modalSaveButton,\r\n                isLocation && !selectedAddress && styles.modalSaveButtonDisabled\r\n              ]} \r\n              onPress={handleSave}\r\n              disabled={isLocation && !selectedAddress}\r\n            >\r\n              <Text style={styles.modalSaveText}>Save</Text>\r\n            </TouchableOpacity>\r\n          </View>\r\n        </View>\r\n      </View>\r\n    </Modal>\r\n  );\r\n};\r\n\r\nconst ProfileInfoTab = ({\r\n  profilePhoto,\r\n  email,\r\n  phone,\r\n  age,\r\n  address,\r\n  city,\r\n  state,\r\n  zip,\r\n  country,\r\n  coordinates,\r\n  bio,\r\n  about_me,\r\n  emergencyContact,\r\n  authorizedHouseholdMembers,\r\n  editMode,\r\n  toggleEditMode,\r\n  onChangeText,\r\n  pickImage,\r\n  setHasUnsavedChanges,\r\n  onSaveComplete,\r\n  isMobile,\r\n  rating,\r\n  reviews,\r\n  role,\r\n  isProfessional,\r\n  insurance = { type: 'none', card: null },\r\n  onNavigateToTab,\r\n  name,\r\n}) => {\r\n  const { name: authName } = useContext(AuthContext);\r\n  \r\n  // Track direct user edits\r\n  const [hasEdits, setHasEdits] = useState(false);\r\n  const [editingField, setEditingField] = useState(null);\r\n  const [editValue, setEditValue] = useState('');\r\n  const [portfolioPhotos, setPortfolioPhotos] = useState([]);\r\n  const [selectedInsurance, setSelectedInsurance] = useState(insurance);\r\n  const [isSaving, setIsSaving] = useState(false);\r\n  \r\n  // Add state to track edited values that should display in the UI\r\n  const [displayValues, setDisplayValues] = useState({\r\n    name: name || authName || \"Your Name\",\r\n    email: email || \"\",\r\n    bio: isProfessional ? bio : about_me,\r\n    location: `${address || ''}${city ? `, ${city}` : ''}${state ? `, ${state}` : ''}`,\r\n  });\r\n  \r\n  const showToast = useToast();\r\n  \r\n  // Track original values to detect changes\r\n  const [originalValues, setOriginalValues] = useState({\r\n    name: '',\r\n    email: '',\r\n    bio: '',\r\n    location: '',\r\n    address: '',\r\n    apartment: '',\r\n    city: '',\r\n    state: '',\r\n    zip: '',\r\n    country: 'USA',\r\n    insurance: { type: 'none', card: null }\r\n  });\r\n\r\n  // Make sure parent component is notified about unsaved changes\r\n  useEffect(() => {\r\n    if (setHasUnsavedChanges) {\r\n      debugLog('MBA230uvj0834h9', 'Updating parent component with hasUnsavedChanges:', hasEdits);\r\n      setHasUnsavedChanges(hasEdits);\r\n    }\r\n  }, [hasEdits, setHasUnsavedChanges]);\r\n  \r\n  // Update the initial useEffect to only run once\r\n  useEffect(() => {\r\n    debugLog('MBA230uvj0834h9', 'ProfileInfoTab mounted with props:', { \r\n      propName: name,\r\n      authName, \r\n      email, \r\n      address, \r\n      bio, \r\n      about_me, \r\n      profilePhoto,\r\n      isProfessional\r\n    });\r\n    \r\n    // Use formatted address if available, otherwise fall back to constructed address\r\n    const locationDisplay = coordinates?.formatted_address || \r\n                           `${address || ''}${city ? `, ${city}` : ''}${state ? `, ${state}` : ''}`;\r\n    \r\n    // Initialize display values on mount ONLY\r\n    setDisplayValues({\r\n      name: name || authName || \"Your Name\",\r\n      email: email || \"\",\r\n      bio: isProfessional ? bio : about_me,\r\n      location: locationDisplay\r\n    });\r\n  }, []); // Empty dependency array - only run on mount\r\n\r\n  // Add effect to update bio when isProfessional changes\r\n  useEffect(() => {\r\n    // Update the bio/about_me when the role changes\r\n    setDisplayValues(prev => ({\r\n      ...prev,\r\n      bio: isProfessional ? bio : about_me\r\n    }));\r\n    \r\n    debugLog('MBA230uvj0834h9', 'Role changed - updating bio/about_me:', { \r\n      isProfessional, \r\n      bio, \r\n      about_me \r\n    });\r\n  }, [isProfessional, bio, about_me]);\r\n  \r\n  // Simplify hasFieldChanged to be more direct\r\n  const hasFieldChanged = (field, value) => {\r\n    // For insurance, we need to do a deep comparison\r\n    if (field === 'insurance') {\r\n      return JSON.stringify(value) !== JSON.stringify(originalValues.insurance);\r\n    }\r\n    \r\n    // For location, we can use a simpler comparison\r\n    if (field === 'location') {\r\n      // If it's an object, check all address fields\r\n      if (typeof value === 'object') {\r\n        // Handle AddressAutocomplete format (with components)\r\n        const newAddress = value.components?.street || value.street || value.address || '';\r\n        const newApartment = value.components?.apartment || value.apartment || '';\r\n        const newCity = value.components?.city || value.city || '';\r\n        const newState = value.components?.state || value.state || 'Colorado';\r\n        const newZip = value.components?.zip || value.zip || '';\r\n        \r\n        debugLog('MBA12345', 'Checking location changes:', {\r\n          originalAddress: originalValues.address,\r\n          newAddress: newAddress,\r\n          originalApartment: originalValues.apartment,\r\n          newApartment: newApartment,\r\n          originalCity: originalValues.city,\r\n          newCity: newCity,\r\n          originalState: originalValues.state,\r\n          newState: newState,\r\n          originalZip: originalValues.zip,\r\n          newZip: newZip\r\n        });\r\n        \r\n        // Check all fields that could have changed\r\n        const hasChanges = newAddress !== originalValues.address ||\r\n                          newApartment !== originalValues.apartment ||\r\n                          newCity !== originalValues.city ||\r\n                          newState !== originalValues.state ||\r\n                          newZip !== originalValues.zip;\r\n        \r\n        debugLog('MBA12345', `Location has changes: ${hasChanges}`);\r\n        return hasChanges;\r\n      }\r\n    }\r\n    \r\n    // For other fields, direct comparison\r\n    return value !== originalValues[field];\r\n  };\r\n\r\n  // Handle edit field\r\n  const handleEdit = (field, currentValue) => {\r\n    debugLog('MBA230uvj0834h9', `Edit ${field}:`, currentValue);\r\n    \r\n    // For location field, pass the current display value as a string for the modal\r\n    if (field === 'location') {\r\n      // Use the current display value (formatted address or constructed address)\r\n      setEditValue(currentValue || '');\r\n    } else {\r\n      setEditValue(currentValue);\r\n    }\r\n    \r\n    // This triggers the modal to open\r\n    setEditingField(field);\r\n    \r\n    // Mark that we're starting an edit\r\n    setHasEdits(true);\r\n    \r\n    // Notify parent component\r\n    if (setHasUnsavedChanges) {\r\n      setHasUnsavedChanges(true);\r\n    }\r\n  };\r\n\r\n  // Update extractAddressComponents to handle address objects correctly\r\n  const extractAddressComponents = async (locationData) => {\r\n    let addressComponents = {};\r\n    \r\n    // If we're getting a validated address object from AddressAutocomplete\r\n    if (locationData && typeof locationData === 'object' && 'components' in locationData) {\r\n      debugLog('MBA8901', 'Processing validated address from autocomplete:', locationData);\r\n      \r\n      addressComponents = {\r\n        address: locationData.components.street || '',\r\n        apartment: locationData.components.apartment || '',\r\n        city: locationData.components.city || '',\r\n        state: locationData.components.state || 'Colorado',\r\n        zip: locationData.components.zip || ''\r\n      };\r\n      \r\n      // Coordinates are already included from the autocomplete\r\n      if (locationData.coordinates) {\r\n        addressComponents.coordinates = locationData.coordinates;\r\n        debugLog('MBA8901', 'Using coordinates from validated address:', locationData.coordinates);\r\n      }\r\n    }\r\n    // Legacy: If we're getting an addressForm object from our old modal\r\n    else if (locationData && typeof locationData === 'object') {\r\n      // If it's an address form with street property\r\n      if ('street' in locationData) {\r\n        addressComponents = {\r\n          address: locationData.street || '',\r\n          apartment: locationData.apartment || '',\r\n          city: locationData.city || '',\r\n          state: locationData.state || 'Colorado',\r\n          zip: locationData.zip || ''\r\n        };\r\n      }\r\n      // If it's our own object with address property\r\n      else if ('address' in locationData) {\r\n        addressComponents = {\r\n          address: locationData.address || '',\r\n          apartment: locationData.apartment || '',\r\n          city: locationData.city || '',\r\n          state: locationData.state || 'Colorado',\r\n          zip: locationData.zip || ''\r\n        };\r\n      }\r\n      \r\n      // Only try to geocode if we don't already have coordinates\r\n      if (!addressComponents.coordinates && addressComponents.address && addressComponents.city && addressComponents.state) {\r\n        debugLog('MBA7890', 'Attempting to geocode legacy address:', addressComponents);\r\n        \r\n        const coordinates = await geocodeAddressGraceful({\r\n          street: addressComponents.address,\r\n          apartment: addressComponents.apartment,\r\n          city: addressComponents.city,\r\n          state: addressComponents.state,\r\n          zip: addressComponents.zip\r\n        });\r\n\r\n        if (coordinates) {\r\n          debugLog('MBA7890', 'Geocoding successful, adding coordinates:', coordinates);\r\n          addressComponents.coordinates = coordinates;\r\n        } else {\r\n          debugLog('MBA7890', 'Geocoding failed, saving address without coordinates');\r\n        }\r\n      }\r\n    }\r\n    // If we're getting a string (legacy format)\r\n    else if (typeof locationData === 'string') {\r\n      const components = locationData.split(',').map(part => part.trim());\r\n      addressComponents = {\r\n        address: components[0] || '',\r\n        apartment: '',\r\n        city: components[1] || '',\r\n        state: components[2] || 'Colorado',\r\n        zip: components[3] || ''\r\n      };\r\n      \r\n      // Try to geocode string addresses\r\n      if (addressComponents.address && addressComponents.city && addressComponents.state) {\r\n        const coordinates = await geocodeAddressGraceful({\r\n          street: addressComponents.address,\r\n          apartment: addressComponents.apartment,\r\n          city: addressComponents.city,\r\n          state: addressComponents.state,\r\n          zip: addressComponents.zip\r\n        });\r\n\r\n        if (coordinates) {\r\n          addressComponents.coordinates = coordinates;\r\n        }\r\n      }\r\n    }\r\n    // Default empty object if all else fails\r\n    else {\r\n      addressComponents = {\r\n        address: '',\r\n        apartment: '',\r\n        city: '',\r\n        state: 'Colorado',\r\n        zip: ''\r\n      };\r\n    }\r\n    \r\n    return addressComponents;\r\n  };\r\n\r\n  // Set original values when props change\r\n  useEffect(() => {\r\n    // Only set original values once on component mount\r\n    const locationDisplay = `${city || ''}${state ? `, ${state}` : ''}`;\r\n    \r\n    setOriginalValues({\r\n      name: name || authName || \"Your Name\",\r\n      email: email || \"\",\r\n      bio: isProfessional ? bio : about_me,\r\n      location: locationDisplay,\r\n      address: address || '',\r\n      apartment: '',\r\n      city: city || '',\r\n      state: state || 'Colorado',\r\n      zip: zip || '',\r\n      insurance: insurance\r\n    });\r\n  }, []); // Empty dependency array - only run once on mount\r\n  \r\n  // Simplify the handleSaveField function to avoid state update loops\r\n  const handleSaveField = async (field, value) => {\r\n    // Skip if no changes (keep this logic)\r\n    if (!hasFieldChanged(field, value)) {\r\n      debugLog('MBA230uvj0834h9', `No changes detected for ${field}, skipping save.`);\r\n      setEditingField(null);\r\n      \r\n      // Reset state since no changes were made\r\n      setHasEdits(false);\r\n      if (setHasUnsavedChanges) {\r\n        setHasUnsavedChanges(false);\r\n      }\r\n      return;\r\n    }\r\n\r\n    debugLog('MBA12345', `Changes detected for ${field}, proceeding with save.`, { value });\r\n    setIsSaving(true);\r\n    \r\n    try {\r\n      let profileData = {};\r\n      \r\n      switch (field) {\r\n        case 'name':\r\n          profileData = { name: value };\r\n          break;\r\n        case 'email':\r\n          profileData = { email: value };\r\n          break;\r\n        case 'bio':\r\n          // Make it clearer which field we're updating\r\n          if (isProfessional) {\r\n            profileData = { bio: value };\r\n            debugLog('MBA4928', 'Saving professional bio:', value);\r\n          } else {\r\n            profileData = { about_me: value };\r\n            debugLog('MBA4928', 'Saving client about_me:', value);\r\n          }\r\n          break;\r\n        case 'location':\r\n          debugLog('MBA12345', 'Extracting address components from:', value);\r\n          const locationComponents = await extractAddressComponents(value);\r\n          debugLog('MBA12345', 'Extracted components:', locationComponents);\r\n          \r\n          profileData = {\r\n            address: locationComponents.address,\r\n            apartment: locationComponents.apartment,\r\n            city: locationComponents.city,\r\n            state: locationComponents.state,\r\n            zip: locationComponents.zip\r\n          };\r\n\r\n          // Add coordinates if geocoding was successful\r\n          if (locationComponents.coordinates) {\r\n            profileData.coordinates = locationComponents.coordinates;\r\n            debugLog('MBA7890', 'Including coordinates in profile update:', locationComponents.coordinates);\r\n          }\r\n          break;\r\n        case 'insurance':\r\n          profileData = { insurance: value };\r\n          break;\r\n        default:\r\n          break;\r\n      }\r\n      \r\n      // Call API to update only the changed field\r\n      debugLog('MBA4928', `Saving ${field} to backend:`, profileData);\r\n      const updatedProfile = await updateProfileInfo(profileData);\r\n      debugLog('MBA4928', `Backend response for ${field}:`, updatedProfile);\r\n      \r\n      // Update display values first\r\n      if (field === 'name') {\r\n        setDisplayValues({\r\n          ...displayValues, \r\n          name: updatedProfile.name || displayValues.name\r\n        });\r\n        \r\n        // Update original values to match the new values from the server\r\n        setOriginalValues(prevValues => ({\r\n          ...prevValues,\r\n          name: updatedProfile.name || prevValues.name\r\n        }));\r\n      } else if (field === 'email') {\r\n        setDisplayValues({\r\n          ...displayValues, \r\n          email: updatedProfile.email || displayValues.email\r\n        });\r\n        \r\n        // Update original values\r\n        setOriginalValues(prevValues => ({\r\n          ...prevValues,\r\n          email: updatedProfile.email || prevValues.email\r\n        }));\r\n      } else if (field === 'bio') {\r\n        // Update display values with the correct field from the response\r\n        if (isProfessional) {\r\n          setDisplayValues({\r\n            ...displayValues, \r\n            bio: updatedProfile.bio || displayValues.bio\r\n          });\r\n          \r\n          // Update original values\r\n          setOriginalValues(prevValues => ({\r\n            ...prevValues,\r\n            bio: updatedProfile.bio || prevValues.bio\r\n          }));\r\n        } else {\r\n          setDisplayValues({\r\n            ...displayValues, \r\n            bio: updatedProfile.about_me || displayValues.bio\r\n          });\r\n          \r\n          // Update original values\r\n          setOriginalValues(prevValues => ({\r\n            ...prevValues,\r\n            bio: updatedProfile.about_me || prevValues.bio\r\n          }));\r\n        }\r\n      } else if (field === 'location') {\r\n        // Use formatted address if available, otherwise construct from components\r\n        const newLocation = updatedProfile.coordinates?.formatted_address || \r\n                           `${updatedProfile.address || ''}${updatedProfile.city ? `, ${updatedProfile.city}` : ''}${updatedProfile.state ? `, ${updatedProfile.state}` : ''}`;\r\n        setDisplayValues({\r\n          ...displayValues, \r\n          location: newLocation\r\n        });\r\n        \r\n        // Update original values for all address components\r\n        setOriginalValues(prevValues => ({\r\n          ...prevValues,\r\n          location: newLocation,\r\n          address: updatedProfile.address || prevValues.address,\r\n          apartment: updatedProfile.apartment || prevValues.apartment,\r\n          city: updatedProfile.city || prevValues.city,\r\n          state: updatedProfile.state || prevValues.state,\r\n          zip: updatedProfile.zip || prevValues.zip\r\n        }));\r\n      } else if (field === 'insurance') {\r\n        setSelectedInsurance(value);\r\n        \r\n        // Update original values\r\n        setOriginalValues(prevValues => ({\r\n          ...prevValues,\r\n          insurance: value\r\n        }));\r\n      }\r\n      \r\n      // Log the updated original values for debugging\r\n      debugLog('MBA4928', `Original values updated after save for ${field}`, { \r\n        originalValues: {\r\n          ...originalValues,\r\n          [field]: field === 'location' ? \r\n            `${updatedProfile.address || ''}${updatedProfile.city ? `, ${updatedProfile.city}` : ''}${updatedProfile.state ? `, ${updatedProfile.state}` : ''}` : \r\n            updatedProfile[field]\r\n        }\r\n      });\r\n      \r\n      // Success notification\r\n      showToast({\r\n        message: `${field.charAt(0).toUpperCase() + field.slice(1)} updated successfully`,\r\n        type: 'success',\r\n        duration: 3000\r\n      });\r\n      \r\n      // Reset state since changes were saved\r\n      setHasEdits(false);\r\n      if (setHasUnsavedChanges) {\r\n        setHasUnsavedChanges(false);\r\n      }\r\n      \r\n      // Notify parent component if needed\r\n      if (onSaveComplete) {\r\n        onSaveComplete(updatedProfile);\r\n      }\r\n    } catch (error) {\r\n      debugLog('MBA4928', `Error saving ${field}:`, error);\r\n      \r\n      // Show error toast\r\n      showToast({\r\n        message: `Failed to update ${field}. Please try again.`,\r\n        type: 'error',\r\n        duration: 4000\r\n      });\r\n      \r\n      // Keep edit state if there was an error\r\n      if (setHasUnsavedChanges) {\r\n        setHasUnsavedChanges(true);\r\n      }\r\n    } finally {\r\n      setIsSaving(false);\r\n      setEditingField(null);\r\n    }\r\n  };\r\n\r\n  // Update handle save to call the new function\r\n  const handleSave = (value) => {\r\n    debugLog('MBA4928', `Save ${editingField} to value:`, value);\r\n    \r\n    if (editingField === 'insurance') {\r\n      handleSaveField('insurance', value);\r\n    } else if (editingField === 'location') {\r\n      handleSaveField('location', value);\r\n    } else {\r\n      // For text fields, update the display value first\r\n      const newDisplayValues = { ...displayValues };\r\n      newDisplayValues[editingField] = value;\r\n      setDisplayValues(newDisplayValues);\r\n      \r\n      // Then save to backend\r\n      handleSaveField(editingField, value);\r\n    }\r\n  };\r\n\r\n  const location = `${city}${state ? `, ${state}` : ''}`;\r\n  \r\n  // Display name (use display values instead of context)\r\n  const displayName = displayValues.name || \"Your Name\";\r\n  \r\n  // Simplify the profile photo handler\r\n  const handleProfilePhotoSelection = async () => {\r\n    try {\r\n      // Let the parent component handle the actual image picking\r\n      const newPhotoUri = await pickImage();\r\n      \r\n      if (newPhotoUri) {\r\n        setIsSaving(true);\r\n        \r\n        // Create form data for photo upload\r\n        const formData = new FormData();\r\n        const photoFile = {\r\n          uri: newPhotoUri,\r\n          type: 'image/jpeg',\r\n          name: 'profile_photo.jpg'\r\n        };\r\n        \r\n        formData.append('profile_picture', photoFile);\r\n        \r\n        // Upload the photo directly\r\n        debugLog('MBA4928', 'Uploading profile photo');\r\n        await updateProfileInfo(formData);\r\n        \r\n        showToast({\r\n          message: 'Profile photo updated successfully',\r\n          type: 'success',\r\n          duration: 3000\r\n        });\r\n        \r\n        // No need to update local state - let the parent handle it via onSaveComplete\r\n      }\r\n    } catch (error) {\r\n      debugLog('MBA4928', 'Error uploading profile photo:', error);\r\n      showToast({\r\n        message: 'Failed to update profile photo. Please try again.',\r\n        type: 'error',\r\n        duration: 4000\r\n      });\r\n    } finally {\r\n      setIsSaving(false);\r\n    }\r\n  };\r\n  \r\n  // Simplify the portfolio photo handler\r\n  const handleAddPortfolioPhoto = async () => {\r\n    try {\r\n      const result = await ImagePicker.launchImageLibraryAsync({\r\n        mediaTypes: ImagePicker.MediaTypeOptions.Images,\r\n        allowsEditing: true,\r\n        aspect: [4, 3],\r\n        quality: 1,\r\n      });\r\n      \r\n      if (!result.canceled) {\r\n        setIsSaving(true);\r\n        \r\n        // Create form data for photo upload\r\n        const formData = new FormData();\r\n        const photoFile = {\r\n          uri: result.assets[0].uri,\r\n          type: 'image/jpeg',\r\n          name: 'portfolio_photo.jpg'\r\n        };\r\n        \r\n        formData.append('portfolio_photo', photoFile);\r\n        \r\n        // Upload the photo - don't update state based on response\r\n        debugLog('MBA4928', 'Uploading portfolio photo');\r\n        await updateProfileInfo(formData);\r\n        \r\n        // Just add to local portfolio photos\r\n        setPortfolioPhotos([...portfolioPhotos, result.assets[0].uri]);\r\n        \r\n        showToast({\r\n          message: 'Portfolio photo added successfully',\r\n          type: 'success',\r\n          duration: 3000\r\n        });\r\n      }\r\n    } catch (error) {\r\n      debugLog('MBA4928', 'Error adding portfolio photo:', error);\r\n      showToast({\r\n        message: 'Failed to add portfolio photo. Please try again.',\r\n        type: 'error',\r\n        duration: 4000\r\n      });\r\n    } finally {\r\n      setIsSaving(false);\r\n    }\r\n  };\r\n\r\n  const renderFacilitiesSection = () => {\r\n    // TODO: Remove the !isProfessional once we have a way to edit facilities\r\n    if (isProfessional || !isProfessional) return null;\r\n\r\n    return (\r\n      <View style={styles.section}>\r\n        <View style={styles.sectionHeader}>\r\n          <Text style={styles.sectionTitle}>Home & Facilities</Text>\r\n          <TouchableOpacity \r\n            style={styles.editButton}\r\n            onPress={() => onNavigateToTab('pets_preferences')}\r\n          >\r\n            <View style={styles.editButtonContent}>\r\n              <MaterialCommunityIcons name=\"pencil\" size={20} color={theme.colors.primary} />\r\n              <Text style={styles.editButtonText}>Edit Facilities</Text>\r\n            </View>\r\n          </TouchableOpacity>\r\n        </View>\r\n        <View style={styles.facilitiesGrid}>\r\n          {[\r\n            { icon: 'home', title: 'Housing Type', value: 'Private House' },\r\n            { icon: 'tree', title: 'Outdoor Space', value: 'Fenced Yard' },\r\n            { icon: 'shield-check', title: 'Security', value: '24/7 Monitoring' }\r\n          ].map((facility, index) => (\r\n            <View \r\n              key={facility.title} \r\n              style={[\r\n                styles.facilityItem,\r\n                { backgroundColor: index % 2 === 0 ? \r\n                  theme.colors.proDashboard.secondary : \r\n                  theme.colors.proDashboard.tertiary \r\n                }\r\n              ]}\r\n            >\r\n              <MaterialCommunityIcons name={facility.icon} size={24} color={theme.colors.text} />\r\n              <View style={styles.facilityContent}>\r\n                <Text style={styles.facilityTitle}>{facility.title}</Text>\r\n                <Text style={styles.facilityValue}>{facility.value}</Text>\r\n              </View>\r\n            </View>\r\n          ))}\r\n        </View>\r\n      </View>\r\n    );\r\n  };\r\n\r\n  const renderInsuranceSection = () => {\r\n    if (!isProfessional) return null;\r\n\r\n    return (\r\n      <View style={styles.section}>\r\n        <View style={styles.sectionHeader}>\r\n          <Text style={styles.sectionTitle}>Insurance</Text>\r\n          <TouchableOpacity \r\n            style={styles.editButton}\r\n            onPress={() => handleEdit('insurance', JSON.stringify(selectedInsurance))}\r\n          >\r\n            <View style={styles.editButtonContent}>\r\n              <MaterialCommunityIcons name=\"pencil\" size={20} color={theme.colors.primary} />\r\n              <Text style={styles.editButtonText}>Edit Insurance</Text>\r\n            </View>\r\n          </TouchableOpacity>\r\n        </View>\r\n        <View style={styles.insuranceContent}>\r\n          {selectedInsurance.type === 'custom' && selectedInsurance.card ? (\r\n            <View style={styles.customInsuranceCard}>\r\n              <Image \r\n                source={{ uri: selectedInsurance.card }} \r\n                style={styles.insuranceCardImage}\r\n              />\r\n              <Text style={styles.insuranceCardText}>Custom Insurance Card</Text>\r\n            </View>\r\n          ) : (\r\n            <View style={styles.insuranceOption}>\r\n              <MaterialCommunityIcons \r\n                name={selectedInsurance.type === 'none' ? 'shield-off' : 'shield-check'} \r\n                size={24} \r\n                color={theme.colors.primary} \r\n              />\r\n              <View style={styles.insuranceOptionContent}>\r\n                <Text style={styles.insuranceOptionTitle}>\r\n                  {INSURANCE_OPTIONS.find(opt => opt.id === selectedInsurance.type)?.label || 'No Insurance'}\r\n                </Text>\r\n                <Text style={styles.insuranceOptionDescription}>\r\n                  {INSURANCE_OPTIONS.find(opt => opt.id === selectedInsurance.type)?.description || 'No insurance selected'}\r\n                </Text>\r\n              </View>\r\n            </View>\r\n          )}\r\n        </View>\r\n      </View>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <View style={styles.container}>\r\n      <View style={styles.contentWrapper}>\r\n        <View style={[styles.mainContent, !isMobile && styles.desktopLayout]}>\r\n          {/* Profile Photo Section */}\r\n          <View style={[styles.profileSection, !isMobile && styles.profileSectionDesktop]}>\r\n            <View style={styles.profileCard}>\r\n              <TouchableOpacity onPress={handleProfilePhotoSelection} style={styles.profilePhotoContainer}>\r\n                {profilePhoto ? (\r\n                  <Image source={{ uri: profilePhoto }} style={styles.profilePhoto} />\r\n                ) : (\r\n                  <View style={[styles.profilePhoto, styles.profilePhotoPlaceholder]}>\r\n                    <MaterialCommunityIcons name=\"camera-plus\" size={40} color={theme.colors.placeholder} />\r\n                  </View>\r\n                )}\r\n                <View style={styles.cameraButton}>\r\n                  <MaterialCommunityIcons name=\"camera\" size={20} color={theme.colors.background} />\r\n                </View>\r\n              </TouchableOpacity>\r\n              <View style={styles.profileInfo}>\r\n                <View style={styles.nameContainer}>\r\n                  <Text style={styles.name}>{displayValues.name}</Text>\r\n                  <TouchableOpacity \r\n                    style={styles.editIcon}\r\n                    onPress={() => handleEdit('name', displayValues.name)}\r\n                  >\r\n                    <MaterialCommunityIcons name=\"pencil\" size={20} color={theme.colors.text} />\r\n                  </TouchableOpacity>\r\n                </View>\r\n                <View style={styles.emailContainer}>\r\n                  <MaterialCommunityIcons name=\"email\" size={16} color={theme.colors.secondary} />\r\n                  <Text style={styles.email}>{displayValues.email || 'No email provided'}</Text>\r\n                  <TouchableOpacity \r\n                    style={styles.editIcon}\r\n                    onPress={() => handleEdit('email', displayValues.email)}\r\n                  >\r\n                    <MaterialCommunityIcons name=\"pencil\" size={16} color={theme.colors.text} />\r\n                  </TouchableOpacity>\r\n                </View>\r\n                <View style={styles.locationContainer}>\r\n                  <View style={styles.locationIconWrapper}>\r\n                    <MaterialCommunityIcons name=\"map-marker\" size={16} color={theme.colors.secondary} />\r\n                  </View>\r\n                  <Text style={styles.location}>{displayValues.location || 'Set Location'}</Text>\r\n                  <TouchableOpacity \r\n                    style={styles.locationEditIcon}\r\n                    onPress={() => handleEdit('location', displayValues.location)}\r\n                  >\r\n                    <MaterialCommunityIcons name=\"pencil\" size={16} color={theme.colors.text} />\r\n                  </TouchableOpacity>\r\n                </View>\r\n                <View style={styles.reviewsContainer}>\r\n                  {rating ? (\r\n                    <View style={styles.ratingContainer}>\r\n                      <MaterialCommunityIcons name=\"star\" size={20} color={theme.colors.warning} />\r\n                      <Text style={styles.rating}>{rating}</Text>\r\n                      <Text style={styles.reviews}>({reviews} reviews)</Text>\r\n                    </View>\r\n                  ) : (\r\n                    <Text style={styles.noReviews}>No reviews yet</Text>\r\n                  )}\r\n                </View>\r\n              </View>\r\n            </View>\r\n          </View>\r\n\r\n          {/* Right Side Sections */}\r\n          <View style={[styles.sectionsContainer, !isMobile && styles.sectionsContainerDesktop]}>\r\n            {/* About Me Section */}\r\n            <View style={styles.section}>\r\n              <View style={styles.sectionHeader}>\r\n                <Text style={styles.sectionTitle}>{isProfessional ? 'Professional Bio' : 'About Me'}</Text>\r\n                <TouchableOpacity \r\n                  style={styles.editButton}\r\n                  onPress={() => handleEdit('bio', displayValues.bio)}\r\n                >\r\n                  <Text style={styles.editButtonText}>Edit {isProfessional ? 'Bio' : 'About Me'}</Text>\r\n                </TouchableOpacity>\r\n              </View>\r\n              <Text style={styles.bioText}>\r\n                {displayValues.bio || 'Tell us about yourself...'}\r\n              </Text>\r\n            </View>\r\n\r\n            {/* Show either Home & Facilities (for owners) or Insurance (for professionals) */}\r\n            {/* TODO: UNCOMMONT THIS SECTION after mvp launch and implementation of facilities and insurance */}\r\n            {/* {isProfessional ? renderInsuranceSection() : renderFacilitiesSection()} */}\r\n\r\n            {/* TODO: UNCOMMONT THIS SECTION\r\n            Portfolio Photos Section - comment this out for now\r\n            <View style={styles.section}>\r\n              <View style={styles.sectionHeader}>\r\n                <Text style={styles.sectionTitle}>Portfolio Photos</Text>\r\n                <TouchableOpacity \r\n                  style={styles.addPhotoButton}\r\n                  onPress={handleAddPortfolioPhoto}\r\n                >\r\n                  <MaterialCommunityIcons name=\"plus\" size={20} color={theme.colors.background} />\r\n                  <Text style={styles.addPhotoText}>Add Photos</Text>\r\n                </TouchableOpacity>\r\n              </View>\r\n              <View style={styles.photoGrid}>\r\n                {portfolioPhotos.map((photo, index) => (\r\n                  <Image \r\n                    key={index} \r\n                    source={{ uri: photo }} \r\n                    style={styles.portfolioPhoto} \r\n                  />\r\n                ))}\r\n                {portfolioPhotos.length === 0 && (\r\n                  <Text style={styles.noPhotosText}>No photos added yet</Text>\r\n                )}\r\n              </View>\r\n            </View> */}\r\n          </View>\r\n        </View>\r\n      </View>\r\n\r\n      <EditOverlay\r\n        visible={!!editingField}\r\n        onClose={() => setEditingField(null)}\r\n        title={`Edit ${editingField?.charAt(0).toUpperCase()}${editingField?.slice(1)}`}\r\n        value={editValue}\r\n        onSave={handleSave}\r\n        isLocation={editingField === 'location'}\r\n        isMultiline={editingField === 'bio' || editingField === 'about_me'}\r\n        isProfessional={isProfessional}\r\n        isInsurance={editingField === 'insurance'}\r\n        selectedInsurance={selectedInsurance}\r\n        onInsuranceChange={setSelectedInsurance}\r\n      />\r\n    </View>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    backgroundColor: theme.colors.surface,\r\n  },\r\n  contentWrapper: {\r\n    maxWidth: 1200,\r\n    alignSelf: 'center',\r\n    width: '100%',\r\n    padding: 16,\r\n  },\r\n  mainContent: {\r\n    width: '100%',\r\n  },\r\n  desktopLayout: {\r\n    flexDirection: 'row',\r\n    gap: 24,\r\n  },\r\n  profileSection: {\r\n    marginBottom: 24,\r\n  },\r\n  profileSectionDesktop: {\r\n    width: 300,\r\n    marginBottom: 0,\r\n  },\r\n  profileCard: {\r\n    backgroundColor: theme.colors.surfaceContrast,\r\n    borderRadius: 8,\r\n    padding: 16,\r\n  },\r\n  profilePhotoContainer: {\r\n    position: 'relative',\r\n    alignItems: 'center',\r\n    marginBottom: 16,\r\n  },\r\n  profilePhoto: {\r\n    width: 200,\r\n    height: 200,\r\n    borderRadius: 8,\r\n    backgroundColor: theme.colors.surface,\r\n  },\r\n  profilePhotoPlaceholder: {\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    borderWidth: 2,\r\n    borderStyle: 'dashed',\r\n    borderColor: theme.colors.border,\r\n  },\r\n  cameraButton: {\r\n    position: 'absolute',\r\n    right: 8,\r\n    bottom: 8,\r\n    backgroundColor: theme.colors.primary,\r\n    padding: 8,\r\n    borderRadius: 20,\r\n  },\r\n  profileInfo: {\r\n    alignItems: 'center',\r\n  },\r\n  nameContainer: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    gap: 8,\r\n    marginBottom: 4,\r\n  },\r\n  name: {\r\n    fontSize: 24,\r\n    fontWeight: '600',\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts?.regular?.fontFamily,\r\n  },\r\n  emailContainer: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    gap: 4,\r\n    marginBottom: 4,\r\n  },\r\n  email: {\r\n    fontSize: 14,\r\n    color: theme.colors.secondary,\r\n    fontFamily: theme.fonts?.regular?.fontFamily,\r\n  },\r\n  locationContainer: {\r\n    flexDirection: 'row',\r\n    marginBottom: 12,\r\n    width: '100%',\r\n    position: 'relative',\r\n    paddingHorizontal: 20,\r\n  },\r\n  locationIconWrapper: {\r\n    position: 'absolute',\r\n    left: 0,\r\n    top: 0,\r\n  },\r\n  location: {\r\n    fontSize: 14,\r\n    color: theme.colors.secondary,\r\n    fontFamily: theme.fonts?.regular?.fontFamily,\r\n    textAlign: 'center',\r\n    flex: 1,\r\n  },\r\n  locationEditIcon: {\r\n    position: 'absolute',\r\n    right: 0,\r\n    top: 0,\r\n    padding: 4,\r\n  },\r\n  roleContainer: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    gap: 4,\r\n    marginBottom: 4,\r\n  },\r\n  role: {\r\n    fontSize: 14,\r\n    color: theme.colors.secondary,\r\n  },\r\n  editIcon: {\r\n    padding: 4,\r\n  },\r\n  ratingContainer: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    gap: 4,\r\n  },\r\n  rating: {\r\n    fontSize: 16,\r\n    fontWeight: '500',\r\n    color: theme.colors.text,\r\n  },\r\n  reviews: {\r\n    fontSize: 14,\r\n    color: theme.colors.secondary,\r\n  },\r\n  sectionsContainer: {\r\n    flex: 1,\r\n  },\r\n  sectionsContainerDesktop: {\r\n    paddingLeft: 24,\r\n  },\r\n  section: {\r\n    backgroundColor: theme.colors.surfaceContrast,\r\n    borderRadius: 8,\r\n    padding: 16,\r\n    marginBottom: 24,\r\n  },\r\n  sectionHeader: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    marginBottom: 16,\r\n  },\r\n  sectionTitle: {\r\n    fontSize: 18,\r\n    fontWeight: '600',\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts?.header?.fontFamily,\r\n  },\r\n  editButton: {\r\n    backgroundColor: 'transparent',\r\n  },\r\n  editButtonText: {\r\n    color: theme.colors.primary,\r\n    fontSize: 14,\r\n    fontWeight: '500',\r\n  },\r\n  bioInput: {\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 8,\r\n    padding: 12,\r\n    minHeight: 100,\r\n    textAlignVertical: 'top',\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n  },\r\n  facilitiesGrid: {\r\n    gap: 16,\r\n  },\r\n  facilityItem: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    backgroundColor: theme.colors.surface,\r\n    padding: 12,\r\n    borderRadius: 8,\r\n  },\r\n  facilityContent: {\r\n    marginLeft: 12,\r\n  },\r\n  facilityTitle: {\r\n    fontSize: 14,\r\n    color: theme.colors.secondary,\r\n  },\r\n  facilityValue: {\r\n    fontSize: 16,\r\n    fontWeight: '500',\r\n    color: theme.colors.text,\r\n    marginTop: 2,\r\n  },\r\n  addPhotoButton: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    backgroundColor: theme.colors.primary,\r\n    paddingHorizontal: 12,\r\n    paddingVertical: 8,\r\n    borderRadius: 6,\r\n    gap: 6,\r\n  },\r\n  addPhotoText: {\r\n    color: theme.colors.background,\r\n    fontSize: 14,\r\n    fontWeight: '500',\r\n  },\r\n  photoGrid: {\r\n    flexDirection: 'row',\r\n    flexWrap: 'wrap',\r\n    gap: 16,\r\n    marginTop: 16,\r\n  },\r\n  reviewsContainer: {\r\n    marginBottom: 12,\r\n  },\r\n  noReviews: {\r\n    fontSize: 14,\r\n    color: theme.colors.secondary,\r\n    fontStyle: 'italic',\r\n  },\r\n  bioText: {\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n    lineHeight: 24,\r\n    fontFamily: theme.fonts?.regular?.fontFamily,\r\n  },\r\n  locationButtons: {\r\n    gap: 16,\r\n  },\r\n  locationButton: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    backgroundColor: theme.colors.primary,\r\n    padding: 12,\r\n    borderRadius: 8,\r\n    justifyContent: 'center',\r\n    gap: 8,\r\n  },\r\n  locationButtonText: {\r\n    color: theme.colors.background,\r\n    fontSize: 16,\r\n    fontWeight: '500',\r\n  },\r\n  orText: {\r\n    textAlign: 'center',\r\n    color: theme.colors.secondary,\r\n    fontSize: 14,\r\n  },\r\n  multilineInput: {\r\n    minHeight: 100,\r\n    textAlignVertical: 'top',\r\n  },\r\n  portfolioPhoto: {\r\n    width: '30%',\r\n    aspectRatio: 4/3,\r\n    borderRadius: 8,\r\n  },\r\n  noPhotosText: {\r\n    fontSize: 14,\r\n    color: theme.colors.secondary,\r\n    fontStyle: 'italic',\r\n    textAlign: 'center',\r\n    padding: 20,\r\n  },\r\n  facilitiesModalContent: {\r\n    height: '80%',\r\n    width: '90%',\r\n    maxWidth: 500,\r\n  },\r\n  facilitiesScrollView: {\r\n    flex: 1,\r\n    marginBottom: 16,\r\n  },\r\n  facilityPresetItem: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    padding: 16,\r\n    borderRadius: 8,\r\n    marginBottom: 8,\r\n    backgroundColor: theme.colors.background,\r\n  },\r\n  selectedFacilityPreset: {\r\n    backgroundColor: theme.colors.primary,\r\n  },\r\n  facilityPresetContent: {\r\n    flex: 1,\r\n    marginLeft: 12,\r\n  },\r\n  facilityPresetTitle: {\r\n    fontSize: 16,\r\n    fontWeight: '500',\r\n    color: theme.colors.text,\r\n    marginBottom: 4,\r\n  },\r\n  facilityPresetDescription: {\r\n    fontSize: 14,\r\n    color: theme.colors.secondary,\r\n  },\r\n  selectedFacilityText: {\r\n    color: theme.colors.background,\r\n  },\r\n  checkIcon: {\r\n    marginLeft: 8,\r\n  },\r\n  modalButtons: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'flex-end',\r\n    gap: 12,\r\n  },\r\n  modalCancelButton: {\r\n    paddingHorizontal: 16,\r\n    paddingVertical: 8,\r\n    borderRadius: 6,\r\n    backgroundColor: theme.colors.surface,\r\n  },\r\n  modalCancelText: {\r\n    color: theme.colors.text,\r\n    fontSize: 14,\r\n    fontWeight: '500',\r\n  },\r\n  modalSaveButton: {\r\n    paddingHorizontal: 16,\r\n    paddingVertical: 8,\r\n    borderRadius: 6,\r\n    backgroundColor: theme.colors.primary,\r\n  },\r\n  modalSaveText: {\r\n    color: theme.colors.background,\r\n    fontSize: 14,\r\n    fontWeight: '500',\r\n  },\r\n  locationModalContent: {\r\n    width: '90%',\r\n    maxWidth: 500,\r\n    maxHeight: '90%',\r\n  },\r\n  locationContent: {\r\n    gap: 16,\r\n    paddingBottom: 16,\r\n  },\r\n  addressInstructions: {\r\n    fontSize: 14,\r\n    color: theme.colors.secondary,\r\n    marginBottom: 8,\r\n    textAlign: 'center',\r\n  },\r\n  addressAutocomplete: {\r\n    marginBottom: 12,\r\n  },\r\n  selectedAddressInfo: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    gap: 8,\r\n    padding: 12,\r\n    backgroundColor: theme.colors.success + '10',\r\n    borderRadius: 8,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.success + '30',\r\n  },\r\n  selectedAddressText: {\r\n    fontSize: 14,\r\n    color: theme.colors.success,\r\n    fontWeight: '500',\r\n  },\r\n  addressForm: {\r\n    gap: 12,\r\n  },\r\n  addressInput: {\r\n    backgroundColor: theme.colors.background,\r\n    borderRadius: 8,\r\n    padding: 12,\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n    minHeight: 44,\r\n  },\r\n  addressRow: {\r\n    flexDirection: 'row',\r\n    gap: 12,\r\n    flexWrap: 'wrap',\r\n  },\r\n  maxFacilitiesText: {\r\n    fontSize: 14,\r\n    color: theme.colors.secondary,\r\n    fontStyle: 'italic',\r\n    textAlign: 'center',\r\n    marginTop: 8,\r\n  },\r\n  modalSaveButtonDisabled: {\r\n    opacity: 0.5,\r\n  },\r\n  insuranceContent: {\r\n    gap: 16,\r\n  },\r\n  customInsuranceCard: {\r\n    alignItems: 'center',\r\n    gap: 8,\r\n  },\r\n  insuranceCardImage: {\r\n    width: '100%',\r\n    height: 200,\r\n    borderRadius: 8,\r\n    backgroundColor: theme.colors.background,\r\n  },\r\n  insuranceCardText: {\r\n    fontSize: 14,\r\n    color: theme.colors.secondary,\r\n  },\r\n  insuranceOption: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    backgroundColor: theme.colors.background,\r\n    padding: 16,\r\n    borderRadius: 8,\r\n    gap: 16,\r\n  },\r\n  insuranceOptionContent: {\r\n    flex: 1,\r\n  },\r\n  insuranceOptionTitle: {\r\n    fontSize: 16,\r\n    fontWeight: '500',\r\n    color: theme.colors.text,\r\n    marginBottom: 4,\r\n  },\r\n  insuranceOptionDescription: {\r\n    fontSize: 14,\r\n    color: theme.colors.secondary,\r\n  },\r\n  editButtonContent: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    gap: 4,\r\n  },\r\n  insuranceStepContent: {\r\n    gap: 16,\r\n  },\r\n  insuranceStepTitle: {\r\n    fontSize: 18,\r\n    fontWeight: '500',\r\n    color: theme.colors.text,\r\n    marginBottom: 16,\r\n  },\r\n  insuranceTypeButton: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    backgroundColor: theme.colors.background,\r\n    padding: 16,\r\n    borderRadius: 8,\r\n    gap: 16,\r\n  },\r\n  insuranceTypeContent: {\r\n    flex: 1,\r\n  },\r\n  insuranceTypeTitle: {\r\n    fontSize: 16,\r\n    fontWeight: '500',\r\n    color: theme.colors.text,\r\n    marginBottom: 4,\r\n  },\r\n  insuranceTypeDescription: {\r\n    fontSize: 14,\r\n    color: theme.colors.secondary,\r\n  },\r\n  uploadButton: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    backgroundColor: theme.colors.background,\r\n    padding: 16,\r\n    borderRadius: 8,\r\n    gap: 8,\r\n  },\r\n  uploadText: {\r\n    fontSize: 16,\r\n    color: theme.colors.primary,\r\n    fontWeight: '500',\r\n  },\r\n  selectedInsuranceOption: {\r\n    backgroundColor: theme.colors.primary + '20',\r\n  },\r\n  modalOverlay: {\r\n    flex: 1,\r\n    backgroundColor: 'rgba(0, 0, 0, 0.5)',\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n  },\r\n  modalContent: {\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 8,\r\n    padding: 16,\r\n    width: '90%',\r\n    maxWidth: 400,\r\n    maxHeight: '90%',\r\n  },\r\n  modalHeader: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    justifyContent: 'space-between',\r\n    marginBottom: 16,\r\n    position: 'relative',\r\n  },\r\n  modalTitle: {\r\n    fontSize: 18,\r\n    fontWeight: '600',\r\n    color: theme.colors.text,\r\n    flex: 1,\r\n    fontFamily: theme.fonts?.header?.fontFamily,\r\n  },\r\n  modalTitleCentered: {\r\n    textAlign: 'center',\r\n  },\r\n  backButton: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    gap: 4,\r\n    position: 'absolute',\r\n    left: 0,\r\n    padding: 8,\r\n    zIndex: 1,\r\n  },\r\n  backButtonText: {\r\n    color: theme.colors.primary,\r\n    fontSize: 14,\r\n    fontWeight: '500',\r\n  },\r\n  modalInput: {\r\n    backgroundColor: theme.colors.background,\r\n    borderRadius: 8,\r\n    padding: 12,\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n    marginBottom: 16,\r\n  },\r\n  modalCloseButton: {\r\n    alignSelf: 'flex-end',\r\n    backgroundColor: theme.colors.primary,\r\n    paddingHorizontal: 16,\r\n    paddingVertical: 8,\r\n    borderRadius: 6,\r\n  },\r\n  modalCloseText: {\r\n    color: theme.colors.background,\r\n    fontSize: 14,\r\n    fontWeight: '500',\r\n  },\r\n});\r\n\r\nexport default ProfileInfoTab; ","import React, { useState, useContext } from 'react';\r\nimport { View, Text, TouchableOpacity, StyleSheet, Switch, ScrollView } from 'react-native';\r\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\r\nimport { theme } from '../../styles/theme';\r\nimport { AuthContext } from '../../context/AuthContext';\r\nimport { useNavigation } from '@react-navigation/native';\r\n\r\nconst DAYS_OF_WEEK = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'];\r\n\r\nconst ServiceIcon = ({ service }) => {\r\n  const iconMap = {\r\n    'Dog Walking': 'walk',\r\n    'Pet Sitting': 'home',\r\n    'Overnight Care': 'bed',\r\n    // Add more mappings as needed\r\n  };\r\n\r\n  return (\r\n    <MaterialCommunityIcons \r\n      name={iconMap[service] || 'paw'} \r\n      size={24} \r\n      color={theme.colors.text} \r\n    />\r\n  );\r\n};\r\n\r\nconst ServicesAvailabilityTab = ({\r\n  services = [\r\n    {\r\n      id: 1,\r\n      name: 'Dog Walking',\r\n      price: 25,\r\n      unit: 'walk',\r\n      isActive: true,\r\n      unavailableDays: ['Sun']\r\n    },\r\n    {\r\n      id: 2,\r\n      name: 'Pet Sitting',\r\n      price: 35,\r\n      unit: 'visit',\r\n      isActive: true,\r\n      unavailableDays: ['Sat', 'Sun']\r\n    },\r\n    {\r\n      id: 3,\r\n      name: 'Overnight Care',\r\n      price: 85,\r\n      unit: 'night',\r\n      isActive: true,\r\n      isOvernight: true\r\n    }\r\n  ],\r\n  onToggleService,\r\n  onEditHours,\r\n  onBlockService,\r\n  onPartialDayBlock,\r\n}) => {\r\n  const { screenWidth } = useContext(AuthContext);\r\n  const navigation = useNavigation();\r\n  const [selectedService, setSelectedService] = useState(null);\r\n  const isStacked = screenWidth <= 1250;\r\n\r\n  const renderServiceItem = (service, index) => (\r\n    <TouchableOpacity\r\n      key={service.id}\r\n      style={[\r\n        styles.serviceItem,\r\n        { backgroundColor: index % 2 === 0 ? \r\n          theme.colors.proDashboard.secondary : \r\n          theme.colors.proDashboard.tertiary \r\n        },\r\n        selectedService?.id === service.id && styles.selectedServiceItem\r\n      ]}\r\n      onPress={() => setSelectedService(service)}\r\n    >\r\n      <View style={styles.serviceItemContent}>\r\n        <ServiceIcon service={service.name} />\r\n        <View style={styles.serviceInfo}>\r\n          <Text style={styles.serviceName}>{service.name}</Text>\r\n          <Text style={styles.servicePrice}>${service.price}/{service.unit}</Text>\r\n        </View>\r\n      </View>\r\n      <Switch\r\n        value={service.isActive}\r\n        onValueChange={() => onToggleService(service.id)}\r\n        trackColor={{ false: theme.colors.border, true: theme.colors.primary }}\r\n        thumbColor={theme.colors.background}\r\n      />\r\n    </TouchableOpacity>\r\n  );\r\n\r\n  const renderDayAvailability = (service) => {\r\n    if (service.isOvernight) {\r\n      // For overnight services, show next unavailable date\r\n      return (\r\n        <View style={styles.nextUnavailableContainer}>\r\n          <Text style={styles.nextUnavailableText}>Next Unavailable: Dec 24-25</Text>\r\n        </View>\r\n      );\r\n    }\r\n\r\n    return (\r\n      <ScrollView \r\n        horizontal \r\n        showsHorizontalScrollIndicator={false}\r\n        style={styles.daysScrollContainer}\r\n        contentContainerStyle={styles.daysContainer}\r\n      >\r\n        {DAYS_OF_WEEK.map((day) => {\r\n          const isUnavailable = service.unavailableDays?.includes(day);\r\n          return (\r\n            <View \r\n              key={day} \r\n              style={[\r\n                styles.dayItem,\r\n                isUnavailable && styles.unavailableDayItem\r\n              ]}\r\n            >\r\n              {isUnavailable && <View style={styles.unavailableSlash} />}\r\n              <Text style={[\r\n                styles.dayText,\r\n                isUnavailable && styles.unavailableDayText\r\n              ]}>{day}</Text>\r\n            </View>\r\n          );\r\n        })}\r\n      </ScrollView>\r\n    );\r\n  };\r\n\r\n  const renderAvailabilitySection = (service, index) => (\r\n    <View style={styles.availabilitySection}>\r\n      <View style={styles.availabilityHeader}>\r\n        <Text style={styles.availabilityTitle}>{service.name}</Text>\r\n        <TouchableOpacity \r\n          style={styles.editHoursButton}\r\n          onPress={() => onEditHours(service.id)}\r\n        >\r\n          <Text style={styles.editHoursText}>Edit Hours</Text>\r\n        </TouchableOpacity>\r\n      </View>\r\n      {renderDayAvailability(service)}\r\n      <Text style={styles.availabilityTime}>\r\n        {service.isOvernight ? 'Check-in: 3 PM, Check-out: 11 AM' : 'Available 9 AM - 5 PM'}\r\n      </Text>\r\n      {index !== services.length - 1 && <View style={styles.availabilityDivider} />}\r\n    </View>\r\n  );\r\n\r\n  return (\r\n    <View style={styles.container}>\r\n      <View style={[\r\n        styles.content,\r\n        { flexDirection: isStacked ? 'column' : 'row' }\r\n      ]}>\r\n        {/* Services Section */}\r\n        <View style={[\r\n          styles.servicesSection,\r\n          !isStacked && { maxWidth: 400 },\r\n          styles.sectionBox\r\n        ]}>\r\n          <View style={styles.sectionHeader}>\r\n            <Text style={styles.sectionTitle}>Your Services</Text>\r\n            <TouchableOpacity \r\n              style={styles.editButton}\r\n              onPress={() => navigation.navigate('ServiceManager')}\r\n            >\r\n              <Text style={styles.editButtonText}>Edit Services</Text>\r\n            </TouchableOpacity>\r\n          </View>\r\n          <View style={styles.servicesList}>\r\n            {services.map((service, index) => (\r\n              <View key={service.id} style={styles.serviceWrapper}>\r\n                {renderServiceItem(service, index)}\r\n                {index !== services.length - 1 && <View style={styles.serviceDivider} />}\r\n              </View>\r\n            ))}\r\n          </View>\r\n        </View>\r\n\r\n        {/* Availability Section */}\r\n        <View style={[\r\n          styles.availabilityContainer,\r\n          isStacked && { marginTop: 24 },\r\n          styles.sectionBox\r\n        ]}>\r\n          <View style={styles.sectionHeader}>\r\n            <Text style={styles.sectionTitle}>Availability</Text>\r\n          </View>\r\n          <ScrollView \r\n            horizontal \r\n            showsHorizontalScrollIndicator={false}\r\n            style={styles.controlsScrollContainer}\r\n            contentContainerStyle={styles.availabilityControls}\r\n          >\r\n            <TouchableOpacity \r\n              style={styles.controlButton}\r\n              onPress={onBlockService}\r\n            >\r\n              <View style={styles.blockButtonContent}>\r\n                <MaterialCommunityIcons name=\"block-helper\" size={20} color={theme.colors.error} />\r\n                <Text style={styles.blockButtonText}>Block All Services</Text>\r\n              </View>\r\n            </TouchableOpacity>\r\n            <TouchableOpacity \r\n              style={styles.controlButton}\r\n              onPress={onPartialDayBlock}\r\n            >\r\n              <View style={styles.partialBlockButtonContent}>\r\n                <MaterialCommunityIcons name=\"clock-outline\" size={20} color=\"#F97316\" />\r\n                <Text style={styles.partialBlockText}>Partial Day Block</Text>\r\n              </View>\r\n            </TouchableOpacity>\r\n            <TouchableOpacity \r\n              style={styles.controlButton}\r\n            >\r\n              <View style={styles.dateRangeButtonContent}>\r\n                <MaterialCommunityIcons name=\"calendar-range\" size={20} color=\"#3B82F6\" />\r\n                <Text style={styles.dateRangeText}>Date Range</Text>\r\n              </View>\r\n            </TouchableOpacity>\r\n          </ScrollView>\r\n          <View style={styles.controlsDivider} />\r\n          <View style={styles.availabilityList}>\r\n            {services.map((service, index) => renderAvailabilitySection(service, index))}\r\n          </View>\r\n        </View>\r\n      </View>\r\n    </View>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    backgroundColor: theme.colors.surface,\r\n  },\r\n  content: {\r\n    padding: 24,\r\n    gap: 24,\r\n  },\r\n  sectionBox: {\r\n    backgroundColor: theme.colors.surfaceContrast,\r\n    borderRadius: 8,\r\n    padding: 16,\r\n    alignSelf: 'flex-start',\r\n  },\r\n  servicesSection: {\r\n    width: '100%',\r\n  },\r\n  servicesList: {\r\n    width: '100%',\r\n  },\r\n  serviceWrapper: {\r\n    width: '100%',\r\n  },\r\n  serviceItem: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    justifyContent: 'space-between',\r\n    padding: 16,\r\n    borderRadius: 8,\r\n    marginBottom: 8,\r\n  },\r\n  selectedServiceItem: {\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.primary,\r\n  },\r\n  serviceItemContent: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    flex: 1,\r\n  },\r\n  serviceInfo: {\r\n    marginLeft: 12,\r\n    flex: 1,\r\n  },\r\n  serviceName: {\r\n    fontSize: 16,\r\n    fontWeight: '500',\r\n    color: theme.colors.text,\r\n  },\r\n  servicePrice: {\r\n    fontSize: 14,\r\n    color: theme.colors.secondary,\r\n    marginTop: 2,\r\n  },\r\n  availabilityContainer: {\r\n    flex: 1,\r\n    width: '100%',\r\n  },\r\n  controlsScrollContainer: {\r\n    marginBottom: 16,\r\n  },\r\n  availabilityControls: {\r\n    flexDirection: 'row',\r\n    gap: 8,\r\n  },\r\n  controlsDivider: {\r\n    height: 1,\r\n    backgroundColor: theme.colors.surface,\r\n    marginBottom: 16,\r\n  },\r\n  daysScrollContainer: {\r\n    marginBottom: 12,\r\n  },\r\n  daysContainer: {\r\n    flexDirection: 'row',\r\n    gap: 8,\r\n  },\r\n  availabilityDivider: {\r\n    height: 4,\r\n    backgroundColor: theme.colors.surface,\r\n    marginTop: 16,\r\n  },\r\n  availabilitySection: {\r\n    backgroundColor: theme.colors.surfaceContrast,\r\n    borderRadius: 8,\r\n    padding: 16,\r\n    marginBottom: 16,\r\n  },\r\n  availabilityHeader: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    marginBottom: 16,\r\n  },\r\n  availabilityTitle: {\r\n    fontSize: 16,\r\n    fontWeight: '600',\r\n    color: theme.colors.text,\r\n  },\r\n  editHoursButton: {\r\n    backgroundColor: 'transparent',\r\n  },\r\n  editHoursText: {\r\n    color: theme.colors.primary,\r\n    fontSize: 14,\r\n    fontWeight: '500',\r\n  },\r\n  dayItem: {\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.primary,\r\n    backgroundColor: 'transparent',\r\n    paddingHorizontal: 12,\r\n    paddingVertical: 8,\r\n    borderRadius: 6,\r\n    position: 'relative',\r\n    overflow: 'hidden',\r\n  },\r\n  petsittingDayItem: {\r\n    backgroundColor: theme.colors.warningLight,\r\n  },\r\n  dayText: {\r\n    color: theme.colors.primary,\r\n    fontSize: 14,\r\n    fontWeight: '500',\r\n    zIndex: 1,\r\n  },\r\n  availabilityTime: {\r\n    fontSize: 14,\r\n    color: theme.colors.secondary,\r\n  },\r\n  serviceDivider: {\r\n    // height: 1,\r\n    backgroundColor: theme.colors.surface,\r\n    marginVertical: 8,\r\n    marginHorizontal: 16,\r\n  },\r\n  availabilityList: {\r\n    width: '100%',\r\n  },\r\n  sectionHeader: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    marginBottom: 16,\r\n  },\r\n  sectionTitle: {\r\n    fontSize: 18,\r\n    fontWeight: '600',\r\n    color: theme.colors.text,\r\n  },\r\n  editButton: {\r\n    backgroundColor: 'transparent',\r\n  },\r\n  editButtonText: {\r\n    color: theme.colors.primary,\r\n    fontSize: 14,\r\n    fontWeight: '500',\r\n  },\r\n  controlButton: {\r\n    borderRadius: 20,\r\n    overflow: 'hidden',\r\n  },\r\n  blockButtonContent: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    paddingVertical: 8,\r\n    paddingHorizontal: 12,\r\n    backgroundColor: '#FEE2E2',\r\n    gap: 6,\r\n  },\r\n  blockButtonText: {\r\n    color: theme.colors.error,\r\n    fontSize: 14,\r\n    fontWeight: '500',\r\n  },\r\n  partialBlockButtonContent: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    paddingVertical: 8,\r\n    paddingHorizontal: 12,\r\n    backgroundColor: '#FFEDD5',\r\n    gap: 6,\r\n  },\r\n  partialBlockText: {\r\n    color: '#F97316',\r\n    fontSize: 14,\r\n    fontWeight: '500',\r\n  },\r\n  dateRangeButtonContent: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    paddingVertical: 8,\r\n    paddingHorizontal: 12,\r\n    backgroundColor: '#EFF6FF',\r\n    gap: 6,\r\n  },\r\n  dateRangeText: {\r\n    color: '#3B82F6',\r\n    fontSize: 14,\r\n    fontWeight: '500',\r\n  },\r\n  unavailableDayItem: {\r\n    borderColor: theme.colors.error,\r\n  },\r\n  unavailableSlash: {\r\n    position: 'absolute',\r\n    top: '50%',\r\n    left: -5,\r\n    right: -5,\r\n    height: 1,\r\n    backgroundColor: theme.colors.error,\r\n    transform: [{ rotate: '45deg' }],\r\n  },\r\n  unavailableDayText: {\r\n    color: theme.colors.error,\r\n  },\r\n  nextUnavailableContainer: {\r\n    paddingVertical: 8,\r\n    paddingHorizontal: 12,\r\n  },\r\n  nextUnavailableText: {\r\n    fontSize: 14,\r\n    color: theme.colors.secondary,\r\n  },\r\n});\r\n\r\nexport default ServicesAvailabilityTab; ","// This is a calculation for the addpet.js file\r\nexport const calculateAge = (birthday) => {\r\n  if (!birthday) return '';\r\n  const today = new Date();\r\n  const birthDate = new Date(birthday);\r\n  let ageYears = today.getFullYear() - birthDate.getFullYear();\r\n  let ageMonths = today.getMonth() - birthDate.getMonth();\r\n\r\n  if (ageMonths < 0) {\r\n    ageYears--;\r\n    ageMonths += 12;\r\n  }\r\n\r\n  let result = '';\r\n  if (ageYears > 0) {\r\n    result += `${ageYears} year${ageYears > 1 ? 's' : ''}`;\r\n  }\r\n  if (ageMonths > 0) {\r\n    if (result) result += ' ';\r\n    result += `${ageMonths} month${ageMonths > 1 ? 's' : ''}`;\r\n  }\r\n  if (!result) result = '< 1 month';\r\n  return result;\r\n};\r\n\r\nexport const calculateProratedMultiplier = (startDate, endDate, startTime, endTime, timeUnit) => {\r\n    // Parse the dates and times separately\r\n    const [startYear, startMonth, startDay] = startDate.split('-').map(Number);\r\n    const [startHour, startMinute] = startTime.split(':').map(Number);\r\n    const [endYear, endMonth, endDay] = endDate.split('-').map(Number);\r\n    const [endHour, endMinute] = endTime.split(':').map(Number);\r\n\r\n    console.log('MBA12348785 ========= Starting calculateProratedMultiplier =========');\r\n    console.log('MBA12348785 Input parameters:', {\r\n        startDate,\r\n        endDate,\r\n        startTime,\r\n        endTime,\r\n        timeUnit\r\n    });\r\n\r\n    console.log('MBA12348785 Parsed components:', {\r\n        start: {\r\n            year: startYear,\r\n            month: startMonth,\r\n            day: startDay,\r\n            hour: startHour,\r\n            minute: startMinute\r\n        },\r\n        end: {\r\n            year: endYear,\r\n            month: endMonth,\r\n            day: endDay,\r\n            hour: endHour,\r\n            minute: endMinute\r\n        }\r\n    });\r\n\r\n    // Calculate days difference directly\r\n    const startDateOnly = new Date(Date.UTC(startYear, startMonth - 1, startDay));\r\n    const endDateOnly = new Date(Date.UTC(endYear, endMonth - 1, endDay));\r\n    const daysDiff = Math.floor((endDateOnly - startDateOnly) / (1000 * 60 * 60 * 24));\r\n    const daysDiffHours = daysDiff * 24;\r\n    \r\n    console.log('MBA12348785 Date difference calculation:', {\r\n        startDateOnly: startDateOnly.toISOString(),\r\n        endDateOnly: endDateOnly.toISOString(),\r\n        daysDiff,\r\n        daysDiffHours\r\n    });\r\n    \r\n    // Calculate time difference\r\n    const startTimeMinutes = startHour * 60 + startMinute;\r\n    const endTimeMinutes = endHour * 60 + endMinute;\r\n    const timeDiffHours = (endTimeMinutes - startTimeMinutes) / 60;\r\n    \r\n    console.log('MBA12348785 Time difference calculation:', {\r\n        startTimeMinutes,\r\n        endTimeMinutes,\r\n        timeDiffHours\r\n    });\r\n    \r\n    // Total hours is days difference plus time difference\r\n    const totalHours = daysDiffHours + timeDiffHours;\r\n    \r\n    console.log('MBA12348785 Total duration:', {\r\n        daysDiffHours,\r\n        timeDiffHours,\r\n        totalHours\r\n    });\r\n\r\n    let result;\r\n    switch(timeUnit) {\r\n        case '15 Min':\r\n            result = totalHours / .25;\r\n            break;\r\n        case '30 Min':\r\n            result = totalHours / .5;\r\n            break;\r\n        case '45 Min':\r\n            result = totalHours / .75;\r\n            break;\r\n        case '1 Hour':\r\n            result = totalHours / 1;\r\n            break;\r\n        case '2 Hour':\r\n            result = totalHours / 2;\r\n            break;\r\n        case '3 Hour':\r\n            result = totalHours / 3;\r\n            break;\r\n        case '4 Hour':\r\n            result = totalHours / 4;\r\n            break;\r\n        case '5 Hour':\r\n            result = totalHours / 5;\r\n            break;\r\n        case '6 Hour':\r\n            result = totalHours / 6;\r\n            break;\r\n        case '7 Hour':\r\n            result = totalHours / 7;\r\n            break;\r\n        case '8 Hour':\r\n            result = totalHours / 8;\r\n            break;\r\n        case '24 Hour':\r\n        case 'Per Day':\r\n            result = totalHours / 24;\r\n            break;\r\n        case 'Week':\r\n            result = totalHours / 168;\r\n            break;\r\n        case 'Per Visit':\r\n            result = 1;\r\n            break;\r\n        default:\r\n            result = 1;\r\n    }\r\n\r\n    console.log('MBA12348785 Final calculation:', {\r\n        timeUnit,\r\n        totalHours,\r\n        divisor: timeUnit === 'Per Visit' ? 1 : timeUnit === 'Week' ? 168 : parseInt(timeUnit) || 24,\r\n        result\r\n    });\r\n    console.log('MBA12348785 ========= End calculateProratedMultiplier =========');\r\n\r\n    return result;\r\n};\r\n  \r\n// Implementation of the backend's calculate_cost function in JavaScript\r\nexport const calculateOccurrenceCost = (occurrenceData, numPets = 0) => {\r\n    console.log('MBA93652 Starting cost calculation with data:', {\r\n        occurrenceData,\r\n        numPets\r\n    });\r\n\r\n    // Extract values from occurrence data\r\n    const {\r\n        start_date,\r\n        end_date,\r\n        start_time,\r\n        end_time,\r\n        rates: {\r\n            base_rate,\r\n            additional_animal_rate,\r\n            applies_after,\r\n            holiday_rate,\r\n            unit_of_time,\r\n            additional_rates = []\r\n        }\r\n    } = occurrenceData;\r\n\r\n    // Calculate number of units needed (this already handles the unit_of_time appropriately)\r\n    const numberOfUnits = calculateProratedMultiplier(\r\n        start_date,\r\n        end_date,\r\n        start_time,\r\n        end_time,\r\n        unit_of_time\r\n    );\r\n\r\n    console.log('MBA93652 calculateProratedMultiplier returned:', {\r\n        numberOfUnits,\r\n        unit_of_time,\r\n        start: `${start_date} ${start_time}`,\r\n        end: `${end_date} ${end_time}`\r\n    });\r\n    \r\n    // Calculate base cost - simply multiply base rate by number of units\r\n    const baseTotal = parseFloat(base_rate) * numberOfUnits;\r\n\r\n    console.log('MBA93652 Base cost calculation:', {\r\n        numberOfUnits,\r\n        baseTotal,\r\n        base_rate\r\n    });\r\n\r\n    // Calculate additional animal cost\r\n    let additionalAnimalRateTotal = 0;\r\n    if (numPets > parseInt(applies_after)) {\r\n        const additionalPets = numPets - parseInt(applies_after);\r\n        additionalAnimalRateTotal = parseFloat(additional_animal_rate) * additionalPets;\r\n    }\r\n\r\n    console.log('MBA93652 Additional animal cost:', {\r\n        additionalAnimalRateTotal,\r\n        numPets,\r\n        applies_after,\r\n        additional_animal_rate\r\n    });\r\n\r\n    // Add holiday rate if applicable (currently not implemented)\r\n    const holidayRateTotal = 0;\r\n\r\n    // Calculate additional rates total\r\n    const additionalRatesTotal = additional_rates.reduce((sum, rate) => \r\n        sum + parseFloat(rate.amount || 0), 0);\r\n\r\n    console.log('MBA93652 Additional rates:', {\r\n        additionalRatesTotal,\r\n        additional_rates\r\n    });\r\n\r\n    // Calculate total\r\n    const totalCost = baseTotal + additionalAnimalRateTotal + holidayRateTotal + additionalRatesTotal;\r\n\r\n    console.log('MBA93652 Final calculation:', {\r\n        baseTotal,\r\n        additionalAnimalRateTotal,\r\n        holidayRateTotal,\r\n        additionalRatesTotal,\r\n        totalCost\r\n    });\r\n\r\n    return {\r\n        base_total: baseTotal,\r\n        multiplier: numberOfUnits,\r\n        additional_animal_rate_total: additionalAnimalRateTotal,\r\n        holiday_rate_total: holidayRateTotal,\r\n        additional_rates_total: additionalRatesTotal,\r\n        total_cost: totalCost\r\n    };\r\n};","import React, { useState, useRef, useMemo, useEffect } from 'react';\r\nimport { View, Text, TouchableOpacity, StyleSheet, Image, TextInput, ScrollView, Platform, Modal, Dimensions, TouchableWithoutFeedback } from 'react-native';\r\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\r\nimport { theme } from '../../styles/theme';\r\nimport { debugLog } from '../../context/AuthContext';\r\nimport DateTimePicker from '@react-native-community/datetimepicker';\r\nimport { addPet, updatePet, fixPetOwner, deletePet } from '../../api/API';\r\nimport { useToast } from '../../components/ToastProvider';\r\nimport ConfirmationModal from '../ConfirmationModal';\r\nimport { calculateAge } from '../../data/calculations';\r\n\r\nconst PetsPreferencesTab = ({\r\n  pets = [],\r\n  preferences = {\r\n    homeEnvironment: [],\r\n    emergencyContacts: [],\r\n    authorizedHouseholdMembers: []\r\n  },\r\n  onAddPet,\r\n  onEditPet,\r\n  onDeletePet,\r\n  onReplacePet, // New prop for atomic replace operation\r\n  onUpdatePreferences,\r\n  userRole,\r\n  isMobile,\r\n}) => {\r\n  const [expandedPetIds, setExpandedPetIds] = useState(new Set());\r\n  const [newEmergencyContact, setNewEmergencyContact] = useState({ name: '', phone: '' });\r\n  const [newHouseholdMember, setNewHouseholdMember] = useState({ name: '', phone: '' });\r\n  const [isAddingEmergencyContact, setIsAddingEmergencyContact] = useState(false);\r\n  const [isAddingHouseholdMember, setIsAddingHouseholdMember] = useState(false);\r\n  const [editingPetIds, setEditingPetIds] = useState(new Set());\r\n  const [editedPetsData, setEditedPetsData] = useState({});\r\n  const [expandedSections, setExpandedSections] = useState({});\r\n  const [datePickerConfig, setDatePickerConfig] = useState({\r\n    isVisible: false,\r\n    currentField: null,\r\n    currentPetId: null,\r\n    selectedDate: new Date()\r\n  });\r\n  \r\n  // Add state for calendar display\r\n  const [displayMonth, setDisplayMonth] = useState(new Date().getMonth());\r\n  const [displayYear, setDisplayYear] = useState(new Date().getFullYear());\r\n  const [windowWidth, setWindowWidth] = useState(Dimensions.get('window').width);\r\n  const toast = useToast();\r\n\r\n  // Add this new variable to track if a save operation is in progress\r\n  const [savingPet, setSavingPet] = useState(false);\r\n\r\n  // Add this near other state declarations\r\n  const [showSuccessModals, setShowSuccessModals] = useState(true);\r\n\r\n  // Add state for delete confirmation modal\r\n  const [deleteConfirmation, setDeleteConfirmation] = useState({\r\n    visible: false,\r\n    petId: null,\r\n    petName: '',\r\n    isDeleting: false\r\n  });\r\n\r\n  // Add these new state variables at the top of the component with other state declarations\r\n  const [showMonthPicker, setShowMonthPicker] = useState(false);\r\n  const [showYearPicker, setShowYearPicker] = useState(false);\r\n\r\n  // Add window resize listener\r\n  useEffect(() => {\r\n    const updateWidth = () => {\r\n      setWindowWidth(Dimensions.get('window').width);\r\n    };\r\n\r\n    Dimensions.addEventListener('change', updateWidth);\r\n    \r\n    return () => {\r\n      // For newer React Native versions, we would use remove\r\n      // In case this component is using an older version, handle appropriately\r\n      if (Dimensions.removeEventListener) {\r\n        Dimensions.removeEventListener('change', updateWidth);\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  // Define all available facilities\r\n  const allFacilities = [\r\n    { id: 'yard', label: 'Fully fenced backyard', icon: 'fence' },\r\n    { id: 'roam', label: 'Free roam of house', icon: 'home' },\r\n    { id: 'ac', label: 'Air Conditioned', icon: 'snowflake' },\r\n    { id: 'furniture', label: 'Allowed on furniture', icon: 'sofa' },\r\n    { id: 'bed', label: 'Allowed on bed', icon: 'bed' },\r\n    { id: 'crate', label: 'Crate Available', icon: 'gate' },\r\n    { id: 'pet_door', label: 'Pet Door', icon: 'door' },\r\n    { id: 'toys', label: 'Pet Toy Collection', icon: 'handball' },\r\n    { id: 'first_aid', label: 'Pet First Aid Kit', icon: 'medical-bag' },\r\n    { id: 'cameras', label: 'Pet Cameras', icon: 'cctv' },\r\n    { id: 'covered_patio', label: 'Covered Patio', icon: 'umbrella' },\r\n    { id: 'garden', label: 'Pet-Safe Garden', icon: 'flower' },\r\n    { id: 'heating', label: 'Central Heating', icon: 'fire' },\r\n    { id: 'feeding_station', label: 'Feeding Station', icon: 'food-variant' },\r\n    { id: 'water_fountain', label: 'Water Fountain', icon: 'fountain' },\r\n    { id: 'scratching_post', label: 'Cat Posts', icon: 'cat' },\r\n    { id: 'litter_area', label: 'Private Litter Area', icon: 'broom' }\r\n  ];\r\n\r\n  // Define selectable options for dropdowns\r\n  const yesNoOptions = [\"Yes\", \"No\", \"N/A\"];\r\n  const energyLevelOptions = [\"Low\", \"Medium\", \"High\", \"N/A\"];\r\n  const sexOptions = [\"Male\", \"Female\"];\r\n\r\n  // Add at the top of the component, after the other utility functions\r\n  \r\n  // Helper function to safely convert any value to a display string\r\n  const safeDisplayText = (value, defaultText = '') => {\r\n    if (value === null || value === undefined) {\r\n      return defaultText;\r\n    }\r\n    \r\n    if (typeof value === 'string') {\r\n      return value;\r\n    }\r\n    \r\n    if (typeof value === 'number' || typeof value === 'boolean') {\r\n      return String(value);\r\n    }\r\n    \r\n    // For any other type (like objects), return the default\r\n    return defaultText;\r\n  };\r\n  \r\n  const returnYesNoContainer = (pet, attributeName) => {\r\n    let displayValue = 'No Option Selected';\r\n    \r\n    if (pet && attributeName) {\r\n      if (pet[attributeName] === null) {\r\n        displayValue = 'N/A';\r\n      } else if (pet[attributeName] === true) {\r\n        displayValue = 'Yes';\r\n      } else if (pet[attributeName] === false) {\r\n        displayValue = 'No';\r\n      } else if (typeof pet[attributeName] === 'string') {\r\n        displayValue = pet[attributeName];\r\n      }\r\n      // If pet[attributeName] is an object or other non-string type, keep the default \"No Option Selected\"\r\n    }\r\n    \r\n    return (\r\n      <View style={styles.dropdownContainer}>\r\n        <Text style={styles.dropdownText}>{displayValue}</Text>\r\n      </View>\r\n    );\r\n  };\r\n\r\n  const returnEnergyLevelContainer = (pet) => {\r\n    // Map backend value to frontend display value\r\n    let displayValue = 'No Option Selected';\r\n    \r\n    // Make sure pet exists before trying to access its energyLevel property\r\n    if (pet && pet.energyLevel !== undefined) {\r\n      if (pet.energyLevel === null) {\r\n        displayValue = 'N/A';\r\n      } else if (pet.energyLevel === 'LOW') {\r\n        displayValue = 'Low';\r\n      } else if (pet.energyLevel === 'MODERATE') {\r\n        displayValue = 'Medium';\r\n      } else if (pet.energyLevel === 'HIGH') {\r\n        displayValue = 'High';\r\n      } else if (typeof pet.energyLevel === 'string') {\r\n        displayValue = pet.energyLevel; // Fallback to whatever string is there\r\n      } else if (pet.energyLevel && typeof pet.energyLevel === 'object') {\r\n        displayValue = 'No Option Selected';\r\n      }\r\n    }\r\n    \r\n    return (\r\n      <View style={styles.dropdownContainer}>\r\n        <Text style={styles.dropdownText}>{displayValue}</Text>\r\n      </View>\r\n    );\r\n  };\r\n\r\n  const togglePetDetails = (petId) => {\r\n    // Remove the condition that prevents toggling when editing\r\n    // We want to allow collapsing/expanding even in edit mode\r\n    setExpandedPetIds(prev => {\r\n      const newSet = new Set(prev);\r\n      if (newSet.has(petId)) {\r\n        newSet.delete(petId);\r\n      } else {\r\n        newSet.add(petId);\r\n      }\r\n      return newSet;\r\n    });\r\n  };\r\n\r\n  const handleEditPet = (petId) => {\r\n    // Clone the current pet data to edit\r\n    const petToEdit = pets.find(pet => pet.id === petId);\r\n    \r\n    // Update the edited data for this specific pet\r\n    setEditedPetsData(prev => ({\r\n      ...prev,\r\n      [petId]: {...petToEdit}\r\n    }));\r\n    \r\n    // Add this pet's ID to the set of pets being edited\r\n    setEditingPetIds(prev => {\r\n      const newSet = new Set(prev);\r\n      newSet.add(petId);\r\n      return newSet;\r\n    });\r\n  };\r\n  \r\n  const handleFixPet = async (petId) => {\r\n    try {\r\n      debugLog(\"MBA456\", \"Attempting to fix pet with ID:\", petId);\r\n      \r\n      // Show fixing toast\r\n      toast({\r\n        message: \"Attempting to repair pet data. Please wait...\",\r\n        type: 'info',\r\n        duration: 3000\r\n      });\r\n      \r\n      // Call the fix pet owner API\r\n      const response = await fixPetOwner(petId);\r\n      debugLog(\"MBA456\", \"Successfully fixed pet owner:\", response);\r\n      \r\n      // Update the pet data with the fixed pet info\r\n      if (response && response.pet) {\r\n        // Find the current pet data\r\n        const currentPetIndex = pets.findIndex(pet => pet.id === petId);\r\n        if (currentPetIndex !== -1) {\r\n          // Create updated pet data\r\n          const updatedPet = {\r\n            ...pets[currentPetIndex],\r\n            ...response.pet,\r\n            // Ensure UI-specific fields are updated\r\n            type: response.pet.species || pets[currentPetIndex].type,\r\n            feedingInstructions: response.pet.feeding_schedule || pets[currentPetIndex].feedingInstructions,\r\n            medicalNotes: response.pet.medication_notes || pets[currentPetIndex].medicalNotes,\r\n            pottyBreakSchedule: response.pet.potty_break_schedule || pets[currentPetIndex].pottyBreakSchedule,\r\n            specialCareInstructions: response.pet.special_care_instructions || pets[currentPetIndex].specialCareInstructions,\r\n            birthday: response.pet.birthday ? formatDateFromBackend(response.pet.birthday) : pets[currentPetIndex].birthday,\r\n            adoptionDate: response.pet.adoption_date ? formatDateFromBackend(response.pet.adoption_date) : pets[currentPetIndex].adoptionDate,\r\n            lastEditFailed: false // Clear the error flag\r\n          };\r\n          \r\n          // Update the pet in the parent component\r\n          onEditPet(petId, updatedPet);\r\n          \r\n          // Show success toast\r\n          toast({\r\n            message: \"The pet's owner has been restored. You should now be able to edit this pet normally.\",\r\n            type: 'success',\r\n            duration: 5000\r\n          });\r\n        }\r\n      }\r\n    } catch (error) {\r\n      debugLog(\"MBA456\", \"Error fixing pet:\", error);\r\n      \r\n      // Show error toast\r\n      let errorMessage = \"There was a problem fixing the pet. Please try again or contact support.\";\r\n      \r\n      if (error.response && error.response.data) {\r\n        if (error.response.data.error) {\r\n          errorMessage = error.response.data.error;\r\n        }\r\n      }\r\n      \r\n      toast({\r\n        message: errorMessage,\r\n        type: 'error',\r\n        duration: 5000\r\n      });\r\n    }\r\n  };\r\n  \r\n  const handleDeletePet = async (petId) => {\r\n    // Find the pet to get its name for the confirmation\r\n    const petToDelete = pets.find(pet => pet.id === petId);\r\n    const petName = petToDelete ? petToDelete.name : 'this pet';\r\n    \r\n    // Show confirmation modal\r\n    setDeleteConfirmation({\r\n      visible: true,\r\n      petId: petId,\r\n      petName: petName,\r\n      isDeleting: false\r\n    });\r\n  };\r\n  \r\n  const confirmDeletePet = async () => {\r\n    try {\r\n      const { petId, petName } = deleteConfirmation;\r\n      \r\n      // Set deleting state\r\n      setDeleteConfirmation(prev => ({ ...prev, isDeleting: true }));\r\n      \r\n      debugLog(\"MBA456\", \"Attempting to delete pet with ID:\", petId);\r\n      \r\n      // Show deleting toast\r\n      toast({\r\n        message: `Deleting ${petName}...`,\r\n        type: 'info',\r\n        duration: 3000\r\n      });\r\n      \r\n      // Call the delete pet API\r\n      await deletePet(petId);\r\n      debugLog(\"MBA456\", \"Successfully deleted pet:\", petId);\r\n      \r\n      // Remove the pet from the parent component's state\r\n      onDeletePet(petId);\r\n      \r\n      // Hide modal\r\n      setDeleteConfirmation({\r\n        visible: false,\r\n        petId: null,\r\n        petName: '',\r\n        isDeleting: false\r\n      });\r\n      \r\n      // Show success toast\r\n      toast({\r\n        message: `${petName} has been successfully deleted.`,\r\n        type: 'success',\r\n        duration: 3000\r\n      });\r\n      \r\n    } catch (error) {\r\n      debugLog(\"MBA456\", \"Error deleting pet:\", error);\r\n      \r\n      // Reset deleting state but keep modal open\r\n      setDeleteConfirmation(prev => ({ ...prev, isDeleting: false }));\r\n      \r\n      // Show error toast\r\n      let errorMessage = \"There was a problem deleting the pet. Please try again or contact support.\";\r\n      \r\n      if (error.response && error.response.data) {\r\n        if (error.response.data.error) {\r\n          errorMessage = error.response.data.error;\r\n        }\r\n      }\r\n      \r\n      toast({\r\n        message: errorMessage,\r\n        type: 'error',\r\n        duration: 5000\r\n      });\r\n    }\r\n  };\r\n  \r\n  const cancelDeletePet = () => {\r\n    setDeleteConfirmation({\r\n      visible: false,\r\n      petId: null,\r\n      petName: '',\r\n      isDeleting: false\r\n    });\r\n  };\r\n  \r\n  const formatDateForBackend = (dateString) => {\r\n    if (!dateString) return null;\r\n    \r\n    // Convert from MM-DD-YYYY to YYYY-MM-DD\r\n    const [month, day, year] = dateString.split('-');\r\n    return `${year}-${month}-${day}`;\r\n  };\r\n  \r\n  // Helper function to convert dates from backend format to frontend format\r\n  const formatDateFromBackend = (dateString) => {\r\n    if (!dateString) return null;\r\n    \r\n    // Convert from YYYY-MM-DD to MM-DD-YYYY\r\n    const [year, month, day] = dateString.split('-');\r\n    return `${month}-${day}-${year}`;\r\n  };\r\n  \r\n  const handleSavePetEdit = async (petId) => {\r\n    // Prevent multiple clicks\r\n    if (savingPet) {\r\n      debugLog(\"MBA5555\", \"SAVE PET - Already saving, ignoring duplicate click\");\r\n      return;\r\n    }\r\n    \r\n    try {\r\n      // Mark that we're starting a save operation\r\n      setSavingPet(true);\r\n      \r\n      // Log current state for debugging\r\n      debugLog(\"MBA5555\", \"SAVE PET - Starting save with pets:\", pets.map(p => ({id: p.id, name: p.name || 'unnamed'})));\r\n      debugLog(\"MBA5555\", \"SAVE PET - Saving petId:\", petId);\r\n      \r\n      // Get the edited data for this pet\r\n      const editedData = editedPetsData[petId] || {};\r\n      \r\n      // Format the pet data for the backend\r\n      const petData = {\r\n        name: editedData.name || '',\r\n        species: editedData.type || '',\r\n        breed: editedData.breed || '',\r\n        age_years: editedData.ageYears,\r\n        age_months: editedData.ageMonths,\r\n        weight: editedData.weight,\r\n        birthday: editedData.birthday ? formatDateForBackend(editedData.birthday) : null,\r\n        sex: editedData.sex,\r\n        adoption_date: editedData.adoptionDate ? formatDateForBackend(editedData.adoptionDate) : null,\r\n        pet_description: editedData.description || '',\r\n        friendly_with_children: editedData.childrenFriendly,\r\n        friendly_with_cats: editedData.catFriendly,\r\n        friendly_with_dogs: editedData.dogFriendly,\r\n        spayed_neutered: editedData.spayedNeutered,\r\n        house_trained: editedData.houseTrained,\r\n        microchipped: editedData.microchipped,\r\n        feeding_schedule: editedData.feedingInstructions || '',\r\n        potty_break_schedule: editedData.pottyBreakSchedule || '',\r\n        energy_level: editedData.energyLevel || '',\r\n        can_be_left_alone: editedData.canBeLeftAlone,\r\n        medication_notes: editedData.medicalNotes || '',\r\n        special_care_instructions: editedData.specialCareInstructions || '',\r\n        vet_name: editedData.vetName || '',\r\n        vet_address: editedData.vetAddress || '',\r\n        vet_phone: editedData.vetPhone || '',\r\n        insurance_provider: editedData.insuranceProvider || '',\r\n        vet_documents: editedData.vetDocuments || [],\r\n      };\r\n      \r\n      debugLog(\"MBA5555\", \"SAVE PET - Pet data being sent:\", petData);\r\n      \r\n      const isNewPet = String(petId).startsWith('temp_');\r\n      debugLog(\"MBA5555\", \"SAVE PET - Is this a new pet?\", isNewPet);\r\n      \r\n      let successMessage = \"\";\r\n      \r\n      if (isNewPet) {\r\n        debugLog(\"MBA5555\", \"SAVE PET - Creating a new pet with backend API call\");\r\n        \r\n        try {\r\n          // Call the API to create the pet\r\n          const response = await addPet(petData);\r\n          debugLog(\"MBA5555\", \"SAVE PET - API response from addPet:\", response);\r\n          \r\n          // If we have a valid response with pet data\r\n          if (response && response.pet && response.pet.pet_id) {\r\n            // Extract the real pet ID from the backend response\r\n            const newPetId = response.pet.pet_id; \r\n            \r\n            // Update our pet data with the real ID and all data from the response\r\n            const updatedPetData = {\r\n              ...editedData, // Keep our local edited data\r\n              ...response.pet, // Add all the pet data from the response\r\n              id: newPetId, // Ensure the ID field is set properly\r\n              type: response.pet.species || editedData.type, // Map species to type for UI consistency\r\n              // Make sure UI-specific fields are properly mapped from backend data\r\n              feedingInstructions: response.pet.feeding_schedule || editedData.feedingInstructions,\r\n              medicalNotes: response.pet.medication_notes || editedData.medicalNotes,\r\n              pottyBreakSchedule: response.pet.potty_break_schedule || editedData.pottyBreakSchedule,\r\n              specialCareInstructions: response.pet.special_care_instructions || editedData.specialCareInstructions,\r\n              // Format birthday properly if it exists\r\n              birthday: response.pet.birthday ? formatDateFromBackend(response.pet.birthday) : editedData.birthday,\r\n              // Format adoption date properly if it exists\r\n              adoptionDate: response.pet.adoption_date ? formatDateFromBackend(response.pet.adoption_date) : editedData.adoptionDate,\r\n            };\r\n            \r\n            debugLog(\"MBA5555\", \"SAVE PET - Successfully created pet. Old ID:\", petId, \"New ID:\", newPetId);\r\n            \r\n            // *** CRITICAL FIX: Use replacePet instead of separate delete and add operations ***\r\n            replaceTempPetWithReal(petId, updatedPetData);\r\n            \r\n            // Set success message\r\n            successMessage = `Pet \"${updatedPetData.name}\" was successfully created!`;\r\n            \r\n            // Show success toast\r\n            toast({\r\n              message: successMessage,\r\n              type: 'success',\r\n              duration: 3000\r\n            });\r\n            \r\n            // Reset all editing state for this pet\r\n            setEditingPetIds(prev => {\r\n              const newSet = new Set(prev);\r\n              newSet.delete(petId);\r\n              return newSet;\r\n            });\r\n            \r\n            setEditedPetsData(prev => {\r\n              const newData = {...prev};\r\n              delete newData[petId];\r\n              return newData;\r\n            });\r\n            \r\n            // Update expanded state to show the real pet\r\n            setExpandedPetIds(prev => {\r\n              const newSet = new Set(prev);\r\n              newSet.delete(petId);\r\n              newSet.add(newPetId);\r\n              return newSet;\r\n            });\r\n          }\r\n        } catch (apiError) {\r\n          debugLog(\"MBA5555\", \"SAVE PET - API error adding pet:\", apiError);\r\n          setSavingPet(false); // Reset saving flag\r\n          \r\n          // Show error message with details from the API error\r\n          showErrorMessage(\"Failed to Create Pet\", apiError);\r\n          return; // Exit the function early to prevent further processing\r\n        }\r\n      } else {\r\n        debugLog(\"MBA5555\", \"SAVE PET - Updating existing pet:\", petId);\r\n        \r\n        try {\r\n          const response = await updatePet(petId, petData);\r\n          debugLog(\"MBA5555\", \"SAVE PET - API response from updatePet:\", response);\r\n          \r\n          // Update our local pet data with the response data\r\n          if (response) {\r\n            const updatedPetData = {\r\n              ...editedData,\r\n              ...response,\r\n              id: petId,\r\n              type: response.species || editedData.type,\r\n              feedingInstructions: response.feeding_schedule || editedData.feedingInstructions,\r\n              medicalNotes: response.medication_notes || editedData.medicalNotes,\r\n              pottyBreakSchedule: response.potty_break_schedule || editedData.pottyBreakSchedule,\r\n              specialCareInstructions: response.special_care_instructions || editedData.specialCareInstructions,\r\n              birthday: response.birthday ? formatDateFromBackend(response.birthday) : editedData.birthday,\r\n              adoptionDate: response.adoption_date ? formatDateFromBackend(response.adoption_date) : editedData.adoptionDate,\r\n            };\r\n            \r\n            // Update the pet in the parent component\r\n            onEditPet(petId, updatedPetData);\r\n            \r\n            // Set success message\r\n            successMessage = `Pet \"${updatedPetData.name}\" was successfully updated!`;\r\n            \r\n            // Show success toast\r\n            toast({\r\n              message: successMessage,\r\n              type: 'success',\r\n              duration: 3000\r\n            });\r\n            \r\n            // Reset editing state for this pet\r\n            setEditingPetIds(prev => {\r\n              const newSet = new Set(prev);\r\n              newSet.delete(petId);\r\n              return newSet;\r\n            });\r\n            \r\n            setEditedPetsData(prev => {\r\n              const newData = {...prev};\r\n              delete newData[petId];\r\n              return newData;\r\n            });\r\n            \r\n            debugLog(\"MBA5555\", \"SAVE PET - Successfully updated pet:\", petId);\r\n          }\r\n        } catch (apiError) {\r\n          debugLog(\"MBA5555\", \"SAVE PET - API error updating pet:\", apiError);\r\n          \r\n          // Show error message with details from the API error\r\n          showErrorMessage(\"Failed to Update Pet\", apiError);\r\n          setSavingPet(false); // Reset saving flag\r\n          return; // Exit early\r\n        }\r\n      }\r\n      \r\n      // Reset saving flag\r\n      setTimeout(() => {\r\n        setSavingPet(false);\r\n        debugLog(\"MBA5555\", \"SAVE PET - Final state after all operations:\", pets.map(p => ({id: p.id, name: p.name || 'unnamed'})));\r\n      }, 100);\r\n    } catch (error) {\r\n      debugLog(\"MBA5555\", \"SAVE PET - Unexpected error saving pet:\", error);\r\n      setSavingPet(false); // Reset saving flag even on error\r\n      \r\n      // Show generic error message for unexpected errors\r\n      showErrorMessage(\"Failed to Save Pet\", error);\r\n    }\r\n  };\r\n  \r\n  const handleCancelPetEdit = (petId) => {\r\n    // Check if this is a newly added pet (has a temp_ ID)\r\n    if (petId && petId.toString().startsWith('temp_')) {\r\n      // Delete the pet instead of just canceling edit mode\r\n      debugLog(\"MBA456\", \"Discarding newly added pet:\", petId);\r\n      onDeletePet(petId);\r\n    }\r\n    \r\n    // Remove this pet from editing state\r\n    setEditingPetIds(prev => {\r\n      const newSet = new Set(prev);\r\n      newSet.delete(petId);\r\n      return newSet;\r\n    });\r\n    \r\n    // Clean up the edited data for this pet\r\n    setEditedPetsData(prev => {\r\n      const newData = {...prev};\r\n      delete newData[petId];\r\n      return newData;\r\n    });\r\n  };\r\n  \r\n  const handleEditChange = (petId, field, value) => {\r\n    setEditedPetsData(prev => ({\r\n      ...prev,\r\n      [petId]: {\r\n        ...(prev[petId] || {}),\r\n        [field]: value\r\n      }\r\n    }));\r\n    debugLog(\"MBA456\", \"Editing pet field\", { petId, field, value });\r\n  };\r\n\r\n  const handleAddNewPet = () => {\r\n    \r\n    // Check for existing temporary pets first\r\n    const existingTempPets = pets.filter(pet => String(pet.id).startsWith('temp_'));\r\n    debugLog(\"MBA5555\", \"ADD PET - Existing temp pets:\", existingTempPets.map(p => p.id));\r\n    \r\n    // If we already have a temporary pet being edited, don't create a new one\r\n    if (existingTempPets.length > 0) {\r\n      debugLog(\"MBA5555\", \"ADD PET - Found existing temp pet, not creating a new one\");\r\n      // Just focus on the existing temp pet instead\r\n      const tempPet = existingTempPets[0];\r\n      \r\n      // Make sure it's in edit mode\r\n      setEditingPetIds(prev => {\r\n        const newSet = new Set(prev);\r\n        newSet.add(tempPet.id);\r\n        return newSet;\r\n      });\r\n      \r\n      // Make sure it's expanded\r\n      setExpandedPetIds(prev => {\r\n        const newSet = new Set(prev);\r\n        newSet.add(tempPet.id);\r\n        return newSet;\r\n      });\r\n      \r\n      return;\r\n    }\r\n    \r\n    // Create a temporary ID for the new pet\r\n    const tempId = `temp_${Date.now()}`;\r\n    debugLog(\"MBA5555\", \"ADD PET - Creating new pet with temp ID:\", tempId);\r\n    \r\n    // Create a blank pet entry\r\n    const newPet = {\r\n      id: tempId,\r\n      name: '',\r\n      breed: '',\r\n      birthday: '',\r\n      type: '',\r\n      feedingInstructions: '',\r\n      medicalNotes: '',\r\n      pottyBreakSchedule: '',\r\n      specialCareInstructions: '',\r\n      childrenFriendly: undefined,\r\n      dogFriendly: undefined,\r\n      catFriendly: undefined,\r\n      spayedNeutered: undefined,\r\n      houseTrained: undefined,\r\n      microchipped: undefined,\r\n      energyLevel: undefined,\r\n      canBeLeftAlone: undefined,\r\n      medications: '',\r\n      vetName: '',\r\n      vetAddress: '',\r\n      vetPhone: '',\r\n      insuranceProvider: '',\r\n      vetDocuments: [],\r\n      // New fields\r\n      sex: undefined,\r\n      weight: '',\r\n      adoptionDate: ''\r\n    };\r\n    \r\n    // First update our local state to show we're editing this pet\r\n    setEditingPetIds(prev => {\r\n      const newSet = new Set(prev);\r\n      newSet.add(tempId);\r\n      return newSet;\r\n    });\r\n    \r\n    setEditedPetsData(prev => ({\r\n      ...prev,\r\n      [tempId]: {...newPet}\r\n    }));\r\n    \r\n    // Expand the pet card\r\n    setExpandedPetIds(prev => {\r\n      const newSet = new Set(prev);\r\n      newSet.add(tempId);\r\n      return newSet;\r\n    });\r\n    \r\n    // Now add the new pet to the existing pets array via the parent component\r\n    // Adding at the top of the list instead of the bottom\r\n    debugLog(\"MBA5555\", \"ADD PET - Calling onAddPet with new pet (adding to top of list)\");\r\n    onAddPet({...newPet, _addToTop: true});\r\n    \r\n    // After everything is done, log the current state\r\n    setTimeout(() => {\r\n      debugLog(\"MBA5555\", \"ADD PET - Final state:\", pets.map(p => ({id: p.id, name: p.name || 'unnamed'})));\r\n    }, 100);\r\n  };\r\n\r\n  const handleUploadDocument = async (petId) => {\r\n    try {\r\n      debugLog(\"MBA456\", \"Document upload simulated\");\r\n      // Simulate a document being selected\r\n      const mockDocument = {\r\n        name: `Document_${new Date().getTime()}.pdf`,\r\n        size: 1024 * 1024 * 2, // 2MB\r\n        type: 'application/pdf'\r\n      };\r\n      \r\n      setEditedPetsData(prev => ({\r\n        ...prev,\r\n        [petId]: {\r\n          ...(prev[petId] || {}),\r\n          vetDocuments: [...(prev[petId]?.vetDocuments || []), mockDocument]\r\n        }\r\n      }));\r\n      \r\n      // Show a toast notification\r\n      toast({\r\n        message: \"Document added successfully. Full document upload feature coming soon.\",\r\n        type: 'info',\r\n        duration: 3000\r\n      });\r\n    } catch (error) {\r\n      debugLog(\"MBA456\", \"Error with document upload\", error);\r\n      \r\n      // Show error toast notification\r\n      toast({\r\n        message: \"Failed to add document\",\r\n        type: 'error',\r\n        duration: 3000\r\n      });\r\n    }\r\n  };\r\n\r\n  const renderVetDocuments = (documents = []) => {\r\n    if (documents.length === 0) {\r\n      return <Text style={styles.noDocumentsText}>No documents uploaded</Text>;\r\n    }\r\n    \r\n    return (\r\n      <View style={styles.documentsList}>\r\n        {documents.map((doc, index) => (\r\n          <View key={index} style={styles.documentItem}>\r\n            <MaterialCommunityIcons name=\"file-document-outline\" size={18} color={theme.colors.primary} />\r\n            <Text style={styles.documentName} numberOfLines={1} ellipsizeMode=\"middle\">\r\n              {doc.name}\r\n            </Text>\r\n            <TouchableOpacity style={styles.viewDocButton}>\r\n              <Text style={styles.viewDocText}>View</Text>\r\n            </TouchableOpacity>\r\n          </View>\r\n        ))}\r\n      </View>\r\n    );\r\n  };\r\n\r\n  const toggleSection = (petId, sectionName, event) => {\r\n    // A completely rewritten, bulletproof version of toggleSection\r\n    \r\n    try {\r\n      // First, stop event propagation if an event was provided\r\n      if (event && typeof event.stopPropagation === 'function') {\r\n        event.stopPropagation();\r\n      }\r\n      \r\n      // Validate inputs - only proceed if we have valid data\r\n      if (!petId) {\r\n        console.warn(\"Missing petId in toggleSection\");\r\n        return;\r\n      }\r\n      \r\n      if (!sectionName) {\r\n        console.warn(\"Missing sectionName in toggleSection\");\r\n        return;\r\n      }\r\n      \r\n      // Sanitize inputs to ensure they're simple strings\r\n      const petIdStr = String(petId);\r\n      const sectionNameStr = String(sectionName);\r\n      \r\n      // Create a consistent key format\r\n      const key = `${petIdStr}-${sectionNameStr}`;\r\n      \r\n      // Update state safely\r\n      setExpandedSections((prev) => {\r\n        // If prev is somehow not an object, start fresh\r\n        if (!prev || typeof prev !== 'object') {\r\n          const newState = {};\r\n          newState[key] = true;\r\n          return newState;\r\n        }\r\n        \r\n        // Create a clean copy of the previous state\r\n        const newState = { ...prev };\r\n        \r\n        // Toggle the value, defaulting to false if not boolean\r\n        const currentValue = newState[key] === true;\r\n        newState[key] = !currentValue;\r\n        \r\n        return newState;\r\n      });\r\n    } catch (err) {\r\n      // If anything goes wrong, log it but don't crash\r\n      console.error(\"Error toggling section:\", err.message || \"Unknown error\");\r\n    }\r\n  };\r\n\r\n  const isSectionExpanded = (petId, sectionName) => {\r\n    try {\r\n      // Safety checks for invalid inputs\r\n      if (!petId || !sectionName) {\r\n        return false;\r\n      }\r\n      \r\n      // Ensure petId is a string for consistent key format\r\n      const petIdStr = String(petId);\r\n      const key = `${petIdStr}-${sectionName}`;\r\n      \r\n      // Default to false (closed) for initial view or non-boolean values\r\n      const result = expandedSections[key] === true;\r\n      return result;\r\n    } catch (err) {\r\n      console.error(\"Error checking if section is expanded:\", err.message || \"Unknown error\");\r\n      return false; // Default to not expanded on error\r\n    }\r\n  };\r\n\r\n  const renderSectionHeader = (petId, title, sectionName) => {\r\n    try {\r\n      // Safety check for valid inputs\r\n      if (!petId || !sectionName) {\r\n        console.warn(\"Missing required parameters in renderSectionHeader\");\r\n        return null;\r\n      }\r\n      \r\n      // Ensure title has a valid string value\r\n      const safeTitle = typeof title === 'string' ? title : 'Section';\r\n      \r\n      const isExpanded = isSectionExpanded(petId, sectionName);\r\n      \r\n      return (\r\n        <TouchableOpacity \r\n          style={styles.sectionHeader}\r\n          onPress={(event) => toggleSection(petId, sectionName, event)}\r\n        >\r\n          <Text style={styles.detailTitle}>{safeTitle}</Text>\r\n          <MaterialCommunityIcons \r\n            name={isExpanded ? \"chevron-up\" : \"chevron-down\"} \r\n            size={20} \r\n            color={theme.colors.text}\r\n          />\r\n        </TouchableOpacity>\r\n      );\r\n    } catch (error) {\r\n      console.error(\"Error rendering section header:\", error.message || \"Unknown error\");\r\n      return null; // Return null on error to prevent crashes\r\n    }\r\n  };\r\n\r\n  const renderPetCard = (pet) => {\r\n    try {\r\n      // Safety check to ensure we have a valid pet object\r\n      if (!pet || typeof pet !== 'object' || !pet.id) {\r\n        console.warn(\"Invalid pet in renderPetCard\");\r\n        return null;\r\n      }\r\n      \r\n      const isExpanded = expandedPetIds.has(pet.id);\r\n      const isEditing = editingPetIds.has(pet.id);\r\n      const editedPetData = editedPetsData[pet.id] || pet;\r\n      const isSmallScreen = windowWidth < 500;\r\n      // Check if this is a pet that hasn't been saved to the database yet\r\n      const isNewPet = pet.id && String(pet.id).startsWith('temp_');\r\n      \r\n      // Safely extract text properties with defaults to prevent rendering objects\r\n      const petName = typeof pet.name === 'string' ? pet.name : '';\r\n      const petBreed = typeof pet.breed === 'string' ? pet.breed : '';\r\n      const petType = typeof pet.type === 'string' ? pet.type : '';\r\n      const petAgeString = pet.birthday ? calculateAge(pet.birthday) : 'No age set';\r\n      \r\n      return (\r\n        <View key={pet.id} style={styles.petCard}>\r\n          <TouchableOpacity \r\n            style={[\r\n              styles.petHeader,\r\n              { backgroundColor: theme.colors.surface }\r\n            ]} \r\n            onPress={(event) => {\r\n              // Important: only toggle details if not in edit mode\r\n              // This prevents any side effects during editing\r\n              if (!isEditing) {\r\n                debugLog(\"MBA5555\", \"PET HEADER - Toggle clicked for pet:\", pet.id);\r\n                togglePetDetails(pet.id);\r\n              } else {\r\n                debugLog(\"MBA5555\", \"PET HEADER - Ignoring click while in edit mode for pet:\", pet.id);\r\n                // Stop propagation to prevent triggering other events\r\n                event.stopPropagation();\r\n              }\r\n            }}\r\n            activeOpacity={0.2}\r\n          >\r\n            <View style={styles.petBasicInfo}>\r\n              {isEditing ? (\r\n                <View style={styles.editMainContainer}>\r\n                  <View style={styles.editHeaderRow}>\r\n                    <View style={styles.editProfileContainer}>\r\n                      <TouchableOpacity\r\n                        style={styles.profilePhotoButton}\r\n                        onPress={() => handleUploadDocument(pet.id)}\r\n                      >\r\n                        <Image \r\n                          source={require('../../../assets/default-pet-image.png')}\r\n                          style={styles.petPhoto}\r\n                        />\r\n                        <View style={styles.plusIconContainer}>\r\n                          <MaterialCommunityIcons name=\"plus-circle\" size={20} color={theme.colors.primary} />\r\n                        </View>\r\n                      </TouchableOpacity>\r\n                    </View>\r\n                    <View style={[\r\n                      styles.editActions,\r\n                      windowWidth < 600 && styles.editActionsSmallScreen\r\n                    ]}>\r\n                      {windowWidth < 600 ? (\r\n                        // Small screen layout: two rows of buttons\r\n                        <>\r\n                          <View style={styles.buttonRowTop}>\r\n                            {!isNewPet && (\r\n                              <TouchableOpacity \r\n                                style={styles.deleteButton}\r\n                                onPress={(event) => {\r\n                                  event.stopPropagation();\r\n                                  handleDeletePet(pet.id);\r\n                                }}\r\n                              >\r\n                                <MaterialCommunityIcons name=\"delete\" size={20} color={theme.colors.error} />\r\n                              </TouchableOpacity>\r\n                            )}\r\n                            <TouchableOpacity \r\n                              style={styles.saveButton}\r\n                              onPress={(event) => {\r\n                                // Prevent event propagation\r\n                                event.stopPropagation();\r\n                                // Prevent duplicates\r\n                                if (savingPet) {\r\n                                  debugLog(\"MBA5555\", \"Save button already clicked, ignoring\");\r\n                                  return;\r\n                                }\r\n                                debugLog(\"MBA5555\", \"SAVE BUTTON - Clicked for pet:\", pet.id);\r\n                                handleSavePetEdit(pet.id);\r\n                              }}\r\n                              disabled={savingPet}\r\n                            >\r\n                              <Text style={styles.saveButtonText}>\r\n                                {isNewPet ? 'Create Pet' : 'Save Pet'}\r\n                              </Text>\r\n                            </TouchableOpacity>\r\n                          </View>\r\n                          <View style={styles.buttonRowBottom}>\r\n                            <TouchableOpacity \r\n                              style={styles.editButton}\r\n                              onPress={(event) => {\r\n                                event.stopPropagation();\r\n                                handleCancelPetEdit(pet.id);\r\n                              }}\r\n                            >\r\n                              <MaterialCommunityIcons name=\"close\" size={20} color={theme.colors.error} />\r\n                            </TouchableOpacity>\r\n                            <TouchableOpacity \r\n                              style={styles.editButton}\r\n                              onPress={(event) => {\r\n                                event.stopPropagation();\r\n                                togglePetDetails(pet.id);\r\n                              }}\r\n                            >\r\n                              <MaterialCommunityIcons \r\n                                name={isExpanded ? \"chevron-up\" : \"chevron-down\"} \r\n                                size={24} \r\n                                color={theme.colors.text}\r\n                              />\r\n                            </TouchableOpacity>\r\n                          </View>\r\n                        </>\r\n                      ) : (\r\n                        // Large screen layout: single row\r\n                        <>\r\n                          <TouchableOpacity \r\n                            style={styles.saveButton}\r\n                            onPress={(event) => {\r\n                              // Prevent event propagation\r\n                              event.stopPropagation();\r\n                              // Prevent duplicates\r\n                              if (savingPet) {\r\n                                debugLog(\"MBA5555\", \"Save button already clicked, ignoring\");\r\n                                return;\r\n                              }\r\n                              debugLog(\"MBA5555\", \"SAVE BUTTON - Clicked for pet:\", pet.id);\r\n                              handleSavePetEdit(pet.id);\r\n                            }}\r\n                            disabled={savingPet}\r\n                          >\r\n                            <Text style={styles.saveButtonText}>\r\n                              {isNewPet ? 'Create Pet' : 'Save Pet'}\r\n                            </Text>\r\n                          </TouchableOpacity>\r\n                          {!isNewPet && (\r\n                            <TouchableOpacity \r\n                              style={styles.deleteButton}\r\n                              onPress={(event) => {\r\n                                event.stopPropagation();\r\n                                handleDeletePet(pet.id);\r\n                              }}\r\n                            >\r\n                              <MaterialCommunityIcons name=\"delete\" size={20} color={theme.colors.error} />\r\n                            </TouchableOpacity>\r\n                          )}\r\n                          <TouchableOpacity \r\n                            style={styles.editButton}\r\n                            onPress={(event) => {\r\n                              event.stopPropagation();\r\n                              handleCancelPetEdit(pet.id);\r\n                            }}\r\n                          >\r\n                            <MaterialCommunityIcons name=\"close\" size={20} color={theme.colors.error} />\r\n                          </TouchableOpacity>\r\n                          <TouchableOpacity \r\n                            style={styles.editButton}\r\n                            onPress={(event) => {\r\n                              event.stopPropagation();\r\n                              togglePetDetails(pet.id);\r\n                            }}\r\n                          >\r\n                            <MaterialCommunityIcons \r\n                              name={isExpanded ? \"chevron-up\" : \"chevron-down\"} \r\n                              size={24} \r\n                              color={theme.colors.text}\r\n                            />\r\n                          </TouchableOpacity>\r\n                        </>\r\n                      )}\r\n                    </View>\r\n                  </View>\r\n                  \r\n                  <View style={styles.editDetailsContainer}>\r\n                    <View style={styles.detailRow}>\r\n                      <View style={styles.detailColumn}>\r\n                        <Text style={styles.inputLabel}>Name</Text>\r\n                        <TextInput\r\n                          style={styles.editInput}\r\n                          value={editedPetData.name || ''}\r\n                          onChangeText={(text) => handleEditChange(pet.id, 'name', text)}\r\n                          placeholder=\"Enter pet name\"\r\n                          placeholderTextColor={theme.colors.placeholder}\r\n                        />\r\n                      </View>\r\n                      <View style={styles.detailColumn}>\r\n                        <Text style={styles.inputLabel}>Breed</Text>\r\n                        <TextInput\r\n                          style={styles.editInput}\r\n                          value={editedPetData.breed || ''}\r\n                          onChangeText={(text) => handleEditChange(pet.id, 'breed', text)}\r\n                          placeholder=\"Enter breed\"\r\n                          placeholderTextColor={theme.colors.placeholder}\r\n                        />\r\n                      </View>\r\n                    </View>\r\n                    \r\n                    {isSmallScreen ? (\r\n                      // Stack animal type and birthday vertically on small screens\r\n                      <View style={styles.stackedFields}>\r\n                        <View style={[styles.detailColumn, styles.fullWidth]}>\r\n                          <Text style={styles.inputLabel}>Animal Type</Text>\r\n                          <TextInput\r\n                            style={styles.editInput}\r\n                            value={editedPetData.type || ''}\r\n                            onChangeText={(text) => handleEditChange(pet.id, 'type', text)}\r\n                            placeholder=\"Enter type\"\r\n                            placeholderTextColor={theme.colors.placeholder}\r\n                          />\r\n                        </View>\r\n                        \r\n                        <View style={[styles.detailColumn, styles.fullWidth]}>\r\n                          <Text style={styles.inputLabel}>Birthday</Text>\r\n                          <View style={styles.customDatePickerContainer}>\r\n                            <TouchableOpacity \r\n                              activeOpacity={0.8}\r\n                              style={styles.dateInputBox}\r\n                              onPress={() => showDatePicker(pet.id, 'birthday')}\r\n                            >\r\n                              <Text style={[\r\n                                styles.dateInputText, \r\n                                !editedPetData.birthday && styles.placeholderText\r\n                              ]}>\r\n                                {editedPetData.birthday || 'MM-DD-YYYY'}\r\n                              </Text>\r\n                            </TouchableOpacity>\r\n                            <TouchableOpacity \r\n                              style={styles.calendarButton}\r\n                              onPress={() => showDatePicker(pet.id, 'birthday')}\r\n                              activeOpacity={0.7}\r\n                            >\r\n                              <MaterialCommunityIcons name=\"calendar\" size={20} color={theme.colors.primary} />\r\n                            </TouchableOpacity>\r\n                          </View>\r\n                        </View>\r\n                      </View>\r\n                    ) : (\r\n                      // Original horizontal layout for larger screens\r\n                      <View style={styles.detailRow}>\r\n                        <View style={styles.detailColumn}>\r\n                          <Text style={styles.inputLabel}>Birthday</Text>\r\n                          <View style={styles.customDatePickerContainer}>\r\n                            <TouchableOpacity \r\n                              activeOpacity={0.8}\r\n                              style={styles.dateInputBox}\r\n                              onPress={() => showDatePicker(pet.id, 'birthday')}\r\n                            >\r\n                              <Text style={[\r\n                                styles.dateInputText, \r\n                                !editedPetData.birthday && styles.placeholderText\r\n                              ]}>\r\n                                {editedPetData.birthday || 'MM-DD-YYYY'}\r\n                              </Text>\r\n                            </TouchableOpacity>\r\n                            <TouchableOpacity \r\n                              style={styles.calendarButton}\r\n                              onPress={() => showDatePicker(pet.id, 'birthday')}\r\n                              activeOpacity={0.7}\r\n                            >\r\n                              <MaterialCommunityIcons name=\"calendar\" size={20} color={theme.colors.primary} />\r\n                            </TouchableOpacity>\r\n                          </View>\r\n                        </View>\r\n                        <View style={styles.detailColumn}>\r\n                          <Text style={styles.inputLabel}>Animal Type</Text>\r\n                          <TextInput\r\n                            style={styles.editInput}\r\n                            value={editedPetData.type || ''}\r\n                            onChangeText={(text) => handleEditChange(pet.id, 'type', text)}\r\n                            placeholder=\"Enter type\"\r\n                            placeholderTextColor={theme.colors.placeholder}\r\n                          />\r\n                        </View>\r\n                      </View>\r\n                    )}\r\n                  </View>\r\n                </View>\r\n              ) : (\r\n                <>\r\n                  <Image \r\n                    source={require('../../../assets/default-pet-image.png')}\r\n                    style={styles.petPhoto}\r\n                  />\r\n                  <View style={[\r\n                    styles.petInfo,\r\n                    windowWidth < 600 && styles.petInfoWithButtonPadding\r\n                  ]}>\r\n                    <Text style={styles.petName}>{petName}</Text>\r\n                    <View style={styles.petDetailsContainer}>\r\n                      <Text style={styles.petDetails}>\r\n                        {petBreed ? petBreed : 'No breed'} • {petAgeString} • {petType ? petType : 'No type'}\r\n                      </Text>\r\n                    </View>\r\n                  </View>\r\n                </>\r\n              )}\r\n            </View>\r\n            {!isEditing && windowWidth < 600 ? (\r\n              <>\r\n                <TouchableOpacity\r\n                  style={[styles.editButton, styles.editButtonTopRight]}\r\n                  onPress={() => handleEditPet(pet.id)}\r\n                >\r\n                  <MaterialCommunityIcons name=\"pencil\" size={20} color={theme.colors.primary} />\r\n                </TouchableOpacity>\r\n                <TouchableOpacity\r\n                  style={[styles.editButton, styles.chevronButtonBottomRight]}\r\n                  onPress={() => togglePetDetails(pet.id)}\r\n                >\r\n                  <MaterialCommunityIcons\r\n                    name={isExpanded ? \"chevron-up\" : \"chevron-down\"}\r\n                    size={24}\r\n                    color={theme.colors.text}\r\n                  />\r\n                </TouchableOpacity>\r\n              </>\r\n            ) : !isEditing ? (\r\n              <View style={styles.petActions}>\r\n                <TouchableOpacity\r\n                  style={styles.editButton}\r\n                  onPress={() => handleEditPet(pet.id)}\r\n                >\r\n                  <MaterialCommunityIcons name=\"pencil\" size={20} color={theme.colors.primary} />\r\n                </TouchableOpacity>\r\n                <TouchableOpacity\r\n                  style={styles.editButton}\r\n                  onPress={() => togglePetDetails(pet.id)}\r\n                >\r\n                  <MaterialCommunityIcons\r\n                    name={isExpanded ? \"chevron-up\" : \"chevron-down\"}\r\n                    size={24}\r\n                    color={theme.colors.text}\r\n                  />\r\n                </TouchableOpacity>\r\n              </View>\r\n            ) : null}\r\n          </TouchableOpacity>\r\n\r\n          {isExpanded && (\r\n            <View style={[styles.expandedDetails, { backgroundColor: theme.colors.surfaceContrast }]}>\r\n              <View style={styles.detailRow}>\r\n                <View style={styles.detailColumn}>\r\n                  <Text style={styles.detailTitle}>Feeding Instructions</Text>\r\n                  {isEditing ? (\r\n                    <TextInput\r\n                      style={styles.editInput}\r\n                      value={editedPetData.feedingInstructions || ''}\r\n                      onChangeText={(text) => handleEditChange(pet.id, 'feedingInstructions', text)}\r\n                      placeholder=\"Enter feeding instructions\"\r\n                      placeholderTextColor={theme.colors.placeholder}\r\n                      multiline\r\n                    />\r\n                  ) : (\r\n                    <Text style={styles.detailText}>{pet.feedingInstructions || '2 cups of dry food twice daily (morning/evening)'}</Text>\r\n                  )}\r\n                </View>\r\n                <View style={styles.detailColumn}>\r\n                  <Text style={styles.detailTitle}>Medical Notes</Text>\r\n                  {isEditing ? (\r\n                    <TextInput\r\n                      style={styles.editInput}\r\n                      value={editedPetData.medicalNotes || ''}\r\n                      onChangeText={(text) => handleEditChange(pet.id, 'medicalNotes', text)}\r\n                      placeholder=\"Enter medical notes\"\r\n                      placeholderTextColor={theme.colors.placeholder}\r\n                      multiline\r\n                    />\r\n                  ) : (\r\n                    <Text style={styles.detailText}>{pet.medicalNotes || 'Hip dysplasia, daily joint supplement in AM meal'}</Text>\r\n                  )}\r\n                </View>\r\n              </View>\r\n              <View style={styles.detailRow}>\r\n                <View style={styles.detailColumn}>\r\n                  <Text style={styles.detailTitle}>Potty Break Schedule</Text>\r\n                  {isEditing ? (\r\n                    <TextInput\r\n                      style={styles.editInput}\r\n                      value={editedPetData.pottyBreakSchedule || ''}\r\n                      onChangeText={(text) => handleEditChange(pet.id, 'pottyBreakSchedule', text)}\r\n                      placeholder=\"Potty break schedule\"\r\n                      placeholderTextColor={theme.colors.placeholder}\r\n                      multiline\r\n                    />\r\n                  ) : (\r\n                    <Text style={styles.detailText}>{pet.pottyBreakSchedule || '15 minutes after each meal'}</Text>\r\n                  )}\r\n                </View>\r\n                <View style={styles.detailColumn}>\r\n                  <Text style={styles.detailTitle}>Special Care Instructions</Text>\r\n                  {isEditing ? (\r\n                    <TextInput\r\n                      style={styles.editInput}\r\n                      value={editedPetData.specialCareInstructions || ''}\r\n                      onChangeText={(text) => handleEditChange(pet.id, 'specialCareInstructions', text)}\r\n                      placeholder=\"Special care instructions\"\r\n                      placeholderTextColor={theme.colors.placeholder}\r\n                      multiline\r\n                    />\r\n                  ) : (\r\n                    <Text style={styles.detailText}>{pet.specialCareInstructions || 'Don\\'t touch his butt, he will eat your ass'}</Text>\r\n                  )}\r\n                </View>\r\n              </View>\r\n              \r\n              <View style={styles.detailSection}>\r\n                {renderSectionHeader(pet.id, \"Care Information\", \"careInfo\")}\r\n                \r\n                {isSectionExpanded(pet.id, \"careInfo\") && (\r\n                  <View style={styles.detailColumn}>\r\n                    <View style={styles.careInfoContainer}>\r\n                      <View style={styles.compatibilityItem}>\r\n                        <Text style={styles.compatibilityLabel}>Energy level:</Text>\r\n                        {isEditing ? (\r\n                          <View style={styles.dropdownContainerEdit}>\r\n                            {energyLevelOptions.map((option) => (\r\n                              <TouchableOpacity\r\n                                key={option}\r\n                                style={[\r\n                                  styles.optionButton,\r\n                                  (editedPetData.energyLevel === null && option === \"N/A\") || \r\n                                  editedPetData.energyLevel === option ? styles.selectedOption : null\r\n                                ]}\r\n                                onPress={() => handleEditChange(pet.id, 'energyLevel', option === \"N/A\" ? null : option)}\r\n                              >\r\n                                <Text style={[\r\n                                  styles.optionText,\r\n                                  (editedPetData.energyLevel === null && option === \"N/A\") || \r\n                                  editedPetData.energyLevel === option ? styles.selectedOptionText : null\r\n                                ]}>\r\n                                  {option}\r\n                                </Text>\r\n                              </TouchableOpacity>\r\n                            ))}\r\n                          </View>\r\n                        ) : (\r\n                          returnEnergyLevelContainer(pet)\r\n                        )}\r\n                      </View>\r\n                      \r\n                      {/* Removing duplicate \"Can be left alone\" section as it's already in the Compatibility & Training section */}\r\n                      \r\n                      <View style={styles.compatibilityItem}>\r\n                        <Text style={styles.compatibilityLabel}>Weight (lbs):</Text>\r\n                        {isEditing ? (\r\n                          <TextInput\r\n                            style={styles.editInputWeight}\r\n                            value={editedPetData.weight || ''}\r\n                            onChangeText={(text) => {\r\n                              // Only allow numbers and decimal point\r\n                              if (/^(\\d*\\.?\\d*)$/.test(text) || text === '') {\r\n                                handleEditChange(pet.id, 'weight', text);\r\n                              }\r\n                            }}\r\n                            placeholder=\"Enter weight\"\r\n                            placeholderTextColor={theme.colors.placeholder}\r\n                            keyboardType=\"numeric\"\r\n                          />\r\n                        ) : (\r\n                          <Text style={styles.vetInfoText}>{pet.weight || 'Not specified'}</Text>\r\n                        )}\r\n                      </View>\r\n                      <View style={styles.medicationsContainer}>\r\n                        <Text style={styles.compatibilityLabel}>Medications:</Text>\r\n                        {isEditing ? (\r\n                          <TextInput\r\n                            style={styles.editInputMedications}\r\n                            value={typeof editedPetData.medications === 'string' ? editedPetData.medications : ''}\r\n                            onChangeText={(text) => handleEditChange(pet.id, 'medications', text)}\r\n                            placeholder=\"Enter medications\"\r\n                            placeholderTextColor={theme.colors.placeholder}\r\n                            multiline\r\n                          />\r\n                        ) : (\r\n                          <Text style={styles.medicationsText}>\r\n                            {typeof pet.medications === 'string' ? pet.medications : \r\n                             (pet.medications === null ? 'None' : \r\n                              (typeof pet.medications === 'object' ? 'None' : String(pet.medications)))}\r\n                          </Text>\r\n                        )}\r\n                      </View>\r\n                    </View>\r\n                  </View>\r\n                )}\r\n              </View>\r\n              \r\n              <View style={styles.detailSection}>\r\n                {renderSectionHeader(pet.id, \"Compatibility & Training\", \"compatibility\")}\r\n                \r\n                {isSectionExpanded(pet.id, \"compatibility\") && (\r\n                  <View style={styles.detailColumn}>\r\n                    <View style={styles.compatibilityContainer}>\r\n                      <View style={styles.compatibilityItem}>\r\n                        <Text style={styles.compatibilityLabel}>Friendly with children:</Text>\r\n                        {isEditing ? (\r\n                          <View style={styles.dropdownContainerEdit}>\r\n                            {yesNoOptions.map((option) => (\r\n                              <TouchableOpacity\r\n                                key={option}\r\n                                style={[\r\n                                  styles.optionButton,\r\n                                  (editedPetData.childrenFriendly === null && option === \"N/A\") || \r\n                                  (editedPetData.childrenFriendly === true && option === \"Yes\") || \r\n                                  (editedPetData.childrenFriendly === false && option === \"No\") ||\r\n                                  editedPetData.childrenFriendly === option ? styles.selectedOption : null\r\n                                ]}\r\n                                onPress={() => handleEditChange(pet.id, 'childrenFriendly', option === \"N/A\" ? null : option)}\r\n                              >\r\n                                <Text style={[\r\n                                  styles.optionText,\r\n                                  (editedPetData.childrenFriendly === null && option === \"N/A\") || \r\n                                  (editedPetData.childrenFriendly === true && option === \"Yes\") || \r\n                                  (editedPetData.childrenFriendly === false && option === \"No\") ||\r\n                                  editedPetData.childrenFriendly === option ? styles.selectedOptionText : null\r\n                                ]}>\r\n                                  {option}\r\n                                </Text>\r\n                              </TouchableOpacity>\r\n                            ))}\r\n                          </View>\r\n                        ) : (\r\n                          returnYesNoContainer(pet, 'childrenFriendly')\r\n                        )}\r\n                      </View>\r\n                      <View style={styles.compatibilityItem}>\r\n                        <Text style={styles.compatibilityLabel}>Friendly with cats:</Text>\r\n                        {isEditing ? (\r\n                          <View style={styles.dropdownContainerEdit}>\r\n                            {yesNoOptions.map((option) => (\r\n                              <TouchableOpacity\r\n                                key={option}\r\n                                style={[\r\n                                  styles.optionButton,\r\n                                  (editedPetData.catFriendly === null && option === \"N/A\") || \r\n                                  (editedPetData.catFriendly === true && option === \"Yes\") || \r\n                                  (editedPetData.catFriendly === false && option === \"No\") ||\r\n                                  editedPetData.catFriendly === option ? styles.selectedOption : null\r\n                                ]}\r\n                                onPress={() => handleEditChange(pet.id, 'catFriendly', option === \"N/A\" ? null : option)}\r\n                              >\r\n                                <Text style={[\r\n                                  styles.optionText,\r\n                                  (editedPetData.catFriendly === null && option === \"N/A\") || \r\n                                  (editedPetData.catFriendly === true && option === \"Yes\") || \r\n                                  (editedPetData.catFriendly === false && option === \"No\") ||\r\n                                  editedPetData.catFriendly === option ? styles.selectedOptionText : null\r\n                                ]}>\r\n                                  {option}\r\n                                </Text>\r\n                              </TouchableOpacity>\r\n                            ))}\r\n                          </View>\r\n                        ) : (\r\n                          returnYesNoContainer(pet, 'catFriendly')\r\n                        )}\r\n                      </View>\r\n                      <View style={styles.compatibilityItem}>\r\n                        <Text style={styles.compatibilityLabel}>Friendly with dogs:</Text>\r\n                        {isEditing ? (\r\n                          <View style={styles.dropdownContainerEdit}>\r\n                            {yesNoOptions.map((option) => (\r\n                              <TouchableOpacity\r\n                                key={option}\r\n                                style={[\r\n                                  styles.optionButton,\r\n                                  (editedPetData.dogFriendly === null && option === \"N/A\") || \r\n                                  (editedPetData.dogFriendly === true && option === \"Yes\") || \r\n                                  (editedPetData.dogFriendly === false && option === \"No\") ||\r\n                                  editedPetData.dogFriendly === option ? styles.selectedOption : null\r\n                                ]}\r\n                                onPress={() => handleEditChange(pet.id, 'dogFriendly', option === \"N/A\" ? null : option)}\r\n                              >\r\n                                <Text style={[\r\n                                  styles.optionText,\r\n                                  (editedPetData.dogFriendly === null && option === \"N/A\") || \r\n                                  (editedPetData.dogFriendly === true && option === \"Yes\") || \r\n                                  (editedPetData.dogFriendly === false && option === \"No\") ||\r\n                                  editedPetData.dogFriendly === option ? styles.selectedOptionText : null\r\n                                ]}>\r\n                                  {option}\r\n                                </Text>\r\n                              </TouchableOpacity>\r\n                            ))}\r\n                          </View>\r\n                        ) : (\r\n                          returnYesNoContainer(pet, 'dogFriendly')\r\n                        )}\r\n                      </View>\r\n                      <View style={styles.compatibilityItem}>\r\n                        <Text style={styles.compatibilityLabel}>Spayed/neutered:</Text>\r\n                        {isEditing ? (\r\n                          <View style={styles.dropdownContainerEdit}>\r\n                            {yesNoOptions.map((option) => (\r\n                              <TouchableOpacity\r\n                                key={option}\r\n                                style={[\r\n                                  styles.optionButton,\r\n                                  (editedPetData.spayedNeutered === null && option === \"N/A\") || \r\n                                  (editedPetData.spayedNeutered === true && option === \"Yes\") || \r\n                                  (editedPetData.spayedNeutered === false && option === \"No\") ||\r\n                                  editedPetData.spayedNeutered === option ? styles.selectedOption : null\r\n                                ]}\r\n                                onPress={() => handleEditChange(pet.id, 'spayedNeutered', option === \"N/A\" ? null : option)}\r\n                              >\r\n                                <Text style={[\r\n                                  styles.optionText,\r\n                                  (editedPetData.spayedNeutered === null && option === \"N/A\") || \r\n                                  (editedPetData.spayedNeutered === true && option === \"Yes\") || \r\n                                  (editedPetData.spayedNeutered === false && option === \"No\") ||\r\n                                  editedPetData.spayedNeutered === option ? styles.selectedOptionText : null\r\n                                ]}>\r\n                                  {option}\r\n                                </Text>\r\n                              </TouchableOpacity>\r\n                            ))}\r\n                          </View>\r\n                        ) : (\r\n                          returnYesNoContainer(pet, 'spayedNeutered')\r\n                        )}\r\n                      </View>\r\n                      <View style={styles.compatibilityItem}>\r\n                        <Text style={styles.compatibilityLabel}>House trained:</Text>\r\n                        {isEditing ? (\r\n                          <View style={styles.dropdownContainerEdit}>\r\n                            {yesNoOptions.map((option) => (\r\n                              <TouchableOpacity\r\n                                key={option}\r\n                                style={[\r\n                                  styles.optionButton,\r\n                                  (editedPetData.houseTrained === null && option === \"N/A\") || \r\n                                  (editedPetData.houseTrained === true && option === \"Yes\") || \r\n                                  (editedPetData.houseTrained === false && option === \"No\") ||\r\n                                  editedPetData.houseTrained === option ? styles.selectedOption : null\r\n                                ]}\r\n                                onPress={() => handleEditChange(pet.id, 'houseTrained', option === \"N/A\" ? null : option)}\r\n                              >\r\n                                <Text style={[\r\n                                  styles.optionText,\r\n                                  (editedPetData.houseTrained === null && option === \"N/A\") || \r\n                                  (editedPetData.houseTrained === true && option === \"Yes\") || \r\n                                  (editedPetData.houseTrained === false && option === \"No\") ||\r\n                                  editedPetData.houseTrained === option ? styles.selectedOptionText : null\r\n                                ]}>\r\n                                  {option}\r\n                                </Text>\r\n                              </TouchableOpacity>\r\n                            ))}\r\n                          </View>\r\n                        ) : (\r\n                          returnYesNoContainer(pet, 'houseTrained')\r\n                        )}\r\n                      </View>\r\n                      <View style={styles.compatibilityItem}>\r\n                        <Text style={styles.compatibilityLabel}>Microchipped:</Text>\r\n                        {isEditing ? (\r\n                          <View style={styles.dropdownContainerEdit}>\r\n                            {yesNoOptions.map((option) => (\r\n                              <TouchableOpacity\r\n                                key={option}\r\n                                style={[\r\n                                  styles.optionButton,\r\n                                  (editedPetData.microchipped === null && option === \"N/A\") || \r\n                                  (editedPetData.microchipped === true && option === \"Yes\") || \r\n                                  (editedPetData.microchipped === false && option === \"No\") ||\r\n                                  editedPetData.microchipped === option ? styles.selectedOption : null\r\n                                ]}\r\n                                onPress={() => handleEditChange(pet.id, 'microchipped', option === \"N/A\" ? null : option)}\r\n                              >\r\n                                <Text style={[\r\n                                  styles.optionText,\r\n                                  (editedPetData.microchipped === null && option === \"N/A\") || \r\n                                  (editedPetData.microchipped === true && option === \"Yes\") || \r\n                                  (editedPetData.microchipped === false && option === \"No\") ||\r\n                                  editedPetData.microchipped === option ? styles.selectedOptionText : null\r\n                                ]}>\r\n                                  {option}\r\n                                </Text>\r\n                              </TouchableOpacity>\r\n                            ))}\r\n                          </View>\r\n                        ) : (\r\n                          returnYesNoContainer(pet, 'microchipped')\r\n                        )}\r\n                      </View>\r\n                      <View style={styles.compatibilityItem}>\r\n                        <Text style={styles.compatibilityLabel}>Can be left alone:</Text>\r\n                        {isEditing ? (\r\n                          <View style={styles.dropdownContainerEdit}>\r\n                            {yesNoOptions.map((option) => (\r\n                              <TouchableOpacity\r\n                                key={option}\r\n                                style={[\r\n                                  styles.optionButton,\r\n                                  (editedPetData.canBeLeftAlone === null && option === \"N/A\") || \r\n                                  (editedPetData.canBeLeftAlone === true && option === \"Yes\") || \r\n                                  (editedPetData.canBeLeftAlone === false && option === \"No\") ||\r\n                                  editedPetData.canBeLeftAlone === option ? styles.selectedOption : null\r\n                                ]}\r\n                                onPress={() => handleEditChange(pet.id, 'canBeLeftAlone', option === \"N/A\" ? null : option)}\r\n                              >\r\n                                <Text style={[\r\n                                  styles.optionText,\r\n                                  (editedPetData.canBeLeftAlone === null && option === \"N/A\") || \r\n                                  (editedPetData.canBeLeftAlone === true && option === \"Yes\") || \r\n                                  (editedPetData.canBeLeftAlone === false && option === \"No\") ||\r\n                                  editedPetData.canBeLeftAlone === option ? styles.selectedOptionText : null\r\n                                ]}>\r\n                                  {option}\r\n                                </Text>\r\n                              </TouchableOpacity>\r\n                            ))}\r\n                          </View>\r\n                        ) : (\r\n                          returnYesNoContainer(pet, 'canBeLeftAlone')\r\n                        )}\r\n                      </View>\r\n                    </View>\r\n                  </View>\r\n                )}\r\n              </View>\r\n              \r\n              <View style={styles.detailSection}>\r\n                {renderSectionHeader(pet.id, \"Vet Information\", \"vetInfo\")}\r\n                \r\n                {isSectionExpanded(pet.id, \"vetInfo\") && (\r\n                  <View style={styles.detailColumn}>\r\n                    <View style={styles.vetInfoContainer}>\r\n                      <View style={styles.vetInfoItem}>\r\n                        <Text style={styles.vetInfoLabel}>Vet name:</Text>\r\n                        {isEditing ? (\r\n                          <TextInput\r\n                            style={styles.editInputShort}\r\n                            value={editedPetData.vetName || ''}\r\n                            onChangeText={(text) => handleEditChange(pet.id, 'vetName', text)}\r\n                            placeholder=\"Enter vet name\"\r\n                            placeholderTextColor={theme.colors.placeholder}\r\n                          />\r\n                        ) : (\r\n                          <Text style={styles.vetInfoText}>{pet.vetName || 'None'}</Text>\r\n                        )}\r\n                      </View>\r\n                      <View style={styles.vetInfoItem}>\r\n                        <Text style={styles.vetInfoLabel}>Vet address:</Text>\r\n                        {isEditing ? (\r\n                          <TextInput\r\n                            style={styles.editInputShort}\r\n                            value={editedPetData.vetAddress || ''}\r\n                            onChangeText={(text) => handleEditChange(pet.id, 'vetAddress', text)}\r\n                            placeholder=\"Enter vet address\"\r\n                            placeholderTextColor={theme.colors.placeholder}\r\n                          />\r\n                        ) : (\r\n                          <Text style={styles.vetInfoText}>{pet.vetAddress || 'None'}</Text>\r\n                        )}\r\n                      </View>\r\n                      <View style={styles.vetInfoItem}>\r\n                        <Text style={styles.vetInfoLabel}>Vet phone:</Text>\r\n                        {isEditing ? (\r\n                          <TextInput\r\n                            style={styles.editInputShort}\r\n                            value={editedPetData.vetPhone || ''}\r\n                            onChangeText={(text) => handleEditChange(pet.id, 'vetPhone', text)}\r\n                            placeholder=\"Enter vet phone\"\r\n                            placeholderTextColor={theme.colors.placeholder}\r\n                            keyboardType=\"phone-pad\"\r\n                          />\r\n                        ) : (\r\n                          <Text style={styles.vetInfoText}>{pet.vetPhone || 'None'}</Text>\r\n                        )}\r\n                      </View>\r\n                      <View style={styles.vetInfoItem}>\r\n                        <Text style={styles.vetInfoLabel}>Insurance provider:</Text>\r\n                        {isEditing ? (\r\n                          <TextInput\r\n                            style={styles.editInputShort}\r\n                            value={editedPetData.insuranceProvider || ''}\r\n                            onChangeText={(text) => handleEditChange(pet.id, 'insuranceProvider', text)}\r\n                            placeholder=\"Enter insurance provider\"\r\n                            placeholderTextColor={theme.colors.placeholder}\r\n                          />\r\n                        ) : (\r\n                          <Text style={styles.vetInfoText}>{pet.insuranceProvider || 'Not specified'}</Text>\r\n                        )}\r\n                      </View>\r\n                      <View style={styles.vetInfoItem}>\r\n                        <Text style={styles.vetInfoLabel}>Sex:</Text>\r\n                        {isEditing ? (\r\n                          <View style={styles.dropdownContainerEdit}>\r\n                            {sexOptions.map((option) => (\r\n                              <TouchableOpacity\r\n                                key={option}\r\n                                style={[\r\n                                  styles.optionButton,\r\n                                  editedPetData.sex === option ? styles.selectedOption : null\r\n                                ]}\r\n                                onPress={() => handleEditChange(pet.id, 'sex', option)}\r\n                              >\r\n                                <Text style={[\r\n                                  styles.optionText,\r\n                                  editedPetData.sex === option ? styles.selectedOptionText : null\r\n                                ]}>\r\n                                  {option}\r\n                                </Text>\r\n                              </TouchableOpacity>\r\n                            ))}\r\n                          </View>\r\n                        ) : (\r\n                          <Text style={styles.vetInfoText}>{pet.sex || 'None Selected'}</Text>\r\n                        )}\r\n                      </View>\r\n                      <View style={styles.vetInfoItem}>\r\n                        <Text style={styles.vetInfoLabel}>Adoption Date:</Text>\r\n                        {isEditing ? (\r\n                          <View style={styles.customDatePickerContainer}>\r\n                            <TouchableOpacity \r\n                              activeOpacity={0.8}\r\n                              style={styles.dateInputBox}\r\n                              onPress={() => showDatePicker(pet.id, 'adoptionDate')}\r\n                            >\r\n                              <Text style={[\r\n                                styles.dateInputText, \r\n                                !editedPetData.adoptionDate && styles.placeholderText\r\n                              ]}>\r\n                                {editedPetData.adoptionDate || 'MM-DD-YYYY'}\r\n                              </Text>\r\n                            </TouchableOpacity>\r\n                            <TouchableOpacity \r\n                              style={styles.calendarButton}\r\n                              onPress={() => showDatePicker(pet.id, 'adoptionDate')}\r\n                              activeOpacity={0.7}\r\n                            >\r\n                              <MaterialCommunityIcons name=\"calendar\" size={20} color={theme.colors.primary} />\r\n                            </TouchableOpacity>\r\n                          </View>\r\n                        ) : (\r\n                          <Text style={styles.vetInfoText}>{pet.adoptionDate || 'Not specified'}</Text>\r\n                        )}\r\n                      </View>\r\n                      {/* TODO: add back after MVP <View style={styles.vetInfoItem}>\r\n                        <Text style={styles.vetInfoLabel}>Vet documents:</Text>\r\n                        {isEditing ? (\r\n                          <View style={styles.documentActionContainer}>\r\n                            <TouchableOpacity \r\n                              style={styles.uploadButton}\r\n                              onPress={() => handleUploadDocument(pet.id)}\r\n                            >\r\n                              <MaterialCommunityIcons name=\"upload\" size={16} color={theme.colors.background} />\r\n                              <Text style={styles.uploadButtonText}>Upload</Text>\r\n                            </TouchableOpacity>\r\n                            {renderVetDocuments(editedPetData.vetDocuments)}\r\n                          </View>\r\n                        ) : (\r\n                          <TouchableOpacity style={styles.documentButton}>\r\n                            <MaterialCommunityIcons name=\"file-document-outline\" size={16} color={theme.colors.primary} />\r\n                            <Text style={styles.documentButtonText}>View documents</Text>\r\n                          </TouchableOpacity>\r\n                        )}\r\n                      </View> */}\r\n                    </View>\r\n                  </View>\r\n                )}\r\n              </View>\r\n            </View>\r\n          )}\r\n        </View>\r\n      );\r\n    } catch (error) {\r\n      console.error(\"Error rendering pet card: \" + (error.message || \"Unknown error\"));\r\n      return null; // Return null on error to prevent crashes\r\n    }\r\n  };\r\n\r\n  const handleAddEmergencyContact = () => {\r\n    if (newEmergencyContact.name && newEmergencyContact.phone) {\r\n      debugLog(\"MBA123\", \"Adding emergency contact\", newEmergencyContact);\r\n      const updatedContacts = [...(preferences.emergencyContacts || []), newEmergencyContact];\r\n      onUpdatePreferences('emergencyContacts', updatedContacts);\r\n      setNewEmergencyContact({ name: '', phone: '' });\r\n      setIsAddingEmergencyContact(false);\r\n    }\r\n  };\r\n\r\n  const handleAddHouseholdMember = () => {\r\n    if (newHouseholdMember.name && newHouseholdMember.phone) {\r\n      debugLog(\"MBA123\", \"Adding household member\", newHouseholdMember);\r\n      const updatedMembers = [...(preferences.authorizedHouseholdMembers || []), newHouseholdMember];\r\n      onUpdatePreferences('authorizedHouseholdMembers', updatedMembers);\r\n      setNewHouseholdMember({ name: '', phone: '' });\r\n      setIsAddingHouseholdMember(false);\r\n    }\r\n  };\r\n\r\n  const handleRemoveEmergencyContact = (index) => {\r\n    debugLog(\"MBA123\", \"Removing emergency contact\", index);\r\n    const updatedContacts = [...(preferences.emergencyContacts || [])];\r\n    updatedContacts.splice(index, 1);\r\n    onUpdatePreferences('emergencyContacts', updatedContacts);\r\n  };\r\n\r\n  const handleRemoveHouseholdMember = (index) => {\r\n    debugLog(\"MBA123\", \"Removing household member\", index);\r\n    const updatedMembers = [...(preferences.authorizedHouseholdMembers || [])];\r\n    updatedMembers.splice(index, 1);\r\n    onUpdatePreferences('authorizedHouseholdMembers', updatedMembers);\r\n  };\r\n\r\n  const handleAddAsHouseholdMember = (contact) => {\r\n    debugLog(\"MBA123\", \"Adding emergency contact as household member\", contact);\r\n    const updatedMembers = [...(preferences.authorizedHouseholdMembers || [])];\r\n    \r\n    // Check if already exists\r\n    const exists = updatedMembers.some(member => \r\n      member.name === contact.name && member.phone === contact.phone\r\n    );\r\n    \r\n    if (!exists) {\r\n      updatedMembers.push(contact);\r\n      onUpdatePreferences('authorizedHouseholdMembers', updatedMembers);\r\n    }\r\n  };\r\n\r\n  const renderEmergencyContactsSection = () => {\r\n    if (userRole !== 'petOwner') return null;\r\n\r\n    return (\r\n      <View style={[styles.section, { backgroundColor: theme.colors.surfaceContrast }]}>\r\n        <View style={styles.sectionHeader}>\r\n          <Text style={styles.sectionTitle}>Emergency Contacts</Text>\r\n          <TouchableOpacity \r\n            style={styles.addButton}\r\n            onPress={() => setIsAddingEmergencyContact(!isAddingEmergencyContact)}\r\n          >\r\n            <MaterialCommunityIcons name=\"plus\" size={20} color={theme.colors.background} />\r\n            <Text style={styles.addButtonText}>Add Contact</Text>\r\n          </TouchableOpacity>\r\n        </View>\r\n        \r\n        {isAddingEmergencyContact && (\r\n          <View style={styles.addContactForm}>\r\n            <TextInput\r\n              style={styles.input}\r\n              placeholder=\"Contact Name\"\r\n              value={newEmergencyContact.name}\r\n              onChangeText={(text) => setNewEmergencyContact({...newEmergencyContact, name: text})}\r\n            />\r\n            <TextInput\r\n              style={styles.input}\r\n              placeholder=\"Phone Number\"\r\n              value={newEmergencyContact.phone}\r\n              onChangeText={(text) => setNewEmergencyContact({...newEmergencyContact, phone: text})}\r\n              keyboardType=\"phone-pad\"\r\n            />\r\n            <TouchableOpacity \r\n              style={styles.submitButton}\r\n              onPress={handleAddEmergencyContact}\r\n            >\r\n              <Text style={styles.submitButtonText}>Save Contact</Text>\r\n            </TouchableOpacity>\r\n          </View>\r\n        )}\r\n        \r\n        <View style={styles.contactsList}>\r\n          {(preferences.emergencyContacts || []).map((contact, index) => (\r\n            <View key={index} style={styles.contactCard}>\r\n              <View style={styles.contactInfo}>\r\n                <Text style={styles.contactName}>{contact.name}</Text>\r\n                <Text style={styles.contactPhone}>{contact.phone}</Text>\r\n              </View>\r\n              <View style={styles.contactActions}>\r\n                <TouchableOpacity \r\n                  style={styles.actionButton}\r\n                  onPress={() => handleAddAsHouseholdMember(contact)}\r\n                >\r\n                  <MaterialCommunityIcons name=\"account-plus\" size={20} color={theme.colors.primary} />\r\n                </TouchableOpacity>\r\n                <TouchableOpacity \r\n                  style={styles.actionButton}\r\n                  onPress={() => handleRemoveEmergencyContact(index)}\r\n                >\r\n                  <MaterialCommunityIcons name=\"delete\" size={20} color={theme.colors.error} />\r\n                </TouchableOpacity>\r\n              </View>\r\n            </View>\r\n          ))}\r\n          {(preferences.emergencyContacts || []).length === 0 && !isAddingEmergencyContact && (\r\n            <Text style={styles.emptyListText}>No emergency contacts added yet</Text>\r\n          )}\r\n        </View>\r\n      </View>\r\n    );\r\n  };\r\n\r\n  const renderHouseholdMembersSection = () => {\r\n    if (userRole !== 'petOwner') return null;\r\n\r\n    return (\r\n      <View style={[styles.section, { backgroundColor: theme.colors.surfaceContrast }]}>\r\n        <View style={styles.sectionHeader}>\r\n          <Text style={styles.sectionTitle}>Authorized Household Members</Text>\r\n          <TouchableOpacity \r\n            style={styles.addButton}\r\n            onPress={() => setIsAddingHouseholdMember(!isAddingHouseholdMember)}\r\n          >\r\n            <MaterialCommunityIcons name=\"plus\" size={20} color={theme.colors.background} />\r\n            <Text style={styles.addButtonText}>Add Member</Text>\r\n          </TouchableOpacity>\r\n        </View>\r\n        \r\n        {isAddingHouseholdMember && (\r\n          <View style={styles.addContactForm}>\r\n            <TextInput\r\n              style={styles.input}\r\n              placeholder=\"Member Name\"\r\n              value={newHouseholdMember.name}\r\n              onChangeText={(text) => setNewHouseholdMember({...newHouseholdMember, name: text})}\r\n            />\r\n            <TextInput\r\n              style={styles.input}\r\n              placeholder=\"Phone Number\"\r\n              value={newHouseholdMember.phone}\r\n              onChangeText={(text) => setNewHouseholdMember({...newHouseholdMember, phone: text})}\r\n              keyboardType=\"phone-pad\"\r\n            />\r\n            <TouchableOpacity \r\n              style={styles.submitButton}\r\n              onPress={handleAddHouseholdMember}\r\n            >\r\n              <Text style={styles.submitButtonText}>Save Member</Text>\r\n            </TouchableOpacity>\r\n          </View>\r\n        )}\r\n        \r\n        <View style={styles.contactsList}>\r\n          {(preferences.authorizedHouseholdMembers || []).map((member, index) => (\r\n            <View key={index} style={styles.contactCard}>\r\n              <View style={styles.contactInfo}>\r\n                <Text style={styles.contactName}>{member.name}</Text>\r\n                <Text style={styles.contactPhone}>{member.phone}</Text>\r\n              </View>\r\n              <View style={styles.contactActions}>\r\n                <TouchableOpacity \r\n                  style={styles.actionButton}\r\n                  onPress={() => handleRemoveHouseholdMember(index)}\r\n                >\r\n                  <MaterialCommunityIcons name=\"delete\" size={20} color={theme.colors.error} />\r\n                </TouchableOpacity>\r\n              </View>\r\n            </View>\r\n          ))}\r\n          {(preferences.authorizedHouseholdMembers || []).length === 0 && !isAddingHouseholdMember && (\r\n            <Text style={styles.emptyListText}>No household members added yet</Text>\r\n          )}\r\n        </View>\r\n      </View>\r\n    );\r\n  };\r\n\r\n  const formatDateString = (date) => {\r\n    if (!date) return '';\r\n    \r\n    const month = (date.getMonth() + 1).toString().padStart(2, '0');\r\n    const day = date.getDate().toString().padStart(2, '0');\r\n    const year = date.getFullYear();\r\n    \r\n    return `${month}-${day}-${year}`;\r\n  };\r\n\r\n  const parseDate = (dateString) => {\r\n    if (!dateString) return new Date();\r\n    \r\n    const [month, day, year] = dateString.split('-').map(part => parseInt(part, 10));\r\n    \r\n    if (!month || !day || !year || isNaN(month) || isNaN(day) || isNaN(year)) {\r\n      return new Date();\r\n    }\r\n    \r\n    return new Date(year, month - 1, day);\r\n  };\r\n\r\n  const showDatePicker = (petId, field) => {\r\n    const currentDate = parseDate(editedPetsData[petId]?.[field]);\r\n    \r\n    setDisplayMonth(currentDate.getMonth());\r\n    setDisplayYear(currentDate.getFullYear());\r\n    \r\n    setDatePickerConfig({\r\n      isVisible: true,\r\n      currentField: field,\r\n      currentPetId: petId,\r\n      selectedDate: currentDate\r\n    });\r\n  };\r\n\r\n  const handleDatePickerSelect = (event, date) => {\r\n    // On Android, this is called immediately when a date is selected\r\n    if (Platform.OS === 'android') {\r\n      if (event?.type === 'dismissed') {\r\n        setDatePickerConfig(prev => ({ ...prev, isVisible: false }));\r\n        return;\r\n      }\r\n      \r\n      if (date) {\r\n        const formattedDate = formatDateString(date);\r\n        handleEditChange(datePickerConfig.currentPetId, datePickerConfig.currentField, formattedDate);\r\n      }\r\n      \r\n      setDatePickerConfig(prev => ({ ...prev, isVisible: false }));\r\n      return;\r\n    }\r\n    \r\n    // For iOS and Web, this is called when the confirm button is pressed\r\n    if (date) {\r\n      const formattedDate = formatDateString(date);\r\n      handleEditChange(datePickerConfig.currentPetId, datePickerConfig.currentField, formattedDate);\r\n    }\r\n    \r\n    setDatePickerConfig({\r\n      isVisible: false,\r\n      currentField: null,\r\n      currentPetId: null,\r\n      selectedDate: null\r\n    });\r\n  };\r\n\r\n  // Generate calendar grid data\r\n  const calendarData = useMemo(() => {\r\n    if (!datePickerConfig.isVisible) return [];\r\n    \r\n    const currentDate = datePickerConfig.selectedDate || new Date();\r\n    const firstDayOfMonth = new Date(displayYear, displayMonth, 1);\r\n    const lastDayOfMonth = new Date(displayYear, displayMonth + 1, 0);\r\n    const daysInMonth = lastDayOfMonth.getDate();\r\n    const startingDayOfWeek = firstDayOfMonth.getDay(); // 0 = Sunday, 1 = Monday, etc.\r\n    \r\n    // Create calendar grid with padding for previous and next month days\r\n    const totalDays = Math.ceil((daysInMonth + startingDayOfWeek) / 7) * 7;\r\n    const calendarDays = [];\r\n    \r\n    let dayCounter = 1 - startingDayOfWeek;\r\n    for (let i = 0; i < totalDays; i++) {\r\n      const dayDate = new Date(displayYear, displayMonth, dayCounter);\r\n      const isCurrentMonth = dayDate.getMonth() === displayMonth;\r\n      const isSelectedDate = isCurrentMonth && \r\n        dayDate.getDate() === currentDate.getDate() && \r\n        dayDate.getMonth() === currentDate.getMonth() && \r\n        dayDate.getFullYear() === currentDate.getFullYear();\r\n      \r\n      calendarDays.push({\r\n        date: dayDate,\r\n        day: dayDate.getDate(),\r\n        isCurrentMonth,\r\n        isSelectedDate,\r\n      });\r\n      \r\n      dayCounter++;\r\n    }\r\n    \r\n    // Group by weeks\r\n    const weeks = [];\r\n    for (let i = 0; i < calendarDays.length; i += 7) {\r\n      weeks.push(calendarDays.slice(i, i + 7));\r\n    }\r\n    \r\n    return weeks;\r\n  }, [displayMonth, displayYear, datePickerConfig.selectedDate, datePickerConfig.isVisible]);\r\n  \r\n  // Navigation functions\r\n  const goToPreviousMonth = () => {\r\n    if (displayMonth === 0) {\r\n      setDisplayMonth(11);\r\n      setDisplayYear(prevYear => prevYear - 1);\r\n    } else {\r\n      setDisplayMonth(prevMonth => prevMonth - 1);\r\n    }\r\n    // Close any open dropdowns when navigating\r\n    setShowMonthPicker(false);\r\n    setShowYearPicker(false);\r\n  };\r\n  \r\n  const goToNextMonth = () => {\r\n    if (displayMonth === 11) {\r\n      setDisplayMonth(0);\r\n      setDisplayYear(prevYear => prevYear + 1);\r\n    } else {\r\n      setDisplayMonth(prevMonth => prevMonth + 1);\r\n    }\r\n    // Close any open dropdowns when navigating\r\n    setShowMonthPicker(false);\r\n    setShowYearPicker(false);\r\n  };\r\n  \r\n  const selectDate = (date) => {\r\n    // Close any open dropdowns when selecting a date\r\n    setShowMonthPicker(false);\r\n    setShowYearPicker(false);\r\n    // Just update the selected date without closing the modal\r\n    setDatePickerConfig(prev => ({\r\n      ...prev,\r\n      selectedDate: date\r\n    }));\r\n  };\r\n\r\n  const renderDatePickerModal = () => {\r\n    if (!datePickerConfig.isVisible) return null;\r\n    \r\n    // For Android, use the native date picker\r\n    if (Platform.OS === 'android') {\r\n      return (\r\n        <DateTimePicker\r\n          value={datePickerConfig.selectedDate}\r\n          mode=\"date\"\r\n          display=\"default\"\r\n          onChange={handleDatePickerSelect}\r\n        />\r\n      );\r\n    }\r\n    \r\n    // Month names for header\r\n    const monthNames = [\r\n      'January', 'February', 'March', 'April', 'May', 'June',\r\n      'July', 'August', 'September', 'October', 'November', 'December'\r\n    ];\r\n\r\n    // Generate years array - only current and previous years, with current year first\r\n    const currentYear = new Date().getFullYear();\r\n    const years = Array.from({ length: 101 }, (_, i) => currentYear - i);\r\n    \r\n    // Function to handle clicking outside dropdowns\r\n    const handleOutsideClick = () => {\r\n      setShowMonthPicker(false);\r\n      setShowYearPicker(false);\r\n    };\r\n    \r\n    return (\r\n      <Modal\r\n        visible={datePickerConfig.isVisible}\r\n        transparent={true}\r\n        animationType=\"fade\"\r\n        onRequestClose={() => {\r\n          setDatePickerConfig(prev => ({ ...prev, isVisible: false }));\r\n          setShowMonthPicker(false);\r\n          setShowYearPicker(false);\r\n        }}\r\n      >\r\n        <TouchableOpacity\r\n          style={styles.modalOverlay}\r\n          activeOpacity={1}\r\n          onPress={handleOutsideClick}\r\n        >\r\n          <View style={styles.calendarModalContent}>\r\n            <View style={styles.calendarModalHeader}>\r\n              <Text style={styles.calendarModalTitle}>\r\n                Select {datePickerConfig.currentField === 'birthday' ? 'Birthday' : 'Adoption Date'}\r\n              </Text>\r\n              <TouchableOpacity \r\n                onPress={() => {\r\n                  setDatePickerConfig(prev => ({ ...prev, isVisible: false }));\r\n                  setShowMonthPicker(false);\r\n                  setShowYearPicker(false);\r\n                }}\r\n                style={styles.closeButton}\r\n              >\r\n                <MaterialCommunityIcons name=\"close\" size={24} color={theme.colors.text} />\r\n              </TouchableOpacity>\r\n            </View>\r\n            \r\n            {/* Calendar Header with Dropdowns */}\r\n            <View style={styles.calendarHeader}>\r\n              <View style={styles.dropdownContainer}>\r\n                <TouchableOpacity \r\n                  style={styles.dropdownButton}\r\n                  onPress={(e) => {\r\n                    e.stopPropagation();\r\n                    setShowMonthPicker(!showMonthPicker);\r\n                    setShowYearPicker(false);\r\n                  }}\r\n                >\r\n                  <Text style={styles.dropdownButtonText}>{monthNames[displayMonth]}</Text>\r\n                  <MaterialCommunityIcons \r\n                    name={showMonthPicker ? \"chevron-up\" : \"chevron-down\"} \r\n                    size={20} \r\n                    color={theme.colors.text} \r\n                  />\r\n                </TouchableOpacity>\r\n                \r\n                <TouchableOpacity \r\n                  style={styles.dropdownButton}\r\n                  onPress={(e) => {\r\n                    e.stopPropagation();\r\n                    setShowYearPicker(!showYearPicker);\r\n                    setShowMonthPicker(false);\r\n                  }}\r\n                >\r\n                  <Text style={styles.dropdownButtonText}>{displayYear}</Text>\r\n                  <MaterialCommunityIcons \r\n                    name={showYearPicker ? \"chevron-up\" : \"chevron-down\"} \r\n                    size={20} \r\n                    color={theme.colors.text} \r\n                  />\r\n                </TouchableOpacity>\r\n              </View>\r\n            </View>\r\n\r\n            {/* Month Picker Dropdown */}\r\n            {showMonthPicker && (\r\n              <TouchableOpacity \r\n                style={styles.dropdownList}\r\n                activeOpacity={1}\r\n                onPress={(e) => e.stopPropagation()}\r\n              >\r\n                <ScrollView style={styles.dropdownScrollView}>\r\n                  {monthNames.map((month, index) => (\r\n                    <TouchableOpacity\r\n                      key={month}\r\n                      style={[\r\n                        styles.dropdownItem,\r\n                        displayMonth === index && styles.dropdownItemSelected\r\n                      ]}\r\n                      onPress={(e) => {\r\n                        e.stopPropagation();\r\n                        setDisplayMonth(index);\r\n                        setShowMonthPicker(false);\r\n                      }}\r\n                    >\r\n                      <Text style={[\r\n                        styles.dropdownItemText,\r\n                        displayMonth === index && styles.dropdownItemTextSelected\r\n                      ]}>\r\n                        {month}\r\n                      </Text>\r\n                    </TouchableOpacity>\r\n                  ))}\r\n                </ScrollView>\r\n              </TouchableOpacity>\r\n            )}\r\n\r\n            {/* Year Picker Dropdown */}\r\n            {showYearPicker && (\r\n              <TouchableOpacity \r\n                style={styles.dropdownList}\r\n                activeOpacity={1}\r\n                onPress={(e) => e.stopPropagation()}\r\n              >\r\n                <ScrollView style={styles.dropdownScrollView}>\r\n                  {years.map((year) => (\r\n                    <TouchableOpacity\r\n                      key={year}\r\n                      style={[\r\n                        styles.dropdownItem,\r\n                        displayYear === year && styles.dropdownItemSelected\r\n                      ]}\r\n                      onPress={(e) => {\r\n                        e.stopPropagation();\r\n                        setDisplayYear(year);\r\n                        setShowYearPicker(false);\r\n                      }}\r\n                    >\r\n                      <Text style={[\r\n                        styles.dropdownItemText,\r\n                        displayYear === year && styles.dropdownItemTextSelected\r\n                      ]}>\r\n                        {year}\r\n                      </Text>\r\n                    </TouchableOpacity>\r\n                  ))}\r\n                </ScrollView>\r\n              </TouchableOpacity>\r\n            )}\r\n            \r\n            {/* Weekday Headers */}\r\n            <TouchableOpacity \r\n              activeOpacity={1} \r\n              onPress={(e) => e.stopPropagation()}\r\n            >\r\n              <View style={styles.weekdayLabels}>\r\n                {['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'].map((day, index) => (\r\n                  <Text key={index} style={styles.weekdayLabel}>{day}</Text>\r\n                ))}\r\n              </View>\r\n            </TouchableOpacity>\r\n            \r\n            {/* Calendar Grid */}\r\n            <TouchableOpacity \r\n              activeOpacity={1} \r\n              onPress={(e) => e.stopPropagation()}\r\n            >\r\n              <View style={styles.calendarGrid}>\r\n                {calendarData.map((week, weekIndex) => (\r\n                  <View key={weekIndex} style={styles.calendarRow}>\r\n                    {week.map((dayObj, dayIndex) => (\r\n                      <TouchableOpacity\r\n                        key={dayIndex}\r\n                        style={[\r\n                          styles.calendarDay,\r\n                          !dayObj.isCurrentMonth && styles.calendarDayOtherMonth,\r\n                          dayObj.isSelectedDate && styles.calendarDaySelected\r\n                        ]}\r\n                        onPress={(e) => {\r\n                          e.stopPropagation();\r\n                          if (dayObj.isCurrentMonth) selectDate(dayObj.date);\r\n                        }}\r\n                        disabled={!dayObj.isCurrentMonth}\r\n                      >\r\n                        <Text style={[\r\n                          styles.calendarDayText,\r\n                          !dayObj.isCurrentMonth && styles.calendarDayTextOtherMonth,\r\n                          dayObj.isSelectedDate && styles.calendarDayTextSelected\r\n                        ]}>\r\n                          {dayObj.day}\r\n                        </Text>\r\n                      </TouchableOpacity>\r\n                    ))}\r\n                  </View>\r\n                ))}\r\n              </View>\r\n            </TouchableOpacity>\r\n            \r\n            <TouchableOpacity \r\n              style={styles.confirmButton}\r\n              onPress={(e) => {\r\n                e.stopPropagation();\r\n                handleDatePickerSelect(null, datePickerConfig.selectedDate);\r\n              }}\r\n            >\r\n              <Text style={styles.confirmButtonText}>Confirm</Text>\r\n            </TouchableOpacity>\r\n          </View>\r\n        </TouchableOpacity>\r\n      </Modal>\r\n    );\r\n  };\r\n\r\n  // Helper function to show error toasts with consistent formatting\r\n  const showErrorMessage = (title, error) => {\r\n    let errorMessage = \"There was a problem with this operation. Please try again.\";\r\n    \r\n    // Check if we have more specific error details from the API\r\n    if (error.response && error.response.data) {\r\n      const details = error.response.data.details;\r\n      if (details) {\r\n        // Build a more specific error message\r\n        errorMessage = \"Error details: \";\r\n        \r\n        Object.keys(details).forEach(field => {\r\n          errorMessage += `${field}: ${details[field].join(\", \")}`;\r\n        });\r\n      } else if (error.response.data.error) {\r\n        errorMessage = error.response.data.error;\r\n      }\r\n    } else if (error.message) {\r\n      errorMessage = error.message;\r\n    }\r\n    \r\n    toast({\r\n      message: `${title}: ${errorMessage}`,\r\n      type: 'error',\r\n      duration: 5000\r\n    });\r\n  };\r\n\r\n\r\n  // New helper function to replace a temporary pet with a real one in a single operation\r\n  const replaceTempPetWithReal = (tempPetId, realPetData) => {\r\n    try {\r\n      debugLog(\"MBA5555\", \"REPLACE PET - Replacing temp pet with real pet in parent state\");\r\n      \r\n      // Find the current pets array and create a new one with the temp pet replaced by the real one\r\n      const currentPetsArray = [...pets];\r\n      const tempPetIndex = currentPetsArray.findIndex(p => p.id === tempPetId);\r\n      \r\n      if (tempPetIndex !== -1) {\r\n        // Create a new array with the temp pet replaced by the real one\r\n        const updatedPets = [\r\n          ...currentPetsArray.slice(0, tempPetIndex),\r\n          realPetData,\r\n          ...currentPetsArray.slice(tempPetIndex + 1)\r\n        ];\r\n        \r\n        // Log the before and after state for debugging\r\n        debugLog(\"MBA5555\", \"REPLACE PET - Before replace:\", currentPetsArray.map(p => ({id: p.id, name: p.name || 'unnamed'})));\r\n        debugLog(\"MBA5555\", \"REPLACE PET - After replace:\", updatedPets.map(p => ({id: p.id, name: p.name || 'unnamed'})));\r\n        \r\n        // Update the parent's state with the new array\r\n        try {\r\n          debugLog(\"MBA5555\", \"REPLACE PET - Calling onReplacePet with new array\");\r\n          onReplacePet(updatedPets);\r\n          debugLog(\"MBA5555\", \"REPLACE PET - Atomic replacement completed\");\r\n        } catch (callbackError) {\r\n          debugLog(\"MBA5555\", \"REPLACE PET - Error in onReplacePet callback:\", callbackError);\r\n          // If the callback fails, try the fallback approach\r\n          try {\r\n            debugLog(\"MBA5555\", \"REPLACE PET - Trying fallback: delete + add\");\r\n            onDeletePet(tempPetId);\r\n            setTimeout(() => {\r\n              onAddPet(realPetData);\r\n            }, 50);\r\n          } catch (fallbackError) {\r\n            debugLog(\"MBA5555\", \"REPLACE PET - Even fallback failed:\", fallbackError);\r\n            // At this point, we've tried everything - just re-throw\r\n            throw fallbackError;\r\n          }\r\n        }\r\n      } else {\r\n        debugLog(\"MBA5555\", \"REPLACE PET - Temp pet not found in array of length \" + currentPetsArray.length);\r\n        debugLog(\"MBA5555\", \"REPLACE PET - Current pet IDs: \" + currentPetsArray.map(p => p.id).join(', '));\r\n        debugLog(\"MBA5555\", \"REPLACE PET - Temp pet ID we're looking for: \" + tempPetId);\r\n        debugLog(\"MBA5555\", \"REPLACE PET - Falling back to add\");\r\n        \r\n        try {\r\n          onAddPet(realPetData);\r\n        } catch (addError) {\r\n          debugLog(\"MBA5555\", \"REPLACE PET - Error in onAddPet fallback:\", addError);\r\n          throw addError;\r\n        }\r\n      }\r\n    } catch (error) {\r\n      debugLog(\"MBA5555\", \"REPLACE PET - Unexpected error during pet replacement:\", error);\r\n      // Re-throw the error so the caller can handle it\r\n      throw error;\r\n    }\r\n  };\r\n\r\n  return (\r\n    <ScrollView style={styles.container}>\r\n      {renderDatePickerModal()}\r\n      <ConfirmationModal\r\n        visible={deleteConfirmation.visible}\r\n        onClose={cancelDeletePet}\r\n        onConfirm={confirmDeletePet}\r\n        actionText={`delete ${deleteConfirmation.petName}`}\r\n        isLoading={deleteConfirmation.isDeleting}\r\n      />\r\n      <View style={[styles.section, { backgroundColor: theme.colors.surfaceContrast }]}>\r\n        <View style={styles.sectionHeader}>\r\n          <Text style={styles.sectionTitle}>My Pets</Text>\r\n          <TouchableOpacity \r\n            style={styles.addButton}\r\n            onPress={handleAddNewPet}\r\n          >\r\n            <MaterialCommunityIcons name=\"plus\" size={20} color={theme.colors.background} />\r\n            <Text style={styles.addButtonText}>Add Pet</Text>\r\n          </TouchableOpacity>\r\n        </View>\r\n        <View style={styles.petsList}>\r\n          {pets.map(renderPetCard)}\r\n        </View>\r\n      </View>\r\n\r\n      {/* TODO: uncomment this once we have implemented edit facilities */}\r\n      {/* <View style={[styles.section, { backgroundColor: theme.colors.surfaceContrast }]}>\r\n        <Text style={styles.sectionTitle}>\r\n          {userRole === 'professional' ? 'My Home & Environment Facilities' : 'Home & Environment Preferences'}\r\n        </Text>\r\n        <Text style={styles.sectionDescription}>\r\n          {userRole === 'professional' \r\n            ? 'Select the facilities available in your home for pet care'\r\n            : 'Select your preferences for pet care facilities'\r\n          }\r\n        </Text>\r\n        <View style={styles.preferencesGrid}>\r\n          {allFacilities.map((facility) => {\r\n            const isSelected = preferences.homeEnvironment.includes(facility.id);\r\n            return (\r\n              <TouchableOpacity\r\n                key={facility.id}\r\n                style={[\r\n                  styles.preferenceButton,\r\n                  isSelected && styles.selectedPreference\r\n                ]}\r\n                onPress={() => onUpdatePreferences('homeEnvironment', facility.id)}\r\n              >\r\n                <MaterialCommunityIcons \r\n                  name={facility.icon} \r\n                  size={20} \r\n                  color={theme.colors.primary}\r\n                />\r\n                <Text style={[\r\n                  styles.preferenceText,\r\n                  isSelected && styles.selectedPreferenceText\r\n                ]}>\r\n                  {facility.label}\r\n                </Text>\r\n                {isSelected && (\r\n                  <MaterialCommunityIcons \r\n                    name=\"check\" \r\n                    size={18} \r\n                    color={theme.colors.primary}\r\n                    style={styles.checkmark}\r\n                  />\r\n                )}\r\n              </TouchableOpacity>\r\n            );\r\n          })}\r\n        </View>\r\n      </View>\r\n\r\n      {renderEmergencyContactsSection()}\r\n      {renderHouseholdMembersSection()} */}\r\n    </ScrollView>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    gap: 24,\r\n  },\r\n  section: {\r\n    borderRadius: 12,\r\n    padding: 24,\r\n    marginBottom: 24,\r\n  },\r\n  sectionHeader: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    paddingVertical: 10,\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: theme.colors.border,\r\n    marginBottom: 12,\r\n  },\r\n  sectionTitle: {\r\n    fontSize: 18,\r\n    fontWeight: '600',\r\n    color: theme.colors.text,\r\n  },\r\n  sectionDescription: {\r\n    fontSize: 14,\r\n    color: theme.colors.secondary,\r\n    marginBottom: 16,\r\n  },\r\n  addButton: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    backgroundColor: theme.colors.primary,\r\n    paddingHorizontal: 8,\r\n    paddingVertical: 4,\r\n    borderRadius: 6,\r\n    gap: 8,\r\n  },\r\n  addButtonText: {\r\n    color: theme.colors.background,\r\n    fontSize: 14,\r\n    fontWeight: '500',\r\n  },\r\n  petsList: {\r\n    gap: 16,\r\n  },\r\n  petCard: {\r\n    borderRadius: 12,\r\n    overflow: 'hidden',\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n  },\r\n  petHeader: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    padding: 16,\r\n  },\r\n  petBasicInfo: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    gap: 16,\r\n    flex: 1,\r\n  },\r\n  petPhoto: {\r\n    width: 68,\r\n    height: 68,\r\n    borderRadius: 50,\r\n  },\r\n  petInfo: {\r\n    flex: 1,\r\n    marginLeft: 12,\r\n    justifyContent: 'center',\r\n  },\r\n  petName: {\r\n    fontSize: 16,\r\n    fontWeight: '600',\r\n    color: theme.colors.text,\r\n    marginBottom: 4,\r\n  },\r\n  petDetailsContainer: {\r\n    flexDirection: 'column',\r\n  },\r\n  petDetails: {\r\n    fontSize: 14,\r\n    color: theme.colors.secondary,\r\n    marginBottom: 2,\r\n  },\r\n  expandedDetails: {\r\n    borderTopWidth: 1,\r\n    borderTopColor: theme.colors.border,\r\n    padding: 16,\r\n  },\r\n  detailRow: {\r\n    flexDirection: 'row',\r\n    gap: 24,\r\n    marginBottom: 16,\r\n  },\r\n  detailColumn: {\r\n    flex: 1,\r\n  },\r\n  detailTitle: {\r\n    fontSize: 14,\r\n    fontWeight: '600',\r\n    color: theme.colors.text,\r\n    marginBottom: 8,\r\n  },\r\n  detailText: {\r\n    fontSize: 14,\r\n    color: theme.colors.secondary,\r\n  },\r\n  preferencesGrid: {\r\n    flexDirection: 'row',\r\n    flexWrap: 'wrap',\r\n    gap: 12,\r\n    marginTop: 16,\r\n  },\r\n  preferenceButton: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    gap: 8,\r\n    paddingVertical: 8,\r\n    paddingHorizontal: 12,\r\n    borderRadius: 6,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.primary,\r\n    backgroundColor: theme.colors.surface,\r\n  },\r\n  selectedPreference: {\r\n    borderColor: theme.colors.primary,\r\n    backgroundColor: `${theme.colors.primary}15`, // 15 is the hex opacity (about 8%)\r\n  },\r\n  preferenceText: {\r\n    fontSize: 14,\r\n    color: theme.colors.primary,\r\n    flex: 1,\r\n  },\r\n  selectedPreferenceText: {\r\n    color: theme.colors.primary,\r\n  },\r\n  checkmark: {\r\n    marginLeft: 'auto',\r\n  },\r\n  petActions: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    gap: 12,\r\n  },\r\n  editButton: {\r\n    padding: 4,\r\n  },\r\n  fixButton: {\r\n    padding: 4,\r\n    backgroundColor: `${theme.colors.warning}15`,\r\n    borderRadius: 4,\r\n    marginHorizontal: 4,\r\n  },\r\n  // New styles for emergency contacts and household members\r\n  addContactForm: {\r\n    marginBottom: 16,\r\n    gap: 12,\r\n  },\r\n  input: {\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    borderRadius: 6,\r\n    padding: 12,\r\n    fontSize: 14,\r\n    color: theme.colors.text,\r\n  },\r\n  submitButton: {\r\n    backgroundColor: theme.colors.primary,\r\n    padding: 12,\r\n    borderRadius: 6,\r\n    alignItems: 'center',\r\n  },\r\n  submitButtonText: {\r\n    color: theme.colors.background,\r\n    fontSize: 14,\r\n    fontWeight: '500',\r\n  },\r\n  contactsList: {\r\n    gap: 12,\r\n  },\r\n  contactCard: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    padding: 12,\r\n    borderRadius: 8,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    backgroundColor: theme.colors.surface,\r\n  },\r\n  contactInfo: {\r\n    flex: 1,\r\n  },\r\n  contactName: {\r\n    fontSize: 16,\r\n    fontWeight: '500',\r\n    color: theme.colors.text,\r\n  },\r\n  contactPhone: {\r\n    fontSize: 14,\r\n    color: theme.colors.secondary,\r\n  },\r\n  contactActions: {\r\n    flexDirection: 'row',\r\n    gap: 8,\r\n  },\r\n  actionButton: {\r\n    padding: 8,\r\n  },\r\n  emptyListText: {\r\n    fontSize: 14,\r\n    color: theme.colors.secondary,\r\n    fontStyle: 'italic',\r\n    textAlign: 'center',\r\n    padding: 12,\r\n  },\r\n  compatibilityContainer: {\r\n    flexDirection: 'column',\r\n    gap: 12,\r\n  },\r\n  compatibilityItem: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    justifyContent: 'space-between',\r\n    paddingVertical: 6,\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: theme.colors.border,\r\n    flexWrap: 'wrap',\r\n  },\r\n  compatibilityLabel: {\r\n    fontSize: 14,\r\n    color: theme.colors.text,\r\n    flex: 0.4,\r\n    marginRight: 10,\r\n  },\r\n  dropdownContainer: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    gap: 8,\r\n    minWidth: 60,\r\n    justifyContent: 'flex-end',\r\n  },\r\n  dropdownText: {\r\n    fontSize: 14,\r\n    color: theme.colors.secondary,\r\n  },\r\n  careInfoContainer: {\r\n    flexDirection: 'column',\r\n    gap: 12,\r\n  },\r\n  medicationsContainer: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    justifyContent: 'space-between',\r\n    paddingVertical: 6,\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: theme.colors.border,\r\n  },\r\n  medicationsText: {\r\n    fontSize: 14,\r\n    color: theme.colors.secondary,\r\n  },\r\n  vetInfoContainer: {\r\n    flexDirection: 'column',\r\n    gap: 12,\r\n  },\r\n  vetInfoItem: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    justifyContent: 'space-between',\r\n    paddingVertical: 6,\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: theme.colors.border,\r\n  },\r\n  vetInfoLabel: {\r\n    fontSize: 14,\r\n    color: theme.colors.text,\r\n  },\r\n  vetInfoText: {\r\n    fontSize: 14,\r\n    color: theme.colors.secondary,\r\n  },\r\n  documentButton: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    gap: 8,\r\n  },\r\n  documentButtonText: {\r\n    fontSize: 14,\r\n    color: theme.colors.primary,\r\n  },\r\n  dropdownContainerEdit: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    gap: 8,\r\n    minWidth: 60,\r\n    justifyContent: 'flex-end',\r\n    flexWrap: 'wrap'\r\n  },\r\n  optionButton: {\r\n    padding: 8,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    borderRadius: 6,\r\n    marginLeft: 10,\r\n    marginBottom: 5\r\n  },\r\n  selectedOption: {\r\n    borderColor: theme.colors.primary,\r\n    backgroundColor: `${theme.colors.primary}15`,\r\n  },\r\n  optionText: {\r\n    fontSize: 14,\r\n    color: theme.colors.text,\r\n  },\r\n  selectedOptionText: {\r\n    color: theme.colors.primary,\r\n  },\r\n  editInput: {\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    borderRadius: 6,\r\n    padding: 12,\r\n    fontSize: 14,\r\n    color: theme.colors.text,\r\n  },\r\n  editInputMedications: {\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    borderRadius: 6,\r\n    padding: 12,\r\n    fontSize: 14,\r\n    color: theme.colors.text,\r\n    flex: 1,\r\n    marginLeft: 10\r\n  },\r\n  editInputShort: {\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    borderRadius: 6,\r\n    padding: 12,\r\n    fontSize: 14,\r\n    color: theme.colors.text,\r\n    width: '55%',\r\n    marginLeft: 'auto'\r\n  },\r\n  editInputWeight: {\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    borderRadius: 6,\r\n    padding: 12,\r\n    fontSize: 14,\r\n    color: theme.colors.text,\r\n    width: '40%',\r\n    marginLeft: 'auto'\r\n  },\r\n  uploadButton: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    gap: 8,\r\n    backgroundColor: theme.colors.primary,\r\n    paddingHorizontal: 12,\r\n    paddingVertical: 8,\r\n    borderRadius: 6,\r\n  },\r\n  uploadButtonText: {\r\n    color: theme.colors.background,\r\n    fontSize: 14,\r\n    fontWeight: '500',\r\n  },\r\n  documentActionContainer: {\r\n    flexDirection: 'column',\r\n    gap: 8,\r\n  },\r\n  documentsList: {\r\n    marginTop: 8,\r\n  },\r\n  documentItem: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    gap: 8,\r\n    paddingVertical: 6,\r\n  },\r\n  documentName: {\r\n    fontSize: 14,\r\n    color: theme.colors.text,\r\n    flex: 1,\r\n  },\r\n  viewDocButton: {\r\n    paddingHorizontal: 8,\r\n    paddingVertical: 4,\r\n    borderRadius: 4,\r\n    backgroundColor: `${theme.colors.primary}15`,\r\n  },\r\n  viewDocText: {\r\n    fontSize: 12,\r\n    color: theme.colors.primary,\r\n  },\r\n  noDocumentsText: {\r\n    fontSize: 14,\r\n    color: theme.colors.secondary,\r\n    fontStyle: 'italic',\r\n    marginTop: 8,\r\n  },\r\n  detailSection: {\r\n    marginTop: 16,\r\n  },\r\n  editContainer: {\r\n    flexWrap: 'wrap',\r\n    gap: 16,\r\n    alignItems: 'flex-start',\r\n  },\r\n  inputsWrapper: {\r\n    flexDirection: 'row',\r\n    flexWrap: 'wrap',\r\n    gap: 16,\r\n    flex: 1,\r\n  },\r\n  inputWrapper: {\r\n    minWidth: 150,\r\n    flexBasis: '46%',\r\n    flexGrow: 1,\r\n    marginBottom: 8,\r\n  },\r\n  inputLabel: {\r\n    fontSize: 12,\r\n    color: theme.colors.secondary,\r\n    marginBottom: 4,\r\n  },\r\n  profilePhotoButton: {\r\n    position: 'relative',\r\n  },\r\n  plusIconContainer: {\r\n    position: 'absolute',\r\n    bottom: 0,\r\n    right: 0,\r\n    backgroundColor: theme.colors.background,\r\n    borderRadius: 10,\r\n  },\r\n  sectionRow: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    marginBottom: 16,\r\n  },\r\n  editMainContainer: {\r\n    width: '100%',\r\n    marginBottom: 16,\r\n  },\r\n  editHeaderRow: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    width: '100%',\r\n    marginBottom: 16,\r\n  },\r\n  editProfileContainer: {\r\n    marginBottom: 16,\r\n    alignItems: 'center',\r\n  },\r\n  editDetailsContainer: {\r\n    width: '100%',\r\n  },\r\n  editActions: {\r\n    flexDirection: 'row',\r\n    gap: 12,\r\n    alignItems: 'center',\r\n    flexWrap: 'wrap',\r\n  },\r\n  editActionsSmallScreen: {\r\n    flexDirection: 'column',\r\n    alignItems: 'stretch',\r\n    gap: 8,\r\n  },\r\n  buttonRowTop: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    marginBottom: 8,\r\n  },\r\n  buttonRowBottom: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'flex-end',\r\n    alignItems: 'center',\r\n    marginTop: 8,\r\n    gap: 4,\r\n  },\r\n  dateInfoContainer: {\r\n    flexDirection: 'column',\r\n    gap: 12,\r\n  },\r\n  dateInfoItem: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    justifyContent: 'space-between',\r\n    paddingVertical: 6,\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: theme.colors.border,\r\n  },\r\n  dateInfoLabel: {\r\n    fontSize: 14,\r\n    color: theme.colors.text,\r\n    flex: 1,\r\n  },\r\n  dateInfoText: {\r\n    fontSize: 14,\r\n    color: theme.colors.secondary,\r\n  },\r\n  customDatePickerContainer: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    borderRadius: 6,\r\n    overflow: 'hidden',\r\n    height: 46,\r\n  },\r\n  dateInputBox: {\r\n    flex: 1,\r\n    height: '100%',\r\n    justifyContent: 'center',\r\n    paddingHorizontal: 12,\r\n  },\r\n  dateInputText: {\r\n    fontSize: 14,\r\n    color: theme.colors.text,\r\n  },\r\n  placeholderText: {\r\n    color: theme.colors.placeholder,\r\n  },\r\n  calendarButton: {\r\n    width: 46,\r\n    height: '100%',\r\n    backgroundColor: theme.colors.surface,\r\n    borderLeftWidth: 1,\r\n    borderLeftColor: theme.colors.border,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n  },\r\n  datePickerContainer: {\r\n    flex: 1,\r\n    maxWidth: '60%',\r\n    marginLeft: 'auto',\r\n    marginRight: 10,\r\n  },\r\n  // Media query style for larger screens\r\n  '@media (min-width: 900px)': {\r\n    petDetailsContainer: {\r\n      flexDirection: 'row',\r\n      flexWrap: 'wrap',\r\n      gap: 8,\r\n    },\r\n    petDetails: {\r\n      marginRight: 8,\r\n    },\r\n  },\r\n  // Modal calendar styles\r\n  modalOverlay: {\r\n    flex: 1,\r\n    backgroundColor: 'rgba(0, 0, 0, 0.5)',\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n  },\r\n  calendarModalContent: {\r\n    backgroundColor: theme.colors.background,\r\n    borderRadius: 12,\r\n    padding: 20,\r\n    width: '90%',\r\n    maxWidth: 420,\r\n  },\r\n  calendarModalHeader: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    marginBottom: 20,\r\n  },\r\n  calendarModalTitle: {\r\n    fontSize: 20,\r\n    fontWeight: '600',\r\n    color: theme.colors.text,\r\n  },\r\n  closeButton: {\r\n    padding: 4,\r\n  },\r\n  calendarHeader: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    marginBottom: 16,\r\n  },\r\n  calendarNavButton: {\r\n    padding: 8,\r\n  },\r\n  calendarMonthYear: {\r\n    fontSize: 18,\r\n    fontWeight: '600',\r\n    color: theme.colors.text,\r\n  },\r\n  weekdayLabels: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-around',\r\n    marginBottom: 8,\r\n  },\r\n  weekdayLabel: {\r\n    flex: 1,\r\n    textAlign: 'center',\r\n    fontSize: 14,\r\n    fontWeight: '500',\r\n    color: theme.colors.secondary,\r\n    paddingVertical: 8,\r\n  },\r\n  calendarGrid: {\r\n    marginBottom: 16,\r\n  },\r\n  calendarRow: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-around',\r\n    marginBottom: 8,\r\n  },\r\n  calendarDay: {\r\n    flex: 1,\r\n    aspectRatio: 1,\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    borderRadius: 8,\r\n    margin: 2,\r\n  },\r\n  calendarDayText: {\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n  },\r\n  calendarDayOtherMonth: {\r\n    opacity: 0.3,\r\n  },\r\n  calendarDayTextOtherMonth: {\r\n    color: theme.colors.placeholder,\r\n  },\r\n  calendarDaySelected: {\r\n    backgroundColor: theme.colors.primary,\r\n  },\r\n  calendarDayTextSelected: {\r\n    color: theme.colors.background,\r\n    fontWeight: '600',\r\n  },\r\n  confirmButton: {\r\n    backgroundColor: theme.colors.primary,\r\n    borderRadius: 8,\r\n    padding: 14,\r\n    alignItems: 'center',\r\n    marginTop: 8,\r\n  },\r\n  confirmButtonText: {\r\n    color: theme.colors.background,\r\n    fontSize: 16,\r\n    fontWeight: '600',\r\n  },\r\n  stackedFields: {\r\n    flexDirection: 'column',\r\n    gap: 16,\r\n    marginBottom: 16,\r\n  },\r\n  fullWidth: {\r\n    width: '100%',\r\n  },\r\n  saveButton: {\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.primary,\r\n    borderRadius: 6,\r\n    paddingHorizontal: 12,\r\n    paddingVertical: 8,\r\n    backgroundColor: theme.colors.primary,\r\n    marginRight: 8,\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n  },\r\n  saveButtonText: {\r\n    color: 'white',\r\n    fontSize: 14,\r\n    fontWeight: '500',\r\n  },\r\n  deleteButton: {\r\n    padding: 8,\r\n    marginRight: 4,\r\n    borderRadius: 6,\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n  },\r\n  // Error modal styles\r\n  errorModalContent: {\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 12,\r\n    padding: 24,\r\n    width: '90%',\r\n    maxWidth: 500,\r\n  },\r\n  successModalContent: {\r\n    borderLeftWidth: 4,\r\n    borderLeftColor: theme.colors.success,\r\n  },\r\n  errorModalHeader: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    marginBottom: 16,\r\n  },\r\n  successModalHeader: {\r\n    // Same styles, but we might want to customize in the future\r\n  },\r\n  errorModalTitle: {\r\n    fontSize: 18,\r\n    fontWeight: 'bold',\r\n    color: theme.colors.error,\r\n  },\r\n  successModalTitle: {\r\n    color: theme.colors.success,\r\n  },\r\n  errorModalMessage: {\r\n    marginBottom: 24,\r\n    fontSize: 16,\r\n    lineHeight: 24,\r\n  },\r\n  successModalMessage: {\r\n    // Same styles, but we might want to customize in the future\r\n  },\r\n  errorModalButton: {\r\n    backgroundColor: theme.colors.primary,\r\n    padding: 12,\r\n    borderRadius: 8,\r\n    alignItems: 'center',\r\n  },\r\n  successModalButton: {\r\n    backgroundColor: theme.colors.success,\r\n  },\r\n  errorModalButtonText: {\r\n    color: theme.colors.surface,\r\n    fontWeight: 'bold',\r\n  },\r\n  successModalButtonText: {\r\n    // Same styles, but we might want to customize in the future\r\n  },\r\n  editButtonTopRight: {\r\n    position: 'absolute',\r\n    top: 12,\r\n    right: 12,\r\n    zIndex: 2,\r\n  },\r\n  chevronButtonBottomRight: {\r\n    position: 'absolute',\r\n    bottom: 12,\r\n    right: 12,\r\n    zIndex: 2,\r\n  },\r\n  petInfoWithButtonPadding: {\r\n    paddingRight: 20, // enough space for both buttons\r\n  },\r\n  dropdownContainer: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    gap: 12,\r\n    marginBottom: 16,\r\n  },\r\n  dropdownButton: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    backgroundColor: theme.colors.surface,\r\n    paddingHorizontal: 12,\r\n    paddingVertical: 8,\r\n    borderRadius: 6,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    minWidth: 120,\r\n  },\r\n  dropdownButtonText: {\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n    marginRight: 8,\r\n  },\r\n  dropdownList: {\r\n    position: 'absolute',\r\n    top: 100,\r\n    left: 20,\r\n    right: 20,\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 8,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    zIndex: 1000,\r\n    maxHeight: 200,\r\n    elevation: 5,\r\n    shadowColor: '#000',\r\n    shadowOffset: { width: 0, height: 2 },\r\n    shadowOpacity: 0.25,\r\n    shadowRadius: 3.84,\r\n  },\r\n  dropdownScrollView: {\r\n    maxHeight: 200,\r\n  },\r\n  dropdownItem: {\r\n    paddingVertical: 12,\r\n    paddingHorizontal: 16,\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: theme.colors.border,\r\n  },\r\n  dropdownItemSelected: {\r\n    backgroundColor: theme.colors.primary + '20',\r\n  },\r\n  dropdownItemText: {\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n  },\r\n  dropdownItemTextSelected: {\r\n    color: theme.colors.primary,\r\n    fontWeight: '600',\r\n  },\r\n});\r\n\r\nexport default PetsPreferencesTab; ","import React, { useState, useEffect } from 'react';\r\nimport { View, Text, StyleSheet, TouchableOpacity, Switch, ScrollView, Modal, FlatList } from 'react-native';\r\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\r\nimport { theme } from '../../styles/theme';\r\nimport { getTimeSettings, updateTimeSettings } from '../../api/API';\r\nimport { debugLog } from '../../context/AuthContext';\r\nimport { useToast } from '../../components/ToastProvider';\r\n\r\nconst SubscriptionPlan = ({ plan, isPopular, isCurrent, onSwitch }) => (\r\n  <View style={[\r\n    styles.planCard,\r\n    isCurrent && styles.currentPlanBorder\r\n  ]}>\r\n    {isPopular && (\r\n      <View style={styles.popularTag}>\r\n        <Text style={styles.popularTagText}>Popular</Text>\r\n      </View>\r\n    )}\r\n    <Text style={styles.planTitle}>{plan.title}</Text>\r\n    <Text style={styles.planPrice}>{plan.price}</Text>\r\n    <Text style={styles.planDescription}>{plan.description}</Text>\r\n    <View style={styles.featuresList}>\r\n      {plan.features.map((feature, index) => (\r\n        <View key={index} style={styles.featureItem}>\r\n          <MaterialCommunityIcons name=\"check\" size={20} color={theme.colors.primary} />\r\n          <Text style={styles.featureText}>{feature}</Text>\r\n        </View>\r\n      ))}\r\n    </View>\r\n    <TouchableOpacity\r\n      style={[styles.planButton, isCurrent && styles.currentPlanButton]}\r\n      onPress={() => !isCurrent && onSwitch(plan.id)}\r\n    >\r\n      <Text style={[styles.planButtonText, isCurrent && styles.currentPlanButtonText]}>\r\n        {isCurrent ? 'Current Plan' : 'Switch Plan'}\r\n      </Text>\r\n    </TouchableOpacity>\r\n  </View>\r\n);\r\n\r\nconst SettingsPaymentsTab = ({\r\n  push_notifications,\r\n  email_updates,\r\n  marketing_communications,\r\n  profile_visibility,\r\n  timezone: propTimezone,\r\n  use_military_time,\r\n  onUpdateSetting,\r\n  paymentMethods,\r\n  onAddPaymentMethod,\r\n  onRemovePaymentMethod,\r\n  onSetDefaultPayment,\r\n  isMobile,\r\n  currentPlan = { \r\n    id: 'waitlist',\r\n    title: 'Waitlist Signup',\r\n    nextBilling: 'N/A',\r\n    connections: { used: 0, total: 'Unlimited' }\r\n  },\r\n  onSwitchPlan,\r\n  userRole,\r\n  isApprovedProfessional,\r\n  navigation,\r\n}) => {\r\n  const [timezone, setTimezone] = useState(propTimezone || 'UTC');\r\n  const [timezoneModalVisible, setTimezoneModalVisible] = useState(false);\r\n  const [timezones, setTimezones] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const showToast = useToast();\r\n\r\n  useEffect(() => {\r\n    // Fetch user's time settings when component mounts\r\n    const fetchTimeSettings = async () => {\r\n      try {\r\n        setLoading(true);\r\n        const timeSettings = await getTimeSettings();\r\n        setTimezone(timeSettings.timezone);\r\n        debugLog('MBA12345 Fetched time settings:', timeSettings);\r\n      } catch (error) {\r\n        debugLog('MBA12345 Error fetching time settings:', error);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    // Check if timezone is in the props already\r\n    if (propTimezone) {\r\n      setTimezone(propTimezone);\r\n    } else {\r\n      fetchTimeSettings();\r\n    }\r\n  }, [propTimezone]);\r\n\r\n  useEffect(() => {\r\n    debugLog('MBA54321 SettingsPaymentsTab received paymentMethods:', paymentMethods);\r\n  }, [paymentMethods]);\r\n\r\n  const handleTimezoneChange = async (newTimezone) => {\r\n    try {\r\n      setLoading(true);\r\n      await updateTimeSettings(newTimezone);\r\n      setTimezone(newTimezone);\r\n      setTimezoneModalVisible(false);\r\n      debugLog('MBA12345 Updated timezone to:', newTimezone);\r\n      showToast({\r\n        message: 'Timezone updated successfully',\r\n        type: 'success',\r\n        duration: 3000\r\n      });\r\n    } catch (error) {\r\n      debugLog('MBA12345 Error updating timezone:', error);\r\n      showToast({\r\n        message: 'Failed to update timezone. Please try again.',\r\n        type: 'error',\r\n        duration: 4000\r\n      });\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const openTimezoneModal = () => {\r\n    // Use the same timezone list as in TimezoneSettings.js\r\n    const COMMON_TIMEZONES = [\r\n      'America/New_York',\r\n      'America/Chicago',\r\n      'America/Denver',\r\n      'America/Los_Angeles',\r\n      'America/Anchorage',\r\n      'America/Adak',\r\n      'Pacific/Honolulu',\r\n      'America/Phoenix',\r\n      'America/Boise',\r\n      'America/Detroit',\r\n      'America/Indiana/Indianapolis',\r\n      'America/Indiana/Knox',\r\n      'America/Indiana/Marengo',\r\n      'America/Indiana/Petersburg',\r\n      'America/Indiana/Tell_City',\r\n      'America/Indiana/Vevay',\r\n      'America/Indiana/Vincennes',\r\n      'America/Indiana/Winamac',\r\n      'America/Kentucky/Louisville',\r\n      'America/Kentucky/Monticello',\r\n      'America/Menominee',\r\n      'America/North_Dakota/Beulah',\r\n      'America/North_Dakota/Center',\r\n      'America/North_Dakota/New_Salem',\r\n      'America/Sitka',\r\n      'America/Yakutat',\r\n      'Europe/London',\r\n      'Europe/Paris',\r\n      'Europe/Berlin',\r\n      'Europe/Moscow',\r\n      'Asia/Tokyo',\r\n      'Asia/Shanghai',\r\n      'Asia/Dubai',\r\n      'Australia/Sydney',\r\n      'Pacific/Auckland',\r\n      'UTC'\r\n    ];\r\n    \r\n    setTimezones(COMMON_TIMEZONES);\r\n    setTimezoneModalVisible(true);\r\n  };\r\n\r\n  const renderTimezoneModal = () => (\r\n    <Modal\r\n      animationType=\"slide\"\r\n      transparent={true}\r\n      visible={timezoneModalVisible}\r\n      onRequestClose={() => setTimezoneModalVisible(false)}\r\n    >\r\n      <View style={styles.modalOverlay}>\r\n        <View style={styles.modalContent}>\r\n          <View style={styles.modalHeader}>\r\n            <Text style={styles.modalTitle}>Select Timezone</Text>\r\n            <TouchableOpacity onPress={() => setTimezoneModalVisible(false)}>\r\n              <MaterialCommunityIcons name=\"close\" size={24} color={theme.colors.text} />\r\n            </TouchableOpacity>\r\n          </View>\r\n          \r\n          <FlatList\r\n            data={timezones}\r\n            keyExtractor={(item) => item}\r\n            renderItem={({ item }) => (\r\n              <TouchableOpacity\r\n                style={[\r\n                  styles.timezoneItem,\r\n                  item === timezone && styles.selectedTimezoneItem\r\n                ]}\r\n                onPress={() => handleTimezoneChange(item)}\r\n              >\r\n                <Text style={[\r\n                  styles.timezoneText,\r\n                  item === timezone && styles.selectedTimezoneText\r\n                ]}>\r\n                  {item}\r\n                </Text>\r\n                {item === timezone && (\r\n                  <MaterialCommunityIcons name=\"check\" size={20} color={theme.colors.primary} />\r\n                )}\r\n              </TouchableOpacity>\r\n            )}\r\n            initialNumToRender={20}\r\n            maxToRenderPerBatch={20}\r\n            windowSize={10}\r\n          />\r\n        </View>\r\n      </View>\r\n    </Modal>\r\n  );\r\n\r\n  const getSubscriptionPlans = () => {\r\n    const commonPlans = [\r\n      {\r\n        id: 'free',\r\n        title: 'Free Tier',\r\n        price: 'Free',\r\n        description: '1 Free Booking/Month, then 15% per booking',\r\n        features: ['Basic profile listing', 'Up to 1 booking/month', 'Standard support'],\r\n        isPopular: false,\r\n      },\r\n      {\r\n        id: 'waitlist',\r\n        title: 'Waitlist Tier',\r\n        price: 'Free',\r\n        description: 'No commissions, no subscriptions, no fees',\r\n        features: ['Early signup discounts', 'Waitlist for early access', 'Unlimited connections', 'Priority support',],\r\n        isPopular: false,\r\n      }\r\n    ];\r\n\r\n    if (userRole === 'professional') {\r\n      return [\r\n        ...commonPlans,\r\n        {\r\n          id: 'subscription',\r\n          title: 'Pro Subscription',\r\n          price: '$29.99/month',\r\n          description: 'No fees as pro',\r\n          features: ['Unlimited connections', 'Priority support', 'Advanced analytics', 'No commission fees'],\r\n          isPopular: true,\r\n        },\r\n        {\r\n          id: 'dual_subscription',\r\n          title: 'Dual Role Subscription',\r\n          price: '$39.99/month',\r\n          description: 'No fees as pro or owner',\r\n          features: ['Unlimited connections', 'Priority support', 'Advanced analytics', 'No commission fees', 'Use as both pro and owner'],\r\n          isPopular: false,\r\n        }\r\n      ];\r\n    } else {\r\n      return [\r\n        ...commonPlans,\r\n        {\r\n          id: 'subscription',\r\n          title: 'Owner Subscription',\r\n          price: '$19.99/month',\r\n          description: 'Unlimited bookings',\r\n          features: ['Unlimited connections', 'Priority support', 'Advanced analytics'],\r\n          isPopular: true,\r\n        }\r\n      ];\r\n\r\n      if (isApprovedProfessional) {\r\n        plans.push({\r\n          id: 'dual_subscription',\r\n          title: 'Dual Role Subscription',\r\n          price: '$39.99/month',\r\n          description: 'No fees as pro or owner',\r\n          features: ['Unlimited connections', 'Priority support', 'Advanced analytics', 'No commission fees', 'Use as both pro and owner'],\r\n          isPopular: false,\r\n        });\r\n      }\r\n\r\n      return plans;\r\n    }\r\n  };\r\n\r\n  const renderPlansSection = () => (\r\n    <View style={styles.section}>\r\n      <Text style={styles.sectionTitle}>Subscription Plans</Text>\r\n      <ScrollView \r\n        horizontal\r\n        showsHorizontalScrollIndicator={true}\r\n        style={styles.plansScroll}\r\n        contentContainerStyle={styles.plansScrollContent}\r\n      >\r\n        {getSubscriptionPlans().map((plan) => (\r\n          <View key={plan.id} style={styles.planCardContainer}>\r\n            <SubscriptionPlan\r\n              plan={plan}\r\n              isPopular={plan.isPopular}\r\n              isCurrent={currentPlan?.id === plan.id}\r\n              onSwitch={onSwitchPlan}\r\n            />\r\n          </View>\r\n        ))}\r\n      </ScrollView>\r\n    </View>\r\n  );\r\n\r\n  const renderCurrentPlanInfo = () => (\r\n    <View style={styles.currentPlanInfo}>\r\n      <Text style={styles.currentPlanTitle}>{currentPlan?.title || 'Waitlist Signup'}</Text>\r\n      <Text style={styles.currentPlanBilling}>\r\n        Next billing date: {currentPlan?.nextBilling || 'N/A'}\r\n      </Text>\r\n      <View style={styles.usageStats}>\r\n        <Text style={styles.usageText}>\r\n          {currentPlan?.id === 'waitlist' ? 'Unlimited connections available' : `${currentPlan?.connections?.used || 0} of ${currentPlan?.connections?.total || 'Unlimited'} connections used`}\r\n        </Text>\r\n        {currentPlan?.id !== 'waitlist' && (\r\n          <View style={styles.usageBar}>\r\n            <View style={[styles.usageProgress, { width: `${(currentPlan?.connections?.used / currentPlan?.connections?.total) * 100 || 0}%` }]} />\r\n          </View>\r\n        )}\r\n      </View>\r\n    </View>\r\n  );\r\n\r\n  const renderPaymentMethodsSection = () => (\r\n    <View style={styles.section}>\r\n      <View style={styles.sectionHeader}>\r\n        <Text style={styles.sectionTitle}>{userRole === 'professional' ? 'Payout Methods' : 'Payment Methods' }</Text>\r\n        <TouchableOpacity style={styles.addButton} onPress={onAddPaymentMethod}>\r\n          <MaterialCommunityIcons name=\"plus\" size={20} color={theme.colors.background} />\r\n          <Text style={styles.addButtonText}>Add New</Text>\r\n        </TouchableOpacity>\r\n      </View>\r\n      {paymentMethods && paymentMethods.length > 0 ? (\r\n        paymentMethods.map(renderPaymentMethod)\r\n      ) : (\r\n        <View style={styles.noPaymentMethodsContainer}>\r\n          <Text style={styles.noPaymentMethodsText}>No payment methods added yet</Text>\r\n        </View>\r\n      )}\r\n    </View>\r\n  );\r\n\r\n  const renderDesktopLayout = () => (\r\n    <View style={styles.desktopContainer}>\r\n      <View style={styles.leftColumn}>\r\n        {/*\r\n        TODO: Add back in after MVP \r\n        {renderPlansSection()} */}\r\n\r\n        <View style={styles.section}>\r\n          <Text style={styles.sectionTitle}>Notification Preferences</Text>\r\n          {renderNotificationSettings()}\r\n        </View>\r\n\r\n        <View style={styles.section}>\r\n          <Text style={styles.sectionTitle}>Privacy & Security Settings</Text>\r\n          {renderPrivacySettings()}\r\n        </View>\r\n\r\n        <View style={styles.section}>\r\n          <Text style={styles.sectionTitle}>Time Settings</Text>\r\n          <View style={styles.settingItem}>\r\n            <View style={styles.settingContent}>\r\n              <MaterialCommunityIcons name=\"clock-outline\" size={24} color={theme.colors.primary} />\r\n              <View style={styles.settingTextContainer}>\r\n                <Text style={styles.settingTitle}>Timezone</Text>\r\n                <Text style={styles.settingDescription}>Set your local timezone for accurate time display</Text>\r\n              </View>\r\n            </View>\r\n            <TouchableOpacity \r\n              style={styles.timezoneButton}\r\n              onPress={openTimezoneModal}\r\n            >\r\n              <Text style={styles.timezoneButtonText}>{timezone}</Text>\r\n              <MaterialCommunityIcons name=\"chevron-down\" size={20} color={theme.colors.primary} />\r\n            </TouchableOpacity>\r\n          </View>\r\n          \r\n          {/* TODO: implement after MVP Launch \r\n          <View style={styles.settingItem}>\r\n            <View style={styles.settingContent}>\r\n              <MaterialCommunityIcons name=\"clock-time-eight\" size={24} color={theme.colors.primary} />\r\n              <View style={styles.settingTextContainer}>\r\n                <Text style={styles.settingTitle}>Military Time (24-hour)</Text>\r\n                <Text style={styles.settingDescription}>Use 24-hour time format instead of 12-hour format</Text>\r\n              </View>\r\n            </View>\r\n            <Switch\r\n              value={use_military_time}\r\n              onValueChange={(value) => handleUpdateSetting('use_military_time', value)}\r\n              trackColor={{ false: theme.colors.disabled, true: theme.colors.primary }}\r\n            />\r\n          </View> */}\r\n        </View>\r\n      </View>\r\n\r\n      {/* TODO: Add back in after MVP \r\n      <View style={styles.rightColumn}>\r\n        <View style={styles.section}>\r\n          <Text style={styles.sectionTitle}>Current Plan</Text>\r\n          {renderCurrentPlanInfo()}\r\n        </View>\r\n\r\n        {renderPaymentMethodsSection()}\r\n\r\n        <View style={styles.section}>\r\n          <Text style={styles.sectionTitle}>Billing History</Text>\r\n          {/* Add billing history items here\r\n          <TouchableOpacity style={styles.viewAllButton}>\r\n            <Text style={styles.viewAllText}>View All Transactions</Text>\r\n          </TouchableOpacity>\r\n        </View>\r\n      </View> */}\r\n    </View>\r\n  );\r\n\r\n  const renderMobileLayout = () => (\r\n    <ScrollView style={styles.mobileContainer}>\r\n      {/* TODO: Add back after MVP \r\n      {renderPlansSection()}\r\n      {renderPaymentMethodsSection()} */}\r\n\r\n      <View style={styles.section}>\r\n        <Text style={styles.sectionTitle}>Notification Settings</Text>\r\n        {renderNotificationSettings()}\r\n      </View>\r\n\r\n      <View style={styles.section}>\r\n        <Text style={styles.sectionTitle}>Privacy & Security Settings</Text>\r\n        {renderPrivacySettings()}\r\n      </View>\r\n\r\n      <View style={styles.section}>\r\n        <Text style={styles.sectionTitle}>Time Settings</Text>\r\n        <View style={styles.settingItem}>\r\n          <View style={styles.settingContent}>\r\n            <MaterialCommunityIcons name=\"clock-outline\" size={24} color={theme.colors.primary} />\r\n            <View style={styles.settingTextContainer}>\r\n              <Text style={styles.settingTitle}>Timezone</Text>\r\n              <Text style={styles.settingDescription}>Set your local timezone for accurate time display</Text>\r\n            </View>\r\n          </View>\r\n          <TouchableOpacity \r\n            style={styles.timezoneButton}\r\n            onPress={openTimezoneModal}\r\n          >\r\n            <Text style={styles.timezoneButtonText}>{timezone}</Text>\r\n            <MaterialCommunityIcons name=\"chevron-down\" size={20} color={theme.colors.primary} />\r\n          </TouchableOpacity>\r\n        </View>\r\n        \r\n        {/* TODO: implement after MVP Launch \r\n        <View style={styles.settingItem}>\r\n          <View style={styles.settingContent}>\r\n            <MaterialCommunityIcons name=\"clock-time-eight\" size={24} color={theme.colors.primary} />\r\n            <View style={styles.settingTextContainer}>\r\n              <Text style={styles.settingTitle}>Military Time (24-hour)</Text>\r\n              <Text style={styles.settingDescription}>Use 24-hour time format instead of 12-hour format</Text>\r\n            </View>\r\n          </View>\r\n          <Switch\r\n            value={use_military_time}\r\n            onValueChange={(value) => handleUpdateSetting('use_military_time', value)}\r\n            trackColor={{ false: theme.colors.disabled, true: theme.colors.primary }}\r\n          />\r\n        </View> */}\r\n      </View>\r\n    </ScrollView>\r\n  );\r\n\r\n  const renderNotificationSettings = () => {\r\n    return (\r\n      <>\r\n        <View style={styles.settingItem}>\r\n          <View style={styles.settingContent}>\r\n            <MaterialCommunityIcons name=\"bell\" size={24} color={theme.colors.primary} />\r\n            <View style={styles.settingTextContainer}>\r\n              <Text style={styles.settingTitle}>Push Notifications</Text>\r\n              <Text style={styles.settingDescription}>Receive push notifications for updates</Text>\r\n            </View>\r\n          </View>\r\n          <Switch\r\n            value={push_notifications}\r\n            onValueChange={(value) => handleUpdateSetting('push_notifications', value)}\r\n            trackColor={{ false: theme.colors.disabled, true: theme.colors.primary }}\r\n          />\r\n        </View>\r\n\r\n        <View style={styles.settingItem}>\r\n          <View style={styles.settingContent}>\r\n            <MaterialCommunityIcons name=\"email\" size={24} color={theme.colors.primary} />\r\n            <View style={styles.settingTextContainer}>\r\n              <Text style={styles.settingTitle}>Email Updates</Text>\r\n              <Text style={styles.settingDescription}>Receive important updates via email</Text>\r\n            </View>\r\n          </View>\r\n          <Switch\r\n            value={email_updates}\r\n            onValueChange={(value) => handleUpdateSetting('email_updates', value)}\r\n            trackColor={{ false: theme.colors.disabled, true: theme.colors.primary }}\r\n          />\r\n        </View>\r\n\r\n        <View style={styles.settingItem}>\r\n          <View style={styles.settingContent}>\r\n            <MaterialCommunityIcons name=\"bell-outline\" size={24} color={theme.colors.primary} />\r\n            <View style={styles.settingTextContainer}>\r\n              <Text style={styles.settingTitle}>Marketing Communications</Text>\r\n              <Text style={styles.settingDescription}>Receive promotions and marketing emails</Text>\r\n            </View>\r\n          </View>\r\n          <Switch\r\n            value={marketing_communications}\r\n            onValueChange={(value) => handleUpdateSetting('marketing_communications', value)}\r\n            trackColor={{ false: theme.colors.disabled, true: theme.colors.primary }}\r\n          />\r\n        </View>\r\n      </>\r\n    );\r\n  };\r\n\r\n  const renderPrivacySettings = () => {\r\n    return (\r\n      <>\r\n        <View style={styles.settingItem}>\r\n          <View style={styles.settingContent}>\r\n            <MaterialCommunityIcons name=\"account-eye\" size={24} color={theme.colors.primary} />\r\n            <View style={styles.settingTextContainer}>\r\n              <Text style={styles.settingTitle}>Profile Visibility</Text>\r\n              <Text style={styles.settingDescription}>Make your profile visible to others</Text>\r\n            </View>\r\n          </View>\r\n          <Switch\r\n            value={profile_visibility}\r\n            onValueChange={(value) => handleUpdateSetting('profile_visibility', value)}\r\n            trackColor={{ false: theme.colors.disabled, true: theme.colors.primary }}\r\n          />\r\n        </View>\r\n\r\n        <View style={styles.settingItem}>\r\n          <View style={styles.settingContent}>\r\n            <MaterialCommunityIcons name=\"lock-reset\" size={24} color={theme.colors.primary} />\r\n            <View style={styles.settingTextContainer}>\r\n              <Text style={styles.settingTitle}>Change Password</Text>\r\n              <Text style={styles.settingDescription}>Update your account password</Text>\r\n            </View>\r\n          </View>\r\n          <TouchableOpacity \r\n            style={styles.actionButton}\r\n            onPress={() => navigation.navigate('ChangePassword')}\r\n          >\r\n            <Text style={styles.actionButtonText}>Change</Text>\r\n          </TouchableOpacity>\r\n        </View>\r\n        \r\n        {/* TODO: Add location privacy toggle after MVP launch */}\r\n      </>\r\n    );\r\n  };\r\n\r\n  const renderSettingItem = (setting) => (\r\n    <View key={setting.id} style={styles.settingItem}>\r\n      <View style={styles.settingContent}>\r\n        <MaterialCommunityIcons name={setting.icon} size={24} color={theme.colors.primary} />\r\n        <View style={styles.settingTextContainer}>\r\n          <Text style={styles.settingTitle}>{setting.title}</Text>\r\n          {setting.description && (\r\n            <Text style={styles.settingDescription}>{setting.description}</Text>\r\n          )}\r\n        </View>\r\n      </View>\r\n      {setting.type === 'toggle' ? (\r\n        <Switch\r\n          value={setting.value}\r\n          onValueChange={(value) => handleUpdateSetting(setting.id, value)}\r\n          trackColor={{ false: theme.colors.disabled, true: theme.colors.primary }}\r\n        />\r\n      ) : setting.type === 'timezone' ? (\r\n        <TouchableOpacity \r\n          style={styles.timezoneButton}\r\n          onPress={openTimezoneModal}\r\n        >\r\n          <Text style={styles.timezoneButtonText}>{timezone}</Text>\r\n          <MaterialCommunityIcons name=\"chevron-down\" size={20} color={theme.colors.primary} />\r\n        </TouchableOpacity>\r\n      ) : (\r\n        <TouchableOpacity \r\n          style={styles.actionButton}\r\n          onPress={() => handleUpdateSetting(setting.id)}\r\n        >\r\n          <Text style={styles.actionButtonText}>{setting.actionText || 'Update'}</Text>\r\n        </TouchableOpacity>\r\n      )}\r\n    </View>\r\n  );\r\n\r\n  const renderPaymentMethod = (method) => (\r\n    <View key={method.id} style={styles.paymentItem}>\r\n      <View style={styles.paymentContent}>\r\n        <MaterialCommunityIcons \r\n          name={method.type === 'card' ? 'credit-card' : 'bank'} \r\n          size={24} \r\n          color={theme.colors.primary} \r\n        />\r\n        <View style={styles.paymentTextContainer}>\r\n          <View style={styles.paymentTitleRow}>\r\n            <Text style={styles.paymentTitle}>\r\n              {method.type === 'card' ? `•••• ${method.last4}` : method.bankName}\r\n            </Text>\r\n            {!method.isDefault && (\r\n              <TouchableOpacity \r\n                style={styles.setDefaultButton}\r\n                onPress={() => onSetDefaultPayment(method.id)}\r\n              >\r\n                <Text style={styles.setDefaultText}>Set Default</Text>\r\n              </TouchableOpacity>\r\n            )}\r\n          </View>\r\n          <Text style={styles.paymentDescription} numberOfLines={1}>\r\n            {method.type === 'card' ? `Expires ${method.expiry}` : `Account ending in ${method.last4}`}\r\n          </Text>\r\n        </View>\r\n      </View>\r\n      <TouchableOpacity \r\n        style={styles.deleteButton} \r\n        onPress={() => onRemovePaymentMethod(method.id)}\r\n      >\r\n        <MaterialCommunityIcons name=\"delete\" size={20} color={theme.colors.error} />\r\n      </TouchableOpacity>\r\n    </View>\r\n  );\r\n\r\n  // Handle setting updates with toast notifications\r\n  const handleUpdateSetting = (id, value) => {\r\n    debugLog('MBA54321 Updating setting:', { id, value });\r\n    \r\n    // Get readable setting name for toast messages\r\n    const settingNames = {\r\n      'push_notifications': 'Push Notifications',\r\n      'email_updates': 'Email Updates',\r\n      'marketing_communications': 'Marketing Communications',\r\n      'profile_visibility': 'Profile Visibility',\r\n      'use_military_time': 'Military Time'\r\n    };\r\n    \r\n    const settingName = settingNames[id] || id;\r\n    \r\n    // Call the parent update function\r\n    onUpdateSetting(id, value)\r\n      .then(() => {\r\n        // Show success toast\r\n        showToast({\r\n          message: `${settingName} ${value ? 'enabled' : 'disabled'} successfully`,\r\n          type: 'success',\r\n          duration: 3000\r\n        });\r\n      })\r\n      .catch(error => {\r\n        debugLog('MBA54321 Error updating setting:', error);\r\n        // Show error toast\r\n        showToast({\r\n          message: `Failed to update ${settingName.toLowerCase()}. Please try again.`,\r\n          type: 'error',\r\n          duration: 4000\r\n        });\r\n      });\r\n  };\r\n\r\n  return (\r\n    <View style={styles.container}>\r\n      {isMobile ? renderMobileLayout() : renderDesktopLayout()}\r\n      {renderTimezoneModal()}\r\n    </View>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  desktopContainer: {\r\n    flexDirection: 'row',\r\n    gap: 24,\r\n  },\r\n  leftColumn: {\r\n    flex: 1,\r\n    gap: 24,\r\n  },\r\n  rightColumn: {\r\n    width: '35%',\r\n    minWidth: 300,\r\n    gap: 24,\r\n  },\r\n  mobileContainer: {\r\n    flex: 1,\r\n  },\r\n  section: {\r\n    backgroundColor: theme.colors.surfaceContrast,\r\n    borderRadius: 10,\r\n    padding: 20,\r\n    marginBottom: 15,\r\n  },\r\n  sectionHeader: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    marginBottom: 15,\r\n  },\r\n  sectionTitle: {\r\n    fontSize: 18,\r\n    fontWeight: 'bold',\r\n    color: theme.colors.text,\r\n    marginBottom: 15,\r\n  },\r\n  plansScroll: {\r\n    marginHorizontal: -20,\r\n  },\r\n  plansScrollContent: {\r\n    paddingHorizontal: 20,\r\n    paddingBottom: 16,\r\n  },\r\n  planCardContainer: {\r\n    width: 280,\r\n    marginRight: 16,\r\n    paddingBottom: 4,\r\n  },\r\n  planCard: {\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 10,\r\n    padding: 20,\r\n    position: 'relative',\r\n    marginTop: 12,\r\n    height: '100%',\r\n    borderWidth: 0,\r\n  },\r\n  currentPlanBorder: {\r\n    borderWidth: 2,\r\n    borderColor: theme.colors.primary,\r\n  },\r\n  popularPlan: {\r\n  },\r\n  popularTag: {\r\n    position: 'absolute',\r\n    top: -12,\r\n    right: 20,\r\n    backgroundColor: theme.colors.primary,\r\n    paddingHorizontal: 12,\r\n    paddingVertical: 4,\r\n    borderRadius: 12,\r\n    zIndex: 2,\r\n  },\r\n  popularTagText: {\r\n    color: theme.colors.surfaceContrast,\r\n    fontWeight: '600',\r\n    fontSize: 12,\r\n  },\r\n  planTitle: {\r\n    fontSize: 20,\r\n    fontWeight: 'bold',\r\n    marginBottom: 10,\r\n  },\r\n  planPrice: {\r\n    fontSize: 24,\r\n    fontWeight: '600',\r\n    color: theme.colors.primary,\r\n    marginBottom: 5,\r\n  },\r\n  planDescription: {\r\n    color: theme.colors.secondary,\r\n    marginBottom: 15,\r\n  },\r\n  featuresList: {\r\n    gap: 10,\r\n    marginBottom: 20,\r\n  },\r\n  featureItem: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    gap: 10,\r\n  },\r\n  featureText: {\r\n    color: theme.colors.text,\r\n  },\r\n  planButton: {\r\n    backgroundColor: theme.colors.primary,\r\n    padding: 12,\r\n    borderRadius: 8,\r\n    alignItems: 'center',\r\n    marginTop: 'auto',\r\n    marginBottom: 0,\r\n  },\r\n  currentPlanButton: {\r\n    backgroundColor: theme.colors.surface,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.primary,\r\n  },\r\n  planButtonText: {\r\n    color: theme.colors.surfaceContrast,\r\n    fontWeight: '600',\r\n  },\r\n  currentPlanButtonText: {\r\n    color: theme.colors.primary,\r\n  },\r\n  settingItem: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    justifyContent: 'space-between',\r\n    paddingVertical: 12,\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: theme.colors.placeHolderText,\r\n  },\r\n  settingContent: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    flex: 1,\r\n  },\r\n  settingTextContainer: {\r\n    marginLeft: 15,\r\n    flex: 1,\r\n  },\r\n  settingTitle: {\r\n    fontSize: 16,\r\n    fontWeight: '500',\r\n  },\r\n  settingDescription: {\r\n    fontSize: 14,\r\n    color: theme.colors.secondary,\r\n    marginTop: 2,\r\n  },\r\n  actionButton: {\r\n    backgroundColor: theme.colors.surface,\r\n    paddingHorizontal: 12,\r\n    paddingVertical: 6,\r\n    borderRadius: 6,\r\n  },\r\n  actionButtonText: {\r\n    color: theme.colors.primary,\r\n    fontWeight: '500',\r\n  },\r\n  currentPlanInfo: {\r\n    backgroundColor: theme.colors.surface,\r\n    padding: 15,\r\n    borderRadius: 8,\r\n  },\r\n  currentPlanTitle: {\r\n    fontSize: 20,\r\n    fontWeight: '600',\r\n    marginBottom: 5,\r\n  },\r\n  currentPlanBilling: {\r\n    color: theme.colors.secondary,\r\n    marginBottom: 15,\r\n  },\r\n  usageStats: {\r\n    gap: 8,\r\n  },\r\n  usageText: {\r\n    fontSize: 14,\r\n    color: theme.colors.text,\r\n  },\r\n  usageBar: {\r\n    height: 8,\r\n    backgroundColor: theme.colors.background,\r\n    borderRadius: 4,\r\n  },\r\n  usageProgress: {\r\n    height: '100%',\r\n    backgroundColor: theme.colors.primary,\r\n    borderRadius: 4,\r\n  },\r\n  paymentItem: {\r\n    flexDirection: 'row',\r\n    alignItems: 'flex-start',\r\n    justifyContent: 'space-between',\r\n    padding: 12,\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 8,\r\n    marginBottom: 10,\r\n  },\r\n  paymentContent: {\r\n    flexDirection: 'row',\r\n    alignItems: 'flex-start',\r\n    flex: 1,\r\n    marginRight: 12,\r\n  },\r\n  paymentTextContainer: {\r\n    marginLeft: 15,\r\n    flex: 1,\r\n  },\r\n  paymentTitleRow: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    flexWrap: 'wrap',\r\n    gap: 8,\r\n  },\r\n  paymentTitle: {\r\n    fontSize: 16,\r\n    fontWeight: '500',\r\n  },\r\n  paymentDescription: {\r\n    fontSize: 14,\r\n    color: theme.colors.secondary,\r\n    marginTop: 2,\r\n  },\r\n  setDefaultButton: {\r\n    paddingHorizontal: 8,\r\n    paddingVertical: 2,\r\n    borderRadius: 4,\r\n  },\r\n  setDefaultText: {\r\n    color: theme.colors.primary,\r\n    fontSize: 14,\r\n    fontWeight: '500',\r\n  },\r\n  deleteButton: {\r\n    padding: 4,\r\n  },\r\n  addButton: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    backgroundColor: theme.colors.primary,\r\n    padding: 8,\r\n    borderRadius: 5,\r\n  },\r\n  addButtonText: {\r\n    color: theme.colors.surfaceContrast,\r\n    marginLeft: 5,\r\n    fontWeight: '500',\r\n  },\r\n  viewAllButton: {\r\n    padding: 12,\r\n    borderRadius: 8,\r\n    backgroundColor: theme.colors.surface,\r\n    alignItems: 'center',\r\n  },\r\n  viewAllText: {\r\n    color: theme.colors.primary,\r\n    fontWeight: '500',\r\n  },\r\n  modalOverlay: {\r\n    flex: 1,\r\n    backgroundColor: 'rgba(0, 0, 0, 0.5)',\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n  },\r\n  modalContent: {\r\n    backgroundColor: theme.colors.background,\r\n    borderRadius: 10,\r\n    width: '90%',\r\n    maxWidth: 500,\r\n    maxHeight: '80%',\r\n    padding: 20,\r\n  },\r\n  modalHeader: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    marginBottom: 15,\r\n    paddingBottom: 10,\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: theme.colors.border,\r\n  },\r\n  modalTitle: {\r\n    fontSize: 18,\r\n    fontWeight: 'bold',\r\n    color: theme.colors.text,\r\n  },\r\n  timezoneItem: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    paddingVertical: 12,\r\n    paddingHorizontal: 15,\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: theme.colors.border,\r\n  },\r\n  selectedTimezoneItem: {\r\n    backgroundColor: theme.colors.primaryLight,\r\n  },\r\n  timezoneText: {\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n  },\r\n  selectedTimezoneText: {\r\n    fontWeight: 'bold',\r\n    color: theme.colors.primary,\r\n  },\r\n  timezoneButton: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    backgroundColor: theme.colors.surface,\r\n    paddingHorizontal: 12,\r\n    paddingVertical: 6,\r\n    borderRadius: 6,\r\n  },\r\n  timezoneButtonText: {\r\n    color: theme.colors.primary,\r\n    fontWeight: '500',\r\n    marginRight: 5,\r\n  },\r\n  noPaymentMethodsContainer: {\r\n    padding: 20,\r\n    alignItems: 'center',\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 8,\r\n  },\r\n  noPaymentMethodsText: {\r\n    color: theme.colors.secondary,\r\n    fontSize: 16,\r\n  },\r\n});\r\n\r\nexport default SettingsPaymentsTab; ","import React from 'react';\r\nimport { View, Text, TouchableOpacity, StyleSheet, ScrollView } from 'react-native';\r\nimport { theme } from '../styles/theme';\r\n\r\nconst TabBar = ({ tabs, activeTab, onTabPress, isMobile }) => {\r\n  return (\r\n    <ScrollView \r\n      horizontal={isMobile}\r\n      showsHorizontalScrollIndicator={false}\r\n      contentContainerStyle={[\r\n        styles.container,\r\n        isMobile && styles.mobileContainer\r\n      ]}\r\n    >\r\n      {tabs.map((tab) => (\r\n        <TouchableOpacity\r\n          key={tab.id}\r\n          style={[\r\n            styles.tab,\r\n            activeTab === tab.id && styles.activeTab,\r\n            isMobile && styles.mobileTab\r\n          ]}\r\n          onPress={() => onTabPress(tab.id)}\r\n        >\r\n          <Text style={[\r\n            styles.tabText,\r\n            activeTab === tab.id && styles.activeTabText,\r\n            isMobile && styles.mobileTabText\r\n          ]}>\r\n            {tab.label}\r\n          </Text>\r\n        </TouchableOpacity>\r\n      ))}\r\n    </ScrollView>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flexDirection: 'row',\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 8,\r\n    padding: 8,\r\n    marginBottom: 16,\r\n  },\r\n  mobileContainer: {\r\n    padding: 4,\r\n    marginBottom: 10,\r\n  },\r\n  tab: {\r\n    flex: 1,\r\n    paddingVertical: 12,\r\n    paddingHorizontal: 20,\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    borderRadius: 6,\r\n    marginHorizontal: 4,\r\n  },\r\n  mobileTab: {\r\n    flex: 0,\r\n    minWidth: 150,\r\n    paddingVertical: 8,\r\n    paddingHorizontal: 16,\r\n  },\r\n  activeTab: {\r\n    backgroundColor: theme.colors.primary,\r\n  },\r\n  tabText: {\r\n    fontSize: 16,\r\n    fontWeight: '500',\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts?.regular?.fontFamily,\r\n  },\r\n  mobileTabText: {\r\n    fontSize: 14,\r\n  },\r\n  activeTabText: {\r\n    color: theme.colors.whiteText || theme.colors.background,\r\n  },\r\n});\r\n\r\nexport default TabBar; ","import React, { useState, useEffect, useContext, useRef } from 'react';\r\nimport { View, ScrollView, StyleSheet, Text, TextInput, TouchableOpacity, Image, Platform, StatusBar, Alert, useWindowDimensions, SafeAreaView, ActivityIndicator } from 'react-native';\r\nimport { MaterialCommunityIcons, Ionicons } from '@expo/vector-icons';\r\nimport { Button, Portal, Dialog, Paragraph } from 'react-native-paper';\r\nimport { useNavigation } from '@react-navigation/native';\r\nimport * as ImagePicker from 'expo-image-picker';\r\nimport { theme } from '../styles/theme';\r\nimport AsyncStorage from '@react-native-async-storage/async-storage';\r\nimport { AuthContext, debugLog, getStorage, setStorage } from '../context/AuthContext';\r\nimport { TutorialContext } from '../context/TutorialContext';\r\nimport FloatingSaveButton from '../components/FloatingSaveButton';\r\nimport ServiceManager from '../components/ServiceManager';\r\nimport ProfessionalTab from '../components/ProfessionalTab';\r\nimport RecordedPets from '../components/RecordedPets';\r\nimport EditableSection from '../components/EditableSection';\r\nimport DatePicker from '../components/DatePicker';\r\nimport BackHeader from '../components/BackHeader';\r\nimport CrossPlatformView from '../components/CrossPlatformView';\r\nimport TutorialModal from '../components/TutorialModal';\r\nimport { DEFAULT_SERVICES } from '../data/mockData';\r\nimport ProfileInfoTab from '../components/profile/ProfileInfoTab';\r\nimport ServicesAvailabilityTab from '../components/profile/ServicesAvailabilityTab';\r\nimport PetsPreferencesTab from '../components/profile/PetsPreferencesTab';\r\nimport SettingsPaymentsTab from '../components/profile/SettingsPaymentsTab';\r\nimport TabBar from '../components/TabBar';\r\nimport { userProfile, updateProfileInfo } from '../api/API';\r\n\r\nconst MyProfile = () => {\r\n  debugLog('MBA5678: MyProfile component rendering/mounting');\r\n  \r\n  const navigation = useNavigation();\r\n  const { width: windowWidth } = useWindowDimensions();\r\n  const { screenWidth, isCollapsed, is_DEBUG, userRole, isApprovedProfessional, user, logout } = useContext(AuthContext);\r\n  const [isMobile, setIsMobile] = useState(screenWidth <= 900);\r\n  const [isWideScreen, setIsWideScreen] = useState(screenWidth >= 1200);\r\n  const styles = createStyles(screenWidth, isCollapsed);\r\n  const [activeTab, setActiveTab] = useState('profile_info');\r\n  const [hasUnsavedChanges, setHasUnsavedChanges] = useState(false);\r\n  \r\n  // Profile state\r\n  const [profileData, setProfileData] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n\r\n  const [editMode, setEditMode] = useState({});\r\n\r\n  const [currentPlan, setCurrentPlan] = useState({\r\n    id: 'waitlist',\r\n    title: 'Waitlist Signup',\r\n    nextBilling: 'N/A',\r\n    connections: { used: 0, total: 'Unlimited' }\r\n  });\r\n\r\n  const { \r\n    isVisible: isTutorialVisible,\r\n    currentStep,\r\n    totalSteps,\r\n    stepData,\r\n    handleNext,\r\n    handlePrevious,\r\n    handleSkip,\r\n    completeTutorial,\r\n  } = useContext(TutorialContext);\r\n\r\n  const loadActiveTab = async () => {\r\n    try {\r\n      // First, check URL parameters directly when on web\r\n      if (Platform.OS === 'web') {\r\n        const urlParams = new URLSearchParams(window.location.search);\r\n        const tabFromUrl = urlParams.get('initialTab') || urlParams.get('screen');\r\n        \r\n        if (tabFromUrl && ['profile_info', 'pets_preferences', 'settings_payments', 'services_availability'].includes(tabFromUrl)) {\r\n          debugLog('MBAuieo2o34nf MyProfile retrieved tab from URL params', { tabFromUrl });\r\n          setActiveTab(tabFromUrl);\r\n          // Store this tab in storage for persistence\r\n          await setStorage('MyProfileActiveTab', tabFromUrl);\r\n          return;\r\n        }\r\n      }\r\n      \r\n      // Then check navigation params\r\n      const params = navigation.getState().routes.find(route => route.name === 'MyProfile')?.params;\r\n      debugLog('MBAuieo2o34nf MyProfile navigation params', params);\r\n      \r\n      if (params?.initialTab) {\r\n        debugLog('MBAuieo2o34nf MyProfile received initialTab param', { initialTab: params.initialTab });\r\n        setActiveTab(params.initialTab);\r\n        await setStorage('MyProfileActiveTab', params.initialTab);\r\n        return;\r\n      } else if (params?.screen) {\r\n        debugLog('MBAuieo2o34nf MyProfile received screen param', { screen: params.screen });\r\n        setActiveTab(params.screen);\r\n        await setStorage('MyProfileActiveTab', params.screen);\r\n        return;\r\n      } else if (stepData?.tab) {\r\n        debugLog('MBAuieo2o34nf MyProfile received tab from stepData', { tab: stepData.tab });\r\n        setActiveTab(stepData.tab);\r\n        await setStorage('MyProfileActiveTab', stepData.tab);\r\n        return;\r\n      }\r\n      \r\n      // If we reach here, attempt to load from storage\r\n      const storedTab = await getStorage('MyProfileActiveTab');\r\n      if (storedTab) {\r\n        debugLog('MBAuieo2o34nf MyProfile loaded tab from storage', { storedTab });\r\n        setActiveTab(storedTab);\r\n      }\r\n    } catch (error) {\r\n      debugLog('MBAuieo2o34nf Error loading active tab', error);\r\n    }\r\n  };\r\n\r\n  // Get initialTab from navigation params\r\n  useEffect(() => {\r\n    loadActiveTab();\r\n  }, [navigation, stepData]);\r\n\r\n  // Store the active tab whenever it changes\r\n  useEffect(() => {\r\n    const storeActiveTab = async () => {\r\n      try {\r\n        await setStorage('MyProfileActiveTab', activeTab);\r\n        \r\n        // Update URL params without reloading the page\r\n        if (Platform.OS === 'web') {\r\n          const url = new URL(window.location.href);\r\n          url.searchParams.set('initialTab', activeTab);\r\n          window.history.replaceState({}, '', url.toString());\r\n        }\r\n        \r\n        debugLog('MBAuieo2o34nf Stored active tab', { activeTab });\r\n      } catch (error) {\r\n        debugLog('MBAuieo2o34nf Error storing active tab', error);\r\n      }\r\n    };\r\n    \r\n    if (activeTab) {\r\n      storeActiveTab();\r\n    }\r\n  }, [activeTab]);\r\n\r\n  // Add a new useEffect to handle tab changes from the tutorial\r\n  useEffect(() => {\r\n    const unsubscribe = navigation.addListener('focus', () => {\r\n      const params = navigation.getState().routes.find(route => route.name === 'MyProfile')?.params;\r\n      if (params?.screen) {\r\n        debugLog('MBA54321 MyProfile focus event - setting active tab', { screen: params.screen });\r\n        setActiveTab(params.screen);\r\n      } else if (params?.initialTab) {\r\n        debugLog('MBA54321 MyProfile focus event - setting active tab', { initialTab: params.initialTab });\r\n        setActiveTab(params.initialTab);\r\n      }\r\n    });\r\n\r\n    return unsubscribe;\r\n  }, [navigation]);\r\n\r\n  // Add a new useEffect to handle tab changes from the tutorial\r\n  useEffect(() => {\r\n    const unsubscribe = navigation.addListener('state', () => {\r\n      const params = navigation.getState().routes.find(route => route.name === 'MyProfile')?.params;\r\n      if (params?.screen) {\r\n        debugLog('MBA54321 MyProfile state change - setting active tab', { screen: params.screen });\r\n        setActiveTab(params.screen);\r\n      } else if (params?.initialTab) {\r\n        debugLog('MBA54321 MyProfile state change - setting active tab', { initialTab: params.initialTab });\r\n        setActiveTab(params.initialTab);\r\n      }\r\n    });\r\n\r\n    return unsubscribe;\r\n  }, [navigation]);\r\n\r\n  useEffect(() => {\r\n    const updateLayout = () => {\r\n      setIsMobile(screenWidth <= 900);\r\n      setIsWideScreen(screenWidth >= 1200);\r\n    };\r\n    updateLayout();\r\n  }, [screenWidth]);\r\n\r\n  useEffect(() => {\r\n    debugLog('MBA5678: MyProfile useEffect running - about to call loadProfileData');\r\n    loadProfileData();\r\n  }, []);\r\n\r\n  const loadProfileData = async () => {\r\n    try {\r\n      setLoading(true);\r\n      // Log the userToken before making the API call\r\n      const token = await getStorage('userToken');\r\n      debugLog('MBA5678: userToken before userProfile call:', token);\r\n      const response = await userProfile();\r\n      setProfileData(response);\r\n      \r\n      // Check for pets with missing owners and fix them if needed\r\n      await checkAndFixPetOwners();\r\n      \r\n      setLoading(false);\r\n      \r\n      // Wait for the tab to be loaded before trying to update active tab from URL\r\n      setTimeout(() => {\r\n        loadActiveTab();\r\n      }, 100);\r\n    } catch (error) {\r\n      setError('Failed to load profile data');\r\n      setLoading(false);\r\n      debugLog('Failed to load profile data:', error);\r\n    }\r\n  };\r\n  \r\n  const checkAndFixPetOwners = async () => {\r\n    try {\r\n      // Check if we have any pets that need fixing\r\n      if (profileData?.pets && profileData.pets.length > 0) {\r\n        const petsWithMissingOwners = profileData.pets.filter(pet => {\r\n          // Try to determine if a pet might have a missing owner\r\n          // Unfortunately we can't directly check the owner field from frontend\r\n          // So we look for potential symptoms like 404 errors on editing\r\n          if (pet.lastUpdateFailed || pet.ownerMissing) {\r\n            return true;\r\n          }\r\n          return false;\r\n        });\r\n        \r\n        if (petsWithMissingOwners.length > 0) {\r\n          debugLog('MBA5432', 'Found pets with potential missing owners:', petsWithMissingOwners);\r\n          \r\n          // Try to fix each pet\r\n          for (const pet of petsWithMissingOwners) {\r\n            try {\r\n              const { fixPetOwner } = require('../api/API');\r\n              const result = await fixPetOwner(pet.id);\r\n              debugLog('MBA5432', 'Fixed pet owner successfully:', result);\r\n            } catch (err) {\r\n              debugLog('MBA5432', 'Failed to fix pet owner:', err);\r\n            }\r\n          }\r\n          \r\n          // Reload profile data to get updated pets\r\n          const response = await userProfile();\r\n          setProfileData(response);\r\n        }\r\n      }\r\n    } catch (error) {\r\n      debugLog('MBA5432', 'Error checking/fixing pet owners:', error);\r\n    }\r\n  };\r\n\r\n  const handleLogout = async () => {\r\n    try {\r\n      await logout();\r\n    } catch (err) {\r\n      debugLog('MBA1234', 'Error during logout:', err);\r\n    }\r\n  };\r\n\r\n  const tabs = [\r\n    { id: 'profile_info', label: userRole === 'professional' ? 'Professional Profile Info' : 'Owner Profile Info' },\r\n    // ...(userRole === 'professional' ? [{ id: 'services_availability', label: 'Services & Availability' }] : []), TODO: Add back in after MVP\r\n    { id: 'pets_preferences', label: 'My Pets' },\r\n    // { id: 'pets_preferences', label: 'Pets & Preferences' }, // TODO: Add back in after MVP\r\n    { id: 'settings_payments', label: 'Settings' }\r\n    // { id: 'settings_payments', label: userRole === 'professional' ? 'Settings & Payout Methods' : 'Settings & Payment Methods' } // TODO: Add back in after MVP\r\n  ];\r\n\r\n  const handlePickImage = async () => {\r\n    const result = await ImagePicker.launchImageLibraryAsync({\r\n      mediaTypes: ImagePicker.MediaTypeOptions.Images,\r\n      allowsEditing: true,\r\n      aspect: [1, 1],\r\n      quality: 1,\r\n    });\r\n\r\n    if (!result.canceled) {\r\n      setProfileData(prev => ({ ...prev, profilePhoto: result.assets[0].uri }));\r\n      setHasUnsavedChanges(true);\r\n    }\r\n  };\r\n\r\n  // Handle save completion from child components\r\n  const handleSaveComplete = (updatedProfile) => {\r\n    debugLog('MBA9876', 'Save completed with updated profile:', updatedProfile);\r\n    \r\n    // Update the profileData with the saved data\r\n    setProfileData(prev => {\r\n      const newProfileData = {\r\n        ...prev,\r\n        ...updatedProfile\r\n      };\r\n      \r\n      // Log the updated profile data for debugging\r\n      debugLog('MBA9876', 'Updated profile data after save:', {\r\n        name: newProfileData.name,\r\n        email: newProfileData.email,\r\n        address: newProfileData.address,\r\n        city: newProfileData.city,\r\n        state: newProfileData.state,\r\n        zip: newProfileData.zip,\r\n        country: newProfileData.country\r\n      });\r\n      \r\n      return newProfileData;\r\n    });\r\n    \r\n    // Reset state flags\r\n    setHasUnsavedChanges(false);\r\n    setEditMode({});\r\n    \r\n    // Show success indicator if needed\r\n    debugLog('MBA5678', 'Changes saved successfully');\r\n  };\r\n\r\n  // Handle field updates before saving\r\n  const handleUpdateField = (field, value) => {\r\n    debugLog('MBA9876', `Updating field ${field} locally, will be saved later:`, value);\r\n    \r\n    // Only update local state, actual save will happen in the child component\r\n    setProfileData(prev => ({\r\n      ...prev,\r\n      [field]: value\r\n    }));\r\n    \r\n    // Mark that we have unsaved changes\r\n    setHasUnsavedChanges(true);\r\n  };\r\n\r\n  const toggleEditMode = (section) => {\r\n    setEditMode(prev => ({ ...prev, [section]: !prev[section] }));\r\n  };\r\n\r\n  const handleSwitchPlan = (planId) => {\r\n    // TODO: Implement API call to switch plans\r\n    debugLog('Switching to plan:', planId);\r\n  };\r\n\r\n  const renderActiveTab = () => {\r\n    debugLog('MBA54321', 'Rendering active tab with profile data:', {\r\n      activeTab,\r\n      profileName: profileData?.name,\r\n      paymentMethods: profileData?.payment_methods\r\n    });\r\n    \r\n    switch (activeTab) {\r\n      case 'profile_info':\r\n        return (\r\n          <ProfileInfoTab\r\n            profilePhoto={profileData?.profilePhoto}\r\n            email={profileData?.email}\r\n            phone={profileData?.phone}\r\n            age={profileData?.age}\r\n            address={profileData?.address}\r\n            city={profileData?.city}\r\n            state={profileData?.state}\r\n            zip={profileData?.zip}\r\n            country={profileData?.country}\r\n            coordinates={profileData?.coordinates}\r\n            bio={profileData?.bio}\r\n            about_me={profileData?.about_me}\r\n            name={profileData?.name}\r\n            emergencyContact={profileData?.emergency_contact}\r\n            authorizedHouseholdMembers={profileData?.authorized_household_members}\r\n            editMode={editMode}\r\n            toggleEditMode={toggleEditMode}\r\n            onChangeText={handleUpdateField}\r\n            pickImage={handlePickImage}\r\n            setHasUnsavedChanges={(hasChanges) => {\r\n              debugLog('MBA9876', 'ProfileInfoTab setting hasUnsavedChanges:', hasChanges);\r\n              setHasUnsavedChanges(hasChanges);\r\n            }}\r\n            onSaveComplete={handleSaveComplete}\r\n            isMobile={isMobile}\r\n            rating={profileData?.rating}\r\n            reviews={profileData?.reviews}\r\n            role={userRole}\r\n            isProfessional={userRole === 'professional'}\r\n            insurance={profileData?.insurance}\r\n            onNavigateToTab={setActiveTab}\r\n          />\r\n        );\r\n      case 'services_availability':\r\n        return (\r\n          <ServicesAvailabilityTab\r\n            services={profileData?.services}\r\n            onToggleService={(id) => {\r\n              const updatedServices = profileData?.services.map(s => \r\n                s.id === id ? { ...s, isActive: !s.isActive } : s\r\n              );\r\n              handleUpdateField('services', updatedServices);\r\n            }}\r\n            onEditHours={() => {}}\r\n            onBlockService={() => {}}\r\n            onPartialDayBlock={() => {}}\r\n            isMobile={isMobile}\r\n          />\r\n        );\r\n      case 'pets_preferences':\r\n        return (\r\n          <PetsPreferencesTab\r\n            pets={profileData?.pets}\r\n            onAddPet={(newPet) => {\r\n              // Check if the pet should be added to the top of the list\r\n              const shouldAddToTop = newPet._addToTop;\r\n              \r\n              // Remove the _addToTop flag before adding to state\r\n              const { _addToTop, ...petToAdd } = newPet;\r\n              \r\n              // Add the new pet to the local state (at the top or bottom)\r\n              const updatedPets = shouldAddToTop \r\n                ? [petToAdd, ...(profileData?.pets || [])] \r\n                : [...(profileData?.pets || []), petToAdd];\r\n                \r\n              handleUpdateField('pets', updatedPets);\r\n              \r\n              // This will mark that there are unsaved changes\r\n              debugLog('MBA5432', 'Added new pet locally:', petToAdd, shouldAddToTop ? '(at top of list)' : '(at bottom of list)');\r\n            }}\r\n            onEditPet={(petId, updatedPetData) => {\r\n              // Update the existing pet in local state\r\n              const updatedPets = (profileData?.pets || []).map(pet => \r\n                pet.id === petId ? { ...pet, ...updatedPetData } : pet\r\n              );\r\n              handleUpdateField('pets', updatedPets);\r\n              debugLog('MBA5432', 'Updated pet locally:', { petId, updatedPetData });\r\n            }}\r\n            onDeletePet={(petId) => {\r\n              // Remove the pet from local state\r\n              const updatedPets = (profileData?.pets || []).filter(pet => pet.id !== petId);\r\n              handleUpdateField('pets', updatedPets);\r\n              debugLog('MBA5432', 'Deleted pet locally:', petId);\r\n            }}\r\n            onReplacePet={(newPetsArray) => {\r\n              // Replace the entire pets array with the new one\r\n              // This prevents the issue with double updates causing blank pets\r\n              handleUpdateField('pets', newPetsArray);\r\n              debugLog('MBA5432', 'Replaced entire pets array:', newPetsArray);\r\n            }}\r\n            preferences={profileData?.preferences}\r\n            onUpdatePreferences={(section, id) => {\r\n              const updatedPreferences = { ...profileData?.preferences };\r\n              if (section === 'homeEnvironment') {\r\n                if (updatedPreferences[section].includes(id)) {\r\n                  updatedPreferences[section] = updatedPreferences[section].filter(item => item !== id);\r\n                } else {\r\n                  updatedPreferences[section] = [...updatedPreferences[section], id];\r\n                }\r\n              } else {\r\n                updatedPreferences[section] = updatedPreferences[section].map(p =>\r\n                  p.id === id ? { ...p, selected: !p.selected } : p\r\n                );\r\n              }\r\n              handleUpdateField('preferences', updatedPreferences);\r\n            }}\r\n            userRole={userRole}\r\n            isMobile={isMobile}\r\n          />\r\n        );\r\n      case 'settings_payments':\r\n        debugLog('MBA54321 Rendering settings_payments tab with payment methods:', {\r\n          paymentMethods: profileData?.payment_methods\r\n        });\r\n        return (\r\n          <SettingsPaymentsTab\r\n            {...profileData}\r\n            navigation={navigation}\r\n            onUpdateSetting={(id, value) => {\r\n              debugLog('Updating setting:', { id, value });\r\n              // Create an update object with just the changed setting\r\n              const updateData = { [id]: value };\r\n              \r\n              // Return the promise for proper chaining in the component\r\n              return updateProfileInfo(updateData)\r\n                .then(updatedProfile => {\r\n                  // Update the profile data with the response\r\n                  setProfileData(prev => ({\r\n                    ...prev,\r\n                    ...updatedProfile\r\n                  }));\r\n                  debugLog('MBA54321 Setting updated successfully:', updateData);\r\n                  // Return the updated profile for the promise chain\r\n                  return updatedProfile;\r\n                });\r\n            }}\r\n            paymentMethods={profileData?.payment_methods || []}\r\n            onAddPaymentMethod={() => navigation.navigate('AddPaymentMethod')}\r\n            onRemovePaymentMethod={(id) => {\r\n              debugLog('Removing payment method:', id);\r\n              // TODO: Implement API call to remove payment method\r\n            }}\r\n            onSetDefaultPayment={(id) => {\r\n              debugLog('Setting default payment method:', id);\r\n              // TODO: Implement API call to set default payment method\r\n            }}\r\n            currentPlan={profileData?.currentPlan || currentPlan}\r\n            onSwitchPlan={handleSwitchPlan}\r\n            isMobile={isMobile}\r\n            userRole={userRole}\r\n            isApprovedProfessional={isApprovedProfessional}\r\n          />\r\n        );\r\n      default:\r\n        return null;\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <View style={styles.container}>\r\n        <ActivityIndicator size=\"large\" color=\"#0000ff\" />\r\n      </View>\r\n    );\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <View style={styles.container}>\r\n        <Text style={styles.errorText}>{error}</Text>\r\n      </View>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <View style={styles.mainContainer}>\r\n      <SafeAreaView style={styles.container}>\r\n        {isMobile && (\r\n          <BackHeader \r\n            title=\"Profile Settings\" \r\n            onBackPress={() => navigation.goBack()} \r\n          />\r\n        )}\r\n        \r\n        <View style={styles.content}>\r\n          <View style={styles.mainContent}>\r\n            <View style={styles.headerSection}>\r\n              <Text style={styles.title}>Profile Settings</Text>\r\n              <ScrollView \r\n                horizontal \r\n                showsHorizontalScrollIndicator={false}\r\n                contentContainerStyle={styles.tabScrollContainer}\r\n              >\r\n                <View style={styles.tabContainer}>\r\n                  {tabs.map((tab) => (\r\n                    <TouchableOpacity\r\n                      key={tab.id}\r\n                      style={[styles.tab, activeTab === tab.id && styles.activeTab]}\r\n                      onPress={async () => {\r\n                        setActiveTab(tab.id);\r\n                        // Update URL params without navigation\r\n                        if (Platform.OS === 'web') {\r\n                          const url = new URL(window.location.href);\r\n                          url.searchParams.set('initialTab', tab.id);\r\n                          window.history.replaceState({}, '', url.toString());\r\n                        }\r\n                        // Store in storage\r\n                        await setStorage('MyProfileActiveTab', tab.id);\r\n                        debugLog('MBAuieo2o34nf Tab clicked - updated storage', { tabId: tab.id });\r\n                      }}\r\n                    >\r\n                      <Text style={[styles.tabText, activeTab === tab.id && styles.activeTabText]}>\r\n                        {tab.label}\r\n                      </Text>\r\n                    </TouchableOpacity>\r\n                  ))}\r\n                </View>\r\n              </ScrollView>\r\n            </View>\r\n\r\n            <View style={styles.tabContent}>\r\n              {renderActiveTab()}\r\n            </View>\r\n          </View>\r\n        </View>\r\n\r\n        {isTutorialVisible && stepData?.screen === 'MyProfile' && (\r\n          <TutorialModal\r\n            step={currentStep}\r\n            totalSteps={totalSteps}\r\n            title={stepData.title}\r\n            description={stepData.description}\r\n            position={stepData.position}\r\n            onNext={handleNext}\r\n            onPrevious={handlePrevious}\r\n            onSkip={handleSkip}\r\n            onClose={completeTutorial}\r\n          />\r\n        )}\r\n      </SafeAreaView>\r\n    </View>\r\n  );\r\n};\r\n\r\nconst createStyles = (screenWidth, isCollapsed) => StyleSheet.create({\r\n  mainContainer: {\r\n    flex: 1,\r\n    backgroundColor: theme.colors.surface,\r\n    height: '100vh',\r\n    overflow: 'hidden',\r\n    position: 'fixed',\r\n    top: 0,\r\n    left: 0,\r\n    right: 0,\r\n    bottom: 0,\r\n    marginLeft: screenWidth > 900 ? (isCollapsed ? 70 : 250) : 0,\r\n    transition: 'margin-left 0.3s ease',\r\n  },\r\n  container: {\r\n    flex: 1,\r\n    backgroundColor: theme.colors.surface,\r\n  },\r\n  content: {\r\n    flex: 1,\r\n    height: '100%',\r\n    overflow: 'auto',\r\n    backgroundColor: theme.colors.surface,\r\n  },\r\n  mainContent: {\r\n    flex: 1,\r\n    width: '100%',\r\n    alignSelf: 'center',\r\n    backgroundColor: theme.colors.surface,\r\n  },\r\n  headerSection: {\r\n    width: '100%',\r\n    backgroundColor: theme.colors.surfaceContrast,\r\n    paddingHorizontal: 24,\r\n    paddingTop: 24,\r\n    zIndex: 2,\r\n  },\r\n  title: {\r\n    fontSize: 32,\r\n    fontWeight: '600',\r\n    color: theme.colors.text,\r\n    marginBottom: 24,\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n  },\r\n  tabScrollContainer: {\r\n    flexGrow: 0,\r\n  },\r\n  tabContainer: {\r\n    flexDirection: 'row',\r\n    gap: screenWidth <= 900 ? 22 : 32,\r\n    paddingRight: screenWidth <= 900 ? 16 : 0,\r\n  },\r\n  tab: {\r\n    paddingBottom: 8,\r\n    borderBottomWidth: 2,\r\n    borderBottomColor: 'transparent',\r\n  },\r\n  activeTab: {\r\n    borderBottomColor: theme.colors.primary,\r\n  },\r\n  tabText: {\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  activeTabText: {\r\n    color: theme.colors.primary,\r\n    fontWeight: '500',\r\n  },\r\n  tabContent: {\r\n    flex: 1,\r\n    padding: screenWidth <= 900 ? 10 : 24,\r\n    backgroundColor: theme.colors.surface,\r\n  },\r\n  errorText: {\r\n    color: 'red',\r\n    textAlign: 'center',\r\n    marginTop: 20,\r\n  },\r\n});\r\n\r\nexport default MyProfile;\r\n","import React from 'react';\r\nimport { TouchableOpacity, Text, StyleSheet } from 'react-native';\r\nimport { theme } from '../styles/theme';\r\n\r\nexport default function CustomButton({ title, onPress }) {\r\n  return (\r\n    <TouchableOpacity style={styles.button} onPress={onPress}>\r\n      <Text style={styles.buttonText}>{title}</Text>\r\n    </TouchableOpacity>\r\n  );\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  button: {\r\n    backgroundColor: theme.colors.primary,\r\n    paddingVertical: theme.spacing.small,\r\n    paddingHorizontal: theme.spacing.medium,\r\n    borderRadius: 5,\r\n    alignItems: 'center',\r\n    marginVertical: theme.spacing.small,\r\n  },\r\n  buttonText: {\r\n    color: theme.colors.whiteText,\r\n    fontSize: theme.fontSizes.medium,\r\n  },\r\n});","/**\r\n * Validation utility functions for form inputs\r\n * These functions are used across the app to ensure data integrity and security\r\n */\r\n\r\n// Import is_PRODUCTION from AuthContext\r\nimport { IsProduction } from '../context/AuthContext';\r\n\r\n/**\r\n * Validates an email address\r\n * @param {string} email - The email address to validate\r\n * @returns {Object} - Object containing isValid (boolean) and message (string)\r\n */\r\nexport const validateEmail = (email) => {\r\n  // Check if email is empty\r\n  if (!email || email.trim() === '') {\r\n    return {\r\n      isValid: false,\r\n      message: 'Email is required'\r\n    };\r\n  }\r\n\r\n  // Basic email format validation\r\n  const emailRegex = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$/;\r\n  \r\n  if (!emailRegex.test(email)) {\r\n    return {\r\n      isValid: false,\r\n      message: 'Please enter a valid email address'\r\n    };\r\n  }\r\n\r\n  // Check for potential XSS or injection attempts\r\n  const sanitizedEmail = email.replace(/[<>]/g, '');\r\n  if (sanitizedEmail !== email) {\r\n    return {\r\n      isValid: false,\r\n      message: 'Email contains invalid characters'\r\n    };\r\n  }\r\n\r\n  return {\r\n    isValid: true,\r\n    message: ''\r\n  };\r\n};\r\n\r\n/**\r\n * Validates a first or last name\r\n * @param {string} name - The name to validate\r\n * @returns {Object} - Object containing isValid (boolean) and message (string)\r\n */\r\nexport const validateName = (name) => {\r\n  // Check if name is empty\r\n  if (!name || name.trim() === '') {\r\n    return {\r\n      isValid: false,\r\n      message: 'Name is required'\r\n    };\r\n  }\r\n\r\n  // Only allow letters, spaces, hyphens, and apostrophes\r\n  const nameRegex = /^[a-zA-Z\\s\\-']+$/;\r\n  \r\n  if (!nameRegex.test(name)) {\r\n    return {\r\n      isValid: false,\r\n      message: 'Name can only contain letters, spaces, hyphens, and apostrophes'\r\n    };\r\n  }\r\n\r\n  // Check for potential XSS or injection attempts\r\n  const sanitizedName = name.replace(/[<>]/g, '');\r\n  if (sanitizedName !== name) {\r\n    return {\r\n      isValid: false,\r\n      message: 'Name contains invalid characters'\r\n    };\r\n  }\r\n\r\n  return {\r\n    isValid: true,\r\n    message: ''\r\n  };\r\n};\r\n\r\n/**\r\n * Validates a password\r\n * @param {string} password - The password to validate\r\n * @returns {Object} - Object containing isValid (boolean) and message (string)\r\n */\r\nexport const validatePassword = (password) => {\r\n  // Check if password is empty\r\n  if (!password || password.trim() === '') {\r\n    return {\r\n      isValid: false,\r\n      message: 'Password is required'\r\n    };\r\n  }\r\n\r\n  // Password strength requirements\r\n  const minLength = 8;\r\n  const hasUpperCase = /[A-Z]/.test(password);\r\n  const hasLowerCase = /[a-z]/.test(password);\r\n  const hasNumbers = /\\d/.test(password);\r\n  const hasSpecialChar = /[!@#$%^&*(),.?\":{}|<>]/.test(password);\r\n\r\n  // Check for potential XSS or injection attempts\r\n  if (IsProduction()) {\r\n    const sanitizedPassword = password.replace(/[<>]/g, '');\r\n    if (sanitizedPassword !== password) {\r\n      return {\r\n        isValid: false,\r\n        message: `Password contains invalid characters: <, >`\r\n      };\r\n    }\r\n  }\r\n\r\n  // Validate password strength\r\n  if (IsProduction()) {\r\n    if (password.length < minLength) {\r\n        return {\r\n        isValid: false,\r\n        message: `Password must be at least ${minLength} characters long`\r\n        };\r\n    }\r\n  }\r\n\r\n  // Only enforce strict password requirements in production\r\n  if (IsProduction()) {\r\n    if (!hasUpperCase || !hasLowerCase || !hasNumbers || !hasSpecialChar) {\r\n      return {\r\n        isValid: false,\r\n        message: 'Password must contain uppercase, lowercase, numbers, and special characters'\r\n      };\r\n    }\r\n  }\r\n\r\n  return {\r\n    isValid: true,\r\n    message: ''\r\n  };\r\n};\r\n\r\n/**\r\n * Validates that two passwords match\r\n * @param {string} password - The first password\r\n * @param {string} confirmPassword - The confirmation password\r\n * @returns {Object} - Object containing isValid (boolean) and message (string)\r\n */\r\nexport const validatePasswordMatch = (password, confirmPassword) => {\r\n  if (password !== confirmPassword) {\r\n    return {\r\n      isValid: false,\r\n      message: 'Passwords do not match'\r\n    };\r\n  }\r\n\r\n  return {\r\n    isValid: true,\r\n    message: ''\r\n  };\r\n};\r\n\r\n/**\r\n * Validates a phone number\r\n * @param {string} phoneNumber - The phone number to validate\r\n * @returns {Object} - Object containing isValid (boolean) and message (string)\r\n */\r\nexport const validatePhoneNumber = (phoneNumber) => {\r\n  // If phone number is optional, allow empty values\r\n  if (!phoneNumber || phoneNumber.trim() === '') {\r\n    return {\r\n      isValid: true,\r\n      message: ''\r\n    };\r\n  }\r\n\r\n  // Basic phone number format validation (allows various formats)\r\n  const phoneRegex = /^[\\+]?[(]?[0-9]{3}[)]?[-\\s\\.]?[0-9]{3}[-\\s\\.]?[0-9]{4,6}$/;\r\n  \r\n  if (!phoneRegex.test(phoneNumber)) {\r\n    return {\r\n      isValid: false,\r\n      message: 'Please enter a valid phone number'\r\n    };\r\n  }\r\n\r\n  // Check for potential XSS or injection attempts\r\n  const sanitizedPhone = phoneNumber.replace(/[<>]/g, '');\r\n  if (sanitizedPhone !== phoneNumber) {\r\n    return {\r\n      isValid: false,\r\n      message: 'Phone number contains invalid characters'\r\n    };\r\n  }\r\n\r\n  return {\r\n    isValid: true,\r\n    message: ''\r\n  };\r\n};\r\n\r\n/**\r\n * Sanitizes input to prevent XSS attacks\r\n * @param {string} input - The input to sanitize\r\n * @returns {string} - The sanitized input\r\n */\r\nexport const sanitizeInput = (input) => {\r\n  if (!input) return '';\r\n  \r\n  // Remove potentially dangerous characters\r\n  return input\r\n    .replace(/[<>]/g, '') // Remove < and > to prevent HTML injection\r\n    .replace(/javascript:/gi, '') // Remove javascript: protocol\r\n    .replace(/on\\w+=/gi, ''); // Remove event handlers\r\n};\r\n","import React, { useState, useContext, useEffect } from 'react';\r\nimport { View, TextInput, Text, StyleSheet, TouchableOpacity, Dimensions, Alert, ActivityIndicator, Platform, Keyboard, SafeAreaView, KeyboardAvoidingView, ScrollView } from 'react-native';\r\nimport { useNavigation, useRoute } from '@react-navigation/native';\r\nimport axios from 'axios';\r\nimport { theme } from '../styles/theme';\r\nimport CustomButton from '../components/CustomButton';\r\nimport { AuthContext } from '../context/AuthContext';\r\nimport { API_BASE_URL } from '../config/config';\r\nimport { navigateToFrom } from '../components/Navigation';\r\nimport { validateEmail, validatePassword } from '../validation/validation';\r\nimport { debugLog } from '../context/AuthContext';\r\nimport { updateTimeSettings } from '../api/API';\r\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\r\nimport { Ionicons } from '@expo/vector-icons';\r\n\r\nconst { width: screenWidth } = Dimensions.get('window');\r\n\r\nexport default function SignIn() {\r\n  const [email, setEmail] = useState('');\r\n  const [password, setPassword] = useState('');\r\n  const [emailError, setEmailError] = useState('');\r\n  const [passwordError, setPasswordError] = useState('');\r\n  const [loading, setLoading] = useState(false);\r\n  const [successMessage, setSuccessMessage] = useState('');\r\n  const [showPassword, setShowPassword] = useState(false);\r\n  const [rememberMe, setRememberMe] = useState(false);\r\n  const navigation = useNavigation();\r\n  const { signIn, is_prototype, is_DEBUG } = useContext(AuthContext);\r\n\r\n  const validateForm = () => {\r\n    let isValid = true;\r\n    \r\n    // Validate email\r\n    const emailValidation = validateEmail(email);\r\n    setEmailError(emailValidation.message);\r\n    if (!emailValidation.isValid) isValid = false;\r\n    \r\n    // Validate password\r\n    const passwordValidation = validatePassword(password);\r\n    setPasswordError(passwordValidation.message);\r\n    if (!passwordValidation.isValid) isValid = false;\r\n    \r\n    return isValid;\r\n  };\r\n\r\n  const handleLogin = async () => {\r\n    if (Platform.OS === 'ios' || Platform.OS === 'android') {\r\n      Keyboard.dismiss();\r\n    }\r\n\r\n    // Validate form before proceeding\r\n    if (!validateForm()) {\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    try {\r\n      debugLog('MBA67890 Starting login process');\r\n      debugLog('MBA67890 API Base URL:', API_BASE_URL);\r\n      debugLog('MBA67890 Login request details:', {\r\n        url: `${API_BASE_URL}/api/token/`,\r\n        method: 'POST',\r\n        data: {\r\n          email: email.toLowerCase(),\r\n          password: '***' // masked for security\r\n        }\r\n      });\r\n\r\n      debugLog('MBA67890 Attempting to authenticate with backend');\r\n      \r\n      const response = await axios.post(`${API_BASE_URL}/api/token/`, {\r\n        email: email.toLowerCase(),\r\n        password: password,\r\n      });\r\n\r\n      debugLog('MBA67890 Login response:', {\r\n        status: response.status,\r\n        statusText: response.statusText,\r\n        headers: response.headers\r\n      });\r\n\r\n      const { access, refresh } = response.data;\r\n      \r\n      debugLog('MBA67890 Authentication successful, received tokens');\r\n      \r\n      // Pass both tokens to signIn and get the status\r\n      const status = await signIn(access, refresh, navigation);\r\n      debugLog('MBA67890 Sign in status:', status);\r\n      \r\n      // After successful login, detect and send timezone to backend\r\n      try {\r\n        const timezone = Intl.DateTimeFormat().resolvedOptions().timeZone;\r\n        debugLog('MBA67890 Detected timezone:', timezone);\r\n        console.log('MBA67890 Detected timezone:', timezone);\r\n        // Pass only the timezone parameter, useMilitaryTime is optional\r\n        await updateTimeSettings(timezone);\r\n        debugLog('MBA67890 Successfully updated timezone in backend');\r\n      } catch (timezoneError) {\r\n        debugLog('MBA67890 Error updating timezone:', timezoneError);\r\n        // Continue with login process even if timezone update fails\r\n      }\r\n      \r\n      // Check if user needs to complete tutorial\r\n      try {\r\n        const tutorialResponse = await axios.get(`${API_BASE_URL}/api/users/v1/tutorial-status/current/`);\r\n        const needsTutorial = tutorialResponse.data.first_time_logging_in || \r\n                             tutorialResponse.data.first_time_logging_in_after_signup;\r\n        \r\n        debugLog('MBA67890 Tutorial status:', tutorialResponse.data);\r\n        debugLog('MBA67890 Needs tutorial:', needsTutorial);\r\n        \r\n        // Navigate based on tutorial status\r\n        if (needsTutorial) {\r\n          debugLog('MBA67890 Navigating to MyProfile for tutorial');\r\n          navigateToFrom(navigation, 'MyProfile', 'SignIn');\r\n        } else {\r\n          debugLog('MBA67890 Navigating to Dashboard');\r\n          navigateToFrom(navigation, 'Dashboard', 'SignIn');\r\n        }\r\n      } catch (tutorialError) {\r\n        debugLog('MBA67890 Error checking tutorial status:', tutorialError);\r\n        // Default to Dashboard if tutorial check fails\r\n        navigateToFrom(navigation, 'Dashboard', 'SignIn');\r\n      }\r\n    } catch (error) {\r\n      debugLog('MBA67890 Login failed', error.response?.data || error.message);\r\n      \r\n      const errorMessage = error.response && error.response.status === 401\r\n        ? 'Invalid credentials. Please try again.'\r\n        : 'An unexpected error occurred.';\r\n\r\n      if (Platform.OS === 'ios' || Platform.OS === 'android') {\r\n        Alert.alert('Login Failed', errorMessage);\r\n      } else {\r\n        setSuccessMessage(`Login Failed: ${errorMessage}`);\r\n      }\r\n\r\n      setEmailError('Invalid email or password');\r\n      setPasswordError('Invalid email or password');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // Add useEffect to handle document-wide keyboard events\r\n  useEffect(() => {\r\n    if (Platform.OS === 'web') {\r\n      const handleDocumentKeyPress = (e) => {\r\n        if (e.key === 'Enter') {\r\n          handleLogin();\r\n        }\r\n      };\r\n\r\n      document.addEventListener('keydown', handleDocumentKeyPress);\r\n\r\n      // Cleanup listener when component unmounts\r\n      return () => {\r\n        document.removeEventListener('keydown', handleDocumentKeyPress);\r\n      };\r\n    }\r\n  }, [email, password]); // Dependencies ensure we have latest state values\r\n\r\n  // Keep the existing handleKeyPress for input fields\r\n  const handleKeyPress = (e) => {\r\n    if (Platform.OS === 'web' && e.nativeEvent.key === 'Enter') {\r\n      handleLogin();\r\n    }\r\n  };\r\n\r\n  // Add this inside the SignIn component, after any existing useEffect\r\n  useEffect(() => {\r\n    // Check if we're on web and have an invitation token in the URL\r\n    if (Platform.OS === 'web') {\r\n      const url = window.location.pathname;\r\n      debugLog('MBA5555 SignIn screen - Current URL path:', url);\r\n      \r\n      if (url.includes('/invite/')) {\r\n        // Extract token and redirect to signup\r\n        const pathParts = url.split('/');\r\n        const inviteIndex = pathParts.findIndex(part => part === 'invite');\r\n        if (inviteIndex !== -1 && pathParts.length > inviteIndex + 1) {\r\n          const token = pathParts[inviteIndex + 1];\r\n          debugLog('MBA5555 SignIn detected invite token, redirecting to SignUp:', token);\r\n          // Navigate to SignUp with the token\r\n          navigation.navigate('SignUp', { token });\r\n        }\r\n      }\r\n    }\r\n  }, []);\r\n\r\n  const togglePasswordVisibility = () => {\r\n    setShowPassword(!showPassword);\r\n  };\r\n\r\n  return (\r\n    <View style={styles.container}>\r\n      <View style={styles.card}>\r\n        <Text style={styles.title}>Log in</Text>\r\n        \r\n        {is_prototype && (\r\n          <Text style={styles.prototypeWarning}>\r\n            Prototype Mode: You can sign in with anything for email and password\r\n          </Text>\r\n        )}\r\n        \r\n        <View style={styles.createAccountContainer}>\r\n          <Text style={styles.createAccountText}>Need a CrittrCove account?</Text>\r\n          <TouchableOpacity onPress={() => navigation.navigate('SignUp')}>\r\n            <Text style={styles.createAccountLink}>Create an account</Text>\r\n          </TouchableOpacity>\r\n        </View>\r\n        \r\n        <View style={styles.inputLabelContainer}>\r\n          <Text style={styles.inputLabel}>Username or Email</Text>\r\n          <TextInput\r\n            style={[styles.input, emailError ? styles.errorInput : null]}\r\n            value={email}\r\n            onChangeText={(text) => {\r\n              setEmail(text);\r\n              setEmailError('');\r\n            }}\r\n            autoCapitalize=\"none\"\r\n            onKeyPress={Platform.OS === 'web' ? handleKeyPress : undefined}\r\n          />\r\n          {emailError ? <Text style={styles.errorText}>{emailError}</Text> : null}\r\n        </View>\r\n        \r\n        <View style={styles.inputLabelContainer}>\r\n          <View style={styles.passwordLabelContainer}>\r\n            <Text style={styles.inputLabel}>Password</Text>\r\n            <TouchableOpacity onPress={togglePasswordVisibility}>\r\n              <Text style={styles.showHideText}>{showPassword ? 'Hide' : 'Show'}</Text>\r\n            </TouchableOpacity>\r\n          </View>\r\n          <TextInput\r\n            style={[styles.input, passwordError ? styles.errorInput : null]}\r\n            secureTextEntry={!showPassword}\r\n            value={password}\r\n            onChangeText={(text) => {\r\n              setPassword(text);\r\n              setPasswordError('');\r\n            }}\r\n            onKeyPress={Platform.OS === 'web' ? handleKeyPress : undefined}\r\n          />\r\n          {passwordError ? <Text style={styles.errorText}>{passwordError}</Text> : null}\r\n        </View>\r\n        \r\n        <View style={styles.rememberMeContainer}>\r\n          <TouchableOpacity \r\n            style={styles.checkbox} \r\n            onPress={() => setRememberMe(!rememberMe)}\r\n          >\r\n            {rememberMe && (\r\n              <View style={styles.checkboxInner}>\r\n                <MaterialCommunityIcons name=\"check\" size={14} color={theme.colors.whiteText} />\r\n              </View>\r\n            )}\r\n          </TouchableOpacity>\r\n          <Text style={styles.rememberMeText}>Keep me logged in</Text>\r\n        </View>\r\n        \r\n        <TouchableOpacity style={styles.loginButton} onPress={handleLogin}>\r\n          <Text style={styles.loginButtonText}>Log in</Text>\r\n        </TouchableOpacity>\r\n        \r\n        {loading && <ActivityIndicator size=\"large\" color={theme.colors.primary} />}\r\n        {successMessage ? <Text style={styles.message}>{successMessage}</Text> : null}\r\n        \r\n        <TouchableOpacity onPress={() => navigation.navigate('ResetPassword')} style={styles.forgotPasswordContainer}>\r\n          <Text style={styles.link}>Forgot Password?</Text>\r\n        </TouchableOpacity>\r\n      </View>\r\n    </View>\r\n  );\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    backgroundColor: theme.colors.background,\r\n    padding: theme.spacing.medium,\r\n  },\r\n  card: {\r\n    backgroundColor: theme.colors.surfaceContrast,\r\n    borderRadius: 8,\r\n    padding: theme.spacing.large * 1.5,\r\n    width: '100%',\r\n    maxWidth: 480,\r\n    shadowColor: '#000',\r\n    shadowOffset: { width: 0, height: 2 },\r\n    shadowOpacity: 0.1,\r\n    shadowRadius: 4,\r\n    elevation: 3,\r\n  },\r\n  title: {\r\n    fontSize: theme.fontSizes.extraLarge * 1.4,\r\n    fontWeight: 'bold',\r\n    color: theme.colors.text,\r\n    marginBottom: theme.spacing.medium,\r\n    textAlign: 'left',\r\n  },\r\n  createAccountContainer: {\r\n    flexDirection: 'row',\r\n    marginBottom: theme.spacing.large,\r\n  },\r\n  createAccountText: {\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.text,\r\n    marginRight: 5,\r\n  },\r\n  createAccountLink: {\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.primary,\r\n    textDecorationLine: 'underline',\r\n  },\r\n  inputLabelContainer: {\r\n    marginBottom: theme.spacing.medium,\r\n  },\r\n  inputLabel: {\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.text,\r\n    marginBottom: theme.spacing.small,\r\n    fontWeight: '500',\r\n  },\r\n  passwordLabelContainer: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    marginBottom: theme.spacing.small,\r\n  },\r\n  showHideText: {\r\n    color: theme.colors.primary,\r\n    fontSize: theme.fontSizes.smallMedium,\r\n  },\r\n  input: {\r\n    height: 48,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    borderRadius: 4,\r\n    paddingHorizontal: theme.spacing.small * 1.5,\r\n    fontSize: theme.fontSizes.medium,\r\n    backgroundColor: theme.colors.surfaceContrast,\r\n  },\r\n  errorInput: {\r\n    borderColor: theme.colors.error,\r\n  },\r\n  errorText: {\r\n    color: theme.colors.error,\r\n    fontSize: theme.fontSizes.smallMedium,\r\n    marginTop: 4,\r\n  },\r\n  rememberMeContainer: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    marginBottom: theme.spacing.large,\r\n  },\r\n  checkbox: {\r\n    width: 20,\r\n    height: 20,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    borderRadius: 2,\r\n    marginRight: 10,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n  },\r\n  checkboxInner: {\r\n    width: 20,\r\n    height: 20,\r\n    backgroundColor: theme.colors.primary,\r\n    borderRadius: 2,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n  },\r\n  rememberMeText: {\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.text,\r\n  },\r\n  loginButton: {\r\n    backgroundColor: theme.colors.primary,\r\n    paddingVertical: theme.spacing.small * 1.75,\r\n    borderRadius: 4,\r\n    alignItems: 'center',\r\n    marginBottom: theme.spacing.medium,\r\n  },\r\n  loginButtonText: {\r\n    color: theme.colors.whiteText,\r\n    fontSize: theme.fontSizes.medium,\r\n    fontWeight: '500',\r\n  },\r\n  forgotPasswordContainer: {\r\n    alignItems: 'center',\r\n    marginTop: theme.spacing.small,\r\n  },\r\n  link: {\r\n    color: theme.colors.primary,\r\n    fontSize: theme.fontSizes.smallMedium,\r\n  },\r\n  message: {\r\n    marginTop: theme.spacing.small,\r\n    color: theme.colors.error,\r\n    fontSize: theme.fontSizes.smallMedium,\r\n    textAlign: 'center',\r\n  },\r\n  prototypeWarning: {\r\n    backgroundColor: '#FFF3CD',\r\n    color: '#856404',\r\n    padding: theme.spacing.small * 1.5,\r\n    marginBottom: theme.spacing.medium,\r\n    borderRadius: 4,\r\n    textAlign: 'center',\r\n  },\r\n});\r\n","import React, { useState, useContext, useEffect } from 'react';\r\nimport { View, TextInput, Text, StyleSheet, ActivityIndicator, Dimensions, KeyboardAvoidingView, Platform, ScrollView, Alert, TouchableOpacity } from 'react-native';\r\nimport axios from 'axios';\r\nimport { useNavigation, useRoute } from '@react-navigation/native';\r\nimport { theme } from '../styles/theme';\r\nimport CustomButton from '../components/CustomButton';\r\nimport { API_BASE_URL } from '../config/config';\r\nimport { AuthContext, debugLog } from '../context/AuthContext'; // Import AuthContext\r\nimport { validateEmail, validateName, validatePassword, validatePasswordMatch } from '../validation/validation';\r\nimport { verifyInvitation } from '../api/API';\r\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\r\n\r\nconst { width: screenWidth } = Dimensions.get('window');\r\n\r\nexport default function SignUp() {\r\n  const navigation = useNavigation();\r\n  const route = useRoute();\r\n  const { signIn, is_DEBUG } = useContext(AuthContext); // Use AuthContext to update auth state\r\n\r\n  const [firstName, setFirstName] = useState('');\r\n  const [lastName, setLastName] = useState('');\r\n  const [email, setEmail] = useState('');\r\n  const [password, setPassword] = useState('');\r\n  const [confirmPassword, setConfirmPassword] = useState('');\r\n  const [loading, setLoading] = useState(false);\r\n  const [successMessage, setSuccessMessage] = useState('');\r\n  const [inviterName, setInviterName] = useState('');\r\n  const [inviteToken, setInviteToken] = useState(null);\r\n  const [inviteVerified, setInviteVerified] = useState(false);\r\n  const [verifyingInvite, setVerifyingInvite] = useState(false);\r\n  \r\n  // Location state\r\n  const [location, setLocation] = useState('');\r\n  const [showLocationDropdown, setShowLocationDropdown] = useState(false);\r\n  const [locationError, setLocationError] = useState('');\r\n  const [locations, setLocations] = useState([]);\r\n  const [loadingLocations, setLoadingLocations] = useState(true);\r\n  \r\n  // Fallback locations in case API fails\r\n  const fallbackLocations = [\r\n    { name: 'Colorado Springs', supported: true },\r\n    { name: 'Denver', supported: false },\r\n    { name: 'Other', supported: false }\r\n  ];\r\n  \r\n  // Validation states\r\n  const [firstNameError, setFirstNameError] = useState('');\r\n  const [lastNameError, setLastNameError] = useState('');\r\n  const [emailError, setEmailError] = useState('');\r\n  const [passwordError, setPasswordError] = useState('');\r\n  const [confirmPasswordError, setConfirmPasswordError] = useState('');\r\n\r\n  // Check for invitation token when component mounts\r\n  useEffect(() => {\r\n    // Check if we have an invitation token in the route params or URL\r\n    const checkInvitation = async () => {\r\n      try {\r\n        // First check if we're on the 'Invite' screen\r\n        const isInviteScreen = route.name === 'Invite';\r\n        debugLog('MBA4321 Current route name:', route.name);\r\n        \r\n        // Check route params\r\n        let token = route.params?.token;\r\n        debugLog('MBA4321 Token from route params:', token);\r\n        \r\n        // If not in route params, check if we're on web and have it in the URL\r\n        if (!token && Platform.OS === 'web') {\r\n          const url = window.location.pathname;\r\n          debugLog('MBA4321 Current URL path:', url);\r\n          debugLog('MBA4321 Full location object:', {\r\n            pathname: window.location.pathname,\r\n            href: window.location.href,\r\n            search: window.location.search,\r\n            hash: window.location.hash\r\n          });\r\n          \r\n          if (url.includes('/invite/')) {\r\n            // Extract token from invite URL format\r\n            const pathParts = url.split('/');\r\n            const inviteIndex = pathParts.findIndex(part => part === 'invite');\r\n            if (inviteIndex !== -1 && pathParts.length > inviteIndex + 1) {\r\n              token = pathParts[inviteIndex + 1];\r\n              debugLog('MBA4321 Found invitation token from invite URL path:', token);\r\n            }\r\n          } else if (url.includes('/signup/')) {\r\n            // Extract token from signup URL format\r\n            const pathParts = url.split('/');\r\n            const signupIndex = pathParts.findIndex(part => part === 'signup');\r\n            if (signupIndex !== -1 && pathParts.length > signupIndex + 1) {\r\n              token = pathParts[signupIndex + 1];\r\n              debugLog('MBA4321 Found invitation token from signup URL path:', token);\r\n            }\r\n          }\r\n        }\r\n        \r\n        // If we still don't have a token, check the URL search params\r\n        if (!token && Platform.OS === 'web') {\r\n          const searchParams = new URLSearchParams(window.location.search);\r\n          const searchToken = searchParams.get('token');\r\n          if (searchToken) {\r\n            token = searchToken;\r\n            debugLog('MBA4321 Found invitation token from URL search params:', token);\r\n          }\r\n        }\r\n        \r\n        if (token) {\r\n          debugLog('MBA4321 Processing invitation token:', token);\r\n          setInviteToken(token);\r\n          setVerifyingInvite(true);\r\n          \r\n          try {\r\n            // Verify the token with the backend\r\n            const inviteInfo = await verifyInvitation(token);\r\n            debugLog('MBA4321 Invitation verification result:', inviteInfo);\r\n            \r\n            if (inviteInfo.valid) {\r\n              setInviteVerified(true);\r\n              setInviterName(inviteInfo.inviter_name);\r\n              \r\n              // If it's an email invitation, set the email field\r\n              if (inviteInfo.email) {\r\n                setEmail(inviteInfo.email);\r\n              }\r\n              \r\n              setSuccessMessage(`You've been invited by ${inviteInfo.inviter_name}!`);\r\n            } else {\r\n              setSuccessMessage(`This invitation is no longer valid: ${inviteInfo.error}`);\r\n            }\r\n          } catch (error) {\r\n            debugLog('MBA4321 Error verifying invitation:', error);\r\n            setSuccessMessage('This invitation link is invalid or has expired.');\r\n          } finally {\r\n            setVerifyingInvite(false);\r\n          }\r\n        }\r\n      } catch (error) {\r\n        debugLog('MBA4321 Error processing invitation:', error);\r\n        setVerifyingInvite(false);\r\n      }\r\n    };\r\n    \r\n    checkInvitation();\r\n  }, [route.params, route.name]);\r\n\r\n  // Fetch supported locations from backend\r\n  useEffect(() => {\r\n    const fetchLocations = async () => {\r\n      setLoadingLocations(true);\r\n      try {\r\n        // Fetch locations from backend\r\n        const response = await axios.get(`${API_BASE_URL}/api/locations/v1/supported/`);\r\n        debugLog('MBA6789: Locations fetched from backend', response.data);\r\n        \r\n        if (response.data && Array.isArray(response.data.locations)) {\r\n          setLocations(response.data.locations);\r\n        } else {\r\n          // Fallback to hardcoded locations if response format is unexpected\r\n          debugLog('MBA6789: Using fallback locations due to unexpected response format', response.data);\r\n          setLocations(fallbackLocations);\r\n        }\r\n      } catch (error) {\r\n        debugLog('MBA6789: Error fetching locations', error);\r\n        // Use fallback locations if API call fails\r\n        setLocations(fallbackLocations);\r\n      } finally {\r\n        setLoadingLocations(false);\r\n      }\r\n    };\r\n    \r\n    fetchLocations();\r\n  }, []);\r\n\r\n  const validateForm = () => {\r\n    let isValid = true;\r\n    \r\n    // Validate location only if not invited\r\n    if (!inviteVerified && !location) {\r\n      setLocationError('Please select your location');\r\n      isValid = false;\r\n    }\r\n    \r\n    // Validate first name\r\n    const firstNameValidation = validateName(firstName);\r\n    setFirstNameError(firstNameValidation.message);\r\n    if (!firstNameValidation.isValid) isValid = false;\r\n    \r\n    // Validate last name\r\n    const lastNameValidation = validateName(lastName);\r\n    setLastNameError(lastNameValidation.message);\r\n    if (!lastNameValidation.isValid) isValid = false;\r\n    \r\n    // Validate email\r\n    const emailValidation = validateEmail(email);\r\n    setEmailError(emailValidation.message);\r\n    if (!emailValidation.isValid) isValid = false;\r\n    \r\n    // Validate password\r\n    const passwordValidation = validatePassword(password);\r\n    setPasswordError(passwordValidation.message);\r\n    if (!passwordValidation.isValid) isValid = false;\r\n    \r\n    // Validate password match\r\n    const passwordMatchValidation = validatePasswordMatch(password, confirmPassword);\r\n    setConfirmPasswordError(passwordMatchValidation.message);\r\n    if (!passwordMatchValidation.isValid) isValid = false;\r\n    \r\n    return isValid;\r\n  };\r\n\r\n  const handleSignUp = async () => {\r\n    // Validate form before proceeding\r\n    if (!validateForm()) {\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    try {\r\n      debugLog('MBA12345 Starting user registration process');\r\n      \r\n      // Get user's timezone and time format preferences\r\n      let userTimezone = 'UTC';\r\n      try {\r\n        // Try to get the timezone using Intl API\r\n        userTimezone = Intl.DateTimeFormat().resolvedOptions().timeZone;\r\n        debugLog('MBA12345 User timezone detected using Intl API', { userTimezone });\r\n      } catch (error) {\r\n        debugLog('MBA12345 Error detecting timezone using Intl API', error);\r\n        // Fallback to a default timezone\r\n        userTimezone = 'UTC';\r\n      }\r\n      \r\n      const useMilitaryTime = false; // Default to non-military time\r\n      \r\n      debugLog('MBA12345 User timezone and preferences', { userTimezone, useMilitaryTime });\r\n      \r\n      // Prepare user data with time settings and invitation token\r\n      const registrationData = {\r\n        ...userData,\r\n        timezone: userTimezone,\r\n        use_military_time: useMilitaryTime,\r\n        invitation_token: inviteToken\r\n      };\r\n      \r\n      // First register the user\r\n      const registerResponse = await axios.post(`${API_BASE_URL}/api/users/v1/register/`, registrationData);\r\n      \r\n      debugLog('MBA12345 User registration successful', registerResponse.data);\r\n      \r\n      // After successful registration, log the user in to get authentication tokens\r\n      debugLog('MBA12345 Attempting to log in with new credentials');\r\n      \r\n      const loginResponse = await axios.post(`${API_BASE_URL}/api/token/`, {\r\n        email: email.toLowerCase(),\r\n        password: password,\r\n      });\r\n      \r\n      debugLog('MBA12345 Login successful, received tokens');\r\n      \r\n      const { access, refresh } = loginResponse.data;\r\n      \r\n      // Use the signIn function from AuthContext to properly set up authentication\r\n      debugLog('MBA12345 Calling signIn function from AuthContext');\r\n      \r\n      await signIn(access, refresh);\r\n      \r\n      debugLog('MBA12345 Authentication setup complete');\r\n      \r\n      // If the user came from an invitation, accept the invitation\r\n      if (inviteToken && inviteVerified) {\r\n        try {\r\n          await axios.post(\r\n            `${API_BASE_URL}/api/users/v1/invitations/${inviteToken}/accept/`,\r\n            {},\r\n            {\r\n              headers: {\r\n                Authorization: `Bearer ${access}`,\r\n                'Content-Type': 'application/json'\r\n              }\r\n            }\r\n          );\r\n          debugLog('MBA12345 Invitation accepted successfully');\r\n        } catch (error) {\r\n          debugLog('MBA12345 Error accepting invitation:', error);\r\n          // Continue even if this fails\r\n        }\r\n      }\r\n      \r\n      if (Platform.OS === 'ios' || Platform.OS === 'android') {\r\n        Alert.alert('Success', 'Account created successfully!', [\r\n          { text: 'OK', onPress: () => navigation.navigate('MyProfile') }\r\n        ]);\r\n      } else {\r\n        navigation.navigate('MyProfile');\r\n      }\r\n    } catch (error) {\r\n      debugLog('MBA12345 Error during signup process', error.response?.data || error.message);\r\n      \r\n      let errorMessage = 'Signup Failed: An error occurred during signup.';\r\n      if (error.response) {\r\n        const errorData = error.response.data;\r\n        // Handle specific field errors\r\n        if (errorData) {\r\n          const firstError = Object.entries(errorData)[0];\r\n          if (firstError) {\r\n            const [field, messages] = firstError;\r\n            errorMessage = `${field}: ${Array.isArray(messages) ? messages[0] : messages}`;\r\n          }\r\n        }\r\n      }\r\n      if (Platform.OS === 'ios' || Platform.OS === 'android') {\r\n        Alert.alert('Error', errorMessage);\r\n      } else {\r\n        setSuccessMessage(errorMessage);\r\n      }\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // Navigate to the sign in page\r\n  const navigateToSignIn = () => {\r\n    navigation.navigate('SignIn');\r\n  };\r\n\r\n  // Navigate to the waitlist page\r\n  const navigateToWaitlist = () => {\r\n    navigation.navigate('Waitlist');\r\n  };\r\n\r\n  // Handle location selection \r\n  const selectLocation = (selectedLocation) => {\r\n    console.log(\"Location selected:\", selectedLocation);\r\n    debugLog('MBA6789: Location selected', selectedLocation);\r\n    setLocation(selectedLocation);\r\n    setShowLocationDropdown(false);\r\n    setLocationError('');\r\n  };\r\n\r\n  // Updated data structure to match new backend expectations\r\n  const userData = {\r\n    name: `${firstName.trim().charAt(0).toUpperCase() + firstName.trim().slice(1).toLowerCase()} ${lastName.trim().charAt(0).toUpperCase() + lastName.trim().slice(1).toLowerCase()}`, // Combine first and last name with first letter capitalized and all other letters lowercase\r\n    email: email.trim().toLowerCase(),\r\n    password: password,\r\n    password2: confirmPassword, // Add confirmation password\r\n    phone_number: '', // Add empty phone number for now\r\n    location: inviteVerified ? 'Colorado Springs' : location, // Use default location for invited users\r\n    ...(inviteToken && { invitation_token: inviteToken }) // Only include invitation_token if it exists\r\n  };\r\n\r\n  return (\r\n    <KeyboardAvoidingView\r\n      style={styles.container}\r\n      behavior={Platform.OS === 'ios' ? 'padding' : 'height'}\r\n      keyboardVerticalOffset={Platform.OS === 'ios' ? 64 : 0}\r\n    >\r\n      <ScrollView contentContainerStyle={styles.scrollContainer}>\r\n        <View style={styles.formContainer}>\r\n          <Text style={styles.title}>Sign Up</Text>\r\n          <Text style={styles.subtitle}>Sign up to continue</Text>\r\n          \r\n          {verifyingInvite && (\r\n            <View style={styles.inviteContainer}>\r\n              <ActivityIndicator size=\"small\" color={theme.colors.primary} />\r\n              <Text style={styles.inviteText}>Verifying invitation...</Text>\r\n            </View>\r\n          )}\r\n          \r\n          {inviteVerified && (\r\n            <View style={styles.inviteContainer}>\r\n              <Text style={styles.inviteText}>\r\n                You've been invited by {inviterName}!\r\n              </Text>\r\n            </View>\r\n          )}\r\n          \r\n          {/* Location Dropdown - Only show if not invited */}\r\n          {!inviteVerified && (\r\n            <View style={styles.locationContainer}>\r\n              <Text style={styles.label}>Where are you located?</Text>\r\n              {loadingLocations ? (\r\n                <View style={[styles.input, styles.dropdown, styles.loadingContainer]}>\r\n                  <ActivityIndicator size=\"small\" color={theme.colors.primary} />\r\n                  <Text style={styles.placeholderText}>Loading locations...</Text>\r\n                </View>\r\n              ) : (\r\n                <View style={styles.dropdownWrapper}>\r\n                  <TouchableOpacity\r\n                    style={[\r\n                      styles.input,\r\n                      styles.dropdown,\r\n                      locationError ? styles.errorInput : null\r\n                    ]}\r\n                    onPress={() => setShowLocationDropdown(!showLocationDropdown)}\r\n                  >\r\n                    <Text style={location ? styles.inputText : styles.placeholderText}>\r\n                      {location || 'Select your location'}\r\n                    </Text>\r\n                    <MaterialCommunityIcons\r\n                      name={showLocationDropdown ? \"chevron-up\" : \"chevron-down\"}\r\n                      size={24}\r\n                      color={theme.colors.text}\r\n                    />\r\n                  </TouchableOpacity>\r\n                  \r\n                  {showLocationDropdown && (\r\n                    <View style={styles.dropdownMenu}>\r\n                      {locations.map((loc) => (\r\n                        <TouchableOpacity\r\n                          key={loc.name}\r\n                          style={styles.dropdownItem}\r\n                          onPress={() => selectLocation(loc.name)}\r\n                        >\r\n                          <Text style={styles.dropdownItemText}>\r\n                            {loc.name} {!loc.supported && \"(Coming Soon)\"}\r\n                          </Text>\r\n                        </TouchableOpacity>\r\n                      ))}\r\n                    </View>\r\n                  )}\r\n                </View>\r\n              )}\r\n              {locationError ? <Text style={styles.errorText}>{locationError}</Text> : null}\r\n            </View>\r\n          )}\r\n          \r\n          {/* Regular form fields */}\r\n          {(inviteVerified || !location || locations.find(loc => loc.name === location && loc.supported)) ? (\r\n            <>\r\n              <View style={styles.inputContainer}>\r\n                <TextInput\r\n                  style={[styles.input, firstNameError ? styles.errorInput : null]}\r\n                  placeholder=\"First Name\"\r\n                  value={firstName}\r\n                  onChangeText={(text) => {\r\n                    setFirstName(text);\r\n                    setFirstNameError('');\r\n                  }}\r\n                />\r\n                {firstNameError ? <Text style={styles.errorText}>{firstNameError}</Text> : null}\r\n              </View>\r\n              \r\n              <View style={styles.inputContainer}>\r\n                <TextInput\r\n                  style={[styles.input, lastNameError ? styles.errorInput : null]}\r\n                  placeholder=\"Last Name\"\r\n                  value={lastName}\r\n                  onChangeText={(text) => {\r\n                    setLastName(text);\r\n                    setLastNameError('');\r\n                  }}\r\n                />\r\n                {lastNameError ? <Text style={styles.errorText}>{lastNameError}</Text> : null}\r\n              </View>\r\n              \r\n              <View style={styles.inputContainer}>\r\n                <TextInput\r\n                  style={[styles.input, emailError ? styles.errorInput : null]}\r\n                  placeholder=\"Email\"\r\n                  value={email}\r\n                  onChangeText={(text) => {\r\n                    setEmail(text);\r\n                    setEmailError('');\r\n                  }}\r\n                  keyboardType=\"email-address\"\r\n                  autoCapitalize=\"none\"\r\n                  editable={true}\r\n                />\r\n                {emailError ? <Text style={styles.errorText}>{emailError}</Text> : null}\r\n              </View>\r\n              \r\n              <View style={styles.inputContainer}>\r\n                <TextInput\r\n                  style={[styles.input, passwordError ? styles.errorInput : null]}\r\n                  placeholder=\"Password\"\r\n                  value={password}\r\n                  onChangeText={(text) => {\r\n                    setPassword(text);\r\n                    setPasswordError('');\r\n                  }}\r\n                  secureTextEntry\r\n                />\r\n                {passwordError ? <Text style={styles.errorText}>{passwordError}</Text> : null}\r\n              </View>\r\n              \r\n              <View style={styles.inputContainer}>\r\n                <TextInput\r\n                  style={[styles.input, confirmPasswordError ? styles.errorInput : null]}\r\n                  placeholder=\"Confirm Password\"\r\n                  value={confirmPassword}\r\n                  onChangeText={(text) => {\r\n                    setConfirmPassword(text);\r\n                    setConfirmPasswordError('');\r\n                  }}\r\n                  secureTextEntry\r\n                />\r\n                {confirmPasswordError ? <Text style={styles.errorText}>{confirmPasswordError}</Text> : null}\r\n              </View>\r\n              \r\n              <CustomButton title=\"Sign Up\" onPress={handleSignUp} style={styles.signupButton} />\r\n            </>\r\n          ) : (\r\n            /* Show waitlist button if unsupported location is selected */\r\n            <View style={styles.waitlistContainer}>\r\n              <Text style={styles.waitlistMessage}>\r\n                CrittrCove isn't available in {location} yet, but we're expanding soon!\r\n              </Text>\r\n              <Text style={styles.waitlistSubMessage}>\r\n                Join our waitlist to be notified when we launch in your area.\r\n              </Text>\r\n              <CustomButton\r\n                title=\"Join Waitlist\"\r\n                onPress={navigateToWaitlist}\r\n                style={styles.waitlistButton}\r\n              />\r\n            </View>\r\n          )}\r\n          \r\n          {loading && <ActivityIndicator size=\"large\" color={theme.colors.primary} style={styles.loader} />}\r\n          {successMessage ? <Text style={styles.message}>{successMessage}</Text> : null}\r\n        </View>\r\n        \r\n        {/* Sign In Link */}\r\n        <View style={styles.signInContainer}>\r\n          <Text style={styles.signInText}>Already have an account? </Text>\r\n          <TouchableOpacity onPress={navigateToSignIn}>\r\n            <Text style={styles.signInLink}>Sign in</Text>\r\n          </TouchableOpacity>\r\n        </View>\r\n      </ScrollView>\r\n    </KeyboardAvoidingView>\r\n  );\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    backgroundColor: theme.colors.background,\r\n  },\r\n  scrollContainer: {\r\n    padding: 20,\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    minHeight: '100%',\r\n  },\r\n  formContainer: {\r\n    backgroundColor: theme.colors.surfaceContrast,\r\n    padding: 30,\r\n    borderRadius: 10,\r\n    width: '100%',\r\n    maxWidth: 500,\r\n    alignItems: 'center',\r\n    shadowColor: '#000',\r\n    shadowOffset: { width: 0, height: 2 },\r\n    shadowOpacity: 0.1,\r\n    shadowRadius: 4,\r\n    elevation: 3,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n  },\r\n  title: {\r\n    fontSize: 32,\r\n    color: theme.colors.text,\r\n    marginBottom: 8,\r\n    fontWeight: 'bold',\r\n    textAlign: 'center',\r\n  },\r\n  subtitle: {\r\n    color: theme.colors.text,\r\n    fontSize: 16,\r\n    marginBottom: 24,\r\n    textAlign: 'center',\r\n  },\r\n  inputContainer: {\r\n    width: '100%',\r\n    marginBottom: 16,\r\n  },\r\n  input: {\r\n    width: '100%',\r\n    height: 50,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    borderRadius: 5,\r\n    paddingHorizontal: 10,\r\n    backgroundColor: theme.colors.surface,\r\n    fontSize: 16,\r\n  },\r\n  errorInput: {\r\n    borderColor: theme.colors.error,\r\n  },\r\n  errorText: {\r\n    color: theme.colors.error,\r\n    fontSize: 12,\r\n    marginTop: 5,\r\n  },\r\n  message: {\r\n    marginTop: 20,\r\n    color: theme.colors.text,\r\n    textAlign: 'center',\r\n    fontSize: 16,\r\n  },\r\n  inviteContainer: {\r\n    marginBottom: 20,\r\n    padding: 16,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.primary,\r\n    borderRadius: 8,\r\n    alignItems: 'center',\r\n    backgroundColor: '#f0f9ff',\r\n    width: '100%',\r\n    flexDirection: 'row',\r\n    justifyContent: 'center',\r\n  },\r\n  inviteText: {\r\n    color: theme.colors.primary,\r\n    fontSize: 16,\r\n    marginLeft: 8,\r\n    fontWeight: '500',\r\n    textAlign: 'center',\r\n  },\r\n  signupButton: {\r\n    marginTop: 24,\r\n    width: '100%',\r\n  },\r\n  loader: {\r\n    marginTop: 20,\r\n  },\r\n  signInContainer: {\r\n    flexDirection: 'row',\r\n    marginTop: 24,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n  },\r\n  signInText: {\r\n    color: theme.colors.text,\r\n    fontSize: 16,\r\n  },\r\n  signInLink: {\r\n    color: theme.colors.primary,\r\n    fontSize: 16,\r\n    fontWeight: '600',\r\n  },\r\n  dropdown: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    height: 50,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    borderRadius: 5,\r\n    paddingHorizontal: 10,\r\n    backgroundColor: theme.colors.surface,\r\n  },\r\n  placeholderText: {\r\n    color: theme.colors.placeHolderText,\r\n    fontSize: 16,\r\n  },\r\n  inputText: {\r\n    color: theme.colors.text,\r\n    fontSize: 16,\r\n  },\r\n  dropdownMenu: {\r\n    position: 'absolute',\r\n    top: '100%',\r\n    left: 0,\r\n    right: 0,\r\n    zIndex: 1002,\r\n    marginTop: 4,\r\n    maxHeight: 200,\r\n    backgroundColor: theme.colors.surface,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    borderRadius: 5,\r\n    shadowColor: '#000',\r\n    shadowOffset: { width: 0, height: 2 },\r\n    shadowOpacity: 0.1,\r\n    shadowRadius: 4,\r\n    elevation: 3,\r\n  },\r\n  dropdownItem: {\r\n    padding: 12,\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: theme.colors.border,\r\n  },\r\n  dropdownItemText: {\r\n    color: theme.colors.text,\r\n    fontSize: 16,\r\n  },\r\n  label: {\r\n    color: theme.colors.text,\r\n    fontSize: 16,\r\n    marginBottom: 8,\r\n  },\r\n  locationContainer: {\r\n    width: '100%',\r\n    marginBottom: 16,\r\n    position: 'relative',\r\n    zIndex: 1000,\r\n  },\r\n  dropdownWrapper: {\r\n    position: 'relative',\r\n    zIndex: 1001,\r\n  },\r\n  loadingContainer: {\r\n    justifyContent: 'center',\r\n  },\r\n  waitlistContainer: {\r\n    marginTop: 20,\r\n    padding: 20,\r\n    borderRadius: 8,\r\n    alignItems: 'center',\r\n    width: '100%',\r\n    backgroundColor: '#f0f9ff',\r\n    borderWidth: 1,\r\n    borderColor: '#e0e7ff',\r\n    shadowColor: '#000',\r\n    shadowOffset: { width: 0, height: 1 },\r\n    shadowOpacity: 0.05,\r\n    shadowRadius: 2,\r\n    elevation: 2,\r\n  },\r\n  waitlistMessage: {\r\n    color: theme.colors.text,\r\n    fontSize: 18,\r\n    fontWeight: '600',\r\n    marginBottom: 16,\r\n    textAlign: 'center',\r\n  },\r\n  waitlistSubMessage: {\r\n    color: theme.colors.text,\r\n    fontSize: 16,\r\n    textAlign: 'center',\r\n    marginBottom: 8,\r\n  },\r\n  waitlistButton: {\r\n    marginTop: 24,\r\n    width: '100%',\r\n    backgroundColor: '#6B7280',\r\n  },\r\n});","import React, { useState, useContext } from 'react';\r\nimport { View, TextInput, Text, StyleSheet, Alert, ActivityIndicator, Dimensions, Platform, SafeAreaView, TouchableOpacity } from 'react-native';\r\nimport { theme } from '../styles/theme';\r\nimport { useNavigation } from '@react-navigation/native';\r\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\r\nimport { AuthContext } from '../context/AuthContext';\r\nimport CustomButton from '../components/CustomButton';\r\nimport axios from 'axios';\r\nimport { API_BASE_URL } from '../config/config';\r\n\r\nconst { width: screenWidth } = Dimensions.get('window');\r\n\r\nexport default function ResetPassword() {\r\n  const [email, setEmail] = useState('');\r\n  const [emailError, setEmailError] = useState(false);\r\n  const [loading, setLoading] = useState(false);\r\n  const [successMessage, setSuccessMessage] = useState('');\r\n  const navigation = useNavigation();\r\n  const { screenWidth: contextScreenWidth, isCollapsed, isSignedIn } = useContext(AuthContext);\r\n\r\n  const handleResetPassword = async () => {\r\n    if (!email) {\r\n      if (Platform.OS === 'ios' || Platform.OS === 'android') {\r\n        Alert.alert('Error', 'Please enter your email address.');\r\n      } else {\r\n        setSuccessMessage('Error: Please enter your email address.');\r\n      }\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    try {\r\n      const response = await axios.post(`${API_BASE_URL}/api/users/v1/reset-password/`, { email });\r\n      if (Platform.OS === 'ios' || Platform.OS === 'android') {\r\n        Alert.alert('Success', 'A reset password link has been sent to your email.', [\r\n          { text: 'OK', onPress: () => navigation.navigate('SignIn') }\r\n        ]);\r\n      } else {\r\n        setSuccessMessage('A reset password link has been sent to your email.');\r\n        setTimeout(() => {\r\n          navigation.navigate('SignIn');\r\n        }, 2000);\r\n      }\r\n    } catch (error) {\r\n      if (error.response && error.response.status === 404) {\r\n        setEmailError(true);\r\n        if (Platform.OS === 'ios' || Platform.OS === 'android') {\r\n          Alert.alert('Error', 'Email is not associated with any user.');\r\n        } else {\r\n          setSuccessMessage('Error: Email is not associated with any user.');\r\n        }\r\n      } else {\r\n        if (Platform.OS === 'ios' || Platform.OS === 'android') {\r\n          Alert.alert('Error', 'Failed to send reset password email. Please try again later.');\r\n        } else {\r\n          setSuccessMessage('Error: Failed to send reset password email. Please try again later.');\r\n        }\r\n      }\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const styles = createStyles(contextScreenWidth, isCollapsed, isSignedIn);\r\n\r\n  return (\r\n    <View style={styles.container}>\r\n      <SafeAreaView style={styles.safeArea}>\r\n        <View style={styles.content}>\r\n          {isSignedIn && (\r\n            <TouchableOpacity onPress={() => navigation.navigate('ChangePassword')} style={styles.backButton}>\r\n              <MaterialCommunityIcons name=\"arrow-left\" size={24} color={theme.colors.text} />\r\n              <Text style={styles.backText}>Reset Password</Text>\r\n            </TouchableOpacity>\r\n          )}\r\n          \r\n          <View style={styles.card}>\r\n            <Text style={styles.title}>Reset Password</Text>\r\n            \r\n            <TextInput\r\n              style={[styles.input, emailError && styles.inputError]}\r\n              placeholder=\"Email\"\r\n              value={email}\r\n              onChangeText={(text) => {\r\n                setEmail(text);\r\n                setEmailError(false);\r\n                setSuccessMessage('');\r\n              }}\r\n              keyboardType=\"email-address\"\r\n              autoCapitalize=\"none\"\r\n              placeholderTextColor={theme.colors.placeHolderText}\r\n            />\r\n            \r\n            <CustomButton \r\n              title=\"Reset Password\" \r\n              onPress={handleResetPassword}\r\n              disabled={loading}\r\n              style={styles.button}\r\n            />\r\n            \r\n            {loading && <ActivityIndicator size=\"large\" color={theme.colors.primary} style={styles.loader} />}\r\n            {successMessage ? <Text style={[styles.message, successMessage.includes('Error') && styles.errorMessage]}>{successMessage}</Text> : null}\r\n          </View>\r\n        </View>\r\n      </SafeAreaView>\r\n    </View>\r\n  );\r\n}\r\n\r\nconst createStyles = (screenWidth, isCollapsed, isSignedIn) => StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    backgroundColor: theme.colors.background,\r\n    marginLeft: (screenWidth > 900 && isSignedIn) ? (isCollapsed ? 70 : 250) : 0,\r\n    transition: 'margin-left 0.3s ease',\r\n  },\r\n  safeArea: {\r\n    flex: 1,\r\n    paddingTop: Platform.OS === 'android' ? 20 : 0,\r\n  },\r\n  content: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    padding: 20,\r\n  },\r\n  backButton: {\r\n    position: 'absolute',\r\n    top: 20,\r\n    left: 20,\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    zIndex: 1,\r\n  },\r\n  backText: {\r\n    marginLeft: 8,\r\n    fontSize: 18,\r\n    fontWeight: '600',\r\n    color: theme.colors.text,\r\n  },\r\n  card: {\r\n    backgroundColor: theme.colors.surfaceContrast,\r\n    borderRadius: 12,\r\n    padding: 40,\r\n    width: '100%',\r\n    maxWidth: 400,\r\n    shadowColor: '#000',\r\n    shadowOffset: {\r\n      width: 0,\r\n      height: 2,\r\n    },\r\n    shadowOpacity: 0.1,\r\n    shadowRadius: 8,\r\n    elevation: 5,\r\n  },\r\n  title: {\r\n    fontSize: 28,\r\n    fontWeight: '600',\r\n    color: theme.colors.text,\r\n    textAlign: 'center',\r\n    marginBottom: 30,\r\n  },\r\n  input: {\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 8,\r\n    padding: 15,\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    marginBottom: 20,\r\n  },\r\n  inputError: {\r\n    borderColor: theme.colors.error,\r\n  },\r\n  button: {\r\n    marginBottom: 20,\r\n  },\r\n  loader: {\r\n    marginTop: 10,\r\n  },\r\n  message: {\r\n    textAlign: 'center',\r\n    color: theme.colors.primary,\r\n    fontSize: 14,\r\n    marginTop: 10,\r\n  },\r\n  errorMessage: {\r\n    color: theme.colors.error,\r\n  },\r\n});\r\n","import React, { useState } from 'react';\r\nimport { View, TextInput, Text, StyleSheet, ActivityIndicator, Dimensions, Alert, Platform } from 'react-native';\r\nimport { useNavigation } from '@react-navigation/native';\r\nimport { theme } from '../styles/theme';\r\nimport CustomButton from '../components/CustomButton';\r\nimport axios from 'axios';\r\nimport { API_BASE_URL } from '../config/config';\r\nimport { navigateToFrom } from '../components/Navigation';\r\n\r\nconst { width: screenWidth } = Dimensions.get('window');\r\n\r\nexport default function ResetPasswordConfirm({ route }) {\r\n  const { uid, token } = route.params;\r\n  const [newPassword, setNewPassword] = useState('');\r\n  const [confirmPassword, setConfirmPassword] = useState('');\r\n  const [loading, setLoading] = useState(false);\r\n  const [successMessage, setSuccessMessage] = useState('');\r\n  const navigation = useNavigation();\r\n\r\n  const handlePasswordReset = async () => {\r\n    if (newPassword !== confirmPassword) {\r\n      if (Platform.OS === 'ios' || Platform.OS === 'android') {\r\n        Alert.alert('Error', 'Passwords do not match.');\r\n      } else {\r\n        setSuccessMessage('Passwords do not match.');\r\n      }\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    try {\r\n      const response = await axios.post(`${API_BASE_URL}/api/users/v1/reset-password-confirm/${uid}/${token}/`, {\r\n        new_password: newPassword,\r\n      });\r\n      if (Platform.OS === 'ios' || Platform.OS === 'android') {\r\n        Alert.alert('Success', 'Your password has been reset.', [\r\n          { text: 'OK', onPress: () => navigateToFrom(navigation, 'SignIn', 'ResetPasswordConfirm') }\r\n        ]);\r\n      } else {\r\n        setSuccessMessage('Your password has been reset.');\r\n        setTimeout(() => {\r\n          navigateToFrom(navigation, 'SignIn', 'ResetPasswordConfirm');\r\n        }, 2000); // Navigate after 2 seconds\r\n      }\r\n    } catch (error) {\r\n      const errorMessage = 'Failed to reset password. Please try again later.';\r\n      if (Platform.OS === 'ios' || Platform.OS === 'android') {\r\n        Alert.alert('Error', errorMessage);\r\n      } else {\r\n        setSuccessMessage(errorMessage);\r\n      }\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <View style={styles.container}>\r\n      <Text style={styles.title}>Reset Password</Text>\r\n      <TextInput\r\n        style={styles.input}\r\n        placeholder=\"New Password\"\r\n        value={newPassword}\r\n        onChangeText={setNewPassword}\r\n        secureTextEntry\r\n      />\r\n      <TextInput\r\n        style={styles.input}\r\n        placeholder=\"Confirm Password\"\r\n        value={confirmPassword}\r\n        onChangeText={setConfirmPassword}\r\n        secureTextEntry\r\n      />\r\n      <CustomButton title=\"Reset Password\" onPress={handlePasswordReset} />\r\n      {loading && <ActivityIndicator size=\"large\" color={theme.colors.primary} />}\r\n      {successMessage ? <Text style={styles.message}>{successMessage}</Text> : null}\r\n    </View>\r\n  );\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    padding: theme.spacing.medium,\r\n    backgroundColor: theme.colors.background,\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n  },\r\n  title: {\r\n    fontSize: theme.fontSizes.large,\r\n    color: theme.colors.primary,\r\n    marginBottom: theme.spacing.medium,\r\n  },\r\n  input: {\r\n    width: screenWidth > 600 ? 600 : '100%',\r\n    maxWidth: 600,\r\n    height: 40,\r\n    borderColor: 'gray',\r\n    borderWidth: 1,\r\n    marginBottom: theme.spacing.small,\r\n    paddingHorizontal: theme.spacing.small,\r\n  },\r\n  message: {\r\n    marginTop: theme.spacing.small,\r\n    color: theme.colors.primary,\r\n    fontSize: theme.fontSizes.medium,\r\n  },\r\n});","// components/BookingCard.js\r\nimport React, { useContext, useState } from 'react';\r\nimport { View, Text, StyleSheet, TouchableOpacity, Image, Platform } from 'react-native';\r\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\r\nimport { theme } from '../styles/theme';\r\nimport { AuthContext, debugLog } from '../context/AuthContext';\r\nimport { convertDateTimeFromUTC, formatDate } from '../utils/time_utils';\r\nimport { supportsHover } from '../utils/deviceUtils';\r\n\r\nconst getStatusInfo = (status) => {\r\n  // Add debugging for status values\r\n  debugLog(\"MBA5677: Processing status\", { status });\r\n  \r\n  switch (status) {\r\n    case 'Pending Initial Professional Changes':\r\n    case 'Pending Professional Changes':\r\n      return {\r\n        text: 'Pending Pro',\r\n        bgColor: theme.colors.mybookings.main,\r\n        textColor: theme.colors.mybookings.secondary,\r\n        icon: 'clock-outline'\r\n      };\r\n    case 'Pending Owner Approval':\r\n      return {\r\n        text: 'Pending Owner',\r\n        bgColor: theme.colors.mybookings.main,\r\n        textColor: theme.colors.mybookings.secondary,\r\n        icon: 'clock-outline'\r\n      };\r\n    case 'Confirmed':\r\n      return {\r\n        text: 'Confirmed',\r\n        bgColor: theme.colors.mybookings.confirmedBg,\r\n        textColor: theme.colors.mybookings.confirmedText,\r\n        icon: 'check-circle-outline'\r\n      };\r\n    case 'Completed':\r\n      return {\r\n        text: 'Completed',\r\n        bgColor: theme.colors.mybookings.completedBg,\r\n        textColor: theme.colors.mybookings.completedText,\r\n        icon: 'flag-checkered'\r\n      };\r\n    case 'Confirmed Pending Professional Changes':\r\n      return {\r\n        text: 'Confirmed • Pending Pro',\r\n        bgColor: theme.colors.mybookings.confirmedBg,\r\n        textColor: theme.colors.mybookings.confirmedText,\r\n        icon: 'check-circle-outline'\r\n      };\r\n    case 'Confirmed Pending Owner Approval':\r\n      return {\r\n        text: 'Confirmed • Pending Owner',\r\n        bgColor: theme.colors.mybookings.confirmedBg,\r\n        textColor: theme.colors.mybookings.confirmedText,\r\n        icon: 'check-circle-outline'\r\n      };\r\n    default:\r\n      return {\r\n        text: status || 'Unknown',\r\n        bgColor: theme.colors.mybookings.main,\r\n        textColor: theme.colors.mybookings.secondary,\r\n        icon: 'clock-outline'\r\n      };\r\n  }\r\n};\r\n\r\nconst BookingCard = ({ booking, type, onViewDetails }) => {\r\n  const { id, status, date, time, serviceName } = booking;\r\n  \r\n  // Handle both client_name and professional_name, with fallbacks for backward compatibility\r\n  let name = '';\r\n  if (type === 'professional') {\r\n    name = booking.client_name || booking.ownerName || 'Client';\r\n    debugLog(\"MBA5677: Using client name for professional view\", { client_name: booking.client_name, ownerName: booking.ownerName });\r\n  } else {\r\n    name = booking.professional_name || booking.professionalName || 'Professional';\r\n    debugLog(\"MBA5677: Using professional name for client view\", { professional_name: booking.professional_name, professionalName: booking.professionalName });\r\n  }\r\n  \r\n  const statusInfo = getStatusInfo(status);\r\n  const pets = booking.pets || [];\r\n  const { screenWidth, timeSettings } = useContext(AuthContext);\r\n  const isMobile = screenWidth < 600;\r\n  const [isHovered, setIsHovered] = useState(false);\r\n  \r\n  // Check if device supports hover\r\n  const deviceSupportsHover = supportsHover();\r\n\r\n  // Add debugging for incoming date\r\n  debugLog(\"MBA5677: Original booking date/time\", { date, time });\r\n\r\n  // Convert time from UTC to user's timezone if needed\r\n  const convertedDateTime = timeSettings?.timezone !== 'UTC' && date && time\r\n    ? convertDateTimeFromUTC(date, time, timeSettings?.timezone || 'America/Denver', timeSettings?.use_military_time || false)\r\n    : date && time ? { date, time } : null;\r\n\r\n  // Format the date for display using the moment-based approach\r\n  const formattedDate = convertedDateTime?.date \r\n    ? (() => {\r\n        debugLog(\"MBA5677: Formatting with direct date\", convertedDateTime.date);\r\n        const parts = convertedDateTime.date.split('-');\r\n        if (parts.length === 3) {\r\n          const [year, month, day] = parts;\r\n          // Create date object directly\r\n          const dateObj = new Date(parseInt(year), parseInt(month) - 1, parseInt(day));\r\n          if (!isNaN(dateObj.getTime())) {\r\n            const monthName = dateObj.toLocaleString('default', { month: 'short' });\r\n            debugLog(\"MBA5677: Formatted date parts\", { year, month, day, monthName, day: dateObj.getDate() });\r\n            return `${monthName} ${dateObj.getDate()}`;\r\n          }\r\n        }\r\n        // Fallback to original date if parsing fails\r\n        return convertedDateTime.date;\r\n      })()\r\n    : 'No date selected';\r\n    \r\n  const convertedTime = convertedDateTime?.time;\r\n\r\n  debugLog(\"MBA5677: Converted date/time\", { \r\n    formattedDate,\r\n    convertedTime,\r\n    convertedDateTime,\r\n    timezone: timeSettings?.timezone,\r\n    originalDate: date,\r\n    originalTime: time\r\n  });\r\n\r\n  const getMetaText = () => {\r\n    const timeText = convertedTime || 'No time selected';\r\n    const serviceText = serviceName || 'No service selected';\r\n\r\n    if (isMobile) {\r\n      return (\r\n        <View style={styles.mobileMetaInfo}>\r\n          <View style={styles.mobileMetaRow}>\r\n            <View style={styles.metaItemContainer}>\r\n              <MaterialCommunityIcons name=\"calendar\" size={14} color={theme.colors.mybookings.metaText} />\r\n              <Text style={styles.metaText}>{formattedDate}</Text>\r\n            </View>\r\n            <View style={styles.metaItemContainer}>\r\n              <MaterialCommunityIcons name=\"clock-outline\" size={14} color={theme.colors.mybookings.metaText} />\r\n              <Text style={styles.metaText}>{timeText}</Text>\r\n            </View>\r\n            <View style={styles.metaItemContainer}>\r\n              <MaterialCommunityIcons name=\"briefcase-outline\" size={14} color={theme.colors.mybookings.metaText} />\r\n              <Text style={styles.metaText}>{serviceText}</Text>\r\n            </View>\r\n          </View>\r\n        </View>\r\n      );\r\n    }\r\n\r\n    return (\r\n      <View style={styles.metaInfo}>\r\n        <View style={styles.metaItemContainer}>\r\n          <MaterialCommunityIcons name=\"calendar\" size={16} color={theme.colors.mybookings.metaText} />\r\n          <Text style={styles.metaText}>{formattedDate}</Text>\r\n        </View>\r\n        <Text style={styles.metaText}> • </Text>\r\n        <View style={styles.metaItemContainer}>\r\n          <MaterialCommunityIcons name=\"clock-outline\" size={16} color={theme.colors.mybookings.metaText} />\r\n          <Text style={styles.metaText}>{timeText}</Text>\r\n        </View>\r\n        <Text style={styles.metaText}> • </Text>\r\n        <View style={styles.metaItemContainer}>\r\n          <MaterialCommunityIcons name=\"briefcase-outline\" size={16} color={theme.colors.mybookings.metaText} />\r\n          <Text style={styles.metaText}>{serviceText}</Text>\r\n        </View>\r\n      </View>\r\n    );\r\n  };\r\n\r\n  // Add debugging for complete booking object and type\r\n  debugLog(\"MBA5677: Rendering BookingCard\", { \r\n    booking,\r\n    type,\r\n    name,\r\n    status\r\n  });\r\n\r\n  return (\r\n    <TouchableOpacity \r\n      style={[\r\n        styles.card,\r\n        Platform.OS === 'web' && isHovered && styles.cardHovered\r\n      ]}\r\n      onPress={onViewDetails}\r\n      onMouseEnter={() => deviceSupportsHover && setIsHovered(true)}\r\n      onMouseLeave={() => deviceSupportsHover && setIsHovered(false)}\r\n    >\r\n      <View style={[styles.cardContent, isMobile && styles.mobileCardContent]}>\r\n        <View style={[styles.topContent, isMobile && styles.mobileTopContent]}>\r\n          <Image \r\n            source={require('../../assets/default-profile.png')} \r\n            style={[\r\n              styles.profileImage,\r\n              isMobile && styles.mobileProfileImage\r\n            ]}\r\n          />\r\n          <View style={[styles.contentContainer, isMobile && styles.mobileContentContainer]}>\r\n            <View style={[styles.headerContainer, isMobile && styles.mobileHeaderContainer]}>\r\n              <View style={styles.nameAndPets}>\r\n                <View style={[styles.clientContainer, isMobile && styles.mobileClientContainer]}>\r\n                  <MaterialCommunityIcons \r\n                    name=\"account\" \r\n                    size={isMobile ? 16 : 18} \r\n                    color={theme.colors.mybookings.ownername} \r\n                  />\r\n                  <Text style={[styles.name, isMobile && styles.mobileName]}>{name}</Text>\r\n                </View>\r\n                <View style={[styles.petContainer, isMobile && styles.mobilePetContainer]}>\r\n                  <MaterialCommunityIcons name=\"paw\" size={isMobile ? 14 : 14} color={theme.colors.mybookings.metaText} />\r\n                  <Text style={[styles.petInfo, isMobile && styles.mobilePetInfo]}>\r\n                    {pets.length > 0 ? pets.map(pet => pet.name).join(', ') : 'No pets selected'}\r\n                  </Text>\r\n                </View>\r\n              </View>\r\n              <View style={[\r\n                styles.statusBadge, \r\n                { backgroundColor: statusInfo.bgColor },\r\n                isMobile && styles.mobileStatusBadge\r\n              ]}>\r\n                <View style={styles.statusContent}>\r\n                  <MaterialCommunityIcons \r\n                    name={statusInfo.icon} \r\n                    size={isMobile ? 12 : 16} \r\n                    color={statusInfo.textColor}\r\n                  />\r\n                  <Text style={[\r\n                    styles.statusText, \r\n                    { color: statusInfo.textColor },\r\n                    isMobile && styles.mobileStatusText\r\n                  ]}>\r\n                    {statusInfo.text}\r\n                  </Text>\r\n                </View>\r\n              </View>\r\n            </View>\r\n            {!isMobile && getMetaText()}\r\n          </View>\r\n          {!isMobile && (\r\n            <TouchableOpacity\r\n              style={styles.viewDetailsButton}\r\n              onPress={onViewDetails}\r\n            >\r\n              <Text style={styles.viewDetailsText}>View Details</Text>\r\n            </TouchableOpacity>\r\n          )}\r\n        </View>\r\n        {isMobile && (\r\n          <>\r\n            <View style={styles.mobileDivider} />\r\n            {getMetaText()}\r\n          </>\r\n        )}\r\n      </View>\r\n    </TouchableOpacity>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  card: {\r\n    backgroundColor: theme.colors.surfaceContrast,\r\n    borderRadius: 12,\r\n    padding: 16,\r\n    marginBottom: 16,\r\n    ...(Platform.OS === 'web' && {\r\n      transition: 'all 0.2s ease-in-out',\r\n      cursor: 'pointer',\r\n    })\r\n  },\r\n  cardHovered: {\r\n    transform: [{ scale: 1.02 }],\r\n    shadowColor: '#000',\r\n    shadowOffset: {\r\n      width: 0,\r\n      height: 2,\r\n    },\r\n    shadowOpacity: 0.1,\r\n    shadowRadius: 4,\r\n    elevation: 5,\r\n  },\r\n  cardContent: {\r\n    flexDirection: 'column',\r\n  },\r\n  mobileCardContent: {\r\n    gap: 12,\r\n  },\r\n  topContent: {\r\n    flexDirection: 'row',\r\n    alignItems: 'flex-start',\r\n    gap: 16,\r\n  },\r\n  mobileTopContent: {\r\n    marginBottom: 0,\r\n  },\r\n  profileImage: {\r\n    width: 88,\r\n    height: 88,\r\n    borderRadius: 44,\r\n  },\r\n  mobileProfileImage: {\r\n    width: 48,\r\n    height: 48,\r\n    borderRadius: 24,\r\n  },\r\n  contentContainer: {\r\n    flex: 1,\r\n  },\r\n  mobileContentContainer: {\r\n    flex: 1,\r\n  },\r\n  headerContainer: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'flex-start',\r\n    marginBottom: 8,\r\n  },\r\n  mobileHeaderContainer: {\r\n    marginBottom: 0,\r\n  },\r\n  nameAndPets: {\r\n    flex: 1,\r\n  },\r\n  statusBadge: {\r\n    alignSelf: 'flex-start',\r\n    paddingHorizontal: 12,\r\n    paddingVertical: 4,\r\n    borderRadius: 16,\r\n  },\r\n  statusContent: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    gap: 6,\r\n  },\r\n  statusText: {\r\n    fontSize: 12,\r\n    fontWeight: '500',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  clientContainer: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    gap: 6,\r\n    marginBottom: 6,\r\n  },\r\n  name: {\r\n    fontSize: 16,\r\n    fontWeight: '600',\r\n    color: theme.colors.mybookings.ownerName,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  petContainer: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    gap: 4,\r\n  },\r\n  petInfo: {\r\n    fontSize: 14,\r\n    color: '#888975',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  mobileDivider: {\r\n    height: 1,\r\n    backgroundColor: theme.colors.surface,\r\n    width: '100%',\r\n    // marginVertical: 12,\r\n  },\r\n  metaInfo: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    flexWrap: 'wrap',\r\n    gap: 8,\r\n  },\r\n  mobileMetaInfo: {\r\n    width: '100%',\r\n  },\r\n  mobileMetaRow: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n  },\r\n  metaItemContainer: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    gap: 4,\r\n  },\r\n  metaText: {\r\n    fontSize: 14,\r\n    color: theme.colors.mybookings.metaText,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  viewDetailsButton: {\r\n    backgroundColor: theme.colors.primary,\r\n    paddingHorizontal: 16,\r\n    paddingVertical: 8,\r\n    borderRadius: 8,\r\n  },\r\n  viewDetailsText: {\r\n    color: theme.colors.surfaceContrast,\r\n    fontSize: 14,\r\n    fontWeight: '500',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  mobileClientContainer: {\r\n    marginBottom: 4,\r\n  },\r\n  mobileName: {\r\n    fontSize: 15,\r\n    color: theme.colors.mybookings.ownerName,\r\n  },\r\n  mobilePetContainer: {\r\n    marginBottom: 2,\r\n  },\r\n  mobilePetInfo: {\r\n    fontSize: 13,\r\n    color: theme.colors.mybookings.metaText,\r\n  },\r\n  mobileStatusBadge: {\r\n    paddingHorizontal: 8,\r\n    paddingVertical: 2,\r\n    borderRadius: 12,\r\n  },\r\n  mobileStatusText: {\r\n    fontSize: 10,\r\n  },\r\n});\r\n\r\nexport default BookingCard;","// THIS FILE IS FOR THE BOOKING STEP MODAL\r\nimport React, { useEffect, useContext, useState } from 'react';\r\nimport {\r\n  View,\r\n  Text,\r\n  StyleSheet,\r\n  TouchableOpacity,\r\n  ScrollView,\r\n  TextInput,\r\n  useWindowDimensions,\r\n} from 'react-native';\r\nimport { theme } from '../../styles/theme';\r\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\r\nimport { AuthContext, debugLog } from '../../context/AuthContext';\r\nimport { formatDateTimeRangeFromUTC, formatFromUTC, FORMAT_TYPES } from '../../utils/time_utils';\r\nimport { updateBookingDraftRates } from '../../api/API';\r\n\r\nconst ReviewAndRatesCard = ({ bookingData, onRatesUpdate, bookingId, showEditControls = true, isProfessional = true }) => {\r\n  const { timeSettings } = useContext(AuthContext);\r\n  const [isEditMode, setIsEditMode] = useState(false);\r\n  const [isAddingRate, setIsAddingRate] = useState(false);\r\n  const [editedRates, setEditedRates] = useState(null);\r\n  const [newRate, setNewRate] = useState({ name: '', amount: '', description: '' });\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [error, setError] = useState(null);\r\n  const [expandedRates, setExpandedRates] = useState(new Set());\r\n  const [editingOccurrenceId, setEditingOccurrenceId] = useState(null);\r\n  const [occurrenceEdits, setOccurrenceEdits] = useState({});\r\n  const [isAddingRateForOccurrence, setIsAddingRateForOccurrence] = useState(null);\r\n  const [newOccurrenceRate, setNewOccurrenceRate] = useState({ name: '', amount: '', description: '' });\r\n  const { width } = useWindowDimensions();\r\n\r\n  useEffect(() => {\r\n    debugLog('MBA54321 ReviewAndRatesCard received bookingData:', bookingData);\r\n    debugLog('MBA54321 ReviewAndRatesCard received bookingId:', bookingId);\r\n    \r\n    if (bookingData?.occurrences?.[0]) {\r\n      // Create a safe default rates object\r\n      const defaultRates = {\r\n        base_rate: 0,\r\n        additional_animal_rate: 0,\r\n        applies_after: 1,\r\n        holiday_rate: 0,\r\n        holiday_days: 0,\r\n        additional_rates: []\r\n      };\r\n      \r\n      // Get the occurrence\r\n      const occurrence = bookingData.occurrences[0];\r\n      \r\n      // Use the existing rates or default to our safe defaults\r\n      const safeRates = occurrence.rates || defaultRates;\r\n      \r\n      // Initialize edited rates\r\n      setEditedRates({ ...safeRates });\r\n    }\r\n  }, [bookingData, bookingId]);\r\n\r\n  // Log whenever either editMode or editingOccurrenceId changes\r\n  useEffect(() => {\r\n    debugLog('MBA66777 Edit state changed:', { \r\n      isEditMode, \r\n      editingOccurrenceId, \r\n      occurrencesCount: bookingData?.occurrences?.length || 0\r\n    });\r\n  }, [isEditMode, editingOccurrenceId, bookingData?.occurrences?.length]);\r\n\r\n  const formatCurrency = (amount) => {\r\n    if (!amount) return '$0.00';\r\n    return `$${parseFloat(amount).toFixed(2)}`;\r\n  };\r\n\r\n  const toggleEditMode = () => {\r\n    if (isEditMode) {\r\n      // Save changes\r\n      saveRateChanges();\r\n    } else {\r\n      // Enter edit mode\r\n      setIsEditMode(true);\r\n      setIsAddingRate(false);\r\n    }\r\n  };\r\n\r\n  const toggleAddRate = () => {\r\n    setIsAddingRate(!isAddingRate);\r\n    // Don't exit edit mode when adding a rate for overnight bookings\r\n    setNewRate({ name: '', amount: '', description: '' });\r\n  };\r\n\r\n  // Helper function to sanitize amount input for consistent handling\r\n  const sanitizeAmountInput = (value) => {\r\n    // Remove non-numeric characters except decimal point\r\n    let sanitized = value\r\n      .replace(/[^\\d.]/g, '') // Remove anything that's not a digit or decimal point\r\n      .replace(/(\\..*)\\./g, '$1'); // Remove multiple decimal points, keep only the first one\r\n    \r\n    // Limit to 2 decimal places\r\n    const parts = sanitized.split('.');\r\n    if (parts.length > 1 && parts[1].length > 2) {\r\n      sanitized = `${parts[0]}.${parts[1].substring(0, 2)}`;\r\n    }\r\n    \r\n    return sanitized;\r\n  };\r\n  \r\n  // Update the setNewRate for amount field to apply consistent validation\r\n  const handleNewRateAmountChange = (text) => {\r\n    setNewRate(prev => ({\r\n      ...prev,\r\n      amount: sanitizeAmountInput(text)\r\n    }));\r\n  };\r\n  \r\n  // Update the setNewOccurrenceRate for amount field to apply consistent validation\r\n  const handleNewOccurrenceRateAmountChange = (text) => {\r\n    setNewOccurrenceRate(prev => ({\r\n      ...prev,\r\n      amount: sanitizeAmountInput(text)\r\n    }));\r\n  };\r\n\r\n  const saveRateChanges = async () => {\r\n    // Create a copy of bookingData with updated rates\r\n    if (!editedRates) return;\r\n\r\n    try {\r\n      setIsLoading(true);\r\n      setError(null);\r\n      \r\n      debugLog('MBA66777 Saving rate changes:', editedRates);\r\n      debugLog('MBA66777 Using bookingId:', bookingId);\r\n      \r\n      // Create a clean version of editedRates to send to API\r\n      const cleanEditedRates = {\r\n        ...editedRates,\r\n        additional_rates: editedRates.additional_rates && editedRates.additional_rates.length > 0 \r\n          ? editedRates.additional_rates.map(rate => ({\r\n              title: rate.name || rate.title, // Always use 'title' for backend\r\n              // Convert empty or string amount values to number\r\n              amount: rate.amount === '' ? 0 : typeof rate.amount === 'string' ? parseFloat(rate.amount) : rate.amount,\r\n              description: rate.description || `Additional rate`\r\n            }))\r\n          : []\r\n      };\r\n      \r\n      // Create occurrences array for API with all occurrences\r\n      const occurrencesForApi = bookingData.occurrences.map((occ, index) => {\r\n        // For the first occurrence (the one being edited in this case), update its rates\r\n        if (index === 0) {\r\n          return {\r\n            occurrence_id: occ.occurrence_id,\r\n            rates: {\r\n              base_rate: editedRates.base_rate === '' ? 0 : typeof editedRates.base_rate === 'string' ? parseFloat(editedRates.base_rate) : editedRates.base_rate,\r\n              additional_animal_rate: editedRates.additional_animal_rate === '' ? 0 : typeof editedRates.additional_animal_rate === 'string' ? parseFloat(editedRates.additional_animal_rate) : editedRates.additional_animal_rate || 0,\r\n              applies_after: parseInt(editedRates.applies_after || 1),\r\n              holiday_rate: editedRates.holiday_rate === '' ? 0 : typeof editedRates.holiday_rate === 'string' ? parseFloat(editedRates.holiday_rate) : editedRates.holiday_rate || 0,\r\n              additional_rates: cleanEditedRates.additional_rates\r\n            }\r\n          };\r\n        }\r\n        // For other occurrences, keep them as they are\r\n        return {\r\n          occurrence_id: occ.occurrence_id,\r\n          rates: {\r\n            base_rate: parseFloat(occ.rates.base_rate),\r\n            additional_animal_rate: parseFloat(occ.rates.additional_animal_rate || 0),\r\n            applies_after: parseInt(occ.rates.applies_after || 1),\r\n            holiday_rate: parseFloat(occ.rates.holiday_rate || 0),\r\n            additional_rates: (occ.rates.additional_rates || []).map(rate => ({\r\n              title: rate.name || rate.title,\r\n              amount: parseFloat(rate.amount),\r\n              description: rate.description || ''\r\n            }))\r\n          }\r\n        };\r\n      });\r\n      \r\n      debugLog('MBA66777 Sending all occurrences to API:', occurrencesForApi);\r\n      \r\n      // Call the API to update rates using the bookingId prop\r\n      const response = await updateBookingDraftRates(\r\n        bookingId, \r\n        occurrencesForApi\r\n      );\r\n      \r\n      debugLog('MBA66777 Rate update API response:', response);\r\n      \r\n      // Update the local state with the response\r\n      if (response.draft_data) {\r\n        // Call onRatesUpdate with the updated data from the API\r\n        if (onRatesUpdate) {\r\n          onRatesUpdate(response.draft_data);\r\n        }\r\n      }\r\n      \r\n      // Reset all edit state\r\n      setIsEditMode(false);\r\n      setEditingOccurrenceId(null);\r\n      setOccurrenceEdits({});\r\n      setExpandedRates(new Set());\r\n      setIsAddingRate(false);\r\n      setIsAddingRateForOccurrence(null);\r\n    } catch (err) {\r\n      debugLog('MBA66777 Error saving rate changes:', err);\r\n      setError('Failed to update rates. Please try again.');\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const saveNewRate = async () => {\r\n    if (!newRate.name || (!newRate.amount && newRate.amount !== '')) return;\r\n    \r\n    try {\r\n      setIsLoading(true);\r\n      setError(null);\r\n      \r\n      // Create the new rate object\r\n      const newAdditionalRate = {\r\n        title: newRate.name,\r\n        amount: newRate.amount === '' ? 0 : typeof newRate.amount === 'string' ? parseFloat(newRate.amount) : newRate.amount,\r\n        description: newRate.description || `Additional rate`\r\n      };\r\n      \r\n      // Create an updated rates object\r\n      const updatedRates = { ...editedRates };\r\n      \r\n      if (!updatedRates.additional_rates) {\r\n        updatedRates.additional_rates = [];\r\n      }\r\n      \r\n      updatedRates.additional_rates.push({\r\n        name: newRate.name,\r\n        title: newRate.name, // Add title for consistency\r\n        amount: newRate.amount === '' ? 0 : typeof newRate.amount === 'string' ? parseFloat(newRate.amount) : newRate.amount,\r\n        description: newRate.description || `Additional rate`\r\n      });\r\n      \r\n      // Create occurrences array for API with all occurrences\r\n      const occurrencesForApi = bookingData.occurrences.map((occ, index) => {\r\n        // For the first occurrence (the one being edited in this case), update its rates with the new rate\r\n        if (index === 0) {\r\n          return {\r\n            occurrence_id: occ.occurrence_id,\r\n            rates: {\r\n              base_rate: parseFloat(updatedRates.base_rate),\r\n              additional_animal_rate: parseFloat(updatedRates.additional_animal_rate || 0),\r\n              applies_after: parseInt(updatedRates.applies_after || 1),\r\n              holiday_rate: parseFloat(updatedRates.holiday_rate || 0),\r\n              additional_rates: updatedRates.additional_rates.map(rate => ({\r\n                title: rate.name || rate.title,\r\n                amount: parseFloat(rate.amount),\r\n                description: rate.description || `Additional rate`\r\n              }))\r\n            }\r\n          };\r\n        }\r\n        // For other occurrences, keep them as they are\r\n        return {\r\n          occurrence_id: occ.occurrence_id,\r\n          rates: {\r\n            base_rate: parseFloat(occ.rates.base_rate),\r\n            additional_animal_rate: parseFloat(occ.rates.additional_animal_rate || 0),\r\n            applies_after: parseInt(occ.rates.applies_after || 1),\r\n            holiday_rate: parseFloat(occ.rates.holiday_rate || 0),\r\n            additional_rates: (occ.rates.additional_rates || []).map(rate => ({\r\n              title: rate.name || rate.title,\r\n              amount: parseFloat(rate.amount),\r\n              description: rate.description || ''\r\n            }))\r\n          }\r\n        };\r\n      });\r\n      \r\n      debugLog('MBA66777 Sending all occurrences with new rate to API:', occurrencesForApi);\r\n      \r\n      // Call the API to update rates using the bookingId prop\r\n      const response = await updateBookingDraftRates(\r\n        bookingId, \r\n        occurrencesForApi\r\n      );\r\n      \r\n      debugLog('MBA66777 New rate added API response:', response);\r\n      \r\n      // Update the local state with the response\r\n      if (response.draft_data) {\r\n        // Set the edited rates from the response\r\n        if (response.draft_data.occurrences && response.draft_data.occurrences[0]) {\r\n          setEditedRates(response.draft_data.occurrences[0].rates);\r\n        }\r\n        \r\n        // Call onRatesUpdate with the updated data from the API\r\n        if (onRatesUpdate) {\r\n          onRatesUpdate(response.draft_data);\r\n        }\r\n      }\r\n      \r\n      setIsAddingRate(false);\r\n      setNewRate({ name: '', amount: '', description: '' });\r\n    } catch (err) {\r\n      debugLog('MBA66777 Error adding new rate:', err);\r\n      setError('Failed to add new rate. Please try again.');\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const updateBaseRate = (value) => {\r\n    // Apply consistent amount sanitization\r\n    const sanitizedValue = sanitizeAmountInput(value);\r\n    \r\n    setEditedRates(prev => ({\r\n      ...prev,\r\n      base_rate: sanitizedValue\r\n    }));\r\n  };\r\n\r\n  const updateAdditionalAnimalRate = (value) => {\r\n    // Apply consistent amount sanitization\r\n    const sanitizedValue = sanitizeAmountInput(value);\r\n    \r\n    setEditedRates(prev => ({\r\n      ...prev,\r\n      additional_animal_rate: sanitizedValue\r\n    }));\r\n  };\r\n\r\n  const updateHolidayRate = (value) => {\r\n    // Apply consistent amount sanitization\r\n    const sanitizedValue = sanitizeAmountInput(value);\r\n    \r\n    setEditedRates(prev => ({\r\n      ...prev,\r\n      holiday_rate: sanitizedValue\r\n    }));\r\n  };\r\n\r\n  const updateAdditionalRate = (index, field, value) => {\r\n    if (!editedRates?.additional_rates) return;\r\n    \r\n    const updatedAdditionalRates = [...editedRates.additional_rates];\r\n    \r\n    if (field === 'amount') {\r\n      // Apply consistent amount sanitization\r\n      const sanitizedValue = sanitizeAmountInput(value);\r\n      \r\n      updatedAdditionalRates[index] = {\r\n        ...updatedAdditionalRates[index],\r\n        amount: sanitizedValue === '' ? '' : sanitizedValue\r\n      };\r\n    } else if (field === 'name') {\r\n      updatedAdditionalRates[index] = {\r\n        ...updatedAdditionalRates[index],\r\n        name: value\r\n      };\r\n    }\r\n    \r\n    setEditedRates(prev => ({\r\n      ...prev,\r\n      additional_rates: updatedAdditionalRates\r\n    }));\r\n  };\r\n\r\n  const deleteAdditionalRate = async (index) => {\r\n    if (!editedRates?.additional_rates) return;\r\n    \r\n    try {\r\n      setIsLoading(true);\r\n      setError(null);\r\n      \r\n      // Create an updated rates object\r\n      const updatedRates = { ...editedRates };\r\n      const updatedAdditionalRates = [...updatedRates.additional_rates];\r\n      updatedAdditionalRates.splice(index, 1);\r\n      updatedRates.additional_rates = updatedAdditionalRates;\r\n      \r\n      // Create occurrences array for API with all occurrences\r\n      const occurrencesForApi = bookingData.occurrences.map((occ, occIndex) => {\r\n        // For the first occurrence (the one being edited in this case), update its rates with the updated rates\r\n        if (occIndex === 0) {\r\n          return {\r\n            occurrence_id: occ.occurrence_id,\r\n            rates: {\r\n              base_rate: parseFloat(updatedRates.base_rate),\r\n              additional_animal_rate: parseFloat(updatedRates.additional_animal_rate || 0),\r\n              applies_after: parseInt(updatedRates.applies_after || 1),\r\n              holiday_rate: parseFloat(updatedRates.holiday_rate || 0),\r\n              additional_rates: updatedRates.additional_rates.map(rate => ({\r\n                title: rate.name || rate.title,\r\n                amount: parseFloat(rate.amount),\r\n                description: rate.description || `Additional rate`\r\n              }))\r\n            }\r\n          };\r\n        }\r\n        // For other occurrences, keep them as they are\r\n        return {\r\n          occurrence_id: occ.occurrence_id,\r\n          rates: {\r\n            base_rate: parseFloat(occ.rates.base_rate),\r\n            additional_animal_rate: parseFloat(occ.rates.additional_animal_rate || 0),\r\n            applies_after: parseInt(occ.rates.applies_after || 1),\r\n            holiday_rate: parseFloat(occ.rates.holiday_rate || 0),\r\n            additional_rates: (occ.rates.additional_rates || []).map(rate => ({\r\n              title: rate.name || rate.title,\r\n              amount: parseFloat(rate.amount),\r\n              description: rate.description || ''\r\n            }))\r\n          }\r\n        };\r\n      });\r\n      \r\n      debugLog('MBA66777 Sending all occurrences with updated rates to API:', occurrencesForApi);\r\n      \r\n      // Call the API to update rates using the bookingId prop\r\n      const response = await updateBookingDraftRates(\r\n        bookingId, \r\n        occurrencesForApi\r\n      );\r\n      \r\n      debugLog('MBA66777 Rate deleted API response:', response);\r\n      \r\n      // Update the local state with the response\r\n      if (response.draft_data) {\r\n        // Set the edited rates from the response\r\n        if (response.draft_data.occurrences && response.draft_data.occurrences[0]) {\r\n          setEditedRates(response.draft_data.occurrences[0].rates);\r\n        }\r\n        \r\n        // Call onRatesUpdate with the updated data from the API\r\n        if (onRatesUpdate) {\r\n          onRatesUpdate(response.draft_data);\r\n        }\r\n      }\r\n    } catch (err) {\r\n      debugLog('MBA66777 Error deleting rate:', err);\r\n      setError('Failed to delete rate. Please try again.');\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleEditOccurrence = (occurrence) => {\r\n    debugLog('MBA66777 Editing occurrence:', occurrence);\r\n    \r\n    // Set the occurrence ID being edited\r\n    setEditingOccurrenceId(occurrence.occurrence_id);\r\n    \r\n    // For single occurrence bookings (typically overnight), also enter edit mode\r\n    if (bookingData.occurrences.length === 1) {\r\n      debugLog('MBA66777 Setting isEditMode for single occurrence booking');\r\n      setIsEditMode(true);\r\n      \r\n      // Make sure we have the correct rates in editedRates\r\n      setEditedRates({\r\n        base_rate: occurrence.rates.base_rate,\r\n        additional_animal_rate: occurrence.rates.additional_animal_rate || 0,\r\n        applies_after: occurrence.rates.applies_after || 1,\r\n        holiday_rate: occurrence.rates.holiday_rate || 0,\r\n        additional_rates: occurrence.rates.additional_rates?.map(r => ({\r\n          name: r.name || r.title,\r\n          amount: r.amount,\r\n          description: r.description || ''\r\n        })) || []\r\n      });\r\n    } else {\r\n      // For multiple occurrences, expand the rates panel\r\n      setExpandedRates(new Set([occurrence.occurrence_id]));\r\n    }\r\n    \r\n    // Set the occurrence edits for either case\r\n    setOccurrenceEdits({\r\n      base_rate: occurrence.rates.base_rate,\r\n      additional_animal_rate: occurrence.rates.additional_animal_rate || 0,\r\n      applies_after: occurrence.rates.applies_after || 1,\r\n      holiday_rate: occurrence.rates.holiday_rate || 0,\r\n      additional_rates: occurrence.rates.additional_rates?.map(r => ({\r\n        name: r.name || r.title,\r\n        amount: r.amount,\r\n        description: r.description || ''\r\n      })) || []\r\n    });\r\n  };\r\n\r\n  const handleCancelEdit = () => {\r\n    setEditingOccurrenceId(null);\r\n    setOccurrenceEdits({});\r\n    \r\n    // If we were editing a single occurrence booking, exit edit mode\r\n    if (bookingData.occurrences.length === 1) {\r\n      setIsEditMode(false);\r\n    }\r\n    \r\n    // Also cancel adding a rate if that was in progress\r\n    setIsAddingRate(false);\r\n    setIsAddingRateForOccurrence(null);\r\n  };\r\n\r\n  const handleOccurrenceInputChange = (field, value) => {\r\n    if (field === 'base_rate' || field === 'additional_animal_rate' || field === 'holiday_rate') {\r\n      // Apply consistent amount sanitization\r\n      const sanitizedValue = sanitizeAmountInput(value);\r\n      \r\n      setOccurrenceEdits(prev => ({\r\n        ...prev,\r\n        [field]: sanitizedValue\r\n      }));\r\n    } else {\r\n      setOccurrenceEdits(prev => ({\r\n        ...prev,\r\n        [field]: value\r\n      }));\r\n    }\r\n  };\r\n\r\n  const handleAdditionalRateChange = (index, field, value) => {\r\n    debugLog(`MBA66778 Changing additional rate at index ${index}, field ${field} to value: ${value}`, {\r\n      currentOccurrenceEdits: occurrenceEdits,\r\n      currentAdditionalRates: occurrenceEdits.additional_rates\r\n    });\r\n    \r\n    setOccurrenceEdits(prev => {\r\n      const updated = [...(prev.additional_rates || [])];\r\n      \r\n      if (field === 'amount') {\r\n        // Apply consistent amount sanitization\r\n        const sanitizedValue = sanitizeAmountInput(value);\r\n        \r\n        updated[index] = {\r\n          ...updated[index],\r\n          amount: sanitizedValue === '' ? '' : sanitizedValue\r\n        };\r\n      } else if (field === 'name') {\r\n        updated[index] = {\r\n          ...updated[index],\r\n          name: value\r\n        };\r\n      }\r\n      \r\n      debugLog(`MBA66778 Updated additional rate:`, {\r\n        updatedRate: updated[index],\r\n        allRates: updated\r\n      });\r\n      \r\n      return { ...prev, additional_rates: updated };\r\n    });\r\n  };\r\n\r\n  const handleSaveOccurrenceRates = async (occurrence) => {\r\n    try {\r\n      setIsLoading(true);\r\n      setError(null);\r\n      \r\n      // Clean up any empty amount values in occurrenceEdits\r\n      const cleanOccurrenceEdits = {\r\n        ...occurrenceEdits,\r\n        additional_rates: (occurrenceEdits.additional_rates || []).map(rate => ({\r\n          title: rate.name || rate.title, // Always use 'title' for backend\r\n          // Convert empty or string amount values to number\r\n          amount: rate.amount === '' ? 0 : typeof rate.amount === 'string' ? parseFloat(rate.amount) : rate.amount,\r\n          description: rate.description || ''\r\n        }))\r\n      };\r\n      \r\n      // Create a list of occurrences to send to the API\r\n      const occurrencesForApi = bookingData.occurrences.map(occ => {\r\n        // For the occurrence being edited, update its rates\r\n        if (occ.occurrence_id === occurrence.occurrence_id) {\r\n          return {\r\n            occurrence_id: occurrence.occurrence_id,\r\n            rates: {\r\n              base_rate: occurrenceEdits.base_rate === '' ? 0 : typeof occurrenceEdits.base_rate === 'string' ? parseFloat(occurrenceEdits.base_rate) : occurrenceEdits.base_rate,\r\n              additional_animal_rate: occurrenceEdits.additional_animal_rate === '' ? 0 : typeof occurrenceEdits.additional_animal_rate === 'string' ? parseFloat(occurrenceEdits.additional_animal_rate) : occurrenceEdits.additional_animal_rate || 0,\r\n              applies_after: parseInt(occurrenceEdits.applies_after || 1),\r\n              holiday_rate: occurrenceEdits.holiday_rate === '' ? 0 : typeof occurrenceEdits.holiday_rate === 'string' ? parseFloat(occurrenceEdits.holiday_rate) : occurrenceEdits.holiday_rate || 0,\r\n              additional_rates: cleanOccurrenceEdits.additional_rates\r\n            }\r\n          };\r\n        }\r\n        // For other occurrences, keep them as they are\r\n        return {\r\n          occurrence_id: occ.occurrence_id,\r\n          rates: {\r\n            base_rate: parseFloat(occ.rates.base_rate),\r\n            additional_animal_rate: parseFloat(occ.rates.additional_animal_rate || 0),\r\n            applies_after: parseInt(occ.rates.applies_after || 1),\r\n            holiday_rate: parseFloat(occ.rates.holiday_rate || 0),\r\n            additional_rates: (occ.rates.additional_rates || []).map(rate => ({\r\n              title: rate.name || rate.title,\r\n              amount: parseFloat(rate.amount),\r\n              description: rate.description || ''\r\n            }))\r\n          }\r\n        };\r\n      });\r\n      \r\n      debugLog('MBA54321 - Sending all occurrences to API:', occurrencesForApi);\r\n      \r\n      const response = await updateBookingDraftRates(\r\n        bookingId,\r\n        occurrencesForApi\r\n      );\r\n      \r\n      if (response.draft_data) {\r\n        if (onRatesUpdate) onRatesUpdate(response.draft_data);\r\n        \r\n        // Reset all edit state\r\n        setEditingOccurrenceId(null);\r\n        setOccurrenceEdits({});\r\n        \r\n        // If we're in edit mode for a single occurrence booking, exit that mode too\r\n        if (bookingData.occurrences.length === 1) {\r\n          setIsEditMode(false);\r\n        }\r\n        \r\n        // Also remove any expanded rates and cancel any rate addition in progress\r\n        setExpandedRates(new Set());\r\n        setIsAddingRate(false);\r\n        setIsAddingRateForOccurrence(null);\r\n      }\r\n    } catch (err) {\r\n      debugLog('MBA54321 - Error saving occurrence rates:', err);\r\n      setError('Failed to update rates. Please try again.');\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const toggleAddRateForOccurrence = (occurrenceId) => {\r\n    if (isAddingRateForOccurrence === occurrenceId) {\r\n      setIsAddingRateForOccurrence(null);\r\n    } else {\r\n      setIsAddingRateForOccurrence(occurrenceId);\r\n    }\r\n    setNewOccurrenceRate({ name: '', amount: '', description: '' });\r\n  };\r\n\r\n  const saveNewRateForOccurrence = async (occurrence) => {\r\n    if (!newOccurrenceRate.name || (!newOccurrenceRate.amount && newOccurrenceRate.amount !== '')) return;\r\n    \r\n    try {\r\n      setIsLoading(true);\r\n      setError(null);\r\n      \r\n      // Create updated occurrence edits with the new rate\r\n      const updatedOccurrenceEdits = { ...occurrenceEdits };\r\n      \r\n      if (!updatedOccurrenceEdits.additional_rates) {\r\n        updatedOccurrenceEdits.additional_rates = [];\r\n      }\r\n      \r\n      updatedOccurrenceEdits.additional_rates.push({\r\n        name: newOccurrenceRate.name,\r\n        title: newOccurrenceRate.name, // Add title for consistency\r\n        amount: newOccurrenceRate.amount === '' ? 0 : typeof newOccurrenceRate.amount === 'string' ? parseFloat(newOccurrenceRate.amount) : newOccurrenceRate.amount,\r\n        description: newOccurrenceRate.description || `Additional rate`\r\n      });\r\n      \r\n      // Update state\r\n      setOccurrenceEdits(updatedOccurrenceEdits);\r\n      \r\n      // Call API to save the new rate\r\n      const occurrencesForApi = bookingData.occurrences.map(occ => {\r\n        // For the occurrence being edited, update its rates with the new rate\r\n        if (occ.occurrence_id === occurrence.occurrence_id) {\r\n          return {\r\n            occurrence_id: occurrence.occurrence_id,\r\n            rates: {\r\n              base_rate: parseFloat(updatedOccurrenceEdits.base_rate),\r\n              additional_animal_rate: parseFloat(updatedOccurrenceEdits.additional_animal_rate || 0),\r\n              applies_after: parseInt(updatedOccurrenceEdits.applies_after || 1),\r\n              holiday_rate: parseFloat(updatedOccurrenceEdits.holiday_rate || 0),\r\n              additional_rates: updatedOccurrenceEdits.additional_rates.map(rate => ({\r\n                title: rate.name,\r\n                amount: parseFloat(rate.amount),\r\n                description: rate.description || ''\r\n              }))\r\n            }\r\n          };\r\n        }\r\n        // For other occurrences, keep them as they are\r\n        return {\r\n          occurrence_id: occ.occurrence_id,\r\n          rates: {\r\n            base_rate: parseFloat(occ.rates.base_rate),\r\n            additional_animal_rate: parseFloat(occ.rates.additional_animal_rate || 0),\r\n            applies_after: parseInt(occ.rates.applies_after || 1),\r\n            holiday_rate: parseFloat(occ.rates.holiday_rate || 0),\r\n            additional_rates: (occ.rates.additional_rates || []).map(rate => ({\r\n              title: rate.name || rate.title,\r\n              amount: parseFloat(rate.amount),\r\n              description: rate.description || ''\r\n            }))\r\n          }\r\n        };\r\n      });\r\n      \r\n      debugLog('MBA54321 - Sending all occurrences with new rate to API:', occurrencesForApi);\r\n      \r\n      const response = await updateBookingDraftRates(\r\n        bookingId,\r\n        occurrencesForApi\r\n      );\r\n      \r\n      debugLog('MBA54321 - New rate added to occurrence API response:', response);\r\n      \r\n      if (response.draft_data) {\r\n        if (onRatesUpdate) onRatesUpdate(response.draft_data);\r\n      }\r\n      \r\n      // Close add rate form\r\n      setIsAddingRateForOccurrence(null);\r\n      setNewOccurrenceRate({ name: '', amount: '', description: '' });\r\n      \r\n    } catch (err) {\r\n      debugLog('MBA66777 Error adding new rate for occurrence:', err);\r\n      setError('Failed to add new rate. Please try again.');\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const deleteRateForOccurrence = async (occurrence, rateIndex) => {\r\n    try {\r\n      setIsLoading(true);\r\n      setError(null);\r\n      \r\n      // Create updated occurrence edits with the rate removed\r\n      const updatedOccurrenceEdits = { ...occurrenceEdits };\r\n      \r\n      if (updatedOccurrenceEdits.additional_rates && updatedOccurrenceEdits.additional_rates.length > rateIndex) {\r\n        // Remove the rate at the specified index\r\n        updatedOccurrenceEdits.additional_rates.splice(rateIndex, 1);\r\n        \r\n        // Update state\r\n        setOccurrenceEdits(updatedOccurrenceEdits);\r\n        \r\n        // Call API to save the updated rates\r\n        const occurrencesForApi = bookingData.occurrences.map(occ => {\r\n          // For the occurrence being edited, update its rates with the rate removed\r\n          if (occ.occurrence_id === occurrence.occurrence_id) {\r\n            return {\r\n              occurrence_id: occurrence.occurrence_id,\r\n              rates: {\r\n                base_rate: parseFloat(updatedOccurrenceEdits.base_rate),\r\n                additional_animal_rate: parseFloat(updatedOccurrenceEdits.additional_animal_rate || 0),\r\n                applies_after: parseInt(updatedOccurrenceEdits.applies_after || 1),\r\n                holiday_rate: parseFloat(updatedOccurrenceEdits.holiday_rate || 0),\r\n                additional_rates: updatedOccurrenceEdits.additional_rates.map(rate => ({\r\n                  title: rate.name,\r\n                  amount: parseFloat(rate.amount),\r\n                  description: rate.description || ''\r\n                }))\r\n              }\r\n            };\r\n          }\r\n          // For other occurrences, keep them as they are\r\n          return {\r\n            occurrence_id: occ.occurrence_id,\r\n            rates: {\r\n              base_rate: parseFloat(occ.rates.base_rate),\r\n              additional_animal_rate: parseFloat(occ.rates.additional_animal_rate || 0),\r\n              applies_after: parseInt(occ.rates.applies_after || 1),\r\n              holiday_rate: parseFloat(occ.rates.holiday_rate || 0),\r\n              additional_rates: (occ.rates.additional_rates || []).map(rate => ({\r\n                title: rate.name || rate.title,\r\n                amount: parseFloat(rate.amount),\r\n                description: rate.description || ''\r\n              }))\r\n            }\r\n          };\r\n        });\r\n        \r\n        debugLog('MBA54321 - Sending all occurrences with rate deleted to API:', occurrencesForApi);\r\n        \r\n        const response = await updateBookingDraftRates(\r\n          bookingId,\r\n          occurrencesForApi\r\n        );\r\n        \r\n        debugLog('MBA54321 - Rate deleted from occurrence API response:', response);\r\n        \r\n        if (response.draft_data) {\r\n          if (onRatesUpdate) onRatesUpdate(response.draft_data);\r\n        }\r\n      }\r\n    } catch (err) {\r\n      debugLog('MBA66777 Error deleting rate for occurrence:', err);\r\n      setError('Failed to delete rate. Please try again.');\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  // Helper function to get the correct value for an additional rate field based on edit state\r\n  const getAdditionalRateValue = (occurrence, index, field) => {\r\n    // If we're editing this occurrence, get value from occurrenceEdits\r\n    if (editingOccurrenceId === occurrence.occurrence_id && occurrenceEdits.additional_rates) {\r\n      const value = occurrenceEdits.additional_rates[index]?.[field];\r\n      // For numeric fields like 'amount', 0 is a valid value\r\n      if (field === 'amount' && value === 0) return '';\r\n      return value || '';\r\n    }\r\n    \r\n    // If we're in edit mode (for single occurrence bookings), get from editedRates\r\n    if (isEditMode && editedRates?.additional_rates) {\r\n      const value = editedRates.additional_rates[index]?.[field];\r\n      // For numeric fields like 'amount', 0 is a valid value\r\n      if (field === 'amount' && value === 0) return '';\r\n      return value || '';\r\n    }\r\n    \r\n    // Otherwise get from the rate directly\r\n    const rates = occurrence.rates?.additional_rates || [];\r\n    const rate = rates[index] || {};\r\n    const value = field === 'name' ? (rate.name || rate.title) : rate[field];\r\n    \r\n    // For numeric fields like 'amount', 0 is a valid value\r\n    if (field === 'amount' && value === 0) return '';\r\n    return value || '';\r\n  };\r\n\r\n  const renderBookingBreakdown = () => {\r\n    debugLog('MBAio3htg5uohg: Rendering booking breakdown with data:', bookingData?.occurrences?.[0]);\r\n    const occurrences = bookingData?.occurrences;\r\n    if (!occurrences || occurrences.length === 0) return null;\r\n\r\n    // Get the user's timezone from context\r\n    const { timeSettings } = useContext(AuthContext);\r\n    const userTimezone = timeSettings?.timezone || 'US/Mountain';\r\n    debugLog('MBAio3htg5uohg: userTimezone: ', userTimezone);\r\n\r\n    // Check if we're dealing with multiple individual dates\r\n    // Updated logic to properly handle midnight end times\r\n    const isMultipleDates = occurrences.length > 1 || \r\n      // Consider a booking with 00:00 end time as a multiple date booking even if\r\n      // there's only one occurrence and end_date is different from start_date\r\n      (occurrences.length === 1 && \r\n       ((occurrences[0].end_date !== occurrences[0].start_date && occurrences[0].end_time === \"00:00\") ||\r\n        occurrences[0].start_date === occurrences[0].end_date));\r\n    \r\n    debugLog('MBAio3htg5uohg: isMultipleDates detection:', { \r\n      isMultipleDates, \r\n      count: occurrences.length,\r\n      firstOccurrence: occurrences[0] ? {\r\n        start_date: occurrences[0].start_date,\r\n        end_date: occurrences[0].end_date,\r\n        end_time: occurrences[0].end_time\r\n      } : null\r\n    });\r\n\r\n    if (isMultipleDates) {\r\n      return (\r\n        <View style={[styles.section, { marginTop: showEditControls ? 24 : 0 }]}>\r\n          <View style={styles.sectionHeaderContainer}>\r\n            <Text style={styles.sectionHeader}>Booking Breakdown</Text>\r\n          </View>\r\n          <View style={[styles.card, { paddingTop: 16 }]}>\r\n            {occurrences.map((occurrence, index) => {\r\n              // Ensure we have a valid unit_of_time - check in multiple places\r\n              const unitOfTime = \r\n                (occurrence.unit_of_time) || \r\n                (occurrence.rates && occurrence.rates.unit_of_time) || \r\n                'Per Visit';\r\n                \r\n              // Ensure multiple is properly formatted as a number\r\n              const multiple = parseFloat(occurrence.multiple) || 1;\r\n              \r\n              // Log each occurrence for debugging\r\n              debugLog('MBAio3htg5uohg: Processing occurrence in UI:', {\r\n                id: occurrence.occurrence_id,\r\n                unit_of_time: unitOfTime,\r\n                multiple: multiple,\r\n                calculated_cost: occurrence.calculated_cost\r\n              });\r\n              \r\n              return (\r\n                <View key={occurrence.occurrence_id} style={styles.multipleDatesContainer}>\r\n                  <View style={styles.dateHeader}>\r\n                    <View style={styles.dateTextContainer}>\r\n                      <Text style={styles.dateText}>\r\n                        {formatDateTimeRangeFromUTC({\r\n                          startDate: occurrence.start_date,\r\n                          startTime: occurrence.start_time,\r\n                          endDate: occurrence.end_date,\r\n                          endTime: occurrence.end_time,\r\n                          userTimezone: userTimezone,\r\n                          includeTimes: true,\r\n                          includeTimezone: true\r\n                        })}\r\n                      </Text>\r\n                    </View>\r\n                    <Text style={styles.occurrenceCost}>\r\n                      {formatCurrency(occurrence.calculated_cost)}\r\n                    </Text>\r\n                    {/* Edit/Cancel Button - moved here, only one icon */}\r\n                    {editingOccurrenceId === occurrence.occurrence_id ? (\r\n                      <TouchableOpacity onPress={handleCancelEdit}>\r\n                        <MaterialCommunityIcons name=\"close\" size={20} color={theme.colors.error} />\r\n                      </TouchableOpacity>\r\n                    ) : (\r\n                      showEditControls && (\r\n                        <TouchableOpacity onPress={() => handleEditOccurrence(occurrence)}>\r\n                          <MaterialCommunityIcons name=\"pencil\" size={20} color={theme.colors.mainColors.main} />\r\n                        </TouchableOpacity>\r\n                      )\r\n                    )}\r\n                  </View>\r\n\r\n                  {/* Collapsible Rates Section */}\r\n                  <TouchableOpacity \r\n                    style={styles.ratesToggleButton}\r\n                    onPress={() => {\r\n                      const newExpandedRates = new Set(expandedRates);\r\n                      if (newExpandedRates.has(occurrence.occurrence_id)) {\r\n                        newExpandedRates.delete(occurrence.occurrence_id);\r\n                      } else {\r\n                        newExpandedRates.add(occurrence.occurrence_id);\r\n                      }\r\n                      setExpandedRates(newExpandedRates);\r\n                    }}\r\n                  >\r\n                    <Text style={styles.ratesToggleText}>\r\n                      {expandedRates.has(occurrence.occurrence_id) ? 'Hide Rates' : 'Show Rates'}\r\n                    </Text>\r\n                    <MaterialCommunityIcons \r\n                      name={expandedRates.has(occurrence.occurrence_id) ? \"chevron-up\" : \"chevron-down\"} \r\n                      size={20} \r\n                      color={theme.colors.mainColors.main} \r\n                    />\r\n                  </TouchableOpacity>\r\n\r\n                  {expandedRates.has(occurrence.occurrence_id) && (\r\n                    <View style={styles.ratesBreakdown}>\r\n                      {/* Base Rate */}\r\n                      <View style={styles.rateItem}>\r\n                        {editingOccurrenceId === occurrence.occurrence_id ? (\r\n                          <View style={{ flexDirection: 'row', alignItems: 'center', justifyContent: 'space-between', width: '100%' }}>\r\n                            <Text style={styles.rateLabel}>Base Rate ({unitOfTime})</Text>\r\n                            <TextInput\r\n                              style={{ \r\n                                width: 80, \r\n                                borderWidth: 1,\r\n                                borderColor: theme.colors.border,\r\n                                borderRadius: 4,\r\n                                padding: 8\r\n                              }}\r\n                              keyboardType=\"decimal-pad\"\r\n                              value={occurrenceEdits.base_rate?.toString() || ''}\r\n                              onChangeText={v => handleOccurrenceInputChange('base_rate', v)}\r\n                            />\r\n                          </View>\r\n                        ) : (\r\n                          <View>\r\n                            <Text style={styles.rateLabel}>Base Rate</Text>\r\n                            <Text style={styles.breakdownCalculation}>\r\n                              {formatCurrency(occurrence.rates.base_rate)} ({unitOfTime}) × {multiple} = {formatCurrency(occurrence.base_total)}\r\n                            </Text>\r\n                          </View>\r\n                        )}\r\n                        {editingOccurrenceId === occurrence.occurrence_id ? null : (\r\n                          <Text style={styles.rateAmount}>{formatCurrency(occurrence.base_total)}</Text>\r\n                        )}\r\n                      </View>\r\n\r\n                      {/* Additional Animal Rate */}\r\n                      {occurrence.rates?.additional_animal_rate && parseFloat(occurrence.rates.additional_animal_rate) > 0 && occurrence.rates?.applies_after && occurrence.rates.applies_after < (bookingData.pets?.length || 0) && (\r\n                        <View style={styles.rateItem}>\r\n                          {editingOccurrenceId === occurrence.occurrence_id ? (\r\n                            <View style={{ flexDirection: 'row', alignItems: 'center', justifyContent: 'space-between', width: '100%' }}>\r\n                              <Text style={styles.rateLabel}>\r\n                                Additional Pet Rate (after {occurrence.rates.applies_after} {occurrence.rates.applies_after !== 1 ? 'pets' : 'pet'})\r\n                              </Text>\r\n                              <TextInput\r\n                                style={{ \r\n                                  width: 80, \r\n                                  borderWidth: 1,\r\n                                  borderColor: theme.colors.border,\r\n                                  borderRadius: 4,\r\n                                  padding: 8\r\n                                }}\r\n                                keyboardType=\"decimal-pad\"\r\n                                value={occurrenceEdits.additional_animal_rate?.toString() || ''}\r\n                                onChangeText={v => handleOccurrenceInputChange('additional_animal_rate', v)}\r\n                              />\r\n                            </View>\r\n                          ) : (\r\n                            <Text style={styles.rateLabel}>\r\n                              Additional Pet Rate (after {occurrence.rates.applies_after} {occurrence.rates.applies_after !== 1 ? 'pets' : 'pet'})\r\n                            </Text>\r\n                          )}\r\n                          {editingOccurrenceId === occurrence.occurrence_id ? null : (\r\n                            <Text style={styles.rateAmount}>{formatCurrency(occurrence.rates.additional_animal_rate)}</Text>\r\n                          )}\r\n                        </View>\r\n                      )}\r\n\r\n                      {/* Holiday Rate - only show if there are actually holiday days */}\r\n                      {occurrence.rates?.holiday_rate && parseFloat(occurrence.rates.holiday_rate) > 0 && \r\n                       (occurrence.rates?.holiday_days > 0 || !('holiday_days' in occurrence.rates)) && (\r\n                        <View style={styles.rateItem}>\r\n                          {editingOccurrenceId === occurrence.occurrence_id ? (\r\n                            <View style={{ flexDirection: 'row', alignItems: 'center', justifyContent: 'space-between', width: '100%' }}>\r\n                              <Text style={styles.rateLabel}>Holiday Rate</Text>\r\n                              <TextInput\r\n                                style={{ \r\n                                  width: 80, \r\n                                  borderWidth: 1,\r\n                                  borderColor: theme.colors.border,\r\n                                  borderRadius: 4,\r\n                                  padding: 8\r\n                                }}\r\n                                keyboardType=\"decimal-pad\"\r\n                                value={occurrenceEdits.holiday_rate?.toString() || ''}\r\n                                onChangeText={v => handleOccurrenceInputChange('holiday_rate', v)}\r\n                              />\r\n                            </View>\r\n                          ) : (\r\n                            <Text style={styles.rateLabel}>Holiday Rate</Text>\r\n                          )}\r\n                          {editingOccurrenceId === occurrence.occurrence_id ? null : (\r\n                            <Text style={styles.rateAmount}>{formatCurrency(occurrence.rates.holiday_rate)}</Text>\r\n                          )}\r\n                        </View>\r\n                      )}\r\n\r\n                      {/* Additional Rates */}\r\n                      {((isEditMode ? editedRates?.additional_rates : occurrence.rates?.additional_rates) || []).length > 0 ? \r\n                        ((isEditMode ? editedRates?.additional_rates : occurrence.rates?.additional_rates) || []).map((rate, index) => (\r\n                          <View key={index} style={styles.breakdownItem}>\r\n                            <View style={styles.breakdownLabelContainer}>\r\n                              {isEditMode || editingOccurrenceId === occurrence.occurrence_id ? (\r\n                                width < 600 ? (\r\n                                  // Mobile layout - stacked with trash icon on the right\r\n                                  <View style={{ width: '100%' }}>\r\n                                    <View style={{ flexDirection: 'row', alignItems: 'center', justifyContent: 'space-between' }}>\r\n                                      {/* Debug log for rate name */}\r\n                                      {debugLog(`MBA66778 Rendering rate at index ${index}:`, {\r\n                                        isEditMode,\r\n                                        editingOccurrenceId: editingOccurrenceId,\r\n                                        occurrenceId: occurrence.occurrence_id,\r\n                                        rateName: rate.name || rate.title,\r\n                                        rateAmount: rate.amount,\r\n                                        occurrenceEditsRate: occurrenceEdits.additional_rates?.[index],\r\n                                        valueToShow: editingOccurrenceId === occurrence.occurrence_id ? \r\n                                          (occurrenceEdits.additional_rates && occurrenceEdits.additional_rates[index]?.amount?.toString()) || '0' : \r\n                                          rate.amount?.toString() || '0'\r\n                                      })}\r\n                                      <TextInput\r\n                                        style={[styles.nameInput, { flex: 1, marginRight: 8 }]}\r\n                                        value={getAdditionalRateValue(occurrence, index, 'name')}\r\n                                        onChangeText={(value) => editingOccurrenceId === occurrence.occurrence_id ? \r\n                                          handleAdditionalRateChange(index, 'name', value) : \r\n                                          updateAdditionalRate(index, 'name', value)}\r\n                                        placeholder=\"Rate Name\"\r\n                                      />\r\n                                      <TouchableOpacity \r\n                                        style={styles.deleteButton} \r\n                                        onPress={() => editingOccurrenceId === occurrence.occurrence_id ? \r\n                                          deleteRateForOccurrence(occurrence, index) : \r\n                                          deleteAdditionalRate(index)}\r\n                                      >\r\n                                        <MaterialCommunityIcons \r\n                                          name=\"trash-can-outline\" \r\n                                          size={22} \r\n                                          color={theme.colors.error} \r\n                                        />\r\n                                      </TouchableOpacity>\r\n                                    </View>\r\n                                    <View style={{ marginTop: 8 }}>\r\n                                      <View style={{ flexDirection: 'row', alignItems: 'center' }}>\r\n                                        <Text style={{ marginRight: 8 }}>Amount: $</Text>\r\n                                        <TextInput\r\n                                          style={{ \r\n                                            width: 80, \r\n                                            borderWidth: 1,\r\n                                            borderColor: theme.colors.border,\r\n                                            borderRadius: 4,\r\n                                            padding: 8\r\n                                          }}\r\n                                          keyboardType=\"decimal-pad\"\r\n                                          value={getAdditionalRateValue(occurrence, index, 'amount') === '' ? '' : \r\n                                                getAdditionalRateValue(occurrence, index, 'amount').toString()}\r\n                                          onChangeText={(value) => editingOccurrenceId === occurrence.occurrence_id ? \r\n                                            handleAdditionalRateChange(index, 'amount', value) : \r\n                                            updateAdditionalRate(index, 'amount', value)}\r\n                                        />\r\n                                      </View>\r\n                                    </View>\r\n                                  </View>\r\n                                ) : (\r\n                                  // Desktop layout - side by side\r\n                                  <View style={styles.editableAdditionalRateRow}>\r\n                                    <View style={styles.rateNameAmountRowWithDelete}>\r\n                                      <TextInput\r\n                                        style={styles.nameInput}\r\n                                        value={getAdditionalRateValue(occurrence, index, 'name')}\r\n                                        onChangeText={(value) => editingOccurrenceId === occurrence.occurrence_id ? \r\n                                          handleAdditionalRateChange(index, 'name', value) : \r\n                                          updateAdditionalRate(index, 'name', value)}\r\n                                        placeholder=\"Rate Name\"\r\n                                      />\r\n                                      <View style={styles.amountInputContainer}>\r\n                                        <Text style={styles.currencySymbol}>$</Text>\r\n                                        <TextInput\r\n                                          style={styles.rateInput}\r\n                                          keyboardType=\"decimal-pad\"\r\n                                          value={getAdditionalRateValue(occurrence, index, 'amount') === '' ? '' : \r\n                                                getAdditionalRateValue(occurrence, index, 'amount').toString()}\r\n                                          onChangeText={(value) => editingOccurrenceId === occurrence.occurrence_id ? \r\n                                            handleAdditionalRateChange(index, 'amount', value) : \r\n                                            updateAdditionalRate(index, 'amount', value)}\r\n                                        />\r\n                                      </View>\r\n                                    </View>\r\n                                    <TouchableOpacity \r\n                                      style={styles.deleteButton} \r\n                                      onPress={() => editingOccurrenceId === occurrence.occurrence_id ? \r\n                                        deleteRateForOccurrence(occurrence, index) : \r\n                                        deleteAdditionalRate(index)}\r\n                                    >\r\n                                      <MaterialCommunityIcons \r\n                                        name=\"trash-can-outline\" \r\n                                        size={22} \r\n                                        color={theme.colors.error} \r\n                                      />\r\n                                    </TouchableOpacity>\r\n                                  </View>\r\n                                )\r\n                              ) : (\r\n                                <>\r\n                                  <Text style={styles.breakdownLabel}>{rate.name || rate.title}</Text>\r\n                                  <Text style={styles.breakdownCalculation}>{rate.description || \"Additional Rate\"}</Text>\r\n                                </>\r\n                              )}\r\n                            </View>\r\n                            {!isEditMode && editingOccurrenceId !== occurrence.occurrence_id && (\r\n                              <Text style={styles.breakdownAmount}>+{formatCurrency(rate.amount)}</Text>\r\n                            )}\r\n                          </View>\r\n                        ))\r\n                      : null}\r\n                    </View>\r\n                  )}\r\n\r\n                  {/* Add New Rate Form for individual occurrence */}\r\n                  {isAddingRateForOccurrence === occurrence.occurrence_id && (\r\n                    <View>\r\n                      <View style={styles.addRateContainer}>\r\n                        <View style={styles.formDivider} />\r\n                        \r\n                        {width < 600 ? (\r\n                          // Mobile layout - stacked\r\n                          <View>\r\n                            <TextInput\r\n                              style={[styles.nameInput, { marginRight: 0, marginBottom: 12 }]}\r\n                              value={newOccurrenceRate.name}\r\n                              onChangeText={(text) => setNewOccurrenceRate(prev => ({ ...prev, name: text }))}\r\n                              placeholder=\"Rate Name\"\r\n                              placeholderTextColor={theme.colors.placeHolderText}\r\n                            />\r\n                            <View style={[styles.amountInputContainer, { marginBottom: 12 }]}>\r\n                              <Text style={styles.currencySymbol}>$</Text>\r\n                              <TextInput\r\n                                style={styles.rateInput}\r\n                                keyboardType=\"decimal-pad\"\r\n                                value={newOccurrenceRate.amount}\r\n                                onChangeText={handleNewOccurrenceRateAmountChange}\r\n                                placeholder=\"0.00\"\r\n                                placeholderTextColor={theme.colors.placeHolderText}\r\n                              />\r\n                            </View>\r\n                            <TextInput\r\n                              style={styles.descriptionInput}\r\n                              value={newOccurrenceRate.description}\r\n                              onChangeText={(text) => setNewOccurrenceRate(prev => ({ ...prev, description: text }))}\r\n                              placeholder=\"Description (optional)\"\r\n                              placeholderTextColor={theme.colors.placeHolderText}\r\n                            />\r\n                          </View>\r\n                        ) : (\r\n                          // Desktop layout - side by side\r\n                          <>\r\n                            <View style={styles.rateNameAmountRow}>\r\n                              <TextInput\r\n                                style={styles.nameInput}\r\n                                value={newOccurrenceRate.name}\r\n                                onChangeText={(text) => setNewOccurrenceRate(prev => ({ ...prev, name: text }))}\r\n                                placeholder=\"Rate Name\"\r\n                                placeholderTextColor={theme.colors.placeHolderText}\r\n                              />\r\n                              <View style={styles.amountInputContainer}>\r\n                                <Text style={styles.currencySymbol}>$</Text>\r\n                                <TextInput\r\n                                  style={styles.rateInput}\r\n                                  keyboardType=\"decimal-pad\"\r\n                                  value={newOccurrenceRate.amount}\r\n                                  onChangeText={handleNewOccurrenceRateAmountChange}\r\n                                  placeholder=\"0.00\"\r\n                                  placeholderTextColor={theme.colors.placeHolderText}\r\n                                />\r\n                              </View>\r\n                            </View>\r\n                            \r\n                            <TextInput\r\n                              style={styles.descriptionInput}\r\n                              value={newOccurrenceRate.description}\r\n                              onChangeText={(text) => setNewOccurrenceRate(prev => ({ ...prev, description: text }))}\r\n                              placeholder=\"Description (optional)\"\r\n                              placeholderTextColor={theme.colors.placeHolderText}\r\n                            />\r\n                          </>\r\n                        )}\r\n                        \r\n                        <View style={styles.formDivider} />\r\n                      </View>\r\n                      <View style={styles.buttonsContainer}>\r\n                        <TouchableOpacity style={styles.cancelButton} onPress={() => setIsAddingRateForOccurrence(null)}>\r\n                          <Text style={styles.cancelButtonText}>Cancel</Text>\r\n                        </TouchableOpacity>\r\n                        <TouchableOpacity style={styles.saveButton} onPress={() => saveNewRateForOccurrence(occurrence)}>\r\n                          <Text style={styles.saveButtonText}>Save New Rate</Text>\r\n                        </TouchableOpacity>\r\n                      </View>\r\n                    </View>\r\n                  )}\r\n\r\n                  {/* Add Rate and Save buttons for edit mode for this occurrence */}\r\n                  {editingOccurrenceId === occurrence.occurrence_id && !isAddingRateForOccurrence && (\r\n                    <View style={styles.buttonsContainer}>\r\n                      <TouchableOpacity \r\n                        style={styles.cancelButton} \r\n                        onPress={() => toggleAddRateForOccurrence(occurrence.occurrence_id)}\r\n                      >\r\n                        <Text style={styles.cancelButtonText}>+ Add Rate</Text>\r\n                      </TouchableOpacity>\r\n                      <TouchableOpacity \r\n                        style={styles.saveButton} \r\n                        onPress={() => handleSaveOccurrenceRates(occurrence)}\r\n                      >\r\n                        <Text style={styles.saveButtonText}>Save Changes</Text>\r\n                      </TouchableOpacity>\r\n                    </View>\r\n                  )}\r\n                </View>\r\n              );\r\n            })}\r\n          </View>\r\n        </View>\r\n      );\r\n    }\r\n   \r\n    // Rest of the function for non-multiple dates case\r\n    const occurrence = occurrences[0];\r\n    if (!occurrence) return null;\r\n\r\n    const formattedDateRange = formatDateTimeRangeFromUTC({\r\n      startDate: occurrence.start_date,\r\n      startTime: occurrence.start_time,\r\n      endDate: occurrence.end_date,\r\n      endTime: occurrence.end_time,\r\n      userTimezone: userTimezone,\r\n      includeTimes: true,\r\n      includeTimezone: true\r\n    });\r\n\r\n    debugLog('MBA54321 Formatted date range:', formattedDateRange);\r\n\r\n    // Initialize rates object if it doesn't exist\r\n    if (!occurrence.rates) {\r\n      debugLog('MBA54321 occurrence.rates is undefined, initializing with defaults');\r\n      occurrence.rates = {\r\n        base_rate: 0,\r\n        additional_animal_rate: 0,\r\n        applies_after: 1,\r\n        holiday_rate: 0,\r\n        holiday_days: 0,\r\n        additional_rates: []\r\n      };\r\n    }\r\n\r\n    return (\r\n      <View style={[styles.section, { marginTop: showEditControls ? 24 : 0 }]}>\r\n        <View style={styles.sectionHeaderContainer}>\r\n          <Text style={styles.sectionHeader}>Booking Breakdown</Text>\r\n        </View>\r\n        <View style={[styles.card, { paddingTop: 16 }]}>\r\n          <View style={styles.breakdownSection}>\r\n            <View style={styles.dateHeader}>\r\n              <View style={styles.dateTextContainer}>\r\n                <Text style={styles.dateText}>\r\n                  {formatDateTimeRangeFromUTC({\r\n                    startDate: occurrence.start_date,\r\n                    startTime: occurrence.start_time,\r\n                    endDate: occurrence.end_date,\r\n                    endTime: occurrence.end_time,\r\n                    userTimezone: userTimezone,\r\n                    includeTimes: true,\r\n                    includeTimezone: true\r\n                  })}\r\n                </Text>\r\n              </View>\r\n              <Text style={styles.occurrenceCost}>\r\n                {formatCurrency(occurrence.calculated_cost)}\r\n              </Text>\r\n              {/* Edit/Cancel Button - moved here, only one icon */}\r\n              {editingOccurrenceId === occurrence.occurrence_id ? (\r\n                <TouchableOpacity onPress={handleCancelEdit}>\r\n                  <MaterialCommunityIcons name=\"close\" size={20} color={theme.colors.error} />\r\n                </TouchableOpacity>\r\n              ) : (\r\n                showEditControls && (\r\n                  <TouchableOpacity onPress={() => handleEditOccurrence(occurrence)}>\r\n                    <MaterialCommunityIcons name=\"pencil\" size={20} color={theme.colors.mainColors.main} />\r\n                  </TouchableOpacity>\r\n                )\r\n              )}\r\n            </View>\r\n            \r\n            {/* Base Rate */}\r\n            <View style={styles.breakdownItem}>\r\n              <View style={styles.breakdownLabelContainer}>\r\n                <View style={styles.rateNameAmountRow}>\r\n                  <Text style={styles.breakdownLabel}>\r\n                    Base Rate ({(occurrence.unit_of_time) || \r\n                              (occurrence.rates && occurrence.rates.unit_of_time) || \r\n                              'Per Visit'})\r\n                  </Text>\r\n                  {isEditMode || editingOccurrenceId === occurrence.occurrence_id ? (\r\n                    <View style={styles.amountInputContainer}>\r\n                      <Text style={styles.currencySymbol}>$</Text>\r\n                      <TextInput\r\n                        style={styles.rateInput}\r\n                        keyboardType=\"decimal-pad\"\r\n                        value={editingOccurrenceId === occurrence.occurrence_id ? \r\n                          occurrenceEdits.base_rate?.toString() || '0' : \r\n                          editedRates?.base_rate?.toString() || '0'}\r\n                        onChangeText={editingOccurrenceId === occurrence.occurrence_id ? \r\n                          v => handleOccurrenceInputChange('base_rate', v) : \r\n                          updateBaseRate}\r\n                      />\r\n                    </View>\r\n                  ) : null}\r\n                </View>\r\n                {!isEditMode && editingOccurrenceId !== occurrence.occurrence_id && (\r\n                  <Text style={styles.breakdownCalculation}>\r\n                    {occurrence.multiple || 1} × {formatCurrency(occurrence.rates?.base_rate || 0)} = {formatCurrency(occurrence.base_total || occurrence.rates?.base_rate || 0)}\r\n                  </Text>\r\n                )}\r\n              </View>\r\n              {!isEditMode && editingOccurrenceId !== occurrence.occurrence_id && (\r\n                <Text style={styles.breakdownAmount}>{formatCurrency(occurrence.base_total || occurrence.rates?.base_rate || 0)}</Text>\r\n              )}\r\n            </View>\r\n            \r\n            {/* Additional Animal Rate */}\r\n            {occurrence.rates?.additional_animal_rate && occurrence.rates?.applies_after && occurrence.rates.applies_after < (bookingData.pets?.length || 0) ? (\r\n              <View style={styles.breakdownItem}>\r\n                <View style={styles.breakdownLabelContainer}>\r\n                  <View style={styles.rateNameAmountRow}>\r\n                    <Text style={styles.breakdownLabel}>\r\n                      Additional Pet Rate (after {occurrence.rates?.applies_after || 1} {occurrence.rates?.applies_after !== 1 ? 'pets' : 'pet'})\r\n                    </Text>\r\n                    {isEditMode || editingOccurrenceId === occurrence.occurrence_id ? (\r\n                      <View style={styles.amountInputContainer}>\r\n                        <Text style={styles.currencySymbol}>$</Text>\r\n                        <TextInput\r\n                          style={styles.rateInput}\r\n                          keyboardType=\"decimal-pad\"\r\n                          value={editingOccurrenceId === occurrence.occurrence_id ? \r\n                            occurrenceEdits.additional_animal_rate?.toString() || '0' : \r\n                            editedRates?.additional_animal_rate?.toString() || '0'}\r\n                          onChangeText={editingOccurrenceId === occurrence.occurrence_id ? \r\n                            v => handleOccurrenceInputChange('additional_animal_rate', v) : \r\n                            updateAdditionalAnimalRate}\r\n                        />\r\n                        <Text style={styles.inputLabel}> / pet / {(occurrence.unit_of_time) || \r\n                                                                (occurrence.rates && occurrence.rates.unit_of_time) || \r\n                                                                'Per Visit'}</Text>\r\n                      </View>\r\n                    ) : null}\r\n                  </View>\r\n                  {!isEditMode && editingOccurrenceId !== occurrence.occurrence_id && (\r\n                    <Text style={styles.breakdownCalculation}>\r\n                      ${occurrence.rates?.additional_animal_rate || 0} / pet / {(occurrence.unit_of_time) || \r\n                                                                              (occurrence.rates && occurrence.rates.unit_of_time) || \r\n                                                                              'Per Visit'}\r\n                    </Text>\r\n                  )}\r\n                </View>\r\n                {!isEditMode && editingOccurrenceId !== occurrence.occurrence_id && (\r\n                  <Text style={styles.breakdownAmount}>\r\n                    {(occurrence.rates?.applies_after && occurrence.rates.applies_after < (bookingData.pets?.length || 0)) ? '+' : ''}\r\n                    {(occurrence.rates?.applies_after && occurrence.rates.applies_after < (bookingData.pets?.length || 0)) \r\n                      ? formatCurrency(occurrence.rates?.additional_animal_rate_total || occurrence.rates?.additional_animal_rate || 0) \r\n                      : 'NA'}\r\n                  </Text>\r\n                )}\r\n              </View>\r\n            ) : null}\r\n            \r\n            {/* Holiday Rate */}\r\n            {occurrence.rates?.holiday_rate && occurrence.rates?.holiday_days && occurrence.rates.holiday_days > 0 ? (\r\n              <View style={[styles.breakdownItem, { borderBottomWidth: (occurrence.rates?.additional_rates?.length > 0 || isAddingRate) ? 1 : 0 }]}>\r\n                <View style={styles.breakdownLabelContainer}>\r\n                  <View style={styles.rateNameAmountRow}>\r\n                    <Text style={styles.breakdownLabel}>\r\n                      Holiday Rate\r\n                    </Text>\r\n                    {isEditMode || editingOccurrenceId === occurrence.occurrence_id ? (\r\n                      <View style={styles.amountInputContainer}>\r\n                        <Text style={styles.currencySymbol}>$</Text>\r\n                        <TextInput\r\n                          style={styles.rateInput}\r\n                          keyboardType=\"decimal-pad\"\r\n                          value={editingOccurrenceId === occurrence.occurrence_id ? \r\n                            occurrenceEdits.holiday_rate?.toString() || '0' : \r\n                            editedRates?.holiday_rate?.toString() || '0'}\r\n                          onChangeText={editingOccurrenceId === occurrence.occurrence_id ? \r\n                            v => handleOccurrenceInputChange('holiday_rate', v) : \r\n                            updateHolidayRate}\r\n                        />\r\n                        <Text style={styles.inputLabel}> × {occurrence.rates?.holiday_days || 0} {occurrence.rates?.holiday_days !== 1 ? 'holidays' : 'holiday'}</Text>\r\n                      </View>\r\n                    ) : null}\r\n                  </View>\r\n                  {!isEditMode && editingOccurrenceId !== occurrence.occurrence_id && (\r\n                    <Text style={styles.breakdownCalculation}>\r\n                      {formatCurrency(occurrence.rates?.holiday_rate || 0)} × {occurrence.rates?.holiday_days || 0} {occurrence.rates?.holiday_days !== 1 ? 'holidays' : 'holiday'}\r\n                    </Text>\r\n                  )}\r\n                </View>\r\n                {!isEditMode && editingOccurrenceId !== occurrence.occurrence_id && (\r\n                  <Text style={styles.breakdownAmount}>\r\n                    {occurrence.rates?.holiday_days ? '+' : ''}\r\n                    {occurrence.rates?.holiday_days ? formatCurrency(occurrence.rates?.holiday_rate_total || occurrence.rates?.holiday_rate || 0) : 'NA'}\r\n                  </Text>\r\n                )}\r\n              </View>\r\n            ) : null}\r\n            \r\n            {/* Additional Rates */}\r\n            {((isEditMode ? editedRates?.additional_rates : occurrence.rates?.additional_rates) || []).length > 0 ? \r\n              ((isEditMode ? editedRates?.additional_rates : occurrence.rates?.additional_rates) || []).map((rate, index) => (\r\n                <View key={index} style={styles.breakdownItem}>\r\n                  <View style={styles.breakdownLabelContainer}>\r\n                    {isEditMode || editingOccurrenceId === occurrence.occurrence_id ? (\r\n                      width < 600 ? (\r\n                        // Mobile layout - stacked with trash icon on the right\r\n                        <View style={{ width: '100%' }}>\r\n                          <View style={{ flexDirection: 'row', alignItems: 'center', justifyContent: 'space-between' }}>\r\n                            {/* Debug log for rate name */}\r\n                            {debugLog(`MBA66778 Rendering rate at index ${index}:`, {\r\n                              isEditMode,\r\n                              editingOccurrenceId: editingOccurrenceId,\r\n                              occurrenceId: occurrence.occurrence_id,\r\n                              rateName: rate.name || rate.title,\r\n                              rateAmount: rate.amount,\r\n                              occurrenceEditsRate: occurrenceEdits.additional_rates?.[index],\r\n                              valueToShow: editingOccurrenceId === occurrence.occurrence_id ? \r\n                                (occurrenceEdits.additional_rates && occurrenceEdits.additional_rates[index]?.amount?.toString()) || '0' : \r\n                                rate.amount?.toString() || '0'\r\n                            })}\r\n                            <TextInput\r\n                              style={[styles.nameInput, { flex: 1, marginRight: 8 }]}\r\n                              value={getAdditionalRateValue(occurrence, index, 'name')}\r\n                              onChangeText={(value) => editingOccurrenceId === occurrence.occurrence_id ? \r\n                                handleAdditionalRateChange(index, 'name', value) : \r\n                                updateAdditionalRate(index, 'name', value)}\r\n                              placeholder=\"Rate Name\"\r\n                            />\r\n                            <TouchableOpacity \r\n                              style={styles.deleteButton} \r\n                              onPress={() => editingOccurrenceId === occurrence.occurrence_id ? \r\n                                deleteRateForOccurrence(occurrence, index) : \r\n                                deleteAdditionalRate(index)}\r\n                            >\r\n                              <MaterialCommunityIcons \r\n                                name=\"trash-can-outline\" \r\n                                size={22} \r\n                                color={theme.colors.error} \r\n                              />\r\n                            </TouchableOpacity>\r\n                          </View>\r\n                          <View style={{ marginTop: 8 }}>\r\n                            <View style={{ flexDirection: 'row', alignItems: 'center' }}>\r\n                              <Text style={{ marginRight: 8 }}>Amount: $</Text>\r\n                              <TextInput\r\n                                style={{ \r\n                                  width: 80, \r\n                                  borderWidth: 1,\r\n                                  borderColor: theme.colors.border,\r\n                                  borderRadius: 4,\r\n                                  padding: 8\r\n                                }}\r\n                                keyboardType=\"decimal-pad\"\r\n                                value={getAdditionalRateValue(occurrence, index, 'amount') === '' ? '' : \r\n                                      getAdditionalRateValue(occurrence, index, 'amount').toString()}\r\n                                onChangeText={(value) => editingOccurrenceId === occurrence.occurrence_id ? \r\n                                  handleAdditionalRateChange(index, 'amount', value) : \r\n                                  updateAdditionalRate(index, 'amount', value)}\r\n                              />\r\n                            </View>\r\n                          </View>\r\n                        </View>\r\n                      ) : (\r\n                        // Desktop layout - side by side\r\n                        <View style={styles.editableAdditionalRateRow}>\r\n                          <View style={styles.rateNameAmountRowWithDelete}>\r\n                            <TextInput\r\n                              style={styles.nameInput}\r\n                              value={getAdditionalRateValue(occurrence, index, 'name')}\r\n                              onChangeText={(value) => editingOccurrenceId === occurrence.occurrence_id ? \r\n                                handleAdditionalRateChange(index, 'name', value) : \r\n                                updateAdditionalRate(index, 'name', value)}\r\n                              placeholder=\"Rate Name\"\r\n                            />\r\n                            <View style={styles.amountInputContainer}>\r\n                              <Text style={styles.currencySymbol}>$</Text>\r\n                              <TextInput\r\n                                style={styles.rateInput}\r\n                                keyboardType=\"decimal-pad\"\r\n                                value={getAdditionalRateValue(occurrence, index, 'amount') === '' ? '' : \r\n                                      getAdditionalRateValue(occurrence, index, 'amount').toString()}\r\n                                onChangeText={(value) => editingOccurrenceId === occurrence.occurrence_id ? \r\n                                  handleAdditionalRateChange(index, 'amount', value) : \r\n                                  updateAdditionalRate(index, 'amount', value)}\r\n                              />\r\n                            </View>\r\n                          </View>\r\n                          <TouchableOpacity \r\n                            style={styles.deleteButton} \r\n                            onPress={() => editingOccurrenceId === occurrence.occurrence_id ? \r\n                              deleteRateForOccurrence(occurrence, index) : \r\n                              deleteAdditionalRate(index)}\r\n                          >\r\n                            <MaterialCommunityIcons \r\n                              name=\"trash-can-outline\" \r\n                              size={22} \r\n                              color={theme.colors.error} \r\n                            />\r\n                          </TouchableOpacity>\r\n                        </View>\r\n                      )\r\n                    ) : (\r\n                      <>\r\n                        <Text style={styles.breakdownLabel}>{rate.name || rate.title}</Text>\r\n                        <Text style={styles.breakdownCalculation}>{rate.description || \"Additional Rate\"}</Text>\r\n                      </>\r\n                    )}\r\n                  </View>\r\n                  {!isEditMode && editingOccurrenceId !== occurrence.occurrence_id && (\r\n                    <Text style={styles.breakdownAmount}>+{formatCurrency(rate.amount)}</Text>\r\n                  )}\r\n                </View>\r\n              ))\r\n            : null}\r\n            \r\n            {/* Add New Rate Form */}\r\n            {isAddingRate ? (\r\n              <View>\r\n                <View style={styles.addRateContainer}>\r\n                  <View style={styles.formDivider} />\r\n                  \r\n                  {width < 600 ? (\r\n                    // Mobile layout - stacked\r\n                    <View>\r\n                      <TextInput\r\n                        style={[styles.nameInput, { marginRight: 0, marginBottom: 12 }]}\r\n                        value={newRate.name}\r\n                        onChangeText={(text) => setNewRate(prev => ({ ...prev, name: text }))}\r\n                        placeholder=\"Rate Name\"\r\n                        placeholderTextColor={theme.colors.placeHolderText}\r\n                      />\r\n                      <View style={[styles.amountInputContainer, { marginBottom: 12 }]}>\r\n                        <Text style={styles.currencySymbol}>$</Text>\r\n                        <TextInput\r\n                          style={styles.rateInput}\r\n                          keyboardType=\"decimal-pad\"\r\n                          value={newRate.amount}\r\n                          onChangeText={handleNewRateAmountChange}\r\n                          placeholder=\"0.00\"\r\n                          placeholderTextColor={theme.colors.placeHolderText}\r\n                        />\r\n                      </View>\r\n                      <TextInput\r\n                        style={styles.descriptionInput}\r\n                        value={newRate.description}\r\n                        onChangeText={(text) => setNewRate(prev => ({ ...prev, description: text }))}\r\n                        placeholder=\"Description (optional)\"\r\n                        placeholderTextColor={theme.colors.placeHolderText}\r\n                      />\r\n                    </View>\r\n                  ) : (\r\n                    // Desktop layout - side by side\r\n                    <>\r\n                      <View style={styles.rateNameAmountRow}>\r\n                        <TextInput\r\n                          style={styles.nameInput}\r\n                          value={newRate.name}\r\n                          onChangeText={(text) => setNewRate(prev => ({ ...prev, name: text }))}\r\n                          placeholder=\"Rate Name\"\r\n                          placeholderTextColor={theme.colors.placeHolderText}\r\n                        />\r\n                        <View style={styles.amountInputContainer}>\r\n                          <Text style={styles.currencySymbol}>$</Text>\r\n                          <TextInput\r\n                            style={styles.rateInput}\r\n                            keyboardType=\"decimal-pad\"\r\n                            value={newRate.amount}\r\n                            onChangeText={handleNewRateAmountChange}\r\n                            placeholder=\"0.00\"\r\n                            placeholderTextColor={theme.colors.placeHolderText}\r\n                          />\r\n                        </View>\r\n                      </View>\r\n                      \r\n                      <TextInput\r\n                        style={styles.descriptionInput}\r\n                        value={newRate.description}\r\n                        onChangeText={(text) => setNewRate(prev => ({ ...prev, description: text }))}\r\n                        placeholder=\"Description (optional)\"\r\n                        placeholderTextColor={theme.colors.placeHolderText}\r\n                      />\r\n                    </>\r\n                  )}\r\n                  \r\n                  <View style={styles.formDivider} />\r\n                </View>\r\n                <View style={styles.buttonsContainer}>\r\n                  <TouchableOpacity style={styles.cancelButton} onPress={toggleAddRate}>\r\n                    <Text style={styles.cancelButtonText}>Cancel</Text>\r\n                  </TouchableOpacity>\r\n                  <TouchableOpacity style={styles.saveButton} onPress={saveNewRate}>\r\n                    <Text style={styles.saveButtonText}>Save New Rate</Text>\r\n                  </TouchableOpacity>\r\n                </View>\r\n              </View>\r\n            ) : null}\r\n            \r\n            {/* Add buttons for edit mode on single occurrence bookings */}\r\n            {isEditMode && !isAddingRate && (\r\n              <View style={styles.buttonsContainer}>\r\n                <TouchableOpacity style={styles.cancelButton} onPress={toggleAddRate}>\r\n                  <Text style={styles.cancelButtonText}>+ Add Rate</Text>\r\n                </TouchableOpacity>\r\n                <TouchableOpacity style={styles.saveButton} onPress={saveRateChanges}>\r\n                  <Text style={styles.saveButtonText}>Save Changes</Text>\r\n                </TouchableOpacity>\r\n              </View>\r\n            )}\r\n          </View>\r\n        </View>\r\n      </View>\r\n    );\r\n  };\r\n\r\n  const renderTotalAmount = () => {\r\n    debugLog('MBA54321 Rendering total amount with data:', bookingData?.cost_summary);\r\n    \r\n    // Create default cost summary in case it's missing\r\n    const defaultCostSummary = {\r\n      subtotal: 0,\r\n      client_platform_fee: 0,\r\n      pro_platform_fee: 0,\r\n      taxes: 0,\r\n      tax_state: '',\r\n      total_client_cost: 0,\r\n      total_sitter_payout: 0,\r\n      pro_subscription_plan: 0\r\n    };\r\n    \r\n    // Use the actual cost summary or our default\r\n    const costSummary = bookingData?.cost_summary || defaultCostSummary;\r\n\r\n    return (\r\n      <View style={styles.section}>\r\n        <Text style={styles.sectionHeader}>Cost Summary</Text>\r\n        <View style={[styles.card, { paddingTop: 16 }]}>\r\n          <View style={styles.subtotalRow}>\r\n            <Text style={styles.subtotalLabel}>Subtotal</Text>\r\n            <Text style={styles.subtotalAmount}>{formatCurrency(costSummary.subtotal)}</Text>\r\n          </View>\r\n          \r\n          {/* Platform Fee */}\r\n          <View style={styles.feeRow}>\r\n            <Text style={styles.feeLabel}>Service Fee</Text>\r\n            <Text style={styles.feeAmount}>{formatCurrency(costSummary.client_platform_fee)}</Text>\r\n          </View>\r\n          \r\n          {/* Taxes */}\r\n          <View style={styles.feeRow}>\r\n            <Text style={styles.feeLabel}>{costSummary.tax_state}{costSummary.tax_state ? ' - ' : ''}Taxes</Text>\r\n            <Text style={styles.feeAmount}>{formatCurrency(costSummary.taxes)}</Text>\r\n          </View>\r\n\r\n          {/* Total Owner Cost */}\r\n          <View style={[styles.totalAmountContainer, { paddingBottom: isProfessional ? 16 : 0, marginBottom: isProfessional ? 16 : 0 }]}>\r\n            <Text style={styles.totalLabel}>Total Owner Cost</Text>\r\n            <Text style={styles.totalAmount}>{formatCurrency(costSummary.total_client_cost)}</Text>\r\n          </View>\r\n\r\n          {/* Divider */}\r\n          {isProfessional ? <View style={styles.divider} /> : null}\r\n\r\n          {/* Professional Payout - Only show when isProfessional is true */}\r\n          {isProfessional ? (\r\n            <View style={styles.payoutContainer}>\r\n              <Text style={styles.payoutLabel}>Professional Payout</Text>\r\n              <Text style={styles.payoutAmount}>{formatCurrency(costSummary.total_sitter_payout)}</Text>\r\n              <Text style={styles.payoutBreakdown}>\r\n                (Subtotal {formatCurrency(costSummary.subtotal)} - Service Fee {formatCurrency(costSummary.pro_platform_fee)})\r\n              </Text>\r\n              {costSummary.pro_platform_fee === 0 ? (\r\n                <Text style={styles.badge}>{costSummary.pro_subscription_plan === 0 ? 'Free Tier - ' \r\n                  : costSummary.pro_subscription_plan === 1 ? 'Waitlist Tier - ' \r\n                  : costSummary.pro_subscription_plan === 2 ? 'Commission Tier - ' \r\n                  : costSummary.pro_subscription_plan === 3 ? 'Pro Subscription - ' \r\n                  : costSummary.pro_subscription_plan === 4 ? 'Pro Subscription - ' \r\n                  :  costSummary.pro_subscription_plan === 5 ? 'Client Subscription - ' \r\n                  : ''} Saved {formatCurrency(costSummary.subtotal * 0.15)}</Text>\r\n              ) : null}\r\n            </View>\r\n          ) : null}\r\n        </View>\r\n      </View>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <ScrollView style={styles.container} contentContainerStyle={styles.contentContainer}>\r\n      {renderBookingBreakdown()}\r\n      {renderTotalAmount()}\r\n    </ScrollView>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    backgroundColor: theme.colors.background,\r\n  },\r\n  contentContainer: {\r\n    padding: 16,\r\n  },\r\n  section: {\r\n    marginTop: 24,\r\n  },\r\n  badge: {\r\n    fontSize: 12,\r\n    color: theme.colors.whiteText,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    fontWeight: 'bold',\r\n    backgroundColor: theme.colors.mainColors.main,\r\n    paddingHorizontal: 8,\r\n    paddingVertical: 4,\r\n    borderRadius: 4,\r\n    marginTop: 4,\r\n  },\r\n  sectionHeaderContainer: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    marginBottom: 8,\r\n  },\r\n  sectionHeader: {\r\n    fontSize: 20,\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n    color: theme.colors.text,\r\n    marginBottom: 8,\r\n  },\r\n  addRateText: {\r\n    color: theme.colors.mainColors.main,\r\n    fontSize: 14,\r\n    fontWeight: '600',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  card: {\r\n    backgroundColor: theme.colors.surfaceContrast,\r\n    borderRadius: 8,\r\n    paddingHorizontal: 16,\r\n    paddingBottom: 16,\r\n    shadowColor: '#000',\r\n    shadowOffset: { width: 0, height: 2 },\r\n    shadowOpacity: 0.1,\r\n    shadowRadius: 4,\r\n    elevation: 3,\r\n  },\r\n  breakdownSection: {\r\n    width: '100%',\r\n  },\r\n  dateHeader: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    marginBottom: 16,\r\n  },\r\n  dateTextContainer: {\r\n    flex: 1,\r\n    marginRight: 8,\r\n  },\r\n  dateText: {\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  breakdownItem: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    paddingVertical: 12,\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: theme.colors.border,\r\n  },\r\n  breakdownLabelContainer: {\r\n    flex: 1,\r\n    marginRight: 16,\r\n  },\r\n  breakdownLabel: {\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  breakdownCalculation: {\r\n    fontSize: 14,\r\n    color: theme.colors.placeHolderText,\r\n    marginTop: 4,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  breakdownAmount: {\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n    fontWeight: '600',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  totalItem: {\r\n    marginTop: 8,\r\n    paddingTop: 16,\r\n  },\r\n  // Fee and total styles\r\n  subtotalRow: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    marginBottom: 12,\r\n    paddingBottom: 12,\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: theme.colors.border,\r\n  },\r\n  subtotalLabel: {\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  subtotalAmount: {\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n    fontWeight: '600',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  feeRow: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    marginBottom: 12,\r\n    paddingBottom: 12,\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: theme.colors.border,\r\n  },\r\n  feeLabel: {\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  feeAmount: {\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  totalAmountContainer: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    marginBottom: 16,\r\n    paddingBottom: 16,\r\n  },\r\n  totalLabel: {\r\n    fontSize: 16,\r\n    fontWeight: '600',\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  totalAmount: {\r\n    fontSize: 18,\r\n    fontWeight: '700',\r\n    color: theme.colors.mainColors.main,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  divider: {\r\n    height: 1,\r\n    backgroundColor: theme.colors.border,\r\n    marginBottom: 16,\r\n  },\r\n  payoutContainer: {\r\n    alignItems: 'flex-end',\r\n  },\r\n  payoutLabel: {\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  payoutAmount: {\r\n    fontSize: 18,\r\n    fontWeight: '700',\r\n    color: theme.colors.success,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    marginTop: 4,\r\n  },\r\n  payoutBreakdown: {\r\n    fontSize: 12,\r\n    color: theme.colors.placeHolderText,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    marginTop: 4,\r\n  },\r\n  // Input styles for editable fields\r\n  inputContainer: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    marginTop: 4,\r\n  },\r\n  addRateContainer: {\r\n    padding: 16,\r\n    width: '100%',\r\n  },\r\n  rateNameAmountRow: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    width: '100%',\r\n    marginBottom: 12,\r\n  },\r\n  rateEditContainer: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    marginTop: 8,\r\n  },\r\n  amountInputContainer: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    minWidth: 120,\r\n    maxWidth: 150,\r\n  },\r\n  rateInput: {\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    borderRadius: 4,\r\n    paddingVertical: 8,\r\n    paddingHorizontal: 12,\r\n    minWidth: 100,\r\n    flex: 1,\r\n  },\r\n  currencySymbol: {\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    marginRight: 4,\r\n    marginLeft: 2,\r\n  },\r\n  inputLabel: {\r\n    fontSize: 14,\r\n    color: theme.colors.placeHolderText,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    marginLeft: 4,\r\n  },\r\n  nameInput: {\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    borderRadius: 4,\r\n    paddingVertical: 8,\r\n    paddingHorizontal: 12,\r\n    flex: 1,\r\n    marginRight: 16,\r\n  },\r\n  descriptionInput: {\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    borderRadius: 4,\r\n    paddingVertical: 8,\r\n    paddingHorizontal: 12,\r\n    width: '100%',\r\n  },\r\n  saveButton: {\r\n    backgroundColor: theme.colors.mainColors.main,\r\n    borderRadius: 4,\r\n    paddingVertical: 12,\r\n    paddingHorizontal: 20,\r\n    marginTop: 0,\r\n    marginBottom: 0,\r\n    marginRight: 0,\r\n  },\r\n  saveButtonText: {\r\n    color: 'white',\r\n    fontSize: 16,\r\n    fontWeight: '600',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  formDivider: {\r\n    height: 1,\r\n    backgroundColor: theme.colors.border,\r\n    marginVertical: 12,\r\n    width: '100%',\r\n  },\r\n  editableAdditionalRateRow: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    justifyContent: 'space-between',\r\n    width: '100%',\r\n  },\r\n  rateNameAmountRowWithDelete: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    flex: 1,\r\n    marginRight: 8,\r\n  },\r\n  deleteButton: {\r\n    padding: 8,\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 4,\r\n    marginLeft: 8,\r\n  },\r\n  buttonsContainer: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'flex-end',\r\n    alignItems: 'center',\r\n    marginTop: 16,\r\n    marginBottom: 8,\r\n    marginRight: 16,\r\n  },\r\n  cancelButton: {\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 4,\r\n    paddingVertical: 12,\r\n    paddingHorizontal: 20,\r\n    marginRight: 12,\r\n  },\r\n  cancelButtonText: {\r\n    color: theme.colors.text,\r\n    fontSize: 16,\r\n    fontWeight: '600',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  multipleDatesContainer: {\r\n    marginBottom: 16,\r\n  },\r\n  occurrenceCost: {\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    fontWeight: '600',\r\n  },\r\n  ratesToggleButton: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    justifyContent: 'space-between',\r\n    padding: 8,\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 4,\r\n  },\r\n  ratesToggleText: {\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  ratesBreakdown: {\r\n    padding: 16,\r\n  },\r\n  rateItem: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    marginBottom: 8,\r\n  },\r\n  rateLabel: {\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  rateAmount: {\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    fontWeight: '600',\r\n  },\r\n  rateDescription: {\r\n    fontSize: 14,\r\n    color: theme.colors.placeHolderText,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  occurrenceDivider: {\r\n    height: 1,\r\n    backgroundColor: theme.colors.border,\r\n    marginBottom: 16,\r\n  },\r\n});\r\n\r\nexport default ReviewAndRatesCard; ","import React, { useState, useEffect, useContext, useRef } from 'react';\r\nimport {\r\n  Modal,\r\n  View,\r\n  Text,\r\n  StyleSheet,\r\n  TouchableOpacity,\r\n  ScrollView,\r\n  SafeAreaView,\r\n  ActivityIndicator,\r\n  TextInput,\r\n  Dimensions,\r\n  Platform\r\n} from 'react-native';\r\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\r\nimport { theme } from '../styles/theme';\r\nimport { AuthContext, debugLog } from '../context/AuthContext';\r\nimport ReviewAndRatesCard from './bookingComponents/ReviewAndRatesCard';\r\nimport { getBookingDetails, approveBooking, requestBookingChanges } from '../api/API';\r\nimport { capitalizeWords } from '../utils/formatStrings';\r\n\r\nconst BookingApprovalModal = ({ \r\n  visible, \r\n  onClose, \r\n  bookingId,\r\n  onApproveSuccess,\r\n  onApproveError,\r\n  onRequestChangesSuccess,\r\n  onRequestChangesError,\r\n  initialData = null,\r\n  isProfessional = true,\r\n  modalTitle = \"Booking Approval Request\",\r\n  hideButtons = false,\r\n  isReadOnly = false\r\n}) => {\r\n  const { screenWidth } = useContext(AuthContext);\r\n  const isDesktop = screenWidth > 768;\r\n  \r\n  // Create a safe default initial data structure if initialData is null\r\n  const defaultInitialData = initialData || {\r\n    booking_id: bookingId,\r\n    service_type: 'Loading...',\r\n    pets: [],\r\n    occurrences: [],\r\n    cost_summary: {\r\n      subtotal: 0,\r\n      client_platform_fee: 0,\r\n      pro_platform_fee: 0,\r\n      taxes: 0,\r\n      tax_state: '',\r\n      total_client_cost: 0,\r\n      total_sitter_payout: 0,\r\n      pro_subscription_plan: 0\r\n    }\r\n  };\r\n  \r\n  const [bookingData, setBookingData] = useState(defaultInitialData);\r\n  const [loading, setLoading] = useState(false);\r\n  const [loadingText, setLoadingText] = useState(\"Loading booking details...\");\r\n  const [error, setError] = useState(null);\r\n  const [changeRequestMessage, setChangeRequestMessage] = useState('');\r\n  const [showChangeRequestInput, setShowChangeRequestInput] = useState(false);\r\n  \r\n  // Use a ref to store a cached copy of the booking data that won't be affected by re-renders\r\n  const bookingDataRef = useRef(defaultInitialData);\r\n  // Flag to track if data has been fully loaded\r\n  const dataLoadedRef = useRef(false);\r\n\r\n  useEffect(() => {\r\n    if (visible && bookingId) {\r\n      fetchBookingDetails();\r\n    }\r\n  }, [visible, bookingId]);\r\n\r\n  // Update modal title based on mode\r\n  const getModalTitle = () => {\r\n    // Debug log to help with modal title decisions\r\n    debugLog('MBA4321: Modal title decision factors:', {\r\n      isReadOnly,\r\n      modalTitle,\r\n      bookingId\r\n    });\r\n    \r\n    if (isReadOnly) {\r\n      return \"Booking Details\";\r\n    }\r\n    \r\n    // Keep the provided modal title\r\n    return modalTitle;\r\n  };\r\n\r\n  // Update bookingData when initialData changes\r\n  useEffect(() => {\r\n    if (initialData && !dataLoadedRef.current) {\r\n      debugLog('MBAio3htg5uohg: Updating bookingData from initialData');\r\n      setBookingData(initialData);\r\n      bookingDataRef.current = initialData;\r\n    }\r\n  }, [initialData]);\r\n\r\n  // Add this useEffect to detect when a websocket update or unread count changes might occur\r\n  // and protect the bookingData from being affected\r\n  useEffect(() => {\r\n    // This sets a regular interval to check if bookingData is still intact\r\n    const dataProtectionInterval = setInterval(() => {\r\n      if (visible && dataLoadedRef.current) {\r\n        // Check if booking data has been unexpectedly cleared\r\n        const hasNoData = !bookingData || \r\n                         !bookingData.occurrences || \r\n                         bookingData.occurrences.length === 0;\r\n                         \r\n        const hasRefData = bookingDataRef.current && \r\n                          bookingDataRef.current.occurrences && \r\n                          bookingDataRef.current.occurrences.length > 0;\r\n        \r\n        if (hasNoData && hasRefData) {\r\n          debugLog('MBAio3htg5uohg: Detected that bookingData was cleared unexpectedly, restoring from cache');\r\n          setBookingData({...bookingDataRef.current});\r\n        }\r\n      }\r\n    }, 1000); // Check every second\r\n    \r\n    return () => {\r\n      // Clean up interval on unmount\r\n      clearInterval(dataProtectionInterval);\r\n    };\r\n  }, [visible, bookingData]);\r\n\r\n  const fetchBookingDetails = async () => {\r\n    if (!bookingId) return;\r\n    \r\n    try {\r\n      setLoading(true);\r\n      setError(null);\r\n      setLoadingText(\"Loading booking details...\");\r\n      \r\n      debugLog('MBAio3htg5uohg: Fetching booking details for ID:', bookingId);\r\n      const response = await getBookingDetails(bookingId);\r\n      \r\n      debugLog('MBAio3htg5uohg: Booking details fetched:', response);\r\n      \r\n      // Ensure the response has the expected structure\r\n      const safeResponse = {\r\n        ...response,\r\n        occurrences: response.occurrences || [],\r\n        pets: response.pets || [],\r\n        cost_summary: response.cost_summary || {\r\n          subtotal: 0,\r\n          client_platform_fee: 0,\r\n          pro_platform_fee: 0,\r\n          taxes: 0,\r\n          tax_state: '',\r\n          total_client_cost: 0,\r\n          total_sitter_payout: 0,\r\n          pro_subscription_plan: 0\r\n        },\r\n        service_type: response.service_type || 'N/A'\r\n      };\r\n      \r\n      // Make sure we have at least one occurrence with required fields\r\n      if (safeResponse.occurrences.length === 0) {\r\n        safeResponse.occurrences = [{\r\n          occurrence_id: '0',\r\n          start_date: new Date().toISOString().split('T')[0],\r\n          end_date: new Date().toISOString().split('T')[0],\r\n          start_time: '09:00',\r\n          end_time: '17:00',\r\n          unit_of_time: 'visit',\r\n          multiple: 1,\r\n          base_total: 0,\r\n          rates: {\r\n            base_rate: 0,\r\n            additional_animal_rate: 0,\r\n            applies_after: 1,\r\n            holiday_rate: 0,\r\n            holiday_days: 0,\r\n            additional_rates: []\r\n          }\r\n        }];\r\n      } else {\r\n        // Ensure each occurrence has a rates object and that unit_of_time is preserved\r\n        safeResponse.occurrences = safeResponse.occurrences.map(occ => {\r\n          // Log detailed info about each occurrence for debugging\r\n          debugLog('MBAio3htg5uohg: Processing occurrence:', {\r\n            id: occ.occurrence_id,\r\n            unit_of_time: occ.unit_of_time,\r\n            multiple: occ.multiple\r\n          });\r\n          \r\n          return {\r\n            ...occ,\r\n            unit_of_time: occ.unit_of_time || 'visit',\r\n            multiple: parseFloat(occ.multiple) || 1,\r\n            base_total: occ.base_total || 0,\r\n            rates: occ.rates || {\r\n              base_rate: 0,\r\n              additional_animal_rate: 0,\r\n              applies_after: 1,\r\n              holiday_rate: 0,\r\n              holiday_days: 0,\r\n              additional_rates: []\r\n            }\r\n          };\r\n        });\r\n      }\r\n      \r\n      // Store the processed response both in state and ref\r\n      setBookingData(safeResponse);\r\n      bookingDataRef.current = safeResponse;\r\n      dataLoadedRef.current = true;\r\n      \r\n      debugLog('MBAio3htg5uohg: Booking data processed and stored');\r\n    } catch (err) {\r\n      debugLog('MBAio3htg5uohg: Error fetching booking details:', err);\r\n      setError('Failed to load booking details. Please try again.');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n  \r\n  // Add a safety effect that restores booking data from ref if it's cleared unexpectedly\r\n  useEffect(() => {\r\n    // Only run this check if we have actually loaded data before\r\n    if (dataLoadedRef.current) {\r\n      // Check if booking data was cleared but we have a cache in the ref\r\n      const hasNoData = !bookingData || !bookingData.occurrences || bookingData.occurrences.length === 0;\r\n      const hasRefData = bookingDataRef.current && bookingDataRef.current.occurrences && bookingDataRef.current.occurrences.length > 0;\r\n      \r\n      if (hasNoData && hasRefData) {\r\n        debugLog('MBAio3htg5uohg: Booking data was cleared unexpectedly, restoring from cache');\r\n        setBookingData(bookingDataRef.current);\r\n      }\r\n    }\r\n  }, [bookingData]);\r\n\r\n  const handleApprove = async () => {\r\n    try {\r\n      setLoading(true);\r\n      setLoadingText(\"Approving booking...\");\r\n      setError(null);\r\n      \r\n      const response = await approveBooking(bookingId);\r\n      \r\n      if (onApproveSuccess) {\r\n        onApproveSuccess(response);\r\n      }\r\n      \r\n      onClose();\r\n    } catch (err) {\r\n      debugLog('MBA77788 Error approving booking:', err);\r\n      setError('Failed to approve booking. Please try again.');\r\n      \r\n      if (onApproveError) {\r\n        onApproveError(err.response?.data?.error || 'Failed to approve booking');\r\n      }\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleShowChangeRequest = () => {\r\n    setShowChangeRequestInput(true);\r\n  };\r\n\r\n  const handleCancelChangeRequest = () => {\r\n    setShowChangeRequestInput(false);\r\n    setChangeRequestMessage('');\r\n  };\r\n\r\n  const handleSubmitChangeRequest = async () => {\r\n    if (!changeRequestMessage.trim()) {\r\n      setError('Please provide details about your requested changes.');\r\n      return;\r\n    }\r\n    \r\n    try {\r\n      setLoading(true);\r\n      setLoadingText(\"Submitting change request...\");\r\n      setError(null);\r\n      \r\n      const response = await requestBookingChanges(bookingId, changeRequestMessage);\r\n      \r\n      if (onRequestChangesSuccess) {\r\n        debugLog('MBA77788 Notifying parent of successful change request submission');\r\n        onRequestChangesSuccess(response);\r\n      }\r\n      \r\n      onClose();\r\n    } catch (err) {\r\n      debugLog('MBA77788 Error requesting booking changes:', err);\r\n      setError('Failed to submit change request. Please try again.');\r\n      \r\n      if (onRequestChangesError) {\r\n        onRequestChangesError(err.response?.data?.error || 'Failed to submit change request');\r\n      }\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // Handle modal close\r\n  const handleClose = () => {\r\n    setShowChangeRequestInput(false);\r\n    setChangeRequestMessage('');\r\n    onClose();\r\n  };\r\n\r\n  // Main content of the modal\r\n  const renderContent = () => {\r\n    if (loading) {\r\n      return (\r\n        <View style={styles.loadingContainer}>\r\n          <ActivityIndicator size=\"large\" color={theme.colors.primary} />\r\n          <Text style={styles.loadingText}>{loadingText}</Text>\r\n        </View>\r\n      );\r\n    }\r\n\r\n    if (error) {\r\n      return (\r\n        <View style={styles.errorContainer}>\r\n          <MaterialCommunityIcons name=\"alert-circle\" size={48} color={theme.colors.error} />\r\n          <Text style={styles.errorText}>{error}</Text>\r\n          <TouchableOpacity style={styles.retryButton} onPress={fetchBookingDetails}>\r\n            <Text style={styles.retryButtonText}>Retry</Text>\r\n          </TouchableOpacity>\r\n        </View>\r\n      );\r\n    }\r\n\r\n    if (!bookingData) {\r\n      return (\r\n        <View style={styles.emptyContainer}>\r\n          <Text style={styles.emptyText}>No booking data available</Text>\r\n        </View>\r\n      );\r\n    }\r\n\r\n    return (\r\n      <>\r\n        <View style={[styles.section, { marginTop: 0 }]}>\r\n          <Text style={styles.sectionHeader}>Service & Pets</Text>\r\n          <View style={styles.card}>\r\n            <View style={styles.serviceContainer}>\r\n              <Text style={styles.serviceLabel}>Service:</Text>\r\n              <Text style={styles.serviceValue}>{bookingData.service_details?.service_type || 'N/A'}</Text>\r\n            </View>\r\n            \r\n            <View style={styles.serviceDivider} />\r\n            \r\n            <View style={styles.petsContainer}>\r\n              <Text style={styles.petsLabel}>Pets:</Text>\r\n              <View style={styles.petsList}>\r\n                {bookingData.pets && bookingData.pets.length > 0 ? (\r\n                  bookingData.pets.map((pet, index) => (\r\n                    <View key={index} style={styles.petItem}>\r\n                      <Text style={styles.petName}>{pet.name}</Text>\r\n                      <Text style={styles.petType}>{capitalizeWords(pet.species)} | {pet.breed}</Text>\r\n                    </View>\r\n                  ))\r\n                ) : (\r\n                  <Text style={styles.noPets}>No pets selected</Text>\r\n                )}\r\n              </View>\r\n            </View>\r\n          </View>\r\n        </View>\r\n        \r\n        {/* ReviewAndRatesCard for booking details */}\r\n        {bookingData && (\r\n          <ReviewAndRatesCard \r\n            bookingData={bookingData} \r\n            bookingId={bookingId}\r\n            onRatesUpdate={(updatedData) => setBookingData(updatedData)}\r\n            showEditControls={false}\r\n            isProfessional={isProfessional}\r\n          />\r\n        )}\r\n      </>\r\n    );\r\n  };\r\n\r\n  // Render change request input\r\n  const renderChangeRequestInput = () => {\r\n    return (\r\n      <View style={styles.changeRequestContainer}>\r\n        <TextInput\r\n          style={styles.changeRequestInput}\r\n          placeholder=\"Enter details about your requested changes...\"\r\n          value={changeRequestMessage}\r\n          onChangeText={setChangeRequestMessage}\r\n          multiline={true}\r\n          numberOfLines={3}\r\n          placeholderTextColor={theme.colors.placeHolderText}\r\n        />\r\n        <View style={styles.buttonWrapper}>\r\n          <View style={styles.changeRequestButtons}>\r\n            <TouchableOpacity\r\n              style={styles.cancelRequestButton}\r\n              onPress={handleCancelChangeRequest}\r\n            >\r\n              <Text style={styles.cancelRequestButtonText}>Cancel</Text>\r\n            </TouchableOpacity>\r\n            <TouchableOpacity\r\n              style={styles.submitRequestButton}\r\n              onPress={handleSubmitChangeRequest}\r\n              disabled={!changeRequestMessage.trim()}\r\n            >\r\n              <Text style={styles.submitRequestButtonText}>Request Changes</Text>\r\n            </TouchableOpacity>\r\n          </View>\r\n        </View>\r\n      </View>\r\n    );\r\n  };\r\n\r\n  // Footer with action buttons\r\n  const renderFooter = () => {\r\n    // Log the current state for debugging\r\n    debugLog('MBA4321: Footer render state:', {\r\n      hideButtons,\r\n      isReadOnly,\r\n      showChangeRequestInput,\r\n      isProfessional,\r\n      modalTitle\r\n    });\r\n    \r\n    // Don't render any footer if the buttons should be hidden\r\n    if (hideButtons) {\r\n      return null;\r\n    }\r\n    \r\n    // Read-only mode for confirmed bookings - just show a close button\r\n    if (isReadOnly) {\r\n      return (\r\n        <View style={styles.footerContainer}>\r\n          <TouchableOpacity\r\n            style={[styles.button, styles.closeButton]}\r\n            onPress={handleClose}\r\n          >\r\n            <Text style={styles.buttonText}>Close</Text>\r\n          </TouchableOpacity>\r\n        </View>\r\n      );\r\n    }\r\n    \r\n    // Show change request input or default buttons\r\n    if (showChangeRequestInput) {\r\n      return null; // Don't render footer when change request input is shown\r\n    }\r\n    \r\n    if (isProfessional) {\r\n      // Professional only gets Close button\r\n      return (\r\n        <View style={styles.footerContainer}>\r\n          <TouchableOpacity\r\n            style={[styles.button, styles.closeButton]}\r\n            onPress={handleClose}\r\n          >\r\n            <Text style={styles.buttonText}>Close</Text>\r\n          </TouchableOpacity>\r\n        </View>\r\n      );\r\n    } else {\r\n      // For booking updates or regular approvals, show all action buttons\r\n      const isBookingUpdate = modalTitle === \"Booking Update\";\r\n      \r\n      // Client gets two or three buttons: Close, Approve, Request Changes\r\n      return (\r\n        <View style={styles.footerContainer}>\r\n          <TouchableOpacity\r\n            style={[styles.button, styles.closeButton]}\r\n            onPress={handleClose}\r\n          >\r\n            <Text style={styles.buttonText}>Close</Text>\r\n          </TouchableOpacity>\r\n          \r\n          <TouchableOpacity\r\n            style={[styles.button, styles.changeButton]}\r\n            onPress={handleShowChangeRequest}\r\n          >\r\n            <Text style={styles.buttonText}>Request Changes</Text>\r\n          </TouchableOpacity>\r\n          \r\n          <TouchableOpacity\r\n            style={[styles.button, styles.approveButton]}\r\n            onPress={handleApprove}\r\n          >\r\n            <Text style={styles.approveText}>{isBookingUpdate ? \"Approve Update\" : \"Approve\"}</Text>\r\n          </TouchableOpacity>\r\n        </View>\r\n      );\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Modal\r\n      visible={visible}\r\n      transparent={true}\r\n      animationType=\"slide\"\r\n      onRequestClose={handleClose}\r\n    >\r\n      <SafeAreaView style={styles.safeArea}>\r\n        <View style={[\r\n          styles.container, \r\n          isDesktop ? styles.desktopContainer : {},\r\n          showChangeRequestInput ? styles.shortenedContainer : {}\r\n        ]}>\r\n          {/* Header with customizable title */}\r\n          <View style={styles.header}>\r\n            <Text style={styles.title}>{getModalTitle()}</Text>\r\n            <TouchableOpacity style={styles.closeButton} onPress={handleClose}>\r\n              <MaterialCommunityIcons name=\"close\" size={24} color={theme.colors.text} />\r\n            </TouchableOpacity>\r\n          </View>\r\n          \r\n          {/* Content */}\r\n          {showChangeRequestInput ? (\r\n            // Render change request input as direct content\r\n            renderChangeRequestInput()\r\n          ) : (\r\n            // Render scrollable booking details\r\n            <ScrollView style={styles.scrollContainer} contentContainerStyle={styles.scrollContent}>\r\n              {renderContent()}\r\n            </ScrollView>\r\n          )}\r\n          \r\n          {/* Footer with action buttons - only shown when not in change request mode */}\r\n          {!showChangeRequestInput && renderFooter()}\r\n        </View>\r\n      </SafeAreaView>\r\n    </Modal>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  safeArea: {\r\n    flex: 1,\r\n    backgroundColor: 'rgba(0, 0, 0, 0.5)',\r\n    justifyContent: 'center',\r\n  },\r\n  container: {\r\n    flex: 1,\r\n    backgroundColor: theme.colors.background,\r\n    margin: Platform.OS === 'web' ? 0 : 24,\r\n    borderRadius: 12,\r\n    overflow: 'hidden',\r\n  },\r\n  desktopContainer: {\r\n    maxWidth: 800,\r\n    maxHeight: '90%',\r\n    alignSelf: 'center',\r\n    marginTop: '5%',\r\n  },\r\n  header: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    padding: 16,\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: theme.colors.border,\r\n    backgroundColor: theme.colors.surface,\r\n  },\r\n  title: {\r\n    fontSize: 20,\r\n    fontWeight: 'bold',\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n  },\r\n  closeButton: {\r\n    padding: 8,\r\n  },\r\n  scrollContainer: {\r\n    flex: 1,\r\n  },\r\n  scrollContent: {\r\n    padding: 16,\r\n    paddingBottom: 32,\r\n  },\r\n  footerContainer: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    padding: 16,\r\n    borderTopWidth: 1,\r\n    borderTopColor: theme.colors.border,\r\n    backgroundColor: theme.colors.surface,\r\n  },\r\n  button: {\r\n    paddingVertical: 12,\r\n    paddingHorizontal: 16,\r\n    borderRadius: 8,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.primary,\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    flex: 1,\r\n    marginRight: 8,\r\n  },\r\n  buttonText: {\r\n    color: theme.colors.primary,\r\n    fontSize: 16,\r\n    fontWeight: '600',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  approveButton: {\r\n    paddingVertical: 12,\r\n    paddingHorizontal: 16,\r\n    borderRadius: 8,\r\n    backgroundColor: theme.colors.primary,\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    flex: 1,\r\n    marginLeft: 8,\r\n  },\r\n  approveText: {\r\n    color: 'white',\r\n    fontSize: 16,\r\n    fontWeight: '600',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  loadingContainer: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    padding: 24,\r\n  },\r\n  loadingText: {\r\n    marginTop: 16,\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  errorContainer: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    padding: 24,\r\n  },\r\n  errorText: {\r\n    marginTop: 16,\r\n    fontSize: 16,\r\n    color: theme.colors.error,\r\n    textAlign: 'center',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  retryButton: {\r\n    marginTop: 16,\r\n    paddingVertical: 8,\r\n    paddingHorizontal: 16,\r\n    backgroundColor: theme.colors.primary,\r\n    borderRadius: 8,\r\n  },\r\n  retryButtonText: {\r\n    color: 'white',\r\n    fontSize: 16,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  emptyContainer: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    padding: 24,\r\n  },\r\n  emptyText: {\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  // Service and Pets section styles\r\n  section: {\r\n    marginTop: 24,\r\n    marginHorizontal: 16,\r\n  },\r\n  sectionHeader: {\r\n    fontSize: 20,\r\n    // fontWeight: 'bold',\r\n    marginBottom: 8,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n  },\r\n  card: {\r\n    backgroundColor: theme.colors.surfaceContrast,\r\n    borderRadius: 8,\r\n    padding: 16,\r\n    shadowColor: '#000',\r\n    shadowOffset: { width: 0, height: 2 },\r\n    shadowOpacity: 0.1,\r\n    shadowRadius: 4,\r\n    elevation: 3,\r\n  },\r\n  serviceContainer: {\r\n    flexDirection: 'row',\r\n    marginBottom: 16,\r\n    alignItems: 'center',\r\n    paddingBottom: 16,\r\n  },\r\n  serviceDivider: {\r\n    height: 1,\r\n    backgroundColor: theme.colors.border,\r\n    marginBottom: 16,\r\n    width: '100%',\r\n  },\r\n  serviceLabel: {\r\n    fontSize: 16,\r\n    fontWeight: '600',\r\n    color: theme.colors.text,\r\n    width: 80,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  serviceValue: {\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n    flex: 1,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  petsContainer: {\r\n    flexDirection: 'row',\r\n    alignItems: 'flex-start',\r\n  },\r\n  petsLabel: {\r\n    fontSize: 16,\r\n    fontWeight: '600',\r\n    color: theme.colors.text,\r\n    width: 80,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  petsList: {\r\n    flex: 1,\r\n  },\r\n  petItem: {\r\n    marginBottom: 8,\r\n  },\r\n  petName: {\r\n    fontSize: 16,\r\n    fontWeight: '500',\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  petType: {\r\n    fontSize: 14,\r\n    color: theme.colors.placeHolderText,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  noPets: {\r\n    fontSize: 16,\r\n    color: theme.colors.placeHolderText,\r\n    fontStyle: 'italic',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  // Change request styles\r\n  changeRequestContainer: {\r\n    padding: 16,\r\n  },\r\n  changeRequestInput: {\r\n    backgroundColor: theme.colors.background,\r\n    borderColor: theme.colors.border,\r\n    borderWidth: 1,\r\n    borderRadius: 8,\r\n    padding: 12,\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n    minHeight: 120,\r\n    textAlignVertical: 'top',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    marginBottom: 16,\r\n  },\r\n  buttonWrapper: {\r\n    alignItems: 'center',\r\n    width: '100%',\r\n  },\r\n  changeRequestButtons: {\r\n    flexDirection: 'row',\r\n    width: 300,\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    marginTop: 16,\r\n  },\r\n  cancelRequestButton: {\r\n    width: 140,\r\n    height: 45,\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border || '#E0E0E0',\r\n    borderRadius: 8,\r\n    backgroundColor: 'white',\r\n  },\r\n  cancelRequestButtonText: {\r\n    color: theme.colors.text || '#333333',\r\n    fontSize: 16,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  submitRequestButton: {\r\n    width: 140,\r\n    height: 45,\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    backgroundColor: theme.colors.olive || '#707855',\r\n    borderRadius: 8,\r\n  },\r\n  submitRequestButtonText: {\r\n    color: 'white',\r\n    fontSize: 16,\r\n    fontWeight: 'bold',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  changeButton: {\r\n    paddingVertical: 12,\r\n    paddingHorizontal: 16,\r\n    borderRadius: 8,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.primary,\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    flex: 1,\r\n    marginLeft: 8,\r\n  },\r\n  shortenedContainer: {\r\n    flex: 0,\r\n    backgroundColor: theme.colors.background,\r\n    margin: Platform.OS === 'web' ? 0 : 24,\r\n    borderRadius: 12,\r\n    overflow: 'hidden',\r\n    alignSelf: 'center',\r\n    width: '90%',\r\n    maxWidth: 500,\r\n    minHeight: 320,\r\n  },\r\n});\r\n\r\nexport default BookingApprovalModal; ","/**\r\n * Capitalizes the first letter of each word in a string, with all other letters lowercase\r\n * @param {string} str - The string to format\r\n * @returns {string} - Formatted string with first letter of each word capitalized\r\n * \r\n * Examples:\r\n * 1. \"DOG\" -> \"Dog\"\r\n * 2. \"HouSE CAt\" -> \"House Cat\"\r\n */\r\nexport const capitalizeWords = (str) => {\r\n  if (!str) return str;\r\n  \r\n  return str\r\n    .split(' ')\r\n    .map(word => \r\n      word.charAt(0).toUpperCase() + word.slice(1).toLowerCase()\r\n    )\r\n    .join(' ');\r\n};\r\n","import React, { useContext, useState, useEffect } from 'react';\r\nimport { View, ScrollView, StyleSheet, Platform, SafeAreaView, Dimensions, StatusBar, TouchableOpacity, Text } from 'react-native';\r\nimport { Card, Title, Paragraph, List, Button, useTheme, Appbar, ActivityIndicator, Avatar } from 'react-native-paper';\r\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\r\nimport axios from 'axios';\r\nimport { API_BASE_URL } from '../config/config';\r\nimport AsyncStorage from '@react-native-async-storage/async-storage';\r\nimport { AuthContext, debugLog } from '../context/AuthContext';\r\nimport { TutorialContext } from '../context/TutorialContext';\r\nimport CrossPlatformView from '../components/CrossPlatformView';\r\nimport { theme } from '../styles/theme';\r\nimport { navigateToFrom } from '../components/Navigation';\r\nimport ProfessionalServiceCard from '../components/ProfessionalServiceCard';\r\nimport { getProfessionalServices } from '../api/API';\r\nimport BookingCard from '../components/BookingCard';\r\nimport TutorialModal from '../components/TutorialModal';\r\nimport BookingApprovalModal from '../components/BookingApprovalModal';\r\n\r\nconst { width: screenWidth, height: screenHeight } = Dimensions.get('window');\r\n\r\nconst Dashboard = ({ navigation }) => {\r\n  const { colors } = useTheme();\r\n  const { signOut, firstName, is_prototype, screenWidth, is_DEBUG, isSignedIn, isCollapsed, userRole } = useContext(AuthContext);\r\n  const { \r\n    isVisible: isTutorialVisible,\r\n    currentStep,\r\n    totalSteps,\r\n    stepData,\r\n    handleNext,\r\n    handlePrevious,\r\n    handleSkip,\r\n    completeTutorial,\r\n  } = useContext(TutorialContext);\r\n  const [bookings, setBookings] = useState([]);\r\n  const [services, setServices] = useState([]);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [activeFilter, setActiveFilter] = useState('upcoming');\r\n  const [onboardingProgress, setOnboardingProgress] = useState({\r\n    profile_complete: 0,\r\n    has_bank_account: false,\r\n    has_services: false,\r\n    subscription_plan: 0\r\n  });\r\n\r\n  // Add state for the BookingApprovalModal\r\n  const [bookingModalVisible, setBookingModalVisible] = useState(false);\r\n  const [selectedBookingId, setSelectedBookingId] = useState(null);\r\n\r\n  const isLargeScreen = screenWidth > 900;\r\n  const isMobile = screenWidth <= 900;\r\n  const isProfessional = userRole === 'professional';\r\n\r\n  // Filter bookings based on active filter\r\n  const filteredBookings = bookings.filter(booking => {\r\n    const now = new Date();\r\n    let bookingDate = null;\r\n    \r\n    // Ensure we have a valid date before parsing\r\n    if (booking.start_date) {\r\n      try {\r\n        bookingDate = new Date(booking.start_date);\r\n        // Check if date is valid\r\n        if (isNaN(bookingDate.getTime())) {\r\n          debugLog(\"MBA5677: Invalid booking date\", booking.start_date);\r\n          return false;\r\n        }\r\n      } catch (error) {\r\n        debugLog(\"MBA5677: Error parsing booking date\", { date: booking.start_date, error });\r\n        return false;\r\n      }\r\n    }\r\n    \r\n    debugLog(\"MBA5677: Filtering booking\", { \r\n      id: booking.booking_id || booking.id,\r\n      date: booking.start_date || booking.date,\r\n      parsedDate: bookingDate ? bookingDate.toISOString() : null,\r\n      now: now.toISOString(),\r\n      filter: activeFilter\r\n    });\r\n    \r\n    switch (activeFilter) {\r\n      case 'upcoming':\r\n        return bookingDate && bookingDate > now;\r\n      case 'active':\r\n        return bookingDate && bookingDate <= now && !booking.completed;\r\n      case 'past':\r\n        return bookingDate && bookingDate < now && booking.completed;\r\n      default:\r\n        return true;\r\n    }\r\n  });\r\n\r\n  // Limit bookings for owner view\r\n  const displayedBookings = !isProfessional ? filteredBookings.slice(0, 3) : filteredBookings;\r\n\r\n  // Dynamic styles based on screen size\r\n  const dynamicStyles = {\r\n    welcomeTitle: {\r\n      fontSize: isLargeScreen ? 32 : 24,\r\n      fontWeight: '600',\r\n      color: theme.colors.whiteText,\r\n      fontFamily: theme.fonts.header.fontFamily,\r\n    },\r\n    bookingCount: {\r\n      fontSize: isLargeScreen ? 16 : 14,\r\n      color: theme.colors.whiteText,\r\n      fontFamily: theme.fonts.regular.fontFamily,\r\n      opacity: 0.8,\r\n      marginTop: 12,\r\n    },\r\n    statValue: {\r\n      fontSize: isLargeScreen ? 20 : 16,\r\n      fontWeight: '600',\r\n      color: theme.colors.text,\r\n      fontFamily: theme.fonts.header.fontFamily,\r\n    },\r\n    statLabel: {\r\n      fontSize: isLargeScreen ? 16 : 14,\r\n      color: theme.colors.textSecondary,\r\n      fontFamily: theme.fonts.regular.fontFamily,\r\n      marginTop: 4,\r\n    },\r\n    statChange: {\r\n      fontSize: isLargeScreen ? 14 : 12,\r\n      fontFamily: theme.fonts.regular.fontFamily,\r\n      marginTop: 4,\r\n    },\r\n    sectionTitle: {\r\n      fontSize: isLargeScreen ? 20 : 18,\r\n      fontWeight: '600',\r\n      color: theme.colors.text,\r\n      fontFamily: theme.fonts.header.fontFamily,\r\n      marginBottom: 16,\r\n      marginTop: 24,\r\n    },\r\n  };\r\n\r\n  const refreshToken = async () => {\r\n    try {\r\n      const refreshToken = await AsyncStorage.getItem('refreshToken');\r\n      const response = await axios.post(`${API_BASE_URL}/api/token/refresh/`, {\r\n        refresh: refreshToken,\r\n      });\r\n      const { access } = response.data;\r\n      await AsyncStorage.setItem('userToken', access);\r\n      return access;\r\n    } catch (error) {\r\n      console.error('Error refreshing token:', error);\r\n      await signOut();\r\n      navigation.navigate('SignIn');\r\n    }\r\n  };\r\n\r\n  // Prototype data\r\n  const prototypeBookings = [\r\n    { id: '56782', owner: 'John Doe', pet: 'Max (Dog)', date: '2023-05-15', time: '14:00', status: 'upcoming' },\r\n    { id: '5678', owner: 'Jane Smith', pet: 'Whiskers (Cat)', date: '2023-05-17', time: '10:00', status: 'active' },\r\n  ];\r\n\r\n  const prototypeServices = [\r\n    {\r\n      service_name: \"Dog Walking\",\r\n      description: \"Professional dog walking service\",\r\n      unit_of_time: \"30 minutes\",\r\n      base_rate: 25,\r\n      additional_animal_rate: 10,\r\n      holiday_rate: 35,\r\n      additional_rates: []\r\n    },\r\n    // Add more prototype services as needed\r\n  ];\r\n\r\n  const fetchDashboardData = async () => {\r\n    if (is_prototype) {\r\n      setBookings(prototypeBookings);\r\n      setServices(prototypeServices);\r\n      setOnboardingProgress({\r\n        profile_complete: 0.5,\r\n        has_bank_account: false,\r\n        has_services: true,\r\n        subscription_plan: 0\r\n      });\r\n      setIsLoading(false);\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setIsLoading(true);\r\n      let token = Platform.OS === 'web' ? sessionStorage.getItem('userToken') : await AsyncStorage.getItem('userToken');\r\n      \r\n      // Fetch bookings based on user role\r\n      const endpoint = isProfessional ? 'professionals' : 'clients';\r\n      const response = await axios.get(\r\n        `${API_BASE_URL}/api/${endpoint}/v1/dashboard/`,\r\n        { headers: { Authorization: `Bearer ${token}` } }\r\n      );\r\n\r\n      debugLog('MBA5677: Dashboard response data', response.data);\r\n      \r\n      // Log the structure of the first booking for debugging\r\n      if (response.data && response.data.upcoming_bookings && response.data.upcoming_bookings.length > 0) {\r\n        const firstBooking = response.data.upcoming_bookings[0];\r\n        debugLog('MBA5677: First booking complete structure', firstBooking);\r\n        \r\n        // Log all the keys in the booking object to see available fields\r\n        debugLog('MBA5677: First booking keys', Object.keys(firstBooking));\r\n        \r\n        // Explicitly check for client_name\r\n        debugLog('MBA5677: First booking client_name field', {\r\n          client_name: firstBooking.client_name,\r\n          owner_name: firstBooking.owner_name,\r\n          client_name_exists: 'client_name' in firstBooking\r\n        });\r\n      }\r\n\r\n      // Process the incoming bookings to ensure dates are properly formatted\r\n      const processedBookings = (response.data.upcoming_bookings || []).map(booking => {\r\n        debugLog('MBA5677: Processing booking', booking);\r\n        \r\n        // Make sure we have a valid booking object\r\n        if (!booking) {\r\n          debugLog('MBA5677: Null booking received');\r\n          return null;\r\n        }\r\n        \r\n        // Normalize date format if needed\r\n        let normalizedDate = booking.start_date;\r\n        if (normalizedDate && normalizedDate.includes(' ')) {\r\n          // Handle if the date includes time\r\n          normalizedDate = normalizedDate.split(' ')[0];\r\n        }\r\n        \r\n        // Return a properly formatted booking object with the client_name explicitly mapped\r\n        return {\r\n          ...booking,\r\n          start_date: normalizedDate, // Ensure date is in YYYY-MM-DD format\r\n          client_name: booking.client_name || booking.owner_name // Ensure client_name is set\r\n        };\r\n      }).filter(booking => booking !== null); // Remove any null bookings\r\n\r\n      debugLog('MBA5677: Processed bookings', processedBookings);\r\n      setBookings(processedBookings);\r\n      \r\n      setOnboardingProgress(response.data.onboarding_progress || {\r\n        profile_complete: 0,\r\n        has_bank_account: false,\r\n        has_services: false,\r\n        subscription_plan: 0\r\n      });\r\n\r\n      // Fetch services if professional\r\n      if (isProfessional) {\r\n        try {\r\n          const servicesData = await getProfessionalServices();\r\n          setServices(servicesData || []);\r\n        } catch (error) {\r\n          console.error('Error fetching professional services:', error);\r\n        }\r\n      }\r\n    } catch (error) {\r\n      if (error.response?.status === 401) {\r\n        const newToken = await refreshToken();\r\n        if (newToken) {\r\n          try {\r\n            // Retry fetching data with new token\r\n            const response = await axios.get(\r\n              `${API_BASE_URL}/api/${isProfessional ? 'professionals' : 'owners'}/v1/dashboard/`,\r\n              { headers: { Authorization: `Bearer ${newToken}` } }\r\n            );\r\n            setBookings(response.data.upcoming_bookings || []);\r\n            setOnboardingProgress(response.data.onboarding_progress || {\r\n              profile_complete: 0,\r\n              has_bank_account: false,\r\n              has_services: false,\r\n              subscription_plan: 0\r\n            });\r\n          } catch (retryError) {\r\n            console.error('Error fetching dashboard data after token refresh:', retryError);\r\n          }\r\n        }\r\n      } else {\r\n        console.error('Error fetching dashboard data:', error);\r\n      }\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchDashboardData();\r\n  }, [userRole, is_prototype]);\r\n\r\n  // Add useEffect to check for active bookings and select the active tab if there are any\r\n  useEffect(() => {\r\n    if (!isLoading && bookings.length > 0) {\r\n      const now = new Date();\r\n      \r\n      // Check if there are any active bookings (date <= now && !completed)\r\n      const hasActiveBookings = bookings.some(booking => {\r\n        try {\r\n          const bookingDate = booking.start_date ? new Date(booking.start_date) : null;\r\n          return bookingDate && bookingDate <= now && !booking.completed;\r\n        } catch (error) {\r\n          return false;\r\n        }\r\n      });\r\n      \r\n      debugLog(\"MBA5677: Checking for active bookings\", { \r\n        hasActiveBookings, \r\n        bookingsCount: bookings.length,\r\n        currentActiveFilter: activeFilter\r\n      });\r\n      \r\n      // If there are active bookings, set the active filter to 'active'\r\n      if (hasActiveBookings && activeFilter !== 'active') {\r\n        debugLog(\"MBA5677: Setting active filter to 'active' due to active bookings\");\r\n        setActiveFilter('active');\r\n      }\r\n    }\r\n  }, [bookings, isLoading]);\r\n\r\n  // TODO: Fetch owner requests from the backend\r\n  const ownerRequests = [\r\n    { id: '1', owner: 'Alice Johnson', pet: 'Fluffy (Rabbit)', date: '2023-05-20', time: '09:00' },\r\n    { id: '2', owner: 'Bob Williams', pet: 'Spike (Iguana)', date: '2023-05-22', time: '16:00' },\r\n  ];\r\n\r\n  const IconComponent = Platform.OS === 'web'\r\n    ? ({ name, ...props }) => <MaterialCommunityIcons name={name} {...props} />\r\n    : List.Icon;\r\n\r\n  const navigateToServiceManager = async () => {\r\n    if (is_DEBUG) {\r\n      console.log('Setting previousRoute to:', 'Dashboard');\r\n      console.log('Setting currentRoute to:', 'ServiceManager');\r\n    }\r\n    setTimeout(async () => {\r\n      await navigateToFrom(navigation, 'ServiceManager', 'Dashboard');\r\n    }, 100);\r\n  };\r\n\r\n  const renderHeader = () => {\r\n    if (isMobile) return null;\r\n    \r\n    return (\r\n      <View style={styles.headerContainer}>\r\n        <View style={styles.headerRight}>\r\n          {/* <TouchableOpacity style={styles.notificationButton}>\r\n            <MaterialCommunityIcons name=\"bell-outline\" size={24} color={theme.colors.text} />\r\n            <View style={styles.notificationBadge}>\r\n              <Text style={styles.notificationCount}>3</Text>\r\n            </View>\r\n          </TouchableOpacity> */}\r\n          <TouchableOpacity \r\n            style={styles.profileButton}\r\n            onPress={() => navigateToFrom(navigation, 'MyProfile', 'Dashboard')}\r\n          >\r\n            <Avatar.Image \r\n              size={40} \r\n              source={require('../../assets/default-profile.png')} \r\n            />\r\n          </TouchableOpacity>\r\n        </View>\r\n      </View>\r\n    );\r\n  };\r\n\r\n  const renderWelcomeSection = () => (\r\n    <View style={styles.welcomeSection}>\r\n      <View style={styles.welcomeContent}>\r\n        <View style={styles.welcomeCard}>\r\n          <View style={styles.welcomeHeader}>\r\n            <View style={styles.welcomeTextContainer}>\r\n              <Text style={dynamicStyles.welcomeTitle}>\r\n                Welcome back{firstName ? ', ' + firstName : ''}! 👋\r\n              </Text>\r\n              <Text style={dynamicStyles.bookingCount}>\r\n                You have {bookings.filter(b => !b.completed).length} active bookings today and {bookings.filter(b => new Date(b.start_date) > new Date()).length} upcoming appointments.\r\n              </Text>\r\n            </View>\r\n          </View>\r\n        </View>\r\n      </View>\r\n    </View>\r\n  );\r\n\r\n  const renderOnboardingProgress = () => (\r\n    <View style={styles.statsContainer}>\r\n      <View style={styles.statsGrid}>\r\n        {isProfessional ? (\r\n          // Professional onboarding cards\r\n          <>\r\n            <TouchableOpacity \r\n              style={styles.statCard}\r\n              onPress={() => navigateToFrom(navigation, 'MyProfile', 'Dashboard', { initialTab: 'profile_info' })}\r\n            >\r\n              <View style={styles.statHeader}>\r\n                <View style={[styles.statIconContainer, { backgroundColor: '#F0F9E5' }]}>\r\n                  <MaterialCommunityIcons name=\"account-check\" size={24} color={theme.colors.primary} />\r\n                </View>\r\n                <Text style={[dynamicStyles.statChange, { color: onboardingProgress.profile_complete === 1 ? theme.colors.success : theme.colors.warning }]}>\r\n                  {Math.round(onboardingProgress.profile_complete * 100)}% Complete\r\n                </Text>\r\n              </View>\r\n              <Text style={dynamicStyles.statValue}>Profile</Text>\r\n              <Text style={dynamicStyles.statLabel}>Complete your profile to get started</Text>\r\n            </TouchableOpacity>\r\n\r\n            {/* TODO: Add back after MVP \r\n            <TouchableOpacity \r\n              style={styles.statCard}\r\n              onPress={() => navigateToFrom(navigation, 'MyProfile', 'Dashboard', { initialTab: 'settings_payments' })}\r\n            >\r\n              <View style={styles.statHeader}>\r\n                <View style={[styles.statIconContainer, { backgroundColor: '#E7F3F8' }]}>\r\n                  <MaterialCommunityIcons name=\"bank\" size={24} color={theme.colors.primary} />\r\n                </View>\r\n                <Text style={[dynamicStyles.statChange, { color: onboardingProgress.has_bank_account ? theme.colors.success : theme.colors.warning }]}>\r\n                  {onboardingProgress.has_bank_account ? 'Connected' : 'Not Connected'}\r\n                </Text>\r\n              </View>\r\n              <Text style={dynamicStyles.statValue}>Bank Account</Text>\r\n              <Text style={dynamicStyles.statLabel}>Connect your bank to receive payments</Text>\r\n            </TouchableOpacity> */}\r\n\r\n            <TouchableOpacity \r\n              style={styles.statCard}\r\n              onPress={() => navigateToFrom(navigation, 'ServiceManager', 'Dashboard')}\r\n            >\r\n              <View style={styles.statHeader}>\r\n                <View style={[styles.statIconContainer, { backgroundColor: '#FEF0DA' }]}>\r\n                  <MaterialCommunityIcons name=\"briefcase\" size={24} color={theme.colors.primary} />\r\n                </View>\r\n                <Text style={[dynamicStyles.statChange, { color: onboardingProgress.has_services ? theme.colors.success : theme.colors.warning }]}>\r\n                  {onboardingProgress.has_services ? 'Active' : 'No Services'}\r\n                </Text>\r\n              </View>\r\n              <Text style={dynamicStyles.statValue}>Services</Text>\r\n              <Text style={dynamicStyles.statLabel}>Add services to start accepting bookings</Text>\r\n            </TouchableOpacity>\r\n\r\n            {/* TODO: Add back after MVP \r\n            <TouchableOpacity \r\n              style={styles.statCard}\r\n              onPress={() => navigateToFrom(navigation, 'MyProfile', 'Dashboard', { initialTab: 'settings_payments' })}\r\n            >\r\n              <View style={styles.statHeader}>\r\n                <View style={[styles.statIconContainer, { backgroundColor: '#E1E2DB' }]}>\r\n                  <MaterialCommunityIcons name=\"star\" size={24} color={theme.colors.primary} />\r\n                </View>\r\n                <Text style={[dynamicStyles.statChange, { color: onboardingProgress.subscription_plan > 0 ? theme.colors.success : theme.colors.warning }]}>\r\n                  {onboardingProgress.subscription_plan === 0 ? 'Free Tier' : 'Premium'}\r\n                </Text>\r\n              </View>\r\n              <Text style={dynamicStyles.statValue}>Subscription</Text>\r\n              <Text style={dynamicStyles.statLabel}>Upgrade for more features</Text>\r\n            </TouchableOpacity> */}\r\n          </>\r\n        ) : (\r\n          // Owner onboarding cards\r\n          <>\r\n            <TouchableOpacity \r\n              style={styles.statCard}\r\n              onPress={() => navigateToFrom(navigation, 'MyProfile', 'Dashboard', { initialTab: 'profile_info' })}\r\n            >\r\n              <View style={styles.statHeader}>\r\n                <View style={[styles.statIconContainer, { backgroundColor: '#F0F9E5' }]}>\r\n                  <MaterialCommunityIcons name=\"account-check\" size={24} color={theme.colors.primary} />\r\n                </View>\r\n                <Text style={[dynamicStyles.statChange, { color: onboardingProgress.profile_complete === 1 ? theme.colors.success : theme.colors.warning }]}>\r\n                  {Math.round(onboardingProgress.profile_complete * 100)}% Complete\r\n                </Text>\r\n              </View>\r\n              <Text style={dynamicStyles.statValue}>Profile</Text>\r\n              <Text style={dynamicStyles.statLabel}>Complete your profile to get started</Text>\r\n            </TouchableOpacity>\r\n\r\n            {/* TODO: Add back after MVP \r\n            <TouchableOpacity \r\n              style={styles.statCard}\r\n              onPress={() => navigateToFrom(navigation, 'MyProfile', 'Dashboard', { initialTab: 'settings_payments' })}\r\n            >\r\n              <View style={styles.statHeader}>\r\n                <View style={[styles.statIconContainer, { backgroundColor: '#E7F3F8' }]}>\r\n                  <MaterialCommunityIcons name=\"credit-card\" size={24} color={theme.colors.primary} />\r\n                </View>\r\n                <Text style={[dynamicStyles.statChange, { color: onboardingProgress.has_payment_method ? theme.colors.success : theme.colors.warning }]}>\r\n                  {onboardingProgress.has_payment_method ? 'Connected' : 'Not Connected'}\r\n                </Text>\r\n              </View>\r\n              <Text style={dynamicStyles.statValue}>Payment Method</Text>\r\n              <Text style={dynamicStyles.statLabel}>Add a payment method to book services</Text>\r\n            </TouchableOpacity> */}\r\n\r\n            <TouchableOpacity \r\n              style={styles.statCard}\r\n              onPress={() => navigateToFrom(navigation, 'MyProfile', 'Dashboard', { initialTab: 'pets_preferences' })}\r\n            >\r\n              <View style={styles.statHeader}>\r\n                <View style={[styles.statIconContainer, { backgroundColor: '#FEF0DA' }]}>\r\n                  <MaterialCommunityIcons name=\"paw\" size={24} color={theme.colors.primary} />\r\n                </View>\r\n                <Text style={[dynamicStyles.statChange, { color: onboardingProgress.has_pets ? theme.colors.success : theme.colors.warning }]}>\r\n                  {onboardingProgress.has_pets ? 'Added' : 'No Pets'}\r\n                </Text>\r\n              </View>\r\n              <Text style={dynamicStyles.statValue}>Pets</Text>\r\n              <Text style={dynamicStyles.statLabel}>Add your pets to book services</Text>\r\n            </TouchableOpacity>\r\n\r\n            {/* TODO: Add back after MVP \r\n            <TouchableOpacity \r\n              style={styles.statCard}\r\n              onPress={() => navigateToFrom(navigation, 'MyProfile', 'Dashboard', { initialTab: 'settings_payments' })}\r\n            >\r\n              <View style={styles.statHeader}>\r\n                <View style={[styles.statIconContainer, { backgroundColor: '#E1E2DB' }]}>\r\n                  <MaterialCommunityIcons name=\"star\" size={24} color={theme.colors.primary} />\r\n                </View>\r\n                <Text style={[dynamicStyles.statChange, { color: onboardingProgress.subscription_plan > 0 ? theme.colors.success : theme.colors.warning }]}>\r\n                  {onboardingProgress.subscription_plan === 0 ? 'Free Tier' : 'Premium'}\r\n                </Text>\r\n              </View>\r\n              <Text style={dynamicStyles.statValue}>Subscription</Text>\r\n              <Text style={dynamicStyles.statLabel}>Upgrade for more features</Text>\r\n            </TouchableOpacity> */}\r\n          </>\r\n        )}\r\n      </View>\r\n    </View>\r\n  );\r\n\r\n  const renderBookingFilters = () => (\r\n    <View style={styles.filterContainer}>\r\n      <View style={styles.filterButtons}>\r\n        {['upcoming', 'active'].map((filter) => (\r\n          <TouchableOpacity\r\n            key={filter}\r\n            style={[\r\n              styles.filterButton,\r\n              activeFilter === filter && styles.activeFilterButton\r\n            ]}\r\n            onPress={() => setActiveFilter(filter)}\r\n          >\r\n            <Text style={[\r\n              styles.filterText,\r\n              activeFilter === filter && styles.activeFilterText\r\n            ]}>\r\n              {filter.charAt(0).toUpperCase() + filter.slice(1)}\r\n            </Text>\r\n          </TouchableOpacity>\r\n        ))}\r\n      </View>\r\n      {/* TODO: UNCOMMONT THIS SECTION after mvp launch and implementation of mybookings screen\r\n      <TouchableOpacity\r\n        style={styles.viewAllButton}\r\n        onPress={() => navigateToFrom(navigation, 'MyBookings', 'Dashboard')}\r\n      >\r\n        <Text style={styles.viewAllText}>View All</Text>\r\n        <MaterialCommunityIcons name=\"chevron-right\" size={20} color={theme.colors.primary} />\r\n      </TouchableOpacity> */}\r\n    </View>\r\n  );\r\n\r\n  // Handle opening the booking modal\r\n  const handleViewBookingDetails = (bookingId) => {\r\n    setSelectedBookingId(bookingId);\r\n    setBookingModalVisible(true);\r\n    debugLog(\"MBA5677: Opening booking modal for ID:\", bookingId);\r\n  };\r\n\r\n  // Handle closing the booking modal\r\n  const handleCloseBookingModal = () => {\r\n    setBookingModalVisible(false);\r\n    setSelectedBookingId(null);\r\n  };\r\n\r\n  const renderBookings = () => (\r\n    <View style={styles.bookingsContainer}>\r\n      {isLoading ? (\r\n        <View style={styles.loadingContainer}>\r\n          <ActivityIndicator size=\"small\" color={colors.primary} />\r\n        </View>\r\n      ) : filteredBookings.length > 0 ? (\r\n        filteredBookings.map((booking) => {\r\n          debugLog('MBA5677: Rendering booking', { \r\n            id: is_prototype ? booking.id : booking.booking_id,\r\n            date: is_prototype ? booking.date : booking.start_date,\r\n            time: is_prototype ? booking.time : booking.start_time,\r\n            client_name: is_prototype ? booking.owner : booking.client_name,\r\n            professional_name: is_prototype ? booking.professional : booking.professional_name,\r\n            status: is_prototype ? booking.status : booking.status\r\n          });\r\n          \r\n          const bookingId = is_prototype ? booking.id : booking.booking_id;\r\n          \r\n          // Set name based on user role\r\n          let name;\r\n          if (isProfessional) {\r\n            name = is_prototype ? booking.owner : (booking.client_name || booking.owner_name || 'Client');\r\n            debugLog('MBA5677: Using client name', name);\r\n          } else {\r\n            name = is_prototype ? booking.professional : (booking.professional_name || 'Professional');\r\n            debugLog('MBA5677: Using professional name', name);\r\n          }\r\n          \r\n          return (\r\n            <BookingCard\r\n              key={bookingId}\r\n              booking={{\r\n                id: bookingId,\r\n                client_name: isProfessional ? name : null,\r\n                professional_name: !isProfessional ? name : null,\r\n                serviceName: is_prototype ? booking.service : booking.service_type,\r\n                date: is_prototype ? booking.date : booking.start_date,\r\n                time: is_prototype ? booking.time : booking.start_time,\r\n                status: is_prototype ? booking.status : booking.status,\r\n                pets: is_prototype ? [{ name: booking.pet }] : booking.pets\r\n              }}\r\n              type={isProfessional ? \"professional\" : \"client\"}\r\n              onViewDetails={() => handleViewBookingDetails(bookingId)}\r\n            />\r\n          );\r\n        })\r\n      ) : (\r\n        <View style={styles.emptyStateContainer}>\r\n          <MaterialCommunityIcons name=\"calendar\" size={48} color={theme.colors.textSecondary} />\r\n          <Text style={styles.emptyStateTitle}>No {activeFilter} bookings</Text>\r\n          <Text style={styles.emptyStateText}>\r\n            {isProfessional \r\n              ? 'Create services to start receiving bookings from owners.'\r\n              : 'Find professional services to book your first appointment.'}\r\n          </Text>\r\n          <TouchableOpacity\r\n            style={styles.createServiceButton}\r\n            onPress={() => navigateToFrom(navigation, \r\n              isProfessional ? 'ServiceManager' : 'SearchProfessionals', \r\n              'Dashboard'\r\n            )}\r\n          >\r\n            <MaterialCommunityIcons \r\n              name={isProfessional ? \"plus\" : \"magnify\"} \r\n              size={20} \r\n              color={theme.colors.surface} \r\n            />\r\n            <Text style={styles.createServiceButtonText}>\r\n              {isProfessional ? 'Create Service' : 'Find Professionals'}\r\n            </Text>\r\n          </TouchableOpacity>\r\n        </View>\r\n      )}\r\n    </View>\r\n  );\r\n\r\n  const renderServiceCard = (service) => (\r\n    <View style={styles.serviceCard} key={service.id}>\r\n      <View style={styles.serviceContent}>\r\n        <View style={styles.serviceHeader}>\r\n          <Text \r\n            style={styles.serviceTitle}\r\n            numberOfLines={1}\r\n            ellipsizeMode=\"tail\"\r\n          >\r\n            {service.service_name}\r\n          </Text>\r\n          <Text style={styles.serviceRate}>${service.base_rate} {service.unit_of_time || 'Per Visit'}</Text>\r\n        </View>\r\n        <Text style={styles.serviceCategory}>{service.category || 'Exotic'}</Text>\r\n      </View>\r\n      <View style={styles.serviceFooter}>\r\n        {/* TODO: Implement this section after mvp */}\r\n        {/* <View style={styles.bookingsCount}>\r\n          <MaterialCommunityIcons name=\"calendar\" size={16} color={theme.colors.textSecondary} />\r\n          <Text style={styles.bookingsText}>{service.booking_count || 8} bookings</Text>\r\n        </View> */}\r\n        <TouchableOpacity \r\n          style={styles.viewButton}\r\n          onPress={() => navigateToFrom(navigation, 'ServiceManager', 'Dashboard', { serviceId: service.id })}\r\n        >\r\n          <Text style={styles.viewButtonText}>View</Text>\r\n        </TouchableOpacity>\r\n      </View>\r\n    </View>\r\n  );\r\n\r\n  const renderServices = () => {\r\n    if (!isProfessional) return null;\r\n\r\n    return (\r\n      <View style={styles.servicesContainer}>\r\n        <View style={styles.sectionHeader}>\r\n          <Text style={dynamicStyles.sectionTitle}>My Services</Text>\r\n          <TouchableOpacity\r\n            style={styles.viewAllButton}\r\n            onPress={() => navigateToFrom(navigation, 'ServiceManager', 'Dashboard')}\r\n          >\r\n            <Text style={styles.viewAllText}>View All</Text>\r\n            <MaterialCommunityIcons name=\"chevron-right\" size={20} color={theme.colors.primary} />\r\n          </TouchableOpacity>\r\n        </View>\r\n        <View style={styles.servicesGrid}>\r\n          {services.map(service => renderServiceCard(service))}\r\n        </View>\r\n      </View>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <View style={styles.mainContainer}>\r\n      <ScrollView \r\n        style={[\r\n          styles.scrollView,\r\n          {\r\n            marginLeft: !isMobile && isSignedIn ? (isCollapsed ? 70 : 250) : 0,\r\n            marginTop: isMobile ? 60 : 0,\r\n          }\r\n        ]}\r\n        contentContainerStyle={[\r\n          styles.scrollViewContent,\r\n          {\r\n            maxWidth: 1200,\r\n            marginHorizontal: 'auto',\r\n            paddingTop: isMobile ? 24 : 0,\r\n          }\r\n        ]}\r\n      >\r\n        {renderHeader()}\r\n        {renderWelcomeSection()}\r\n        {renderOnboardingProgress()}\r\n        {renderBookingFilters()}\r\n        {renderBookings()}\r\n        {renderServices()}\r\n      </ScrollView>\r\n      \r\n      {/* Custom BookingApprovalModal with modified title */}\r\n      <BookingApprovalModal\r\n        visible={bookingModalVisible}\r\n        onClose={handleCloseBookingModal}\r\n        bookingId={selectedBookingId}\r\n        isProfessional={isProfessional}\r\n        modalTitle=\"Review Details\" // Custom title for dashboard view\r\n        hideButtons={true} // Hide action buttons when viewed from dashboard\r\n      />\r\n      \r\n      {isTutorialVisible && stepData?.screen === 'Dashboard' && (\r\n        <TutorialModal\r\n          step={currentStep}\r\n          totalSteps={totalSteps}\r\n          title={stepData.title}\r\n          description={stepData.description}\r\n          position={stepData.position}\r\n          onNext={() => handleNext(navigation)}\r\n          onPrevious={handlePrevious}\r\n          onSkip={handleSkip}\r\n          onClose={completeTutorial}\r\n        />\r\n      )}\r\n    </View>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  mainContainer: {\r\n    flex: 1,\r\n    height: '100vh',\r\n    backgroundColor: '#f5f5f5',\r\n    position: 'fixed',\r\n    top: 0,\r\n    right: 0,\r\n    bottom: 0,\r\n    left: 0,\r\n    overflow: 'hidden',\r\n  },\r\n  scrollView: {\r\n    flex: 1,\r\n    height: '100%',\r\n    overflow: 'auto',\r\n  },\r\n  scrollViewContent: {\r\n    width: '100%',\r\n    paddingBottom: 40,\r\n  },\r\n  headerContainer: {\r\n    padding: 24,\r\n    paddingTop: Platform.OS === 'android' ? StatusBar.currentHeight + 24 : 24,\r\n    flexDirection: 'row',\r\n    justifyContent: 'flex-end',\r\n    alignItems: 'center',\r\n  },\r\n  headerRight: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    gap: 16,\r\n  },\r\n  notificationButton: {\r\n    position: 'relative',\r\n    padding: 8,\r\n  },\r\n  notificationBadge: {\r\n    position: 'absolute',\r\n    top: 4,\r\n    right: 4,\r\n    backgroundColor: theme.colors.error,\r\n    borderRadius: 10,\r\n    minWidth: 20,\r\n    height: 20,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n  },\r\n  notificationCount: {\r\n    color: theme.colors.whiteText,\r\n    fontSize: 12,\r\n    fontWeight: 'bold',\r\n  },\r\n  profileButton: {\r\n    borderRadius: 20,\r\n    overflow: 'hidden',\r\n  },\r\n  welcomeSection: {\r\n    padding: 24,\r\n    paddingTop: 0,\r\n  },\r\n  welcomeContent: {\r\n    maxWidth: 1200,\r\n    marginHorizontal: 'auto',\r\n    width: '100%',\r\n  },\r\n  welcomeCard: {\r\n    backgroundColor: 'transparent',\r\n    backgroundImage: 'linear-gradient(to right, #6B6C53, #86C5D9)',\r\n    borderRadius: 12,\r\n    padding: 24,\r\n    marginBottom: 24,\r\n  },\r\n  welcomeHeader: {\r\n    flexDirection: 'row',\r\n    flexWrap: 'wrap',\r\n  },\r\n  welcomeTextContainer: {\r\n    flex: 1,\r\n    minWidth: 280,\r\n  },\r\n  statsContainer: {\r\n    padding: 24,\r\n    paddingTop: 0,\r\n    backgroundColor: '#f5f5f5',\r\n  },\r\n  statsGrid: {\r\n    display: 'grid',\r\n    gridTemplateColumns: 'repeat(auto-fit, minmax(140px, 1fr))',\r\n    gap: 24,\r\n    maxWidth: 1200,\r\n    marginHorizontal: 'auto',\r\n    width: '100%',\r\n  },\r\n  statCard: {\r\n    backgroundColor: theme.colors.surface,\r\n    padding: 16,\r\n    borderRadius: 12,\r\n    shadowColor: '#000',\r\n    shadowOffset: { width: 0, height: 2 },\r\n    shadowOpacity: 0.1,\r\n    shadowRadius: 4,\r\n    elevation: 3,\r\n    ...Platform.select({\r\n      ios: {\r\n        activeOpacity: 0.7,\r\n      },\r\n      android: {\r\n        android_ripple: {\r\n          color: 'rgba(0, 0, 0, 0.1)',\r\n        },\r\n      },\r\n    }),\r\n  },\r\n  statHeader: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    marginBottom: 12,\r\n  },\r\n  statIconContainer: {\r\n    width: 48,\r\n    height: 48,\r\n    borderRadius: 12,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n  },\r\n  bookingsContainer: {\r\n    padding: 24,\r\n    paddingTop: 0,\r\n    backgroundColor: '#f5f5f5',\r\n    maxWidth: 1200,\r\n    marginHorizontal: 'auto',\r\n    width: '100%',\r\n  },\r\n  bookingItem: {\r\n    marginBottom: 16,\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 8,\r\n    padding: 16,\r\n    shadowColor: '#000',\r\n    shadowOffset: { width: 0, height: 1 },\r\n    shadowOpacity: 0.1,\r\n    shadowRadius: 2,\r\n    elevation: 2,\r\n  },\r\n  bookingContent: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n  },\r\n  bookingInfo: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    flex: 1,\r\n  },\r\n  bookingDetails: {\r\n    marginLeft: 12,\r\n  },\r\n  bookingTitle: {\r\n    fontSize: 16,\r\n    fontWeight: '600',\r\n    color: theme.colors.text,\r\n    marginBottom: 4,\r\n  },\r\n  bookingTime: {\r\n    fontSize: 14,\r\n    color: theme.colors.textSecondary,\r\n  },\r\n  bookingStatus: {\r\n    alignItems: 'flex-end',\r\n  },\r\n  statusText: {\r\n    fontSize: 14,\r\n    fontWeight: '500',\r\n    marginBottom: 8,\r\n  },\r\n  progressBar: {\r\n    width: 100,\r\n    height: 4,\r\n    backgroundColor: theme.colors.border,\r\n    borderRadius: 2,\r\n    overflow: 'hidden',\r\n  },\r\n  progress: {\r\n    height: '100%',\r\n    backgroundColor: theme.colors.primary,\r\n  },\r\n  timeLeft: {\r\n    fontSize: 12,\r\n    color: theme.colors.textSecondary,\r\n    marginTop: 4,\r\n  },\r\n  emptyStateContainer: {\r\n    padding: 40,\r\n    alignItems: 'center',\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 8,\r\n    marginBottom: 24,\r\n  },\r\n  emptyStateTitle: {\r\n    fontSize: theme.fontSizes.large,\r\n    color: theme.colors.text,\r\n    fontWeight: '600',\r\n    marginTop: 16,\r\n    marginBottom: 8,\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n  },\r\n  emptyStateText: {\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.textSecondary,\r\n    textAlign: 'center',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    marginBottom: 24,\r\n  },\r\n  createServiceButton: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    backgroundColor: '#6B6C53',\r\n    paddingVertical: 12,\r\n    paddingHorizontal: 20,\r\n    borderRadius: 8,\r\n    gap: 8,\r\n  },\r\n  createServiceButtonText: {\r\n    color: theme.colors.surface,\r\n    fontSize: 16,\r\n    fontWeight: '600',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  loadingContainer: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n  },\r\n  filterContainer: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    marginBottom: 16,\r\n    paddingHorizontal: 24,\r\n    paddingVertical: 8,\r\n    borderRadius: 30,\r\n    // marginHorizontal: 24,\r\n  },\r\n  filterButtons: {\r\n    flexDirection: 'row',\r\n    backgroundColor: 'rgb(238, 241, 245)', //rgb(227, 229, 232)\r\n    padding: 4,\r\n    borderRadius: 5,\r\n    // gap: 4,\r\n  },\r\n  filterButton: {\r\n    paddingHorizontal: 20,\r\n    paddingVertical: 10,\r\n    borderRadius: 5,\r\n  },\r\n  activeFilterButton: {\r\n    backgroundColor: theme.colors.surface,\r\n    shadowColor: '#000',\r\n    shadowOffset: {\r\n      width: 0,\r\n      height: 2,\r\n    },\r\n    shadowOpacity: 0.05,\r\n    shadowRadius: 3,\r\n    elevation: 2,\r\n  },\r\n  filterText: {\r\n    color: '#6B7280',\r\n    fontSize: 16,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    fontWeight: '500',\r\n  },\r\n  activeFilterText: {\r\n    color: '#111827',\r\n    fontWeight: '600',\r\n  },\r\n  viewAllButton: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    gap: 4,\r\n    paddingRight: 12,\r\n  },\r\n  viewAllText: {\r\n    color: theme.colors.primary,\r\n    fontSize: 16,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    fontWeight: '500',\r\n  },\r\n  servicesContainer: {\r\n    padding: 24,\r\n    paddingTop: 0,\r\n  },\r\n  sectionHeader: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    marginBottom: 16,\r\n  },\r\n  servicesGrid: {\r\n    display: 'grid',\r\n    gridTemplateColumns: 'repeat(auto-fill, minmax(300px, 1fr))',\r\n    gap: 16,\r\n  },\r\n  serviceCard: {\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 12,\r\n    padding: 20,\r\n    marginBottom: 16,\r\n    shadowColor: '#000',\r\n    shadowOffset: {\r\n      width: 0,\r\n      height: 2,\r\n    },\r\n    shadowOpacity: 0.05,\r\n    shadowRadius: 3,\r\n    elevation: 2,\r\n    justifyContent: 'space-between',\r\n  },\r\n  serviceContent: {\r\n    marginBottom: 20,\r\n  },\r\n  serviceHeader: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'flex-start',\r\n    marginBottom: 4,\r\n  },\r\n  serviceTitle: {\r\n    fontSize: 16,\r\n    fontWeight: '600',\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n    maxWidth: '50%',\r\n  },\r\n  serviceCategory: {\r\n    fontSize: 14,\r\n    color: theme.colors.textSecondary,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  serviceFooter: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    justifyContent: 'space-between',\r\n  },\r\n  bookingsCount: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    gap: 6,\r\n  },\r\n  bookingsText: {\r\n    fontSize: 14,\r\n    color: theme.colors.textSecondary,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  serviceRate: {\r\n    fontSize: 16,\r\n    color: '#6B6C53',\r\n    fontWeight: '600',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  viewButton: {\r\n    paddingVertical: 8,\r\n    paddingHorizontal: 16,\r\n    borderRadius: 6,\r\n    backgroundColor: theme.colors.surface,\r\n    shadowColor: '#000',\r\n    shadowOffset: {\r\n      width: 0,\r\n      height: 1,\r\n    },\r\n    shadowOpacity: 0.05,\r\n    shadowRadius: 2,\r\n    elevation: 1,\r\n  },\r\n  viewButtonText: {\r\n    color: theme.colors.text,\r\n    fontSize: 14,\r\n    fontWeight: '500',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n});\r\n\r\nexport default Dashboard;\r\n","import React, { useState, useEffect, useContext } from 'react';\r\nimport { View, Text, TextInput, StyleSheet, ScrollView, SafeAreaView, Platform, StatusBar, TouchableOpacity, ActivityIndicator, Alert, Image, useWindowDimensions } from 'react-native';\r\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\r\nimport { theme } from '../styles/theme';\r\nimport * as ImagePicker from 'expo-image-picker';\r\nimport { AuthContext } from '../context/AuthContext';\r\nimport { navigateToFrom, handleBack } from '../components/Navigation';\r\nimport AsyncStorage from '@react-native-async-storage/async-storage';\r\n\r\n\r\n// TODO: mention to user initially we are doing a manual verification process, will implement automation later.\r\nconst BecomeProfessional = ({ navigation }) => {\r\n  const { width: windowWidth } = useWindowDimensions();\r\n  const { screenWidth, isCollapsed, is_DEBUG } = useContext(AuthContext);\r\n  const [isMobile, setIsMobile] = useState(screenWidth <= 900);\r\n  const [selectedPets, setSelectedPets] = useState({\r\n    dog: false,\r\n    cat: false,\r\n    exotics: false,\r\n  });\r\n  const [about, setAbout] = useState('');\r\n  const [certifications, setCertifications] = useState([]);\r\n  const [insuranceProof, setInsuranceProof] = useState([]);\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const updateLayout = () => {\r\n      setIsMobile(screenWidth <= 900);\r\n    };\r\n    updateLayout();\r\n  }, [screenWidth]);\r\n\r\n  useEffect(() => {\r\n    const initializeNavigation = async () => {\r\n      const currentRoute = Platform.OS === 'web' ? sessionStorage.getItem('currentRoute') : await AsyncStorage.getItem('currentRoute');\r\n      if (currentRoute !== 'BecomeProfessional') {\r\n        await navigateToFrom(navigation, 'BecomeProfessional', currentRoute);\r\n      } else {\r\n        if (is_DEBUG) {\r\n          console.log('Error, currentRoute is BecomeProfessional');\r\n        }\r\n      }\r\n    };\r\n    initializeNavigation();\r\n  }, []);\r\n\r\n  const handleBackPress = () => {\r\n    handleBack(navigation);\r\n  };\r\n\r\n  const togglePetSelection = (pet) => {\r\n    setSelectedPets({ ...selectedPets, [pet]: !selectedPets[pet] });\r\n  };\r\n\r\n  const pickCertification = async () => {\r\n    let result = await ImagePicker.launchImageLibraryAsync({\r\n      mediaTypes: ImagePicker.MediaTypeOptions.Images,\r\n      allowsEditing: true,\r\n      aspect: [4, 3],\r\n      quality: 1,\r\n      base64: true,\r\n    });\r\n\r\n    if (!result.canceled) {\r\n      const newCertification = {\r\n        uri: result.assets[0].uri,\r\n        base64: result.assets[0].base64,\r\n        name: result.assets[0].uri.split('/').pop()\r\n      };\r\n      setCertifications([...certifications, newCertification]);\r\n    }\r\n  };\r\n\r\n  const pickInsuranceProof = async () => {\r\n    let result = await ImagePicker.launchImageLibraryAsync({\r\n      mediaTypes: ImagePicker.MediaTypeOptions.Images,\r\n      allowsEditing: true,\r\n      aspect: [4, 3],\r\n      quality: 1,\r\n      base64: true,\r\n    });\r\n\r\n    if (!result.canceled) {\r\n      const newProof = {\r\n        uri: result.assets[0].uri,\r\n        base64: result.assets[0].base64,\r\n        name: result.assets[0].uri.split('/').pop()\r\n      };\r\n      setInsuranceProof([...insuranceProof, newProof]);\r\n    }\r\n  };\r\n\r\n  const removeCertification = (index) => {\r\n    setCertifications(certifications.filter((_, i) => i !== index));\r\n  };\r\n\r\n  const removeInsuranceProof = (index) => {\r\n    setInsuranceProof(insuranceProof.filter((_, i) => i !== index));\r\n  };\r\n\r\n  const handleSubmit = async () => {\r\n    setIsSubmitting(true);\r\n\r\n    \r\n      // Original submission logic for non-prototype mode\r\n      setTimeout(() => {\r\n        setIsSubmitting(false);\r\n        setSelectedPets({\r\n          dog: false,\r\n          cat: false,\r\n          exotics: false,\r\n        });\r\n        setAbout('');\r\n        setCertifications([]);\r\n        setInsuranceProof([]);\r\n        if (Platform.OS === 'web') {\r\n          window.confirm('Success: Your application has been submitted successfully!') && navigation.navigate('More');\r\n        } else {\r\n          Alert.alert('Success', 'Your application has been submitted successfully!', [\r\n            { text: 'OK', onPress: () => navigation.navigate('More', { screen: 'More', transition: 'slide' }) },\r\n          ]);\r\n        }\r\n      }, 2000);\r\n  };\r\n\r\n  const createStyles = (screenWidth, isCollapsed) => StyleSheet.create({\r\n    mainContainer: {\r\n      flex: 1,\r\n      backgroundColor: theme.colors.background,\r\n      height: '100vh',\r\n      overflow: 'hidden',\r\n      position: 'fixed',\r\n      top: 0,\r\n      left: 0,\r\n      right: 0,\r\n      bottom: 0,\r\n      marginLeft: screenWidth > 900 ? (isCollapsed ? 70 : 250) : 0,\r\n      transition: 'margin-left 0.3s ease',\r\n    },\r\n    container: {\r\n      flex: 1,\r\n      backgroundColor: theme.colors.background,\r\n      paddingTop: Platform.OS === 'android' ? StatusBar.currentHeight : 0,\r\n    },\r\n    scrollContent: {\r\n      flexGrow: 1,\r\n      padding: screenWidth <= 900 ? 16 : 20,\r\n      width: screenWidth > 900 ? '60%' : '90%',\r\n      maxWidth: 800,\r\n      alignSelf: 'center',\r\n    },\r\n    header: {\r\n      flexDirection: 'row',\r\n      alignItems: 'center',\r\n      padding: 16,\r\n      borderBottomWidth: 1,\r\n      borderBottomColor: theme.colors.border,\r\n      display: screenWidth <= 900 ? 'flex' : 'none',\r\n    },\r\n    backButton: {\r\n      marginRight: 16,\r\n    },\r\n    headerText: {\r\n      fontSize: 20,\r\n      fontWeight: 'bold',\r\n      color: theme.colors.primary,\r\n    },\r\n    title: {\r\n      fontSize: screenWidth <= 900 ? 24 : 32,\r\n      color: theme.colors.text,\r\n      textAlign: 'center',\r\n      marginBottom: screenWidth <= 900 ? 16 : 24,\r\n      fontFamily: theme.fonts.header.fontFamily,\r\n    },\r\n    label: {\r\n      fontSize: theme.fontSizes.medium,\r\n      color: theme.colors.text,\r\n      marginBottom: screenWidth <= 900 ? 8 : 12,\r\n      fontFamily: theme.fonts.regular.fontFamily,\r\n    },\r\n    checkboxContainer: {\r\n      flexDirection: 'row',\r\n      flexWrap: 'wrap',\r\n      justifyContent: screenWidth <= 900 ? 'space-between' : 'flex-start',\r\n      gap: screenWidth <= 900 ? 8 : 16,\r\n      marginBottom: screenWidth <= 900 ? 16 : 24,\r\n    },\r\n    petButton: {\r\n      flexDirection: 'row',\r\n      alignItems: 'center',\r\n      padding: screenWidth <= 900 ? 8 : 12,\r\n      borderWidth: 1,\r\n      borderColor: theme.colors.primary,\r\n      borderRadius: 8,\r\n      backgroundColor: theme.colors.surface,\r\n      minWidth: screenWidth <= 900 ? '45%' : 150,\r\n    },\r\n    selectedPetButton: {\r\n      backgroundColor: theme.colors.primary,\r\n    },\r\n    petButtonText: {\r\n      marginLeft: 8,\r\n      color: theme.colors.primary,\r\n      fontSize: theme.fontSizes.medium,\r\n      fontFamily: theme.fonts.regular.fontFamily,\r\n    },\r\n    selectedPetButtonText: {\r\n      color: theme.colors.surface,\r\n    },\r\n    textInput: {\r\n      borderColor: theme.colors.border,\r\n      borderWidth: 1,\r\n      borderRadius: 8,\r\n      padding: screenWidth <= 900 ? 12 : 16,\r\n      marginBottom: screenWidth <= 900 ? 16 : 24,\r\n      backgroundColor: theme.colors.inputBackground,\r\n      minHeight: 120,\r\n      fontSize: theme.fontSizes.medium,\r\n      fontFamily: theme.fonts.regular.fontFamily,\r\n    },\r\n    uploadButton: {\r\n      flexDirection: 'row',\r\n      alignItems: 'center',\r\n      justifyContent: 'center',\r\n      padding: screenWidth <= 900 ? 12 : 16,\r\n      borderWidth: 1,\r\n      borderColor: theme.colors.border,\r\n      borderRadius: 8,\r\n      borderStyle: 'dashed',\r\n      marginBottom: screenWidth <= 900 ? 12 : 16,\r\n    },\r\n    uploadText: {\r\n      marginLeft: 8,\r\n      color: theme.colors.text,\r\n      fontSize: theme.fontSizes.medium,\r\n      fontFamily: theme.fonts.regular.fontFamily,\r\n    },\r\n    uploadedFileContainer: {\r\n      flexDirection: 'row',\r\n      alignItems: 'center',\r\n      backgroundColor: theme.colors.surfaceVariant,\r\n      padding: screenWidth <= 900 ? 8 : 12,\r\n      borderRadius: 8,\r\n      marginBottom: 8,\r\n    },\r\n    uploadedFilePreview: {\r\n      width: 40,\r\n      height: 40,\r\n      borderRadius: 4,\r\n      marginRight: 8,\r\n    },\r\n    certificationText: {\r\n      flex: 1,\r\n      fontSize: theme.fontSizes.small,\r\n      color: theme.colors.text,\r\n      marginRight: 8,\r\n      fontFamily: theme.fonts.regular.fontFamily,\r\n    },\r\n    removeFileButton: {\r\n      padding: 4,\r\n    },\r\n    submitButton: {\r\n      backgroundColor: theme.colors.primary,\r\n      padding: screenWidth <= 900 ? 12 : 16,\r\n      borderRadius: 8,\r\n      alignItems: 'center',\r\n      marginTop: screenWidth <= 900 ? 20 : 32,\r\n    },\r\n    submitButtonDisabled: {\r\n      opacity: 0.6,\r\n    },\r\n    submitButtonText: {\r\n      color: theme.colors.surface,\r\n      fontSize: theme.fontSizes.medium,\r\n      fontWeight: 'bold',\r\n      fontFamily: theme.fonts.regular.fontFamily,\r\n    },\r\n    loadingIndicator: {\r\n      marginTop: 16,\r\n    },\r\n    formContainer: {\r\n      width: '100%',\r\n    },\r\n  });\r\n\r\n  return (\r\n    <View style={createStyles(screenWidth, isCollapsed).mainContainer}>\r\n      <SafeAreaView style={createStyles(screenWidth, isCollapsed).container}>\r\n        {isMobile && (\r\n          <View style={createStyles(screenWidth, isCollapsed).header}>\r\n            <TouchableOpacity onPress={handleBackPress} style={createStyles(screenWidth, isCollapsed).backButton}>\r\n              <MaterialCommunityIcons name=\"arrow-left\" size={24} color={theme.colors.primary} />\r\n            </TouchableOpacity>\r\n            <Text style={createStyles(screenWidth, isCollapsed).headerText}>Become a Professional</Text>\r\n          </View>\r\n        )}\r\n        \r\n        <ScrollView contentContainerStyle={createStyles(screenWidth, isCollapsed).scrollContent}>\r\n          <View style={createStyles(screenWidth, isCollapsed).formContainer}>\r\n            <Text style={createStyles(screenWidth, isCollapsed).title}>Become a Professional</Text>\r\n            \r\n            <Text style={createStyles(screenWidth, isCollapsed).label}>Select Pets You Can Sit:</Text>\r\n            <View style={createStyles(screenWidth, isCollapsed).checkboxContainer}>\r\n              {['dog', 'cat', 'exotics'].map((pet) => (\r\n                <TouchableOpacity\r\n                  key={pet}\r\n                  style={[\r\n                    createStyles(screenWidth, isCollapsed).petButton,\r\n                    selectedPets[pet] && createStyles(screenWidth, isCollapsed).selectedPetButton,\r\n                  ]}\r\n                  onPress={() => togglePetSelection(pet)}\r\n                >\r\n                  <MaterialCommunityIcons\r\n                    name={pet === 'exotics' ? 'turtle' : pet}\r\n                    size={24}\r\n                    color={selectedPets[pet] ? theme.colors.surface : theme.colors.primary}\r\n                  />\r\n                  <Text style={[\r\n                    createStyles(screenWidth, isCollapsed).petButtonText,\r\n                    selectedPets[pet] && createStyles(screenWidth, isCollapsed).selectedPetButtonText\r\n                  ]}>\r\n                    {pet.charAt(0).toUpperCase() + pet.slice(1)}\r\n                  </Text>\r\n                </TouchableOpacity>\r\n              ))}\r\n            </View>\r\n\r\n            <Text style={createStyles(screenWidth, isCollapsed).label}>About You:</Text>\r\n            <TextInput\r\n              style={createStyles(screenWidth, isCollapsed).textInput}\r\n              multiline\r\n              numberOfLines={4}\r\n              placeholder=\"Write a little about yourself...\"\r\n              value={about}\r\n              onChangeText={setAbout}\r\n            />\r\n\r\n            <Text style={createStyles(screenWidth, isCollapsed).label}>Upload Certifications/Resume:</Text>\r\n            <TouchableOpacity style={createStyles(screenWidth, isCollapsed).uploadButton} onPress={pickCertification}>\r\n              <MaterialCommunityIcons name=\"file-upload\" size={24} color={theme.colors.text} />\r\n              <Text style={createStyles(screenWidth, isCollapsed).uploadText}>Upload Documents</Text>\r\n            </TouchableOpacity>\r\n            {certifications.map((cert, index) => (\r\n              <View key={index} style={createStyles(screenWidth, isCollapsed).uploadedFileContainer}>\r\n                <Image source={{ uri: cert.uri }} style={createStyles(screenWidth, isCollapsed).uploadedFilePreview} />\r\n                <Text style={createStyles(screenWidth, isCollapsed).certificationText} numberOfLines={1}>\r\n                  {cert.name}\r\n                </Text>\r\n                <TouchableOpacity \r\n                  style={createStyles(screenWidth, isCollapsed).removeFileButton}\r\n                  onPress={() => removeCertification(index)}\r\n                >\r\n                  <MaterialCommunityIcons name=\"close\" size={20} color={theme.colors.error} />\r\n                </TouchableOpacity>\r\n              </View>\r\n            ))}\r\n\r\n            <Text style={createStyles(screenWidth, isCollapsed).label}>Upload Insurance Proof:</Text>\r\n            <TouchableOpacity style={createStyles(screenWidth, isCollapsed).uploadButton} onPress={pickInsuranceProof}>\r\n              <MaterialCommunityIcons name=\"file-upload\" size={24} color={theme.colors.text} />\r\n              <Text style={createStyles(screenWidth, isCollapsed).uploadText}>Upload Insurance</Text>\r\n            </TouchableOpacity>\r\n            {insuranceProof.map((proof, index) => (\r\n              <View key={index} style={createStyles(screenWidth, isCollapsed).uploadedFileContainer}>\r\n                <Image source={{ uri: proof.uri }} style={createStyles(screenWidth, isCollapsed).uploadedFilePreview} />\r\n                <Text style={createStyles(screenWidth, isCollapsed).certificationText} numberOfLines={1}>\r\n                  {proof.name}\r\n                </Text>\r\n                <TouchableOpacity \r\n                  style={createStyles(screenWidth, isCollapsed).removeFileButton}\r\n                  onPress={() => removeInsuranceProof(index)}\r\n                >\r\n                  <MaterialCommunityIcons name=\"close\" size={20} color={theme.colors.error} />\r\n                </TouchableOpacity>\r\n              </View>\r\n            ))}\r\n\r\n            <TouchableOpacity \r\n              style={[\r\n                createStyles(screenWidth, isCollapsed).submitButton,\r\n                isSubmitting && createStyles(screenWidth, isCollapsed).submitButtonDisabled\r\n              ]} \r\n              onPress={handleSubmit} \r\n              disabled={isSubmitting}\r\n            >\r\n              <Text style={createStyles(screenWidth, isCollapsed).submitButtonText}>\r\n                {isSubmitting ? 'Submitting...' : 'Submit Application'}\r\n              </Text>\r\n            </TouchableOpacity>\r\n            \r\n            {isSubmitting && (\r\n              <ActivityIndicator \r\n                style={createStyles(screenWidth, isCollapsed).loadingIndicator} \r\n                size=\"small\" \r\n                color={theme.colors.primary} \r\n              />\r\n            )}\r\n          </View>\r\n        </ScrollView>\r\n      </SafeAreaView>\r\n    </View>\r\n  );\r\n};\r\n\r\nexport default BecomeProfessional;\r\n","import React, { useContext, useEffect, useState } from 'react';\r\nimport { View, StyleSheet, Alert, Platform, SafeAreaView, StatusBar } from 'react-native';\r\nimport { List, Divider, Button } from 'react-native-paper';\r\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\r\nimport { theme } from '../styles/theme';\r\nimport { AuthContext } from '../context/AuthContext';\r\nimport AsyncStorage from '@react-native-async-storage/async-storage';\r\nimport { navigateToFrom } from '../components/Navigation';\r\n\r\nconst MoreScreen = ({ navigation }) => {\r\n  const { isSignedIn, isApprovedProfessional, userRole, switchRole, signOut, screenWidth, isCollapsed, is_DEBUG } = useContext(AuthContext);\r\n  const [isMobile, setIsMobile] = useState(screenWidth <= 900);\r\n  const styles = createStyles(screenWidth, isCollapsed);\r\n\r\n  useEffect(() => {\r\n    const updateLayout = () => {\r\n      setIsMobile(screenWidth <= 900);\r\n    };\r\n    updateLayout();\r\n  }, [screenWidth]);\r\n\r\n  useEffect(() => {\r\n    const initializeRoutes = async () => {\r\n      try {\r\n        const initialRoute = isSignedIn \r\n          ? 'Dashboard'\r\n          : 'Home';\r\n\r\n        if (Platform.OS === 'web') {\r\n          sessionStorage.setItem('currentRoute', initialRoute);\r\n          sessionStorage.setItem('previousRoute', 'More');\r\n        } else {\r\n          await AsyncStorage.setItem('currentRoute', initialRoute);\r\n          await AsyncStorage.setItem('previousRoute', 'More');\r\n        }\r\n      } catch (error) {\r\n        console.error('Error initializing routes:', error);\r\n      }\r\n    };\r\n\r\n    initializeRoutes();\r\n  }, [isSignedIn, userRole]);\r\n\r\n  const handleNavigation = async (route, tab) => {\r\n    try {\r\n      await navigateToFrom(navigation, route, 'More', tab);\r\n    } catch (error) {\r\n      console.error('Error handling navigation:', error);\r\n      navigation.navigate(route);\r\n    }\r\n  };\r\n\r\n  const handleLogout = async () => {\r\n    try {\r\n      await signOut();\r\n      // Clear navigation history on logout\r\n      if (Platform.OS === 'web') {\r\n        sessionStorage.removeItem('currentRoute');\r\n        sessionStorage.removeItem('previousRoute');\r\n      } else {\r\n        await AsyncStorage.multiRemove(['currentRoute', 'previousRoute']);\r\n      }\r\n      Alert.alert('Logged Out', 'You have been successfully logged out.');\r\n      navigation.navigate('Home');\r\n    } catch (error) {\r\n      console.error('Logout failed', error);\r\n      Alert.alert('Logout Failed', 'An error occurred while logging out.');\r\n    }\r\n  };\r\n\r\n  const handleSwitchRole = async () => {\r\n    if (isApprovedProfessional) {\r\n      const newRole = userRole === 'professional' ? 'petOwner' : 'professional';\r\n      \r\n      await switchRole();\r\n      \r\n      // Store new route before navigating\r\n      const newRoute = 'Dashboard';\r\n      if (Platform.OS === 'web') {\r\n        sessionStorage.setItem('currentRoute', newRoute);\r\n      } else {\r\n        await AsyncStorage.setItem('currentRoute', newRoute);\r\n      }\r\n      \r\n      // Add a small delay to ensure state is updated before navigation\r\n      setTimeout(() => {\r\n        navigation.navigate(newRoute);\r\n      }, 0);\r\n    } else {\r\n      Alert.alert('Not Approved', 'You are not approved as a professional yet.');\r\n      handleNavigation('BecomeProfessional', 'Overview');\r\n    }\r\n  };\r\n\r\n  const menuItems = {\r\n    notSignedIn: [\r\n      { title: 'Privacy Policy', icon: 'shield-account', route: 'PrivacyPolicy' },\r\n      { title: 'Terms of Service', icon: 'file-document', route: 'TermsOfService' },\r\n    ],\r\n    petOwner: [\r\n      { title: 'Profile', icon: 'account', route: 'MyProfile' },\r\n      { title: 'My Bookings', icon: 'calendar-clock', route: 'MyBookings' },\r\n      { title: 'Payment Methods', icon: 'credit-card', route: 'PaymentMethods' },\r\n      { title: 'Become a Professional', icon: 'account-tie', route: 'BecomeProfessional' },\r\n      { title: 'Settings', icon: 'cog', route: 'Settings' },\r\n      { title: 'Blog', icon: 'post', route: 'Blog' },\r\n      { title: 'Privacy Policy', icon: 'shield-account', route: 'PrivacyPolicy' },\r\n      { title: 'Terms of Service', icon: 'file-document', route: 'TermsOfService' },\r\n      { title: 'Contact Us', icon: 'email', route: 'ContactUs' },\r\n    ],\r\n    professional: [\r\n      { title: 'Profile', icon: 'account', route: 'MyProfile' },\r\n      { title: 'My Services', icon: 'briefcase-outline', route: 'ServiceManager' },\r\n      { title: 'My Bookings', icon: 'calendar-clock', route: 'MyBookings' },\r\n      { title: 'Payment Methods', icon: 'credit-card', route: 'PaymentMethods' },\r\n      { title: 'Settings', icon: 'cog', route: 'Settings' },\r\n      { title: 'Blog', icon: 'post', route: 'Blog' },\r\n      { title: 'Privacy Policy', icon: 'shield-account', route: 'PrivacyPolicy' },\r\n      { title: 'Terms of Service', icon: 'file-document', route: 'TermsOfService' },\r\n      { title: 'Contact Us', icon: 'email', route: 'ContactUs' },\r\n    ],\r\n  };\r\n\r\n  const renderMenuItems = () => {\r\n    let items;\r\n    if (!isSignedIn) {\r\n      items = menuItems.notSignedIn;\r\n    } else if (userRole === 'professional') {\r\n      items = menuItems.professional;\r\n    } else {\r\n      items = menuItems.petOwner;\r\n    }\r\n\r\n    return items.map((item, index) => (\r\n      <React.Fragment key={index}>\r\n        <List.Item\r\n          title={item.title}\r\n          titleStyle={styles.listItemTitle}\r\n          left={props => \r\n            Platform.OS === 'web' \r\n              ? <MaterialCommunityIcons \r\n                  name={item.icon} \r\n                  size={screenWidth <= 900 ? 20 : 24} \r\n                  color={theme.colors.primary} \r\n                />\r\n              : <List.Icon {...props} icon={item.icon} />\r\n          }\r\n          onPress={() => handleNavigation(item.route, item.tab || 'Overview')}\r\n          style={[\r\n            styles.webListItem,\r\n            { paddingHorizontal: screenWidth <= 900 ? 8 : 16 }\r\n          ]}\r\n        />\r\n        {index < items.length - 1 && <Divider />}\r\n      </React.Fragment>\r\n    ));\r\n  };\r\n\r\n  return (\r\n    <View style={styles.mainContainer}>\r\n      <SafeAreaView style={styles.container}>\r\n        <View style={styles.content}>\r\n          <View style={styles.webContent}>\r\n            <List.Section style={styles.listSection}>\r\n              {renderMenuItems()}\r\n            </List.Section>\r\n            {isSignedIn && (\r\n              <View style={styles.buttonContainer}>\r\n                <Button \r\n                  mode=\"contained\" \r\n                  onPress={handleLogout} \r\n                  style={[styles.logoutButton]}\r\n                  labelStyle={styles.buttonText}\r\n                >\r\n                  Log Out\r\n                </Button>\r\n              </View>\r\n            )}\r\n          </View>\r\n        </View>\r\n      </SafeAreaView>\r\n    </View>\r\n  );\r\n};\r\n\r\nconst createStyles = (screenWidth, isCollapsed) => StyleSheet.create({\r\n  mainContainer: {\r\n    flex: 1,\r\n    backgroundColor: theme.colors.background,\r\n    height: '100vh',\r\n    overflow: 'hidden',\r\n    position: 'fixed',\r\n    top: 0,\r\n    left: 0,\r\n    right: 0,\r\n    bottom: 0,\r\n    marginLeft: screenWidth > 900 ? (isCollapsed ? 70 : 250) : 0,\r\n    transition: 'margin-left 0.3s ease',\r\n  },\r\n  container: {\r\n    flex: 1,\r\n  },\r\n  content: {\r\n    flex: 1,\r\n    backgroundColor: theme.colors.background,\r\n    paddingTop: Platform.OS === 'android' ? StatusBar.currentHeight : 0,\r\n  },\r\n  webContent: {\r\n    width: '100%',\r\n    maxWidth: screenWidth > 900 ? 800 : 600,\r\n    alignSelf: 'center',\r\n    padding: screenWidth <= 900 ? 10 : 16,\r\n    paddingTop: screenWidth <= 900 ? 80 : 16,\r\n  },\r\n  listSection: {\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 8,\r\n    marginBottom: 16,\r\n  },\r\n  webListItem: {\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: theme.colors.border,\r\n    paddingVertical: screenWidth <= 900 ? 8 : 12,\r\n  },\r\n  listItemTitle: {\r\n    fontSize: screenWidth <= 900 ? theme.fontSizes.medium : theme.fontSizes.large,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    fontWeight: '600',\r\n  },\r\n  buttonContainer: {\r\n    marginBottom: 16,\r\n  },\r\n  switchRoleButton: {\r\n    borderColor: theme.colors.primary,\r\n  },\r\n  logoutButton: {\r\n    backgroundColor: theme.colors.error,\r\n  },\r\n  buttonText: {\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    fontWeight: '600',\r\n  }\r\n});\r\n\r\nexport default MoreScreen;\r\n","import React, { useState } from 'react';\r\nimport { View, Text, StyleSheet, TouchableOpacity, Modal } from 'react-native';\r\nimport { theme } from '../styles/theme';\r\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\r\nimport { format, parse } from 'date-fns';\r\n\r\nconst UnavailableTimeSlot = ({ startTime, endTime, reason, onPress, onRemove }) => {\r\n  const [showAllServices, setShowAllServices] = useState(false);\r\n  \r\n  const isAllDay = startTime === '00:00' && endTime === '24:00';\r\n\r\n  const formatTime = (time) => {\r\n    if (isAllDay) {\r\n      return 'All Day';\r\n    }\r\n    \r\n    if (typeof time === 'string') {\r\n      try {\r\n        const date = parse(time, 'HH:mm', new Date());\r\n        return format(date, 'h:mm a');\r\n      } catch (error) {\r\n        console.warn(`Invalid time format: ${time}`);\r\n        return 'Invalid Time';\r\n      }\r\n    } else if (time instanceof Date) {\r\n      return format(time, 'h:mm a');\r\n    } else {\r\n      console.warn(`Invalid time format: ${time}`);\r\n      return 'Invalid Time';\r\n    }\r\n  };\r\n\r\n  const formatServicesDisplay = () => {\r\n    const services = reason?.replace('Unavailable for: ', '').split(', ') || [];\r\n    \r\n    if (services.length === 0) return 'No services specified';\r\n    if (services.length === 10) return 'All Services';\r\n    return `${services.length} ${services.length === 1 ? 'Service' : 'Services'}`;\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <View style={styles.container}>\r\n        <TouchableOpacity \r\n          style={styles.removeButton} \r\n          onPress={onRemove}\r\n        >\r\n          <MaterialCommunityIcons name=\"close\" size={20} color={theme.colors.error} />\r\n        </TouchableOpacity>\r\n        \r\n        <View style={styles.contentContainer}>\r\n          <Text style={styles.time}>\r\n            {isAllDay ? 'All Day' : `${formatTime(startTime)} - ${formatTime(endTime)}`}\r\n          </Text>\r\n          <View style={styles.serviceContainer}>\r\n            <Text style={styles.reason}>{formatServicesDisplay()}</Text>\r\n            {reason && (\r\n              <TouchableOpacity \r\n                onPress={() => setShowAllServices(true)}\r\n                style={styles.seeMoreButton}\r\n              >\r\n                <Text style={styles.seeMoreText}>See All</Text>\r\n              </TouchableOpacity>\r\n            )}\r\n          </View>\r\n        </View>\r\n      </View>\r\n\r\n      <Modal\r\n        visible={showAllServices}\r\n        transparent={true}\r\n        animationType=\"fade\"\r\n        onRequestClose={() => setShowAllServices(false)}\r\n      >\r\n        <TouchableOpacity \r\n          style={styles.modalOverlay}\r\n          activeOpacity={1}\r\n          onPress={() => setShowAllServices(false)}\r\n        >\r\n          <View style={styles.modalContent}>\r\n            <View style={styles.modalHeader}>\r\n              <Text style={styles.modalTitle}>Unavailable Services</Text>\r\n              <TouchableOpacity onPress={() => setShowAllServices(false)}>\r\n                <MaterialCommunityIcons name=\"close\" size={24} color={theme.colors.text} />\r\n              </TouchableOpacity>\r\n            </View>\r\n            <Text style={styles.modalTime}>\r\n              {formatTime(startTime)} - {formatTime(endTime)}\r\n            </Text>\r\n            {reason?.replace('Unavailable for: ', '').split(', ').map((service, index) => (\r\n              <Text key={index} style={styles.serviceItem}>• {service}</Text>\r\n            ))}\r\n          </View>\r\n        </TouchableOpacity>\r\n      </Modal>\r\n    </>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    paddingVertical: 8,\r\n    paddingHorizontal: 10,\r\n    backgroundColor: theme.colors.lightGrey,\r\n    borderRadius: 5,\r\n    marginBottom: 5,\r\n  },\r\n  removeButton: {\r\n    padding: 5,\r\n    marginRight: 5,\r\n  },\r\n  contentContainer: {\r\n    flex: 1,\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n  },\r\n  time: {\r\n    fontSize: theme.fontSizes.small,\r\n    fontWeight: 'bold',\r\n    flex: 1,\r\n  },\r\n  serviceContainer: {\r\n    flex: 2,\r\n    flexDirection: 'row',\r\n    justifyContent: 'flex-end',\r\n    alignItems: 'center',\r\n  },\r\n  reason: {\r\n    fontSize: theme.fontSizes.small,\r\n    color: theme.colors.textSecondary,\r\n    marginRight: 8,\r\n  },\r\n  seeMoreButton: {\r\n    padding: 4,\r\n    borderRadius: 4,\r\n    backgroundColor: theme.colors.primary,\r\n  },\r\n  seeMoreText: {\r\n    color: theme.colors.whiteText,\r\n    fontSize: theme.fontSizes.small,\r\n  },\r\n  modalOverlay: {\r\n    flex: 1,\r\n    backgroundColor: 'rgba(0, 0, 0, 0.5)',\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n  },\r\n  modalContent: {\r\n    backgroundColor: theme.colors.background,\r\n    borderRadius: 8,\r\n    padding: 16,\r\n    width: '80%',\r\n    maxHeight: '80%',\r\n  },\r\n  modalHeader: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    marginBottom: 16,\r\n  },\r\n  modalTitle: {\r\n    fontSize: theme.fontSizes.large,\r\n    fontWeight: 'bold',\r\n    color: theme.colors.text,\r\n  },\r\n  modalTime: {\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.text,\r\n    marginBottom: 12,\r\n  },\r\n  serviceItem: {\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.text,\r\n    paddingVertical: 4,\r\n  },\r\n});\r\n\r\nexport default UnavailableTimeSlot;\r\n","// First, create a new BookingCard component\r\n// src/components/BookingCard.js\r\n\r\nimport React from 'react';\r\nimport { View, Text, StyleSheet, TouchableOpacity } from 'react-native';\r\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\r\nimport { theme } from '../styles/theme';\r\nimport { format, parse } from 'date-fns';\r\nimport { useNavigation } from '@react-navigation/native';\r\n\r\nconst AvailabilityBookingCard = ({ booking, onPress, onEdit }) => {\r\n  const navigation = useNavigation();\r\n  const formatTime = (time) => {\r\n    try {\r\n      const date = parse(time, 'HH:mm', new Date());\r\n      return format(date, 'h:mm a');\r\n    } catch (error) {\r\n      console.warn(`Invalid time format: ${time}`);\r\n      return 'Invalid Time';\r\n    }\r\n  };\r\n\r\n  const handlePress = () => {\r\n    if (onPress) {\r\n      onPress(booking);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <TouchableOpacity \r\n      style={styles.card} \r\n      onPress={handlePress}\r\n    >\r\n      <View style={styles.cardContent}>\r\n        <View style={styles.timeContainer}>\r\n          <MaterialCommunityIcons name=\"clock-outline\" size={20} color={theme.colors.primary} />\r\n          <Text style={styles.timeText}>\r\n            {formatTime(booking.startTime)} - {formatTime(booking.endTime)}\r\n          </Text>\r\n        </View>\r\n        <Text style={styles.ownerName}>Booked with {booking.owner_name}</Text>\r\n      </View>\r\n      <TouchableOpacity \r\n        style={styles.editButton} \r\n        onPress={handlePress}\r\n      >\r\n        <MaterialCommunityIcons name=\"pencil\" size={20} color={theme.colors.primary} />\r\n      </TouchableOpacity>\r\n    </TouchableOpacity>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  card: {\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 8,\r\n    padding: 12,\r\n    marginBottom: 8,\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    elevation: 2,\r\n    shadowColor: '#000',\r\n    shadowOffset: { width: 0, height: 1 },\r\n    shadowOpacity: 0.2,\r\n    shadowRadius: 2,\r\n  },\r\n  cardContent: {\r\n    flex: 1,\r\n  },\r\n  timeContainer: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    marginBottom: 4,\r\n  },\r\n  timeText: {\r\n    marginLeft: 8,\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.text,\r\n    fontWeight: '500',\r\n  },\r\n  ownerName: {\r\n    fontSize: theme.fontSizes.small,\r\n    color: theme.colors.textSecondary,\r\n  },\r\n  editButton: {\r\n    padding: 8,\r\n  },\r\n});\r\n\r\nexport default AvailabilityBookingCard;","import React, { useContext } from 'react';\r\nimport { View, Text, StyleSheet, Platform, TouchableOpacity } from 'react-native';\r\nimport DateTimePicker from '@react-native-community/datetimepicker';\r\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\r\nimport { theme } from '../styles/theme';\r\nimport { AuthContext } from '../context/AuthContext';\r\n\r\nconst TimePicker = ({ \r\n  label, \r\n  value, \r\n  onChange, \r\n  fullWidth = false, \r\n  containerStyle,\r\n  error,\r\n  disabled = false \r\n}) => {\r\n  const [showPicker, setShowPicker] = React.useState(false);\r\n  const { screenWidth } = useContext(AuthContext);\r\n  const showClockIcon = screenWidth > 400;\r\n\r\n  const handleChange = (event, selectedDate) => {\r\n    setShowPicker(Platform.OS === 'ios');\r\n    if (selectedDate) {\r\n      onChange(selectedDate);\r\n    }\r\n  };\r\n\r\n  const showTimepicker = () => {\r\n    setShowPicker(true);\r\n  };\r\n\r\n  if (Platform.OS === 'web') {\r\n    // Add browser detection for Chrome\r\n    const isChrome = typeof navigator !== 'undefined' && /Chrome/.test(navigator.userAgent) && /Google Inc/.test(navigator.vendor);\r\n\r\n    return (\r\n      <View style={[styles.container, fullWidth && styles.fullWidth, containerStyle]}>\r\n        {label && <Text style={[styles.label, error && styles.errorText]}>{label}</Text>}\r\n        <View style={[\r\n          styles.webInputContainer,\r\n          !fullWidth && styles.compactTimeButton,\r\n          error && styles.errorBorder,\r\n          disabled && styles.disabled\r\n        ]}>\r\n          <style>\r\n            {`\r\n              input[type=\"time\"]::-webkit-calendar-picker-indicator {\r\n                display: ${showClockIcon && isChrome ? 'block' : 'none'};\r\n              }\r\n              input[type=\"time\"]::-webkit-inner-spin-button,\r\n              input[type=\"time\"]::-webkit-clear-button {\r\n                display: none;\r\n              }\r\n            `}\r\n          </style>\r\n          <input\r\n            type=\"time\"\r\n            value={value.toTimeString().slice(0, 5)}\r\n            onChange={(e) => onChange(new Date(`2000-01-01T${e.target.value}`))}\r\n            style={{\r\n              ...styles.webInput,\r\n              paddingRight: '12px',\r\n            }}\r\n            disabled={disabled}\r\n          />\r\n          {showClockIcon && !isChrome && (\r\n            <MaterialCommunityIcons \r\n              name=\"clock-outline\" \r\n              size={24} \r\n              color={disabled ? theme.colors.placeholder : theme.colors.text}\r\n              style={styles.webIcon}\r\n              onPress={disabled ? null : () => {\r\n                const input = document.querySelector('input[type=\"time\"]');\r\n                if (input) input.showPicker();\r\n              }}\r\n            />\r\n          )}\r\n        </View>\r\n        {error && <Text style={styles.errorMessage}>{error}</Text>}\r\n      </View>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <View style={[styles.container, fullWidth && styles.fullWidth, containerStyle]}>\r\n      {label && <Text style={[styles.label, error && styles.errorText]}>{label}</Text>}\r\n      <TouchableOpacity \r\n        onPress={showTimepicker}\r\n        style={[\r\n          styles.timeButton, \r\n          !fullWidth && styles.compactTimeButton,\r\n          error && styles.errorBorder,\r\n          disabled && styles.disabled\r\n        ]}\r\n        disabled={disabled}\r\n      >\r\n        <Text style={[styles.timeText, disabled && styles.disabledText]}>\r\n          {value.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}\r\n        </Text>\r\n        {showClockIcon && (\r\n          <MaterialCommunityIcons \r\n            name=\"clock-outline\" \r\n            size={24} \r\n            color={disabled ? theme.colors.placeholder : theme.colors.text} \r\n          />\r\n        )}\r\n      </TouchableOpacity>\r\n      {error && <Text style={styles.errorMessage}>{error}</Text>}\r\n      {showPicker && (\r\n        <DateTimePicker\r\n          value={value}\r\n          mode=\"time\"\r\n          is24Hour={true}\r\n          display=\"default\"\r\n          onChange={handleChange}\r\n          disabled={disabled}\r\n        />\r\n      )}\r\n    </View>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    // marginVertical: 8,\r\n    // marginBottom: 8,\r\n  },\r\n  fullWidth: {\r\n    width: '100%',\r\n  },\r\n  label: {\r\n    fontSize: theme.fontSizes.smallMedium,\r\n    color: theme.colors.placeholder,\r\n    fontWeight: '500',\r\n  },\r\n  timeButton: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    borderRadius: 8,\r\n    padding: 8,\r\n    backgroundColor: theme.colors.background,\r\n    minHeight: 20,\r\n  },\r\n  compactTimeButton: {\r\n    width: 150,\r\n  },\r\n  timeText: {\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.text,\r\n  },\r\n  webInputContainer: {\r\n    position: 'relative',\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    borderRadius: 8,\r\n    backgroundColor: theme.colors.background,\r\n    overflow: 'hidden',\r\n    height: 40,\r\n    display: 'flex',\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n  },\r\n  webInput: {\r\n    // padding: '8px 36px 8px 12px',\r\n    fontSize: theme.fontSizes.medium,\r\n    marginLeft: 12,\r\n    width: '90%',\r\n    height: '100%',\r\n    border: 'none',\r\n    outline: 'none',\r\n    backgroundColor: 'transparent',\r\n    color: theme.colors.text,\r\n  },\r\n  webIcon: {\r\n    position: 'absolute',\r\n    right: 12,\r\n    cursor: 'pointer',\r\n    pointerEvents: 'auto',\r\n  },\r\n  errorBorder: {\r\n    borderColor: theme.colors.error,\r\n  },\r\n  errorText: {\r\n    color: theme.colors.error,\r\n  },\r\n  errorMessage: {\r\n    color: theme.colors.error,\r\n    fontSize: theme.fontSizes.small,\r\n    marginTop: 4,\r\n  },\r\n  disabled: {\r\n    backgroundColor: theme.colors.disabled,\r\n    opacity: 0.7,\r\n  },\r\n  disabledText: {\r\n    color: theme.colors.placeholder,\r\n  },\r\n});\r\n\r\nexport default TimePicker;\r\n\r\n","import React, { useState, useEffect } from 'react';\r\nimport { View, Text, StyleSheet, Modal, TouchableOpacity, Switch, Platform, Dimensions, ScrollView } from 'react-native';\r\nimport DateTimePicker from '@react-native-community/datetimepicker';\r\nimport { theme } from '../styles/theme';\r\nimport UnavailableTimeSlot from './UnavailableTimeSlot';\r\nimport { format, parse } from 'date-fns';\r\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\r\nimport { SERVICE_TYPES, ALL_SERVICES } from '../data/mockData';\r\nimport AvailabilityBookingCard from './AvailabilityBookingCard';\r\nimport { useNavigation } from '@react-navigation/native';\r\nimport TimePicker from './TimePicker';\r\n\r\nconst { width, height: SCREEN_HEIGHT } = Dimensions.get('window');\r\nconst modalWidth = Platform.OS === 'web' ? width * 0.4 : width * 0.9;\r\n\r\nconst AddAvailabilityModal = ({ isVisible: propIsVisible, onClose, onSave, selectedDates, currentAvailability, bookings, onRemoveTimeSlot }) => {\r\n  const [isVisible, setIsVisible] = useState(propIsVisible);\r\n  const [isAllDay, setIsAllDay] = useState(false);\r\n  const [startTime, setStartTime] = useState(new Date());\r\n  const [endTime, setEndTime] = useState(new Date());\r\n  const [showStartTimePicker, setShowStartTimePicker] = useState(false);\r\n  const [showEndTimePicker, setShowEndTimePicker] = useState(false);\r\n  const [selectedServices, setSelectedServices] = useState([]);\r\n  const [showServiceDropdown, setShowServiceDropdown] = useState(false);\r\n  const [modalWidth, setModalWidth] = useState(getModalWidth());\r\n  const [activeView, setActiveView] = useState('bookings');\r\n  const [editingBooking, setEditingBooking] = useState(null);\r\n  const navigation = useNavigation();\r\n\r\n  useEffect(() => {\r\n    setIsVisible(propIsVisible);\r\n  }, [propIsVisible]);\r\n\r\n  function getModalWidth() {\r\n    const { width } = Dimensions.get('window');\r\n    return width < 600 ? width * 0.9 : width * 0.4;\r\n  }\r\n\r\n  useEffect(() => {\r\n    const updateWidth = () => {\r\n      setModalWidth(getModalWidth());\r\n    };\r\n\r\n    const dimensionsHandler = Dimensions.addEventListener('change', updateWidth);\r\n\r\n    return () => {\r\n      dimensionsHandler.remove();\r\n    };\r\n  }, []);\r\n\r\n  const isTimeSlotUnavailable = () => {\r\n    if (!startTime || !endTime || isAllDay) return false;\r\n    \r\n    return selectedDates.some(date => {\r\n      const existingTimes = currentAvailability[date]?.unavailableTimes || [];\r\n      return existingTimes.some(time => {\r\n        const [existingStartHour, existingStartMin] = time.startTime.split(':').map(Number);\r\n        const [existingEndHour, existingEndMin] = time.endTime.split(':').map(Number);\r\n        const newStartStr = format(startTime, 'HH:mm');\r\n        const newEndStr = format(endTime, 'HH:mm');\r\n        const [newStartHour, newStartMin] = newStartStr.split(':').map(Number);\r\n        const [newEndHour, newEndMin] = newEndStr.split(':').map(Number);\r\n        \r\n        return newStartHour === existingStartHour && \r\n               newStartMin === existingStartMin && \r\n               newEndHour === existingEndHour && \r\n               newEndMin === existingEndMin;\r\n      });\r\n    });\r\n  };\r\n\r\n  const handleMarkUnavailable = () => {\r\n    if (selectedServices.length === 0 || isTimeSlotUnavailable()) return;\r\n    \r\n    const services = selectedServices.includes(ALL_SERVICES) \r\n      ? SERVICE_TYPES.filter(service => service !== ALL_SERVICES) \r\n      : selectedServices;\r\n\r\n    onSave({\r\n      dates: selectedDates,\r\n      isAllDay,\r\n      startTime: isAllDay ? null : format(startTime, 'HH:mm'),\r\n      endTime: isAllDay ? null : format(endTime, 'HH:mm'),\r\n      isUnavailable: true,\r\n      serviceTypes: services,\r\n      reason: `Unavailable for: ${services.join(', ')}`,\r\n    });\r\n  };\r\n\r\n  const handleMarkAvailable = () => {\r\n    if (selectedServices.length === 0 || !isTimeSlotUnavailable()) return;\r\n\r\n    const newStartStr = format(startTime, 'HH:mm');\r\n    const newEndStr = format(endTime, 'HH:mm');\r\n\r\n    const updatedAvailability = {};\r\n    \r\n    selectedDates.forEach(selectedDate => {\r\n      if (currentAvailability[selectedDate]?.unavailableTimes) {\r\n        const currentTimes = currentAvailability[selectedDate].unavailableTimes;\r\n        const filteredTimes = currentTimes.filter(time => \r\n          time.startTime !== newStartStr || time.endTime !== newEndStr\r\n        );\r\n\r\n        updatedAvailability[selectedDate] = {\r\n          ...currentAvailability[selectedDate],\r\n          unavailableTimes: filteredTimes\r\n        };\r\n      }\r\n    });\r\n\r\n    onRemoveTimeSlot(selectedDates[0], { startTime: newStartStr, endTime: newEndStr }, updatedAvailability, selectedDates);\r\n  };\r\n\r\n  const handleRemoveTimeSlot = (date, timeSlot) => {\r\n    if (selectedDates.length === 1) {\r\n      onRemoveTimeSlot(date, timeSlot);\r\n      return;\r\n    }\r\n\r\n    const updatedAvailability = {};\r\n    \r\n    selectedDates.forEach(selectedDate => {\r\n      if (currentAvailability[selectedDate]?.unavailableTimes) {\r\n        const currentTimes = currentAvailability[selectedDate].unavailableTimes;\r\n        const filteredTimes = currentTimes.filter(time => \r\n          time.startTime !== timeSlot.startTime || time.endTime !== timeSlot.endTime\r\n        );\r\n\r\n        updatedAvailability[selectedDate] = {\r\n          ...currentAvailability[selectedDate],\r\n          unavailableTimes: filteredTimes\r\n        };\r\n      }\r\n    });\r\n\r\n    onRemoveTimeSlot(date, timeSlot, updatedAvailability, selectedDates);\r\n  };\r\n\r\n  const renderUnavailableTimes = () => {\r\n    if (selectedDates.length === 0) return null;\r\n\r\n    const date = selectedDates[0];\r\n    const unavailableTimes = currentAvailability[date]?.unavailableTimes || [];\r\n\r\n    if (unavailableTimes.length === 0) return null;\r\n\r\n    return (\r\n      <View style={styles.unavailableTimesContainer}>\r\n        <Text style={styles.sectionTitle}>Unavailable Times:</Text>\r\n        <ScrollView>\r\n          {unavailableTimes.map((time, index) => (\r\n            <UnavailableTimeSlot\r\n              key={index}\r\n              startTime={time.startTime}\r\n              endTime={time.endTime}\r\n              reason={time.reason}\r\n              onRemove={() => handleRemoveTimeSlot(date, time)}\r\n            />\r\n          ))}\r\n        </ScrollView>\r\n      </View>\r\n    );\r\n  };\r\n\r\nconst renderTimePicker = () => (\r\n  <>\r\n    <View style={styles.timePickerContainer}>\r\n      <Text>Start Time:</Text>\r\n      <TimePicker\r\n        value={startTime}\r\n        onChange={setStartTime}\r\n        showPicker={showStartTimePicker}\r\n        setShowPicker={setShowStartTimePicker}\r\n        fullWidth\r\n      />\r\n    </View>\r\n    <View style={styles.timePickerContainer}>\r\n      <Text>End Time:</Text>\r\n      <TimePicker\r\n        value={endTime}\r\n        onChange={setEndTime}\r\n        showPicker={showEndTimePicker}\r\n        setShowPicker={setShowEndTimePicker}\r\n        fullWidth\r\n      />\r\n    </View>\r\n  </>\r\n);\r\n\r\nconst formatSelectedDates = () => {\r\n  if (!selectedDates || selectedDates.length === 0) return '';\r\n  \r\n  const startDate = selectedDates[0];\r\n  const endDate = selectedDates[selectedDates.length - 1];\r\n  \r\n  if (startDate === endDate) {\r\n    return startDate;\r\n  }\r\n  \r\n  return `${startDate} - ${endDate}`;\r\n};\r\n\r\nconst handleEditBooking = async (booking) => {\r\n  setEditingBooking(booking);\r\n  // Implement your booking edit logic here\r\n  try {\r\n    const response = await updateBooking({\r\n      ...booking,\r\n      // Add your updated booking data\r\n    });\r\n    \r\n    if (response.success) {\r\n      // Update local state\r\n      // Implement your state update logic\r\n    }\r\n  } catch (error) {\r\n    console.error('Failed to update booking:', error);\r\n  }\r\n};\r\n\r\nconst renderToggleButtons = () => (\r\n  <View style={styles.toggleContainer}>\r\n    <TouchableOpacity\r\n      style={[\r\n        styles.toggleButton,\r\n        activeView === 'unavailable' && styles.activeToggle\r\n      ]}\r\n      onPress={() => setActiveView('unavailable')}\r\n    >\r\n      <Text style={[\r\n        styles.toggleText,\r\n        activeView === 'unavailable' && styles.activeToggleText\r\n      ]}>\r\n        Unavailable Times\r\n      </Text>\r\n    </TouchableOpacity>\r\n    <TouchableOpacity\r\n      style={[\r\n        styles.toggleButton,\r\n        activeView === 'bookings' && styles.activeToggle\r\n      ]}\r\n      onPress={() => setActiveView('bookings')}\r\n    >\r\n      <Text style={[\r\n        styles.toggleText,\r\n        activeView === 'bookings' && styles.activeToggleText\r\n      ]}>\r\n        Bookings\r\n      </Text>\r\n    </TouchableOpacity>\r\n  </View>\r\n);\r\n\r\nconst renderBookings = () => {\r\n  const dateBookings = selectedDates.reduce((acc, date) => {\r\n    if (bookings[date]) {\r\n      acc.push(...bookings[date].map(booking => ({\r\n        ...booking,\r\n        date\r\n      })));\r\n    }\r\n    return acc;\r\n  }, []);\r\n\r\n  if (dateBookings.length === 0) {\r\n    return (\r\n      <View style={styles.emptyState}>\r\n        <MaterialCommunityIcons \r\n          name=\"calendar-blank\" \r\n          size={48} \r\n          color={theme.colors.textSecondary} \r\n        />\r\n        <Text style={styles.emptyStateText}>No bookings for selected dates</Text>\r\n      </View>\r\n    );\r\n  }\r\n\r\n  const handleBookingPress = (booking) => {\r\n    onClose();\r\n    \r\n    // Navigate after a short delay\r\n    setTimeout(() => {\r\n      navigation.navigate('BookingDetails', { bookingId: booking.id });\r\n    }, 300);\r\n  };\r\n\r\n  return (\r\n    <View style={styles.bookingsContainer}>\r\n      <ScrollView \r\n        style={styles.bookingsList}\r\n        nestedScrollEnabled={true}\r\n      >\r\n        {dateBookings.map((booking, index) => (\r\n          <AvailabilityBookingCard\r\n            key={index}\r\n            booking={booking}\r\n            onPress={() => handleBookingPress(booking)}\r\n            onEdit={() => handleBookingPress(booking)}\r\n          />\r\n        ))}\r\n      </ScrollView>\r\n    </View>\r\n  );\r\n};\r\n\r\n  return (\r\n    <Modal\r\n      visible={isVisible}\r\n      animationType=\"slide\"\r\n      transparent={true}\r\n      onRequestClose={onClose}\r\n    >\r\n      <View style={styles.modalContainer}>\r\n        <View style={[styles.modalContent, { width: modalWidth }]}>\r\n          <View style={styles.modalHeader}>\r\n            <Text style={styles.modalTitle}>\r\n              {selectedDates.length > 1 ? 'Edit Multiple Days' : 'Edit Availability'}\r\n            </Text>\r\n            <TouchableOpacity \r\n              style={styles.closeButton} \r\n              onPress={onClose}\r\n            >\r\n              <MaterialCommunityIcons \r\n                name=\"close\" \r\n                size={24} \r\n                color={theme.colors.text} \r\n              />\r\n            </TouchableOpacity>\r\n          </View>\r\n\r\n          <Text style={styles.selectedDatesText}>\r\n            Selected Dates: {formatSelectedDates()}\r\n          </Text>\r\n\r\n          {renderToggleButtons()}\r\n          \r\n          <ScrollView \r\n            style={styles.contentScrollView}\r\n            nestedScrollEnabled={true}\r\n          >\r\n            {activeView === 'unavailable' ? (\r\n              <View style={styles.unavailableTimesWrapper}>\r\n                {renderUnavailableTimes()}\r\n              </View>\r\n            ) : (\r\n              <View style={styles.bookingsWrapper}>\r\n                {renderBookings()}\r\n              </View>\r\n            )}\r\n\r\n            <View style={styles.availabilityControls}>\r\n              <View style={styles.inputWrapper}>\r\n                <Text style={styles.inputLabel}>Service Type(s) *</Text>\r\n                <TouchableOpacity\r\n                  style={[\r\n                    styles.input,\r\n                    styles.customDropdown,\r\n                    selectedServices.length === 0 && styles.inputError\r\n                  ]}\r\n                  onPress={() => setShowServiceDropdown(!showServiceDropdown)}\r\n                >\r\n                  <Text style={{\r\n                    color: selectedServices.length > 0 ? theme.colors.text : theme.colors.placeHolderText\r\n                  }}>\r\n                    {selectedServices.length > 0 \r\n                      ? selectedServices.includes(ALL_SERVICES)\r\n                        ? \"All Services\"\r\n                        : selectedServices.length > 1\r\n                          ? `${selectedServices.length} services selected`\r\n                          : selectedServices[0]\r\n                      : \"Select service type(s)\"\r\n                    }\r\n                  </Text>\r\n                  <MaterialCommunityIcons \r\n                    name={showServiceDropdown ? \"chevron-up\" : \"chevron-down\"} \r\n                    size={24} \r\n                    color={theme.colors.primary} \r\n                  />\r\n                </TouchableOpacity>\r\n                \r\n                {showServiceDropdown && (\r\n                  <View style={styles.dropdownContainer}>\r\n                    <ScrollView style={styles.dropdownScroll}>\r\n                      {SERVICE_TYPES.map((service) => (\r\n                        <TouchableOpacity\r\n                          key={service}\r\n                          style={styles.dropdownItem}\r\n                          onPress={() => {\r\n                            if (service === ALL_SERVICES) {\r\n                              setSelectedServices(\r\n                                selectedServices.includes(ALL_SERVICES) \r\n                                  ? [] \r\n                                  : [ALL_SERVICES]\r\n                              );\r\n                            } else {\r\n                              setSelectedServices(prev => {\r\n                                // Remove \"All Services\" if it was selected\r\n                                const withoutAll = prev.filter(s => s !== ALL_SERVICES);\r\n                                \r\n                                if (prev.includes(service)) {\r\n                                  return withoutAll.filter(s => s !== service);\r\n                                } else {\r\n                                  return [...withoutAll, service];\r\n                                }\r\n                              });\r\n                            }\r\n                          }}\r\n                        >\r\n                          <View style={styles.dropdownItemContent}>\r\n                            <Text style={[\r\n                              styles.dropdownText,\r\n                              selectedServices.includes(service) && styles.selectedOption\r\n                            ]}>\r\n                              {service}\r\n                            </Text>\r\n                            {selectedServices.includes(service) && (\r\n                              <MaterialCommunityIcons \r\n                                name=\"check\" \r\n                                size={20} \r\n                                color={theme.colors.primary} \r\n                              />\r\n                            )}\r\n                          </View>\r\n                        </TouchableOpacity>\r\n                      ))}\r\n                    </ScrollView>\r\n                  </View>\r\n                )}\r\n              </View>\r\n\r\n              <View style={styles.switchContainer}>\r\n                <Text>All Day</Text>\r\n                <Switch value={isAllDay} onValueChange={setIsAllDay} />\r\n              </View>\r\n\r\n              {!isAllDay && renderTimePicker()}\r\n\r\n              <View style={styles.buttonContainer}>\r\n                <TouchableOpacity\r\n                  style={[\r\n                    styles.availabilityButton,\r\n                    styles.availableButton,\r\n                    (selectedServices.length === 0 || !isTimeSlotUnavailable()) && styles.disabledButton\r\n                  ]}\r\n                  onPress={handleMarkAvailable}\r\n                  disabled={selectedServices.length === 0 || !isTimeSlotUnavailable()}\r\n                >\r\n                  <Text style={styles.availabilityButtonText}>\r\n                    Mark Available\r\n                  </Text>\r\n                </TouchableOpacity>\r\n\r\n                <TouchableOpacity\r\n                  style={[\r\n                    styles.availabilityButton,\r\n                    styles.unavailableButton,\r\n                    (selectedServices.length === 0 || isTimeSlotUnavailable()) && styles.disabledButton\r\n                  ]}\r\n                  onPress={handleMarkUnavailable}\r\n                  disabled={selectedServices.length === 0 || isTimeSlotUnavailable()}\r\n                >\r\n                  <Text style={styles.availabilityButtonText}>\r\n                    Mark Unavailable\r\n                  </Text>\r\n                </TouchableOpacity>\r\n              </View>\r\n            </View>\r\n          </ScrollView>\r\n        </View>\r\n      </View>\r\n    </Modal>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  modalContainer: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    backgroundColor: 'rgba(0, 0, 0, 0.5)',\r\n  },\r\n  modalContent: {\r\n    backgroundColor: theme.colors.background,\r\n    padding: 22,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    borderRadius: 17,\r\n    maxHeight: SCREEN_HEIGHT * 0.7,\r\n    zIndex: 1,\r\n  },\r\n  modalHeader: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    width: '100%',\r\n    marginBottom: 15,\r\n  },\r\n  modalTitle: {\r\n    fontSize: theme.fontSizes.large,\r\n    fontWeight: 'bold',\r\n  },\r\n  closeButton: {\r\n    padding: 5,\r\n  },\r\n  switchContainer: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    width: '100%',\r\n    marginVertical: 10,\r\n    zIndex: 1,\r\n  },\r\n  buttonContainer: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    width: '100%',\r\n    marginTop: 20,\r\n    gap: 10,\r\n  },\r\n  availabilityButton: {\r\n    padding: 10,\r\n    borderRadius: 5,\r\n    flex: 1,\r\n    alignItems: 'center',\r\n  },\r\n  availableButton: {\r\n    backgroundColor: theme.colors.primary,\r\n  },\r\n  unavailableButton: {\r\n    backgroundColor: theme.colors.danger,\r\n  },\r\n  disabledButton: {\r\n    opacity: 0.5,\r\n  },\r\n  availabilityButtonText: {\r\n    color: theme.colors.whiteText,\r\n    fontWeight: 'bold',\r\n  },\r\n  timePickerContainer: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    width: '100%',\r\n    marginVertical: 10,\r\n    zIndex: 1,\r\n  },\r\n  webTimePicker: {\r\n    padding: 5,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    borderRadius: 5,\r\n  },\r\n  unavailableTimesContainer: {\r\n    marginTop: 20,\r\n    maxHeight: 200,\r\n  },\r\n  sectionTitle: {\r\n    fontSize: theme.fontSizes.medium,\r\n    fontWeight: 'bold',\r\n    marginBottom: 10,\r\n  },\r\n  inputWrapper: {\r\n    position: 'relative',\r\n    width: '100%',\r\n    marginBottom: 15,\r\n    zIndex: 2,\r\n  },\r\n  \r\n  inputLabel: {\r\n    fontSize: theme.fontSizes.small,\r\n    color: theme.colors.text,\r\n    marginBottom: 5,\r\n    fontWeight: '500',\r\n  },\r\n  \r\n  input: {\r\n    borderColor: theme.colors.border,\r\n    borderWidth: 1,\r\n    borderRadius: 5,\r\n    padding: 10,\r\n    backgroundColor: theme.colors.inputBackground,\r\n  },\r\n  \r\n  customDropdown: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    height: 40,\r\n  },\r\n  \r\n  dropdownContainer: {\r\n    position: 'absolute',\r\n    top: '95%',\r\n    left: 0,\r\n    right: 0,\r\n    backgroundColor: theme.colors.surface,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    borderRadius: 5,\r\n    marginTop: 2,\r\n    maxHeight: 160,\r\n    zIndex: 1000,\r\n    elevation: 5,\r\n    shadowColor: \"#000\",\r\n    shadowOffset: {\r\n      width: 0,\r\n      height: 2,\r\n    },\r\n    shadowOpacity: 0.25,\r\n    shadowRadius: 3.84,\r\n  },\r\n  \r\n  dropdownScroll: {\r\n    maxHeight: 160,\r\n  },\r\n  \r\n  dropdownItem: {\r\n    padding: 10,\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: theme.colors.border,\r\n    height: 40,\r\n  },\r\n  \r\n  dropdownText: {\r\n    color: theme.colors.text,\r\n    fontSize: theme.fontSizes.medium,\r\n  },\r\n  \r\n  selectedOption: {\r\n    color: theme.colors.primary,\r\n    fontWeight: 'bold',\r\n  },\r\n  \r\n  inputError: {\r\n    borderColor: theme.colors.danger,\r\n  },\r\n  \r\n  dropdownItemContent: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    paddingRight: 10,\r\n  },\r\n  toggleContainer: {\r\n    flexDirection: 'row',\r\n    marginBottom: 16,\r\n    borderRadius: 8,\r\n    backgroundColor: theme.colors.surface,\r\n    padding: 4,\r\n  },\r\n  toggleButton: {\r\n    flex: 1,\r\n    paddingVertical: 8,\r\n    paddingHorizontal: 16,\r\n    borderRadius: 6,\r\n    borderColor: theme.colors.border,\r\n    borderWidth: 1,\r\n    margin: 2,\r\n  },\r\n  activeToggle: {\r\n    backgroundColor: theme.colors.primary,\r\n  },\r\n  toggleText: {\r\n    textAlign: 'center',\r\n    color: theme.colors.text,\r\n    fontSize: theme.fontSizes.small,\r\n  },\r\n  activeToggleText: {\r\n    color: theme.colors.whiteText,\r\n    fontWeight: '500',\r\n  },\r\n  bookingsList: {\r\n    maxHeight: 300,\r\n  },\r\n  emptyState: {\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    padding: 32,\r\n  },\r\n  emptyStateText: {\r\n    marginTop: 16,\r\n    color: theme.colors.textSecondary,\r\n    fontSize: theme.fontSizes.medium,\r\n    textAlign: 'center',\r\n  },\r\n  contentScrollView: {\r\n    flex: 1,\r\n    width: '100%',\r\n  },\r\n  availabilityControls: {\r\n    marginTop: 20,\r\n    paddingTop: 20,\r\n    borderTopWidth: 1,\r\n    borderTopColor: theme.colors.border,\r\n    width: '100%',\r\n  },\r\n  bookingsContainer: {\r\n    maxHeight: 200,\r\n    marginBottom: 16,\r\n  },\r\n  unavailableTimesWrapper: {\r\n    maxHeight: 200,\r\n    marginBottom: 16,\r\n  },\r\n  bookingsWrapper: {\r\n    marginBottom: 16,\r\n  },\r\n  selectedDatesText: {\r\n    marginVertical: 8,\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.text,\r\n  },\r\n});\r\n\r\nexport default AddAvailabilityModal;\r\n","import React, { useState } from 'react';\r\nimport { View, Text, StyleSheet, Platform } from 'react-native';\r\nimport { theme } from '../../styles/theme';\r\n\r\nconst DatetimePicker = ({ \r\n  format = [\r\n    [\"months\", \"days\", \"years\"],\r\n    [\"hours\", \"minutes\", \"am/pm\"]\r\n  ],\r\n  value,\r\n  onChange,\r\n  disabled = false,\r\n  isInModal = false,\r\n  error = false\r\n}) => {\r\n  const [selectedValues, setSelectedValues] = useState({\r\n    months: '',\r\n    days: '',\r\n    years: '',\r\n    hours: '',\r\n    minutes: '',\r\n    ampm: 'AM'\r\n  });\r\n\r\n  const handleSelectChange = (type, value) => {\r\n    if (disabled) return;\r\n    \r\n    const newValues = { ...selectedValues, [type]: value };\r\n    setSelectedValues(newValues);\r\n    \r\n    if (onChange) {\r\n      // Convert to date object and call onChange\r\n      const date = convertToDate(newValues);\r\n      onChange(date);\r\n    }\r\n  };\r\n\r\n  const convertToDate = (values) => {\r\n    const { months, days, years, hours, minutes, ampm } = values;\r\n    if (!months || !days || !years) return null;\r\n    \r\n    let hour = parseInt(hours || '12');\r\n    if (ampm === 'PM' && hour !== 12) hour += 12;\r\n    if (ampm === 'AM' && hour === 12) hour = 0;\r\n    \r\n    return new Date(\r\n      parseInt(years),\r\n      parseInt(months) - 1,\r\n      parseInt(days),\r\n      hour,\r\n      parseInt(minutes || '0')\r\n    );\r\n  };\r\n\r\n  const renderSelect = (type) => {\r\n    let options = [];\r\n    switch (type) {\r\n      case 'months':\r\n        options = Array.from({ length: 12 }, (_, i) => ({\r\n          value: (i + 1).toString(),\r\n          label: new Date(2000, i).toLocaleString('default', { month: 'long' })\r\n        }));\r\n        break;\r\n      case 'days':\r\n        options = Array.from({ length: 31 }, (_, i) => ({\r\n          value: (i + 1).toString(),\r\n          label: (i + 1).toString()\r\n        }));\r\n        break;\r\n      case 'years':\r\n        const currentYear = new Date().getFullYear();\r\n        options = Array.from({ length: 100 }, (_, i) => ({\r\n          value: (currentYear - 50 + i).toString(),\r\n          label: (currentYear - 50 + i).toString()\r\n        }));\r\n        break;\r\n      case 'hours':\r\n        options = Array.from({ length: 12 }, (_, i) => ({\r\n          value: (i + 1).toString(),\r\n          label: (i + 1).toString()\r\n        }));\r\n        break;\r\n      case 'minutes':\r\n        options = Array.from({ length: 60 }, (_, i) => ({\r\n          value: i.toString().padStart(2, '0'),\r\n          label: i.toString().padStart(2, '0')\r\n        }));\r\n        break;\r\n      case 'am/pm':\r\n        options = [\r\n          { value: 'AM', label: 'AM' },\r\n          { value: 'PM', label: 'PM' }\r\n        ];\r\n        break;\r\n    }\r\n\r\n    const handleChange = (e) => {\r\n      if (isInModal && Platform.OS === 'web') {\r\n        e.stopPropagation();\r\n      }\r\n      handleSelectChange(type === 'am/pm' ? 'ampm' : type, e.target.value);\r\n    };\r\n\r\n    const selectStyle = {\r\n      ...styles.select,\r\n      ...(error ? styles.errorSelect : {}),\r\n      ...(type === 'months' ? styles.monthSelect : {}),\r\n      ...(type === 'years' ? styles.yearSelect : {}),\r\n      ...(type === 'days' ? styles.daySelect : {})\r\n    };\r\n\r\n    return (\r\n      <select\r\n        value={selectedValues[type === 'am/pm' ? 'ampm' : type]}\r\n        onChange={handleChange}\r\n        style={selectStyle}\r\n        disabled={disabled}\r\n      >\r\n        <option value=\"\">{type.charAt(0).toUpperCase() + type.slice(1)}</option>\r\n        {options.map(option => (\r\n          <option key={option.value} value={option.value}>\r\n            {option.label}\r\n          </option>\r\n        ))}\r\n      </select>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <View style={styles.container}>\r\n      {format.map((row, rowIndex) => (\r\n        <View key={rowIndex} style={styles.row}>\r\n          {row.map((type, index) => (\r\n            <View key={type} style={styles.selectContainer}>\r\n              {renderSelect(type)}\r\n            </View>\r\n          ))}\r\n        </View>\r\n      ))}\r\n    </View>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    width: '100%',\r\n  },\r\n  row: {\r\n    flexDirection: 'row',\r\n    marginBottom: 8,\r\n    gap: 8,\r\n  },\r\n  selectContainer: {\r\n    flex: 1,\r\n  },\r\n  select: {\r\n    width: '100%',\r\n    padding: 8,\r\n    borderRadius: 4,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    backgroundColor: theme.colors.background,\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.text,\r\n    appearance: 'none',\r\n    WebkitAppearance: 'none',\r\n    MozAppearance: 'none',\r\n    paddingRight: 8,\r\n    cursor: 'pointer',\r\n  },\r\n  monthSelect: {\r\n    flex: 1.5,\r\n  },\r\n  daySelect: {\r\n    flex: 0.8,\r\n  },\r\n  yearSelect: {\r\n    flex: 1.2,\r\n  },\r\n  errorSelect: {\r\n    borderColor: theme.colors.danger,\r\n  }\r\n});\r\n\r\nexport { DatetimePicker }; ","import React, { useState, useEffect, useContext, useRef } from 'react';\r\nimport { View, Text, StyleSheet, Modal, TouchableOpacity, Switch, ScrollView, Platform, Dimensions, Animated } from 'react-native';\r\nimport DateTimePicker from '@react-native-community/datetimepicker';\r\nimport { theme } from '../styles/theme';\r\nimport DatePicker from './DatePicker';\r\nimport TimePicker from './TimePicker';\r\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\r\nimport { AuthContext } from '../context/AuthContext';\r\nimport { DatetimePicker } from './ui/datetime-picker';\r\n\r\nconst { width } = Dimensions.get('window');\r\nconst modalWidth = Platform.OS === 'web' ? width * 0.4 : width * 0.9;\r\n\r\nconst ALL_DAYS = \"All Days\";\r\nconst DAYS_OF_WEEK = [\r\n  ALL_DAYS,\r\n  'Monday',\r\n  'Tuesday',\r\n  'Wednesday',\r\n  'Thursday',\r\n  'Friday',\r\n  'Saturday',\r\n  'Sunday'\r\n];\r\n\r\nconst DefaultSettingsModal = ({ isVisible, onClose, onSave, defaultSettings }) => {\r\n  const { screenWidth } = useContext(AuthContext);\r\n  const [selectedDays, setSelectedDays] = useState([]);\r\n  const [settings, setSettings] = useState(defaultSettings || {\r\n    Monday: { isAllDay: false, startTime: '09:00', endTime: '17:00', endDate: null },\r\n    Tuesday: { isAllDay: false, startTime: '09:00', endTime: '17:00', endDate: null },\r\n    Wednesday: { isAllDay: false, startTime: '09:00', endTime: '17:00', endDate: null },\r\n    Thursday: { isAllDay: false, startTime: '09:00', endTime: '17:00', endDate: null },\r\n    Friday: { isAllDay: false, startTime: '09:00', endTime: '17:00', endDate: null },\r\n    Saturday: { isAllDay: false, startTime: '09:00', endTime: '17:00', endDate: null },\r\n    Sunday: { isAllDay: false, startTime: '09:00', endTime: '17:00', endDate: null },\r\n  });\r\n\r\n  const [showTimePicker, setShowTimePicker] = useState({ visible: false, type: '', value: '' });\r\n  const [showDatePicker, setShowDatePicker] = useState(false);\r\n  const [isCurrentlyUnavailable, setIsCurrentlyUnavailable] = useState(false);\r\n  const [showDayDropdown, setShowDayDropdown] = useState(false);\r\n  const [validationError, setValidationError] = useState(\"Please select day(s) first\");\r\n\r\n  const fadeAnim = useRef(new Animated.Value(0)).current;\r\n  const slideAnim = useRef(new Animated.Value(600)).current;\r\n\r\n  const handleClose = () => {\r\n    // Animate out\r\n    Animated.parallel([\r\n      Animated.timing(fadeAnim, {\r\n        toValue: 0,\r\n        duration: 300,\r\n        useNativeDriver: true,\r\n      }),\r\n      Animated.timing(slideAnim, {\r\n        toValue: 600,\r\n        duration: 300,\r\n        useNativeDriver: true,\r\n      })\r\n    ]).start(() => {\r\n      // Call onClose after animations complete\r\n      onClose();\r\n    });\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (isVisible) {\r\n      // Fade in the background overlay\r\n      Animated.timing(fadeAnim, {\r\n        toValue: 1,\r\n        duration: 300,\r\n        useNativeDriver: true,\r\n      }).start();\r\n\r\n      // Slide up the modal content\r\n      Animated.spring(slideAnim, {\r\n        toValue: 0,\r\n        tension: 50,\r\n        friction: 8,\r\n        useNativeDriver: true,\r\n      }).start();\r\n    }\r\n  }, [isVisible]);\r\n\r\n  // Close dropdown when clicking outside\r\n  useEffect(() => {\r\n    const handleClickOutside = (event) => {\r\n      const dropdownButton = document.getElementById('dropdown-button');\r\n      const dropdownContainer = document.getElementById('dropdown-container');\r\n      \r\n      // If click is not on the button and not inside the dropdown, close it\r\n      if (showDayDropdown && \r\n          dropdownContainer && \r\n          !dropdownContainer.contains(event.target) &&\r\n          !dropdownButton.contains(event.target)) {\r\n        setShowDayDropdown(false);\r\n      }\r\n    };\r\n\r\n    if (Platform.OS === 'web') {\r\n      document.addEventListener('mousedown', handleClickOutside);\r\n      return () => {\r\n        document.removeEventListener('mousedown', handleClickOutside);\r\n      };\r\n    }\r\n  }, [showDayDropdown]);\r\n\r\n  const handleSave = () => {\r\n    onSave({\r\n      ...settings,\r\n      [selectedDays[0]]: {\r\n        ...settings[selectedDays[0]],\r\n        isUnavailable: !isCurrentlyUnavailable\r\n      }\r\n    });\r\n  };\r\n\r\n  const updateDaySettings = (day, newSettings) => {\r\n    setSettings(prevSettings => ({\r\n      ...prevSettings,\r\n      [day]: { ...prevSettings[day], ...newSettings }\r\n    }));\r\n  };\r\n\r\n  const handleDaySelection = (day) => {\r\n    setSelectedDays(current => {\r\n      if (day === ALL_DAYS) {\r\n        return current.includes(ALL_DAYS) \r\n          ? [] \r\n          : DAYS_OF_WEEK.filter(d => d !== ALL_DAYS);\r\n      }\r\n      \r\n      const withoutAll = current.filter(d => d !== ALL_DAYS);\r\n      if (withoutAll.includes(day)) {\r\n        return withoutAll.filter(d => d !== day);\r\n      } else {\r\n        if (withoutAll.length + 1 === DAYS_OF_WEEK.length - 1) {\r\n          return DAYS_OF_WEEK.filter(d => d !== ALL_DAYS);\r\n        } else {\r\n          return [...withoutAll, day];\r\n        }\r\n      }\r\n    });\r\n  };\r\n\r\n  const handleAvailabilityChange = (makeAvailable) => {\r\n    console.log(\"Selected days:\", selectedDays);\r\n    if (selectedDays.length === 0) return;\r\n\r\n    const daysToUpdate = selectedDays.includes(ALL_DAYS) \r\n      ? DAYS_OF_WEEK.filter(day => day !== ALL_DAYS)\r\n      : selectedDays;\r\n    \r\n    console.log(\"Days to update:\", daysToUpdate);\r\n    console.log(\"Current settings:\", settings);\r\n    console.log(\"Making available:\", makeAvailable);\r\n\r\n    const newSettings = { ...settings };\r\n    daysToUpdate.forEach(day => {\r\n      console.log(`Updating ${day}`);\r\n      newSettings[day] = {\r\n        ...settings[day],\r\n        isUnavailable: !makeAvailable,\r\n        startTime: settings[selectedDays[0]].startTime,\r\n        endTime: settings[selectedDays[0]].endTime,\r\n        isAllDay: settings[selectedDays[0]].isAllDay,\r\n        endDate: settings[selectedDays[0]].endDate\r\n      };\r\n    });\r\n    \r\n    console.log(\"New settings:\", newSettings);\r\n    setSettings(newSettings);\r\n    onSave(newSettings);\r\n    setIsCurrentlyUnavailable(!makeAvailable);\r\n  };\r\n\r\n  // Update validation error whenever selected days changes\r\n  useEffect(() => {\r\n    if (selectedDays.length === 0) {\r\n      setValidationError(\"Please select day(s) first\");\r\n    } else {\r\n      setValidationError(\"\");\r\n    }\r\n  }, [selectedDays]);\r\n\r\n  const renderTimePicker = (type, value, onChange) => {\r\n      return (\r\n      <TimePicker\r\n        value={new Date(`2000-01-01T${value}`)}\r\n        onChange={(selectedTime) => {\r\n          const timeString = selectedTime.toTimeString().slice(0, 5);\r\n          onChange(timeString);\r\n        }}\r\n        fullWidth={false}\r\n        disabled={selectedDays.length === 0}\r\n        error={validationError}\r\n      />\r\n    );\r\n  };\r\n\r\n  const renderEndDatePicker = () => {\r\n    // Guard against no selected days\r\n    if (!selectedDays || selectedDays.length === 0) {\r\n      return (\r\n        <View style={styles.datePickerWrapper}>\r\n          <View \r\n            style={[styles.datePickerContainer]} \r\n            onClick={(e) => e.stopPropagation()}\r\n            onMouseDown={(e) => e.stopPropagation()}\r\n          >\r\n            <DatetimePicker\r\n              format={[[\"months\", \"days\", \"years\"]]}\r\n              disabled={true}\r\n              isInModal={true}\r\n              error={true}\r\n            />\r\n          </View>\r\n          <Text style={styles.validationErrorText}>{validationError}</Text>\r\n        </View>\r\n      );\r\n    }\r\n\r\n    const daySettings = settings[selectedDays[0]];\r\n    \r\n    return (\r\n      <View style={styles.datePickerWrapper}>\r\n        <View \r\n          style={styles.datePickerContainer}\r\n          onClick={(e) => e.stopPropagation()}\r\n          onMouseDown={(e) => e.stopPropagation()}\r\n        >\r\n          <DatetimePicker\r\n            format={[[\"months\", \"days\", \"years\"]]}\r\n            value={daySettings.endDate ? new Date(daySettings.endDate) : null}\r\n            onChange={(date) => updateDaySettings(selectedDays[0], { endDate: date.toISOString().split('T')[0] })}\r\n            disabled={false}\r\n            isInModal={true}\r\n            error={false}\r\n          />\r\n        </View>\r\n      </View>\r\n    );\r\n  };\r\n\r\n  const renderDaySettings = () => {\r\n    const daySettings = settings[selectedDays[0]] || {\r\n      isAllDay: false,\r\n      startTime: '09:00',\r\n      endTime: '17:00',\r\n      endDate: null\r\n    };\r\n    \r\n    return (\r\n      <View style={styles.daySettingsContainer}>\r\n        <View style={styles.settingRow}>\r\n          <Text style={selectedDays.length === 0 ? styles.disabledText : styles.enabledText}>All Day:</Text>\r\n          <Switch\r\n            value={daySettings.isAllDay}\r\n            onValueChange={(value) => {\r\n              if (selectedDays.length === 0) return;\r\n              const newSettings = { ...settings };\r\n              selectedDays.forEach(day => {\r\n                newSettings[day] = {\r\n                  ...newSettings[day],\r\n                  isAllDay: value\r\n                };\r\n              });\r\n              setSettings(newSettings);\r\n            }}\r\n            disabled={selectedDays.length === 0}\r\n          />\r\n        </View>\r\n        {!daySettings.isAllDay && (\r\n          <>\r\n            <View style={styles.settingRow}>\r\n              <Text style={selectedDays.length === 0 ? styles.disabledText : styles.enabledText}>Start Time:</Text>\r\n              <View style={styles.timePickerContainer}>\r\n                {renderTimePicker(\r\n                  'startTime',\r\n                  daySettings.startTime,\r\n                  (newTime) => {\r\n                    if (selectedDays.length === 0) return;\r\n                    const newSettings = { ...settings };\r\n                    selectedDays.forEach(day => {\r\n                      newSettings[day] = {\r\n                        ...newSettings[day],\r\n                        startTime: newTime\r\n                      };\r\n                    });\r\n                    setSettings(newSettings);\r\n                  }\r\n                )}\r\n              </View>\r\n            </View>\r\n            <View style={styles.settingRow}>\r\n              <Text style={selectedDays.length === 0 ? styles.disabledText : styles.enabledText}>End Time:</Text>\r\n              <View style={styles.timePickerContainer}>\r\n                {renderTimePicker(\r\n                  'endTime',\r\n                  daySettings.endTime,\r\n                  (newTime) => {\r\n                    if (selectedDays.length === 0) return;\r\n                    const newSettings = { ...settings };\r\n                    selectedDays.forEach(day => {\r\n                      newSettings[day] = {\r\n                        ...newSettings[day],\r\n                        endTime: newTime\r\n                      };\r\n                    });\r\n                    setSettings(newSettings);\r\n                  }\r\n                )}\r\n              </View>\r\n            </View>\r\n          </>\r\n        )}\r\n        <View style={styles.settingRow}>\r\n          <Text style={selectedDays.length === 0 ? styles.disabledText : styles.enabledText}>End Date:</Text>\r\n          <View pointerEvents={selectedDays.length === 0 ? 'none' : 'auto'}>\r\n            {renderEndDatePicker()}\r\n          </View>\r\n        </View>\r\n      </View>\r\n    );\r\n  };\r\n\r\n  const checkCurrentAvailability = (days, settings) => {\r\n    if (!days || days.length === 0) return false;\r\n    \r\n    return days.some(day => settings[day]?.isUnavailable);\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (selectedDays.length > 0) {\r\n      const isUnavailable = checkCurrentAvailability(selectedDays, settings);\r\n      setIsCurrentlyUnavailable(isUnavailable);\r\n    } else {\r\n      setIsCurrentlyUnavailable(false);\r\n    }\r\n  }, [selectedDays, settings]);\r\n\r\n  const renderDaySelector = () => (\r\n    <View style={styles.inputWrapper}>\r\n      <Text style={styles.inputLabel}>Day(s) *</Text>\r\n      <TouchableOpacity\r\n        id=\"dropdown-button\"\r\n        style={[\r\n          styles.input,\r\n          styles.customDropdown,\r\n          selectedDays.length === 0 && styles.inputError\r\n        ]}\r\n        onPress={() => setShowDayDropdown(!showDayDropdown)}\r\n      >\r\n        <Text style={{\r\n          color: selectedDays.length > 0 ? theme.colors.text : theme.colors.placeHolderText\r\n        }}>\r\n          {selectedDays.length === 0 \r\n            ? 'Select Days' \r\n            : selectedDays.includes(ALL_DAYS)\r\n              ? 'All Days'\r\n              : selectedDays.length > 2\r\n                ? `${selectedDays.length} Days Selected`\r\n                : selectedDays.join(', ')}\r\n        </Text>\r\n        <MaterialCommunityIcons \r\n          name={showDayDropdown ? \"chevron-up\" : \"chevron-down\"} \r\n          size={24} \r\n          color={theme.colors.text} \r\n        />\r\n      </TouchableOpacity>\r\n      \r\n      {showDayDropdown && (\r\n        <View \r\n          id=\"dropdown-container\"\r\n          style={styles.dropdownContainer}\r\n        >\r\n          <ScrollView style={styles.dropdownScroll}>\r\n            {DAYS_OF_WEEK.map((day) => (\r\n              <TouchableOpacity\r\n                key={day}\r\n                style={styles.dropdownItem}\r\n                onPress={() => handleDaySelection(day)}\r\n              >\r\n                <View style={styles.dropdownItemContent}>\r\n                  <Text style={[\r\n                    styles.dropdownText,\r\n                    selectedDays.includes(day) && styles.selectedOption\r\n                  ]}>\r\n                    {day}\r\n                  </Text>\r\n                  {selectedDays.includes(day) && (\r\n                    <MaterialCommunityIcons \r\n                      name=\"check\" \r\n                      size={20} \r\n                      color={theme.colors.primary} \r\n                    />\r\n                  )}\r\n                </View>\r\n              </TouchableOpacity>\r\n            ))}\r\n          </ScrollView>\r\n        </View>\r\n      )}\r\n    </View>\r\n  );\r\n\r\n  return (\r\n    <Modal\r\n      visible={isVisible}\r\n      transparent={true}\r\n      onRequestClose={handleClose}\r\n    >\r\n      <Animated.View style={[\r\n        styles.modalContainer,\r\n        {\r\n          opacity: fadeAnim,\r\n        }\r\n      ]}>\r\n        <Animated.View style={[\r\n          styles.modalContent,\r\n          {\r\n            width: screenWidth < 600 ? '90%' : 600,\r\n            transform: [{ translateY: slideAnim }]\r\n          }\r\n        ]}>\r\n          <View style={styles.modalHeader}>\r\n            <Text style={styles.modalTitle}>Default Settings</Text>\r\n            <TouchableOpacity onPress={handleClose} style={styles.closeButton}>\r\n              <MaterialCommunityIcons name=\"close\" size={24} color={theme.colors.text} />\r\n            </TouchableOpacity>\r\n          </View>\r\n          {renderDaySelector()}\r\n          {renderDaySettings()}\r\n          <View style={styles.buttonContainer}>\r\n            <TouchableOpacity\r\n              style={[styles.button, styles.availableButton]}\r\n              onPress={() => handleAvailabilityChange(true)}\r\n              disabled={selectedDays.length === 0}\r\n            >\r\n              <Text style={styles.buttonText}>Mark Available</Text>\r\n            </TouchableOpacity>\r\n            <TouchableOpacity\r\n              style={[styles.button, styles.unavailableButton]}\r\n              onPress={() => handleAvailabilityChange(false)}\r\n              disabled={selectedDays.length === 0}\r\n            >\r\n              <Text style={styles.buttonText}>Mark Unavailable</Text>\r\n            </TouchableOpacity>\r\n          </View>\r\n        </Animated.View>\r\n      </Animated.View>\r\n    </Modal>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  modalContainer: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    backgroundColor: 'rgba(0, 0, 0, 0.5)',\r\n  },\r\n  modalContent: {\r\n    backgroundColor: theme.colors.background,\r\n    padding: 22,\r\n    borderRadius: 17,\r\n    maxHeight: '80%',\r\n  },\r\n  modalHeader: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    marginBottom: 20,\r\n  },\r\n  closeButton: {\r\n    padding: 8,\r\n  },\r\n  modalTitle: {\r\n    fontSize: theme.fontSizes.large,\r\n    fontWeight: 'bold',\r\n    marginBottom: 15,\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n  },\r\n  settingContainer: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    width: '100%',\r\n    marginVertical: 10,\r\n  },\r\n  sectionTitle: {\r\n    fontSize: theme.fontSizes.medium,\r\n    fontWeight: 'bold',\r\n    marginTop: 20,\r\n    marginBottom: 10,\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n  },\r\n  dayContainer: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    width: '100%',\r\n    marginVertical: 5,\r\n  },\r\n  buttonContainer: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    gap: 12,\r\n    marginTop: 20,\r\n  },\r\n  button: {\r\n    flex: 1,\r\n    padding: 12,\r\n    borderRadius: 8,\r\n    alignItems: 'center',\r\n  },\r\n  availableButton: {\r\n    backgroundColor: theme.colors.primary,\r\n  },\r\n  unavailableButton: {\r\n    backgroundColor: theme.colors.error,\r\n  },\r\n  buttonText: {\r\n    color: theme.colors.whiteText,\r\n    fontWeight: 'bold',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  tabContainer: {\r\n    flexDirection: 'row',\r\n    marginBottom: 15,\r\n  },\r\n  tab: {\r\n    paddingHorizontal: 15,\r\n    paddingVertical: 10,\r\n    borderBottomWidth: 2,\r\n    borderBottomColor: 'transparent',\r\n  },\r\n  selectedTab: {\r\n    borderBottomColor: theme.colors.primary,\r\n  },\r\n  tabText: {\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  selectedTabText: {\r\n    color: theme.colors.primary,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  daySettingsContainer: {\r\n    marginBottom: 15,\r\n  },\r\n  settingRow: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    marginBottom: 15,\r\n    gap: 12,\r\n  },\r\n  webTimePicker: {\r\n    padding: 5,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    borderRadius: 5,\r\n  },\r\n  webDatePicker: {\r\n    padding: 5,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    borderRadius: 5,\r\n  },\r\n  inputWrapper: {\r\n    position: 'relative',\r\n    width: '100%',\r\n    marginBottom: 15,\r\n    zIndex: 2,\r\n  },\r\n  inputLabel: {\r\n    marginBottom: 5,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  input: {\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    borderRadius: 5,\r\n    padding: 10,\r\n    backgroundColor: theme.colors.surface,\r\n  },\r\n  customDropdown: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n  },\r\n  dropdownContainer: {\r\n    position: 'absolute',\r\n    top: '100%',\r\n    left: 0,\r\n    right: 0,\r\n    backgroundColor: theme.colors.surface,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    borderRadius: 5,\r\n    maxHeight: 200,\r\n    zIndex: 1000,\r\n  },\r\n  dropdownScroll: {\r\n    maxHeight: 200,\r\n  },\r\n  dropdownItem: {\r\n    padding: 10,\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: theme.colors.border,\r\n  },\r\n  dropdownItemContent: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n  },\r\n  dropdownText: {\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  selectedOption: {\r\n    color: theme.colors.primary,\r\n    fontWeight: 'bold',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  inputError: {\r\n    borderColor: theme.colors.danger,\r\n  },\r\n  disabledButton: {\r\n    opacity: 0.5,\r\n  },\r\n  disabledText: {\r\n    color: theme.colors.placeHolderText,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  enabledText: {\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  timePickerContainer: {\r\n    flex: 1,\r\n    maxWidth: 150,\r\n  },\r\n  datePickerContainer: {\r\n    flex: 1,\r\n    maxWidth: 200,\r\n  },\r\n  datePickerWrapper: {\r\n    width: '100%',\r\n  },\r\n  validationErrorText: {\r\n    color: theme.colors.danger,\r\n    fontSize: theme.fontSizes.small,\r\n    marginTop: 4,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n});\r\n\r\nexport default DefaultSettingsModal;\r\n","import React, { useState, useRef, useEffect, useContext } from 'react';\r\nimport { View, Text, StyleSheet, TouchableOpacity, ScrollView, Platform, Switch, Animated } from 'react-native';\r\nimport { theme } from '../styles/theme';\r\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\r\nimport { format, parse } from 'date-fns';\r\nimport TimePicker from './TimePicker';\r\nimport { SERVICE_TYPES, ALL_SERVICES } from '../data/mockData';\r\nimport { AuthContext } from '../context/AuthContext';\r\n\r\nconst AvailabilityBottomSheet = ({ \r\n  selectedDates, \r\n  currentAvailability,\r\n  onClose,\r\n  onViewUnavailableTimes,\r\n  onSave,\r\n  onMinimize\r\n}) => {\r\n  const { screenWidth } = useContext(AuthContext);\r\n  const [startTime, setStartTime] = useState(new Date());\r\n  const [endTime, setEndTime] = useState(new Date());\r\n  const [selectedServices, setSelectedServices] = useState([]);\r\n  const [showServiceDropdown, setShowServiceDropdown] = useState(false);\r\n  const [isAllDay, setIsAllDay] = useState(false);\r\n  const [error, setError] = useState(null);\r\n  const [isMinimized, setIsMinimized] = useState(false);\r\n  const animatedHeight = useRef(new Animated.Value(1)).current;\r\n  const animatedOpacity = useRef(new Animated.Value(1)).current;\r\n  const slideAnimation = useRef(new Animated.Value(0)).current;\r\n\r\n  useEffect(() => {\r\n    // Start the entrance animation when the component mounts\r\n    Animated.spring(slideAnimation, {\r\n      toValue: 1,\r\n      useNativeDriver: true,\r\n      tension: 50,\r\n      friction: 8\r\n    }).start();\r\n  }, []);\r\n\r\n  const getAvailabilityStatus = () => {\r\n    if (!selectedDates || selectedDates.length === 0) return 'Unknown';\r\n\r\n    const date = selectedDates[0];\r\n    const dateAvailability = currentAvailability[date];\r\n\r\n    if (!dateAvailability) return 'Available';\r\n    if (!dateAvailability.isAvailable) return 'Unavailable';\r\n    if (dateAvailability.unavailableTimes?.length > 0) return 'Partially Available';\r\n    return 'Available';\r\n  };\r\n\r\n  const getStatusColor = () => {\r\n    const status = getAvailabilityStatus();\r\n    switch (status) {\r\n      case 'Available':\r\n        return theme.colors.success;\r\n      case 'Partially Available':\r\n        return theme.colors.warning;\r\n      case 'Unavailable':\r\n        return theme.colors.error;\r\n      default:\r\n        return theme.colors.text;\r\n    }\r\n  };\r\n\r\n  const formatDateRange = () => {\r\n    if (!selectedDates || selectedDates.length === 0) return '';\r\n    \r\n    if (selectedDates.length === 1) {\r\n      return format(parse(selectedDates[0], 'yyyy-MM-dd', new Date()), 'MMM dd, yyyy');\r\n    }\r\n\r\n    return `${format(parse(selectedDates[0], 'yyyy-MM-dd', new Date()), 'MMM dd')} - ${format(parse(selectedDates[selectedDates.length - 1], 'yyyy-MM-dd', new Date()), 'MMM dd, yyyy')}`;\r\n  };\r\n\r\n  const validateAndSave = (isAvailable) => {\r\n    if (selectedServices.length === 0) {\r\n      setError('Please select at least one service type');\r\n      return;\r\n    }\r\n    setError(null);\r\n    onSave({ \r\n      startTime: isAllDay ? '00:00' : format(startTime, 'HH:mm'),\r\n      endTime: isAllDay ? '24:00' : format(endTime, 'HH:mm'),\r\n      services: selectedServices,\r\n      isAvailable,\r\n      isAllDay\r\n    });\r\n  };\r\n\r\n  const toggleMinimized = () => {\r\n    const toValue = isMinimized ? 1 : 0;\r\n    \r\n    // Call onMinimize first to start the background fade\r\n    const newMinimizedState = !isMinimized;\r\n    onMinimize?.(newMinimizedState);\r\n    \r\n    // Then start our animations\r\n    Animated.parallel([\r\n      Animated.timing(animatedHeight, {\r\n        toValue,\r\n        duration: 300,\r\n        useNativeDriver: false\r\n      }),\r\n      Animated.timing(animatedOpacity, {\r\n        toValue,\r\n        duration: 300,\r\n        useNativeDriver: false\r\n      })\r\n    ]).start(() => {\r\n      setIsMinimized(newMinimizedState);\r\n    });\r\n  };\r\n\r\n  const handleClose = () => {\r\n    // Animate the slide down\r\n    Animated.timing(slideAnimation, {\r\n      toValue: 0,\r\n      duration: 300,\r\n      useNativeDriver: true\r\n    }).start(() => {\r\n      // Call the onClose prop after animation completes\r\n      onClose();\r\n    });\r\n  };\r\n\r\n  const maxHeight = isAllDay ? 364 : 445; // Adjust this value based on your content\r\n  const minHeight = 96;\r\n\r\n  const containerHeight = animatedHeight.interpolate({\r\n    inputRange: [0, 1],\r\n    outputRange: [minHeight, maxHeight]\r\n  });\r\n\r\n  const renderHandle = () => {\r\n    if (Platform.OS === 'web') {\r\n      return (\r\n        <TouchableOpacity \r\n          onPress={toggleMinimized}\r\n          style={styles.handleContainer}\r\n        >\r\n          <MaterialCommunityIcons \r\n            name={isMinimized ? \"chevron-up\" : \"chevron-down\"}\r\n            size={24}\r\n            color={theme.colors.text}\r\n          />\r\n        </TouchableOpacity>\r\n      );\r\n    }\r\n\r\n    return (\r\n      <TouchableOpacity \r\n        onPress={toggleMinimized}\r\n        style={styles.handleContainer}\r\n      >\r\n        <View style={styles.handle} />\r\n      </TouchableOpacity>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <View style={[\r\n      styles.overlay,\r\n      { pointerEvents: isMinimized ? 'box-none' : 'auto' } // Allow clicks through when minimized\r\n    ]}>\r\n      <Animated.View \r\n        style={[\r\n          styles.container,\r\n          { \r\n            height: containerHeight,\r\n            transform: [{\r\n              translateY: slideAnimation.interpolate({\r\n                inputRange: [0, 1],\r\n                outputRange: [600, 0]\r\n              })\r\n            }]\r\n          }\r\n        ]}\r\n      >\r\n        {renderHandle()}\r\n        \r\n        <View style={[styles.header, isMinimized && styles.headerMinimized]}>\r\n          {!isMinimized && (\r\n            <TouchableOpacity onPress={handleClose} style={styles.closeButton}>\r\n              <MaterialCommunityIcons name=\"close\" size={24} color={theme.colors.text} />\r\n            </TouchableOpacity>\r\n          )}\r\n          <View style={styles.headerCenter}>\r\n            <Text style={styles.dateText}>{formatDateRange()}</Text>\r\n            <Text style={[styles.statusText, { color: getStatusColor() }]}>\r\n              {getAvailabilityStatus()}\r\n            </Text>\r\n          </View>\r\n          {!isMinimized && (\r\n            <Animated.View style={{ opacity: animatedOpacity }}>\r\n              <TouchableOpacity \r\n                style={styles.actionButton}\r\n                onPress={onViewUnavailableTimes}\r\n              >\r\n                <MaterialCommunityIcons \r\n                  name=\"clock-outline\" \r\n                  size={24} \r\n                  color={theme.colors.primary} \r\n                />\r\n                <Text style={styles.actionButtonText}>\r\n                  {'Unavailable\\nTimes'}\r\n                </Text>\r\n              </TouchableOpacity>\r\n            </Animated.View>\r\n          )}\r\n        </View>\r\n\r\n        <Animated.View \r\n          style={[\r\n            styles.content,\r\n            { opacity: animatedOpacity,\r\n             }\r\n          ]}\r\n        >\r\n          <View style={styles.serviceSection}>\r\n            <Text style={[styles.label, { textAlign: 'center' }]}>Change Availability for Services</Text>\r\n            <TouchableOpacity\r\n              style={[styles.serviceSelector, error && selectedServices.length <= 0 && styles.serviceSelectorError]}\r\n              onPress={() => setShowServiceDropdown(!showServiceDropdown)}\r\n            >\r\n              <Text style={styles.serviceSelectorText}>\r\n                {selectedServices.length > 0 \r\n                  ? selectedServices.includes(ALL_SERVICES)\r\n                    ? \"All Services\"\r\n                    : selectedServices.length > 1\r\n                      ? `${selectedServices.length} services selected`\r\n                      : selectedServices[0]\r\n                  : \"Select one or more service types\"\r\n                }\r\n              </Text>\r\n              <MaterialCommunityIcons \r\n                name={showServiceDropdown ? \"chevron-up\" : \"chevron-down\"} \r\n                size={24} \r\n                color={theme.colors.primary} \r\n              />\r\n            </TouchableOpacity>\r\n            {error && selectedServices.length <= 0 && !showServiceDropdown && <Text style={styles.errorText}>{error}</Text>}\r\n\r\n            {showServiceDropdown && (\r\n              <View style={styles.dropdownContainer}>\r\n                <ScrollView style={styles.dropdownScroll}>\r\n                  {SERVICE_TYPES.map((service) => (\r\n                    <TouchableOpacity\r\n                      key={service}\r\n                      style={styles.dropdownItem}\r\n                      onPress={() => {\r\n                        if (service === ALL_SERVICES) {\r\n                          setSelectedServices(\r\n                            selectedServices.includes(ALL_SERVICES) \r\n                              ? [] \r\n                              : [ALL_SERVICES]\r\n                          );\r\n                        } else {\r\n                          setSelectedServices(prev => {\r\n                            const withoutAll = prev.filter(s => s !== ALL_SERVICES);\r\n                            if (prev.includes(service)) {\r\n                              return withoutAll.filter(s => s !== service);\r\n                            } else {\r\n                              return [...withoutAll, service];\r\n                            }\r\n                          });\r\n                        }\r\n                      }}\r\n                    >\r\n                      <View style={styles.dropdownItemContent}>\r\n                        <Text style={[\r\n                          styles.dropdownText,\r\n                          selectedServices.includes(service) && styles.selectedOption\r\n                        ]}>\r\n                          {service}\r\n                        </Text>\r\n                        {selectedServices.includes(service) && (\r\n                          <MaterialCommunityIcons \r\n                            name=\"check\" \r\n                            size={20} \r\n                            color={theme.colors.primary} \r\n                          />\r\n                        )}\r\n                      </View>\r\n                    </TouchableOpacity>\r\n                  ))}\r\n                </ScrollView>\r\n              </View>\r\n            )}\r\n          </View>\r\n\r\n          <View style={styles.timeToggleContainer}>\r\n            <Text style={[styles.label, { marginBottom: 0 }]}>Time Selection</Text>\r\n            <View style={styles.customToggle}>\r\n              <TouchableOpacity \r\n                style={[\r\n                  styles.toggleButton,\r\n                  isAllDay ? styles.toggleButtonActive : styles.toggleButtonInactive\r\n                ]}\r\n                onPress={() => setIsAllDay(true)}\r\n              >\r\n                <Text style={[\r\n                  styles.toggleButtonText,\r\n                  isAllDay && styles.toggleButtonTextActive\r\n                ]}>All Day</Text>\r\n              </TouchableOpacity>\r\n              <TouchableOpacity \r\n                style={[\r\n                  styles.toggleButton,\r\n                  !isAllDay ? styles.toggleButtonActive : styles.toggleButtonInactive\r\n                ]}\r\n                onPress={() => setIsAllDay(false)}\r\n              >\r\n                <Text style={[\r\n                  styles.toggleButtonText,\r\n                  !isAllDay && styles.toggleButtonTextActive\r\n                ]}>Custom Hours</Text>\r\n              </TouchableOpacity>\r\n            </View>\r\n          </View>\r\n\r\n          {!isAllDay && (\r\n            <View style={styles.timeSection}>\r\n              <View style={styles.timeContainer}>\r\n                <Text style={[styles.label, { marginBottom: 0 }]}>Start Time</Text>\r\n                <TimePicker\r\n                  value={startTime}\r\n                  onChange={setStartTime}\r\n                  fullWidth\r\n                />\r\n              </View>\r\n              <View style={styles.timeContainer}>\r\n                <Text style={[styles.label, { marginBottom: 0 }]}>End Time</Text>\r\n                <TimePicker\r\n                  value={endTime}\r\n                  onChange={setEndTime}\r\n                  fullWidth\r\n                />\r\n              </View>\r\n            </View>\r\n          )}\r\n\r\n          <View style={styles.buttonContainer}>\r\n            <TouchableOpacity\r\n              style={[styles.button, styles.availableButton]}\r\n              onPress={() => validateAndSave(true)}\r\n            >\r\n              <Text style={styles.buttonText}>Mark Available</Text>\r\n            </TouchableOpacity>\r\n            <TouchableOpacity\r\n              style={[styles.button, styles.unavailableButton]}\r\n              onPress={() => validateAndSave(false)}\r\n            >\r\n              <Text style={styles.buttonText}>Mark Unavailable</Text>\r\n            </TouchableOpacity>\r\n          </View>\r\n        </Animated.View>\r\n      </Animated.View>\r\n    </View>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  overlay: {\r\n    width: '100%',\r\n    pointerEvents: 'box-none', // This allows clicks to pass through to elements behind\r\n  },\r\n  container: {\r\n    backgroundColor: theme.colors.surface,\r\n    borderTopLeftRadius: 20,\r\n    borderTopRightRadius: 20,\r\n    padding: 16,\r\n    paddingBottom: Platform.OS === 'ios' ? 40 : 16,\r\n    maxWidth: 600,\r\n    width: '100%',\r\n    alignSelf: 'center',\r\n    shadowColor: '#000',\r\n    shadowOffset: {\r\n      width: 0,\r\n      height: -2,\r\n    },\r\n    shadowOpacity: 0.25,\r\n    shadowRadius: 3.84,\r\n    elevation: 5,\r\n  },\r\n  handleContainer: {\r\n    width: '100%',\r\n    height: 24,\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    marginBottom: 4,\r\n  },\r\n  handle: {\r\n    width: 40,\r\n    height: 4,\r\n    backgroundColor: theme.colors.border,\r\n    borderRadius: 2,\r\n  },\r\n  header: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    marginBottom: 12,\r\n    paddingRight: 8,\r\n    marginTop: 4, // Add a small margin to separate from the chevron\r\n  },\r\n  headerMinimized: {\r\n    marginBottom: 8,\r\n    paddingBottom: 12, // Add padding at the bottom when minimized\r\n    justifyContent: 'space-between',\r\n  },\r\n  headerCenter: {\r\n    flex: 1,\r\n    alignItems: 'center',\r\n  },\r\n  closeButton: {\r\n    width: 60,\r\n    height: 40,\r\n    // marginBottom: 30,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n  },\r\n  dateText: {\r\n    fontSize: theme.fontSizes.medium,\r\n    fontWeight: 'bold',\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n  },\r\n  statusText: {\r\n    fontSize: theme.fontSizes.medium,\r\n    marginTop: 4,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  actionButton: {\r\n    width: 60,\r\n    alignItems: 'center',\r\n  },\r\n  actionButtonText: {\r\n    fontSize: theme.fontSizes.small,\r\n    color: theme.colors.primary,\r\n    marginTop: 4,\r\n    textAlign: 'center',\r\n    lineHeight: 16,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  content: {\r\n    gap: 12,\r\n  },\r\n  timeToggleContainer: {\r\n    // marginBottom: 8,\r\n  },\r\n  customToggle: {\r\n    flexDirection: 'row',\r\n    backgroundColor: theme.colors.background,\r\n    borderRadius: 8,\r\n    padding: 4,\r\n    // marginTop: 8,\r\n    gap: 8,\r\n  },\r\n  toggleButton: {\r\n    flex: 1,\r\n    paddingVertical: 12,\r\n    paddingHorizontal: 16,\r\n    borderRadius: 6,\r\n    alignItems: 'center',\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n  },\r\n  toggleButtonActive: {\r\n    backgroundColor: theme.colors.primary,\r\n    borderColor: theme.colors.primary,\r\n  },\r\n  toggleButtonInactive: {\r\n    backgroundColor: 'transparent',\r\n  },\r\n  toggleButtonText: {\r\n    color: theme.colors.text,\r\n    fontSize: theme.fontSizes.medium,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  toggleButtonTextActive: {\r\n    color: theme.colors.whiteText,\r\n    fontWeight: 'bold',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  timeSection: {\r\n    flexDirection: 'row',\r\n    gap: 16,\r\n  },\r\n  timeContainer: {\r\n    flex: 1,\r\n  },\r\n  label: {\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.text,\r\n    marginBottom: 4,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  serviceSection: {\r\n    position: 'relative',\r\n    zIndex: 1,\r\n  },\r\n  serviceSelector: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    borderRadius: 8,\r\n    padding: 12,\r\n    backgroundColor: theme.colors.background,\r\n  },\r\n  serviceSelectorText: {\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  dropdownContainer: {\r\n    position: 'absolute',\r\n    top: '100%',\r\n    left: 0,\r\n    right: 0,\r\n    backgroundColor: theme.colors.surface,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    borderRadius: 8,\r\n    maxHeight: 200,\r\n    zIndex: 1000,\r\n  },\r\n  dropdownScroll: {\r\n    maxHeight: 200,\r\n  },\r\n  dropdownItem: {\r\n    padding: 12,\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: theme.colors.border,\r\n  },\r\n  dropdownItemContent: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n  },\r\n  dropdownText: {\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  selectedOption: {\r\n    color: theme.colors.primary,\r\n    fontWeight: 'bold',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  buttonContainer: {\r\n    flexDirection: 'row',\r\n    gap: 12,\r\n    // marginTop: 12,\r\n  },\r\n  button: {\r\n    flex: 1,\r\n    padding: 12,\r\n    borderRadius: 8,\r\n    alignItems: 'center',\r\n  },\r\n  availableButton: {\r\n    backgroundColor: theme.colors.primary,\r\n  },\r\n  unavailableButton: {\r\n    backgroundColor: theme.colors.error,\r\n  },\r\n  buttonText: {\r\n    color: theme.colors.whiteText,\r\n    fontSize: theme.fontSizes.medium,\r\n    fontWeight: 'bold',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  serviceSelectorError: {\r\n    borderColor: theme.colors.error,\r\n    borderWidth: 1,\r\n  },\r\n  errorText: {\r\n    color: theme.colors.error,\r\n    fontSize: theme.fontSizes.small,\r\n    marginTop: 4,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n});\r\n\r\nexport default AvailabilityBottomSheet; ","import React, { useRef, useEffect } from 'react';\r\nimport { View, Text, StyleSheet, Modal, TouchableOpacity, ScrollView, Animated } from 'react-native';\r\nimport { theme } from '../styles/theme';\r\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\r\nimport { format, parse } from 'date-fns';\r\nimport { useNavigation } from '@react-navigation/native';\r\nimport { navigateToFrom } from '../components/Navigation';\r\n\r\nconst UnavailableTimesModal = ({ \r\n  visible, \r\n  onClose, \r\n  selectedDates,\r\n  currentAvailability,\r\n  onRemoveTimeSlot,\r\n  bookings\r\n}) => {\r\n  const navigation = useNavigation();\r\n  const fadeAnim = useRef(new Animated.Value(0)).current;\r\n  const slideAnim = useRef(new Animated.Value(600)).current;\r\n\r\n  useEffect(() => {\r\n    if (visible) {\r\n      // Fade in the background overlay\r\n      Animated.timing(fadeAnim, {\r\n        toValue: 1,\r\n        duration: 300,\r\n        useNativeDriver: true,\r\n      }).start();\r\n\r\n      // Slide up the modal content\r\n      Animated.spring(slideAnim, {\r\n        toValue: 0,\r\n        tension: 50,\r\n        friction: 8,\r\n        useNativeDriver: true,\r\n      }).start();\r\n    }\r\n  }, [visible]);\r\n\r\n  const handleClose = () => {\r\n    // Animate out\r\n    Animated.parallel([\r\n      Animated.timing(fadeAnim, {\r\n        toValue: 0,\r\n        duration: 300,\r\n        useNativeDriver: true,\r\n      }),\r\n      Animated.timing(slideAnim, {\r\n        toValue: 600,\r\n        duration: 300,\r\n        useNativeDriver: true,\r\n      })\r\n    ]).start(() => {\r\n      // Call onClose after animations complete\r\n      onClose();\r\n    });\r\n  };\r\n\r\n  const formatTime = (time) => {\r\n    const [hours, minutes] = time.split(':');\r\n    const date = new Date();\r\n    date.setHours(parseInt(hours), parseInt(minutes));\r\n    return format(date, 'h:mm a');\r\n  };\r\n\r\n  const handleBookingPress = async (bookingId) => {\r\n    onClose(); // Close the modal first\r\n    await navigateToFrom(navigation, 'BookingDetails', 'AvailabilitySettings', { bookingId });\r\n  };\r\n\r\n  const getUnavailableTimes = () => {\r\n    if (!selectedDates || selectedDates.length === 0) return [];\r\n\r\n    const allTimes = [];\r\n    const processedTimes = new Set(); // Track processed time slots\r\n\r\n    selectedDates.forEach(date => {\r\n      const dateBookings = bookings[date] || [];\r\n      const dateAvailability = currentAvailability[date];\r\n\r\n      // Add bookings first\r\n      dateBookings.forEach(booking => {\r\n        const timeKey = `${date}-${booking.startTime}-${booking.endTime}`;\r\n        if (!processedTimes.has(timeKey)) {\r\n          allTimes.push({\r\n            date,\r\n            startTime: booking.startTime,\r\n            endTime: booking.endTime,\r\n            reason: `${booking.service_type}\\nBooked with ${booking.owner_name}`,\r\n            isBooking: true,\r\n            ownerId: booking.ownerId\r\n          });\r\n          processedTimes.add(timeKey);\r\n        }\r\n      });\r\n\r\n      // Add personal unavailable times, excluding any that overlap with bookings\r\n      if (dateAvailability?.unavailableTimes) {\r\n        dateAvailability.unavailableTimes\r\n          .filter(time => !time.ownerId) // Only include non-booking unavailable times\r\n          .forEach(time => {\r\n            const timeKey = `${date}-${time.startTime}-${time.endTime}`;\r\n            if (!processedTimes.has(timeKey)) {\r\n              allTimes.push({\r\n                date,\r\n                startTime: time.startTime,\r\n                endTime: time.endTime,\r\n                reason: time.reason,\r\n                isBooking: false\r\n              });\r\n              processedTimes.add(timeKey);\r\n            }\r\n          });\r\n      }\r\n    });\r\n\r\n    // Sort by date and then by start time\r\n    return allTimes.sort((a, b) => {\r\n      if (a.date !== b.date) return a.date.localeCompare(b.date);\r\n      return a.startTime.localeCompare(b.startTime);\r\n    });\r\n  };\r\n\r\n  const renderActionButton = (item) => {\r\n    if (item.isBooking) {\r\n      return (\r\n        <TouchableOpacity\r\n          style={styles.bookingButton}\r\n          onPress={() => handleBookingPress(item.ownerId)}\r\n        >\r\n          <MaterialCommunityIcons name=\"arrow-right\" size={24} color={theme.colors.primary} />\r\n        </TouchableOpacity>\r\n      );\r\n    }\r\n    \r\n    return (\r\n      <TouchableOpacity\r\n        style={styles.removeButton}\r\n        onPress={() => onRemoveTimeSlot(item.date, item)}\r\n      >\r\n        <MaterialCommunityIcons name=\"close\" size={24} color={theme.colors.error} />\r\n      </TouchableOpacity>\r\n    );\r\n  };\r\n\r\n  const renderTimeSlot = (item, index) => {\r\n    const formattedDate = format(parse(item.date, 'yyyy-MM-dd', new Date()), 'MMM d, yyyy');\r\n    const formattedStartTime = formatTime(item.startTime);\r\n    const formattedEndTime = formatTime(item.endTime);\r\n\r\n    return (\r\n      <View key={index} style={styles.timeSlotContainer}>\r\n        <View style={styles.dateHeader}>\r\n          <Text style={styles.dateText}>{formattedDate}</Text>\r\n        </View>\r\n        <View style={[\r\n          styles.timeSlotContent,\r\n          item.isBooking && styles.bookingContent\r\n        ]}>\r\n          <View style={styles.timeAndReason}>\r\n            <Text style={styles.timeText}>\r\n              {formattedStartTime} - {formattedEndTime}\r\n            </Text>\r\n            <Text style={styles.reasonText}>\r\n              {item.reason}\r\n            </Text>\r\n          </View>\r\n          {renderActionButton(item)}\r\n        </View>\r\n      </View>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <Modal\r\n      visible={visible}\r\n      transparent={true}\r\n      onRequestClose={handleClose}\r\n    >\r\n      <Animated.View style={[\r\n        styles.modalContainer,\r\n        {\r\n          opacity: fadeAnim,\r\n        }\r\n      ]}>\r\n        <Animated.View style={[\r\n          styles.modalContent,\r\n          {\r\n            transform: [{ translateY: slideAnim }]\r\n          }\r\n        ]}>\r\n          <View style={styles.modalHeader}>\r\n            <Text style={styles.modalTitle}>Unavailable Times</Text>\r\n            <TouchableOpacity onPress={handleClose} style={styles.closeButton}>\r\n              <MaterialCommunityIcons name=\"close\" size={24} color={theme.colors.text} />\r\n            </TouchableOpacity>\r\n          </View>\r\n          \r\n          <ScrollView style={styles.timesList}>\r\n            {getUnavailableTimes().map((item, index) => renderTimeSlot(item, index))}\r\n            {getUnavailableTimes().length === 0 && (\r\n              <Text style={styles.emptyText}>No unavailable times for selected date(s)</Text>\r\n            )}\r\n          </ScrollView>\r\n        </Animated.View>\r\n      </Animated.View>\r\n    </Modal>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  modalContainer: {\r\n    flex: 1,\r\n    backgroundColor: 'rgba(0, 0, 0, 0.5)',\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n  },\r\n  modalContent: {\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 20,\r\n    padding: 20,\r\n    width: '90%',\r\n    maxWidth: 500,\r\n    maxHeight: '80%',\r\n  },\r\n  modalHeader: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    marginBottom: 20,\r\n  },\r\n  modalTitle: {\r\n    fontSize: theme.fontSizes.large,\r\n    fontWeight: 'bold',\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n  },\r\n  closeButton: {\r\n    padding: 5,\r\n  },\r\n  timesList: {\r\n    maxHeight: '90%',\r\n  },\r\n  timeSlotContainer: {\r\n    marginBottom: 15,\r\n  },\r\n  dateHeader: {\r\n    marginBottom: 8,\r\n  },\r\n  dateText: {\r\n    fontSize: theme.fontSizes.medium,\r\n    fontWeight: 'bold',\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n  },\r\n  timeSlotContent: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'flex-start',\r\n    backgroundColor: theme.colors.background,\r\n    padding: 12,\r\n    borderRadius: 8,\r\n  },\r\n  bookingContent: {\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    backgroundColor: theme.colors.surface,\r\n    shadowColor: '#000',\r\n    shadowOffset: {\r\n      width: 0,\r\n      height: 1,\r\n    },\r\n    shadowOpacity: 0.1,\r\n    shadowRadius: 2,\r\n    elevation: 2,\r\n  },\r\n  timeAndReason: {\r\n    flex: 1,\r\n  },\r\n  timeText: {\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.text,\r\n    marginBottom: 4,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  reasonText: {\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.textSecondary,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  removeButton: {\r\n    padding: 5,\r\n    marginLeft: 10,\r\n  },\r\n  bookingButton: {\r\n    padding: 5,\r\n    marginLeft: 10,\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 20,\r\n    width: 34,\r\n    height: 34,\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    shadowColor: '#000',\r\n    shadowOffset: {\r\n      width: 0,\r\n      height: 1,\r\n    },\r\n    shadowOpacity: 0.1,\r\n    shadowRadius: 1,\r\n    elevation: 2,\r\n  },\r\n  emptyText: {\r\n    textAlign: 'center',\r\n    color: theme.colors.textSecondary,\r\n    fontSize: theme.fontSizes.medium,\r\n    marginTop: 20,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n});\r\n\r\nexport default UnavailableTimesModal; ","import React, { useState, useEffect, useRef, useContext } from 'react';\r\nimport { View, Text, StyleSheet, TouchableOpacity, Modal, ScrollView, Platform, StatusBar, Dimensions, ActivityIndicator, Animated } from 'react-native';\r\nimport { SafeAreaView } from 'react-native-safe-area-context';\r\nimport { Calendar } from 'react-native-calendars';\r\nimport moment from 'moment';\r\nimport Icon from 'react-native-vector-icons/Ionicons';\r\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\r\nimport { theme } from '../styles/theme';\r\nimport AddAvailabilityModal from '../components/AddAvailabilityModal';\r\nimport DefaultSettingsModal from '../components/DefaultSettingsModal';\r\nimport { format, parse } from 'date-fns';\r\nimport { SERVICE_TYPES, fetchAvailabilityData, ALL_SERVICES } from '../data/mockData';\r\nimport AvailabilityBottomSheet from '../components/AvailabilityBottomSheet';\r\nimport UnavailableTimesModal from '../components/UnavailableTimesModal';\r\nimport { useNavigation } from '@react-navigation/native';\r\nimport { AuthContext } from '../context/AuthContext';\r\n\r\nconst daysOfWeek = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];\r\n\r\nconst AvailabilitySettings = () => {\r\n  const { screenWidth, isCollapsed, is_DEBUG } = useContext(AuthContext);\r\n  const [isMobile, setIsMobile] = useState(screenWidth <= 900);\r\n  const styles = createStyles(screenWidth, isCollapsed);\r\n  const [markedDates, setMarkedDates] = useState({});\r\n  const [selectedDates, setSelectedDates] = useState([]);\r\n  const [isAddModalVisible, setIsAddModalVisible] = useState(false);\r\n  const [isSettingsModalVisible, setIsSettingsModalVisible] = useState(false);\r\n  const [defaultAvailability, setDefaultAvailability] = useState('available');\r\n  const [currentAvailability, setCurrentAvailability] = useState({});\r\n  const [bookings, setBookings] = useState({});\r\n  const [defaultSettings, setDefaultSettings] = useState({\r\n    Monday: { isAllDay: false, isUnavailable: false, startTime: '09:00', endTime: '17:00', endDate: null },\r\n    Tuesday: { isAllDay: false, isUnavailable: false, startTime: '09:00', endTime: '17:00', endDate: null },\r\n    Wednesday: { isAllDay: false, isUnavailable: false, startTime: '09:00', endTime: '17:00', endDate: null },\r\n    Thursday: { isAllDay: false, isUnavailable: false, startTime: '09:00', endTime: '17:00', endDate: null },\r\n    Friday: { isAllDay: false, isUnavailable: false, startTime: '09:00', endTime: '17:00', endDate: null },\r\n    Saturday: { isAllDay: false, isUnavailable: false, startTime: '09:00', endTime: '17:00', endDate: null },\r\n    Sunday: { isAllDay: false, isUnavailable: false, startTime: '09:00', endTime: '17:00', endDate: null },\r\n  });\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  const [showBottomSheet, setShowBottomSheet] = useState(false);\r\n  const [showUnavailableTimesModal, setShowUnavailableTimesModal] = useState(false);\r\n  const [isClosing, setIsClosing] = useState(false);\r\n  const [isBottomSheetMinimized, setIsBottomSheetMinimized] = useState(false);\r\n  const navigation = useNavigation();\r\n  const fadeAnim = useRef(new Animated.Value(0)).current;\r\n\r\n  useEffect(() => {\r\n    const updateLayout = () => {\r\n      setIsMobile(screenWidth <= 900);\r\n    };\r\n    updateLayout();\r\n  }, [screenWidth]);\r\n\r\n  useEffect(() => {\r\n    const loadAvailabilityData = async () => {\r\n      try {\r\n        setIsLoading(true);\r\n        const data = await fetchAvailabilityData();\r\n        updateMarkedDates(data.availableDates, data.unavailableDates, data.bookings);\r\n        \r\n        const combinedAvailability = {};\r\n        Object.keys(data.availableDates).forEach(date => {\r\n          combinedAvailability[date] = { \r\n            isAvailable: true,\r\n            unavailableTimes: [] // Initialize empty array for partially unavailable times\r\n          };\r\n        });\r\n        Object.keys(data.unavailableDates).forEach(date => {\r\n          combinedAvailability[date] = { \r\n            isAvailable: false,\r\n            unavailableTimes: [{\r\n              startTime: data.unavailableDates[date].startTime,\r\n              endTime: data.unavailableDates[date].endTime,\r\n              reason: ' Personal Time'\r\n            }]\r\n          };\r\n        });\r\n        Object.keys(data.bookings).forEach(date => {\r\n          if (!combinedAvailability[date]) {\r\n            combinedAvailability[date] = { \r\n              isAvailable: true,\r\n              unavailableTimes: []\r\n            };\r\n          }\r\n          combinedAvailability[date].unavailableTimes = [\r\n            ...combinedAvailability[date].unavailableTimes,\r\n            ...data.bookings[date].map(booking => ({\r\n              startTime: booking.startTime,\r\n              endTime: booking.endTime,\r\n              reason: ` Booked with ${booking.owner_name}`,\r\n              ownerId: booking.ownerId // Assuming each booking has a ownerId\r\n            }))\r\n          ];\r\n        });\r\n        setCurrentAvailability(combinedAvailability);\r\n        setBookings(data.bookings);\r\n      } catch (err) {\r\n        setError('Failed to load availability data');\r\n        console.error(err);\r\n      } finally {\r\n        setIsLoading(false);\r\n      }\r\n    };\r\n\r\n    loadAvailabilityData();\r\n  }, []);\r\n\r\n  const updateMarkedDates = (availableDates, unavailableDates, bookings) => {\r\n    const newMarkedDates = {};\r\n\r\n    // Helper function to check if all services are selected for a time slot\r\n    const hasAllServices = (reason) => {\r\n      if (!reason) return false;\r\n      const services = reason.replace('Unavailable for: ', '').split(', ');\r\n      return services.length === (SERVICE_TYPES.length - 1);\r\n    };\r\n\r\n    Object.entries(unavailableDates).forEach(([date, time]) => {\r\n      const isFullDay = time.startTime === '00:00' && time.endTime === '24:00';\r\n      const allServicesSelected = hasAllServices(time.reason);\r\n      \r\n      newMarkedDates[date] = {\r\n        customStyles: {\r\n          container: { \r\n            backgroundColor: isFullDay && allServicesSelected ? 'lightgrey' : theme.colors.calendarColor,\r\n            width: 35,\r\n            height: 35,\r\n            borderRadius: 17.5,\r\n            alignItems: 'center',\r\n            justifyContent: 'center'\r\n          },\r\n          text: { color: 'white' }\r\n        }\r\n      };\r\n    });\r\n\r\n    Object.entries(availableDates).forEach(([date, time]) => {\r\n      if (!newMarkedDates[date]) {\r\n        newMarkedDates[date] = {\r\n          customStyles: {\r\n            container: { \r\n              backgroundColor: 'white',\r\n              width: 35,\r\n              height: 35,\r\n              borderRadius: 17.5,\r\n              alignItems: 'center',\r\n              justifyContent: 'center'\r\n            },\r\n            text: { color: 'black' }\r\n          }\r\n        };\r\n      }\r\n    });\r\n\r\n    Object.entries(bookings).forEach(([date, bookingList]) => {\r\n      const isFullDay = bookingList.some(booking => \r\n        booking.startTime === '00:00' && booking.endTime === '24:00'\r\n      );\r\n      newMarkedDates[date] = { \r\n        marked: true,\r\n        dotColor: theme.colors.primary,\r\n        customStyles: {\r\n          container: { \r\n            backgroundColor: isFullDay ? theme.colors.primary : theme.colors.calendarColorYellowBrown,\r\n            width: 35,\r\n            height: 35,\r\n            borderRadius: 17.5,\r\n            alignItems: 'center',\r\n            justifyContent: 'center'\r\n          },\r\n          text: { color: 'white' }\r\n        }\r\n      };\r\n    });\r\n\r\n    setMarkedDates(newMarkedDates);\r\n  };\r\n\r\n  const toggleBottomSheet = (show) => {\r\n    if (show) {\r\n      setIsClosing(false);\r\n      setShowBottomSheet(true);\r\n      Animated.timing(fadeAnim, {\r\n        toValue: 0.5,\r\n        duration: 300,\r\n        useNativeDriver: true,\r\n      }).start();\r\n    } else {\r\n      setIsClosing(true);\r\n      Animated.timing(fadeAnim, {\r\n        toValue: 0,\r\n        duration: 300,\r\n        useNativeDriver: true,\r\n      }).start(() => {\r\n        setShowBottomSheet(false);\r\n        setIsClosing(false);\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleBottomSheetMinimize = (minimized) => {\r\n    setIsBottomSheetMinimized(minimized);\r\n    Animated.timing(fadeAnim, {\r\n      toValue: minimized ? 0 : 0.5,\r\n      duration: 300,\r\n      useNativeDriver: true,\r\n    }).start();\r\n  };\r\n\r\n  const onDayPress = (day) => {\r\n    const { dateString } = day;\r\n    const selectedDate = new Date(dateString);\r\n    selectedDate.setDate(selectedDate.getDate() + 1); // Adjust for timezone offset\r\n    selectedDate.setHours(0, 0, 0, 0);\r\n  \r\n    if (selectedDates.length === 0) {\r\n      setSelectedDates([dateString]);\r\n      toggleBottomSheet(true);\r\n    } else if (selectedDates.length >= 1) {\r\n      const firstDate = new Date(selectedDates[0]);\r\n      firstDate.setDate(firstDate.getDate() + 1); // Adjust for timezone offset\r\n      firstDate.setHours(0, 0, 0, 0);    \r\n\r\n      if (selectedDate.getTime() === firstDate.getTime()) {\r\n        return;\r\n      }\r\n\r\n      if (selectedDate < firstDate) {\r\n        setSelectedDates([dateString]);\r\n        toggleBottomSheet(true);\r\n        return;\r\n      }\r\n\r\n      const range = [];\r\n      const currentDate = new Date(firstDate);\r\n      const endDate = new Date(selectedDate);\r\n\r\n      while (currentDate <= endDate) {\r\n        range.push(format(currentDate, 'yyyy-MM-dd'));\r\n        currentDate.setDate(currentDate.getDate() + 1);\r\n      }\r\n    \r\n      setSelectedDates(range);\r\n    }\r\n  };\r\n\r\n  const handleAddAvailability = (availabilityData) => {\r\n    const newMarkedDates = { ...markedDates };\r\n    const newCurrentAvailability = { ...currentAvailability };\r\n\r\n    availabilityData.dates.forEach(date => {\r\n      const allServicesSelected = availabilityData.serviceTypes.includes(ALL_SERVICES) || \r\n                                 availabilityData.serviceTypes.length === SERVICE_TYPES.length - 1;\r\n\r\n      if (!availabilityData.isAvailable) {\r\n        newCurrentAvailability[date] = {\r\n          isAvailable: false,\r\n          unavailableTimes: [{\r\n            startTime: availabilityData.startTime,\r\n            endTime: availabilityData.endTime,\r\n            reason: availabilityData.reason\r\n          }]\r\n        };\r\n\r\n        newMarkedDates[date] = {\r\n          customStyles: {\r\n            container: {\r\n              backgroundColor: availabilityData.isAllDay && allServicesSelected ? 'lightgrey' : theme.colors.calendarColor,\r\n              width: 35,\r\n              height: 35,\r\n              borderRadius: 17.5,\r\n              alignItems: 'center',\r\n              justifyContent: 'center'\r\n            },\r\n            text: { color: 'white' }\r\n          }\r\n        };\r\n      } else {\r\n        newCurrentAvailability[date] = {\r\n          isAvailable: true,\r\n          unavailableTimes: []\r\n        };\r\n        newMarkedDates[date] = {\r\n          customStyles: {\r\n            container: { \r\n              backgroundColor: 'white',\r\n              width: 35,\r\n              height: 35,\r\n              borderRadius: 17.5,\r\n              alignItems: 'center',\r\n              justifyContent: 'center'\r\n            },\r\n            text: { color: 'black' }\r\n          }\r\n        };\r\n      }\r\n    });\r\n\r\n    setMarkedDates(newMarkedDates);\r\n    setCurrentAvailability(newCurrentAvailability);\r\n    setIsAddModalVisible(false);\r\n    setSelectedDates([]);\r\n  };\r\n\r\n  const applyDefaultSettingsToCalendar = (settings) => {\r\n    const newMarkedDates = { ...markedDates };\r\n    const newCurrentAvailability = { ...currentAvailability };\r\n    \r\n    const today = new Date();\r\n    const oneYearFromNow = new Date(today.getFullYear() + 1, today.getMonth(), today.getDate());\r\n\r\n    const daysMapping = {\r\n      'Sunday': 0,\r\n      'Monday': 1,\r\n      'Tuesday': 2,\r\n      'Wednesday': 3,\r\n      'Thursday': 4,\r\n      'Friday': 5,\r\n      'Saturday': 6\r\n    };\r\n\r\n    Object.entries(settings).forEach(([day, daySettings]) => {\r\n      let currentDate = new Date(Date.UTC(today.getFullYear(), today.getMonth(), today.getDate()));\r\n      const targetDayNumber = daysMapping[day];\r\n      \r\n      while (currentDate <= (daySettings.endDate ? new Date(daySettings.endDate) : oneYearFromNow)) {\r\n        const currentDayNumber = currentDate.getUTCDay();\r\n        const dateString = currentDate.toISOString().split('T')[0];\r\n        \r\n        if (currentDayNumber === targetDayNumber) {\r\n          if (daySettings.isUnavailable) {\r\n            if (daySettings.isAllDay) {\r\n              newMarkedDates[dateString] = {\r\n                customStyles: {\r\n                  container: { backgroundColor: 'lightgrey' },\r\n                  text: { color: 'white' }\r\n                }\r\n              };\r\n              newCurrentAvailability[dateString] = {\r\n                isAvailable: false,\r\n                unavailableTimes: [{ startTime: '00:00', endTime: '24:00', reason: 'Default Setting' }]\r\n              };\r\n            } else {\r\n              newMarkedDates[dateString] = {\r\n                customStyles: {\r\n                  container: { backgroundColor: theme.colors.calendarColor },\r\n                  text: { color: 'white' }\r\n                }\r\n              };\r\n              newCurrentAvailability[dateString] = {\r\n                isAvailable: true,\r\n                unavailableTimes: [{\r\n                  startTime: daySettings.startTime,\r\n                  endTime: daySettings.endTime,\r\n                  reason: 'Default Setting'\r\n                }]\r\n              };\r\n            }\r\n          } else {\r\n            // Reset to available\r\n            delete newMarkedDates[dateString];\r\n            delete newCurrentAvailability[dateString];\r\n          }\r\n        }\r\n        currentDate.setUTCDate(currentDate.getUTCDate() + 1);\r\n      }\r\n    });\r\n\r\n    setMarkedDates(newMarkedDates);\r\n    setCurrentAvailability(newCurrentAvailability);\r\n  };\r\n\r\n  //TODO: implement this in future for making owners on bookings clickable\r\n  // const handleOwnerPress = (ownerId) => {\r\n  //   // Navigate to the owner history page\r\n  //   // You'll need to implement this navigation logic\r\n  //   console.log(`Navigating to owner history for owner ID: ${ownerId}`);\r\n  // };\r\n\r\n  const IconComponent = Platform.OS === 'web' ? MaterialCommunityIcons : Icon;\r\n\r\n  const renderArrow = (direction) => {\r\n    let iconName;\r\n    if (Platform.OS === 'web') {\r\n      iconName = direction === 'left' ? 'chevron-left' : 'chevron-right';\r\n    } else {\r\n      iconName = direction === 'left' ? 'chevron-back' : 'chevron-forward';\r\n    }\r\n    return (\r\n      <IconComponent \r\n        name={iconName} \r\n        size={24} \r\n        color={theme.colors.primary}\r\n      />\r\n    );\r\n  };\r\n\r\n  const handleDefaultSettingsSave = (newSettings) => {\r\n    console.log(\"Before updating defaultSettings:\", defaultSettings);\r\n    console.log(\"New settings to be applied:\", newSettings);\r\n    setDefaultSettings(newSettings);\r\n    \r\n    // Add a setTimeout to check the state after update\r\n    setTimeout(() => {\r\n      console.log(\"After updating defaultSettings:\", defaultSettings);\r\n    }, 0);\r\n    \r\n    // Call applyDefaultSettingsToCalendar to update the calendar view\r\n    applyDefaultSettingsToCalendar(newSettings);\r\n    setIsSettingsModalVisible(false);\r\n  };\r\n\r\n  const handleSaveAvailability = (data) => {\r\n    const { startTime, endTime, services, isAvailable } = data;\r\n    const isAllDay = startTime === '00:00' && endTime === '24:00';\r\n    handleAddAvailability({\r\n      dates: selectedDates,\r\n      isAllDay,\r\n      startTime,\r\n      endTime,\r\n      isUnavailable: !isAvailable,\r\n      serviceTypes: services,\r\n      reason: `Unavailable for: ${services.join(', ')}`,\r\n    });\r\n    toggleBottomSheet(false);\r\n    setSelectedDates([]);\r\n  };\r\n\r\n  // TODO: make this actually remove the timeslot on the backend\r\n  const handleRemoveTimeSlot = (date, timeSlot, updatedAvailability, selectedDates) => {\r\n    if (updatedAvailability && selectedDates) {\r\n      // Handle multiple dates\r\n      setCurrentAvailability(prev => ({\r\n        ...prev,\r\n        ...updatedAvailability\r\n      }));\r\n\r\n      // Update marked dates for multiple dates\r\n      const newMarkedDates = { ...markedDates };\r\n      selectedDates.forEach(date => {\r\n        if (updatedAvailability[date]?.unavailableTimes.length === 0) {\r\n          newMarkedDates[date] = {\r\n            customStyles: {\r\n              container: { backgroundColor: 'white' },\r\n              text: { color: 'black' }\r\n            }\r\n          };\r\n        }\r\n      });\r\n      setMarkedDates(newMarkedDates);\r\n    } else {\r\n      // Handle single date (existing functionality)\r\n      setCurrentAvailability(prev => {\r\n        const currentDateAvailability = prev[date];\r\n        if (!currentDateAvailability) return prev;\r\n\r\n        const filteredTimes = currentDateAvailability.unavailableTimes.filter(\r\n          time => !(time.startTime === timeSlot.startTime && time.endTime === timeSlot.endTime)\r\n        );\r\n\r\n        // Update marked dates for single date\r\n        const newMarkedDates = { ...markedDates };\r\n        if (filteredTimes.length === 0) {\r\n          newMarkedDates[date] = {\r\n            customStyles: {\r\n              container: { backgroundColor: 'white' },\r\n              text: { color: 'black' }\r\n            }\r\n          };\r\n          setMarkedDates(newMarkedDates);\r\n        }\r\n\r\n        return {\r\n          ...prev,\r\n          [date]: {\r\n            ...currentDateAvailability,\r\n            unavailableTimes: filteredTimes\r\n          }\r\n        };\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleViewBookings = () => {\r\n    if (selectedDates.length > 0) {\r\n      navigation.navigate('MyBookings', {\r\n        selectedDates,\r\n        initialTab: 'Upcoming'\r\n      });\r\n    }\r\n  };\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <SafeAreaView style={styles.container}>\r\n        <View style={styles.loadingContainer}>\r\n          <ActivityIndicator size=\"large\" color={theme.colors.primary} />\r\n          <Text style={styles.loadingText}>Loading availability...</Text>\r\n        </View>\r\n      </SafeAreaView>\r\n    );\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <SafeAreaView style={styles.container}>\r\n        <View style={styles.errorContainer}>\r\n          <Text style={styles.errorText}>{error}</Text>\r\n          <TouchableOpacity \r\n            style={styles.retryButton}\r\n            onPress={() => {\r\n              setError(null);\r\n              loadAvailabilityData();\r\n            }}\r\n          >\r\n            <Text style={styles.retryButtonText}>Retry</Text>\r\n          </TouchableOpacity>\r\n        </View>\r\n      </SafeAreaView>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <View style={createStyles(screenWidth, isCollapsed).mainContainer}>\r\n      <View style={createStyles(screenWidth, isCollapsed).container}>\r\n        <ScrollView \r\n          style={createStyles(screenWidth, isCollapsed).scrollView}\r\n          contentContainerStyle={createStyles(screenWidth, isCollapsed).scrollContent}\r\n          showsVerticalScrollIndicator={false}\r\n        >\r\n          <View style={createStyles(screenWidth, isCollapsed).centeredContainer}>\r\n            <View style={createStyles(screenWidth, isCollapsed).header}>\r\n              <Text style={createStyles(screenWidth, isCollapsed).title}>Availability Settings</Text>\r\n              <TouchableOpacity \r\n                style={createStyles(screenWidth, isCollapsed).defaultSettingsButton}\r\n                onPress={() => setIsSettingsModalVisible(true)}\r\n              >\r\n                <Text style={createStyles(screenWidth, isCollapsed).defaultSettingsText}>Default Settings</Text>\r\n                <IconComponent \r\n                  name={Platform.OS === 'web' ? 'cog' : 'settings-outline'} \r\n                  size={24} \r\n                  color={theme.colors.text} \r\n                />\r\n              </TouchableOpacity>\r\n            </View>\r\n\r\n            <Calendar\r\n              style={[createStyles(screenWidth, isCollapsed).calendar, { width: screenWidth <= 900 ? '100%' : 'auto' }]}\r\n              markedDates={markedDates}\r\n              onDayPress={onDayPress}\r\n              theme={{\r\n                backgroundColor: 'transparent',\r\n                calendarBackground: 'transparent',\r\n                textSectionTitleColor: theme.colors.text,\r\n                selectedDayBackgroundColor: theme.colors.primary,\r\n                selectedDayTextColor: '#ffffff',\r\n                todayTextColor: theme.colors.primary,\r\n                dayTextColor: theme.colors.text,\r\n                textDisabledColor: '#d9e1e8',\r\n                dotColor: theme.colors.primary,\r\n                monthTextColor: theme.colors.text,\r\n                arrowColor: theme.colors.primary,\r\n                indicatorColor: theme.colors.primary,\r\n              }}\r\n            />\r\n\r\n            <View style={createStyles(screenWidth, isCollapsed).colorKeyContainer}>\r\n              <Text style={createStyles(screenWidth, isCollapsed).colorKeyTitle}>Color Key</Text>\r\n              <View style={createStyles(screenWidth, isCollapsed).colorKeyItem}>\r\n                <View style={[createStyles(screenWidth, isCollapsed).colorBox, { backgroundColor: theme.colors.calendarColor }]} />\r\n                <Text style={createStyles(screenWidth, isCollapsed).colorKeyText}>Unavailable</Text>\r\n              </View>\r\n              <View style={createStyles(screenWidth, isCollapsed).colorKeyItem}>\r\n                <View style={[createStyles(screenWidth, isCollapsed).colorBox, { backgroundColor: theme.colors.calendarColorYellowBrown }]} />\r\n                <Text style={createStyles(screenWidth, isCollapsed).colorKeyText}>Partially Available</Text>\r\n              </View>\r\n            </View>\r\n          </View>\r\n        </ScrollView>\r\n\r\n        <TouchableOpacity \r\n          style={createStyles(screenWidth, isCollapsed).addButton}\r\n          onPress={() => setIsAddModalVisible(true)}\r\n        >\r\n          <Icon name=\"add\" size={24} color={theme.colors.whiteText} />\r\n        </TouchableOpacity>\r\n      </View>\r\n\r\n      {isAddModalVisible && (\r\n        <AddAvailabilityModal\r\n          visible={isAddModalVisible}\r\n          onClose={() => setIsAddModalVisible(false)}\r\n          onSave={handleAddAvailability}\r\n          selectedDate={selectedDates.length > 0 ? selectedDates[0] : null}\r\n        />\r\n      )}\r\n\r\n      {isSettingsModalVisible && (\r\n        <DefaultSettingsModal\r\n          isVisible={isSettingsModalVisible}\r\n          onClose={() => setIsSettingsModalVisible(false)}\r\n          onSave={handleDefaultSettingsSave}\r\n          defaultSettings={defaultSettings}\r\n        />\r\n      )}\r\n\r\n      {(showBottomSheet || isClosing) && (\r\n        <>\r\n          <Animated.View \r\n            style={[\r\n              styles.overlay,\r\n              {\r\n                opacity: fadeAnim,\r\n                backgroundColor: 'black',\r\n                pointerEvents: isBottomSheetMinimized ? 'none' : 'auto'\r\n              }\r\n            ]} \r\n          />\r\n          <View style={[\r\n            styles.bottomSheetContainer,\r\n            { pointerEvents: 'box-none' }\r\n          ]}>\r\n            <AvailabilityBottomSheet\r\n              selectedDates={selectedDates}\r\n              currentAvailability={currentAvailability}\r\n              onClose={() => {\r\n                toggleBottomSheet(false);\r\n                setSelectedDates([]);\r\n              }}\r\n              onViewUnavailableTimes={() => {\r\n                setShowUnavailableTimesModal(true);\r\n              }}\r\n              onSave={handleSaveAvailability}\r\n              onViewBookings={handleViewBookings}\r\n              onMinimize={handleBottomSheetMinimize}\r\n            />\r\n          </View>\r\n        </>\r\n      )}\r\n\r\n      <UnavailableTimesModal\r\n        visible={showUnavailableTimesModal}\r\n        onClose={() => setShowUnavailableTimesModal(false)}\r\n        selectedDates={selectedDates}\r\n        currentAvailability={currentAvailability}\r\n        onRemoveTimeSlot={handleRemoveTimeSlot}\r\n        bookings={bookings}\r\n      />\r\n    </View>\r\n  );\r\n};\r\n\r\nconst createStyles = (screenWidth, isCollapsed) => StyleSheet.create({\r\n  mainContainer: {\r\n    flex: 1,\r\n    backgroundColor: theme.colors.background,\r\n    height: '100vh',\r\n    overflow: 'hidden',\r\n    position: 'fixed',\r\n    top: 0,\r\n    left: 0,\r\n    right: 0,\r\n    bottom: 0,\r\n    marginLeft: screenWidth > 900 ? (isCollapsed ? 70 : 250) : 0,\r\n    transition: 'margin-left 0.3s ease',\r\n  },\r\n  container: {\r\n    flex: 1,\r\n  },\r\n  scrollView: {\r\n    flex: 1,\r\n  },\r\n  scrollContent: {\r\n    flexGrow: 1,\r\n  },\r\n  bottomSheetOverlay: {\r\n    position: 'absolute',\r\n    bottom: 0,\r\n    left: 0,\r\n    right: 0,\r\n  },\r\n  centeredContainer: {\r\n    maxWidth: screenWidth > 900 ? 1000 : '100%',\r\n    width: '100%',\r\n    alignSelf: 'center',\r\n    flex: 1,\r\n    padding: screenWidth <= 900 ? 10 : 20,\r\n  },\r\n  header: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    padding: screenWidth <= 900 ? 10 : 16,\r\n    flexWrap: screenWidth <= 600 ? 'wrap' : 'nowrap',\r\n    gap: screenWidth <= 600 ? 10 : 0,\r\n  },\r\n  title: {\r\n    fontSize: screenWidth <= 600 ? theme.fontSizes.medium : theme.fontSizes.large,\r\n    fontWeight: 'bold',\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n    width: screenWidth <= 600 ? '100%' : 'auto',\r\n  },\r\n  addButton: {\r\n    position: 'absolute',\r\n    right: 20,\r\n    bottom: 20,\r\n    width: 56,\r\n    height: 56,\r\n    borderRadius: 28,\r\n    backgroundColor: theme.colors.primary,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    elevation: 5,\r\n    shadowColor: '#000',\r\n    shadowOffset: { width: 0, height: 2 },\r\n    shadowOpacity: 0.25,\r\n    shadowRadius: 3.84,\r\n  },\r\n  defaultSettingsButton: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    padding: 8,\r\n  },\r\n  defaultSettingsText: {\r\n    marginRight: 8,\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  colorKeyContainer: {\r\n    marginTop: 20,\r\n    padding: screenWidth <= 600 ? 15 : 10,\r\n    backgroundColor: 'white',\r\n    borderRadius: 5,\r\n    elevation: 2,\r\n    flexDirection: screenWidth <= 600 ? 'column' : 'row',\r\n    flexWrap: 'wrap',\r\n    gap: 10,\r\n  },\r\n  colorKeyTitle: {\r\n    fontSize: 16,\r\n    fontWeight: 'bold',\r\n    marginBottom: 10,\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n  },\r\n  colorKeyItem: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    marginVertical: screenWidth <= 600 ? 2 : 5,\r\n    flex: screenWidth <= 600 ? 0 : 1,\r\n  },\r\n  colorBox: {\r\n    width: 20,\r\n    height: 20,\r\n    borderRadius: 3,\r\n    marginRight: 10,\r\n  },\r\n  colorKeyText: {\r\n    fontSize: 14,\r\n    color: 'black',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  loadingContainer: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n  },\r\n  loadingText: {\r\n    marginTop: 10,\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  errorContainer: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    padding: 20,\r\n  },\r\n  errorText: {\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.error,\r\n    textAlign: 'center',\r\n    marginBottom: 20,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  retryButton: {\r\n    backgroundColor: theme.colors.primary,\r\n    padding: 10,\r\n    borderRadius: 5,\r\n  },\r\n  retryButtonText: {\r\n    color: theme.colors.whiteText,\r\n    fontSize: theme.fontSizes.medium,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  overlay: {\r\n    position: 'absolute',\r\n    top: 0,\r\n    left: 0,\r\n    right: 0,\r\n    bottom: 0,\r\n    backgroundColor: 'black',\r\n  },\r\n  bottomSheetContainer: {\r\n    position: 'absolute',\r\n    bottom: 0,\r\n    left: 0,\r\n    right: 0,\r\n  },\r\n  calendar: {\r\n    paddingBottom: 20,\r\n    paddingLeft: 10,\r\n    paddingRight: 10\r\n  },\r\n});\r\n\r\nexport default AvailabilitySettings;\r\n","import React from 'react';\r\nimport { View, StyleSheet, ScrollView, Platform, SafeAreaView, StatusBar } from 'react-native';\r\nimport { Card, Title, Paragraph, List, Button, useTheme } from 'react-native-paper';\r\nimport { theme } from '../styles/theme';\r\nimport { navigateToFrom } from '../components/Navigation';\r\n\r\nconst OwnerHistory = ({ route, navigation }) => {\r\n  const { ownerId } = route.params;\r\n  const { colors } = useTheme();\r\n\r\n  // Mock data - replace with actual data from your backend\r\n  const ownerData = {\r\n    id: ownerId,\r\n    name: 'John Doe',\r\n    email: 'john.doe@example.com',\r\n    phone: '(123) 456-7890',\r\n    contracts: [\r\n      { id: '1', date: '2023-05-01', status: 'Completed' },\r\n      { id: '2', date: '2023-04-15', status: 'Pending' },\r\n    ],\r\n    invoices: [\r\n      { id: '1', date: '2023-05-02', amount: '$100', status: 'Paid' },\r\n      { id: '2', date: '2023-04-16', amount: '$75', status: 'Unpaid' },\r\n    ],\r\n    upcomingBookings: [\r\n      { id: '1', date: '2023-06-01', service: 'Dog Walking' },\r\n      { id: '2', date: '2023-06-15', service: 'Cat Sitting' },\r\n    ],\r\n  };\r\n\r\n  const Content = () => (\r\n    <ScrollView style={styles.scrollView} contentContainerStyle={styles.scrollViewContent}>\r\n      <Card style={styles.card}>\r\n        <Card.Content>\r\n          <Title>{ownerData.name}</Title>\r\n          <Paragraph>Email: {ownerData.email}</Paragraph>\r\n          <Paragraph>Phone: {ownerData.phone}</Paragraph>\r\n        </Card.Content>\r\n      </Card>\r\n\r\n      <Card style={styles.card}>\r\n        <Card.Content>\r\n          <Title>Upcoming Bookings</Title>\r\n          {ownerData.upcomingBookings.map(booking => (\r\n            <List.Item\r\n              key={booking.id}\r\n              title={`Booking ${booking.id}`}\r\n              description={`Date: ${booking.date} - Service: ${booking.service}`}\r\n              left={props => <List.Icon {...props} icon=\"calendar\" />}\r\n            />\r\n          ))}\r\n        </Card.Content>\r\n      </Card>\r\n\r\n      <Card style={styles.card}>\r\n        <Card.Content>\r\n          <Title>Contracts</Title>\r\n          {ownerData.contracts.map(contract => (\r\n            <List.Item\r\n              key={contract.id}\r\n              title={`Contract ${contract.id}`}\r\n              description={`Date: ${contract.date} - Status: ${contract.status}`}\r\n              left={props => <List.Icon {...props} icon=\"file-document-outline\" />}\r\n            />\r\n          ))}\r\n        </Card.Content>\r\n        <Card.Actions>\r\n          <Button onPress={() => navigateToFrom(navigation, 'Contracts', 'OwnerHistory', { ownerId })}>View All Contracts</Button>\r\n        </Card.Actions>\r\n      </Card>\r\n\r\n      <Card style={styles.card}>\r\n        <Card.Content>\r\n          <Title>Invoices</Title>\r\n          {ownerData.invoices.map(invoice => (\r\n            <List.Item\r\n              key={invoice.id}\r\n              title={`Invoice ${invoice.id}`}\r\n              description={`Date: ${invoice.date} - Amount: ${invoice.amount} - Status: ${invoice.status}`}\r\n              left={props => <List.Icon {...props} icon=\"file-document-outline\" />}\r\n            />\r\n          ))}\r\n        </Card.Content>\r\n        <Card.Actions>\r\n          <Button onPress={() => navigateToFrom(navigation, 'Invoices', 'OwnerHistory', { ownerId })}>View All Invoices</Button>\r\n        </Card.Actions>\r\n      </Card>\r\n\r\n      <View style={styles.messageButtonContainer}>\r\n        <Button \r\n          mode=\"contained\" \r\n          onPress={() => navigateToFrom(navigation, 'MessageHistory', 'OwnerHistory', { ownerId })}\r\n          style={styles.messageButton}\r\n        >\r\n          View Messages\r\n        </Button>\r\n      </View>\r\n    </ScrollView>\r\n  );\r\n\r\n  if (Platform.OS === 'ios') {\r\n    return (\r\n      <SafeAreaView style={styles.container}>\r\n        <Content />\r\n      </SafeAreaView>\r\n    );\r\n  } else if (Platform.OS === 'android') {\r\n    return (\r\n      <View style={[styles.container, styles.androidContainer]}>\r\n        <Content />\r\n      </View>\r\n    );\r\n  } else {\r\n    return (\r\n      <View style={styles.container}>\r\n        <Content />\r\n      </View>\r\n    );\r\n  }\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    backgroundColor: theme.colors.background,\r\n  },\r\n  androidContainer: {\r\n    paddingTop: StatusBar.currentHeight,\r\n  },\r\n  scrollView: {\r\n    flex: 1,\r\n  },\r\n  scrollViewContent: {\r\n    padding: 16,\r\n    paddingBottom: Platform.OS === 'web' ? 16 : 90, // Extra padding for iOS and Android\r\n  },\r\n  card: {\r\n    marginBottom: 16,\r\n    maxWidth: 600,\r\n    alignSelf: 'center',\r\n    width: '100%',\r\n  },\r\n  messageButtonContainer: {\r\n    maxWidth: 600,\r\n    alignSelf: 'center',\r\n    width: '100%',\r\n    marginTop: 16,\r\n  },\r\n  messageButton: {\r\n    width: '100%',\r\n  },\r\n});\r\n\r\nexport default OwnerHistory;\r\n","import React, { useState, useContext, useEffect, useRef } from 'react';\r\nimport { View, Text, StyleSheet, TextInput, Pressable, ScrollView, Animated } from 'react-native';\r\nimport { theme } from '../styles/theme';\r\nimport { AuthContext } from '../context/AuthContext';\r\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\r\n\r\nconst DateTimePicker = ({\r\n  value,\r\n  onChange,\r\n  error,\r\n  disabled = false,\r\n  containerStyle,\r\n  isMilitary = true,\r\n  onPickerStateChange\r\n}) => {\r\n  const { is_DEBUG, screenWidth } = useContext(AuthContext);\r\n  const [inputs, setInputs] = useState({\r\n    month: '',\r\n    day: '',\r\n    year: '',\r\n    hours: '',\r\n    minutes: '',\r\n    period: isMilitary ? null : 'AM'\r\n  });\r\n  const [showCalendar, setShowCalendar] = useState(false);\r\n  const [showTimeSelector, setShowTimeSelector] = useState(false);\r\n  const containerRef = useRef(null);\r\n  const fadeAnim = useRef(new Animated.Value(0)).current;\r\n\r\n  const animatePickerVisibility = (show) => {\r\n    Animated.timing(fadeAnim, {\r\n      toValue: show ? 1 : 0,\r\n      duration: 200,\r\n      useNativeDriver: true,\r\n    }).start();\r\n  };\r\n\r\n  useEffect(() => {\r\n    animatePickerVisibility(showCalendar || showTimeSelector);\r\n  }, [showCalendar, showTimeSelector]);\r\n\r\n  useEffect(() => {\r\n    if (value instanceof Date && !isNaN(value)) {\r\n      if (is_DEBUG) {\r\n        console.log('MBA1234 Received date value:', value.toISOString());\r\n      }\r\n      \r\n      const hours24 = value.getHours();\r\n      const hours12 = hours24 % 12 || 12;\r\n      const period = isMilitary ? null : (hours24 >= 12 ? 'PM' : 'AM');\r\n      \r\n      if (is_DEBUG) {\r\n        console.log('MBA1234 Time format detection:', {\r\n          hours24,\r\n          hours12,\r\n          period,\r\n          isMilitary\r\n        });\r\n      }\r\n      \r\n      setInputs({\r\n        month: String(value.getMonth() + 1).padStart(2, '0'),\r\n        day: String(value.getDate()).padStart(2, '0'),\r\n        year: String(value.getFullYear()),\r\n        hours: isMilitary ? String(hours24).padStart(2, '0') : String(hours12).padStart(2, '0'),\r\n        minutes: String(value.getMinutes()).padStart(2, '0'),\r\n        period\r\n      });\r\n    }\r\n  }, [value, isMilitary]);\r\n\r\n  useEffect(() => {\r\n    if (is_DEBUG) {\r\n      console.log('MBA5678 DateTimePicker picker states:', {\r\n        showCalendar,\r\n        showTimeSelector,\r\n        isPickerActive: showCalendar || showTimeSelector\r\n      });\r\n    }\r\n    onPickerStateChange?.(showCalendar || showTimeSelector);\r\n  }, [showCalendar, showTimeSelector]);\r\n\r\n  useEffect(() => {\r\n    const handleClickOutside = (event) => {\r\n      if (containerRef.current && !containerRef.current.contains(event.target)) {\r\n        if (is_DEBUG) {\r\n          console.log('MBA5678 Click outside - closing pickers');\r\n        }\r\n        setShowCalendar(false);\r\n        setShowTimeSelector(false);\r\n      }\r\n    };\r\n\r\n    document.addEventListener('mousedown', handleClickOutside);\r\n    return () => document.removeEventListener('mousedown', handleClickOutside);\r\n  }, []);\r\n\r\n  const formatTwoDigitInput = (input, field, currentValue) => {\r\n    // Remove any non-numeric characters\r\n    const numbers = input.replace(/[^0-9]/g, '');\r\n    \r\n    if (is_DEBUG) {\r\n      console.log('MBA1234 Formatting input:', {\r\n        field,\r\n        input,\r\n        numbers,\r\n        currentValue\r\n      });\r\n    }\r\n\r\n    // Handle backspace (empty input)\r\n    if (numbers.length === 0) {\r\n      return '00';\r\n    }\r\n\r\n    // If we only have one digit\r\n    if (numbers.length === 1) {\r\n      return `0${numbers}`;\r\n    }\r\n\r\n    // If we have two digits\r\n    if (numbers.length >= 2) {\r\n      const firstDigit = parseInt(numbers[0], 10);\r\n      const secondDigit = parseInt(numbers[1], 10);\r\n      \r\n      if (field === 'month') {\r\n        if (firstDigit > 1 || (firstDigit === 1 && secondDigit > 2)) {\r\n          return '12';\r\n        }\r\n        return `${firstDigit}${secondDigit}`;\r\n      }\r\n      \r\n      if (field === 'day') {\r\n        if (firstDigit > 3 || (firstDigit === 3 && secondDigit > 1)) {\r\n          return '31';\r\n        }\r\n        return `${firstDigit}${secondDigit}`;\r\n      }\r\n      \r\n      if (field === 'hours') {\r\n        if (!currentValue.period) {\r\n          // 24-hour format\r\n          if (firstDigit > 2 || (firstDigit === 2 && secondDigit > 3)) {\r\n            return '23';\r\n          }\r\n        } else {\r\n          // 12-hour format\r\n          if (firstDigit > 1 || (firstDigit === 1 && secondDigit > 2)) {\r\n            return '12';\r\n          }\r\n        }\r\n        return `${firstDigit}${secondDigit}`;\r\n      }\r\n      \r\n      if (field === 'minutes') {\r\n        if (firstDigit > 5) {\r\n          return '59';\r\n        }\r\n        return `${firstDigit}${secondDigit}`;\r\n      }\r\n    }\r\n    \r\n    return numbers.slice(0, 2);\r\n  };\r\n\r\n  const formatYearInput = (input) => {\r\n    const numbers = input.replace(/[^0-9]/g, '');\r\n    if (numbers.length === 0) return '0000';\r\n    return numbers.padStart(4, '0').slice(0, 4);\r\n  };\r\n\r\n  const handleInputChange = (field, value) => {\r\n    let formattedValue = value;\r\n\r\n    if (is_DEBUG) {\r\n      console.log('MBA1234 Input change:', {\r\n        field,\r\n        value,\r\n        currentInputs: inputs\r\n      });\r\n    }\r\n\r\n    switch (field) {\r\n      case 'month':\r\n        formattedValue = formatTwoDigitInput(value, 'month', inputs);\r\n        break;\r\n      case 'day':\r\n        formattedValue = formatTwoDigitInput(value, 'day', inputs);\r\n        break;\r\n      case 'year':\r\n        formattedValue = formatYearInput(value);\r\n        break;\r\n      case 'hours':\r\n        formattedValue = formatTwoDigitInput(value, 'hours', inputs);\r\n        break;\r\n      case 'minutes':\r\n        formattedValue = formatTwoDigitInput(value, 'minutes', inputs);\r\n        break;\r\n      case 'period':\r\n        formattedValue = value;\r\n        break;\r\n    }\r\n\r\n    if (is_DEBUG) {\r\n      console.log('MBA1234 Formatted value:', {\r\n        field,\r\n        formattedValue\r\n      });\r\n    }\r\n\r\n    const newInputs = { ...inputs, [field]: formattedValue };\r\n    setInputs(newInputs);\r\n\r\n    // Only create new date if we have all required fields\r\n    if (newInputs.month && newInputs.day && newInputs.year && \r\n        newInputs.hours && newInputs.minutes) {\r\n      createNewDate(newInputs);\r\n    }\r\n  };\r\n\r\n  const createNewDate = (currentInputs) => {\r\n    try {\r\n      let hours = parseInt(currentInputs.hours, 10);\r\n      if (currentInputs.period) {\r\n        // Only convert hours if we're using AM/PM\r\n        if (currentInputs.period === 'PM' && hours !== 12) {\r\n          hours += 12;\r\n        } else if (currentInputs.period === 'AM' && hours === 12) {\r\n          hours = 0;\r\n        }\r\n      }\r\n\r\n      const newDate = new Date(\r\n        parseInt(currentInputs.year, 10),\r\n        parseInt(currentInputs.month, 10) - 1,\r\n        parseInt(currentInputs.day, 10),\r\n        hours,\r\n        parseInt(currentInputs.minutes, 10)\r\n      );\r\n\r\n      if (is_DEBUG) {\r\n        console.log('MBA1234 Created new date:', {\r\n          inputs: currentInputs,\r\n          newDate: newDate.toISOString()\r\n        });\r\n      }\r\n\r\n      if (!isNaN(newDate.getTime())) {\r\n        onChange(newDate);\r\n      }\r\n    } catch (error) {\r\n      if (is_DEBUG) {\r\n        console.error('MBA1234 Error creating date:', error);\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleDatePress = () => {\r\n    if (is_DEBUG) {\r\n      console.log('MBA5678 Date press - toggling calendar');\r\n    }\r\n    setShowCalendar(prev => !prev);\r\n    setShowTimeSelector(false);\r\n  };\r\n\r\n  const handleTimePress = () => {\r\n    if (is_DEBUG) {\r\n      console.log('MBA5678 Time press - toggling time selector');\r\n    }\r\n    setShowTimeSelector(prev => !prev);\r\n    setShowCalendar(false);\r\n  };\r\n\r\n  const handleDaySelect = (day) => {\r\n    handleInputChange('day', String(day));\r\n    setShowCalendar(false);\r\n  };\r\n\r\n  if (is_DEBUG) {\r\n    console.log('MBA1234 Current state:', {\r\n      inputs,\r\n      isMilitary\r\n    });\r\n  }\r\n\r\n  return (\r\n    <View style={[styles.container, containerStyle]} ref={containerRef}>\r\n      <View style={[\r\n        styles.dateTimeContainer,\r\n        error && styles.errorBorder,\r\n        disabled && styles.disabled\r\n      ]}>\r\n        {/* Date Inputs */}\r\n        <Pressable \r\n          style={styles.dateInputGroup}\r\n          onPress={() => !disabled && handleDatePress()}\r\n        >\r\n          <TextInput\r\n            style={styles.numberInput}\r\n            value={inputs.month}\r\n            maxLength={2}\r\n            keyboardType=\"number-pad\"\r\n            onChangeText={(text) => handleInputChange('month', text)}\r\n            placeholder=\"MM\"\r\n            editable={!disabled}\r\n          />\r\n          <Text style={styles.separator}>/</Text>\r\n          <TextInput\r\n            style={styles.numberInput}\r\n            value={inputs.day}\r\n            maxLength={2}\r\n            keyboardType=\"number-pad\"\r\n            onChangeText={(text) => handleInputChange('day', text)}\r\n            placeholder=\"DD\"\r\n            editable={!disabled}\r\n          />\r\n          <Text style={styles.separator}>/</Text>\r\n          <TextInput\r\n            style={styles.yearInput}\r\n            value={inputs.year}\r\n            maxLength={4}\r\n            keyboardType=\"number-pad\"\r\n            onChangeText={(text) => handleInputChange('year', text)}\r\n            placeholder=\"YYYY\"\r\n            editable={!disabled}\r\n          />\r\n          {screenWidth > 410 && (\r\n            <MaterialCommunityIcons \r\n              name=\"calendar\" \r\n              size={20} \r\n              color={theme.colors.text} \r\n              style={styles.icon} \r\n            />\r\n          )}\r\n        </Pressable>\r\n        \r\n        <Text style={styles.divider}>|</Text>\r\n        \r\n        {/* Time Inputs */}\r\n        <Pressable \r\n          style={styles.timeInputGroup}\r\n          onPress={() => !disabled && handleTimePress()}\r\n        >\r\n          <TextInput\r\n            style={styles.numberInput}\r\n            value={inputs.hours}\r\n            maxLength={2}\r\n            keyboardType=\"number-pad\"\r\n            onChangeText={(text) => handleInputChange('hours', text)}\r\n            placeholder=\"HH\"\r\n            editable={!disabled}\r\n          />\r\n          <Text style={styles.separator}>:</Text>\r\n          <TextInput\r\n            style={styles.numberInput}\r\n            value={inputs.minutes}\r\n            maxLength={2}\r\n            keyboardType=\"number-pad\"\r\n            onChangeText={(text) => handleInputChange('minutes', text)}\r\n            placeholder=\"MM\"\r\n            editable={!disabled}\r\n          />\r\n          \r\n          {/* AM/PM Toggle - only show if not military time */}\r\n          {!isMilitary && (\r\n            <Pressable\r\n              style={styles.periodButton}\r\n              onPress={() => !disabled && handleInputChange('period', inputs.period)}\r\n              disabled={disabled}\r\n            >\r\n              <Text style={styles.periodText}>{inputs.period}</Text>\r\n            </Pressable>\r\n          )}\r\n          {screenWidth > 410 && (\r\n            <MaterialCommunityIcons \r\n              name=\"clock-outline\" \r\n              size={20} \r\n              color={theme.colors.text} \r\n              style={styles.icon} \r\n            />\r\n          )}\r\n        </Pressable>\r\n      </View>\r\n\r\n      <Animated.View style={[\r\n        styles.pickerContainer,\r\n        { opacity: fadeAnim },\r\n        { display: (showCalendar || showTimeSelector) ? 'flex' : 'none' }\r\n      ]}>\r\n        {showCalendar && !disabled && (\r\n          <View style={styles.calendar}>\r\n            <View style={styles.calendarHeader}>\r\n              <Text style={styles.calendarHeaderText}>\r\n                {value.toLocaleString('default', { month: 'long' })} {value.getFullYear()}\r\n              </Text>\r\n            </View>\r\n            <View style={styles.calendarWeekDays}>\r\n              {['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'].map(day => (\r\n                <Text key={day} style={styles.calendarWeekDay}>{day}</Text>\r\n              ))}\r\n            </View>\r\n            {/* Calendar grid */}\r\n            {Array.from({ length: 6 }).map((_, weekIndex) => (\r\n              <View key={`week-${weekIndex}`} style={styles.calendarWeek}>\r\n                {Array.from({ length: 7 }).map((__, dayIndex) => {\r\n                  const dayNumber = weekIndex * 7 + dayIndex - value.getDay() + 1;\r\n                  const isCurrentMonth = dayNumber > 0 && dayNumber <= new Date(value.getFullYear(), value.getMonth() + 1, 0).getDate();\r\n                  const isSelected = parseInt(inputs.day) === dayNumber;\r\n                  \r\n                  return (\r\n                    <Pressable\r\n                      key={`day-${dayIndex}`}\r\n                      style={[\r\n                        styles.calendarDay,\r\n                        isSelected && styles.selectedDay,\r\n                        !isCurrentMonth && styles.disabledDay\r\n                      ]}\r\n                      onPress={() => isCurrentMonth && handleDaySelect(dayNumber)}\r\n                    >\r\n                      {isCurrentMonth && (\r\n                        <Text style={[\r\n                          styles.calendarDayText,\r\n                          isSelected && styles.selectedDayText\r\n                        ]}>\r\n                          {dayNumber}\r\n                        </Text>\r\n                      )}\r\n                    </Pressable>\r\n                  );\r\n                })}\r\n              </View>\r\n            ))}\r\n          </View>\r\n        )}\r\n\r\n        {showTimeSelector && !disabled && (\r\n          <View style={styles.timeSelector}>\r\n            <View style={styles.timeSelectorColumn}>\r\n              <Text style={styles.timeSelectorLabel}>Hour</Text>\r\n              <ScrollView style={styles.timeSelectorScroll}>\r\n                {Array.from({ length: isMilitary ? 24 : 12 }, (_, i) => (\r\n                  <Pressable\r\n                    key={i}\r\n                    style={[\r\n                      styles.timeSelectorItem,\r\n                      parseInt(inputs.hours) === (isMilitary ? i : i + 1) && styles.selectedTime\r\n                    ]}\r\n                    onPress={() => {\r\n                      handleInputChange('hours', String(isMilitary ? i : i + 1).padStart(2, '0'));\r\n                    }}\r\n                  >\r\n                    <Text style={[\r\n                      styles.timeSelectorText,\r\n                      parseInt(inputs.hours) === (isMilitary ? i : i + 1) && styles.selectedTimeText\r\n                    ]}>\r\n                      {String(isMilitary ? i : i + 1).padStart(2, '0')}\r\n                    </Text>\r\n                  </Pressable>\r\n                ))}\r\n              </ScrollView>\r\n            </View>\r\n\r\n            <View style={styles.timeSelectorColumn}>\r\n              <Text style={styles.timeSelectorLabel}>Minute</Text>\r\n              <ScrollView style={styles.timeSelectorScroll}>\r\n                {Array.from({ length: 60 }, (_, i) => (\r\n                  <Pressable\r\n                    key={i}\r\n                    style={[\r\n                      styles.timeSelectorItem,\r\n                      parseInt(inputs.minutes) === i && styles.selectedTime\r\n                    ]}\r\n                    onPress={() => handleInputChange('minutes', String(i).padStart(2, '0'))}\r\n                  >\r\n                    <Text style={[\r\n                      styles.timeSelectorText,\r\n                      parseInt(inputs.minutes) === i && styles.selectedTimeText\r\n                    ]}>\r\n                      {String(i).padStart(2, '0')}\r\n                    </Text>\r\n                  </Pressable>\r\n                ))}\r\n              </ScrollView>\r\n            </View>\r\n\r\n            {!isMilitary && (\r\n              <View style={styles.timeSelectorColumn}>\r\n                <Text style={styles.timeSelectorLabel}>Period</Text>\r\n                <View style={styles.periodContainer}>\r\n                  <Pressable\r\n                    style={[\r\n                      styles.timeSelectorItem,\r\n                      inputs.period === 'AM' && styles.selectedTime\r\n                    ]}\r\n                    onPress={() => handleInputChange('period', 'AM')}\r\n                  >\r\n                    <Text style={[\r\n                      styles.timeSelectorText,\r\n                      inputs.period === 'AM' && styles.selectedTimeText\r\n                    ]}>\r\n                      AM\r\n                    </Text>\r\n                  </Pressable>\r\n                  <Pressable\r\n                    style={[\r\n                      styles.timeSelectorItem,\r\n                      inputs.period === 'PM' && styles.selectedTime\r\n                    ]}\r\n                    onPress={() => handleInputChange('period', 'PM')}\r\n                  >\r\n                    <Text style={[\r\n                      styles.timeSelectorText,\r\n                      inputs.period === 'PM' && styles.selectedTimeText\r\n                    ]}>\r\n                      PM\r\n                    </Text>\r\n                  </Pressable>\r\n                </View>\r\n              </View>\r\n            )}\r\n          </View>\r\n        )}\r\n      </Animated.View>\r\n\r\n      {error && <Text style={styles.errorText}>{error}</Text>}\r\n    </View>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    position: 'relative',\r\n  },\r\n  dateTimeContainer: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    backgroundColor: theme.colors.background,\r\n    borderRadius: 8,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    paddingHorizontal: 12,\r\n    height: 40,\r\n    width: '100%',\r\n    justifyContent: 'space-between',\r\n  },\r\n  dateInputGroup: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    paddingHorizontal: 4,\r\n  },\r\n  timeInputGroup: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    paddingHorizontal: 4,\r\n  },\r\n  numberInput: {\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.text,\r\n    width: 24,\r\n    textAlign: 'center',\r\n    padding: 0,\r\n  },\r\n  yearInput: {\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.text,\r\n    width: 42,\r\n    textAlign: 'center',\r\n    padding: 0,\r\n  },\r\n  separator: {\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.text,\r\n    marginHorizontal: 2,\r\n  },\r\n  divider: {\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.border,\r\n    marginHorizontal: 8,\r\n  },\r\n  periodButton: {\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 4,\r\n    paddingHorizontal: 8,\r\n    paddingVertical: 4,\r\n    marginLeft: 8,\r\n  },\r\n  periodText: {\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.text,\r\n    fontWeight: '500',\r\n  },\r\n  errorBorder: {\r\n    borderColor: theme.colors.error,\r\n  },\r\n  errorText: {\r\n    color: theme.colors.error,\r\n    fontSize: theme.fontSizes.small,\r\n    marginTop: 4,\r\n  },\r\n  disabled: {\r\n    backgroundColor: theme.colors.disabled,\r\n    opacity: 0.7,\r\n  },\r\n  icon: {\r\n    marginLeft: 8,\r\n  },\r\n  pickerContainer: {\r\n    position: 'absolute',\r\n    top: '100%',\r\n    left: 0,\r\n    right: 0,\r\n    zIndex: 1000,\r\n  },\r\n  calendar: {\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 8,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    marginTop: 4,\r\n    padding: 12,\r\n    elevation: 5,\r\n    shadowColor: '#000',\r\n    shadowOffset: { width: 0, height: 2 },\r\n    shadowOpacity: 0.25,\r\n    shadowRadius: 3.84,\r\n  },\r\n  calendarHeader: {\r\n    alignItems: 'center',\r\n    marginBottom: 12,\r\n  },\r\n  calendarHeaderText: {\r\n    fontSize: theme.fontSizes.medium,\r\n    fontWeight: '500',\r\n  },\r\n  calendarWeekDays: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-around',\r\n    marginBottom: 8,\r\n  },\r\n  calendarWeekDay: {\r\n    width: 36,\r\n    textAlign: 'center',\r\n    fontSize: theme.fontSizes.small,\r\n    color: theme.colors.placeholder,\r\n  },\r\n  calendarWeek: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-around',\r\n    marginBottom: 4,\r\n  },\r\n  calendarDay: {\r\n    width: 36,\r\n    height: 36,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    borderRadius: 18,\r\n  },\r\n  calendarDayText: {\r\n    fontSize: theme.fontSizes.medium,\r\n  },\r\n  selectedDay: {\r\n    backgroundColor: theme.colors.primary,\r\n  },\r\n  selectedDayText: {\r\n    color: theme.colors.surface,\r\n  },\r\n  timeSelector: {\r\n    flexDirection: 'row',\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 8,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    marginTop: 4,\r\n    padding: 12,\r\n    gap: 12,\r\n    elevation: 5,\r\n    shadowColor: '#000',\r\n    shadowOffset: { width: 0, height: 2 },\r\n    shadowOpacity: 0.25,\r\n    shadowRadius: 3.84,\r\n  },\r\n  timeSelectorColumn: {\r\n    flex: 1,\r\n    alignItems: 'center',\r\n  },\r\n  timeSelectorLabel: {\r\n    fontSize: theme.fontSizes.small,\r\n    color: theme.colors.placeholder,\r\n    marginBottom: 8,\r\n  },\r\n  timeSelectorScroll: {\r\n    height: 200,\r\n    width: '100%',\r\n  },\r\n  timeSelectorItem: {\r\n    padding: 12,\r\n    alignItems: 'center',\r\n    borderRadius: 4,\r\n    width: '100%',\r\n  },\r\n  timeSelectorText: {\r\n    fontSize: theme.fontSizes.medium,\r\n  },\r\n  selectedTime: {\r\n    backgroundColor: theme.colors.primary,\r\n  },\r\n  selectedTimeText: {\r\n    color: theme.colors.surface,\r\n  },\r\n  periodContainer: {\r\n    width: '100%',\r\n  },\r\n  disabledDay: {\r\n    opacity: 0.3,\r\n  },\r\n});\r\n\r\nexport default DateTimePicker; ","/**\r\n * Validates that the end date/time is not before the start date/time\r\n * @param {string} startDate - Start date in ISO format\r\n * @param {string} endDate - End date in ISO format (optional)\r\n * @param {string} startTime - Start time in HH:mm format\r\n * @param {string} endTime - End time in HH:mm format\r\n * @returns {Object} - { isValid: boolean, error: string | null }\r\n */\r\nexport const validateDateTimeRange = (startDate, endDate, startTime, endTime) => {\r\n  // Convert dates and times to comparable format\r\n  const [startHour, startMinute] = startTime.split(':').map(Number);\r\n  const [endHour, endMinute] = endTime.split(':').map(Number);\r\n  \r\n  const startDateTime = new Date(startDate);\r\n  startDateTime.setHours(startHour, startMinute, 0);\r\n  \r\n  let endDateTime;\r\n  if (endDate) {\r\n    endDateTime = new Date(endDate);\r\n    endDateTime.setHours(endHour, endMinute, 0);\r\n  } else {\r\n    // If no end date, use start date\r\n    endDateTime = new Date(startDate);\r\n    endDateTime.setHours(endHour, endMinute, 0);\r\n  }\r\n\r\n  if (endDateTime < startDateTime) {\r\n    return {\r\n      isValid: false,\r\n      error: 'End date/time cannot be before start date/time'\r\n    };\r\n  }\r\n\r\n  return {\r\n    isValid: true,\r\n    error: null\r\n  };\r\n}; ","import React, { useState, useEffect, useContext, useRef, useCallback } from 'react';\r\nimport { View, Text, Modal, TextInput, TouchableOpacity, StyleSheet, ScrollView, Picker, ActivityIndicator, Platform, Animated, Alert } from 'react-native';\r\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\r\nimport { theme } from '../styles/theme';\r\nimport DateTimePicker from './DateTimePicker';\r\nimport { AuthContext } from '../context/AuthContext'\r\nimport { format, parse } from 'date-fns';\r\nimport { TIME_OPTIONS } from '../data/mockData';\r\nimport { validateDateTimeRange } from '../utils/dateTimeValidation';\r\nimport { Button } from 'react-native-paper';\r\nimport { API_BASE_URL } from '../config/config';\r\nimport ConfirmationModal from './ConfirmationModal';\r\nimport { getStorage } from '../context/AuthContext';\r\nimport { debounce } from 'lodash';\r\nimport { calculateOccurrenceCost } from '../data/calculations';\r\n\r\nconst ANIMAL_COUNT_OPTIONS = ['1', '2', '3', '4', '5'];\r\n\r\nconst WebScrollStyles = `\r\n  .modal-scroll-container {\r\n    max-height: 60vh;\r\n    overflow-y: scroll !important;\r\n    padding-right: 16px;\r\n    display: block;\r\n    position: relative;\r\n    scrollbar-width: auto;\r\n    scrollbar-color: rgba(0, 0, 0, 0.5) rgba(0, 0, 0, 0.1);\r\n  }\r\n\r\n  .modal-scroll-container::-webkit-scrollbar {\r\n    width: 10px;\r\n    background-color: #F5F5F5;\r\n    display: block;\r\n  }\r\n\r\n  .modal-scroll-container::-webkit-scrollbar-track {\r\n    border-radius: 10px;\r\n    background: rgba(0, 0, 0, 0.1);\r\n    border: 1px solid #ccc;\r\n  }\r\n\r\n  .modal-scroll-container::-webkit-scrollbar-thumb {\r\n    border-radius: 10px;\r\n    background: rgba(0, 0, 0, 0.5);\r\n    border: 1px solid #aaa;\r\n  }\r\n\r\n  .modal-scroll-container::-webkit-scrollbar-thumb:hover {\r\n    background: rgba(0, 0, 0, 0.7);\r\n  }\r\n`;\r\n\r\nconst ScrollableContent = ({ children }) => {\r\n  if (Platform.OS === 'web') {\r\n    return (\r\n      <>\r\n        <style>{WebScrollStyles}</style>\r\n        <div className=\"modal-scroll-container\">\r\n          {children}\r\n        </div>\r\n      </>\r\n    );\r\n  }\r\n  \r\n  return (\r\n    <ScrollView showsVerticalScrollIndicator={true} persistentScrollbar={true}>\r\n      {children}\r\n    </ScrollView>\r\n  );\r\n};\r\n\r\nconst AddOccurrenceModal = ({ \r\n  visible, \r\n  onClose, \r\n  onAdd, \r\n  defaultRates, \r\n  hideRates = false,\r\n  initialOccurrence = null,\r\n  isEditing = false,\r\n  modalTitle = 'Add New Occurrence',\r\n  isFromRequestBooking = false,\r\n  booking\r\n}) => {\r\n  const { is_DEBUG, screenWidth, timeSettings } = useContext(AuthContext);\r\n  const [showDeleteConfirmation, setShowDeleteConfirmation] = useState(false);\r\n  const [isAnyPickerActive, setIsAnyPickerActive] = useState(false);\r\n  const heightAnim = useRef(new Animated.Value(0)).current;\r\n  const [validationError, setValidationError] = useState(null);\r\n  const initialValues = useRef(null);\r\n  const [isCalculatingCost, setIsCalculatingCost] = useState(false);\r\n\r\n  const parseInitialDates = (initialOccurrence) => {\r\n    if (is_DEBUG) {\r\n      console.log('MBA1234 Parsing initial occurrence:', initialOccurrence);\r\n      console.log('MBA1234 Time settings:', timeSettings);\r\n    }\r\n\r\n    if (!initialOccurrence) {\r\n      const now = new Date();\r\n      const oneHourLater = new Date(now.getTime() + 60 * 60 * 1000);\r\n      return {\r\n        startDateTime: now,\r\n        endDateTime: oneHourLater,\r\n        isMilitary: timeSettings.use_military_time\r\n      };\r\n    }\r\n\r\n    try {\r\n      const { startDate, startTime, endDate, endTime } = initialOccurrence;\r\n      \r\n      // Use the user's time format preference from settings \r\n      const isMilitary = timeSettings.use_military_time;\r\n      \r\n      if (is_DEBUG) {\r\n        console.log('MBA1234 Time format detection:', {\r\n          startTime,\r\n          endTime,\r\n          isMilitary,\r\n          timeSettings\r\n        });\r\n      }\r\n\r\n      // Parse the date and time strings based on format\r\n      let startDateTime, endDateTime;\r\n      \r\n      if (isMilitary) {\r\n        startDateTime = parse(\r\n          `${startDate} ${startTime}`,\r\n          'yyyy-MM-dd HH:mm',\r\n          new Date()\r\n        );\r\n        endDateTime = parse(\r\n          `${endDate} ${endTime}`,\r\n          'yyyy-MM-dd HH:mm',\r\n          new Date()\r\n        );\r\n      } else {\r\n        startDateTime = parse(\r\n          `${startDate} ${startTime}`,\r\n          'yyyy-MM-dd hh:mm aa',\r\n          new Date()\r\n        );\r\n        endDateTime = parse(\r\n          `${endDate} ${endTime}`,\r\n          'yyyy-MM-dd hh:mm aa',\r\n          new Date()\r\n        );\r\n      }\r\n\r\n      if (is_DEBUG) {\r\n        console.log('MBA1234 Parsed dates:', {\r\n          startDateTime: startDateTime.toISOString(),\r\n          endDateTime: endDateTime.toISOString(),\r\n          isMilitary\r\n        });\r\n      }\r\n\r\n      return {\r\n        startDateTime,\r\n        endDateTime,\r\n        isMilitary\r\n      };\r\n    } catch (error) {\r\n      console.error('MBA1234 Error parsing dates:', error);\r\n      const now = new Date();\r\n      const oneHourLater = new Date(now.getTime() + 60 * 60 * 1000);\r\n      return {\r\n        startDateTime: now,\r\n        endDateTime: oneHourLater,\r\n        isMilitary: timeSettings.use_military_time\r\n      };\r\n    }\r\n  };\r\n\r\n  const initialDates = parseInitialDates(initialOccurrence);\r\n  \r\n  if (is_DEBUG) {\r\n    console.log('MBA565656 AddOccurrenceModal initializing with:', {\r\n      defaultRates,\r\n      initialOccurrence,\r\n      initialDates\r\n    });\r\n  }\r\n\r\n  const [occurrence, setOccurrence] = useState(() => {\r\n    const initialState = {\r\n      startDateTime: initialDates.startDateTime,\r\n      endDateTime: initialDates.endDateTime,\r\n      isMilitary: timeSettings.use_military_time,\r\n      rates: {\r\n        baseRate: '0',\r\n        additionalAnimalRate: '0',\r\n        appliesAfterAnimals: '1',\r\n        holidayRate: '0',\r\n        unit_of_time: 'Per Visit',\r\n        additionalRates: []\r\n      },\r\n      calculatedCost: '0'\r\n    };\r\n\r\n    // If we have an initial occurrence, use its rates\r\n    if (initialOccurrence?.rates) {\r\n      initialState.rates = initialOccurrence.rates;\r\n      initialState.calculatedCost = initialOccurrence.calculatedCost || '0';\r\n    }\r\n    // Otherwise if we have default rates, use those\r\n    else if (defaultRates) {\r\n      initialState.rates = {\r\n        baseRate: defaultRates.base_rate?.toString() || '0',\r\n        additionalAnimalRate: defaultRates.additional_animal_rate?.toString() || '0',\r\n        appliesAfterAnimals: defaultRates.applies_after?.toString() || '1',\r\n        holidayRate: defaultRates.holiday_rate?.toString() || '0',\r\n        unit_of_time: defaultRates.unit_of_time || 'Per Visit',\r\n        additionalRates: defaultRates.additional_rates?.map(rate => ({\r\n          name: rate.title,\r\n          description: rate.description || '',\r\n          amount: rate.amount\r\n        })) || []\r\n      };\r\n      initialState.calculatedCost = defaultRates.calculated_cost?.toString() || '0';\r\n    }\r\n\r\n    if (is_DEBUG) {\r\n      console.log('MBA565656 Initial state calculated:', initialState);\r\n    }\r\n\r\n    return initialState;\r\n  });\r\n\r\n  const [unit_of_time, setUnitOfTime] = useState(\r\n    initialOccurrence?.rates?.unit_of_time || \r\n    defaultRates?.unit_of_time || \r\n    'Per Visit'\r\n  );\r\n\r\n  // Clear validation error and set initial values when modal becomes visible\r\n  useEffect(() => {\r\n    if (visible) {\r\n      setValidationError(null);\r\n      // Store initial values when modal opens, including dates\r\n      initialValues.current = {\r\n        baseRate: occurrence.rates.baseRate,\r\n        additionalAnimalRate: occurrence.rates.additionalAnimalRate,\r\n        holidayRate: occurrence.rates.holidayRate,\r\n        unit_of_time: occurrence.rates.unit_of_time,\r\n        additionalRates: [...occurrence.rates.additionalRates],\r\n        startDateTime: new Date(occurrence.startDateTime),\r\n        endDateTime: new Date(occurrence.endDateTime)\r\n      };\r\n      if (is_DEBUG) {\r\n        console.log('MBA565656 Setting initial values:', initialValues.current);\r\n      }\r\n    }\r\n  }, [visible]); // Only depend on visible prop\r\n\r\n  const handlePickerStateChange = (isActive) => {\r\n    setIsAnyPickerActive(isActive);\r\n    if (is_DEBUG) {\r\n      console.log('MBA5678 Picker state changed:', {\r\n        isActive,\r\n        isFromRequestBooking,\r\n        currentModalHeight: isActive && isFromRequestBooking ? '65vh' : '80%'\r\n      });\r\n    }\r\n\r\n    // Animate to new height\r\n    Animated.timing(heightAnim, {\r\n      toValue: isActive && isFromRequestBooking ? 1 : 0,\r\n      duration: 300,\r\n      useNativeDriver: false,\r\n    }).start();\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (is_DEBUG) {\r\n      console.log('MBA5678 Modal state:', {\r\n        isFromRequestBooking,\r\n        isAnyPickerActive,\r\n        visible\r\n      });\r\n    }\r\n  }, [isFromRequestBooking, isAnyPickerActive, visible]);\r\n\r\n  // Add effect to update rates when defaultRates changes\r\n  useEffect(() => {\r\n    if (!initialOccurrence && defaultRates) {\r\n      if (is_DEBUG) {\r\n        console.log('MBA565656 Updating rates from defaultRates:', {\r\n          defaultRates,\r\n          currentRates: occurrence.rates\r\n        });\r\n      }\r\n\r\n      const newRates = {\r\n        baseRate: defaultRates.base_rate?.toString() || '0',\r\n        additionalAnimalRate: defaultRates.additional_animal_rate?.toString() || '0',\r\n        appliesAfterAnimals: defaultRates.applies_after?.toString() || '1',\r\n        holidayRate: defaultRates.holiday_rate?.toString() || '0',\r\n        unit_of_time: defaultRates.unit_of_time || 'Per Visit',\r\n        additionalRates: defaultRates.additional_rates?.map(rate => ({\r\n          name: rate.title,\r\n          description: rate.description || '',\r\n          amount: rate.amount\r\n        })) || []\r\n      };\r\n\r\n      if (is_DEBUG) {\r\n        console.log('MBA565656 Setting new rates:', newRates);\r\n        console.log('MBA565656 Setting calculated cost:', defaultRates.calculated_cost);\r\n      }\r\n\r\n      setOccurrence(prev => {\r\n        const updated = {\r\n          ...prev,\r\n          rates: newRates,\r\n          calculatedCost: defaultRates.calculated_cost?.toString() || '0'\r\n        };\r\n        if (is_DEBUG) {\r\n          console.log('MBA565656 Updated occurrence state:', updated);\r\n        }\r\n        return updated;\r\n      });\r\n      \r\n      setUnitOfTime(defaultRates.unit_of_time || 'Per Visit');\r\n    }\r\n  }, [defaultRates, initialOccurrence]);\r\n\r\n  // Replace the debounced API call with frontend calculation\r\n  const debouncedCalculateCosts = useCallback(\r\n    debounce((occurrenceData) => {\r\n      if (!booking?.booking_id) return;\r\n\r\n      try {\r\n        setIsCalculatingCost(true);\r\n        \r\n        // Calculate cost using frontend function\r\n        const result = calculateOccurrenceCost(occurrenceData, booking.pets?.length || 0);\r\n\r\n        if (is_DEBUG) {\r\n          console.log('MBA565656 Cost calculation result:', result);\r\n        }\r\n\r\n        setOccurrence(prev => ({\r\n          ...prev,\r\n          calculatedCost: result.total_cost.toFixed(2)\r\n        }));\r\n      } catch (error) {\r\n        if (is_DEBUG) {\r\n          console.error('MBA565656 Error calculating costs:', error);\r\n        }\r\n      } finally {\r\n        setIsCalculatingCost(false);\r\n      }\r\n    }, 500),\r\n    [booking?.booking_id, booking?.pets?.length]\r\n  );\r\n\r\n  // Update the cost calculation effect\r\n  useEffect(() => {\r\n    // Only calculate costs if:\r\n    // 1. Modal is visible\r\n    // 2. We have initial values set\r\n    // 3. Have a valid booking ID\r\n    // 4. User has made actual changes to the form\r\n    if (visible && initialValues.current && booking?.booking_id) {\r\n      if (is_DEBUG) {\r\n        console.log('MBA565656 Checking for changes:', {\r\n          current: {\r\n            rates: occurrence.rates,\r\n            startDateTime: occurrence.startDateTime.toISOString(),\r\n            endDateTime: occurrence.endDateTime.toISOString()\r\n          },\r\n          initial: {\r\n            rates: initialValues.current,\r\n            startDateTime: initialValues.current.startDateTime.toISOString(),\r\n            endDateTime: initialValues.current.endDateTime.toISOString()\r\n          }\r\n        });\r\n      }\r\n\r\n      // Track if any changes were made that require recalculation\r\n      const timeDiffs = {\r\n        start: Math.abs(occurrence.startDateTime.getTime() - initialValues.current.startDateTime.getTime()),\r\n        end: Math.abs(occurrence.endDateTime.getTime() - initialValues.current.endDateTime.getTime())\r\n      };\r\n\r\n      const rateChanges = {\r\n        baseRate: occurrence.rates.baseRate !== initialValues.current.baseRate,\r\n        additionalAnimalRate: occurrence.rates.additionalAnimalRate !== initialValues.current.additionalAnimalRate,\r\n        holidayRate: occurrence.rates.holidayRate !== initialValues.current.holidayRate,\r\n        unit_of_time: occurrence.rates.unit_of_time !== initialValues.current.unit_of_time,\r\n        additionalRatesLength: occurrence.rates.additionalRates.length !== initialValues.current.additionalRates.length\r\n      };\r\n\r\n      const hasChanges = \r\n        rateChanges.baseRate ||\r\n        rateChanges.additionalAnimalRate ||\r\n        rateChanges.holidayRate ||\r\n        rateChanges.unit_of_time ||\r\n        rateChanges.additionalRatesLength ||\r\n        timeDiffs.start >= 1000 ||\r\n        timeDiffs.end >= 1000;\r\n\r\n      if (is_DEBUG) {\r\n        console.log('MBA565656 Change detection details:', {\r\n          timeDiffs,\r\n          rateChanges,\r\n          hasChanges\r\n        });\r\n      }\r\n\r\n      if (hasChanges) {\r\n        if (is_DEBUG) {\r\n          console.log('MBA565656 Changes detected, calculating costs:', {\r\n            current: {\r\n              rates: occurrence.rates,\r\n              startDateTime: occurrence.startDateTime.toISOString(),\r\n              endDateTime: occurrence.endDateTime.toISOString()\r\n            },\r\n            initial: {\r\n              rates: initialValues.current,\r\n              startDateTime: initialValues.current.startDateTime.toISOString(),\r\n              endDateTime: initialValues.current.endDateTime.toISOString()\r\n            },\r\n            timeDiffs,\r\n            rateChanges\r\n          });\r\n        }\r\n\r\n        const occurrenceData = {\r\n          start_date: format(occurrence.startDateTime, 'yyyy-MM-dd'),\r\n          end_date: format(occurrence.endDateTime, 'yyyy-MM-dd'),\r\n          start_time: format(occurrence.startDateTime, 'HH:mm'),\r\n          end_time: format(occurrence.endDateTime, 'HH:mm'),\r\n          rates: {\r\n            base_rate: occurrence.rates.baseRate,\r\n            additional_animal_rate: occurrence.rates.additionalAnimalRate,\r\n            applies_after: occurrence.rates.appliesAfterAnimals,\r\n            holiday_rate: occurrence.rates.holidayRate,\r\n            unit_of_time: occurrence.rates.unit_of_time,\r\n            additional_rates: occurrence.rates.additionalRates\r\n          }\r\n        };\r\n\r\n        if (is_DEBUG) {\r\n          console.log('MBA565656 Calling debouncedCalculateCosts with:', occurrenceData);\r\n        }\r\n\r\n        debouncedCalculateCosts(occurrenceData);\r\n      } else {\r\n        if (is_DEBUG) {\r\n          console.log('MBA565656 No changes detected, skipping calculation');\r\n        }\r\n      }\r\n    } else {\r\n      if (is_DEBUG) {\r\n        console.log('MBA565656 Skipping cost calculation:', {\r\n          visible,\r\n          hasInitialValues: !!initialValues.current,\r\n          hasBookingId: !!booking?.booking_id\r\n        });\r\n      }\r\n    }\r\n\r\n    // Cleanup function\r\n    return () => {\r\n      debouncedCalculateCosts.cancel();\r\n    };\r\n  }, [\r\n    visible,\r\n    occurrence.startDateTime,\r\n    occurrence.endDateTime,\r\n    occurrence.rates.baseRate,\r\n    occurrence.rates.additionalAnimalRate,\r\n    occurrence.rates.appliesAfterAnimals,\r\n    occurrence.rates.holidayRate,\r\n    occurrence.rates.unit_of_time,\r\n    occurrence.rates.additionalRates,\r\n    debouncedCalculateCosts,\r\n    booking?.booking_id\r\n  ]);\r\n\r\n  // Add effect to update unit_of_time when rates change\r\n  useEffect(() => {\r\n    if (is_DEBUG) {\r\n      console.log('MBA565656 Rates changed:', occurrence.rates);\r\n    }\r\n    setUnitOfTime(occurrence.rates.unit_of_time);\r\n  }, [occurrence.rates]);\r\n\r\n  // Add effect to log when modal becomes visible\r\n  useEffect(() => {\r\n    if (visible) {\r\n      if (is_DEBUG) {\r\n        console.log('MBA565656 Modal became visible:', {\r\n          defaultRates,\r\n          initialOccurrence,\r\n          currentRates: occurrence.rates\r\n        });\r\n      }\r\n    }\r\n  }, [visible]);\r\n\r\n  // Add effect to update military time preference when timeSettings changes\r\n  useEffect(() => {\r\n    if (is_DEBUG) {\r\n      console.log('MBA4321 Time settings changed:', timeSettings);\r\n    }\r\n    setOccurrence(prev => ({\r\n      ...prev,\r\n      isMilitary: timeSettings.use_military_time\r\n    }));\r\n  }, [timeSettings]);\r\n\r\n  // Add effect to update dates when initialOccurrence changes\r\n  useEffect(() => {\r\n    if (initialOccurrence) {\r\n      if (is_DEBUG) {\r\n        console.log('MBA4321 Initial occurrence rates:', initialOccurrence.rates);\r\n        console.log('MBA4321 Initial unit_of_time:', initialOccurrence.rates?.unit_of_time);\r\n      }\r\n      const dates = parseInitialDates(initialOccurrence);\r\n      // Use unit_of_time directly from the rates object without any transformation\r\n      const unit_of_time = initialOccurrence.rates?.unit_of_time;\r\n      if (is_DEBUG) {\r\n        console.log('MBA4321 Setting unit_of_time to:', unit_of_time);\r\n      }\r\n      setOccurrence(prev => ({\r\n        ...prev,\r\n        startDateTime: dates.startDateTime,\r\n        endDateTime: dates.endDateTime,\r\n        isMilitary: dates.isMilitary,\r\n        rates: {\r\n          ...initialOccurrence.rates,\r\n          unit_of_time: unit_of_time\r\n        }\r\n      }));\r\n      setUnitOfTime(unit_of_time);\r\n    }\r\n  }, [initialOccurrence]);\r\n\r\n  const handleStartDateTimeChange = (date) => {\r\n    if (is_DEBUG) {\r\n      console.log('MBA1234 Start datetime changed:', {\r\n        newDate: date?.toISOString(),\r\n        currentInitialValues: initialValues.current,\r\n        currentOccurrence: {\r\n          startDateTime: occurrence.startDateTime.toISOString(),\r\n          endDateTime: occurrence.endDateTime.toISOString()\r\n        }\r\n      });\r\n    }\r\n    if (date && !isNaN(date.getTime())) {\r\n      setOccurrence(prev => {\r\n        const updated = {\r\n          ...prev,\r\n          startDateTime: date\r\n        };\r\n        if (is_DEBUG) {\r\n          console.log('MBA1234 Updated occurrence:', {\r\n            startDateTime: updated.startDateTime.toISOString(),\r\n            endDateTime: updated.endDateTime.toISOString()\r\n          });\r\n        }\r\n        return updated;\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleEndDateTimeChange = (date) => {\r\n    if (is_DEBUG) {\r\n      console.log('MBA1234 End datetime changed:', {\r\n        newDate: date?.toISOString(),\r\n        currentInitialValues: initialValues.current,\r\n        currentOccurrence: {\r\n          startDateTime: occurrence.startDateTime.toISOString(),\r\n          endDateTime: occurrence.endDateTime.toISOString()\r\n        }\r\n      });\r\n    }\r\n    if (date && !isNaN(date.getTime())) {\r\n      setOccurrence(prev => {\r\n        const updated = {\r\n          ...prev,\r\n          endDateTime: date\r\n        };\r\n        if (is_DEBUG) {\r\n          console.log('MBA1234 Updated occurrence:', {\r\n            startDateTime: updated.startDateTime.toISOString(),\r\n            endDateTime: updated.endDateTime.toISOString()\r\n          });\r\n        }\r\n        return updated;\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleAdd = async () => {\r\n    try {\r\n      // Format dates in UTC for backend\r\n      const startDate = format(occurrence.startDateTime, 'yyyy-MM-dd');\r\n      const startTime = format(occurrence.startDateTime, 'HH:mm');\r\n      const endDate = format(occurrence.endDateTime, 'yyyy-MM-dd');\r\n      const endTime = format(occurrence.endDateTime, 'HH:mm');\r\n\r\n      if (is_DEBUG) {\r\n        console.log('MBA1234 Adding occurrence:', {\r\n          startDate,\r\n          startTime,\r\n          endDate,\r\n          endTime,\r\n          startDateTime: occurrence.startDateTime.toISOString(),\r\n          endDateTime: occurrence.endDateTime.toISOString()\r\n        });\r\n      }\r\n\r\n      const response = await onAdd({\r\n        startDate,\r\n        startTime,\r\n        endDate,\r\n        endTime,\r\n        rates: occurrence.rates\r\n      });\r\n\r\n      if (is_DEBUG) {\r\n        console.log('MBA1234 Response from onAdd:', response);\r\n      }\r\n\r\n      if (response?.status === 'success') {\r\n        if (is_DEBUG) {\r\n          console.log('MBA1234 Successfully added/updated occurrence');\r\n        }\r\n        resetForm();\r\n        onClose();\r\n        // Show success message using Alert\r\n        Alert.alert('Success', response.message);\r\n      } else {\r\n        // Show error message but don't close modal\r\n        setValidationError(response?.message || 'Failed to add event');\r\n      }\r\n    } catch (error) {\r\n      if (is_DEBUG) {\r\n        console.error('MBA1234 Error adding occurrence:', error);\r\n      }\r\n      setValidationError(error.message || 'An unexpected error occurred');\r\n    }\r\n  };\r\n\r\n  const [showAddRate, setShowAddRate] = useState(false);\r\n  const [newRate, setNewRate] = useState({ name: '', amount: '' });\r\n  \r\n  useEffect(() => {\r\n    if (is_DEBUG) {\r\n      console.log('MBA1234 Initial occurrence:', initialOccurrence);\r\n      console.log('MBA1234 Unit of time set to:', unit_of_time);\r\n    }\r\n  }, [unit_of_time, initialOccurrence]);\r\n\r\n  // Update occurrence when unit_of_time changes\r\n  useEffect(() => {\r\n    if (is_DEBUG) {\r\n      console.log('MBA4321 Unit of time changed:', {\r\n        newUnitOfTime: unit_of_time,\r\n        occurrenceRatesUnitOfTime: occurrence.rates.unit_of_time\r\n      });\r\n    }\r\n    setOccurrence(prev => ({\r\n      ...prev,\r\n      rates: {\r\n        ...prev.rates,\r\n        unit_of_time: unit_of_time\r\n      }\r\n    }));\r\n  }, [unit_of_time]);\r\n\r\n  const handleDeleteRate = (index) => {\r\n    setOccurrence(prev => ({\r\n      ...prev,\r\n      rates: {\r\n        ...prev.rates,\r\n        additionalRates: prev.rates.additionalRates.filter((_, i) => i !== index)\r\n      }\r\n    }));\r\n  };\r\n\r\n  const handleClose = () => {\r\n    resetForm();\r\n    onClose();\r\n  };\r\n\r\n  const handleSubmit = () => {\r\n    // Validate the date/time range\r\n    const validation = validateDateTimeRange(\r\n      format(occurrence.startDateTime, 'yyyy-MM-dd'),\r\n      format(occurrence.endDateTime, 'yyyy-MM-dd'),\r\n      format(occurrence.startDateTime, 'HH:mm'),\r\n      format(occurrence.endDateTime, 'HH:mm')\r\n    );\r\n\r\n    if (!validation.isValid) {\r\n      setValidationError(validation.error);\r\n      return;\r\n    }\r\n\r\n    setValidationError(null);\r\n    handleAdd();\r\n  };\r\n\r\n  const resetForm = () => {\r\n    setOccurrence({\r\n      startDateTime: new Date(),\r\n      endDateTime: new Date(new Date().setHours(new Date().getHours() + 1)),\r\n      isMilitary: timeSettings.use_military_time,\r\n      rates: {\r\n        baseRate: defaultRates?.base_rate?.toString() || '0',\r\n        additionalAnimalRate: defaultRates?.additional_animal_rate?.toString() || '0',\r\n        appliesAfterAnimals: defaultRates?.applies_after?.toString() || '1',\r\n        holidayRate: defaultRates?.holiday_rate?.toString() || '0',\r\n        unit_of_time: defaultRates?.unit_of_time || 'Per Visit',\r\n        additionalRates: defaultRates?.additional_rates?.map(rate => ({\r\n          name: rate.title,\r\n          description: rate.description || '',\r\n          amount: rate.amount\r\n        })) || []\r\n      },\r\n      calculatedCost: '0'\r\n    });\r\n    setUnitOfTime(defaultRates?.unit_of_time || 'Per Visit');\r\n    setShowAddRate(false);\r\n    setNewRate({ name: '', amount: '' });\r\n  };\r\n\r\n  const renderPickerItems = (options) => {\r\n    return options.map((option) => (\r\n      <Picker.Item \r\n        key={option} \r\n        label={option} \r\n        value={option}\r\n        style={styles.pickerItem}\r\n      />\r\n    ));\r\n  };\r\n\r\n  const handleDeleteClick = () => {\r\n    setShowDeleteConfirmation(true);\r\n  };\r\n\r\n  const handleDeleteConfirm = () => {\r\n    setShowDeleteConfirmation(false);\r\n    handleClose();\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Modal\r\n        visible={visible}\r\n        onRequestClose={handleClose}\r\n        animationType=\"slide\"\r\n        transparent={true}\r\n      >\r\n        <View style={styles.modalContainer}>\r\n          <Animated.View style={[\r\n            styles.modalContent,\r\n            isFromRequestBooking ? {\r\n              maxHeight: undefined,\r\n              height: heightAnim.interpolate({\r\n                inputRange: [0, 1],\r\n                outputRange: ['325px', '650px']\r\n              }),\r\n              transform: [{\r\n                translateY: heightAnim.interpolate({\r\n                  inputRange: [0, 1],\r\n                  outputRange: [0, -40]\r\n                })\r\n              }]\r\n            } : {\r\n              maxHeight: '80%'\r\n            }\r\n          ]}>\r\n            <View style={styles.modalHeader}>\r\n              <Text style={styles.modalTitle}>{modalTitle}</Text>\r\n              <TouchableOpacity onPress={handleClose}>\r\n                <MaterialCommunityIcons name=\"close\" size={24} color={theme.colors.text} />\r\n              </TouchableOpacity>\r\n            </View>\r\n\r\n            <ScrollView \r\n              style={styles.scrollView}\r\n              contentContainerStyle={[\r\n                styles.scrollViewContent,\r\n                isFromRequestBooking && isAnyPickerActive && { paddingBottom: 300 }\r\n              ]}\r\n            >\r\n              <View style={[styles.section, { zIndex: 10 }]}>\r\n                <Text style={styles.label}>Start Date & Time</Text>\r\n                <DateTimePicker\r\n                  value={occurrence.startDateTime}\r\n                  onChange={handleStartDateTimeChange}\r\n                  error={validationError?.startDateTime}\r\n                  isMilitary={occurrence.isMilitary}\r\n                  onPickerStateChange={handlePickerStateChange}\r\n                />\r\n              </View>\r\n\r\n              <View style={[styles.section, { zIndex: 9 }]}>\r\n                <Text style={styles.label}>End Date & Time</Text>\r\n                <DateTimePicker\r\n                  value={occurrence.endDateTime}\r\n                  onChange={handleEndDateTimeChange}\r\n                  error={validationError?.endDateTime}\r\n                  isMilitary={occurrence.isMilitary}\r\n                  onPickerStateChange={handlePickerStateChange}\r\n                />\r\n              </View>\r\n\r\n              {!hideRates && (\r\n                <>\r\n                  <View style={[styles.section, { zIndex: 8 }]}>\r\n                    <Text style={styles.label}>Base Rate</Text>\r\n                    <View style={styles.rateContainer}>\r\n                      <View style={styles.baseRateInput}>\r\n                        <TextInput\r\n                          style={styles.input}\r\n                          value={occurrence.rates.baseRate.toString()}\r\n                          onChangeText={(text) => setOccurrence(prev => ({\r\n                            ...prev,\r\n                            rates: {\r\n                              ...prev.rates,\r\n                              baseRate: text.replace(/[^0-9.]/g, '')\r\n                            }\r\n                          }))}\r\n                          keyboardType=\"decimal-pad\"\r\n                          placeholder=\"0.00\"\r\n                        />\r\n                      </View>\r\n                      <View style={styles.timeUnitInput}>\r\n                        <Text style={styles.label}>Per</Text>\r\n                        <Picker\r\n                          selectedValue={unit_of_time}\r\n                          onValueChange={(itemValue) => {\r\n                            if (is_DEBUG) {\r\n                              console.log('MBA4321 Picker value changed to:', itemValue);\r\n                            }\r\n                            setUnitOfTime(itemValue);\r\n                            setOccurrence(prev => ({\r\n                              ...prev,\r\n                              rates: {\r\n                                ...prev.rates,\r\n                                unit_of_time: itemValue\r\n                              }\r\n                            }));\r\n                          }}\r\n                          style={styles.picker}\r\n                        >\r\n                          {renderPickerItems(TIME_OPTIONS)}\r\n                        </Picker>\r\n                      </View>\r\n                    </View>\r\n                  </View>\r\n\r\n                  <View style={[styles.section, { zIndex: 7 }]}>\r\n                    <Text style={styles.label}>\r\n                      {screenWidth < 375 \r\n                        ? `+${occurrence.rates.appliesAfterAnimals} Pet Rate`\r\n                        : 'Additional Pet Rate'\r\n                      }\r\n                    </Text>\r\n                    <View style={styles.rateContainer}>\r\n                      <View style={styles.baseRateInput}>\r\n                        <TextInput\r\n                          style={styles.input}\r\n                          value={occurrence.rates.additionalAnimalRate.toString()}\r\n                          onChangeText={(text) => setOccurrence(prev => ({\r\n                            ...prev,\r\n                            rates: {\r\n                              ...prev.rates,\r\n                              additionalAnimalRate: text.replace(/[^0-9.]/g, '')\r\n                            }\r\n                          }))}\r\n                          keyboardType=\"decimal-pad\"\r\n                          placeholder=\"0.00\"\r\n                        />\r\n                      </View>\r\n                      <View style={styles.timeUnitInput}>\r\n                        <Text style={styles.label}>Applies After</Text>\r\n                        <Picker\r\n                          selectedValue={occurrence.rates.appliesAfterAnimals}\r\n                          onValueChange={(itemValue) => setOccurrence(prev => ({\r\n                            ...prev,\r\n                            rates: {\r\n                              ...prev.rates,\r\n                              appliesAfterAnimals: itemValue\r\n                            }\r\n                          }))}\r\n                          style={styles.picker}\r\n                        >\r\n                          {ANIMAL_COUNT_OPTIONS.map((option) => (\r\n                            <Picker.Item key={option} label={`${option} animal${option === '1' ? '' : 's'}`} value={option} />\r\n                          ))}\r\n                        </Picker>\r\n                      </View>\r\n                    </View>\r\n                  </View>\r\n\r\n                  <View style={[styles.section, { zIndex: 6 }]}>\r\n                    <Text style={styles.label}>Holiday Rate</Text>\r\n                    <View style={styles.rateContainer}>\r\n                      <View style={styles.baseRateInput}>\r\n                        <TextInput\r\n                          style={styles.input}\r\n                          value={occurrence.rates.holidayRate.toString()}\r\n                          onChangeText={(text) => setOccurrence(prev => ({\r\n                            ...prev,\r\n                            rates: {\r\n                              ...prev.rates,\r\n                              holidayRate: text.replace(/[^0-9.]/g, '')\r\n                            }\r\n                          }))}\r\n                          keyboardType=\"decimal-pad\"\r\n                          placeholder=\"0.00\"\r\n                        />\r\n                      </View>\r\n                    </View>\r\n                  </View>\r\n\r\n                  <View style={[styles.section, { zIndex: 5 }]}>\r\n                    <Text style={styles.label}>Additional Rates</Text>\r\n                    {occurrence.rates.additionalRates.map((rate, index) => (\r\n                      <View key={index} style={[styles.rateRow, {marginBottom: 10}]}>\r\n                        <TextInput\r\n                          style={[styles.input, styles.rateInput]}\r\n                          value={rate.name}\r\n                          editable={false}\r\n                        />\r\n                        <View style={[styles.rateAmountContainer]}>\r\n                          <TextInput\r\n                            style={[styles.input, styles.rateAmountInput]}\r\n                            value={rate.amount.toString()}\r\n                            editable={false}\r\n                          />\r\n                        </View>\r\n                        <TouchableOpacity onPress={() => handleDeleteRate(index)}>\r\n                          <MaterialCommunityIcons name=\"close\" size={24} color={theme.colors.error} />\r\n                        </TouchableOpacity>\r\n                      </View>\r\n                    ))}\r\n\r\n                    {showAddRate ? (\r\n                      <>\r\n                        <View style={styles.rateLabelContainer}>\r\n                          <Text style={styles.rateTitleLabel}>Rate Title</Text>\r\n                          <Text style={styles.rateAmountLabel}>Rate Amount</Text>\r\n                        </View>\r\n                        <View style={styles.rateRow}>\r\n                          <TextInput\r\n                            style={[styles.input, styles.rateInput]}\r\n                            value={newRate.name}\r\n                            onChangeText={(text) => setNewRate(prev => ({ ...prev, name: text }))}\r\n                            placeholder=\"Rate Title\"\r\n                          />\r\n                          <View style={[styles.rateAmountContainer]}>\r\n                            <TextInput\r\n                              style={[styles.input, styles.rateAmountInput]}\r\n                              value={newRate.amount}\r\n                              onChangeText={(text) => setNewRate(prev => ({ \r\n                                ...prev, \r\n                                amount: text.replace(/[^0-9.]/g, '') \r\n                              }))}\r\n                              keyboardType=\"decimal-pad\"\r\n                              placeholder=\"0.00\"\r\n                            />\r\n                          </View>\r\n                          <TouchableOpacity onPress={() => handleAddRate()}>\r\n                            <MaterialCommunityIcons name=\"plus\" size={24} color={theme.colors.primary} />\r\n                          </TouchableOpacity>\r\n                        </View>\r\n                      </>\r\n                    ) : (\r\n                      <TouchableOpacity \r\n                        style={styles.addRateButton}\r\n                        onPress={() => setShowAddRate(true)}\r\n                      >\r\n                        <Text style={styles.addRateButtonText}>Add custom rate</Text>\r\n                      </TouchableOpacity>\r\n                    )}\r\n                  </View>\r\n                \r\n\r\n                  <View style={styles.totalSection}>\r\n                    <Text style={styles.totalLabel}>Total:</Text>\r\n                    {isCalculatingCost ? (\r\n                      <View style={styles.loadingContainer}>\r\n                        <ActivityIndicator size=\"small\" color={theme.colors.primary} />\r\n                      </View>\r\n                    ) : (\r\n                      <Text style={styles.totalAmount}>${parseFloat(occurrence.calculatedCost).toFixed(2)}</Text>\r\n                    )}\r\n                  </View>\r\n\r\n                </>\r\n              )}\r\n            </ScrollView>\r\n\r\n            <View style={styles.buttonContainer}>\r\n              <Button \r\n                mode=\"outlined\" \r\n                onPress={handleDeleteClick}\r\n                style={[styles.button, { borderColor: theme.colors.error }]}\r\n                textColor={theme.colors.error}\r\n              >\r\n                Delete\r\n              </Button>\r\n              <Button \r\n                mode=\"contained\" \r\n                onPress={handleSubmit}\r\n                style={styles.button}\r\n              >\r\n                {isEditing ? 'Save Changes' : 'Add'}\r\n              </Button>\r\n            </View>\r\n            {validationError && (\r\n              <Text style={styles.errorMessage}>{validationError}</Text>\r\n            )}\r\n          </Animated.View>\r\n        </View>\r\n      </Modal>\r\n\r\n      <ConfirmationModal\r\n        visible={showDeleteConfirmation}\r\n        onClose={() => setShowDeleteConfirmation(false)}\r\n        onConfirm={handleDeleteConfirm}\r\n        actionText=\"delete this occurrence\"\r\n      />\r\n    </>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  modalContainer: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    backgroundColor: 'rgba(0, 0, 0, 0.5)',\r\n  },\r\n  modalContent: {\r\n    backgroundColor: theme.colors.background,\r\n    borderRadius: 8,\r\n    padding: 20,\r\n    width: '95%',\r\n    maxWidth: 500,\r\n  },\r\n  modalHeader: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    marginBottom: 20,\r\n  },\r\n  modalTitle: {\r\n    fontSize: theme.fontSizes.largeLarge,\r\n    fontWeight: 'bold',\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n  },\r\n  section: {\r\n    position: 'relative',\r\n    marginBottom: 16,\r\n  },\r\n  label: {\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.text,\r\n    marginBottom: 2,\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n  },\r\n  inputContainer: {\r\n    position: 'relative',\r\n    zIndex: 200, // Higher than modal content\r\n    marginBottom: 16,\r\n  },\r\n  dollarSign: {\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.text,\r\n    marginRight: 4,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  input: {\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    borderRadius: 8,\r\n    padding: 8,\r\n    backgroundColor: theme.colors.background,\r\n  },\r\n  buttonContainer: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    gap: 10,\r\n    marginTop: 16,\r\n  },\r\n  button: {\r\n    flex: 1,\r\n    paddingVertical: 6,\r\n  },\r\n  rateSection: {\r\n    // marginBottom: 10,\r\n  },\r\n  rateContainer: {\r\n    flexDirection: 'row',\r\n    alignItems: 'flex-end',\r\n    justifyContent: 'space-between',\r\n    gap: 12,\r\n  },\r\n  baseRateInput: {\r\n    flex: 1,\r\n  },\r\n  timeUnitInput: {\r\n    flex: 1,\r\n    marginTop: -32,\r\n  },\r\n  picker: {\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 8,\r\n    height: 39,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  totalSection: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    marginTop: 20,\r\n    paddingTop: 20,\r\n    borderTopWidth: 1,\r\n    borderTopColor: theme.colors.border,\r\n  },\r\n  totalLabel: {\r\n    fontSize: theme.fontSizes.medium,\r\n    fontWeight: 'bold',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  totalAmount: {\r\n    fontSize: theme.fontSizes.mediumLarge,\r\n    fontWeight: 'bold',\r\n    color: theme.colors.primary,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  errorText: {\r\n    color: theme.colors.error,\r\n    fontSize: theme.fontSizes.small,\r\n    marginTop: 8,\r\n    marginBottom: 8,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  rateRow: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    gap: 10,\r\n    marginBottom: 10,\r\n    width: '100%',\r\n    flexWrap: 'nowrap',\r\n  },\r\n  rateInput: {\r\n    flex: 2,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    borderRadius: 8,\r\n    height: 39,\r\n    padding: 12,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    minWidth: 0,\r\n  },\r\n  rateAmountContainer: {\r\n    flex: 1,\r\n    minWidth: 0,\r\n  },\r\n  rateAmountInput: {\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    borderRadius: 8,\r\n    height: 39,\r\n    padding: 12,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    width: '100%',\r\n  },\r\n  addRateButton: {\r\n    padding: 10,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    borderRadius: 8,\r\n    alignItems: 'center',\r\n  },\r\n  addRateButtonText: {\r\n    color: theme.colors.primary,\r\n    fontSize: theme.fontSizes.medium,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  rateLabelContainer: {\r\n    flexDirection: 'row',\r\n    marginTop: 10,\r\n    marginBottom: 5,\r\n  },\r\n  rateTitleLabel: {\r\n    flex: 2,\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  rateAmountLabel: {\r\n    flex: 1,\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.text,\r\n    marginLeft: 10,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  scrollView: {\r\n    flex: 1,\r\n  },\r\n  scrollViewContent: {\r\n    flexGrow: 1,\r\n  },\r\n  errorMessage: {\r\n    color: theme.colors.error,\r\n    fontSize: 14,\r\n    textAlign: 'center',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    marginTop: 8,\r\n  },\r\n  loadingContainer: {\r\n    minWidth: 80,\r\n    alignItems: 'center',\r\n    justifyContent: 'center'\r\n  },\r\n});\r\n\r\nexport default AddOccurrenceModal;","import React, { useState, useEffect, useContext } from 'react';\r\nimport { View, StyleSheet, Modal, ScrollView, TouchableOpacity, ActivityIndicator } from 'react-native';\r\nimport { Button, Text, TextInput } from 'react-native-paper';\r\nimport { theme } from '../styles/theme';\r\nimport DatePicker from './DatePicker';\r\nimport TimePicker from './TimePicker';\r\nimport AddOccurrenceModal from './AddOccurrenceModal';\r\nimport { format } from 'date-fns';\r\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\r\nimport { SERVICE_TYPE_SUGGESTIONS, mockPets } from '../data/mockData';\r\nimport ConfirmationModal from './ConfirmationModal';\r\nimport { validateDateTimeRange } from '../utils/dateTimeValidation';\r\nimport axios from 'axios';\r\nimport { API_BASE_URL } from '../config/config';\r\nimport { getStorage, AuthContext } from '../context/AuthContext';\r\n\r\nconst RequestBookingModal = ({ visible, onClose, onSubmit, conversationId }) => {\r\n  const [selectedService, setSelectedService] = useState('');\r\n  const { is_DEBUG } = useContext(AuthContext);\r\n  const [selectedPets, setSelectedPets] = useState([]);\r\n  const [showServiceDropdown, setShowServiceDropdown] = useState(false);\r\n  const [showPetDropdown, setShowPetDropdown] = useState(false);\r\n  const [showAddOccurrenceModal, setShowAddOccurrenceModal] = useState(false);\r\n  const [occurrences, setOccurrences] = useState([]);\r\n  const [selectedOccurrence, setSelectedOccurrence] = useState(null);\r\n  const [confirmationModal, setConfirmationModal] = useState({\r\n    visible: false,\r\n    actionText: '',\r\n    onConfirm: null,\r\n    isLoading: false\r\n  });\r\n  const [occurrenceErrors, setOccurrenceErrors] = useState({});\r\n  const [services, setServices] = useState([]);\r\n  const [pets, setPets] = useState([]);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n\r\n  useEffect(() => {\r\n    if (visible && conversationId) {\r\n      fetchPreRequestData();\r\n    } else if (!visible) {\r\n      // Reset states when modal is closed\r\n      setIsLoading(false);\r\n      setError(null);\r\n    }\r\n  }, [visible, conversationId]);\r\n\r\n  const fetchPreRequestData = async () => {\r\n    try {\r\n      setIsLoading(true);\r\n      setError(null);\r\n      if (is_DEBUG) {\r\n        console.log('Fetching prerequest data for conversation:', conversationId);\r\n      }\r\n      \r\n      const token = await getStorage('userToken');\r\n      const response = await axios.get(\r\n        `${API_BASE_URL}/api/messages/v1/prerequest_booking/${conversationId}/`,\r\n        {\r\n          headers: {\r\n            Authorization: `Bearer ${token}`,\r\n            'Content-Type': 'application/json'\r\n          }\r\n        }\r\n      );\r\n      \r\n      if (is_DEBUG) {\r\n        console.log('Prerequest data response:', response.data);\r\n      }\r\n      \r\n      setServices(response.data.services);\r\n      setPets(response.data.pets);\r\n      if (is_DEBUG) {\r\n        console.log('Updated services:', response.data.services);\r\n        console.log('Updated pets:', response.data.pets);\r\n      }\r\n    } catch (err) {\r\n      if (is_DEBUG) {\r\n        console.error('Error fetching pre-request data:', err.response || err);\r\n      }\r\n      setError('Failed to load booking data. Please try again.');\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const resetForm = () => {\r\n    setSelectedService('');\r\n    setSelectedPets([]);\r\n    setOccurrences([]);\r\n    setSelectedOccurrence(null);\r\n    setIsLoading(false);\r\n    setError(null);\r\n  };\r\n\r\n  const validateOccurrences = (occs) => {\r\n    const errors = {};\r\n    let isValid = true;\r\n\r\n    occs.forEach((occ, index) => {\r\n      const validation = validateDateTimeRange(\r\n        occ.startDate,\r\n        occ.endDate,\r\n        occ.startTime,\r\n        occ.endTime\r\n      );\r\n\r\n      if (!validation.isValid) {\r\n        errors[index] = validation.error;\r\n        isValid = false;\r\n      }\r\n    });\r\n\r\n    setOccurrenceErrors(errors);\r\n    return isValid;\r\n  };\r\n\r\n  const handleSubmit = () => {\r\n    if (occurrences.length === 0) return;\r\n\r\n    // Validate all occurrences before submitting\r\n    if (!validateOccurrences(occurrences)) {\r\n      return;\r\n    }\r\n\r\n    // Get the selected service object\r\n    const selectedServiceObj = services.find(s => s.service_name === selectedService);\r\n    if (!selectedServiceObj) {\r\n      setError('Please select a valid service');\r\n      return;\r\n    }\r\n\r\n    const bookingData = {\r\n      conversation_id: conversationId,\r\n      service_type: selectedServiceObj.service_id,\r\n      pets: selectedPets,\r\n      occurrences: occurrences.map(occ => ({\r\n        start_date: occ.startDate,\r\n        end_date: occ.endDate || occ.startDate,\r\n        start_time: occ.startTime,\r\n        end_time: occ.endTime\r\n      }))\r\n    };\r\n\r\n    if (is_DEBUG) {\r\n      console.log('Sending booking data:', JSON.stringify(bookingData, null, 2));\r\n    }\r\n\r\n    setIsLoading(true);\r\n    setError(null);\r\n    \r\n    onSubmit(bookingData)\r\n      .then(() => {\r\n        resetForm();\r\n        onClose();\r\n      })\r\n      .catch(err => {\r\n        const errorMessage = err.response?.data?.error || 'Failed to create booking request';\r\n        setError(errorMessage);\r\n      })\r\n      .finally(() => {\r\n        setIsLoading(false);\r\n      });\r\n  };\r\n\r\n  const handleDeleteOccurrence = async (occurrenceToDelete) => {\r\n    setConfirmationModal(prev => ({ ...prev, isLoading: true }));\r\n    \r\n    try {\r\n      setOccurrences(prev => prev.filter(occ => \r\n        occ.startDate !== occurrenceToDelete.startDate || \r\n        occ.startTime !== occurrenceToDelete.startTime\r\n      ));\r\n    } finally {\r\n      setConfirmationModal({ \r\n        visible: false, \r\n        actionText: '', \r\n        onConfirm: null, \r\n        isLoading: false \r\n      });\r\n    }\r\n  };\r\n\r\n  const confirmDeleteOccurrence = (occurrence) => {\r\n    setConfirmationModal({\r\n      visible: true,\r\n      actionText: 'delete this occurrence',\r\n      onConfirm: () => handleDeleteOccurrence(occurrence),\r\n      isLoading: false\r\n    });\r\n  };\r\n\r\n  const handleClose = () => {\r\n    resetForm();\r\n    onClose();\r\n  };\r\n\r\n  const handleOpenOccurrenceModal = () => {\r\n    setShowServiceDropdown(false);\r\n    setShowPetDropdown(false);\r\n    setShowAddOccurrenceModal(true);\r\n  };\r\n\r\n  const handleOccurrenceUpdate = (newOccurrence) => {\r\n    const { startDate, endDate, startTime, endTime } = newOccurrence;\r\n    \r\n    // Validate the new occurrence\r\n    const validation = validateDateTimeRange(startDate, endDate, startTime, endTime);\r\n    \r\n    if (!validation.isValid) {\r\n      // Show error in the AddOccurrenceModal\r\n      // You'll need to add error handling in the AddOccurrenceModal component\r\n      return false;\r\n    }\r\n\r\n    if (selectedOccurrence) {\r\n      setOccurrences(prev => prev.map(occ => \r\n        occ === selectedOccurrence ? \r\n        { startDate, endDate, startTime, endTime } : \r\n        occ\r\n      ));\r\n    } else {\r\n      setOccurrences(prev => [...prev, { startDate, endDate, startTime, endTime }]);\r\n    }\r\n    setSelectedOccurrence(null);\r\n    setShowAddOccurrenceModal(false);\r\n    return true;\r\n  };\r\n\r\n  const renderServiceDropdown = () => (\r\n    <View style={styles.dropdownContainer}>\r\n      <TouchableOpacity\r\n        style={styles.dropdownInput}\r\n        onPress={() => setShowServiceDropdown(!showServiceDropdown)}\r\n      >\r\n        <Text>{selectedService || 'Select Service Type'}</Text>\r\n        <MaterialCommunityIcons \r\n          name={showServiceDropdown ? \"chevron-up\" : \"chevron-down\"} \r\n          size={24} \r\n          color={theme.colors.text} \r\n        />\r\n      </TouchableOpacity>\r\n\r\n      {showServiceDropdown && (\r\n        <View style={styles.dropdownList}>\r\n          <ScrollView nestedScrollEnabled={true}>\r\n            {services.map((service) => (\r\n              <TouchableOpacity\r\n                key={service.service_id}\r\n                style={styles.dropdownItem}\r\n                onPress={() => {\r\n                  setSelectedService(service.service_name);\r\n                  setShowServiceDropdown(false);\r\n                }}\r\n              >\r\n                <Text style={[\r\n                  styles.dropdownText,\r\n                  selectedService === service.service_name && styles.selectedOption\r\n                ]}>\r\n                  {service.service_name}\r\n                </Text>\r\n              </TouchableOpacity>\r\n            ))}\r\n          </ScrollView>\r\n        </View>\r\n      )}\r\n    </View>\r\n  );\r\n\r\n  const renderPetSelector = () => (\r\n    <View style={{ zIndex: 2 }}>\r\n      {selectedPets.map((petId) => {\r\n        const pet = pets.find(p => p.pet_id === petId);\r\n        return (\r\n          <View key={petId} style={styles.petItem}>\r\n            <View style={styles.petInfo}>\r\n              <Text style={styles.petName}>{pet.name}</Text>\r\n              <Text style={styles.petDetails}>{pet.pet_type} • {pet.breed}</Text>\r\n            </View>\r\n            <TouchableOpacity\r\n              onPress={() => setSelectedPets(prev => prev.filter(id => id !== petId))}\r\n            >\r\n              <MaterialCommunityIcons \r\n                name=\"close\" \r\n                size={24} \r\n                color={theme.colors.error} \r\n              />\r\n            </TouchableOpacity>\r\n          </View>\r\n        );\r\n      })}\r\n      \r\n      <TouchableOpacity\r\n        style={styles.addPetButton}\r\n        onPress={() => setShowPetDropdown(!showPetDropdown)}\r\n      >\r\n        <MaterialCommunityIcons \r\n          name={showPetDropdown ? \"chevron-up\" : \"chevron-down\"} \r\n          size={20} \r\n          color={theme.colors.primary} \r\n        />\r\n        <Text style={styles.addPetText}>\r\n          {selectedPets.length === 0 ? 'Select Pets' : 'Add Pet'}\r\n        </Text>\r\n      </TouchableOpacity>\r\n      \r\n      {showPetDropdown && (\r\n        <View style={styles.dropdownList}>\r\n          <ScrollView nestedScrollEnabled={true} style={styles.petDropdown}>\r\n            {pets\r\n              .filter(pet => !selectedPets.includes(pet.pet_id))\r\n              .map((pet) => (\r\n                <TouchableOpacity\r\n                  key={pet.pet_id}\r\n                  style={styles.dropdownItem}\r\n                  onPress={() => {\r\n                    setSelectedPets(prev => [...prev, pet.pet_id]);\r\n                    setShowPetDropdown(false);\r\n                  }}\r\n                >\r\n                  <View>\r\n                    <Text style={styles.dropdownPetName}>{pet.name}</Text>\r\n                    <Text style={styles.dropdownPetDetails}>\r\n                      {pet.pet_type} • {pet.breed}\r\n                    </Text>\r\n                  </View>\r\n                </TouchableOpacity>\r\n              ))}\r\n          </ScrollView>\r\n        </View>\r\n      )}\r\n    </View>\r\n  );\r\n\r\n  const renderOccurrenceCard = (occ, index) => (\r\n    <View key={index}>\r\n      <TouchableOpacity \r\n        style={[\r\n          styles.occurrenceCard,\r\n          occurrenceErrors[index] && styles.occurrenceCardError\r\n        ]}\r\n      >\r\n        <View style={styles.occurrenceDetails}>\r\n          <Text style={styles.dateText}>\r\n            {occ.endDate && occ.startDate !== occ.endDate ? \r\n              `${occ.startDate} - ${occ.endDate}` :\r\n              occ.startDate\r\n            }\r\n          </Text>\r\n          <Text style={styles.timeText}>\r\n            {`${occ.startTime} - ${occ.endTime}`}\r\n          </Text>\r\n          {occurrenceErrors[index] && (\r\n            <Text style={styles.errorText}>{occurrenceErrors[index]}</Text>\r\n          )}\r\n        </View>\r\n        <View style={styles.occurrenceActions}>\r\n          <TouchableOpacity \r\n            style={styles.actionButton}\r\n            onPress={() => confirmDeleteOccurrence(occ)}\r\n          >\r\n            <MaterialCommunityIcons name=\"trash-can-outline\" size={20} color={theme.colors.error} />\r\n          </TouchableOpacity>\r\n          <TouchableOpacity \r\n            style={styles.actionButton}\r\n            onPress={() => {\r\n              setSelectedOccurrence(occ);\r\n              handleOpenOccurrenceModal();\r\n            }}\r\n          >\r\n            <MaterialCommunityIcons name=\"pencil\" size={20} color={theme.colors.primary} />\r\n          </TouchableOpacity>\r\n        </View>\r\n      </TouchableOpacity>\r\n    </View>\r\n  );\r\n\r\n  return (\r\n    <Modal\r\n      visible={visible}\r\n      onRequestClose={handleClose}\r\n      animationType=\"slide\"\r\n      transparent={true}\r\n    >\r\n      <View style={styles.modalContainer}>\r\n        <View style={styles.modalContent}>\r\n          <Text style={styles.modalTitle}>Request Booking</Text>\r\n          \r\n          {isLoading ? (\r\n            <View style={styles.loadingContainer}>\r\n              <ActivityIndicator size=\"large\" color={theme.colors.primary} />\r\n              <Text>Loading booking data...</Text>\r\n            </View>\r\n          ) : error ? (\r\n            <View style={styles.errorContainer}>\r\n              <Text style={styles.errorText}>{error}</Text>\r\n              <Button mode=\"contained\" onPress={fetchPreRequestData}>\r\n                Retry\r\n              </Button>\r\n            </View>\r\n          ) : (\r\n            <ScrollView style={styles.scrollView}>\r\n              {/* Service Selection */}\r\n              <Text style={styles.label}>Select Service</Text>\r\n              {renderServiceDropdown()}\r\n\r\n              {/* Pet Selection */}\r\n              <Text style={styles.label}>Select Pets</Text>\r\n              {renderPetSelector()}\r\n\r\n              {/* Date & Time Selection */}\r\n              <Text style={styles.label}>Select Date & Time</Text>\r\n              {occurrences.map((occ, index) => renderOccurrenceCard(occ, index))}\r\n\r\n              <TouchableOpacity\r\n                style={styles.addOccurrenceButton}\r\n                onPress={() => {\r\n                  setSelectedOccurrence(null);\r\n                  handleOpenOccurrenceModal();\r\n                }}\r\n              >\r\n                <MaterialCommunityIcons name=\"plus\" size={24} color={theme.colors.primary} />\r\n                <Text style={styles.addOccurrenceText}>Add Date & Time</Text>\r\n              </TouchableOpacity>\r\n            </ScrollView>\r\n          )}\r\n\r\n          <View style={styles.buttonContainer}>\r\n            <Button mode=\"outlined\" onPress={handleClose} style={styles.button}>\r\n              Cancel\r\n            </Button>\r\n            <Button \r\n              mode=\"contained\" \r\n              onPress={handleSubmit}\r\n              style={styles.button}\r\n              disabled={!selectedService || selectedPets.length === 0 || occurrences.length === 0 || isLoading}\r\n            >\r\n              Submit\r\n            </Button>\r\n          </View>\r\n        </View>\r\n      </View>\r\n\r\n      <AddOccurrenceModal\r\n        visible={showAddOccurrenceModal}\r\n        onClose={() => setShowAddOccurrenceModal(false)}\r\n        onAdd={handleOccurrenceUpdate}\r\n        hideRates={true}\r\n        initialOccurrence={selectedOccurrence}\r\n        modalTitle={selectedOccurrence ? 'Edit Occurrence' : 'Add New Occurrence'}\r\n        isFromRequestBooking={true}\r\n      />\r\n\r\n      <ConfirmationModal\r\n        visible={confirmationModal.visible}\r\n        actionText={confirmationModal.actionText}\r\n        onClose={() => {\r\n          if (!confirmationModal.isLoading) {\r\n            setConfirmationModal({ \r\n              visible: false, \r\n              actionText: '', \r\n              onConfirm: null, \r\n              isLoading: false \r\n            });\r\n          }\r\n        }}\r\n        onConfirm={confirmationModal.onConfirm}\r\n        isLoading={confirmationModal.isLoading}\r\n      />\r\n    </Modal>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  modalContainer: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    backgroundColor: 'rgba(0, 0, 0, 0.5)',\r\n  },\r\n  modalContent: {\r\n    backgroundColor: theme.colors.background,\r\n    borderRadius: 8,\r\n    padding: 20,\r\n    width: '90%',\r\n    maxWidth: 500,\r\n    maxHeight: '80%',\r\n  },\r\n  modalTitle: {\r\n    fontSize: theme.fontSizes.largeLarge,\r\n    fontWeight: 'bold',\r\n    marginBottom: 20,\r\n    textAlign: 'center',\r\n  },\r\n  scrollView: {\r\n    maxHeight: '70%',\r\n  },\r\n  label: {\r\n    fontSize: theme.fontSizes.medium,\r\n    fontWeight: '500',\r\n    marginTop: 15,\r\n    marginBottom: 10,\r\n  },\r\n  serviceOptions: {\r\n    flexDirection: 'row',\r\n    flexWrap: 'wrap',\r\n    gap: 10,\r\n  },\r\n  serviceButton: {\r\n    marginBottom: 10,\r\n  },\r\n  petOptions: {\r\n    flexDirection: 'row',\r\n    flexWrap: 'wrap',\r\n    gap: 10,\r\n  },\r\n  petButton: {\r\n    marginBottom: 10,\r\n  },\r\n  dateContainer: {\r\n    gap: 10,\r\n  },\r\n  timeContainer: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    gap: 10,\r\n  },\r\n  buttonContainer: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    marginTop: 20,\r\n    gap: 10,\r\n  },\r\n  button: {\r\n    flex: 1,\r\n  },\r\n  timePickerWrapper: {\r\n    flex: 1,\r\n  },\r\n  dropdownContainer: {\r\n    position: 'relative',\r\n    marginBottom: 20,\r\n    zIndex: 3,\r\n  },\r\n  dropdownInput: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    borderRadius: 8,\r\n    padding: 12,\r\n    backgroundColor: theme.colors.surface,\r\n  },\r\n  dropdownList: {\r\n    position: 'absolute',\r\n    top: '100%',\r\n    left: 0,\r\n    right: 0,\r\n    backgroundColor: theme.colors.surface,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    borderRadius: 8,\r\n    maxHeight: 200,\r\n    zIndex: 1000,\r\n    elevation: 5,\r\n  },\r\n  dropdownItem: {\r\n    padding: 12,\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: theme.colors.border,\r\n  },\r\n  dropdownText: {\r\n    color: theme.colors.text,\r\n  },\r\n  selectedOption: {\r\n    color: theme.colors.primary,\r\n    fontWeight: 'bold',\r\n  },\r\n  petItem: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    paddingVertical: 12,\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: theme.colors.border,\r\n  },\r\n  petInfo: {\r\n    flex: 1,\r\n  },\r\n  petName: {\r\n    fontSize: theme.fontSizes.medium,\r\n    fontWeight: '500',\r\n    marginBottom: 4,\r\n  },\r\n  petDetails: {\r\n    fontSize: theme.fontSizes.smallMedium,\r\n    color: theme.colors.placeholder,\r\n  },\r\n  addPetButton: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    padding: 12,\r\n    marginTop: 8,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    borderRadius: 8,\r\n    justifyContent: 'center',\r\n  },\r\n  addPetText: {\r\n    marginLeft: 8,\r\n    color: theme.colors.primary,\r\n    fontSize: theme.fontSizes.medium,\r\n  },\r\n  occurrenceCard: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    padding: 15,\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 8,\r\n    marginBottom: 10,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n  },\r\n  occurrenceDetails: {\r\n    flex: 1,\r\n  },\r\n  dateText: {\r\n    fontSize: theme.fontSizes.medium,\r\n    fontWeight: '500',\r\n    marginBottom: 4,\r\n  },\r\n  timeText: {\r\n    fontSize: theme.fontSizes.smallMedium,\r\n    color: theme.colors.placeholder,\r\n  },\r\n  addOccurrenceButton: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    padding: 16,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.primary,\r\n    borderRadius: 8,\r\n    marginTop: 12,\r\n  },\r\n  addOccurrenceText: {\r\n    marginLeft: 8,\r\n    color: theme.colors.primary,\r\n    fontSize: theme.fontSizes.medium,\r\n  },\r\n  occurrenceActions: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    gap: 10,\r\n  },\r\n  actionButton: {\r\n    padding: 8,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.error,\r\n    borderRadius: 4,\r\n  },\r\n  bookingRequestCard: {\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 8,\r\n    padding: 16,\r\n    margin: 8,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.primary,\r\n  },\r\n  bookingRequestHeader: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    marginBottom: 12,\r\n    gap: 8,\r\n  },\r\n  bookingRequestTitle: {\r\n    fontSize: theme.fontSizes.mediumLarge,\r\n    fontWeight: 'bold',\r\n    color: theme.colors.primary,\r\n  },\r\n  bookingRequestDetails: {\r\n    gap: 8,\r\n  },\r\n  detailLabel: {\r\n    fontSize: theme.fontSizes.smallMedium,\r\n    fontWeight: '500',\r\n    color: theme.colors.placeholder,\r\n  },\r\n  detailText: {\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.text,\r\n  },\r\n  acceptButton: {\r\n    backgroundColor: theme.colors.primary,\r\n    padding: 12,\r\n    borderRadius: 8,\r\n    alignItems: 'center',\r\n    marginTop: 16,\r\n  },\r\n  acceptButtonText: {\r\n    color: theme.colors.surface,\r\n    fontSize: theme.fontSizes.medium,\r\n    fontWeight: '500',\r\n  },\r\n  occurrenceCardError: {\r\n    borderColor: theme.colors.error,\r\n  },\r\n  errorText: {\r\n    color: theme.colors.error,\r\n    fontSize: theme.fontSizes.small,\r\n    marginTop: 4,\r\n  },\r\n  loadingContainer: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    padding: 20,\r\n  },\r\n  errorContainer: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    padding: 20,\r\n  },\r\n});\r\n\r\nexport default RequestBookingModal; ","import React, { useState, useContext, useEffect } from 'react';\r\nimport {\r\n  View,\r\n  Text,\r\n  StyleSheet,\r\n  TouchableOpacity,\r\n  ScrollView,\r\n  ActivityIndicator,\r\n  Image,\r\n  Platform,\r\n  Alert,\r\n} from 'react-native';\r\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\r\nimport { theme } from '../../styles/theme';\r\nimport { AuthContext } from '../../context/AuthContext';\r\nimport { getBookingAvailableServices, getBookingAvailablePets } from '../../api/API';\r\nimport axios from 'axios';\r\nimport { navigateToFrom } from '../Navigation';\r\n\r\nconst ServiceAndPetsCard = ({ \r\n  bookingId, \r\n  onServiceSelect, \r\n  onPetSelect, \r\n  selectedService, \r\n  selectedPets,\r\n  isLoading,\r\n  error,\r\n  onNext,\r\n  currentBookingId,\r\n  navigation,\r\n  onClose\r\n}) => {\r\n  const { is_DEBUG } = useContext(AuthContext);\r\n  const [availableServices, setAvailableServices] = useState([]);\r\n  const [availablePets, setAvailablePets] = useState([]);\r\n  const [isLoadingServices, setIsLoadingServices] = useState(false);\r\n  const [isLoadingPets, setIsLoadingPets] = useState(false);\r\n  const [serviceError, setServiceError] = useState(null);\r\n  const [petsError, setPetsError] = useState(null);\r\n\r\n  useEffect(() => {\r\n    if (bookingId) {\r\n      fetchAvailableServices();\r\n      fetchAvailablePets();\r\n    }\r\n  }, [bookingId]);\r\n\r\n  const fetchAvailableServices = async () => {\r\n    try {\r\n      setIsLoadingServices(true);\r\n      setServiceError(null);\r\n      const response = await getBookingAvailableServices(bookingId);\r\n      if (is_DEBUG) {\r\n        console.log('MBA12345 Available services response:', response);\r\n      }\r\n      setAvailableServices(response.services);\r\n      \r\n      // If there's a selected service in the response and no service is currently selected,\r\n      // automatically select it\r\n      if (response.selected_service_id && !selectedService) {\r\n        const serviceToSelect = response.services.find(s => s.service_id === response.selected_service_id);\r\n        if (serviceToSelect) {\r\n          onServiceSelect({\r\n            ...serviceToSelect,\r\n            isOvernightForced: serviceToSelect.is_overnight\r\n          });\r\n        }\r\n      }\r\n    } catch (error) {\r\n      if (is_DEBUG) {\r\n        console.error('MBA12345 Error fetching services:', error);\r\n      }\r\n      setServiceError('Failed to load available services');\r\n    } finally {\r\n      setIsLoadingServices(false);\r\n    }\r\n  };\r\n\r\n  const fetchAvailablePets = async () => {\r\n    try {\r\n      setIsLoadingPets(true);\r\n      setPetsError(null);\r\n      const response = await getBookingAvailablePets(bookingId);\r\n      if (is_DEBUG) {\r\n        console.log('MBA12345 Available pets response:', response);\r\n      }\r\n      setAvailablePets(response.pets);\r\n      \r\n      // If there are selected pets in the response and no pets are currently selected,\r\n      // automatically select them\r\n      if (response.selected_pet_ids && response.selected_pet_ids.length > 0 && selectedPets.length === 0) {\r\n        const petsToSelect = response.pets.filter(p => response.selected_pet_ids.includes(p.pet_id));\r\n        petsToSelect.forEach(pet => onPetSelect(pet));\r\n      }\r\n    } catch (error) {\r\n      if (is_DEBUG) {\r\n        console.error('MBA12345 Error fetching pets:', error);\r\n      }\r\n      setPetsError('Failed to load available pets');\r\n    } finally {\r\n      setIsLoadingPets(false);\r\n    }\r\n  };\r\n\r\n  // TODO: change to animal type based icons\r\n  const getServiceIcon = (serviceName) => {\r\n    switch (serviceName.toLowerCase()) {\r\n      case 'dog walking':\r\n        return 'paw';\r\n      case 'house sitting':\r\n        return 'home';\r\n      case 'drop-in visits':\r\n        return 'food-variant';\r\n      case 'boarding':\r\n        return 'home-city';\r\n      default:\r\n        return 'paw';\r\n    }\r\n  };\r\n\r\n  const renderServiceCard = (service) => {\r\n    const isSelected = selectedService?.service_id === service.service_id;\r\n    \r\n    return (\r\n      <TouchableOpacity\r\n        key={service.service_id}\r\n        style={[\r\n          styles.serviceCard,\r\n          isSelected && styles.selectedServiceCard\r\n        ]}\r\n        onPress={() => onServiceSelect({\r\n          ...service,\r\n          isOvernightForced: service.is_overnight\r\n        })}\r\n      >\r\n        {/* TODO: change to animal type based icons */}\r\n        <MaterialCommunityIcons \r\n          name={getServiceIcon(service.service_name)}\r\n          size={24}\r\n          color={isSelected ? theme.colors.mainColors.main : theme.colors.text}\r\n        />\r\n        <Text style={[\r\n          styles.serviceText,\r\n          isSelected && styles.selectedServiceText\r\n        ]}>\r\n          {service.service_name}\r\n        </Text>\r\n        {isSelected && (\r\n          <MaterialCommunityIcons \r\n            name=\"check\" \r\n            size={24} \r\n            color={theme.colors.mainColors.main}\r\n            style={styles.serviceCheckIcon}\r\n          />\r\n        )}\r\n      </TouchableOpacity>\r\n    );\r\n  };\r\n\r\n  const renderPetCard = (pet) => {\r\n    const isSelected = selectedPets.some(selectedPet => selectedPet.pet_id === pet.pet_id);\r\n    \r\n    return (\r\n      <TouchableOpacity\r\n        key={pet.pet_id}\r\n        style={[\r\n          styles.petCard,\r\n          isSelected && styles.selectedPetCard\r\n        ]}\r\n        onPress={() => onPetSelect(pet)}\r\n      >\r\n        <View style={styles.petImageContainer}>\r\n          {pet.image_url ? (\r\n            <Image \r\n              source={{ uri: pet.image_url }} \r\n              style={styles.petImage}\r\n              defaultSource={require('../../../assets/default-pet-image.png')}\r\n            />\r\n          ) : (\r\n            <View style={styles.defaultPetImage}>\r\n              <MaterialCommunityIcons \r\n                name=\"paw\" \r\n                size={24} \r\n                color={theme.colors.placeHolderText}\r\n              />\r\n            </View>\r\n          )}\r\n        </View>\r\n        <View style={styles.petInfo}>\r\n          <Text style={styles.petName}>{pet.name}</Text>\r\n          <Text style={styles.petDetails}>\r\n            {pet.breed} • {pet.age} years\r\n          </Text>\r\n        </View>\r\n        {isSelected && (\r\n          <MaterialCommunityIcons \r\n            name=\"check\" \r\n            size={24} \r\n            color={theme.colors.mainColors.main}\r\n            style={styles.checkIcon}\r\n          />\r\n        )}\r\n      </TouchableOpacity>\r\n    );\r\n  };\r\n\r\n  const renderSelectedItems = () => {\r\n    if (!selectedService && selectedPets.length === 0) return null;\r\n\r\n    return (\r\n      <View style={styles.selectedItemsContainer}>\r\n        <Text style={styles.selectedItemsTitle}>Selected Service & Pets:</Text>\r\n        <View style={styles.selectedItemsContent}>\r\n          {selectedService && (\r\n            <TouchableOpacity \r\n              style={styles.selectedTag}\r\n              onPress={() => onServiceSelect(null)}\r\n            >\r\n              <Text style={styles.selectedTagText}>{selectedService.service_name}</Text>\r\n              <MaterialCommunityIcons name=\"close\" size={16} color={theme.colors.mainColors.main} />\r\n            </TouchableOpacity>\r\n          )}\r\n          {selectedPets.map(pet => (\r\n            <TouchableOpacity \r\n              key={pet.pet_id}\r\n              style={styles.selectedTag}\r\n              onPress={() => onPetSelect(pet)}\r\n            >\r\n              <Text style={styles.selectedTagText}>{pet.name}</Text>\r\n              <MaterialCommunityIcons name=\"close\" size={16} color={theme.colors.mainColors.main} />\r\n            </TouchableOpacity>\r\n          ))}\r\n        </View>\r\n      </View>\r\n    );\r\n  };\r\n\r\n  const handleNext = async () => {\r\n    if (is_DEBUG) {\r\n      console.log('MBA98765 handleNext:', {\r\n        selectedService,\r\n        selectedPets,\r\n        currentBookingId\r\n      });\r\n    }\r\n\r\n    if (!selectedService || selectedPets.length === 0) {\r\n      Alert.alert('Error', 'Please select both a service and at least one pet before proceeding.');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      // Update the draft with selected service and pets\r\n      const response = await axios.patch(\r\n        `${API_BASE_URL}/api/booking_drafts/v1/${currentBookingId}/update/`,\r\n        {\r\n          service_id: selectedService.service_id,\r\n          pet_ids: selectedPets.map(pet => pet.pet_id)\r\n        }\r\n      );\r\n\r\n      if (is_DEBUG) {\r\n        console.log('MBA98765 Draft update response:', response.data);\r\n      }\r\n\r\n      // If successful, proceed to next step\r\n      onNext();\r\n    } catch (error) {\r\n      if (is_DEBUG) {\r\n        console.log('MBA98765 Error updating draft:', error);\r\n      }\r\n      Alert.alert('Error', 'Failed to update booking draft. Please try again.');\r\n    }\r\n  };\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <View style={styles.loadingContainer}>\r\n        <ActivityIndicator size=\"large\" color={theme.colors.mainColors.main} />\r\n      </View>\r\n    );\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <View style={styles.errorContainer}>\r\n        <Text style={styles.errorText}>{error}</Text>\r\n      </View>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <ScrollView style={styles.container}>\r\n      <View style={styles.section}>\r\n        <Text style={styles.sectionTitle}>Select Service</Text>\r\n        {serviceError ? (\r\n          <Text style={styles.errorText}>{serviceError}</Text>\r\n        ) : isLoadingServices ? (\r\n          <ActivityIndicator size=\"small\" color={theme.colors.mainColors.main} />\r\n        ) : availableServices.length > 0 ? (\r\n          <View style={styles.servicesGrid}>\r\n            {availableServices.map(service => renderServiceCard(service))}\r\n          </View>\r\n        ) : (\r\n          <View style={styles.noServicesContainer}>\r\n            <Text style={styles.errorText}>No services available. Please add services to create a booking.</Text>\r\n            <TouchableOpacity \r\n              style={styles.createServiceButton} \r\n              onPress={() => {\r\n                onClose();\r\n                navigateToFrom(navigation, 'ServiceManager', 'MessageHistory');\r\n              }}\r\n            >\r\n              <Text style={styles.createServiceButtonText}>Create Services</Text>\r\n            </TouchableOpacity>\r\n          </View>\r\n        )}\r\n      </View>\r\n\r\n      <View style={styles.section}>\r\n        <Text style={styles.sectionTitle}>Select Pets</Text>\r\n        {petsError ? (\r\n          <Text style={styles.errorText}>{petsError}</Text>\r\n        ) : isLoadingPets ? (\r\n          <ActivityIndicator size=\"small\" color={theme.colors.mainColors.main} />\r\n        ) : (\r\n          availablePets.length > 0 ? (\r\n            <View style={styles.petsContainer}>\r\n              {availablePets.map(pet => renderPetCard(pet))}\r\n            </View>\r\n          ) : (\r\n            <Text style={styles.errorText}>Please instruct client to add pets to their account so you can create a booking for their pets.</Text>\r\n          )\r\n        )}\r\n      </View>\r\n    </ScrollView>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    backgroundColor: theme.colors.background,\r\n  },\r\n  section: {\r\n    padding: 16,\r\n  },\r\n  sectionTitle: {\r\n    fontSize: Platform.OS === 'web' ? 18 : 14,\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n    marginBottom: 16,\r\n    color: theme.colors.text,\r\n  },\r\n  servicesGrid: {\r\n    flexDirection: 'row',\r\n    flexWrap: 'wrap',\r\n    gap: 12,\r\n    justifyContent: 'flex-start',\r\n    width: '100%',\r\n  },\r\n  serviceCard: {\r\n    width: '31%',\r\n    minWidth: 100,\r\n    maxWidth: 150,\r\n    aspectRatio: 1.2,\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 12,\r\n    padding: 12,\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    marginBottom: 8,\r\n  },\r\n  selectedServiceCard: {\r\n    backgroundColor: `${theme.colors.mainColors.main}10`,\r\n    borderColor: theme.colors.mainColors.main,\r\n  },\r\n  serviceText: {\r\n    marginTop: 8,\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    textAlign: 'center',\r\n    width: '100%',\r\n  },\r\n  selectedServiceText: {\r\n    color: theme.colors.mainColors.main,\r\n    fontWeight: '600',\r\n  },\r\n  petsContainer: {\r\n    gap: 12,\r\n    flexDirection: 'row',\r\n    flexWrap: 'wrap',\r\n    justifyContent: 'flex-start',\r\n  },\r\n  petCard: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 12,\r\n    padding: 12,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    width: Platform.OS === 'web' ? 'calc(50% - 6px)' : '100%',\r\n    minWidth: Platform.OS === 'web' ? 250 : 'auto',\r\n    maxWidth: Platform.OS === 'web' ? 400 : '100%',\r\n  },\r\n  selectedPetCard: {\r\n    backgroundColor: `${theme.colors.mainColors.main}10`,\r\n    borderColor: theme.colors.mainColors.main,\r\n  },\r\n  petImageContainer: {\r\n    marginRight: 12,\r\n  },\r\n  petImage: {\r\n    width: 48,\r\n    height: 48,\r\n    borderRadius: 24,\r\n  },\r\n  defaultPetImage: {\r\n    width: 48,\r\n    height: 48,\r\n    borderRadius: 24,\r\n    backgroundColor: theme.colors.surface,\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n  },\r\n  petInfo: {\r\n    flex: 1,\r\n  },\r\n  petName: {\r\n    fontSize: 16,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    marginBottom: 4,\r\n    color: theme.colors.text,\r\n  },\r\n  petDetails: {\r\n    fontSize: 14,\r\n    color: theme.colors.placeHolderText,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  checkIcon: {\r\n    marginLeft: 12,\r\n  },\r\n  selectedItemsContainer: {\r\n    backgroundColor: 'rgba(0, 0, 0, 0.03)',\r\n    padding: 16,\r\n    borderRadius: 8,\r\n  },\r\n  selectedItemsTitle: {\r\n    fontSize: Platform.OS === 'web' ? 14 : 10,\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n    marginBottom: 16,\r\n    color: theme.colors.text,\r\n  },\r\n  selectedItemsContent: {\r\n    flexDirection: 'row',\r\n    flexWrap: 'wrap',\r\n    gap: 8,\r\n  },\r\n  selectedTag: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    backgroundColor: `${theme.colors.mainColors.main}10`,\r\n    borderRadius: 20,\r\n    paddingVertical: 6,\r\n    paddingHorizontal: 12,\r\n    gap: 8,\r\n  },\r\n  selectedTagText: {\r\n    color: theme.colors.mainColors.main,\r\n    fontSize: 14,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  loadingContainer: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    padding: 20,\r\n  },\r\n  errorContainer: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    padding: 20,\r\n  },\r\n  errorText: {\r\n    color: theme.colors.error,\r\n    textAlign: 'center',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  serviceCheckIcon: {\r\n    position: 'absolute',\r\n    top: 8,\r\n    right: 8,\r\n  },\r\n  createServiceButton: {\r\n    backgroundColor: theme.colors.mainColors.main,\r\n    padding: 16,\r\n    borderRadius: 8,\r\n    alignItems: 'center',\r\n  },\r\n  createServiceButtonText: {\r\n    color: theme.colors.surface,\r\n    fontSize: 16,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n});\r\n\r\nexport default ServiceAndPetsCard; ","import React, { useState, useContext, useEffect, useRef } from 'react';\r\nimport {\r\n  View,\r\n  Text,\r\n  StyleSheet,\r\n  TouchableOpacity,\r\n  ScrollView,\r\n  Dimensions,\r\n  Modal,\r\n  Platform,\r\n  Image,\r\n  Animated,\r\n} from 'react-native';\r\nimport { theme } from '../../styles/theme';\r\nimport { AuthContext, debugLog } from '../../context/AuthContext';\r\n\r\nconst DateSelectionCard = ({ \r\n  selectedDates = [], \r\n  onDateSelect,\r\n  bookingType = 'one-time', // 'one-time' or 'recurring'\r\n  dateRangeType = 'date-range', // 'date-range' or 'multiple-days'\r\n  initialDateRange = null,\r\n  isOvernightForced = false,\r\n}) => {\r\n  const { is_DEBUG, screenWidth } = useContext(AuthContext);\r\n  const isDesktop = screenWidth > 768;\r\n  const [currentMonth, setCurrentMonth] = useState(new Date());\r\n  const [selectedDatesList, setSelectedDatesList] = useState(selectedDates);\r\n  const [selectedBookingType, setSelectedBookingType] = useState(isOvernightForced ? 'one-time' : bookingType);\r\n  const [selectedDateRangeType, setSelectedDateRangeType] = useState('date-range');\r\n  const [rangeStartDate, setRangeStartDate] = useState(initialDateRange ? initialDateRange.startDate : null);\r\n  const [selectedDaysOfWeek, setSelectedDaysOfWeek] = useState([1, 3]); // Default to M,W\r\n  const [selectedFrequency, setSelectedFrequency] = useState('weekly'); // 'weekly', 'bi-weekly', 'monthly'\r\n  const [dateRangeEnd, setDateRangeEnd] = useState(initialDateRange ? initialDateRange.endDate : null);\r\n  const [showRecurringCalendar, setShowRecurringCalendar] = useState(false);\r\n  const [recurringStartDate, setRecurringStartDate] = useState(new Date());\r\n  const [recurringEndDate, setRecurringEndDate] = useState(() => {\r\n    const date = new Date();\r\n    date.setMonth(date.getMonth() + 1);\r\n    return date;\r\n  });\r\n  const [isSelectingStartDate, setIsSelectingStartDate] = useState(true);\r\n  const [showRecurringPreview, setShowRecurringPreview] = useState(false);\r\n  const [showRecurringDropdownCalendar, setShowRecurringDropdownCalendar] = useState(false);\r\n  const [tempRangeStart, setTempRangeStart] = useState(null);\r\n  const [tempRangeEnd, setTempRangeEnd] = useState(null);\r\n  const [datesFromRange, setDatesFromRange] = useState(false);\r\n  const [lastRangeSelection, setLastRangeSelection] = useState(null);\r\n\r\n  useEffect(() => {\r\n    debugLog('MBA54321 DateSelectionCard initialized with dates:', selectedDates);\r\n    debugLog('MBA54321 Current booking type:', bookingType);\r\n    debugLog('MBA54321 Current date range type:', dateRangeType);\r\n    debugLog('MBA54321 Initial date range:', initialDateRange);\r\n    debugLog('MBA54321 isOvernightForced:', isOvernightForced);\r\n    \r\n    // Set the booking type and date range type from props\r\n    setSelectedBookingType(isOvernightForced ? 'one-time' : bookingType);\r\n    \r\n    // For overnight services, ALWAYS force date-range selection type\r\n    // For non-overnight services, ALWAYS force multiple-days selection type\r\n    if (isOvernightForced) {\r\n      setSelectedDateRangeType('date-range');\r\n    } else {\r\n      // TODO: [NON-OVERNIGHT Date Range Feature] This is for date ranges for non-overnight services, uncomment after MVP launch\r\n      // // Check if the dates are non-consecutive to enforce multiple-days mode\r\n      // if (selectedDates && selectedDates.length > 1) {\r\n      //   const datesArray = selectedDates.map(dateItem => {\r\n      //     if (dateItem instanceof Date) {\r\n      //       return dateItem;\r\n      //     } else if (typeof dateItem === 'object' && dateItem.date) {\r\n      //       return new Date(dateItem.date);\r\n      //     } else {\r\n      //       return new Date(dateItem);\r\n      //     }\r\n      //   }).sort((a, b) => a - b);\r\n        \r\n      //   // Check if dates are consecutive\r\n      //   let areConsecutive = true;\r\n      //   for (let i = 1; i < datesArray.length; i++) {\r\n      //     const prevDate = new Date(datesArray[i-1]);\r\n      //     const currDate = new Date(datesArray[i]);\r\n      //     prevDate.setDate(prevDate.getDate() + 1);\r\n          \r\n      //     if (prevDate.getTime() !== currDate.getTime()) {\r\n      //       areConsecutive = false;\r\n      //       break;\r\n      //     }\r\n      //   }\r\n        \r\n      //   // Set appropriate date range type\r\n      //   if (!areConsecutive) {\r\n      setSelectedDateRangeType('multiple-days');\r\n      // TODO: [NON-OVERNIGHT Date Range Feature] This is for date ranges for non-overnight services, uncomment after MVP launch\r\n      //     debugLog('MBA54321 Non-consecutive dates detected, enforcing multiple-days mode');\r\n      //   } else {\r\n      //     setSelectedDateRangeType(dateRangeType);\r\n      //   }\r\n      // } else {\r\n      //   setSelectedDateRangeType(dateRangeType);\r\n      // }\r\n    }\r\n    \r\n    // Handle dates from draft that might be in a different format\r\n    if (selectedDates && selectedDates.length > 0) {\r\n      // Check if the dates are already Date objects or if they're objects with a date property\r\n      const datesArray = selectedDates.map(dateItem => {\r\n        if (dateItem instanceof Date) {\r\n          return dateItem; // Already a Date object\r\n        } else if (typeof dateItem === 'object' && dateItem.date) {\r\n          // It's a date object with a date property (from draft data)\r\n          // Format is typically { date: '2023-05-01', startTime: '09:00', endTime: '17:00' }\r\n          return new Date(dateItem.date);\r\n        } else {\r\n          // Unknown format, try to parse as date\r\n          return new Date(dateItem);\r\n        }\r\n      });\r\n      \r\n      setSelectedDatesList(datesArray);\r\n      \r\n      // If in date-range mode and dates are consecutive, set the range start and end dates\r\n      const areConsecutiveDates = checkIfConsecutiveDates(datesArray);\r\n      \r\n      if ((dateRangeType === 'date-range' || isOvernightForced) && datesArray.length > 0 && areConsecutiveDates) {\r\n        // Sort dates to get min and max\r\n        const sortedDates = [...datesArray].sort((a, b) => a - b);\r\n        setRangeStartDate(sortedDates[0]);\r\n        setDateRangeEnd(sortedDates[sortedDates.length - 1]);\r\n        setDatesFromRange(true);\r\n      } else if (datesArray.length > 0) {\r\n        // For non-consecutive dates, we'll stay in multiple-days mode\r\n        setDatesFromRange(false);\r\n      }\r\n      \r\n      // Notify parent component that we have valid dates\r\n      if (onDateSelect) {\r\n        // TODO: [NON-OVERNIGHT Date Range Feature] Add this back to the conditional below instead of just multiple days\r\n        // (!areConsecutiveDates ? 'multiple-days' : dateRangeType),\r\n        const dateData = {\r\n          type: bookingType,\r\n          dates: datesArray,\r\n          rangeType: isOvernightForced ? 'date-range' : 'multiple-days',\r\n          isValid: true\r\n        };\r\n        \r\n        // Add range data if in date-range mode and dates are consecutive\r\n        if ((dateRangeType === 'date-range' || isOvernightForced) && \r\n            datesArray.length > 0 && \r\n            areConsecutiveDates) {\r\n          const sortedDates = [...datesArray].sort((a, b) => a - b);\r\n          dateData.startDate = sortedDates[0];\r\n          dateData.endDate = sortedDates[sortedDates.length - 1];\r\n        }\r\n        \r\n        onDateSelect(dateData);\r\n      }\r\n    }\r\n  }, []);\r\n\r\n  // Helper function to check if an array of dates contains only consecutive dates\r\n  const checkIfConsecutiveDates = (datesArray) => {\r\n    if (!datesArray || datesArray.length <= 1) return true;\r\n    \r\n    // Sort the dates\r\n    const sortedDates = [...datesArray].sort((a, b) => a - b);\r\n    \r\n    // Check if each date is exactly one day after the previous\r\n    for (let i = 1; i < sortedDates.length; i++) {\r\n      const prevDate = new Date(sortedDates[i-1]);\r\n      const currDate = new Date(sortedDates[i]);\r\n      prevDate.setDate(prevDate.getDate() + 1);\r\n      \r\n      if (prevDate.getTime() !== currDate.getTime()) {\r\n        debugLog('MBA54321 Non-consecutive dates found:', {\r\n          prev: sortedDates[i-1].toISOString().split('T')[0],\r\n          current: sortedDates[i].toISOString().split('T')[0]\r\n        });\r\n        return false;\r\n      }\r\n    }\r\n    \r\n    return true;\r\n  };\r\n\r\n  // Initialize date range if provided separately via initialDateRange\r\n  useEffect(() => {\r\n    if (initialDateRange && initialDateRange.startDate && initialDateRange.endDate && !datesFromRange) {\r\n      // Check if we already have selectedDatesList populated\r\n      // If so, we need to determine if these are non-consecutive dates\r\n      if (selectedDatesList.length > 0 && !checkIfConsecutiveDates(selectedDatesList)) {\r\n        debugLog('MBA54321 Non-consecutive dates already loaded, not converting to range');\r\n        \r\n        // We already have non-consecutive dates, don't override with a range\r\n        if (onDateSelect) {\r\n          onDateSelect({\r\n            type: bookingType,\r\n            dates: selectedDatesList,\r\n            rangeType: 'multiple-days',\r\n            isValid: selectedDatesList.length > 0\r\n          });\r\n        }\r\n        return;\r\n      }\r\n      \r\n      const dateRange = [];\r\n      const currentDate = new Date(initialDateRange.startDate);\r\n      const endDate = new Date(initialDateRange.endDate);\r\n      \r\n      while (currentDate <= endDate) {\r\n        dateRange.push(new Date(currentDate));\r\n        currentDate.setDate(currentDate.getDate() + 1);\r\n      }\r\n      \r\n      setSelectedDatesList(dateRange);\r\n      setRangeStartDate(new Date(initialDateRange.startDate));\r\n      setDateRangeEnd(new Date(initialDateRange.endDate));\r\n      setDatesFromRange(true);\r\n\r\n      if (onDateSelect) {\r\n        onDateSelect({\r\n          type: bookingType,\r\n          dates: dateRange,\r\n          rangeType: 'date-range',\r\n          startDate: new Date(initialDateRange.startDate),\r\n          endDate: new Date(initialDateRange.endDate),\r\n          isValid: true\r\n        });\r\n      }\r\n    }\r\n  }, [initialDateRange, datesFromRange]);\r\n\r\n  const handleBookingTypeSelect = (type) => {\r\n    if (isOvernightForced) return; // Prevent booking type changes for overnight services\r\n    \r\n    if (is_DEBUG) {\r\n      console.log('MBA54321 Booking type selected:', type);\r\n    }\r\n    setSelectedBookingType(type);\r\n    // Clear selected dates when changing booking type\r\n    setSelectedDatesList([]);\r\n    setRangeStartDate(null);\r\n    setDateRangeEnd(null);\r\n    setDatesFromRange(false);\r\n  };\r\n\r\n  const handleDateRangeTypeSelect = (type) => {\r\n    if (is_DEBUG) {\r\n      console.log('MBA54321 Date range type selected:', type);\r\n      console.log('MBA54321 Current range data:', {\r\n        rangeStartDate,\r\n        dateRangeEnd,\r\n        selectedDatesList: selectedDatesList.length\r\n      });\r\n    }\r\n    \r\n    // Check if we're switching to date-range with non-consecutive dates\r\n    if (type === 'date-range' && selectedDatesList.length > 1 && !checkIfConsecutiveDates(selectedDatesList)) {\r\n      debugLog('MBA54321 Cannot switch to date-range with existing non-consecutive dates');\r\n      // The UI will handle this by clearing dates first, so we don't need additional handling here\r\n      return;\r\n    }\r\n    \r\n    setSelectedDateRangeType(type);\r\n    \r\n    if (type === 'date-range' && lastRangeSelection) {\r\n      // Only restore the last range selection when switching to date-range\r\n      // if those dates were actually consecutive\r\n      if (checkIfConsecutiveDates(lastRangeSelection.dates)) {\r\n        setRangeStartDate(lastRangeSelection.startDate);\r\n        setDateRangeEnd(lastRangeSelection.endDate);\r\n        setSelectedDatesList(lastRangeSelection.dates);\r\n        setDatesFromRange(true);\r\n        \r\n        if (onDateSelect) {\r\n          onDateSelect({\r\n            type: 'one-time',\r\n            dates: lastRangeSelection.dates,\r\n            rangeType: 'date-range',\r\n            startDate: lastRangeSelection.startDate,\r\n            endDate: lastRangeSelection.endDate,\r\n            isValid: true\r\n          });\r\n        }\r\n      } else {\r\n        // Current dates are not consecutive - keep in multiple-days mode and show warning\r\n        debugLog('MBA54321 Cannot switch to date-range with non-consecutive dates');\r\n        \r\n        // Revert the UI selection\r\n        setTimeout(() => {\r\n          setSelectedDateRangeType('multiple-days');\r\n        }, 100);\r\n        \r\n        // Keep the existing dates in multiple-days mode\r\n        if (onDateSelect) {\r\n          onDateSelect({\r\n            type: 'one-time',\r\n            dates: selectedDatesList,\r\n            rangeType: 'multiple-days',\r\n            isValid: selectedDatesList.length > 0\r\n          });\r\n        }\r\n      }\r\n    } else if (type === 'multiple-days') {\r\n      // Store the current range selection before switching to multiple-days\r\n      if (rangeStartDate && dateRangeEnd) {\r\n        setLastRangeSelection({\r\n          startDate: rangeStartDate,\r\n          endDate: dateRangeEnd,\r\n          dates: selectedDatesList\r\n        });\r\n      }\r\n      \r\n      // Keep the selected dates when switching to multiple-days\r\n      if (onDateSelect) {\r\n        onDateSelect({\r\n          type: 'one-time',\r\n          dates: selectedDatesList,\r\n          rangeType: 'multiple-days',\r\n          isValid: selectedDatesList.length > 0\r\n        });\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleDayOfWeekSelect = (dayIndex) => {\r\n    if (is_DEBUG) {\r\n      console.log('MBA54321 Day of week toggled:', dayIndex);\r\n    }\r\n    \r\n    setSelectedDaysOfWeek(prev => {\r\n      if (prev.includes(dayIndex)) {\r\n        return prev.filter(day => day !== dayIndex);\r\n      } else {\r\n        return [...prev, dayIndex];\r\n      }\r\n    });\r\n  };\r\n\r\n  const handleFrequencySelect = (frequency) => {\r\n    if (is_DEBUG) {\r\n      console.log('MBA54321 Frequency selected:', frequency);\r\n    }\r\n    setSelectedFrequency(frequency);\r\n  };\r\n\r\n  const goToPreviousMonth = () => {\r\n    const prevMonth = new Date(currentMonth);\r\n    prevMonth.setMonth(prevMonth.getMonth() - 1);\r\n    setCurrentMonth(prevMonth);\r\n  };\r\n\r\n  const goToNextMonth = () => {\r\n    const nextMonth = new Date(currentMonth);\r\n    nextMonth.setMonth(nextMonth.getMonth() + 1);\r\n    setCurrentMonth(nextMonth);\r\n  };\r\n\r\n  const isDateSelected = (date) => {\r\n    return selectedDatesList.some(selectedDate => {\r\n      // Ensure selectedDate is a proper Date object\r\n      if (!(selectedDate instanceof Date)) {\r\n        // Try to convert selectedDate to a Date if it's not already one\r\n        if (typeof selectedDate === 'string') {\r\n          selectedDate = new Date(selectedDate);\r\n        } else if (selectedDate && typeof selectedDate.date === 'string') {\r\n          selectedDate = new Date(selectedDate.date);\r\n        } else {\r\n          // Return false if we can't convert to a Date\r\n          return false;\r\n        }\r\n      }\r\n      \r\n      // Now safe to call Date methods\r\n      return selectedDate.getDate() === date.getDate() && \r\n             selectedDate.getMonth() === date.getMonth() && \r\n             selectedDate.getFullYear() === date.getFullYear();\r\n    });\r\n  };\r\n\r\n  const isDateInRange = (date) => {\r\n    if (!rangeStartDate || !dateRangeEnd) return false;\r\n    \r\n    return date >= rangeStartDate && date <= dateRangeEnd;\r\n  };\r\n\r\n  const handleDateSelection = (date) => {\r\n    if (is_DEBUG) {\r\n      console.log('MBA54321 Date selected:', date);\r\n    }\r\n\r\n    if (isOvernightForced || selectedDateRangeType === 'date-range') {\r\n      handleDateRangeSelection(date);\r\n    } else {\r\n      // Multiple days selection\r\n      toggleDateSelection(date);\r\n    }\r\n  };\r\n\r\n  const handleDateRangeSelection = (date) => {\r\n    if (is_DEBUG) {\r\n      console.log('MBA19ynkiy34b handleDateRangeSelection - date:', date);\r\n      console.log('MBA19ynkiy34b handleDateRangeSelection - current state:', {\r\n        rangeStartDate,\r\n        dateRangeEnd,\r\n        selectedDatesList: selectedDatesList.length\r\n      });\r\n    }\r\n\r\n    // If we have non-consecutive dates but we're in date-range mode,\r\n    // we should clear them first\r\n    if (selectedDatesList.length > 1 && !checkIfConsecutiveDates(selectedDatesList)) {\r\n      debugLog('MBA19ynkiy34b handleDateRangeSelection - clearing non-consecutive dates for date range');\r\n      setSelectedDatesList([date]);\r\n      setRangeStartDate(date);\r\n      setDateRangeEnd(null);\r\n      setDatesFromRange(false);\r\n      \r\n      if (onDateSelect) {\r\n        onDateSelect({\r\n          type: 'one-time',\r\n          dates: [date],\r\n          rangeType: 'date-range',\r\n          startDate: date,\r\n          isValid: false\r\n        });\r\n      }\r\n      return;\r\n    }\r\n\r\n    // First check if we already have non-consecutive dates selected\r\n    if (selectedDatesList.length > 1 && !checkIfConsecutiveDates(selectedDatesList)) {\r\n      // We have non-consecutive dates, so we should be in multiple-days mode\r\n      if (selectedDateRangeType !== 'multiple-days') {\r\n        debugLog('MBA19ynkiy34b Non-consecutive dates exist, forcing multiple-days mode');\r\n        setSelectedDateRangeType('multiple-days');\r\n      }\r\n      \r\n      // Handle the date click as a toggle in multiple-days mode\r\n      toggleDateSelection(date);\r\n      return;\r\n    }\r\n\r\n    if (!rangeStartDate) {\r\n      setRangeStartDate(date);\r\n      setSelectedDatesList([date]);\r\n      setDateRangeEnd(null);\r\n      setLastRangeSelection(null); // Clear last range when starting new selection\r\n      if (is_DEBUG) console.log('MBA19ynkiy34b handleDateRangeSelection - first date selected');\r\n      if (onDateSelect) {\r\n        onDateSelect({\r\n          type: 'one-time',\r\n          dates: [date],\r\n          rangeType: 'date-range',\r\n          startDate: date,\r\n          isValid: false\r\n        });\r\n      }\r\n    } else if (!dateRangeEnd) {\r\n      let startDate = new Date(rangeStartDate);\r\n      let endDate = new Date(date);\r\n      \r\n      if (date < rangeStartDate) {\r\n        startDate = new Date(date);\r\n        endDate = new Date(rangeStartDate);\r\n      }\r\n      \r\n      setDateRangeEnd(endDate);\r\n      \r\n      const dateRange = [];\r\n      const currentDate = new Date(startDate);\r\n      \r\n      while (currentDate <= endDate) {\r\n        dateRange.push(new Date(currentDate));\r\n        currentDate.setDate(currentDate.getDate() + 1);\r\n      }\r\n      \r\n      setSelectedDatesList(dateRange);\r\n      // Store the new range selection\r\n      setLastRangeSelection({\r\n        startDate: startDate,\r\n        endDate: endDate,\r\n        dates: dateRange\r\n      });\r\n\r\n      if (onDateSelect) {\r\n        const data = {\r\n          type: 'one-time',\r\n          dates: dateRange,\r\n          rangeType: 'date-range',\r\n          startDate: startDate,\r\n          endDate: endDate,\r\n          isValid: true\r\n        };\r\n        if (is_DEBUG) console.log('MBA19ynkiy34b handleDateRangeSelection - complete range selected, sending data:', data);\r\n        onDateSelect(data);\r\n      }\r\n    } else {\r\n      setRangeStartDate(date);\r\n      setSelectedDatesList([date]);\r\n      setDateRangeEnd(null);\r\n      setLastRangeSelection(null); // Clear last range when starting new selection\r\n      if (is_DEBUG) console.log('MBA19ynkiy34b handleDateRangeSelection - resetting selection');\r\n      if (onDateSelect) {\r\n        onDateSelect({\r\n          type: 'one-time',\r\n          dates: [date],\r\n          rangeType: 'date-range',\r\n          startDate: date,\r\n          isValid: false\r\n        });\r\n      }\r\n    }\r\n  };\r\n\r\n  const toggleDateSelection = (date) => {\r\n    if (is_DEBUG) {\r\n      console.log('MBA19ynkiy34b toggleDateSelection - date:', date);\r\n      console.log('MBA19ynkiy34b toggleDateSelection - current selected dates:', selectedDatesList.length);\r\n    }\r\n\r\n    const isAlreadySelected = isDateSelected(date);\r\n    let newSelectedDates;\r\n    \r\n    if (isAlreadySelected) {\r\n      newSelectedDates = selectedDatesList.filter(selectedDate => {\r\n        // Ensure selectedDate is a proper Date object\r\n        if (!(selectedDate instanceof Date)) {\r\n          // Try to convert to date if needed\r\n          if (typeof selectedDate === 'string') {\r\n            selectedDate = new Date(selectedDate);\r\n          } else if (selectedDate && typeof selectedDate.date === 'string') {\r\n            selectedDate = new Date(selectedDate.date);\r\n          } else {\r\n            // Can't compare, so keep this entry\r\n            return true;\r\n          }\r\n        }\r\n        \r\n        return !(selectedDate.getDate() === date.getDate() && \r\n                 selectedDate.getMonth() === date.getMonth() && \r\n                 selectedDate.getFullYear() === date.getFullYear());\r\n      });\r\n    } else {\r\n      newSelectedDates = [...selectedDatesList, date].sort((a, b) => a - b);\r\n    }\r\n    \r\n    setSelectedDatesList(newSelectedDates);\r\n\r\n    if (onDateSelect) {\r\n      const data = {\r\n        type: 'one-time',\r\n        dates: newSelectedDates,\r\n        rangeType: 'multiple-days',\r\n        isValid: newSelectedDates.length > 0\r\n      };\r\n      if (is_DEBUG) {\r\n        console.log('MBA19ynkiy34b toggleDateSelection - sending data:', data);\r\n        console.log('MBA19ynkiy34b toggleDateSelection - newSelectedDates length:', newSelectedDates.length);\r\n      }\r\n      onDateSelect(data);\r\n    }\r\n  };\r\n\r\n  const handleRecurringDateSelect = (date) => {\r\n    if (is_DEBUG) {\r\n      console.log('MBA19ynkiy34b handleRecurringDateSelect - date:', date);\r\n      console.log('MBA19ynkiy34b handleRecurringDateSelect - current state:', {\r\n        tempRangeStart,\r\n        selectedDaysOfWeek: selectedDaysOfWeek.length,\r\n        frequency: selectedFrequency\r\n      });\r\n    }\r\n    \r\n    if (!tempRangeStart) {\r\n      setTempRangeStart(date);\r\n      setRecurringStartDate(date);\r\n      if (is_DEBUG) console.log('MBA19ynkiy34b handleRecurringDateSelect - first date selected');\r\n      if (onDateSelect) {\r\n        onDateSelect({\r\n          type: 'recurring',\r\n          startDate: date,\r\n          daysOfWeek: selectedDaysOfWeek,\r\n          frequency: selectedFrequency,\r\n          isValid: false\r\n        });\r\n      }\r\n    } else {\r\n      let startDate = tempRangeStart;\r\n      let endDate = date;\r\n      \r\n      if (date < tempRangeStart) {\r\n        startDate = date;\r\n        endDate = tempRangeStart;\r\n      }\r\n      \r\n      setRecurringStartDate(startDate);\r\n      setRecurringEndDate(endDate);\r\n      setTempRangeStart(null);\r\n      setTempRangeEnd(null);\r\n      setShowRecurringDropdownCalendar(false);\r\n\r\n      if (onDateSelect) {\r\n        const data = {\r\n          type: 'recurring',\r\n          daysOfWeek: selectedDaysOfWeek,\r\n          frequency: selectedFrequency,\r\n          startDate: startDate,\r\n          endDate: endDate,\r\n          isValid: selectedDaysOfWeek.length > 0\r\n        };\r\n        if (is_DEBUG) {\r\n          console.log('MBA19ynkiy34b handleRecurringDateSelect - complete selection, sending data:', data);\r\n          console.log('MBA19ynkiy34b handleRecurringDateSelect - selectedDaysOfWeek:', selectedDaysOfWeek);\r\n        }\r\n        onDateSelect(data);\r\n      }\r\n    }\r\n  };\r\n\r\n  const isDateInTempRange = (date) => {\r\n    if (!tempRangeStart || !date) return false;\r\n    // Only highlight the tempRangeStart date if no end date is selected yet\r\n    if (!tempRangeEnd) {\r\n      return date.getTime() === tempRangeStart.getTime();\r\n    }\r\n    // Otherwise highlight the range between start and end\r\n    return date >= tempRangeStart && date <= tempRangeEnd;\r\n  };\r\n\r\n  const openRecurringCalendar = (isStart) => {\r\n    setIsSelectingStartDate(isStart);\r\n    setShowRecurringCalendar(true);\r\n  };\r\n\r\n  const isDateSelectable = (date) => {\r\n    const today = new Date();\r\n    today.setHours(0, 0, 0, 0);\r\n    \r\n    // Allow selection of dates from previous month that are visible\r\n    if (date.getMonth() < currentMonth.getMonth()) {\r\n      return date.getMonth() === ((currentMonth.getMonth() - 1 + 12) % 12) &&\r\n             date >= today;\r\n    }\r\n    \r\n    // Allow selection of dates from next month that are visible\r\n    if (date.getMonth() > currentMonth.getMonth()) {\r\n      return date.getMonth() === ((currentMonth.getMonth() + 1) % 12) &&\r\n             date >= today;\r\n    }\r\n    \r\n    return date >= today;\r\n  };\r\n\r\n  const getSelectedDaysText = () => {\r\n    const dayNames = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];\r\n    const selectedDays = selectedDaysOfWeek.map(dayIndex => dayNames[dayIndex]);\r\n    \r\n    if (selectedDays.length === 0) return 'No days selected';\r\n    \r\n    let daysText = '';\r\n    if (selectedDays.length === 1) {\r\n      daysText = selectedDays[0];\r\n    } else if (selectedDays.length === 2) {\r\n      daysText = `${selectedDays[0]} and ${selectedDays[1]}`;\r\n    } else {\r\n      const lastDay = selectedDays.pop();\r\n      daysText = `${selectedDays.join(', ')}, and ${lastDay}`;\r\n    }\r\n\r\n    switch (selectedFrequency) {\r\n      case 'bi-weekly':\r\n        return `every other ${daysText}`;\r\n      case 'monthly':\r\n        const weekNum = getWeekOfMonth(recurringStartDate);\r\n        return `the ${weekNum} ${daysText} of each month`;\r\n      default:\r\n        return `every ${daysText}`;\r\n    }\r\n  };\r\n\r\n  const getWeekOfMonth = (date) => {\r\n    const week = Math.ceil((date.getDate() + (date.getDay() === 0 ? 6 : date.getDay() - 1)) / 7);\r\n    const suffixes = ['first', 'second', 'third', 'fourth', 'last'];\r\n    return suffixes[Math.min(week - 1, 4)];\r\n  };\r\n\r\n  const renderCalendar = () => {\r\n    const monthStart = new Date(currentMonth.getFullYear(), currentMonth.getMonth(), 1);\r\n    const monthEnd = new Date(currentMonth.getFullYear(), currentMonth.getMonth() + 1, 0);\r\n    const startDate = new Date(monthStart);\r\n    const endDate = new Date(monthEnd);\r\n    \r\n    startDate.setDate(startDate.getDate() - startDate.getDay());\r\n    endDate.setDate(endDate.getDate() + (6 - endDate.getDay()));\r\n    \r\n    const weeks = [];\r\n    let days = [];\r\n    let day = new Date(startDate);\r\n    \r\n    while (day <= endDate) {\r\n      for (let i = 0; i < 7; i++) {\r\n        days.push(new Date(day));\r\n        day.setDate(day.getDate() + 1);\r\n      }\r\n      weeks.push(days);\r\n      days = [];\r\n    }\r\n\r\n    const monthName = currentMonth.toLocaleString('default', { month: 'long' });\r\n    const year = currentMonth.getFullYear();\r\n\r\n    return (\r\n      <View style={styles.calendarContainer}>\r\n        <View style={styles.calendarHeader}>\r\n          <TouchableOpacity onPress={goToPreviousMonth} style={styles.calendarNavButton}>\r\n            <Text style={styles.calendarNavButtonText}>{'<'}</Text>\r\n          </TouchableOpacity>\r\n          <Text style={styles.calendarTitle}>{`${monthName} ${year}`}</Text>\r\n          <TouchableOpacity onPress={goToNextMonth} style={styles.calendarNavButton}>\r\n            <Text style={styles.calendarNavButtonText}>{'>'}</Text>\r\n          </TouchableOpacity>\r\n        </View>\r\n        \r\n        <View style={styles.weekdaysContainer}>\r\n          {['S', 'M', 'T', 'W', 'T', 'F', 'S'].map((day, index) => (\r\n            <Text key={`weekday-${index}`} style={styles.weekdayText}>{day}</Text>\r\n          ))}\r\n        </View>\r\n        \r\n        {weeks.map((week, weekIndex) => (\r\n          <View key={`week-${weekIndex}`} style={styles.weekRow}>\r\n            {week.map((date, dateIndex) => {\r\n              const isSelectable = isDateSelectable(date);\r\n              const isSelected = isDateSelected(date);\r\n              const isInRange = selectedDateRangeType === 'date-range' && isDateInRange(date);\r\n              const isInTempRange = showRecurringDropdownCalendar && isDateInTempRange(date);\r\n              \r\n              return (\r\n                <TouchableOpacity\r\n                  key={`date-${weekIndex}-${dateIndex}`}\r\n                  style={[\r\n                    styles.dateCell,\r\n                    !isSelectable && styles.otherMonthDate,\r\n                    isSelected && styles.selectedDate,\r\n                    isInRange && styles.dateInRange,\r\n                    isInTempRange && styles.dateInRange,\r\n                  ]}\r\n                  onPress={() => isSelectable && (showRecurringDropdownCalendar ? handleRecurringDateSelect(date) : handleDateSelection(date))}\r\n                  disabled={!isSelectable}\r\n                >\r\n                  <Text style={[\r\n                    styles.dateText,\r\n                    !isSelectable && styles.otherMonthDateText,\r\n                    (isSelected || isInRange || isInTempRange) && styles.selectedDateText,\r\n                  ]}>\r\n                    {date.getDate()}\r\n                  </Text>\r\n                </TouchableOpacity>\r\n              );\r\n            })}\r\n          </View>\r\n        ))}\r\n      </View>\r\n    );\r\n  };\r\n\r\n  const formatSelectedDate = (date) => {\r\n    const monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];\r\n    const month = monthNames[date.getMonth()];\r\n    const day = date.getDate();\r\n    const year = date.getFullYear();\r\n    return `${month} ${day}, ${year}`;\r\n  };\r\n\r\n  const clearDateRange = () => {\r\n    if (is_DEBUG) {\r\n      console.log('MBA54321 Clearing date range');\r\n    }\r\n    \r\n    setSelectedDatesList([]);\r\n    setRangeStartDate(null);\r\n    setDateRangeEnd(null);\r\n    setDatesFromRange(false);\r\n    setLastRangeSelection(null);\r\n\r\n    if (onDateSelect) {\r\n      onDateSelect({\r\n        type: 'one-time',\r\n        dates: [],\r\n        rangeType: selectedDateRangeType,\r\n        startDate: null,\r\n        endDate: null,\r\n        isValid: false\r\n      });\r\n    }\r\n  };\r\n\r\n  const renderSelectedDates = () => {\r\n    if (selectedDatesList.length === 0) {\r\n      return null;\r\n    }\r\n\r\n    // If we have a date range and we're in date-range mode\r\n    if (selectedDateRangeType === 'date-range' && (dateRangeEnd || (datesFromRange && initialDateRange))) {\r\n      const startDate = rangeStartDate || initialDateRange?.startDate || selectedDatesList[0];\r\n      const endDate = dateRangeEnd || initialDateRange?.endDate || selectedDatesList[selectedDatesList.length - 1];\r\n      \r\n      return (\r\n        <View style={styles.selectedDatesContainer}>\r\n          <Text style={styles.selectedDatesTitle}>Selected Range:</Text>\r\n          <View style={styles.dateRangeChip}>\r\n            <Text style={styles.dateRangeText}>\r\n              From {formatSelectedDate(startDate)} to {formatSelectedDate(endDate)}\r\n            </Text>\r\n            <TouchableOpacity \r\n              onPress={clearDateRange}\r\n              style={styles.removeRangeButton}\r\n            >\r\n              <Text style={styles.removeButtonText}>×</Text>\r\n            </TouchableOpacity>\r\n          </View>\r\n        </View>\r\n      );\r\n    }\r\n\r\n    // For multiple days selection or when in multiple-days mode\r\n    return (\r\n      <View style={styles.selectedDatesContainer}>\r\n        <Text style={styles.selectedDatesTitle}>Selected Dates:</Text>\r\n        <View style={styles.selectedDatesList}>\r\n          {selectedDatesList.map((date, index) => (\r\n            <View key={`selected-date-${index}`} style={styles.selectedDateChip}>\r\n              <Text style={styles.selectedDateChipText}>{formatSelectedDate(date)}</Text>\r\n              <TouchableOpacity \r\n                onPress={() => toggleDateSelection(date)}\r\n                style={styles.removeButton}\r\n              >\r\n                <Text style={styles.removeButtonText}>×</Text>\r\n              </TouchableOpacity>\r\n            </View>\r\n          ))}\r\n        </View>\r\n      </View>\r\n    );\r\n  };\r\n\r\n  const renderRecurringDropdownCalendar = () => {\r\n    if (!showRecurringDropdownCalendar) return null;\r\n\r\n    return (\r\n      <View style={styles.dropdownCalendar}>\r\n        <View style={styles.dropdownCalendarContent}>\r\n          {renderCalendar()}\r\n          <TouchableOpacity\r\n            style={styles.dropdownCloseButton}\r\n            onPress={() => {\r\n              setShowRecurringDropdownCalendar(false);\r\n              setTempRangeStart(null);\r\n              setTempRangeEnd(null);\r\n            }}\r\n          >\r\n            <Text style={styles.dropdownCloseButtonText}>Cancel</Text>\r\n          </TouchableOpacity>\r\n        </View>\r\n      </View>\r\n    );\r\n  };\r\n\r\n  const renderDateRangeSection = () => {\r\n    return (\r\n      <View style={styles.dateRangeSection}>\r\n        <View style={styles.dateRangeRow}>\r\n          <TouchableOpacity \r\n            style={styles.dateRangeColumn}\r\n            onPress={() => setShowRecurringDropdownCalendar(true)}\r\n          >\r\n            <Text style={styles.dateRangeLabel}>From</Text>\r\n            <Text style={styles.dateRangeValue}>\r\n              {formatSelectedDate(recurringStartDate)}\r\n            </Text>\r\n          </TouchableOpacity>\r\n          <TouchableOpacity \r\n            style={styles.dateRangeColumn}\r\n            onPress={() => setShowRecurringDropdownCalendar(true)}\r\n          >\r\n            <Text style={styles.dateRangeLabel}>To</Text>\r\n            <Text style={styles.dateRangeValue}>\r\n              {formatSelectedDate(recurringEndDate)}\r\n            </Text>\r\n          </TouchableOpacity>\r\n        </View>\r\n        {renderRecurringDropdownCalendar()}\r\n      </View>\r\n    );\r\n  };\r\n\r\n  const renderRecurringOptions = () => {\r\n    if (selectedBookingType !== 'recurring') return null;\r\n\r\n    return (\r\n      <View style={styles.recurringOptionsContainer}>\r\n        <Text style={styles.sectionTitle}>Repeat on</Text>\r\n        <View style={styles.daysOfWeekContainer}>\r\n          {['M', 'T', 'W', 'T', 'F', 'S', 'S'].map((day, index) => {\r\n            // Adjust index to match JavaScript day of week (0=Sun, 1=Mon, etc.)\r\n            const dayIndex = index === 6 ? 0 : index + 1;\r\n            const isSelected = selectedDaysOfWeek.includes(dayIndex);\r\n            \r\n            return (\r\n              <TouchableOpacity\r\n                key={`day-${index}`}\r\n                style={[\r\n                  styles.dayOfWeekButton,\r\n                  isSelected && styles.selectedDayOfWeekButton\r\n                ]}\r\n                onPress={() => handleDayOfWeekSelect(dayIndex)}\r\n              >\r\n                <Text style={[\r\n                  styles.dayOfWeekText,\r\n                  isSelected && styles.selectedDayOfWeekText\r\n                ]}>{day}</Text>\r\n              </TouchableOpacity>\r\n            );\r\n          })}\r\n        </View>\r\n\r\n        {renderDateRangeSection()}\r\n\r\n        <Text style={styles.sectionTitle}>Frequency</Text>\r\n        <View style={styles.frequencyContainer}>\r\n          <TouchableOpacity\r\n            style={[\r\n              styles.frequencyButton,\r\n              selectedFrequency === 'weekly' && styles.selectedFrequencyButton\r\n            ]}\r\n            onPress={() => handleFrequencySelect('weekly')}\r\n          >\r\n            <Text style={[\r\n              styles.frequencyText,\r\n              selectedFrequency === 'weekly' && styles.selectedFrequencyText\r\n            ]}>Weekly</Text>\r\n          </TouchableOpacity>\r\n          <TouchableOpacity\r\n            style={[\r\n              styles.frequencyButton,\r\n              selectedFrequency === 'bi-weekly' && styles.selectedFrequencyButton\r\n            ]}\r\n            onPress={() => handleFrequencySelect('bi-weekly')}\r\n          >\r\n            <Text style={[\r\n              styles.frequencyText,\r\n              selectedFrequency === 'bi-weekly' && styles.selectedFrequencyText\r\n            ]}>Bi-weekly</Text>\r\n          </TouchableOpacity>\r\n          <TouchableOpacity\r\n            style={[\r\n              styles.frequencyButton,\r\n              selectedFrequency === 'monthly' && styles.selectedFrequencyButton\r\n            ]}\r\n            onPress={() => handleFrequencySelect('monthly')}\r\n          >\r\n            <Text style={[\r\n              styles.frequencyText,\r\n              selectedFrequency === 'monthly' && styles.selectedFrequencyText\r\n            ]}>Monthly</Text>\r\n          </TouchableOpacity>\r\n        </View>\r\n\r\n        <View style={styles.recurrencePatternContainer}>\r\n          <Text style={styles.recurrencePatternTitle}>Recurrence Pattern:</Text>\r\n          <Text style={styles.recurrencePatternText}>\r\n            {getSelectedDaysText()}\r\n          </Text>\r\n          <Text style={styles.recurrencePatternText}>\r\n            From {formatSelectedDate(recurringStartDate)} to {formatSelectedDate(recurringEndDate)}\r\n          </Text>\r\n          <TouchableOpacity\r\n            style={styles.previewButton}\r\n            onPress={() => setShowRecurringPreview(true)}\r\n          >\r\n            <Text style={styles.previewButtonText}>View on Calendar</Text>\r\n          </TouchableOpacity>\r\n        </View>\r\n      </View>\r\n    );\r\n  };\r\n\r\n  const RecurringCalendarPreview = () => {\r\n    const [previewMonth, setPreviewMonth] = useState(new Date(recurringStartDate));\r\n    \r\n    const getRecurringDates = () => {\r\n      if (!recurringStartDate || !recurringEndDate || selectedDaysOfWeek.length === 0) {\r\n        return new Set();\r\n      }\r\n\r\n      const dates = new Set();\r\n      const current = new Date(recurringStartDate);\r\n      const end = new Date(recurringEndDate);\r\n      \r\n      while (current <= end) {\r\n        if (selectedDaysOfWeek.includes(current.getDay())) {\r\n          if (selectedFrequency === 'weekly') {\r\n            dates.add(new Date(current).getTime());\r\n          } else if (selectedFrequency === 'bi-weekly') {\r\n            const weeks = Math.floor((current - recurringStartDate) / (7 * 24 * 60 * 60 * 1000));\r\n            if (weeks % 2 === 0) {\r\n              dates.add(new Date(current).getTime());\r\n            }\r\n          } else if (selectedFrequency === 'monthly') {\r\n            const startWeek = getWeekOfMonth(recurringStartDate);\r\n            const currentWeek = getWeekOfMonth(current);\r\n            if (startWeek === currentWeek) {\r\n              dates.add(new Date(current).getTime());\r\n            }\r\n          }\r\n        }\r\n        current.setDate(current.getDate() + 1);\r\n      }\r\n      return dates;\r\n    };\r\n\r\n    const goToPreviousMonth = () => {\r\n      const prevMonth = new Date(previewMonth);\r\n      prevMonth.setMonth(prevMonth.getMonth() - 1);\r\n      setPreviewMonth(prevMonth);\r\n    };\r\n\r\n    const goToNextMonth = () => {\r\n      const nextMonth = new Date(previewMonth);\r\n      nextMonth.setMonth(nextMonth.getMonth() + 1);\r\n      setPreviewMonth(nextMonth);\r\n    };\r\n\r\n    const renderPreviewCalendar = () => {\r\n      const monthStart = new Date(previewMonth.getFullYear(), previewMonth.getMonth(), 1);\r\n      const monthEnd = new Date(previewMonth.getFullYear(), previewMonth.getMonth() + 1, 0);\r\n      const startDate = new Date(monthStart);\r\n      const endDate = new Date(monthEnd);\r\n      \r\n      startDate.setDate(startDate.getDate() - startDate.getDay());\r\n      endDate.setDate(endDate.getDate() + (6 - endDate.getDay()));\r\n      \r\n      const weeks = [];\r\n      let days = [];\r\n      let day = new Date(startDate);\r\n      const recurringDates = getRecurringDates();\r\n      \r\n      while (day <= endDate) {\r\n        for (let i = 0; i < 7; i++) {\r\n          days.push(new Date(day));\r\n          day.setDate(day.getDate() + 1);\r\n        }\r\n        weeks.push(days);\r\n        days = [];\r\n      }\r\n\r\n      const monthName = previewMonth.toLocaleString('default', { month: 'long' });\r\n      const year = previewMonth.getFullYear();\r\n\r\n      return (\r\n        <View style={styles.previewCalendarContainer}>\r\n          <View style={styles.calendarHeader}>\r\n            <TouchableOpacity onPress={goToPreviousMonth} style={styles.calendarNavButton}>\r\n              <Text style={styles.calendarNavButtonText}>{'<'}</Text>\r\n            </TouchableOpacity>\r\n            <Text style={styles.calendarTitle}>{`${monthName} ${year}`}</Text>\r\n            <TouchableOpacity onPress={goToNextMonth} style={styles.calendarNavButton}>\r\n              <Text style={styles.calendarNavButtonText}>{'>'}</Text>\r\n            </TouchableOpacity>\r\n          </View>\r\n          \r\n          <View style={styles.weekdaysContainer}>\r\n            {['S', 'M', 'T', 'W', 'T', 'F', 'S'].map((day, index) => (\r\n              <Text key={`weekday-${index}`} style={styles.weekdayText}>{day}</Text>\r\n            ))}\r\n          </View>\r\n          \r\n          {weeks.map((week, weekIndex) => (\r\n            <View key={`week-${weekIndex}`} style={styles.weekRow}>\r\n              {week.map((date, dateIndex) => {\r\n                const isCurrentMonth = date.getMonth() === previewMonth.getMonth();\r\n                const isRecurring = recurringDates.has(date.getTime());\r\n                \r\n                return (\r\n                  <View\r\n                    key={`date-${weekIndex}-${dateIndex}`}\r\n                    style={[\r\n                      styles.previewDateCell,\r\n                      !isCurrentMonth && styles.otherMonthDate,\r\n                      isRecurring && styles.recurringDate,\r\n                    ]}\r\n                  >\r\n                    <Text style={[\r\n                      styles.dateText,\r\n                      !isCurrentMonth && styles.otherMonthDateText,\r\n                      isRecurring && styles.recurringDateText,\r\n                    ]}>\r\n                      {date.getDate()}\r\n                    </Text>\r\n                  </View>\r\n                );\r\n              })}\r\n            </View>\r\n          ))}\r\n        </View>\r\n      );\r\n    };\r\n\r\n    return (\r\n      <Modal\r\n        visible={showRecurringPreview}\r\n        transparent={true}\r\n        animationType=\"fade\"\r\n        onRequestClose={() => setShowRecurringPreview(false)}\r\n      >\r\n        <View style={styles.modalOverlay}>\r\n          <View style={[styles.modalContent, styles.previewModalContent]}>\r\n            <Text style={styles.modalTitle}>Recurring Dates Preview</Text>\r\n            {renderPreviewCalendar()}\r\n            <TouchableOpacity\r\n              style={styles.modalCloseButton}\r\n              onPress={() => setShowRecurringPreview(false)}\r\n            >\r\n              <Text style={styles.modalCloseButtonText}>Close</Text>\r\n            </TouchableOpacity>\r\n          </View>\r\n        </View>\r\n      </Modal>\r\n    );\r\n  };\r\n\r\n  // Remove the useEffect for date validation since we're handling it directly in the handlers\r\n  useEffect(() => {\r\n    if (is_DEBUG) {\r\n      console.log('MBA19ynkiy34b Component mounted with:', {\r\n        selectedDates,\r\n        bookingType,\r\n        dateRangeType\r\n      });\r\n    }\r\n  }, []);\r\n\r\n  return (\r\n    <ScrollView style={styles.container}>\r\n      {/* TODO: Add back recurring options once implemented after MVP */}\r\n      {isOvernightForced || selectedBookingType === 'one-time' ? (\r\n        <View style={styles.oneTimeOptionsContainer}>\r\n          <Text style={[styles.dateSelectionTitle, { fontSize: screenWidth > 768 ? 24 : 18 }]}>\r\n            {isOvernightForced \r\n              ? \"Select a date range\" \r\n              : \"Select one or more dates\"}\r\n          </Text>\r\n          \r\n          {renderCalendar()}\r\n          {renderSelectedDates()}\r\n        </View>\r\n      ) : renderRecurringOptions()}\r\n      \r\n      <RecurringCalendarPreview />\r\n    </ScrollView>\r\n  );\r\n};\r\n\r\nconst { width, height } = Dimensions.get('window');\r\nconst maxCalendarHeight = height * 0.4;\r\nconst isDesktopView = width > 480;\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    backgroundColor: theme.colors.background,\r\n    padding: 12,\r\n    minHeight: isDesktopView ? 600 : 'auto',\r\n  },\r\n  bookingTypeContainer: {\r\n    flexDirection: 'row',\r\n    marginBottom: 12,\r\n    borderRadius: 8,\r\n    overflow: 'hidden',\r\n  },\r\n  bookingTypeButton: {\r\n    flex: 1,\r\n    paddingVertical: 12,\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    backgroundColor: '#e8e8e8', // Light gray for inactive buttons\r\n  },\r\n  selectedBookingTypeButton: {\r\n    backgroundColor: theme.colors.mainColors.main,\r\n  },\r\n  bookingTypeText: {\r\n    fontSize: 16,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    color: theme.colors.text,\r\n  },\r\n  selectedBookingTypeText: {\r\n    color: theme.colors.surface,\r\n    fontWeight: '600',\r\n  },\r\n  dateRangeTypeContainer: {\r\n    flexDirection: 'row',\r\n    marginBottom: 12,\r\n    borderRadius: 8,\r\n    overflow: 'hidden',\r\n  },\r\n  dateRangeTypeButton: {\r\n    flex: 1,\r\n    paddingVertical: 12,\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    backgroundColor: '#e8e8e8', // Light gray for inactive buttons\r\n  },\r\n  selectedDateRangeTypeButton: {\r\n    backgroundColor: theme.colors.mainColors.main,\r\n  },\r\n  dateRangeTypeText: {\r\n    fontSize: 16,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    color: theme.colors.text,\r\n  },\r\n  selectedDateRangeTypeText: {\r\n    color: theme.colors.surface,\r\n    fontWeight: '600',\r\n  },\r\n  calendarContainer: {\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 8,\r\n    padding: 12,\r\n    marginBottom: 12,\r\n    maxHeight: isDesktopView ? (width > 700 ? 600 : 500) : maxCalendarHeight,\r\n    overflow: 'visible',\r\n    minHeight: isDesktopView ? (width > 700 ? 500 : 400) : 350,\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n  },\r\n  calendarHeader: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    marginBottom: 8,\r\n  },\r\n  calendarTitle: {\r\n    fontSize: 16,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    fontWeight: '600',\r\n    color: theme.colors.text,\r\n  },\r\n  calendarNavButton: {\r\n    padding: 6,\r\n  },\r\n  calendarNavButtonText: {\r\n    fontSize: 18,\r\n    color: theme.colors.text,\r\n  },\r\n  weekdaysContainer: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-around',\r\n    marginBottom: isDesktopView ? 8 : 4,\r\n    paddingHorizontal: 4,\r\n  },\r\n  weekdayText: {\r\n    flex: 1,\r\n    textAlign: 'center',\r\n    fontSize: 12,\r\n    color: theme.colors.text,\r\n    opacity: 0.7,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  weekRow: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-around',\r\n    marginBottom: isDesktopView ? 12 : 4,\r\n    minHeight: isDesktopView ? (width > 700 ? 70 : 50) : 40,\r\n    flex: 1,\r\n    paddingHorizontal: 4,\r\n  },\r\n  dateCell: {\r\n    flex: 1,\r\n    aspectRatio: 1,\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    borderRadius: 4,\r\n    padding: isDesktopView ? 4 : 2,\r\n    minHeight: isDesktopView ? (width > 700 ? 60 : 40) : 'auto',\r\n  },\r\n  dateText: {\r\n    fontSize: isDesktopView ? (width > 700 ? 16 : 14) : 14,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  otherMonthDate: {\r\n    opacity: 0.3,\r\n  },\r\n  otherMonthDateText: {\r\n    color: theme.colors.placeHolderText,\r\n  },\r\n  selectedDate: {\r\n    backgroundColor: theme.colors.mainColors.main,\r\n  },\r\n  dateInRange: {\r\n    backgroundColor: `${theme.colors.mainColors.main}80`, // 50% opacity\r\n  },\r\n  selectedDateText: {\r\n    color: theme.colors.surface,\r\n    fontWeight: '600',\r\n  },\r\n  selectedDatesContainer: {\r\n    marginTop: 12,\r\n  },\r\n  selectedDatesTitle: {\r\n    fontSize: 14,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    fontWeight: '600',\r\n    marginBottom: 6,\r\n    color: theme.colors.text,\r\n  },\r\n  selectedDatesList: {\r\n    flexDirection: 'row',\r\n    flexWrap: 'wrap',\r\n    gap: 6,\r\n  },\r\n  selectedDateChip: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    backgroundColor: theme.colors.backgroundContrast,\r\n    borderRadius: 16,\r\n    paddingVertical: 6,\r\n    paddingLeft: 10,\r\n    paddingRight: 6,\r\n    marginRight: 6,\r\n    marginBottom: 6,\r\n  },\r\n  selectedDateChipText: {\r\n    color: theme.colors.mainColors.main,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    fontSize: 12,\r\n    marginRight: 2,\r\n  },\r\n  removeButton: {\r\n    marginLeft: 4,\r\n    padding: 2,\r\n  },\r\n  removeButtonText: {\r\n    fontSize: 16,\r\n    color: theme.colors.mainColors.main,\r\n    fontWeight: 'bold',\r\n  },\r\n  dateRangeText: {\r\n    fontSize: 14,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    marginBottom: 8,\r\n  },\r\n  recurringOptionsContainer: {\r\n    marginTop: 8,\r\n  },\r\n  sectionTitle: {\r\n    fontSize: 16,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    fontWeight: '600',\r\n    marginBottom: 8,\r\n    color: theme.colors.text,\r\n  },\r\n  daysOfWeekContainer: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    marginBottom: 16,\r\n  },\r\n  dayOfWeekButton: {\r\n    width: 40,\r\n    height: 40,\r\n    borderRadius: 20,\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    backgroundColor: '#e8e8e8', // Light gray for inactive buttons\r\n  },\r\n  selectedDayOfWeekButton: {\r\n    backgroundColor: theme.colors.mainColors.main,\r\n  },\r\n  dayOfWeekText: {\r\n    fontSize: 14,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  selectedDayOfWeekText: {\r\n    color: theme.colors.surface,\r\n    fontWeight: '600',\r\n  },\r\n  dateRangeSection: {\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 8,\r\n    padding: 12,\r\n    marginBottom: 16,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.modernBorder,\r\n  },\r\n  dateRangeRow: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n  },\r\n  dateRangeColumn: {\r\n    flex: 1,\r\n    backgroundColor: theme.colors.surface,\r\n    padding: 8,\r\n    borderRadius: 8,\r\n    // borderWidth: 1,\r\n    // borderColor: theme.colors.modernBorder,\r\n  },\r\n  dateRangeLabel: {\r\n    fontSize: 14,\r\n    color: theme.colors.text,\r\n    opacity: 0.7,\r\n    marginBottom: 4,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  dateRangeValue: {\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    fontWeight: '600',\r\n  },\r\n  frequencyContainer: {\r\n    flexDirection: 'row',\r\n    marginBottom: 16,\r\n  },\r\n  frequencyButton: {\r\n    flex: 1,\r\n    paddingVertical: 10,\r\n    paddingHorizontal: 8,\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    backgroundColor: '#e8e8e8', // Light gray for inactive buttons\r\n    borderRadius: 8,\r\n    marginRight: 8,\r\n  },\r\n  selectedFrequencyButton: {\r\n    backgroundColor: theme.colors.mainColors.main,\r\n  },\r\n  frequencyText: {\r\n    fontSize: 14,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  selectedFrequencyText: {\r\n    color: theme.colors.surface,\r\n    fontWeight: '600',\r\n  },\r\n  recurrencePatternContainer: {\r\n    backgroundColor: theme.colors.backgroundContrast,\r\n    borderRadius: 8,\r\n    padding: 12,\r\n    marginBottom: 16,\r\n  },\r\n  recurrencePatternTitle: {\r\n    fontSize: 14,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    fontWeight: '600',\r\n    marginBottom: 4,\r\n    color: theme.colors.text,\r\n  },\r\n  recurrencePatternText: {\r\n    fontSize: 14,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    marginBottom: 2,\r\n  },\r\n  modalOverlay: {\r\n    flex: 1,\r\n    backgroundColor: 'rgba(0, 0, 0, 0.5)',\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n  },\r\n  modalContent: {\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 12,\r\n    padding: 16,\r\n    width: '90%',\r\n    maxWidth: 400,\r\n  },\r\n  modalTitle: {\r\n    fontSize: 18,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    fontWeight: '600',\r\n    marginBottom: 16,\r\n    textAlign: 'center',\r\n    color: theme.colors.text,\r\n  },\r\n  modalCloseButton: {\r\n    marginTop: 16,\r\n    paddingVertical: 12,\r\n    alignItems: 'center',\r\n    backgroundColor: theme.colors.backgroundContrast,\r\n    borderRadius: 8,\r\n  },\r\n  modalCloseButtonText: {\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  previewButton: {\r\n    marginTop: 8,\r\n    paddingVertical: 8,\r\n    paddingHorizontal: 12,\r\n    backgroundColor: theme.colors.mainColors.main,\r\n    borderRadius: 8,\r\n    alignSelf: 'flex-start',\r\n  },\r\n  previewButtonText: {\r\n    color: theme.colors.surface,\r\n    fontSize: 14,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  previewModalContent: {\r\n    maxHeight: '80%',\r\n  },\r\n  previewCalendarContainer: {\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 8,\r\n    padding: 12,\r\n    marginVertical: 16,\r\n  },\r\n  recurringDate: {\r\n    backgroundColor: theme.colors.mainColors.main,\r\n  },\r\n  recurringDateText: {\r\n    color: theme.colors.surface,\r\n    fontWeight: '600',\r\n  },\r\n  previewDateCell: {\r\n    flex: 1,\r\n    aspectRatio: 1,\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    borderRadius: 4,\r\n    padding: 2,\r\n  },\r\n  dateRangeChip: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    justifyContent: 'space-between',\r\n    backgroundColor: theme.colors.backgroundContrast,\r\n    borderRadius: 16,\r\n    paddingVertical: 8,\r\n    paddingLeft: 12,\r\n    paddingRight: 8,\r\n  },\r\n  removeRangeButton: {\r\n    marginLeft: 8,\r\n    padding: 4,\r\n  },\r\n  selectedDateChip: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    backgroundColor: theme.colors.backgroundContrast,\r\n    borderRadius: 16,\r\n    paddingVertical: 6,\r\n    paddingLeft: 10,\r\n    paddingRight: 6,\r\n    marginRight: 6,\r\n    marginBottom: 6,\r\n  },\r\n  removeButton: {\r\n    marginLeft: 4,\r\n    padding: 2,\r\n  },\r\n  removeButtonText: {\r\n    fontSize: 16,\r\n    color: theme.colors.mainColors.main,\r\n    fontWeight: 'bold',\r\n  },\r\n  oneTimeOptionsContainer: {\r\n    marginTop: 8,\r\n  },\r\n  dateSelectionTitle: {\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    fontWeight: '600',\r\n    marginBottom: 16,\r\n    paddingHorizontal: 4,\r\n  },\r\n});\r\n\r\nexport default DateSelectionCard; ","import React, { useState, useEffect, useRef } from 'react';\r\nimport { View, Text, StyleSheet, TouchableOpacity, ScrollView, Alert } from 'react-native';\r\nimport { MaterialIcons } from '@expo/vector-icons';\r\nimport { theme } from '../../styles/theme';\r\nimport { debugLog } from '../../context/AuthContext';\r\n\r\nconst HOURS = Array.from({ length: 12 }, (_, i) => i === 0 ? 12 : i);\r\nconst MINUTES = Array.from({ length: 60 }, (_, i) => i).filter(m => m % 5 === 0);\r\nconst PERIODS = ['AM', 'PM'];\r\n\r\nconst TimePickerDropdown = ({\r\n  initialTime,\r\n  onTimeSelect,\r\n  isOpen,\r\n  onClose,\r\n  label = 'Time',\r\n  uniqueId = 'default',\r\n  showInlinePicker = false\r\n}) => {\r\n  // Create references for scrolling to right position\r\n  const hourScrollRef = useRef(null);\r\n  const minuteScrollRef = useRef(null);\r\n  const periodScrollRef = useRef(null);\r\n  \r\n  // Need to deep copy initialTime to prevent reference issues\r\n  const initTime = JSON.parse(JSON.stringify(initialTime || { hours: 9, minutes: 0 }));\r\n  \r\n  // Convert 24h to 12h format for UI\r\n  const init12Hour = () => {\r\n    const hours24 = initTime.hours;\r\n    \r\n    // Find the closest 5-minute interval\r\n    const minute = Math.round(initTime.minutes / 5) * 5;\r\n    \r\n    return {\r\n      hour: hours24 % 12 === 0 ? 12 : hours24 % 12,\r\n      minute: minute >= 60 ? 0 : minute, // Handle case where rounding gives 60\r\n      period: hours24 >= 12 ? 'PM' : 'AM'\r\n    };\r\n  };\r\n  \r\n  // State for the selected time\r\n  const [selectedTime, setSelectedTime] = useState(init12Hour());\r\n  \r\n  // Keep track of the last confirmed time\r\n  const [lastConfirmedTime, setLastConfirmedTime] = useState(init12Hour());\r\n  \r\n  // Add error state\r\n  const [timeError, setTimeError] = useState(null);\r\n  \r\n  // Reset the selected time when the initial time changes\r\n  useEffect(() => {\r\n    if (initialTime) {\r\n      const newTime = init12Hour();\r\n      setSelectedTime(newTime);\r\n      setLastConfirmedTime(newTime);\r\n      setTimeError(null);\r\n    }\r\n  }, [initialTime?.hours, initialTime?.minutes]);\r\n  \r\n  // Clear error after 5 seconds\r\n  useEffect(() => {\r\n    if (timeError) {\r\n      const timer = setTimeout(() => {\r\n        setTimeError(null);\r\n      }, 5000);\r\n      \r\n      return () => clearTimeout(timer);\r\n    }\r\n  }, [timeError]);\r\n  \r\n  // Scroll to the right positions when the picker is opened\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      setTimeout(() => {\r\n        scrollToSelections();\r\n      }, 50);\r\n    }\r\n  }, [isOpen, selectedTime]);\r\n\r\n  // Function to handle hour selection\r\n  const handleHourSelect = (hour) => {\r\n    setSelectedTime(prev => ({ ...prev, hour }));\r\n    setTimeError(null);\r\n  };\r\n\r\n  // Function to handle minute selection\r\n  const handleMinuteSelect = (minute) => {\r\n    setSelectedTime(prev => ({ ...prev, minute }));\r\n    setTimeError(null);\r\n  };\r\n\r\n  // Function to handle AM/PM selection\r\n  const handlePeriodSelect = (period) => {\r\n    setSelectedTime(prev => ({ ...prev, period }));\r\n    setTimeError(null);\r\n  };\r\n\r\n  // Convert 12h time to 24h and call the onTimeSelect callback\r\n  const triggerTimeChange = (time12h) => {\r\n    const { hour, minute, period } = time12h;\r\n    \r\n    // Convert to 24-hour format\r\n    let hours24 = hour;\r\n    if (period === 'PM' && hour !== 12) hours24 += 12;\r\n    if (period === 'AM' && hour === 12) hours24 = 0;\r\n    \r\n    const newTime = {\r\n      hours: hours24,\r\n      minutes: minute\r\n    };\r\n    \r\n    debugLog(`MBAoi9uv43d: TimePickerDropdown selected time (${uniqueId}):`, {\r\n      time12h, \r\n      time24h: newTime\r\n    });\r\n    \r\n    // Update the last confirmed time\r\n    setLastConfirmedTime(time12h);\r\n    \r\n    // Pass the new time up to the parent component\r\n    const isValid = onTimeSelect(newTime);\r\n    \r\n    // If time validation failed (parent returned false), show an error\r\n    if (isValid === false) {\r\n      // Show error alert\r\n      Alert.alert(\r\n        \"Invalid Time Selection\", \r\n        uniqueId.includes('start') ? \r\n          \"Start time cannot be later than end time.\" :\r\n          \"End time cannot be earlier than start time.\",\r\n        [{ text: \"OK\" }]\r\n      );\r\n      \r\n      // Set error message for visual indicator\r\n      setTimeError(uniqueId.includes('start') ? \r\n        \"Start time cannot be later than end time.\" :\r\n        \"End time cannot be earlier than start time.\"\r\n      );\r\n      \r\n      return false;\r\n    }\r\n    \r\n    // Only close the picker if validation passed\r\n    onClose();\r\n    return true;\r\n  };\r\n\r\n  // Handle confirm button press\r\n  const handleConfirm = () => {\r\n    triggerTimeChange(selectedTime);\r\n  };\r\n  \r\n  // Handle cancel button press\r\n  const handleCancel = () => {\r\n    // Reset the selected time to the last confirmed time\r\n    setSelectedTime(lastConfirmedTime);\r\n    setTimeError(null);\r\n    onClose();\r\n  };\r\n\r\n  // Scroll to the selected values\r\n  const scrollToSelections = () => {\r\n    if (hourScrollRef.current) {\r\n      const hourIndex = HOURS.indexOf(selectedTime.hour);\r\n      const hourOffset = hourIndex * 40;\r\n      hourScrollRef.current.scrollTo({ y: Math.max(0, hourOffset - 40), animated: true });\r\n    }\r\n    \r\n    if (minuteScrollRef.current) {\r\n      const minuteIndex = MINUTES.indexOf(selectedTime.minute);\r\n      const minuteOffset = minuteIndex * 40;\r\n      minuteScrollRef.current.scrollTo({ y: Math.max(0, minuteOffset - 40), animated: true });\r\n    }\r\n    \r\n    if (periodScrollRef.current) {\r\n      const periodIndex = PERIODS.indexOf(selectedTime.period);\r\n      const periodOffset = periodIndex * 40;\r\n      periodScrollRef.current.scrollTo({ y: Math.max(0, periodOffset - 20), animated: true });\r\n    }\r\n  };\r\n\r\n  // Format the time for display\r\n  const formatTimeDisplay = (hour, minute, period) => {\r\n    return `${hour}:${minute.toString().padStart(2, '0')} ${period}`;\r\n  };\r\n\r\n  // Render the dropdown content\r\n  const renderDropdownContent = () => (\r\n    <View>\r\n      <View style={styles.dropdownContent}>\r\n        {/* Hours */}\r\n        <ScrollView \r\n          ref={hourScrollRef} \r\n          style={styles.column}\r\n          showsVerticalScrollIndicator={false}\r\n        >\r\n          {HOURS.map((hour) => (\r\n            <TouchableOpacity\r\n              key={`hour-${hour}`}\r\n              style={[\r\n                styles.option,\r\n                selectedTime.hour === hour && styles.selectedOption\r\n              ]}\r\n              onPress={() => handleHourSelect(hour)}\r\n            >\r\n              <Text style={[\r\n                styles.optionText,\r\n                selectedTime.hour === hour && styles.selectedOptionText\r\n              ]}>\r\n                {hour}\r\n              </Text>\r\n            </TouchableOpacity>\r\n          ))}\r\n        </ScrollView>\r\n        \r\n        {/* Minutes */}\r\n        <ScrollView \r\n          ref={minuteScrollRef} \r\n          style={styles.column}\r\n          showsVerticalScrollIndicator={false}\r\n        >\r\n          {MINUTES.map((minute) => (\r\n            <TouchableOpacity\r\n              key={`minute-${minute}`}\r\n              style={[\r\n                styles.option,\r\n                selectedTime.minute === minute && styles.selectedOption\r\n              ]}\r\n              onPress={() => handleMinuteSelect(minute)}\r\n            >\r\n              <Text style={[\r\n                styles.optionText,\r\n                selectedTime.minute === minute && styles.selectedOptionText\r\n              ]}>\r\n                {minute.toString().padStart(2, '0')}\r\n              </Text>\r\n            </TouchableOpacity>\r\n          ))}\r\n        </ScrollView>\r\n        \r\n        {/* AM/PM */}\r\n        <ScrollView \r\n          ref={periodScrollRef} \r\n          style={styles.column}\r\n          showsVerticalScrollIndicator={false}\r\n        >\r\n          {PERIODS.map((period) => (\r\n            <TouchableOpacity\r\n              key={`period-${period}`}\r\n              style={[\r\n                styles.option,\r\n                selectedTime.period === period && styles.selectedOption\r\n              ]}\r\n              onPress={() => handlePeriodSelect(period)}\r\n            >\r\n              <Text style={[\r\n                styles.optionText,\r\n                selectedTime.period === period && styles.selectedOptionText\r\n              ]}>\r\n                {period}\r\n              </Text>\r\n            </TouchableOpacity>\r\n          ))}\r\n        </ScrollView>\r\n      </View>\r\n      \r\n      {/* Error message */}\r\n      {timeError && (\r\n        <View style={styles.errorContainer}>\r\n          <MaterialIcons name=\"error\" size={16} color={theme.colors.error || '#D32F2F'} />\r\n          <Text style={styles.errorText}>{timeError}</Text>\r\n        </View>\r\n      )}\r\n      \r\n      {/* Buttons row */}\r\n      <View style={styles.buttonRow}>\r\n        <TouchableOpacity \r\n          style={[styles.button, styles.cancelButton]}\r\n          onPress={handleCancel}\r\n        >\r\n          <Text style={styles.cancelButtonText}>Cancel</Text>\r\n        </TouchableOpacity>\r\n        <TouchableOpacity \r\n          style={[styles.button, styles.confirmButton]}\r\n          onPress={handleConfirm}\r\n        >\r\n          <Text style={styles.confirmButtonText}>Confirm</Text>\r\n        </TouchableOpacity>\r\n      </View>\r\n    </View>\r\n  );\r\n\r\n  // For inline mode (shown directly in the UI)\r\n  if (showInlinePicker) {\r\n    return (\r\n      <View style={styles.inlineContainer}>\r\n        {label && <Text style={styles.label}>{label}</Text>}\r\n        {renderDropdownContent()}\r\n      </View>\r\n    );\r\n  }\r\n\r\n  // For dropdown mode (shown when button is clicked)\r\n  return (\r\n    <>\r\n      <TouchableOpacity\r\n        style={styles.timeDisplay}\r\n        onPress={isOpen ? onClose : () => {}}\r\n      >\r\n        <MaterialIcons name=\"access-time\" size={18} color={theme.colors.mainColors.main} />\r\n        <Text style={styles.timeText}>\r\n          {formatTimeDisplay(selectedTime.hour, selectedTime.minute, selectedTime.period)}\r\n        </Text>\r\n        <MaterialIcons \r\n          name={isOpen ? \"keyboard-arrow-up\" : \"keyboard-arrow-down\"} \r\n          size={20} \r\n          color={theme.colors.text} \r\n        />\r\n      </TouchableOpacity>\r\n      \r\n      {isOpen && (\r\n        <View style={styles.dropdownContainer}>\r\n          {renderDropdownContent()}\r\n        </View>\r\n      )}\r\n    </>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  timeDisplay: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    justifyContent: 'space-between',\r\n    backgroundColor: theme.colors.surface,\r\n    padding: 10,\r\n    borderRadius: 8,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.modernBorder,\r\n    marginVertical: 5,\r\n  },\r\n  timeText: {\r\n    flex: 1,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    fontSize: theme.fontSizes.medium,\r\n    marginLeft: 8,\r\n  },\r\n  dropdownContainer: {\r\n    position: 'absolute',\r\n    top: '100%',\r\n    left: 0,\r\n    right: 0,\r\n    backgroundColor: theme.colors.background,\r\n    borderRadius: 8,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.modernBorder,\r\n    marginTop: 4,\r\n    zIndex: 1000,\r\n    shadowColor: '#000',\r\n    shadowOffset: { width: 0, height: 2 },\r\n    shadowOpacity: 0.1,\r\n    shadowRadius: 4,\r\n    elevation: 3,\r\n  },\r\n  inlineContainer: {\r\n    backgroundColor: theme.colors.background,\r\n    borderRadius: 8,\r\n    padding: 4,\r\n  },\r\n  label: {\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    fontSize: theme.fontSizes.small,\r\n    marginBottom: 8,\r\n  },\r\n  dropdownContent: {\r\n    flexDirection: 'row',\r\n    padding: 4,\r\n  },\r\n  column: {\r\n    flex: 1,\r\n    height: 160,\r\n  },\r\n  option: {\r\n    padding: 8,\r\n    alignItems: 'center',\r\n    height: 40,\r\n    justifyContent: 'center',\r\n  },\r\n  selectedOption: {\r\n    backgroundColor: `${theme.colors.mainColors.main}20`,\r\n    borderRadius: 4,\r\n  },\r\n  optionText: {\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    fontSize: theme.fontSizes.medium,\r\n  },\r\n  selectedOptionText: {\r\n    color: theme.colors.mainColors.main,\r\n    fontWeight: '600',\r\n  },\r\n  buttonRow: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    marginTop: 8,\r\n    paddingHorizontal: 4,\r\n  },\r\n  button: {\r\n    paddingVertical: 8,\r\n    paddingHorizontal: 16,\r\n    borderRadius: 6,\r\n    flex: 1,\r\n    marginHorizontal: 4,\r\n    alignItems: 'center',\r\n  },\r\n  confirmButton: {\r\n    backgroundColor: theme.colors.mainColors.main,\r\n  },\r\n  cancelButton: {\r\n    backgroundColor: theme.colors.modernBorder,\r\n  },\r\n  confirmButtonText: {\r\n    color: 'white',\r\n    fontFamily: theme.fonts.medium.fontFamily,\r\n    fontSize: theme.fontSizes.small,\r\n  },\r\n  cancelButtonText: {\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    fontSize: theme.fontSizes.small,\r\n  },\r\n  errorContainer: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    backgroundColor: '#FFEBEE',\r\n    padding: 8,\r\n    marginHorizontal: 4,\r\n    marginTop: 4,\r\n    borderRadius: 4,\r\n  },\r\n  errorText: {\r\n    color: theme.colors.error || '#D32F2F',\r\n    fontSize: theme.fontSizes.small,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    marginLeft: 4,\r\n    flex: 1,\r\n  }\r\n});\r\n\r\nexport default TimePickerDropdown; ","import React, { useState, useEffect, useContext, useRef } from 'react';\r\nimport { View, Text, StyleSheet, TouchableOpacity, TouchableWithoutFeedback, Modal } from 'react-native';\r\nimport { MaterialIcons } from '@expo/vector-icons';\r\nimport { theme } from '../../styles/theme';\r\nimport { AuthContext, debugLog } from '../../context/AuthContext';\r\nimport TimePickerDropdown from './TimePickerDropdown';\r\n\r\nconst NewTimeRangeSelector = ({\r\n  title,\r\n  onTimeSelect,\r\n  initialTimes = {},\r\n  is_overnight = false,\r\n  uniqueId = 'default',\r\n  dateRange = null,\r\n  selectedDates = [],\r\n  isIndividualDaySelector = false,\r\n}) => {\r\n  const { is_DEBUG } = useContext(AuthContext);\r\n  \r\n  // Create local state with deep copies to prevent reference issues\r\n  const [times, setTimes] = useState(() => {\r\n    const defaultTimes = {\r\n      startTime: { hours: 9, minutes: 0 },\r\n      endTime: { hours: 17, minutes: 0 },\r\n      isOvernightForced: initialTimes?.isOvernightForced || is_overnight || false\r\n    };\r\n    \r\n    // Deep copy initialTimes if provided\r\n    if (initialTimes) {\r\n      return {\r\n        startTime: initialTimes.startTime ? JSON.parse(JSON.stringify(initialTimes.startTime)) : defaultTimes.startTime,\r\n        endTime: initialTimes.endTime ? JSON.parse(JSON.stringify(initialTimes.endTime)) : defaultTimes.endTime,\r\n        isOvernightForced: initialTimes.isOvernightForced || is_overnight || false\r\n      };\r\n    }\r\n    \r\n    return defaultTimes;\r\n  });\r\n  \r\n  // Track which time picker is currently open\r\n  const [activeTimePicker, setActiveTimePicker] = useState(null);\r\n  \r\n  // Update times when initialTimes prop changes\r\n  useEffect(() => {\r\n    if (!initialTimes) return;\r\n    \r\n    debugLog(`MBAoi9uv43d: NewTimeRangeSelector (${uniqueId}) initialTimes update:`, initialTimes);\r\n    \r\n    // Create deep copies of the times\r\n    const updatedTimes = {\r\n      startTime: initialTimes.startTime ? JSON.parse(JSON.stringify(initialTimes.startTime)) : times.startTime,\r\n      endTime: initialTimes.endTime ? JSON.parse(JSON.stringify(initialTimes.endTime)) : times.endTime,\r\n      isOvernightForced: initialTimes.isOvernightForced || is_overnight || times.isOvernightForced\r\n    };\r\n    \r\n    setTimes(updatedTimes);\r\n  }, [\r\n    initialTimes?.startTime?.hours, \r\n    initialTimes?.startTime?.minutes, \r\n    initialTimes?.endTime?.hours, \r\n    initialTimes?.endTime?.minutes,\r\n    initialTimes?.isOvernightForced,\r\n    is_overnight\r\n  ]);\r\n  \r\n  // Close dropdown when clicking outside\r\n  useEffect(() => {\r\n    const handleClickOutside = () => {\r\n      if (activeTimePicker) {\r\n        setActiveTimePicker(null);\r\n      }\r\n    };\r\n\r\n    return () => {\r\n      // Clean up listeners\r\n    };\r\n  }, [activeTimePicker]);\r\n  \r\n  // Handle start time change\r\n  const handleStartTimeChange = (newTime) => {\r\n    // Validate that start time is not after end time\r\n    // End time could be 00:00 (midnight) which is treated as end of day\r\n    // So we need a special check for that case\r\n    const isEndTimeMidnight = times.endTime.hours === 0 && times.endTime.minutes === 0;\r\n    const startTotalMinutes = (newTime.hours * 60) + newTime.minutes;\r\n    const endTotalMinutes = (times.endTime.hours * 60) + times.endTime.minutes;\r\n    \r\n    // Check if the time combination is valid\r\n    // Allow if end time is midnight (special case) or if start time is before end time\r\n    if (!(isEndTimeMidnight || startTotalMinutes < endTotalMinutes)) {\r\n      debugLog(`MBAoi9uv43d: NewTimeRangeSelector (${uniqueId}) invalid start time - would be after end time:`, {\r\n        attemptedStart: newTime,\r\n        currentEnd: times.endTime,\r\n        startMinutes: startTotalMinutes,\r\n        endMinutes: endTotalMinutes\r\n      });\r\n      \r\n      // Return false to trigger error handling in TimePickerDropdown\r\n      return false;\r\n    }\r\n    \r\n    // Time is valid, proceed with the update\r\n    const newTimes = {\r\n      ...times,\r\n      startTime: JSON.parse(JSON.stringify(newTime))\r\n    };\r\n    \r\n    setTimes(newTimes);\r\n    onTimeSelect(newTimes);\r\n    \r\n    debugLog(`MBAoi9uv43d: NewTimeRangeSelector (${uniqueId}) startTime changed:`, {\r\n      newTime,\r\n      updatedTimes: newTimes\r\n    });\r\n    \r\n    return true;\r\n  };\r\n  \r\n  // Handle end time change\r\n  const handleEndTimeChange = (newTime) => {\r\n    // Special case: if new end time is midnight (00:00), always allow it\r\n    const isNewEndTimeMidnight = newTime.hours === 0 && newTime.minutes === 0;\r\n    \r\n    // For all other times, validate that end time is after start time\r\n    const startTotalMinutes = (times.startTime.hours * 60) + times.startTime.minutes;\r\n    const endTotalMinutes = (newTime.hours * 60) + newTime.minutes;\r\n    \r\n    // Check if the time combination is valid\r\n    // Allow if end time is midnight (special case) or if end time is after start time\r\n    if (!(isNewEndTimeMidnight || endTotalMinutes > startTotalMinutes)) {\r\n      debugLog(`MBAoi9uv43d: NewTimeRangeSelector (${uniqueId}) invalid end time - would be before start time:`, {\r\n        currentStart: times.startTime,\r\n        attemptedEnd: newTime,\r\n        startMinutes: startTotalMinutes,\r\n        endMinutes: endTotalMinutes\r\n      });\r\n      \r\n      // Return false to trigger error handling in TimePickerDropdown\r\n      return false;\r\n    }\r\n    \r\n    // Time is valid, proceed with the update\r\n    const newTimes = {\r\n      ...times,\r\n      endTime: JSON.parse(JSON.stringify(newTime))\r\n    };\r\n    \r\n    setTimes(newTimes);\r\n    onTimeSelect(newTimes);\r\n    \r\n    debugLog(`MBAoi9uv43d: NewTimeRangeSelector (${uniqueId}) endTime changed:`, {\r\n      newTime,\r\n      updatedTimes: newTimes\r\n    });\r\n    \r\n    return true;\r\n  };\r\n  \r\n  // Format time for display (12-hour format)\r\n  const formatTimeDisplay = (time) => {\r\n    if (!time) return '';\r\n    \r\n    const hours = time.hours;\r\n    const minutes = time.minutes;\r\n    const period = hours >= 12 ? 'PM' : 'AM';\r\n    const hours12 = hours % 12 === 0 ? 12 : hours % 12;\r\n    \r\n    return `${hours12}:${minutes.toString().padStart(2, '0')} ${period}`;\r\n  };\r\n  \r\n  // Format a date for display\r\n  const formatDate = (date) => {\r\n    if (!date) return '';\r\n    \r\n    try {\r\n      const dateObj = new Date(date);\r\n      return dateObj.toLocaleDateString('en-US', { \r\n        month: 'short', \r\n        day: 'numeric', \r\n        year: 'numeric' \r\n      });\r\n    } catch (error) {\r\n      debugLog(`MBAoi9uv43d: Error formatting date: ${error.message}`);\r\n      return '';\r\n    }\r\n  };\r\n  \r\n  // Calculate duration between start and end times\r\n  const calculateDuration = () => {\r\n    const { isOvernightForced } = times;\r\n    \r\n    // If overnight service and we have date range or selected dates, calculate nights from date range\r\n    if ((isOvernightForced || is_overnight) && (dateRange || (selectedDates && selectedDates.length > 0))) {\r\n      let startDate, endDate;\r\n      \r\n      if (dateRange && dateRange.startDate && dateRange.endDate) {\r\n        // If we have a date range, use it\r\n        startDate = new Date(dateRange.startDate);\r\n        endDate = new Date(dateRange.endDate);\r\n      } else if (selectedDates && selectedDates.length >= 2) {\r\n        // If we have selected dates array, use first and last date\r\n        // Sort dates to ensure correct order\r\n        const sortedDates = [...selectedDates].sort((a, b) => new Date(a) - new Date(b));\r\n        startDate = new Date(sortedDates[0]);\r\n        endDate = new Date(sortedDates[sortedDates.length - 1]);\r\n      } else if (selectedDates && selectedDates.length === 1) {\r\n        // If only one date selected, it's same day\r\n        return \"Same day\";\r\n      } else {\r\n        // Fallback if no date information\r\n        return \"1 night\";\r\n      }\r\n      \r\n      // Calculate nights between dates\r\n      const diffTime = Math.abs(endDate - startDate);\r\n      \r\n      // For date ranges, use correct date math (without time component)\r\n      // This ensures dates like May 14-16 (3 days) result in 2 nights, not 1 night\r\n      let diffDays;\r\n      \r\n      // Normalize dates to remove time component\r\n      const normalizedStartDate = new Date(startDate.getFullYear(), startDate.getMonth(), startDate.getDate());\r\n      const normalizedEndDate = new Date(endDate.getFullYear(), endDate.getMonth(), endDate.getDate());\r\n      \r\n      // Calculate the actual number of calendar days between the dates (inclusive)\r\n      diffDays = Math.round(Math.abs(normalizedEndDate - normalizedStartDate) / (1000 * 60 * 60 * 24)) + 1;\r\n      \r\n      // The number of nights is always one less than the number of days\r\n      const nights = diffDays > 1 ? diffDays - 1 : 0;\r\n      \r\n      if (nights === 0) {\r\n        return \"Same day\";\r\n      } else if (nights === 1) {\r\n        return \"1 night\";\r\n      } else {\r\n        return `${nights} nights`;\r\n      }\r\n    }\r\n    \r\n    // For regular (non-overnight) services or when no date range is available\r\n    const { startTime, endTime } = times;\r\n    \r\n    // Convert times to minutes\r\n    const startMinutes = (startTime.hours * 60) + startTime.minutes;\r\n    let endMinutes = (endTime.hours * 60) + endTime.minutes;\r\n    \r\n    // Special case: midnight (00:00) as end time is treated as end of day\r\n    if (endTime.hours === 0 && endTime.minutes === 0) {\r\n      endMinutes = 24 * 60; // End of day\r\n    }\r\n    \r\n    // Calculate duration in minutes\r\n    let durationMinutes = endMinutes - startMinutes;\r\n    \r\n    // If end time is earlier than start time and not midnight, add 24 hours\r\n    if (durationMinutes < 0 && !(endTime.hours === 0 && endTime.minutes === 0)) {\r\n      durationMinutes += 24 * 60;\r\n    }\r\n    \r\n    // Convert to hours and minutes\r\n    const hours = Math.floor(durationMinutes / 60);\r\n    const minutes = durationMinutes % 60;\r\n    \r\n    // Format the duration string\r\n    let durationStr = '';\r\n    if (hours > 0) {\r\n      durationStr += `${hours} hour${hours !== 1 ? 's' : ''}`;\r\n    }\r\n    if (minutes > 0) {\r\n      if (durationStr.length > 0) durationStr += ' ';\r\n      durationStr += `${minutes} minute${minutes !== 1 ? 's' : ''}`;\r\n    }\r\n    \r\n    return durationStr || '0 minutes';\r\n  };\r\n  \r\n  // Get start date for display\r\n  const getStartDate = () => {\r\n    if (dateRange && dateRange.startDate) {\r\n      return dateRange.startDate;\r\n    } else if (selectedDates && selectedDates.length > 0) {\r\n      const sortedDates = [...selectedDates].sort((a, b) => new Date(a) - new Date(b));\r\n      return sortedDates[0];\r\n    }\r\n    return null;\r\n  };\r\n  \r\n  // Get end date for display\r\n  const getEndDate = () => {\r\n    if (dateRange && dateRange.endDate) {\r\n      return dateRange.endDate;\r\n    } else if (selectedDates && selectedDates.length > 0) {\r\n      const sortedDates = [...selectedDates].sort((a, b) => new Date(a) - new Date(b));\r\n      return sortedDates[sortedDates.length - 1];\r\n    }\r\n    return null;\r\n  };\r\n  \r\n  const startDate = getStartDate();\r\n  const endDate = getEndDate();\r\n  \r\n  return (\r\n    <View style={styles.container}>\r\n      {title && <Text style={styles.title}>{title}</Text>}\r\n      \r\n      {/* Time selection UI with dates */}\r\n      <View style={styles.timeSelectionContainer}>\r\n        {/* Start time picker with date */}\r\n        <View style={styles.timePickerContainer}>\r\n          {startDate && (isIndividualDaySelector || times.isOvernightForced || is_overnight) ? (\r\n            <Text style={styles.dateLabel}>{formatDate(startDate)}</Text>\r\n          ) : (\r\n            <Text style={styles.dateLabel}>Applies to all individual days</Text>\r\n          )}\r\n          <Text style={styles.timeLabel}>Start Time</Text>\r\n          <TouchableOpacity\r\n            style={styles.timeButton}\r\n            onPress={() => setActiveTimePicker(activeTimePicker === 'start' ? null : 'start')}\r\n          >\r\n            <View style={styles.timeButtonContent}>\r\n              <MaterialIcons name=\"access-time\" size={18} color={theme.colors.mainColors.main} />\r\n              <Text style={styles.timeText}>\r\n                {formatTimeDisplay(times.startTime)}\r\n              </Text>\r\n              <MaterialIcons \r\n                name={activeTimePicker === 'start' ? \"keyboard-arrow-up\" : \"keyboard-arrow-down\"} \r\n                size={20} \r\n                color={theme.colors.text} \r\n              />\r\n            </View>\r\n          </TouchableOpacity>\r\n        </View>\r\n        \r\n        {/* End time picker with date */}\r\n        <View style={styles.timePickerContainer}>\r\n          {endDate && (isIndividualDaySelector || times.isOvernightForced || is_overnight) ? (\r\n            <Text style={styles.dateLabel}>{formatDate(endDate)}</Text>\r\n          ) : (\r\n            <Text style={styles.dateLabel}>Applies to all individual days</Text>\r\n          )}\r\n          <Text style={styles.timeLabel}>End Time</Text>\r\n          <TouchableOpacity\r\n            style={styles.timeButton}\r\n            onPress={() => setActiveTimePicker(activeTimePicker === 'end' ? null : 'end')}\r\n          >\r\n            <View style={styles.timeButtonContent}>\r\n              <MaterialIcons name=\"access-time\" size={18} color={theme.colors.mainColors.main} />\r\n              <Text style={styles.timeText}>\r\n                {formatTimeDisplay(times.endTime)}\r\n              </Text>\r\n              <MaterialIcons \r\n                name={activeTimePicker === 'end' ? \"keyboard-arrow-up\" : \"keyboard-arrow-down\"} \r\n                size={20} \r\n                color={theme.colors.text} \r\n              />\r\n            </View>\r\n          </TouchableOpacity>\r\n        </View>\r\n      </View>\r\n      \r\n      {/* Duration display */}\r\n      <View style={styles.durationContainer}>\r\n        <MaterialIcons name=\"timelapse\" size={18} color={theme.colors.mainColors.main} />\r\n        <Text style={styles.durationText}>Duration: {calculateDuration()}</Text>\r\n      </View>\r\n      \r\n      {/* Modal for handling outside click to close the dropdowns */}\r\n      {activeTimePicker && (\r\n        <Modal\r\n          transparent={true}\r\n          animationType=\"none\"\r\n          visible={!!activeTimePicker}\r\n          onRequestClose={() => setActiveTimePicker(null)}\r\n        >\r\n          <TouchableWithoutFeedback onPress={() => setActiveTimePicker(null)}>\r\n            <View style={styles.modalOverlay}>\r\n              <TouchableWithoutFeedback>\r\n                <View style={[\r\n                  styles.modalContent,\r\n                  activeTimePicker === 'start' ? styles.startModalContent : styles.endModalContent\r\n                ]}>\r\n                  <TimePickerDropdown\r\n                    initialTime={activeTimePicker === 'start' ? times.startTime : times.endTime}\r\n                    onTimeSelect={activeTimePicker === 'start' ? handleStartTimeChange : handleEndTimeChange}\r\n                    isOpen={true}\r\n                    onClose={() => setActiveTimePicker(null)}\r\n                    uniqueId={`${uniqueId}-${activeTimePicker}`}\r\n                    showInlinePicker={true}\r\n                  />\r\n                </View>\r\n              </TouchableWithoutFeedback>\r\n            </View>\r\n          </TouchableWithoutFeedback>\r\n        </Modal>\r\n      )}\r\n    </View>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    backgroundColor: theme.colors.background,\r\n    borderRadius: 8,\r\n    padding: 16,\r\n    marginBottom: 16,\r\n  },\r\n  title: {\r\n    fontSize: theme.fontSizes.medium,\r\n    fontFamily: theme.fonts.medium.fontFamily,\r\n    color: theme.colors.text,\r\n    marginBottom: 16,\r\n  },\r\n  timeSelectionContainer: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    marginBottom: 16,\r\n  },\r\n  timePickerContainer: {\r\n    flex: 1,\r\n    marginHorizontal: 4,\r\n    position: 'relative',\r\n    zIndex: 10,\r\n  },\r\n  dateLabel: {\r\n    fontSize: theme.fontSizes.small,\r\n    fontFamily: theme.fonts.medium.fontFamily,\r\n    color: theme.colors.textSecondary,\r\n    marginBottom: 4,\r\n  },\r\n  timeLabel: {\r\n    fontSize: theme.fontSizes.smallMedium,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    color: theme.colors.text,\r\n    marginBottom: 8,\r\n  },\r\n  timeButton: {\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.modernBorder,\r\n    borderRadius: 8,\r\n    backgroundColor: theme.colors.surface,\r\n    position: 'relative',\r\n  },\r\n  timeButtonContent: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    padding: 12,\r\n  },\r\n  timeText: {\r\n    flex: 1,\r\n    fontSize: theme.fontSizes.medium,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    color: theme.colors.text,\r\n    marginLeft: 8,\r\n  },\r\n  durationContainer: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    marginTop: 4,\r\n    padding: 12,\r\n    backgroundColor: theme.colors.bgColorModern,\r\n    borderRadius: 8,\r\n  },\r\n  durationText: {\r\n    fontSize: theme.fontSizes.medium,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    color: theme.colors.text,\r\n    marginLeft: 8,\r\n  },\r\n  // Modal styling for outside click handling\r\n  modalOverlay: {\r\n    flex: 1,\r\n    backgroundColor: 'rgba(0, 0, 0, 0.2)',\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n  },\r\n  modalContent: {\r\n    backgroundColor: theme.colors.background,\r\n    borderRadius: 8,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.modernBorder,\r\n    width: '80%',\r\n    padding: 8,\r\n    shadowColor: '#000',\r\n    shadowOffset: { width: 0, height: 2 },\r\n    shadowOpacity: 0.2,\r\n    shadowRadius: 4,\r\n    elevation: 5,\r\n  },\r\n  startModalContent: {\r\n    alignSelf: 'flex-start',\r\n    marginLeft: '10%',\r\n  },\r\n  endModalContent: {\r\n    alignSelf: 'flex-end',\r\n    marginRight: '10%',\r\n  }\r\n});\r\n\r\nexport default NewTimeRangeSelector; ","import React, { useState, useEffect, useContext } from 'react';\r\nimport { View, Text, StyleSheet } from 'react-native';\r\nimport { theme } from '../../styles/theme';\r\nimport { AuthContext, debugLog } from '../../context/AuthContext';\r\nimport NewTimeRangeSelector from './NewTimeRangeSelector';\r\n\r\nconst DayTimeSelector = ({\r\n  date,\r\n  initialTimes = {},\r\n  onTimeChange,\r\n  is_overnight = false\r\n}) => {\r\n  const { is_DEBUG } = useContext(AuthContext);\r\n  \r\n  // Format the date for display\r\n  const formatDate = (date) => {\r\n    if (!date) return '';\r\n    \r\n    // Create a copy to prevent timezone issues\r\n    const dateObj = new Date(date);\r\n    const options = { weekday: 'short', month: 'short', day: 'numeric' };\r\n    return dateObj.toLocaleDateString('en-US', options);\r\n  };\r\n  \r\n  // Generate a unique ID for this date's time selector\r\n  const generateUniqueId = () => {\r\n    if (!date) return 'day-unknown';\r\n    \r\n    try {\r\n      // If date is a Date object, convert to ISO string and extract date part\r\n      if (date instanceof Date) {\r\n        return `day-${date.toISOString().split('T')[0]}`;\r\n      }\r\n      \r\n      // If date is already in YYYY-MM-DD format\r\n      if (typeof date === 'string' && date.match(/^\\d{4}-\\d{2}-\\d{2}$/)) {\r\n        return `day-${date}`;\r\n      }\r\n      \r\n      // If date is in another format, try to convert it\r\n      const parsedDate = new Date(date);\r\n      if (!isNaN(parsedDate.getTime())) {\r\n        return `day-${parsedDate.toISOString().split('T')[0]}`;\r\n      }\r\n      \r\n      // Fallback\r\n      return `day-unknown-${Date.now()}`;\r\n    } catch (error) {\r\n      debugLog('MBAoi9uv43d: Error generating unique ID for date:', error);\r\n      return `day-unknown-${Date.now()}`;\r\n    }\r\n  };\r\n  \r\n  // Generate a stable date key for API\r\n  const generateDateKey = () => {\r\n    if (!date) return null;\r\n    \r\n    try {\r\n      // If date is a Date object, convert to YYYY-MM-DD\r\n      if (date instanceof Date) {\r\n        return date.toISOString().split('T')[0];\r\n      }\r\n      \r\n      // If date is already in YYYY-MM-DD format\r\n      if (typeof date === 'string' && date.match(/^\\d{4}-\\d{2}-\\d{2}$/)) {\r\n        return date;\r\n      }\r\n      \r\n      // If date is in another format, try to convert it\r\n      const parsedDate = new Date(date);\r\n      if (!isNaN(parsedDate.getTime())) {\r\n        return parsedDate.toISOString().split('T')[0];\r\n      }\r\n      \r\n      // Couldn't parse date\r\n      debugLog('MBAoi9uv43d: Could not parse date:', date);\r\n      return null;\r\n    } catch (error) {\r\n      debugLog('MBAoi9uv43d: Error generating date key:', error);\r\n      return null;\r\n    }\r\n  };\r\n  \r\n  // Generate stable IDs\r\n  const uniqueId = generateUniqueId();\r\n  const dateKey = generateDateKey();\r\n  \r\n  // Handle time selection from the time range selector\r\n  const handleTimeSelect = (timesData) => {\r\n    if (!dateKey) {\r\n      debugLog('MBAoi9uv43d: Cannot handle time selection - invalid date key');\r\n      return;\r\n    }\r\n    \r\n    // Create a completely new times object to avoid reference issues\r\n    const newTimes = JSON.parse(JSON.stringify(timesData));\r\n    \r\n    debugLog(`MBAoi9uv43d: DayTimeSelector (${uniqueId}) time changed:`, {\r\n      dateKey,\r\n      timesData: newTimes\r\n    });\r\n    \r\n    // Pass the time data up to the parent component\r\n    onTimeChange(newTimes, dateKey);\r\n  };\r\n  \r\n  return (\r\n    <View style={styles.container}>\r\n      <Text style={styles.dateLabel}>{formatDate(date)}</Text>\r\n      \r\n      <NewTimeRangeSelector\r\n        onTimeSelect={handleTimeSelect}\r\n        initialTimes={initialTimes}\r\n        is_overnight={is_overnight}\r\n        uniqueId={uniqueId}\r\n        selectedDates={[date]}\r\n        isIndividualDaySelector={true}\r\n      />\r\n    </View>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    marginBottom: 16,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.modernBorder,\r\n    borderRadius: 8,\r\n    backgroundColor: theme.colors.surface,\r\n    overflow: 'visible',\r\n  },\r\n  dateLabel: {\r\n    fontSize: theme.fontSizes.medium,\r\n    fontFamily: theme.fonts.medium.fontFamily,\r\n    color: theme.colors.text,\r\n    backgroundColor: theme.colors.bgColorModern,\r\n    padding: 12,\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: theme.colors.modernBorder,\r\n  }\r\n});\r\n\r\nexport default DayTimeSelector; ","import React, { useState, useContext, useEffect, useRef } from 'react';\r\nimport { View, Text, StyleSheet, TouchableOpacity, ScrollView, TouchableWithoutFeedback } from 'react-native';\r\nimport { MaterialIcons } from '@expo/vector-icons';\r\nimport { theme } from '../../styles/theme';\r\nimport NewTimeRangeSelector from './NewTimeRangeSelector';\r\nimport { AuthContext, debugLog } from '../../context/AuthContext';\r\nimport DayTimeSelector from './DayTimeSelector';\r\nimport { formatDateOnly, getUTCTimeString } from '../../utils/time_utils';\r\n\r\n// Helper function to parse time values from various formats\r\nconst parseTimeValue = (timeValue) => {\r\n  if (!timeValue) return null;\r\n  \r\n  // Handle string format 'HH:MM'\r\n  if (typeof timeValue === 'string' && timeValue.includes(':')) {\r\n    const [hours, minutes] = timeValue.split(':').map(part => parseInt(part, 10));\r\n    return { hours, minutes };\r\n  }\r\n  \r\n  // Handle object format directly\r\n  if (typeof timeValue === 'object' && timeValue !== null) {\r\n    // If it has hours/minutes properties directly\r\n    if (timeValue.hours !== undefined || timeValue.minutes !== undefined) {\r\n      return {\r\n        hours: timeValue.hours || 0,\r\n        minutes: timeValue.minutes || 0\r\n      };\r\n    }\r\n  }\r\n  \r\n  // Default fallback\r\n  return null;\r\n};\r\n\r\nconst TimeSelectionCard = ({ \r\n  onTimeSelect,\r\n  initialTimes = {},\r\n  dateRange = null,\r\n  selectedService = null,\r\n  isOvernightForced = false\r\n}) => {\r\n  const { is_DEBUG } = useContext(AuthContext);\r\n  \r\n  // Initialize showIndividualDays based on initialTimes.hasIndividualTimes\r\n  const [showIndividualDays, setShowIndividualDays] = useState(() => {\r\n    // For overnight services, never show individual days\r\n    if (selectedService?.is_overnight || isOvernightForced) {\r\n      return false;\r\n    }\r\n    \r\n    const shouldShowIndividual = initialTimes && initialTimes.hasIndividualTimes === true;\r\n    debugLog('MBAoi9uv43d: Initial showIndividualDays value:', shouldShowIndividual);\r\n    return shouldShowIndividual;\r\n  });\r\n  \r\n  const [individualTimeRanges, setIndividualTimeRanges] = useState({});\r\n  const [times, setTimes] = useState(() => {\r\n    // Safely initialize with default values if initialTimes is not properly formatted\r\n    try {\r\n      if (!initialTimes || typeof initialTimes !== 'object') {\r\n        debugLog('MBAoi9uv43d: Invalid initialTimes, using defaults:', initialTimes);\r\n        return {\r\n          startTime: { hours: 9, minutes: 0 },\r\n          endTime: { hours: 17, minutes: 0 },\r\n          isOvernightForced: false\r\n        };\r\n      }\r\n      return initialTimes;\r\n    } catch (error) {\r\n      debugLog('MBAoi9uv43d: Error initializing times:', error);\r\n      return {\r\n        startTime: { hours: 9, minutes: 0 },\r\n        endTime: { hours: 17, minutes: 0 },\r\n        isOvernightForced: false\r\n      };\r\n    }\r\n  });\r\n  \r\n  // Use a ref to track if this is the initial render\r\n  const isInitialRender = useRef(true);\r\n  \r\n  useEffect(() => {\r\n    debugLog('MBAoi9uv43d: TimeSelectionCard received initialTimes:', initialTimes);\r\n    \r\n    // Safely initialize with default values if initialTimes is not properly formatted\r\n    try {\r\n      if (!initialTimes || typeof initialTimes !== 'object') {\r\n        const defaultTimes = {\r\n          startTime: { hours: 9, minutes: 0 },\r\n          endTime: { hours: 17, minutes: 0 },\r\n          isOvernightForced: selectedService?.is_overnight || false\r\n        };\r\n        debugLog('MBAoi9uv43d: Using default times:', defaultTimes);\r\n        setTimes(defaultTimes);\r\n        setShowIndividualDays(false);\r\n        return;\r\n      }\r\n      \r\n      // Extract the hasIndividualTimes flag early\r\n      const hasIndividualTimesFlag = initialTimes.hasIndividualTimes === true;\r\n      debugLog('MBAoi9uv43d: hasIndividualTimes flag is', hasIndividualTimesFlag);\r\n      \r\n      // Only set the showIndividualDays based on initialTimes on the initial render\r\n      // This prevents it from overriding user's toggle action\r\n      if (isInitialRender.current) {\r\n        debugLog('MBAoi9uv43d: Initial render - setting showIndividualDays to', hasIndividualTimesFlag);\r\n        setShowIndividualDays(hasIndividualTimesFlag);\r\n        isInitialRender.current = false;\r\n      } else {\r\n        debugLog('MBAoi9uv43d: Not initial render - preserving showIndividualDays state');\r\n      }\r\n      \r\n      // Get formatted start time\r\n      const startTimeValue = parseTimeValue(initialTimes.startTime);\r\n      const endTimeValue = parseTimeValue(initialTimes.endTime);\r\n      \r\n      const formattedTimes = {\r\n        startTime: startTimeValue || { hours: 9, minutes: 0 },\r\n        endTime: endTimeValue || { hours: 17, minutes: 0 },\r\n        isOvernightForced: initialTimes.isOvernightForced || selectedService?.is_overnight || false\r\n      };\r\n      \r\n      debugLog('MBAoi9uv43d: Setting formatted times:', formattedTimes);\r\n      setTimes(formattedTimes);\r\n      \r\n      // Check if initialTimes already has individual times or if we have dates from draft\r\n      const hasDatesInDraft = initialTimes && Object.keys(initialTimes).some(key => key.match(/^\\d{4}-\\d{2}-\\d{2}$/));\r\n      \r\n      debugLog('MBAoi9uv43d: Time selection setup:', { \r\n        hasDatesInDraft,\r\n        hasIndividualTimesFlag,\r\n        hasDateRange: !!(dateRange && dateRange.startDate && dateRange.endDate),\r\n        hasDates: !!(initialTimes && initialTimes.dates && initialTimes.dates.length > 0)\r\n      });\r\n      \r\n      // Initialize individual time ranges if we have a date range or dates in draft\r\n      if ((dateRange && dateRange.startDate && dateRange.endDate) || hasDatesInDraft) {\r\n        const newTimeRanges = {};\r\n        \r\n        // If we have a dateRange, populate default times for all dates in the range\r\n        if (dateRange && dateRange.startDate && dateRange.endDate) {\r\n          const startDate = new Date(dateRange.startDate);\r\n          const endDate = new Date(dateRange.endDate);\r\n          \r\n          // Set default times for each date in the range\r\n          const current = new Date(startDate);\r\n          while (current <= endDate) {\r\n            const dateKey = current.toISOString().split('T')[0];\r\n            newTimeRanges[dateKey] = JSON.parse(JSON.stringify(formattedTimes));\r\n            current.setDate(current.getDate() + 1);\r\n          }\r\n        }\r\n        \r\n        // Also populate time ranges from multiple days selection if available\r\n        if (initialTimes.dates && initialTimes.dates.length > 0 && !dateRange) {\r\n          debugLog('MBAoi9uv43d: Creating time ranges from multiple days selection');\r\n          initialTimes.dates.forEach(dateObj => {\r\n            // Handle different date formats\r\n            let date;\r\n            if (typeof dateObj === 'string') {\r\n              date = new Date(dateObj);\r\n            } else if (dateObj && dateObj.date) {\r\n              date = new Date(dateObj.date);\r\n            } else {\r\n              date = new Date(dateObj);\r\n            }\r\n            \r\n            const dateKey = date.toISOString().split('T')[0];\r\n            if (!newTimeRanges[dateKey]) {\r\n              newTimeRanges[dateKey] = JSON.parse(JSON.stringify(formattedTimes));\r\n            }\r\n          });\r\n        }\r\n        \r\n        // Check if initialTimes has individual times for specific days\r\n        if (hasIndividualTimesFlag || hasDatesInDraft) {\r\n          Object.keys(initialTimes).forEach(key => {\r\n            // Check if the key is a date (format YYYY-MM-DD)\r\n            if (key.match(/^\\d{4}-\\d{2}-\\d{2}$/) && initialTimes[key]) {\r\n              const dayTime = initialTimes[key];\r\n              const parsedStartTime = parseTimeValue(dayTime.startTime);\r\n              const parsedEndTime = parseTimeValue(dayTime.endTime);\r\n              \r\n              if (parsedStartTime || parsedEndTime) {\r\n                newTimeRanges[key] = {\r\n                  startTime: parsedStartTime || { hours: 9, minutes: 0 },\r\n                  endTime: parsedEndTime || { hours: 17, minutes: 0 },\r\n                  isOvernightForced: dayTime.isOvernightForced || false\r\n                };\r\n              }\r\n            }\r\n          });\r\n        }\r\n        \r\n        // Also handle individualTimeRanges format from initialTimes\r\n        if (initialTimes.individualTimeRanges) {\r\n          Object.keys(initialTimes.individualTimeRanges).forEach(dateKey => {\r\n            if (dateKey.match(/^\\d{4}-\\d{2}-\\d{2}$/)) {\r\n              const dayTime = initialTimes.individualTimeRanges[dateKey];\r\n              const parsedStartTime = parseTimeValue(dayTime.startTime);\r\n              const parsedEndTime = parseTimeValue(dayTime.endTime);\r\n              \r\n              if (parsedStartTime || parsedEndTime) {\r\n                newTimeRanges[dateKey] = {\r\n                  startTime: parsedStartTime || { hours: 9, minutes: 0 },\r\n                  endTime: parsedEndTime || { hours: 17, minutes: 0 },\r\n                  isOvernightForced: dayTime.isOvernightForced || false\r\n                };\r\n              }\r\n            }\r\n          });\r\n        }\r\n        \r\n        debugLog('MBAoi9uv43d: Setting individual time ranges:', newTimeRanges);\r\n        setIndividualTimeRanges(newTimeRanges);\r\n      }\r\n    } catch (error) {\r\n      debugLog('MBAoi9uv43d: Error processing initialTimes:', error);\r\n      // Set default times on error\r\n      setTimes({\r\n        startTime: { hours: 9, minutes: 0 },\r\n        endTime: { hours: 17, minutes: 0 },\r\n        isOvernightForced: selectedService?.is_overnight || false\r\n      });\r\n    }\r\n  }, [initialTimes, dateRange, selectedService]);\r\n  \r\n  const handleDefaultTimeSelect = (newTimes) => {\r\n    debugLog('MBAoi9uv43d: handleDefaultTimeSelect called with:', newTimes);\r\n    \r\n    // Create a new deep copy to avoid reference issues\r\n    const updatedTimes = JSON.parse(JSON.stringify(newTimes));\r\n    \r\n    // Update our local state\r\n    setTimes(updatedTimes);\r\n    \r\n    // If showing individual days, update each day's times\r\n    if (showIndividualDays) {\r\n      const updatedRanges = {};\r\n      \r\n      // Create deep copies for each date\r\n      Object.keys(individualTimeRanges).forEach(date => {\r\n        updatedRanges[date] = {\r\n          startTime: updatedTimes.startTime,\r\n          endTime: updatedTimes.endTime,\r\n          isOvernightForced: updatedTimes.isOvernightForced\r\n        };\r\n      });\r\n      \r\n      setIndividualTimeRanges(updatedRanges);\r\n      \r\n      // Send full object with individual day data\r\n      onTimeSelect({\r\n        ...updatedTimes,\r\n        ...updatedRanges,\r\n        hasIndividualTimes: true\r\n      });\r\n    } else {\r\n      // Just send the default times\r\n      onTimeSelect({\r\n        ...updatedTimes,\r\n        hasIndividualTimes: false\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleIndividualDayTimeSelect = (timesData, dateKey) => {\r\n    debugLog('MBAoi9uv43d: Individual day time selection for card:', { dateKey, timesData });\r\n    \r\n    if (!dateKey) {\r\n      debugLog('MBAoi9uv43d: No dateKey provided, returning');\r\n      return;\r\n    }\r\n\r\n    // Create a completely fresh object for the updated ranges with no shared references\r\n    const updatedRanges = JSON.parse(JSON.stringify(individualTimeRanges));\r\n    \r\n    // Now set the new time data for this date key\r\n    updatedRanges[dateKey] = JSON.parse(JSON.stringify(timesData));\r\n    \r\n    debugLog('MBAoi9uv43d: TimeSelectionCard updating only date:', dateKey);\r\n    debugLog('MBAoi9uv43d: Current individualTimeRanges keys:', Object.keys(individualTimeRanges));\r\n    debugLog('MBAoi9uv43d: New updatedRanges keys:', Object.keys(updatedRanges));\r\n    \r\n    // Update local state with completely new object to break all references\r\n    setIndividualTimeRanges(updatedRanges);\r\n    \r\n    // Format time strings for API\r\n    const formattedRanges = {};\r\n    Object.keys(updatedRanges).forEach(date => {\r\n      const timeData = updatedRanges[date];\r\n      formattedRanges[date] = {\r\n        startTime: `${String(timeData.startTime.hours).padStart(2, '0')}:${String(timeData.startTime.minutes).padStart(2, '0')}`,\r\n        endTime: `${String(timeData.endTime.hours).padStart(2, '0')}:${String(timeData.endTime.minutes).padStart(2, '0')}`,\r\n        isOvernightForced: !!timeData.isOvernightForced\r\n      };\r\n    });\r\n    \r\n    // Create a completely new data object for the parent component\r\n    const updatedData = {\r\n      startTime: JSON.parse(JSON.stringify(times.startTime)),\r\n      endTime: JSON.parse(JSON.stringify(times.endTime)),\r\n      isOvernightForced: times.isOvernightForced,\r\n      hasIndividualTimes: true,\r\n      dates: initialTimes.dates ? [...initialTimes.dates] : [],\r\n      individualTimeRanges: formattedRanges\r\n    };\r\n    \r\n    // Add the specific date data\r\n    updatedData[dateKey] = formattedRanges[dateKey];\r\n    \r\n    debugLog('MBAoi9uv43d: TimeSelectionCard sending updated data to parent');\r\n    onTimeSelect(updatedData);\r\n  };\r\n\r\n  const handleToggleIndividualDays = () => {\r\n    debugLog('MBAoi9uv43d: TOGGLE button pressed');\r\n    debugLog('MBAoi9uv43d: Current showIndividualDays state:', showIndividualDays);\r\n    \r\n    if (showIndividualDays) {\r\n      // Currently showing individual days, switching to default time range\r\n      debugLog('MBAoi9uv43d: Switching FROM individual days TO default time range');\r\n      \r\n      // First, update the UI state\r\n      setShowIndividualDays(false);\r\n      \r\n      // Then send updated data to parent with hasIndividualTimes=false\r\n      // Include ONLY the essential time data, no date keys\r\n      const updatedData = {\r\n        startTime: times.startTime,\r\n        endTime: times.endTime,\r\n        isOvernightForced: times.isOvernightForced,\r\n        hasIndividualTimes: false,\r\n        // Keep the dates array for reference but don't include individual time ranges\r\n        dates: initialTimes.dates || []\r\n      };\r\n      \r\n      debugLog('MBAoi9uv43d: Sending default time data to parent:', updatedData);\r\n      onTimeSelect(updatedData);\r\n    } else {\r\n      // Currently showing default time range, switching to individual days\r\n      debugLog('MBAoi9uv43d: Switching FROM default time range TO individual days');\r\n      \r\n      // First update the UI state\r\n      setShowIndividualDays(true);\r\n      \r\n      // Create individual time ranges\r\n      let newTimeRanges = {};\r\n      \r\n      // Check if we have multiple individual dates from the booking data\r\n      const hasMultipleDays = initialTimes && initialTimes.dates && initialTimes.dates.length > 0;\r\n      \r\n      if (hasMultipleDays) {\r\n        // Get dates from initialTimes.dates for multiple-days selection\r\n        debugLog('MBAoi9uv43d: Creating time ranges for multiple individual dates');\r\n        \r\n        initialTimes.dates.forEach(dateObj => {\r\n          // Handle different date formats\r\n          let date;\r\n          if (typeof dateObj === 'string') {\r\n            date = new Date(dateObj);\r\n          } else if (dateObj && dateObj.date) {\r\n            date = new Date(dateObj.date);\r\n          } else {\r\n            date = new Date(dateObj);\r\n          }\r\n          \r\n          const dateKey = date.toISOString().split('T')[0];\r\n          \r\n          // Use current times values as default\r\n          newTimeRanges[dateKey] = {\r\n            startTime: JSON.parse(JSON.stringify(times.startTime)),\r\n            endTime: JSON.parse(JSON.stringify(times.endTime)),\r\n            isOvernightForced: times.isOvernightForced\r\n          };\r\n        });\r\n      } else if (dateRange && dateRange.startDate && dateRange.endDate) {\r\n        // Create ranges from dateRange\r\n        debugLog('MBAoi9uv43d: Creating time ranges from dateRange');\r\n        \r\n        const startDate = new Date(dateRange.startDate);\r\n        const endDate = new Date(dateRange.endDate);\r\n        const current = new Date(startDate);\r\n        \r\n        while (current <= endDate) {\r\n          const dateKey = current.toISOString().split('T')[0];\r\n          \r\n          // Use current times values as default, with deep copy\r\n          newTimeRanges[dateKey] = {\r\n            startTime: JSON.parse(JSON.stringify(times.startTime)),\r\n            endTime: JSON.parse(JSON.stringify(times.endTime)),\r\n            isOvernightForced: times.isOvernightForced\r\n          };\r\n          \r\n          // Move to next day\r\n          current.setDate(current.getDate() + 1);\r\n        }\r\n      } else if (Object.keys(individualTimeRanges).length > 0) {\r\n        // Use existing time ranges if we already have them\r\n        newTimeRanges = JSON.parse(JSON.stringify(individualTimeRanges));\r\n      }\r\n      \r\n      debugLog('MBAoi9uv43d: Setting individual time ranges:', newTimeRanges);\r\n      setIndividualTimeRanges(newTimeRanges);\r\n      \r\n      // Send full object with individual day data\r\n      onTimeSelect({\r\n        ...times,\r\n        ...newTimeRanges,\r\n        hasIndividualTimes: true\r\n      });\r\n    }\r\n  };\r\n\r\n  // Utility to get dates from dateRange or initialTimes\r\n  const getDates = () => {\r\n    let dates = [];\r\n    \r\n    // Check if we have multiple individual dates from the booking data\r\n    const hasMultipleDays = initialTimes && initialTimes.dates && initialTimes.dates.length > 0;\r\n    \r\n    if (hasMultipleDays) {\r\n      // Get dates from the initialTimes.dates for multiple-days selection\r\n      debugLog('MBAoi9uv43d: Using multiple individual dates from initialTimes:', initialTimes.dates);\r\n      dates = initialTimes.dates.map(dateObj => {\r\n        // Handle different date formats (string or object with date property)\r\n        if (typeof dateObj === 'string') {\r\n          return new Date(dateObj);\r\n        } else if (dateObj && dateObj.date) {\r\n          return new Date(dateObj.date);\r\n        } else {\r\n          return new Date(dateObj);\r\n        }\r\n      });\r\n    } else if (dateRange && dateRange.startDate && dateRange.endDate) {\r\n      // Generate array of dates between start and end for date range\r\n      debugLog('MBAoi9uv43d: Generating dates from dateRange:', dateRange);\r\n      const startDate = new Date(dateRange.startDate);\r\n      const endDate = new Date(dateRange.endDate);\r\n      const current = new Date(startDate);\r\n      \r\n      while (current <= endDate) {\r\n        dates.push(new Date(current));\r\n        current.setDate(current.getDate() + 1);\r\n      }\r\n    }\r\n    \r\n    return dates;\r\n  };\r\n\r\n  return (\r\n    <View style={styles.container}>\r\n      <View style={styles.card}>\r\n        {/* Only show default time range selector when not showing individual days */}\r\n        {!showIndividualDays && (\r\n          <NewTimeRangeSelector\r\n            onTimeSelect={handleDefaultTimeSelect}\r\n            initialTimes={times}\r\n            is_overnight={selectedService?.is_overnight || times.isOvernightForced || isOvernightForced || false}\r\n            uniqueId=\"default-time-range\"\r\n            dateRange={dateRange}\r\n            selectedDates={initialTimes.dates || []}\r\n          />\r\n        )}\r\n\r\n        {/* Only show customize button if not an overnight service */}\r\n        {!selectedService?.is_overnight && !isOvernightForced && (\r\n          <View style={styles.customizeButtonContainer}>\r\n            <TouchableOpacity \r\n              style={styles.customizeButton}\r\n              onPress={handleToggleIndividualDays}\r\n              activeOpacity={0.7}\r\n            >\r\n              <MaterialIcons name=\"schedule\" size={20} color={theme.colors.mainColors.main} />\r\n              <Text style={styles.customizeButtonText}>\r\n                {showIndividualDays ? 'Set Default Time Range' : 'Customize Individual Day Schedules'}\r\n              </Text>\r\n            </TouchableOpacity>\r\n          </View>\r\n        )}\r\n\r\n        {/* Only show individual day schedules if not an overnight service and the toggle is on */}\r\n        {showIndividualDays && !selectedService?.is_overnight && !isOvernightForced && (\r\n          <View style={styles.individualDaysContainer}>\r\n            <Text style={styles.sectionHeader}>Individual Day Schedules</Text>\r\n            <ScrollView>\r\n              {getDates().map((date, index) => {\r\n                const dateKey = date.toISOString().split('T')[0];\r\n                \r\n                // Get existing time data for this date or use default with deep copying\r\n                let timeData;\r\n                \r\n                // Check if we have a specific time range for this date in initialTimes\r\n                if (initialTimes && initialTimes[dateKey]) {\r\n                  const parsedStartTime = parseTimeValue(initialTimes[dateKey].startTime);\r\n                  const parsedEndTime = parseTimeValue(initialTimes[dateKey].endTime);\r\n                  \r\n                  timeData = {\r\n                    startTime: parsedStartTime || JSON.parse(JSON.stringify(times.startTime)),\r\n                    endTime: parsedEndTime || JSON.parse(JSON.stringify(times.endTime)),\r\n                    isOvernightForced: !!initialTimes[dateKey].isOvernightForced\r\n                  };\r\n                  \r\n                  debugLog(`MBAoi9uv43d: Found specific time data for date ${dateKey} in initialTimes`);\r\n                } \r\n                // Otherwise check individualTimeRanges which is our local state\r\n                else if (individualTimeRanges && individualTimeRanges[dateKey]) {\r\n                  timeData = JSON.parse(JSON.stringify(individualTimeRanges[dateKey]));\r\n                  debugLog(`MBAoi9uv43d: Using time from individualTimeRanges for date ${dateKey}`);\r\n                } \r\n                // If nothing found, use default times\r\n                else {\r\n                  timeData = { \r\n                    startTime: JSON.parse(JSON.stringify(times.startTime)),\r\n                    endTime: JSON.parse(JSON.stringify(times.endTime)),\r\n                    isOvernightForced: times.isOvernightForced\r\n                  };\r\n                  debugLog(`MBAoi9uv43d: Using default times for date ${dateKey}`);\r\n                }\r\n                \r\n                return (\r\n                  <DayTimeSelector\r\n                    key={`day-${dateKey}`}\r\n                    date={date}\r\n                    initialTimes={timeData}\r\n                    onTimeChange={handleIndividualDayTimeSelect}\r\n                    is_overnight={selectedService?.is_overnight || false}\r\n                  />\r\n                );\r\n              })}\r\n            </ScrollView>\r\n          </View>\r\n        )}\r\n      </View>\r\n    </View>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    padding: 16,\r\n  },\r\n  card: {\r\n    backgroundColor: theme.colors.background,\r\n    borderRadius: 12,\r\n  },\r\n  customizeButtonContainer: {\r\n    marginBottom: 24,\r\n    paddingHorizontal: 16,\r\n  },\r\n  customizeButton: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    gap: 8,\r\n    paddingVertical: 12,\r\n    paddingHorizontal: 16,\r\n    borderRadius: 8,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.mainColors.main,\r\n  },\r\n  customizeButtonText: {\r\n    color: theme.colors.mainColors.main,\r\n    fontSize: theme.fontSizes.medium,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    textAlign: 'center',\r\n  },\r\n  individualDaysContainer: {\r\n    gap: 12,\r\n    marginBottom: 16,\r\n  },\r\n  sectionHeader: {\r\n    fontSize: theme.fontSizes.medium,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    color: theme.colors.text,\r\n    marginBottom: 12,\r\n    paddingHorizontal: 16,\r\n  },\r\n});\r\n\r\nexport default TimeSelectionCard; ","import React, { useState, useContext, useEffect } from 'react';\r\nimport {\r\n  View,\r\n  Text,\r\n  StyleSheet,\r\n  TouchableOpacity,\r\n  Modal,\r\n  SafeAreaView,\r\n  Platform,\r\n  ScrollView,\r\n  Dimensions,\r\n} from 'react-native';\r\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\r\nimport { theme } from '../styles/theme';\r\nimport { AuthContext, debugLog } from '../context/AuthContext';\r\nimport ServiceAndPetsCard from './bookingComponents/ServiceAndPetsCard';\r\nimport DateSelectionCard from './bookingComponents/DateSelectionCard';\r\nimport TimeSelectionCard from './bookingComponents/TimeSelectionCard';\r\nimport ReviewAndRatesCard from './bookingComponents/ReviewAndRatesCard';\r\nimport StepProgressIndicator from './common/StepProgressIndicator';\r\nimport { updateBookingDraftPetsAndServices, \r\n         updateBookingDraftTimeAndDate, \r\n         updateBookingDraftMultipleDays,\r\n         updateBookingDraftRecurring,\r\n         createBookingFromDraft,\r\n         getBookingDraftDatesAndTimes\r\n} from '../api/API';\r\nimport { convertToUTC, formatDateForAPI, formatTimeForAPI, parseOccurrencesForBookingSteps } from '../utils/time_utils';\r\n\r\nconst STEPS = {\r\n  SERVICES_AND_PETS: {\r\n    id: 0,\r\n    name: 'Services & Pets'\r\n  },\r\n  DATE_SELECTION: {\r\n    id: 1,\r\n    name: 'Date Selection'\r\n  },\r\n  TIME_SELECTION: {\r\n    id: 2,\r\n    name: 'Time Selection'\r\n  },\r\n  REVIEW_AND_RATES: {\r\n    id: 3,\r\n    name: 'Review & Rates'\r\n  }\r\n};\r\n\r\nconst BookingStepModal = ({ \r\n  visible, \r\n  onClose,\r\n  bookingId,\r\n  onComplete,\r\n  initialData = {},\r\n  navigation\r\n}) => {\r\n  const { is_DEBUG, screenWidth, timeSettings } = useContext(AuthContext);\r\n  const isSmallScreen = screenWidth < 600;\r\n  const isDesktop = screenWidth > 768;\r\n  const [currentStep, setCurrentStep] = useState(STEPS.SERVICES_AND_PETS.id);\r\n  const [bookingData, setBookingData] = useState({\r\n    service: initialData.service || null,\r\n    pets: initialData.pets || [],\r\n    dates: initialData.dates || [],\r\n    bookingType: initialData.bookingType || 'one-time',\r\n    dateRangeType: initialData.dateRangeType || 'date-range',\r\n    times: initialData.times || {\r\n      startTime: '09:00',  // Default start time\r\n      endTime: '17:00',    // Default end time\r\n      isOvernightForced: false,\r\n      hasIndividualTimes: false  // Default to false\r\n    },\r\n    rates: initialData.rates || {},\r\n    dateSelectionData: null,\r\n    dateRange: null,\r\n    hasFetchedDates: false, // Track whether dates have been fetched\r\n  });\r\n  const [error, setError] = useState(null);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n\r\n  // Add effect to log initial data\r\n  useEffect(() => {\r\n    debugLog('MBA12345 Initial data received:', initialData);\r\n    debugLog('MBA12345 Initial booking data state:', bookingData);\r\n  }, [initialData]);\r\n\r\n  // New effect to fetch draft dates and times\r\n  useEffect(() => {\r\n    const fetchDraftDatesAndTimes = async () => {\r\n      if (!bookingId || !visible) return;\r\n      \r\n      // Only fetch if we haven't already loaded dates, or if they're empty\r\n      if (bookingData.hasFetchedDates) {\r\n        debugLog('MBA2j3kbr9hve4: Skipping fetch as hasFetchedDates is true');\r\n        return;\r\n      }\r\n      \r\n      try {\r\n        setIsLoading(true);\r\n        setError(null);\r\n        \r\n        debugLog('MBA2j3kbr9hve4: Fetching draft dates and times for booking ID:', bookingId);\r\n        const response = await getBookingDraftDatesAndTimes(bookingId);\r\n        debugLog('MBA2j3kbr9hve4: Received draft dates and times:', response);\r\n        \r\n        if (response) {\r\n          // Use our utility function to parse occurrences correctly\r\n          const parsedData = parseOccurrencesForBookingSteps(response.occurrences || []);\r\n          \r\n          debugLog('MBA2j3kbr9hve4: Parsed draft dates and times:', parsedData);\r\n          \r\n          // Check if this is an overnight service\r\n          // First check the service from the response \r\n          const serviceName = (response.service_details?.service_type || '').toLowerCase();\r\n          const knownOvernightTerms = ['overnight', 'boarding', 'house sitting', 'pet sitting'];\r\n          const isOvernightService = response.service_details?.is_overnight === true || \r\n                                   knownOvernightTerms.some(term => serviceName.includes(term));\r\n          \r\n          debugLog('MBA2j3kbr9hve4: Is overnight service from response:', isOvernightService);\r\n          debugLog('MBA2j3kbr9hve4: Service name:', serviceName);\r\n          debugLog('MBA2j3kbr9hve4: Known overnight terms match:', knownOvernightTerms.some(term => serviceName.includes(term)));\r\n          debugLog('MBA2j3kbr9hve4: Full service details from response:', response.service_details);\r\n\r\n          // Update bookingData with the service information to ensure we have the overnight status\r\n          let serviceData = null;\r\n          if (response.service_details) {\r\n            serviceData = {\r\n              ...response.service_details,\r\n              service_id: response.service_details.service_id,\r\n              service_name: response.service_details.service_type,\r\n              is_overnight: isOvernightService, // Using our improved overnight detection\r\n            };\r\n            debugLog('MBA2j3kbr9hve4: Setting service data with overnight status:', serviceData);\r\n          }\r\n          \r\n          // Check for occurrences to determine if this is an overnight booking\r\n          if (response.occurrences && response.occurrences.length > 0) {\r\n            // Check if we can determine if this is an overnight booking from the dates\r\n            const firstOcc = response.occurrences[0];\r\n            const lastOcc = response.occurrences[response.occurrences.length - 1];\r\n            \r\n            // If first and last occurrence have different dates, this might be an overnight range\r\n            if (firstOcc.start_date !== lastOcc.end_date) {\r\n              const startDate = new Date(firstOcc.start_date);\r\n              const endDate = new Date(lastOcc.end_date);\r\n              const daysDifference = Math.ceil((endDate - startDate) / (1000 * 60 * 60 * 24));\r\n              \r\n              // If the difference is 1+ days, it's likely an overnight booking\r\n              if (daysDifference >= 1) {\r\n                debugLog('MBA2j3kbr9hve4: DETECTED OVERNIGHT from date range:', {\r\n                  startDate: firstOcc.start_date,\r\n                  endDate: lastOcc.end_date,\r\n                  daysDifference\r\n                });\r\n                \r\n                // Force overnight mode\r\n                if (serviceData) {\r\n                  serviceData.is_overnight = true;\r\n                }\r\n              }\r\n            }\r\n          }\r\n            \r\n          // Special check to handle a possible case where we have a multi-day date range\r\n          // with only start and end dates in individual occurrences (instead of all dates)\r\n          if (response.occurrences?.length === 2) {\r\n            try {\r\n              const occ1Date = new Date(response.occurrences[0].start_date);\r\n              const occ2Date = new Date(response.occurrences[1].start_date);\r\n              \r\n              // Check if they are more than 1 day apart\r\n              const daysBetween = Math.abs(Math.round((occ2Date - occ1Date) / (1000 * 60 * 60 * 24)));\r\n              \r\n              if (daysBetween > 1) {\r\n                debugLog('MBA2j3kbr9hve4: DETECTED POTENTIAL OVERNIGHT from date distance:', {\r\n                  date1: response.occurrences[0].start_date,\r\n                  date2: response.occurrences[1].start_date,\r\n                  daysBetween\r\n                });\r\n                \r\n                // Force overnight mode if we have more than 1 day between occurrences\r\n                if (serviceData) {\r\n                  serviceData.is_overnight = true;\r\n                }\r\n              }\r\n            } catch (err) {\r\n              debugLog('MBA2j3kbr9hve4: Error checking occ dates:', err);\r\n            }\r\n          }\r\n            \r\n          // Ensure we set a correct dateRangeType\r\n          // If we have detected an overnight service, force 'date-range' mode\r\n          let dateRangeType = response.date_range_type || 'date-range';\r\n          if (isOvernightService || (serviceData && serviceData.is_overnight)) {\r\n            dateRangeType = 'date-range';\r\n            debugLog('MBA2j3kbr9hve4: Forcing date-range type for overnight service');\r\n          } \r\n          // Otherwise, if we have non-consecutive dates, force multiple-days mode\r\n          else if (parsedData.dates && parsedData.dates.length > 1 && !parsedData.dateRange) {\r\n            dateRangeType = 'multiple-days';\r\n            debugLog('MBA2j3kbr9hve4: Non-consecutive dates detected, forcing multiple-days mode');\r\n          }\r\n            \r\n          // Determine final overnight status\r\n          const isOvernightForced = isOvernightService || (serviceData && serviceData.is_overnight);\r\n          \r\n          debugLog('MBA2j3kbr9hve4: Final overnight determination:', {\r\n            initialCheck: isOvernightService,\r\n            afterOccurrenceChecks: serviceData?.is_overnight,\r\n            finalIsOvernightForced: isOvernightForced\r\n          });\r\n          \r\n          setBookingData(prev => ({\r\n            ...prev,\r\n            dates: parsedData.dates || [],\r\n            dateRange: parsedData.dateRange,\r\n            times: {\r\n              ...(parsedData.defaultTimes || {}),\r\n              ...parsedData.individualTimes,\r\n              individualTimeRanges: parsedData.individualTimes || {},\r\n              allTimesAreTheSame: parsedData.allTimesAreTheSame,\r\n              hasIndividualTimes: !parsedData.allTimesAreTheSame,\r\n              isOvernightForced: isOvernightForced\r\n            },\r\n            dateRangeType: dateRangeType,\r\n            bookingType: response.booking_type || prev.bookingType || 'one-time',\r\n            hasFetchedDates: true, // Flag to prevent refetching\r\n            // Update service information with overnight status\r\n            service: serviceData || prev.service\r\n          }));\r\n        }\r\n      } catch (error) {\r\n        debugLog('MBA2j3kbr9hve4: Error fetching draft dates and times:', error);\r\n        // Only show an error if we're not already on step 1 (service selection)\r\n        // This prevents showing an error when we're editing an existing booking\r\n        // that might not have dates/times yet\r\n        if (currentStep > STEPS.SERVICES_AND_PETS.id) {\r\n          setError('Failed to load booking details. Please try again.');\r\n        } else {\r\n          // Log the error but don't show it to the user on the first step\r\n          debugLog('MBA2j3kbr9hve4: Suppressing error on first step:', error.message);\r\n        }\r\n      } finally {\r\n        setIsLoading(false);\r\n      }\r\n    };\r\n    \r\n    fetchDraftDatesAndTimes();\r\n  }, [bookingId, visible, currentStep, bookingData.hasFetchedDates]);\r\n\r\n  // Effect to ensure dateRangeType is always 'date-range' for overnight services\r\n  useEffect(() => {\r\n    if (bookingData.service?.is_overnight || bookingData.times?.isOvernightForced) {\r\n      debugLog('MBA2j3kbr9hve4: Detected overnight service, ensuring dateRangeType is date-range');\r\n      \r\n      // If we have an overnight service but dateRangeType is not date-range, update it\r\n      if (bookingData.dateRangeType !== 'date-range') {\r\n        debugLog('MBA2j3kbr9hve4: Updating dateRangeType from', bookingData.dateRangeType, 'to date-range');\r\n        \r\n        setBookingData(prev => ({\r\n          ...prev,\r\n          dateRangeType: 'date-range'\r\n        }));\r\n      }\r\n    }\r\n  }, [bookingData.service, bookingData.times?.isOvernightForced]);\r\n\r\n  const handleServiceSelect = (service) => {\r\n    debugLog('MBA12345 Selected service:', service);\r\n    \r\n    // Check if the service has an overnight property or name contains overnight-related terms\r\n    const serviceName = (service?.service_name || '').toLowerCase();\r\n    const knownOvernightTerms = ['overnight', 'boarding', 'house sitting', 'pet sitting'];\r\n    \r\n    // Determine if this is an overnight service from the is_overnight flag or name\r\n    const isOvernight = service?.is_overnight === true || \r\n                        knownOvernightTerms.some(term => serviceName.includes(term));\r\n    \r\n    debugLog('MBA2j3kbr9hve4: Service overnight status:', {\r\n      isOvernight,\r\n      serviceData: service,\r\n      serviceName,\r\n      matchesOvernightTerms: knownOvernightTerms.some(term => serviceName.includes(term))\r\n    });\r\n    \r\n    setBookingData(prev => {\r\n      // Update times object to include isOvernightForced based on service\r\n      const updatedTimes = {\r\n        ...(prev.times || {}),\r\n        // Explicitly set isOvernightForced based on service type\r\n        isOvernightForced: isOvernight\r\n      };\r\n      \r\n      debugLog('MBA2j3kbr9hve4: Updated times with overnight status:', updatedTimes);\r\n      \r\n      // Also update the service object to ensure is_overnight is set correctly\r\n      const updatedService = {\r\n        ...service,\r\n        is_overnight: isOvernight\r\n      };\r\n      \r\n      return {\r\n        ...prev,\r\n        service: updatedService,\r\n        // Also update the times object to ensure isOvernightForced is set correctly\r\n        times: updatedTimes,\r\n        // Force date-range selection mode for overnight services\r\n        dateRangeType: isOvernight ? 'date-range' : prev.dateRangeType\r\n      };\r\n    });\r\n  };\r\n\r\n  const handlePetSelect = (pet) => {\r\n    debugLog('MBA12345 Selected/deselected pet:', pet);\r\n    \r\n    const updatedPets = bookingData.pets.find(p => p.pet_id === pet.pet_id)\r\n      ? bookingData.pets.filter(p => p.pet_id !== pet.pet_id)\r\n      : [...bookingData.pets, pet];\r\n\r\n    setBookingData(prev => ({\r\n      ...prev,\r\n      pets: updatedPets\r\n    }));\r\n  };\r\n\r\n  const handleDateSelect = (dateData) => {\r\n    debugLog('MBA12345 Selected dates:', dateData);\r\n    debugLog('MBA2j3kbr9hve4: CRITICAL handleDateSelect rangeType:', {\r\n      rangeType: dateData.rangeType,\r\n      currentDateRangeType: bookingData.dateRangeType,\r\n      isServiceOvernight: bookingData.service?.is_overnight,\r\n      isTimesOvernightForced: bookingData.times?.isOvernightForced\r\n    });\r\n    \r\n    setBookingData(prev => {\r\n      // Preserve date range when switching to multiple-days\r\n      let newDateRange = prev.dateRange;\r\n      \r\n      // Update date range based on the selection type\r\n      if (dateData.rangeType === 'date-range' && dateData.startDate && dateData.endDate) {\r\n        newDateRange = {\r\n          startDate: dateData.startDate,\r\n          endDate: dateData.endDate\r\n        };\r\n      } else if (dateData.rangeType === 'multiple-days') {\r\n        // Keep the existing date range when in multiple-days mode\r\n        newDateRange = prev.dateRange;\r\n      } else if (!dateData.dates || dateData.dates.length === 0) {\r\n        // Clear date range if all dates are cleared\r\n        newDateRange = null;\r\n      }\r\n\r\n      return {\r\n        ...prev,\r\n        dates: dateData.dates || [],\r\n        dateSelectionData: dateData,\r\n        dateRange: newDateRange,\r\n        dateRangeType: dateData.rangeType || prev.dateRangeType\r\n      };\r\n    });\r\n  };\r\n\r\n  const handleBookingTypeChange = (bookingType) => {\r\n    debugLog('MBA12345 Booking type changed:', bookingType);\r\n    setBookingData(prev => ({\r\n      ...prev,\r\n      bookingType,\r\n      // Clear dates when changing booking type\r\n      dates: []\r\n    }));\r\n  };\r\n\r\n  const handleDateRangeTypeChange = (dateRangeType) => {\r\n    debugLog('MBA12345 Date range type changed:', dateRangeType);\r\n    setBookingData(prev => ({\r\n      ...prev,\r\n      dateRangeType\r\n    }));\r\n  };\r\n\r\n  const handleTimeSelect = (timeData) => {\r\n    debugLog('MBAoi1h34ghnvo: TimeSelectionCard sent time data:', timeData);\r\n\r\n    // Just for logging\r\n    const hasServiceOvernight = bookingData.service?.is_overnight === true;\r\n    \r\n    setBookingData(prev => {\r\n      // Check if we have individual day times\r\n      if (timeData.hasIndividualTimes) {\r\n        debugLog('MBAoi1h34ghnvo: Processing individual times');\r\n        \r\n        // Create a new times object that preserves all individual time changes\r\n        const individualTimes = {\r\n          ...prev.times,\r\n          hasIndividualTimes: true,\r\n          isOvernightForced: timeData.isOvernightForced,\r\n          dates: timeData.dates || prev.times.dates || [],\r\n          // Preserve the raw individualTimeRanges\r\n          individualTimeRanges: timeData.individualTimeRanges || {}\r\n        };\r\n\r\n        // Add all date-specific time changes\r\n        Object.keys(timeData).forEach(key => {\r\n          if (key.match(/^\\d{4}-\\d{2}-\\d{2}$/)) {\r\n            debugLog('MBAoi1h34ghnvo: Processing date key:', key, timeData[key]);\r\n            // Ensure we preserve the exact time data for each date\r\n            individualTimes[key] = {\r\n              startTime: timeData[key].startTime,\r\n              endTime: timeData[key].endTime,\r\n              isOvernightForced: timeData[key].isOvernightForced\r\n            };\r\n          }\r\n        });\r\n          \r\n        debugLog('MBAoi1h34ghnvo: Final individual times object:', individualTimes);\r\n        \r\n        return {\r\n          ...prev,\r\n          times: individualTimes\r\n        };\r\n      } else {\r\n        debugLog('MBAoi1h34ghnvo: Using default time range mode');\r\n        \r\n        // Create a new times object that preserves any existing values\r\n        const updatedTimes = {\r\n          ...prev.times,\r\n          startTime: timeData.startTime ? `${String(timeData.startTime.hours).padStart(2, '0')}:${String(timeData.startTime.minutes || 0).padStart(2, '0')}` : prev.times.startTime,\r\n          endTime: timeData.endTime ? `${String(timeData.endTime.hours).padStart(2, '0')}:${String(timeData.endTime.minutes || 0).padStart(2, '0')}` : prev.times.endTime,\r\n          isOvernightForced: timeData.isOvernightForced,\r\n          hasIndividualTimes: false,\r\n          dates: timeData.dates || prev.times.dates || []\r\n        };\r\n\r\n        debugLog('MBAoi1h34ghnvo: Updated default times:', updatedTimes);\r\n\r\n        return {\r\n          ...prev,\r\n          times: updatedTimes\r\n        };\r\n      }\r\n    });\r\n  };\r\n\r\n  const canProceedToNextStep = () => {\r\n    switch (currentStep) {\r\n      case STEPS.SERVICES_AND_PETS.id:\r\n        return bookingData.service && bookingData.pets.length > 0;\r\n      case STEPS.DATE_SELECTION.id:\r\n        // Check if we have valid dates, either from:\r\n        // 1. dateSelectionData that's been validated\r\n        // 2. dates array with entries\r\n        // 3. a valid dateRange with both startDate and endDate\r\n\r\n        // First check if dateSelectionData exists and is valid\r\n        if (bookingData.dateSelectionData && bookingData.dateSelectionData.isValid) {\r\n          return true;\r\n        }\r\n        \r\n        // Check if we have any dates in the array\r\n        if (bookingData.dates && bookingData.dates.length > 0) {\r\n          return true;\r\n        }\r\n        \r\n        // Check if we have a valid date range\r\n        if (bookingData.dateRange && bookingData.dateRange.startDate && bookingData.dateRange.endDate) {\r\n          return true;\r\n        }\r\n        \r\n        // No valid date configuration found\r\n        return false;\r\n      case STEPS.TIME_SELECTION.id:\r\n        // Always allow proceeding from time selection since we have default times\r\n        return true;\r\n      case STEPS.REVIEW_AND_RATES.id:\r\n        return true;\r\n      // Add validation for other steps as they are implemented\r\n      default:\r\n        return false;\r\n    }\r\n  };\r\n\r\n  const handleNext = async () => {\r\n    if (!canProceedToNextStep()) {\r\n      setError('Please complete all required fields before proceeding');\r\n      return;\r\n    }\r\n\r\n    setError(null);\r\n    \r\n    // Log what's happening when advancing to the next step\r\n    debugLog('MBA2j3kbr9hve4: Moving to next step:', {\r\n      currentStep,\r\n      nextStep: currentStep + 1,\r\n      hasValidDates: bookingData.dates && bookingData.dates.length > 0,\r\n      hasValidDateRange: bookingData.dateRange && bookingData.dateRange.startDate && bookingData.dateRange.endDate,\r\n      hasValidDateSelectionData: bookingData.dateSelectionData && bookingData.dateSelectionData.isValid,\r\n      dateRangeType: bookingData.dateRangeType,\r\n      bookingType: bookingData.bookingType\r\n    });\r\n    \r\n    if (currentStep < STEPS.REVIEW_AND_RATES.id) {\r\n      // If we're on the first step, update the draft with selected service and pets\r\n      if (currentStep === STEPS.SERVICES_AND_PETS.id) {\r\n        try {\r\n          debugLog('MBA2j3kbr9hve4: Updating booking draft with service and pets');\r\n          await updateBookingDraftPetsAndServices(bookingId, {\r\n            service_id: bookingData.service?.service_id,\r\n            pets: bookingData.pets\r\n          });\r\n          debugLog('MBA2j3kbr9hve4: Successfully updated booking draft with service and pets');\r\n          \r\n          // Reset hasFetchedDates to force fetching dates and times when moving to the dates step\r\n          setBookingData(prev => ({\r\n            ...prev,\r\n            hasFetchedDates: false\r\n          }));\r\n        } catch (error) {\r\n          debugLog('MBA2j3kbr9hve4: Error updating booking draft:', error);\r\n          setError('Failed to save service and pet selections');\r\n          return;\r\n        }\r\n      }\r\n      \r\n      // Handle time selection calculations before proceeding\r\n      if (currentStep === STEPS.TIME_SELECTION.id) {\r\n        try {\r\n          debugLog('MBA5asdt3f4321 Original booking data:', bookingData);\r\n\r\n          // Direct fix - if the service is overnight, always use the updateBookingDraftTimeAndDate endpoint\r\n          // regardless of the dateRangeType that might have been previously set\r\n          const isServiceOvernightFlag = bookingData.service?.is_overnight === true;\r\n          const isTimeOvernightFlag = bookingData.times?.isOvernightForced === true;\r\n          const isAnyOvernightFlag = isServiceOvernightFlag || isTimeOvernightFlag;\r\n          \r\n          debugLog('MBA5asdt3f4321 DIRECT OVERNIGHT CHECK AT START:', {\r\n            isServiceOvernightFlag,\r\n            isTimeOvernightFlag,\r\n            isAnyOvernightFlag,\r\n            dateRangeType: bookingData.dateRangeType\r\n          });\r\n          \r\n          // If any overnight flag is set, we'll bypass all the other checks and directly use the overnight endpoint\r\n          if (isAnyOvernightFlag && bookingData.dateRange) {\r\n            // Force overnight mode\r\n            debugLog('MBA53212co2v3nvoub5 DIRECT OVERRIDE: Forcing overnight mode for any overnight service');\r\n            \r\n            const startDate = formatDateForAPI(bookingData.dateRange.startDate);\r\n            const endDate = formatDateForAPI(bookingData.dateRange.endDate);\r\n            const startTime = formatTimeForAPI(bookingData.times.startTime);\r\n            const endTime = formatTimeForAPI(bookingData.times.endTime);\r\n            \r\n            debugLog('MBA53212co2v3nvoub5 DIRECT OVERRIDE: Using time-and-date endpoint with dates:', {\r\n              startDate,\r\n              endDate,\r\n              startTime,\r\n              endTime\r\n            });\r\n            \r\n            // Get user's timezone from context\r\n            const userTz = timeSettings?.timezone || 'US/Mountain';\r\n            debugLog('MBA53212co2v3nvoub5 Using user timezone for UTC conversion:', userTz);\r\n            \r\n            // Convert local times to UTC before sending to backend\r\n            const { date: utcStartDate, time: utcStartTime } = convertToUTC(\r\n              startDate,\r\n              startTime,\r\n              userTz\r\n            );\r\n\r\n            const { date: utcEndDate, time: utcEndTime } = convertToUTC(\r\n              endDate,\r\n              endTime,\r\n              userTz\r\n            );\r\n\r\n            // Call the API with UTC times and dates\r\n            const response = await updateBookingDraftTimeAndDate(\r\n              bookingId,\r\n              utcStartDate,\r\n              utcEndDate,\r\n              utcStartTime,\r\n              utcEndTime\r\n            );\r\n            \r\n            debugLog('MBA53212co2v3nvoub5 DIRECT OVERRIDE: Response from updateBookingDraftTimeAndDate:', response);\r\n            \r\n            // Update booking data with the response's draft_data\r\n            if (response?.draft_data) {\r\n              setBookingData(prev => ({\r\n                ...prev,\r\n                ...response.draft_data,\r\n                // Ensure we maintain overnight settings\r\n                times: {\r\n                  ...(response.draft_data.times || prev.times),\r\n                  isOvernightForced: true\r\n                },\r\n                service: {\r\n                  ...(response.draft_data.service || prev.service),\r\n                  is_overnight: true\r\n                },\r\n                // Force dateRangeType to date-range for overnight services\r\n                dateRangeType: 'date-range'\r\n              }));\r\n            }\r\n            \r\n            // Skip the rest of the checks - we've already made the API call\r\n            setCurrentStep(prev => prev + 1);\r\n            return;\r\n          }\r\n          \r\n          if (bookingData.dateRangeType === 'date-range') {\r\n            // Check if this is a non-overnight service with date range\r\n            const isServiceOvernight = bookingData.service?.is_overnight === true;\r\n            // Check time overnight status - but don't count 00:00 end time as overnight by itself\r\n            const isTimeOvernight = bookingData.times?.isOvernightForced === true && \r\n                                   !(bookingData.times.endTime === '00:00' && !isServiceOvernight);\r\n            \r\n            // Check if the date range spans multiple days - if it does, treat it as overnight\r\n            let isMultiDayRange = false;\r\n            if (bookingData.dateRange && bookingData.dateRange.startDate && bookingData.dateRange.endDate) {\r\n              try {\r\n                const startDate = new Date(bookingData.dateRange.startDate);\r\n                const endDate = new Date(bookingData.dateRange.endDate);\r\n                const daysDifference = Math.ceil((endDate - startDate) / (1000 * 60 * 60 * 24));\r\n                \r\n                // If more than 1 day difference, consider it multi-day\r\n                if (daysDifference > 1) {\r\n                  isMultiDayRange = true;\r\n                  debugLog('MBA53212co2v3nvoub5 DETECTED multi-day date range:', {\r\n                    startDate: bookingData.dateRange.startDate,\r\n                    endDate: bookingData.dateRange.endDate,\r\n                    daysDifference\r\n                  });\r\n                }\r\n              } catch (err) {\r\n                debugLog('MBA53212co2v3nvoub5 Error checking date range:', err);\r\n              }\r\n            }\r\n            \r\n            debugLog('MBA53212co2v3nvoub5 CRITICAL Checking overnight status:', {\r\n              dateRangeType: bookingData.dateRangeType,\r\n              serviceIsOvernight: isServiceOvernight,\r\n              timesIsOvernightForced: bookingData.times?.isOvernightForced,\r\n              endTime: bookingData.times?.endTime,\r\n              endTimeIsMidnight: bookingData.times?.endTime === '00:00',\r\n              // Special check for midnight end time\r\n              isMidnightEndTimeButNotForced: bookingData.times?.endTime === '00:00' && !isServiceOvernight,\r\n              isTimeOvernight: isTimeOvernight,\r\n              isMultiDayRange: isMultiDayRange,\r\n              service: bookingData.service,\r\n              times: bookingData.times\r\n            });\r\n            \r\n            // DIRECT FIX: If either the service or times indicate this is an overnight service,\r\n            // or if we have a multi-day date range, we need to use the updateBookingDraftTimeAndDate endpoint\r\n            if (isServiceOvernight || isTimeOvernight || isMultiDayRange) {\r\n              // Force the overnight flag to ensure we get the right API call in future steps\r\n              const updatedBookingData = {\r\n                ...bookingData,\r\n                service: {\r\n                  ...bookingData.service,\r\n                  is_overnight: true\r\n                },\r\n                times: {\r\n                  ...bookingData.times,\r\n                  isOvernightForced: true\r\n                }\r\n              };\r\n              \r\n              // Update state with the forced overnight mode\r\n              setBookingData(updatedBookingData);\r\n              \r\n              // This is an overnight service with a date range, so we should call updateBookingDraftTimeAndDate\r\n              debugLog('MBA53212co2v3nvoub5 OVERRIDE: Forcing overnight mode for date range due to overnight service or flag');\r\n              \r\n              const startDate = formatDateForAPI(bookingData.dateRange.startDate);\r\n              const endDate = formatDateForAPI(bookingData.dateRange.endDate);\r\n              const startTime = formatTimeForAPI(bookingData.times.startTime);\r\n              const endTime = formatTimeForAPI(bookingData.times.endTime);\r\n              \r\n              // Get user's timezone from context\r\n              const userTz = timeSettings?.timezone || 'US/Mountain';\r\n              debugLog('MBA53212co2v3nvoub5 Using user timezone for UTC conversion:', userTz);\r\n              \r\n              // Convert local times to UTC before sending to backend\r\n              const { date: utcStartDate, time: utcStartTime } = convertToUTC(\r\n                startDate,\r\n                startTime,\r\n                userTz\r\n              );\r\n\r\n              const { date: utcEndDate, time: utcEndTime } = convertToUTC(\r\n                endDate,\r\n                endTime,\r\n                userTz\r\n              );\r\n\r\n              // Call the API with UTC times and dates\r\n              const response = await updateBookingDraftTimeAndDate(\r\n                bookingId,\r\n                utcStartDate,\r\n                utcEndDate,\r\n                utcStartTime,\r\n                utcEndTime\r\n              );\r\n              \r\n              debugLog('MBA53212co2v3nvoub5 Received response from updateBookingDraftTimeAndDate (overnight override):', response);\r\n              \r\n              // Update booking data with the response's draft_data\r\n              if (response?.draft_data) {\r\n                setBookingData(prev => ({\r\n                  ...prev,\r\n                  ...response.draft_data,\r\n                  // Ensure we maintain overnight settings\r\n                  times: {\r\n                    ...(response.draft_data.times || prev.times),\r\n                    isOvernightForced: true\r\n                  },\r\n                  service: {\r\n                    ...(response.draft_data.service || prev.service),\r\n                    is_overnight: true\r\n                  }\r\n                }));\r\n              }\r\n              \r\n              // Skip the rest of the checks since we've already made the API call\r\n              setCurrentStep(prev => prev + 1);\r\n              return;\r\n            }\r\n            \r\n            const isNonOvernightDateRange = \r\n              bookingData.dateRangeType === 'date-range' && \r\n              !isServiceOvernight &&\r\n              !isTimeOvernight &&\r\n              !isMultiDayRange;\r\n\r\n            debugLog('MBA53212co2v3nvoub5 Decision:', {\r\n              isNonOvernightDateRange: isNonOvernightDateRange,\r\n              willUseEndpoint: isNonOvernightDateRange ? 'updateBookingDraftMultipleDays' : 'updateBookingDraftTimeAndDate'\r\n            });\r\n\r\n            if (isNonOvernightDateRange) {\r\n              // For non-overnight date range services, we need to create individual days\r\n              debugLog('MBA53212co2v3nvoub5 Handling non-overnight date range as individual occurrences');\r\n              \r\n              // Create dates array from date range\r\n              const startDate = new Date(bookingData.dateRange.startDate);\r\n              const endDate = new Date(bookingData.dateRange.endDate);\r\n              const dates = [];\r\n              \r\n              // Generate all dates in the range\r\n              const currentDate = new Date(startDate);\r\n              while (currentDate <= endDate) {\r\n                dates.push(new Date(currentDate));\r\n                currentDate.setDate(currentDate.getDate() + 1);\r\n              }\r\n              \r\n              debugLog('MBA53212co2v3nvoub5 Generated dates from range:', dates.map(d => d.toISOString().split('T')[0]));\r\n              debugLog('MBA53212co2v3nvoub5 Time settings:', bookingData.times);\r\n              \r\n              // Format dates and determine times for each day\r\n              const formattedDates = dates.map(date => {\r\n                const dateKey = date.toISOString().split('T')[0];\r\n                debugLog('MBA53212co2v3nvoub5 Processing date:', dateKey);\r\n                \r\n                let dayTimes = bookingData.times;\r\n                \r\n                // If there are individual time settings for this day, use those\r\n                if (bookingData.times[dateKey] && bookingData.times.hasIndividualTimes) {\r\n                  dayTimes = bookingData.times[dateKey];\r\n                  debugLog('MBA53212co2v3nvoub5 Using individual times for date:', dateKey, dayTimes);\r\n                } else {\r\n                  debugLog('MBA53212co2v3nvoub5 Using default times for date:', dateKey, dayTimes);\r\n                }\r\n                \r\n                // Format the start time\r\n                let startTime;\r\n                if (typeof dayTimes.startTime === 'string') {\r\n                  startTime = dayTimes.startTime;\r\n                } else if (dayTimes.startTime?.hours !== undefined) {\r\n                  startTime = `${String(dayTimes.startTime.hours).padStart(2, '0')}:${String(dayTimes.startTime.minutes || 0).padStart(2, '0')}`;\r\n                } else {\r\n                  // Default time if missing\r\n                  startTime = '09:00';\r\n                }\r\n                \r\n                // Format the end time\r\n                let endTime;\r\n                if (typeof dayTimes.endTime === 'string') {\r\n                  endTime = dayTimes.endTime;\r\n                } else if (dayTimes.endTime?.hours !== undefined) {\r\n                  endTime = `${String(dayTimes.endTime.hours).padStart(2, '0')}:${String(dayTimes.endTime.minutes || 0).padStart(2, '0')}`;\r\n                } else {\r\n                  // Default time if missing\r\n                  endTime = '17:00';\r\n                }\r\n                \r\n                debugLog('MBA53212co2v3nvoub5 Formatted times for date:', dateKey, { startTime, endTime });\r\n                \r\n                // Format the date\r\n                const formattedDate = formatDateForAPI(date);\r\n                debugLog('MBA53212co2v3nvoub5 Formatted date:', formattedDate);\r\n                \r\n                // Determine if the end time might cross to the next day\r\n                // Check if end time is midnight or earlier than start time, indicating day boundary crossing\r\n                const needsNextDayDate = endTime === '00:00' || \r\n                                        (parseInt(endTime.split(':')[0], 10) < parseInt(startTime.split(':')[0], 10)) ||\r\n                                        (parseInt(endTime.split(':')[0], 10) === parseInt(startTime.split(':')[0], 10) && \r\n                                         parseInt(endTime.split(':')[1], 10) < parseInt(startTime.split(':')[1], 10));\r\n                \r\n                // Calculate end date - either same day or next day\r\n                const endDateObj = needsNextDayDate \r\n                  ? new Date(date.getTime() + 24*60*60*1000) // Next day if crossing midnight\r\n                  : new Date(date);\r\n                  \r\n                const formattedEndDate = formatDateForAPI(endDateObj);\r\n                \r\n                debugLog('MBA53212co2v3nvoub5 End date calculation:', {\r\n                  needsNextDayDate,\r\n                  startTime,\r\n                  endTime,\r\n                  originalDate: formattedDate,\r\n                  calculatedEndDate: formattedEndDate\r\n                });\r\n                \r\n                // IMPORTANT: Crossing midnight or having a different end date due to 00:00 end time\r\n                // should NOT force overnight mode - that should only be based on the service type\r\n                // We're just calculating the correct end date for API payload\r\n                \r\n                // Get user's timezone from context\r\n                const userTz = timeSettings?.timezone || 'US/Mountain';\r\n                debugLog('MBA53212co2v3nvoub5 Using user timezone for UTC conversion in map function:', userTz);\r\n                \r\n                // Convert local times to UTC for start time and date\r\n                const { date: utcStartDate, time: utcStartTime } = convertToUTC(\r\n                  formattedDate,\r\n                  startTime,\r\n                  userTz\r\n                );\r\n                \r\n                // Convert end time to UTC with potentially different end date\r\n                const { date: utcEndDate, time: utcEndTime } = convertToUTC(\r\n                  formattedEndDate,\r\n                  endTime,\r\n                  userTz\r\n                );\r\n                \r\n                debugLog('MBA53212co2v3nvoub5 Converted UTC times:', { \r\n                  utcStartDate, \r\n                  utcStartTime, \r\n                  utcEndDate, \r\n                  utcEndTime,\r\n                  isDifferentDates: utcStartDate !== utcEndDate\r\n                });\r\n                \r\n                // Return structured data with separate start and end dates\r\n                return {\r\n                  date: utcStartDate,\r\n                  startTime: utcStartTime,\r\n                  endDate: utcEndDate,  // Always include endDate\r\n                  endTime: utcEndTime\r\n                };\r\n              });\r\n              \r\n              debugLog('MBA53212co2v3nvoub5 - Converted UTC dates:', formattedDates);\r\n              \r\n              // Call the API for multiple individual days (even though they're from a date range)\r\n              const response = await updateBookingDraftMultipleDays(\r\n                bookingId,\r\n                {\r\n                  dates: formattedDates,\r\n                  times: {} // Empty times object since times are already included in each date\r\n                },\r\n                timeSettings\r\n              );\r\n              \r\n              debugLog('MBA53212co2v3nvoub5 Received response from updateBookingDraftMultipleDays:', response);\r\n              \r\n              if (response?.draft_data) {\r\n                setBookingData(prev => ({\r\n                  ...prev,\r\n                  ...response.draft_data\r\n                }));\r\n              }\r\n            } else {\r\n              // Handle date range selection for overnight services (existing logic)\r\n              const startDate = formatDateForAPI(bookingData.dateRange.startDate);\r\n              const endDate = formatDateForAPI(bookingData.dateRange.endDate);\r\n              const startTime = formatTimeForAPI(bookingData.times.startTime);\r\n              const endTime = formatTimeForAPI(bookingData.times.endTime);\r\n\r\n              debugLog('MBA53212co2v3nvoub5 Using update-time-and-date endpoint for OVERNIGHT service with dates:', {\r\n                startDate,\r\n                endDate,\r\n                startTime,\r\n                endTime,\r\n                service: {\r\n                  id: bookingData.service?.service_id,\r\n                  name: bookingData.service?.service_name,\r\n                  is_overnight: bookingData.service?.is_overnight\r\n                },\r\n                times: {\r\n                  isOvernightForced: bookingData.times?.isOvernightForced\r\n                }\r\n              });\r\n\r\n              // Convert local times to UTC before sending to backend\r\n              const { date: utcStartDate, time: utcStartTime } = convertToUTC(\r\n                startDate,\r\n                startTime,\r\n                userTz\r\n              );\r\n\r\n              const { date: utcEndDate, time: utcEndTime } = convertToUTC(\r\n                endDate,\r\n                endTime,\r\n                userTz\r\n              );\r\n\r\n              debugLog('MBA53212co2v3nvoub5 UTC dates and times:', {\r\n                utcStartDate,\r\n                utcStartTime,\r\n                utcEndDate,\r\n                utcEndTime\r\n              });\r\n\r\n              // Call the API with UTC times and dates\r\n              const response = await updateBookingDraftTimeAndDate(\r\n                bookingId,\r\n                utcStartDate,\r\n                utcEndDate,\r\n                utcStartTime,\r\n                utcEndTime\r\n              );\r\n\r\n              debugLog('MBA53212co2v3nvoub5 Received response from updateBookingDraftTimeAndDate:', response);\r\n\r\n              // Update booking data with the response's draft_data\r\n              if (response?.draft_data) {\r\n                setBookingData(prev => ({\r\n                  ...prev,\r\n                  ...response.draft_data\r\n                }));\r\n              } else {\r\n                debugLog('MBA53212co2v3nvoub5 No draft_data in response:', response);\r\n              }\r\n            }\r\n          } else if (bookingData.dateRangeType === 'multiple-days') {\r\n            // Handle multiple individual days\r\n            debugLog('MBA53212co2v3nvoub5 Multiple days selection:', {\r\n              dates: bookingData.dates,\r\n              times: bookingData.times\r\n            });\r\n\r\n            // Call the API for multiple individual days\r\n            const response = await updateBookingDraftMultipleDays(\r\n              bookingId,\r\n              {\r\n                dates: bookingData.dates,\r\n                times: bookingData.times\r\n              },\r\n              timeSettings\r\n            );\r\n\r\n            debugLog('MBA53212co2v3nvoub5 Received response from updateBookingDraftMultipleDays:', response);\r\n\r\n            if (response?.draft_data) {\r\n              setBookingData(prev => ({\r\n                ...prev,\r\n                ...response.draft_data\r\n              }));\r\n            }\r\n          } else if (bookingData.bookingType === 'recurring') {\r\n            // Handle recurring dates\r\n            debugLog('MBA53212co2v3nvoub5 Recurring dates selection:', {\r\n              startDate: bookingData.recurringStartDate,\r\n              endDate: bookingData.recurringEndDate,\r\n              daysOfWeek: bookingData.selectedDaysOfWeek,\r\n              frequency: bookingData.selectedFrequency,\r\n              times: bookingData.times\r\n            });\r\n\r\n            // Call the API for recurring dates\r\n            const response = await updateBookingDraftRecurring(\r\n              bookingId,\r\n              {\r\n                startDate: bookingData.recurringStartDate,\r\n                endDate: bookingData.recurringEndDate,\r\n                daysOfWeek: bookingData.selectedDaysOfWeek,\r\n                frequency: bookingData.selectedFrequency,\r\n                startTime: bookingData.times.startTime,\r\n                endTime: bookingData.times.endTime\r\n              }\r\n            );\r\n\r\n            debugLog('MBA53212co2v3nvoub5 Received response from updateBookingDraftRecurring:', response);\r\n\r\n            if (response?.draft_data) {\r\n              setBookingData(prev => ({\r\n                ...prev,\r\n                ...response.draft_data\r\n              }));\r\n            }\r\n          }\r\n        } catch (error) {\r\n          debugLog('MBA53212co2v3nvoub5 Error calculating booking totals:', error);\r\n          debugLog('MBA53212co2v3nvoub5 Error stack:', error.stack);\r\n          debugLog('MBA53212co2v3nvoub5 Error details:', {\r\n            message: error.message,\r\n            name: error.name,\r\n            response: error.response?.data\r\n          });\r\n          setError('Failed to calculate booking totals');\r\n          return;\r\n        }\r\n      }\r\n\r\n      setCurrentStep(prev => prev + 1);\r\n    } else {\r\n      // We're on the final step (REVIEW_AND_RATES), so create the booking\r\n      try {\r\n        setError(null);\r\n        \r\n        // Check if we have a conversation ID from the booking data\r\n        if (!bookingData.conversation_id) {\r\n          setError('Missing conversation information');\r\n          return;\r\n        }\r\n        \r\n        debugLog('MBA66777 Creating booking from draft with conversation ID:', bookingData.conversation_id);\r\n        \r\n        // Call the API to create a booking from the draft\r\n        const response = await createBookingFromDraft(bookingData.conversation_id);\r\n        \r\n        debugLog('MBA66777 Booking created successfully:', response);\r\n        \r\n        // Create a booking message from the response data\r\n        // The booking data is in the message object of the response\r\n        const bookingMessageData = response.message || {};\r\n        const bookingId = response.booking_id;\r\n        \r\n        const bookingMessage = {\r\n          id: Date.now().toString(), // Temporary ID for UI purposes\r\n          type_of_message: 'send_approved_message',\r\n          metadata: {\r\n            booking_id: bookingId,\r\n            service_type: bookingMessageData.service_type || bookingData.service?.service_name,\r\n            occurrences: bookingMessageData.occurrences || [],\r\n            cost_summary: bookingMessageData.cost_summary || {\r\n              total_client_cost: bookingMessageData.occurrences?.[0]?.cost_summary?.total_client_cost,\r\n              total_sitter_payout: bookingMessageData.occurrences?.[0]?.cost_summary?.total_sitter_payout\r\n            }\r\n          },\r\n          content: 'Approval Request',\r\n          sent_by_other_user: false,\r\n          timestamp: new Date().toISOString()\r\n        };\r\n        \r\n        // Close the modal and pass the new booking data to the parent component\r\n        onComplete({\r\n          ...bookingData,\r\n          booking_id: bookingId,\r\n          status: 'Pending Client Approval',\r\n          message: bookingMessage // Include the new message to be added to the message list\r\n        });\r\n        \r\n        // Reset the modal to step 1 with initial state\r\n        // This ensures next time it's opened, it starts fresh\r\n        resetModal();\r\n        \r\n      } catch (error) {\r\n        debugLog('MBA66777 Error creating booking:', error);\r\n        setError('Failed to create booking. Please try again.');\r\n        \r\n        // Still try to close the modal in case the booking was actually created\r\n        // The backend handles duplicate bookings, so it's safe to let the user try again if needed\r\n        setTimeout(() => {\r\n          // Short timeout to let the user see the error\r\n          onComplete({\r\n            ...bookingData,\r\n            error: true,\r\n            errorMessage: error.message\r\n          });\r\n        }, 3000);\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleBack = () => {\r\n    if (currentStep > STEPS.SERVICES_AND_PETS.id) {\r\n      setCurrentStep(prev => prev - 1);\r\n    } else {\r\n      // We're on the first step, so close the modal\r\n      handleClose();\r\n    }\r\n  };\r\n\r\n  const renderCurrentStep = () => {\r\n    switch (currentStep) {\r\n      case STEPS.SERVICES_AND_PETS.id:\r\n        return (\r\n          <ServiceAndPetsCard\r\n            bookingId={bookingId}\r\n            onServiceSelect={handleServiceSelect}\r\n            onPetSelect={handlePetSelect}\r\n            selectedService={bookingData.service}\r\n            selectedPets={bookingData.pets}\r\n            navigation={navigation}\r\n            onClose={onClose}\r\n          />\r\n        );\r\n      case STEPS.DATE_SELECTION.id:\r\n        debugLog('MBA2j3kbr9hve4: Rendering date selection with:', { \r\n          dates: bookingData.dates, \r\n          dateRange: bookingData.dateRange,\r\n          bookingType: bookingData.bookingType,\r\n          dateRangeType: bookingData.dateRangeType,\r\n          hasFetchedDates: bookingData.hasFetchedDates\r\n        });\r\n        \r\n        const dateSelectionIsOvernightMode = bookingData.service?.is_overnight || bookingData.times?.isOvernightForced || false;\r\n        \r\n        debugLog('MBA2j3kbr9hve4: Date selection overnight status:', {\r\n          serviceIsOvernight: bookingData.service?.is_overnight,\r\n          timesIsOvernightForced: bookingData.times?.isOvernightForced,\r\n          combinedMode: dateSelectionIsOvernightMode\r\n        });\r\n        \r\n        return (\r\n          <DateSelectionCard\r\n            selectedDates={bookingData.dates || []}\r\n            onDateSelect={handleDateSelect}\r\n            bookingType={bookingData.bookingType || 'one-time'}\r\n            dateRangeType={bookingData.dateRangeType || 'date-range'}\r\n            initialDateRange={bookingData.dateRange || null}\r\n            isOvernightForced={dateSelectionIsOvernightMode}\r\n          />\r\n        );\r\n      case STEPS.TIME_SELECTION.id:\r\n        // Check if we have valid dates to display\r\n        if (!bookingData.dates || bookingData.dates.length === 0) {\r\n          return (\r\n            <View style={styles.errorContainer}>\r\n              <Text style={styles.errorText}>Please select dates first</Text>\r\n            </View>\r\n          );\r\n        }\r\n        \r\n        // Log current service and times state BEFORE preparing initialTimes \r\n        debugLog('MBA66777: CURRENT STATE Before rendering time selection:', { \r\n          service: {\r\n            id: bookingData.service?.service_id,\r\n            name: bookingData.service?.service_name,\r\n            is_overnight: bookingData.service?.is_overnight\r\n          },\r\n          times: {\r\n            isOvernightForced: bookingData.times?.isOvernightForced,\r\n            hasIndividualTimes: bookingData.times?.hasIndividualTimes\r\n          },\r\n          dateRange: bookingData.dateRange,\r\n          dateRangeType: bookingData.dateRangeType\r\n        });\r\n        \r\n        // Prepare initialTimes object with all necessary data\r\n        const initialTimes = {\r\n          ...bookingData.times,\r\n          // Always include dates for multiple-days selection\r\n          dates: bookingData.dates || [],\r\n          // Include occurrences if available\r\n          occurrences: bookingData.occurrences || [],\r\n          // Ensure hasIndividualTimes is preserved from bookingData.times\r\n          hasIndividualTimes: bookingData.times?.hasIndividualTimes || false,\r\n          // Make sure isOvernightForced is included in initialTimes\r\n          isOvernightForced: bookingData.service?.is_overnight || bookingData.times?.isOvernightForced || false\r\n        };\r\n        \r\n        // If it's an overnight service, make sure hasIndividualTimes is false\r\n        if (bookingData.service?.is_overnight || bookingData.times?.isOvernightForced) {\r\n          initialTimes.hasIndividualTimes = false;\r\n          initialTimes.isOvernightForced = true;\r\n        }\r\n        \r\n        const isOvernightMode = bookingData.service?.is_overnight || bookingData.times?.isOvernightForced || false;\r\n        \r\n        debugLog('MBA66777: Passing initialTimes to TimeSelectionCard:', {\r\n          hasIndividualTimes: initialTimes.hasIndividualTimes,\r\n          dateCount: initialTimes.dates?.length || 0,\r\n          isOvernightService: bookingData.service?.is_overnight,\r\n          isOvernightForced: bookingData.times?.isOvernightForced,\r\n          combinedOvernight: isOvernightMode\r\n        });\r\n        \r\n        return (\r\n          <TimeSelectionCard\r\n            onTimeSelect={handleTimeSelect}\r\n            initialTimes={initialTimes}\r\n            dateRange={bookingData.dateRange}\r\n            selectedService={{\r\n              ...bookingData.service,\r\n              is_overnight: isOvernightMode\r\n            }}\r\n            isOvernightForced={isOvernightMode}\r\n          />\r\n        );\r\n      case STEPS.REVIEW_AND_RATES.id:\r\n        return (\r\n          <ReviewAndRatesCard\r\n            bookingData={bookingData}\r\n            bookingId={bookingId}\r\n            onRatesUpdate={(updatedData) => {\r\n              debugLog('MBA2j3kbr9hve4: Rates updated:', updatedData);\r\n              setBookingData(prev => ({\r\n                ...prev,\r\n                occurrences: updatedData.occurrences,\r\n                cost_summary: updatedData.cost_summary\r\n              }));\r\n            }}\r\n          />\r\n        );\r\n      default:\r\n        return null;\r\n    }\r\n  };\r\n\r\n  // Function to reset the modal state\r\n  const resetModal = () => {\r\n    debugLog('MBA2j3kbr9hve4: Resetting booking step modal state');\r\n    setCurrentStep(STEPS.SERVICES_AND_PETS.id);\r\n    setBookingData({\r\n      service: initialData.service || null,\r\n      pets: initialData.pets || [],\r\n      dates: initialData.dates || [],\r\n      bookingType: initialData.bookingType || 'one-time',\r\n      dateRangeType: initialData.dateRangeType || 'date-range',\r\n      times: initialData.times || {\r\n        startTime: '09:00',\r\n        endTime: '17:00',\r\n        isOvernightForced: false,\r\n        hasIndividualTimes: false\r\n      },\r\n      rates: initialData.rates || {},\r\n      dateSelectionData: null,\r\n      dateRange: null,\r\n      hasFetchedDates: false, // Reset the fetch flag to ensure dates are refetched\r\n    });\r\n    setError(null);\r\n    setIsLoading(false);\r\n  };\r\n\r\n  // Function to handle cancellation of the modal\r\n  const handleClose = () => {\r\n    debugLog('MBA66777: Closing booking step modal and resetting state');\r\n    // Reset the modal state\r\n    resetModal();\r\n    // Call the onClose function passed as a prop\r\n    onClose();\r\n  };\r\n\r\n  // Add cleanup effect to ensure clean state when unmounting\r\n  useEffect(() => {\r\n    return () => {\r\n      debugLog('MBA2j3kbr9hve4: BookingStepModal unmounting, cleaning up state');\r\n      // This is a cleanup function that will run when the component unmounts\r\n      // We don't need to do anything here, just logging for debugging\r\n    };\r\n  }, []);\r\n\r\n  const formatDatesForAPI = (dateState) => {\r\n    if (!dateState || !dateState.dates || dateState.dates.length === 0) {\r\n      return { dates: [] };\r\n    }\r\n\r\n    // Format the dates for the API using the proper UTC conversion\r\n    const formattedDates = dateState.dates.map(date => {\r\n      const dateString = date.toISOString().split('T')[0];\r\n      \r\n      // Get time data for this specific date or fall back to default\r\n      let timeData = dateState.times;\r\n      \r\n      // Check if we have individual day schedules\r\n      if (dateState.times.hasIndividualTimes && dateState.times[dateString]) {\r\n        timeData = dateState.times[dateString];\r\n      }\r\n      \r\n      // Format start and end times\r\n      const formattedStartTime = formatTimeObj(timeData.startTime);\r\n      const formattedEndTime = formatTimeObj(timeData.endTime);\r\n      \r\n      // Handle midnight (00:00) as end of current day, not start of next day\r\n      // This ensures proper duration calculation and prevents negative durations\r\n      let endDate = dateString;\r\n      const isMidnightEnd = formattedEndTime === \"00:00\";\r\n      const isTimeBeforeStart = compareTimesAsMinutes(timeData.endTime, timeData.startTime) < 0;\r\n      \r\n      // If end time is midnight (00:00) or earlier than start time, use the next day as the end date\r\n      if (isMidnightEnd || isTimeBeforeStart) {\r\n        // Calculate the next day\r\n        const nextDay = new Date(date);\r\n        nextDay.setDate(nextDay.getDate() + 1);\r\n        endDate = nextDay.toISOString().split('T')[0];\r\n        \r\n        debugLog(\"MBA8810: Using next day for end date due to midnight/early morning end time:\", {\r\n          date: dateString,\r\n          startTime: formattedStartTime,\r\n          endTime: formattedEndTime,\r\n          endDate: endDate,\r\n          isMidnightEnd,\r\n          isTimeBeforeStart\r\n        });\r\n      }\r\n      \r\n      return {\r\n        date: dateString,\r\n        start_time: formattedStartTime,\r\n        end_time: formattedEndTime,\r\n        end_date: endDate, // Always include end_date for proper backend processing\r\n        is_overnight: timeData.isOvernightForced || dateState.service?.is_overnight || false\r\n      };\r\n    });\r\n\r\n    return { dates: formattedDates };\r\n  };\r\n\r\n  const formatTimeObj = (timeObj) => {\r\n    const hours = timeObj.hours.toString().padStart(2, '0');\r\n    const minutes = timeObj.minutes.toString().padStart(2, '0');\r\n    return `${hours}:${minutes}`;\r\n  };\r\n  \r\n  // Helper to compare two time objects by converting to minutes\r\n  const compareTimesAsMinutes = (time1, time2) => {\r\n    const time1Minutes = (time1.hours * 60) + time1.minutes;\r\n    const time2Minutes = (time2.hours * 60) + time2.minutes;\r\n    return time1Minutes - time2Minutes;\r\n  };\r\n\r\n  return (\r\n    <Modal\r\n      visible={visible}\r\n      animationType=\"fade\"\r\n      onRequestClose={handleClose}\r\n      transparent={true}\r\n    >\r\n      <View style={styles.modalOverlay}>\r\n        <SafeAreaView style={styles.modalContent}>\r\n          <View style={styles.stepIndicatorContainer}>\r\n            <StepProgressIndicator\r\n              steps={Object.values(STEPS).map(step => step.name)}\r\n              currentStep={currentStep}\r\n            />\r\n          </View>\r\n          <ScrollView style={styles.scrollContent} contentContainerStyle={styles.scrollContentContainer}>\r\n            <View style={styles.content}>\r\n              {isLoading ? (\r\n                <View style={styles.loadingContainer}>\r\n                  <Text style={styles.loadingText}>Loading booking information...</Text>\r\n                </View>\r\n              ) : (\r\n                renderCurrentStep()\r\n              )}\r\n            </View>\r\n            {error && (\r\n              <Text style={styles.errorText}>{error}</Text>\r\n            )}\r\n          </ScrollView>\r\n          <View style={styles.footer}>\r\n            {currentStep === STEPS.SERVICES_AND_PETS.id ? (\r\n              // Step 1: [Cancel] [Next]\r\n              <>\r\n                <TouchableOpacity\r\n                  style={styles.cancelButton}\r\n                  onPress={handleClose}\r\n                >\r\n                  <Text style={styles.cancelButtonText}>Cancel</Text>\r\n                </TouchableOpacity>\r\n                <TouchableOpacity\r\n                  style={[\r\n                    styles.nextButton,\r\n                    (!canProceedToNextStep() || isLoading) && styles.disabledButton\r\n                  ]}\r\n                  onPress={handleNext}\r\n                  disabled={!canProceedToNextStep() || isLoading}\r\n                >\r\n                  <Text style={[\r\n                    styles.nextButtonText,\r\n                    (!canProceedToNextStep() || isLoading) && styles.disabledButtonText\r\n                  ]}>\r\n                    Next\r\n                  </Text>\r\n                </TouchableOpacity>\r\n              </>\r\n            ) : (\r\n              // Steps 2-4: [Back] [Cancel][Next/Confirm]\r\n              <>\r\n                <TouchableOpacity\r\n                  style={[styles.backButton, isSmallScreen && styles.smallScreenButton]}\r\n                  onPress={handleBack}\r\n                >\r\n                  <Text style={styles.backButtonText}>Back</Text>\r\n                </TouchableOpacity>\r\n                <View style={styles.spacer} />\r\n                <TouchableOpacity\r\n                  style={[styles.cancelButtonSmall, isSmallScreen && styles.smallScreenButton]}\r\n                  onPress={handleClose}\r\n                >\r\n                  <Text style={styles.cancelButtonText}>Cancel</Text>\r\n                </TouchableOpacity>\r\n                <View style={isSmallScreen ? styles.smallMargin : null} />\r\n                <TouchableOpacity\r\n                  style={[\r\n                    styles.nextButtonSmall, \r\n                    isSmallScreen && styles.smallScreenButton,\r\n                    (!canProceedToNextStep() || isLoading) && styles.disabledButton\r\n                  ]}\r\n                  onPress={handleNext}\r\n                  disabled={!canProceedToNextStep() || isLoading}\r\n                >\r\n                  {currentStep === STEPS.REVIEW_AND_RATES.id && isSmallScreen ? (\r\n                    <View style={styles.confirmButtonColumn}>\r\n                      <Text style={[styles.nextButtonText, (!canProceedToNextStep() || isLoading) && styles.disabledButtonText]}>\r\n                        Request\r\n                      </Text>\r\n                      <Text style={[styles.nextButtonText, (!canProceedToNextStep() || isLoading) && styles.disabledButtonText]}>\r\n                        Booking\r\n                      </Text>\r\n                    </View>\r\n                  ) : (\r\n                    <Text style={[styles.nextButtonText, (!canProceedToNextStep() || isLoading) && styles.disabledButtonText]}>\r\n                      {currentStep === STEPS.REVIEW_AND_RATES.id ? 'Request Booking' : 'Next'}\r\n                    </Text>\r\n                  )}\r\n                </TouchableOpacity>\r\n              </>\r\n            )}\r\n          </View>\r\n        </SafeAreaView>\r\n      </View>\r\n    </Modal>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  modalOverlay: {\r\n    flex: 1,\r\n    backgroundColor: 'rgba(0, 0, 0, 0.5)',\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    width: '100%',\r\n  },\r\n  modalContent: {\r\n    width: '95%',\r\n    maxWidth: Platform.OS === 'web' ? 600 : '100%',\r\n    maxHeight: '90%',\r\n    backgroundColor: theme.colors.background,\r\n    borderRadius: 12,\r\n    overflow: 'hidden',\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n  },\r\n  stepIndicatorContainer: {\r\n    width: '100%',\r\n    paddingVertical: 12,\r\n    backgroundColor: theme.colors.background,\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: theme.colors.modernBorder,\r\n  },\r\n  scrollContent: {\r\n    flex: 1,\r\n  },\r\n  scrollContentContainer: {\r\n    flexGrow: 1,\r\n  },\r\n  content: {\r\n    flex: 1,\r\n    backgroundColor: theme.colors.background,\r\n  },\r\n  footer: {\r\n    flexDirection: 'row',\r\n    padding: 16,\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    backgroundColor: theme.colors.background,\r\n    borderTopWidth: 1,\r\n    borderTopColor: theme.colors.modernBorder,\r\n  },\r\n  spacer: {\r\n    width: 16,\r\n    flexGrow: 1,\r\n  },\r\n  smallMargin: {\r\n    width: 8,\r\n  },\r\n  backButton: {\r\n    minWidth: 100,\r\n    backgroundColor: theme.colors.surface,\r\n    paddingVertical: 12,\r\n    paddingHorizontal: 16,\r\n    borderRadius: 8,\r\n    alignItems: 'center',\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n  },\r\n  smallScreenButton: {\r\n    minWidth: 80,\r\n    paddingVertical: 8,\r\n    paddingHorizontal: 10,\r\n  },\r\n  backButtonText: {\r\n    color: theme.colors.text,\r\n    fontSize: 16,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  cancelButton: {\r\n    flex: 1,\r\n    backgroundColor: theme.colors.surface,\r\n    paddingVertical: 12,\r\n    borderRadius: 8,\r\n    alignItems: 'center',\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n  },\r\n  cancelButtonSmall: {\r\n    minWidth: 100,\r\n    backgroundColor: theme.colors.surface,\r\n    paddingVertical: 12,\r\n    paddingHorizontal: 16,\r\n    borderRadius: 8,\r\n    alignItems: 'center',\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n  },\r\n  cancelButtonText: {\r\n    color: theme.colors.text,\r\n    fontSize: 16,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  nextButton: {\r\n    flex: 1,\r\n    backgroundColor: theme.colors.mainColors.main,\r\n    paddingVertical: 12,\r\n    borderRadius: 8,\r\n    alignItems: 'center',\r\n  },\r\n  nextButtonSmall: {\r\n    minWidth: 100,\r\n    backgroundColor: theme.colors.mainColors.main,\r\n    paddingVertical: 12,\r\n    paddingHorizontal: 16,\r\n    borderRadius: 8,\r\n    alignItems: 'center',\r\n  },\r\n  disabledButton: {\r\n    backgroundColor: theme.colors.placeHolderText,\r\n  },\r\n  nextButtonText: {\r\n    color: theme.colors.surface,\r\n    fontSize: 16,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    fontWeight: '600',\r\n  },\r\n  disabledButtonText: {\r\n    color: theme.colors.surface,\r\n  },\r\n  errorText: {\r\n    color: theme.colors.error,\r\n    textAlign: 'center',\r\n    marginBottom: 16,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  loadingContainer: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    padding: 16,\r\n  },\r\n  loadingText: {\r\n    color: theme.colors.text,\r\n    fontSize: 16,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  stepContent: {\r\n    flex: 1,\r\n    backgroundColor: theme.colors.background,\r\n  },\r\n  divider: {\r\n    height: 1,\r\n    backgroundColor: theme.colors.modernBorder,\r\n    marginVertical: 16,\r\n  },\r\n  errorContainer: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    padding: 16,\r\n  },\r\n  confirmButtonColumn: {\r\n    flexDirection: 'column',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n  },\r\n});\r\n\r\nexport default BookingStepModal; ","import React, { useContext, useState, useEffect } from 'react';\r\nimport { View, Text, StyleSheet, TouchableOpacity } from 'react-native';\r\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\r\nimport { theme } from '../styles/theme';\r\nimport { approveBooking } from '../api/API';\r\nimport { formatDateTimeRangeFromUTC, convertTo24Hour } from '../utils/time_utils';\r\nimport { AuthContext, debugLog } from '../context/AuthContext';\r\nimport moment from 'moment-timezone';\r\nimport BookingApprovalModal from './BookingApprovalModal';\r\n\r\n// A simplified version of checkDSTChange that only relies on moment-timezone\r\nconst checkDSTChange = (startDate, startTime, endDate, endTime, timezone) => {\r\n  try {\r\n    // Create UTC moments for start and end time\r\n    const startMoment = moment.utc(`${startDate}T${startTime}:00Z`).tz(timezone);\r\n    const endMoment = moment.utc(`${endDate}T${endTime}:00Z`).tz(timezone);\r\n    \r\n    // Check if the offset from UTC (in minutes) is different\r\n    return startMoment.utcOffset() !== endMoment.utcOffset();\r\n  } catch (error) {\r\n    debugLog('MBA9876DST Error checking DST change:', error);\r\n    return false;\r\n  }\r\n};\r\n\r\nconst BookingMessageCard = ({ \r\n  type,  // 'request', 'approval', 'request_changes', or 'booking_confirmed'\r\n  displayType, // Optional override for the display title (e.g., 'booking_update')\r\n  data,\r\n  isFromMe,\r\n  onPress,\r\n  isProfessional,\r\n  onApproveSuccess,\r\n  onApproveError,\r\n  onEditDraft,\r\n  bookingStatus, // Added to know if booking is confirmed\r\n  hasChangeRequest, // Boolean to indicate if this approval has a pending change request\r\n  isNewestMessage = false, // Flag to indicate if this is the newest message for this booking\r\n  messageCreatedAt, // Timestamp of when the message was created\r\n  hasNewerApprovalRequests = false, // Flag to indicate if this booking_confirmed message has newer approval requests\r\n  isAfterConfirmation = false // Flag to indicate if this approval message comes after a booking confirmation\r\n}) => {\r\n  const { timeSettings } = useContext(AuthContext);\r\n  const userTimezone = timeSettings?.timezone || 'US/Mountain';\r\n  const [approvalModalVisible, setApprovalModalVisible] = useState(false);\r\n  const [safeInitialData, setSafeInitialData] = useState(null);\r\n  const [showAllDates, setShowAllDates] = useState(false); // New state for expanded/collapsed dates\r\n  \r\n  // Create safe data on component load\r\n  useEffect(() => {\r\n    // Ensure we have basic rate data for the initial load\r\n    const preparedData = {\r\n      ...data,\r\n      occurrences: data.occurrences?.map(occ => ({\r\n        ...occ,\r\n        rates: occ.rates || {\r\n          base_rate: 0,\r\n          additional_animal_rate: 0,\r\n          applies_after: 1,\r\n          holiday_rate: 0,\r\n          holiday_days: 0,\r\n          additional_rates: []\r\n        }\r\n      }))\r\n    };\r\n    setSafeInitialData(preparedData);\r\n  }, [data]);\r\n\r\n  const isConfirmed = bookingStatus === 'Confirmed';\r\n  const isChangeRequest = type === 'request_changes';\r\n  const isBookingConfirmed = type === 'booking_confirmed';\r\n  const shouldShowAsApproval = type === 'approval' || isChangeRequest;\r\n  \r\n  // Special flag for change requests that are for a confirmed booking\r\n  const isChangeRequestForConfirmedBooking = isChangeRequest && isConfirmed;\r\n  \r\n  // Determine if we should show the overlay based on message type and recency\r\n  // - Show \"Booking Confirmed\" on all earlier messages for confirmed bookings EXCEPT\r\n  //   for approval messages that come after a booking confirmation\r\n  // - Show \"Changes Requested\" on approval messages if there's a change request AND this isn't the newest message\r\n  // - Show \"Booking Updated\" on change request messages if they're not the newest message and there's a newer approval\r\n  // - Show \"Booking Updated\" on the booking_confirmed message if there's a newer approval request \r\n  //   for the same booking ID (NOT on the approval request itself)\r\n  // - Show \"Booking Updated\" on booking update messages if they have newer request changes\r\n  const shouldShowOverlay = \r\n    // Show \"Booking Confirmed\" on earlier messages, but NOT on approval messages that come after a confirmation\r\n    // AND not on request_changes messages that are the newest message\r\n    (isConfirmed && !isBookingConfirmed && type !== 'approval' && !isAfterConfirmation && !(isChangeRequest && isNewestMessage)) || \r\n    // Show \"Changes Requested\" on approval messages with pending changes that aren't newest\r\n    (type === 'approval' && hasChangeRequest && !isNewestMessage) ||\r\n    // Show \"Booking Updated\" on change request messages that aren't newest\r\n    (isChangeRequest && !isNewestMessage) ||\r\n    // Show \"Booking Updated\" on booking_confirmed messages with newer approval requests\r\n    (isBookingConfirmed && hasNewerApprovalRequests) ||\r\n    // Show \"Booking Updated\" on booking update messages (displayType === 'booking_update') with newer request changes\r\n    (displayType === 'booking_update' && hasChangeRequest && !isNewestMessage) ||\r\n    // Show \"Booking Updated\" on approval messages that come after confirmation but aren't the newest message\r\n    (type === 'approval' && isAfterConfirmation && !isNewestMessage);\r\n  \r\n  // What overlay text to show\r\n  const getOverlayText = () => {\r\n    // For booking_confirmed messages with newer approval requests, show \"Booking Updated\"\r\n    if (isBookingConfirmed && hasNewerApprovalRequests) return 'Booking Updated';\r\n    \r\n    // For booking update messages with newer request changes, show \"Booking Updated\"\r\n    if (displayType === 'booking_update' && hasChangeRequest && !isNewestMessage) return 'Booking Updated';\r\n    \r\n    // For approval messages that come after a confirmation but aren't newest, show \"Booking Updated\"\r\n    if (type === 'approval' && isAfterConfirmation && !isNewestMessage) return 'Booking Updated';\r\n    \r\n    // For approval messages that come after a confirmation and are newest, don't show an overlay\r\n    if (type === 'approval' && isAfterConfirmation && isNewestMessage) return '';\r\n    \r\n    // For request changes messages that are the newest, don't show an overlay\r\n    if (isChangeRequest && isNewestMessage) return '';\r\n    \r\n    // For other messages when booking is confirmed, show \"Booking Confirmed\"\r\n    if (isConfirmed && !isBookingConfirmed && !isAfterConfirmation && !(isChangeRequest && isNewestMessage)) return 'Booking Confirmed';\r\n    \r\n    // For approval messages with change requests that aren't newest\r\n    if (type === 'approval' && hasChangeRequest && !isNewestMessage) {\r\n      return 'Changes Requested';\r\n    }\r\n    \r\n    // For change request messages that aren't newest\r\n    if (isChangeRequest && !isNewestMessage) {\r\n      return 'Booking Updated';\r\n    }\r\n    \r\n    return '';\r\n  };\r\n  \r\n  const overlayText = getOverlayText();\r\n  \r\n  // Log message state for debugging\r\n  debugLog('MBA4321: Message state for booking', data.booking_id, {\r\n    type,\r\n    displayType,\r\n    isFromMe,\r\n    isProfessional,\r\n    bookingStatus,\r\n    hasChangeRequest,\r\n    isNewestMessage,\r\n    isAfterConfirmation,\r\n    hasNewerApprovalRequests,\r\n    shouldShowOverlay,\r\n    overlayText,\r\n    messageCreatedAt: messageCreatedAt || 'N/A',\r\n    // Add detailed logic checks to help debug overlay decisions\r\n    overlayLogicChecks: {\r\n      isConfirmedButNotConfirmationMessage: isConfirmed && !isBookingConfirmed,\r\n      isChangeRequestAndNewestMessage: isChangeRequest && isNewestMessage,\r\n      isApprovalWithChangeRequest: type === 'approval' && hasChangeRequest && !isNewestMessage,\r\n      isBookingConfirmedWithNewerApprovals: isBookingConfirmed && hasNewerApprovalRequests\r\n    }\r\n  });\r\n\r\n  const getIcon = () => {\r\n    switch (type) {\r\n      case 'request':\r\n        return 'calendar-plus';\r\n      case 'approval':\r\n        return 'calendar-check';\r\n      case 'request_changes':\r\n        return 'calendar-edit';\r\n      case 'booking_confirmed':\r\n        return 'check-circle-outline';\r\n      default:\r\n        return 'calendar';\r\n    }\r\n  };\r\n\r\n  const getTitle = () => {\r\n    // If a display type is provided, use it to override the title\r\n    if (displayType === 'booking_update') {\r\n      return 'Booking Update';\r\n    }\r\n    \r\n    // For change requests that come after a booking update, adjust the display\r\n    if (type === 'request_changes' && isAfterConfirmation) {\r\n      return 'Update Change Request';\r\n    }\r\n    \r\n    switch (type) {\r\n      case 'request':\r\n        return 'Booking Request';\r\n      case 'approval':\r\n        return 'Approval Request';\r\n      case 'request_changes':\r\n        return 'Request Changes';\r\n      case 'booking_confirmed':\r\n        return 'Booking Confirmed';\r\n      default:\r\n        return 'Booking';\r\n    }\r\n  };\r\n\r\n  const getCardStyle = () => {\r\n    const baseStyle = [\r\n      styles.card,\r\n      isFromMe ? styles.sentCard : styles.receivedCard\r\n    ];\r\n\r\n    if (shouldShowAsApproval) {\r\n      baseStyle.push(styles.approvalCard);\r\n    }\r\n    \r\n    if (isBookingConfirmed) {\r\n      baseStyle.push(styles.confirmedCard);\r\n    }\r\n\r\n    return baseStyle;\r\n  };\r\n\r\n  const getHeaderStyle = () => {\r\n    if (isBookingConfirmed) {\r\n      return [styles.header, styles.confirmedHeader];\r\n    }\r\n    \r\n    return [\r\n      styles.header,\r\n      shouldShowAsApproval ? styles.approvalHeader : styles.requestHeader\r\n    ];\r\n  };\r\n\r\n  const handleApprove = async () => {\r\n    try {\r\n      const response = await approveBooking(data.booking_id);\r\n      \r\n      // Call the success callback if provided\r\n      if (onApproveSuccess) {\r\n        onApproveSuccess(response);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error approving booking from message card:', error);\r\n      // Call the error callback if provided\r\n      if (onApproveError) {\r\n        onApproveError(error.response?.data?.error || 'Failed to approve booking');\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleOpenApprovalModal = () => {\r\n    // Process initial data for any message type\r\n    if (!safeInitialData) {\r\n      // If safeInitialData isn't ready yet, create it now\r\n      const tempData = {\r\n        ...data,\r\n        occurrences: data.occurrences?.map(occ => ({\r\n          ...occ,\r\n          rates: occ.rates || {\r\n            base_rate: 0,\r\n            additional_animal_rate: 0,\r\n            applies_after: 1,\r\n            holiday_rate: 0,\r\n            holiday_days: 0,\r\n            additional_rates: []\r\n          }\r\n        })) || []\r\n      };\r\n      setSafeInitialData(tempData);\r\n    }\r\n    \r\n    debugLog('MBA9876 Opening approval modal with booking ID:', data.booking_id);\r\n    setApprovalModalVisible(true);\r\n  };\r\n\r\n  const handleApprovalSuccess = (response) => {\r\n    if (onApproveSuccess) {\r\n      onApproveSuccess(response);\r\n    }\r\n  };\r\n\r\n  const handleApprovalError = (error) => {\r\n    if (onApproveError) {\r\n      onApproveError(error);\r\n    }\r\n  };\r\n\r\n  const handleRequestChangesSuccess = (response) => {\r\n    debugLog('MBA9999 Change request submitted successfully:', response);\r\n    // Pass along the response to the parent component\r\n    if (onApproveSuccess) {\r\n      onApproveSuccess(response);\r\n    }\r\n  };\r\n\r\n  const handleRequestChangesError = (error) => {\r\n    debugLog('MBA9999 Error submitting change request:', error);\r\n    // Pass along the error to the parent component\r\n    if (onApproveError) {\r\n      onApproveError(error);\r\n    }\r\n  };\r\n\r\n  // Format a date/time range for an occurrence using the time_utils function\r\n  const formatOccurrenceDateRange = (occ) => {\r\n    // Check if we have direct UTC dates and times\r\n    if (occ.start_date && occ.end_date && occ.start_time && occ.end_time) {\r\n      // Format the date range\r\n      const formattedRange = formatDateTimeRangeFromUTC({\r\n        startDate: occ.start_date,\r\n        startTime: occ.start_time,\r\n        endDate: occ.end_date,\r\n        endTime: occ.end_time,\r\n        userTimezone: userTimezone,\r\n        includeTimes: true,\r\n        includeTimezone: true\r\n      });\r\n      \r\n      // Check for DST change between start and end times\r\n      const hasDSTChange = checkDSTChange(\r\n        occ.start_date,\r\n        occ.start_time,\r\n        occ.end_date,\r\n        occ.end_time,\r\n        userTimezone\r\n      );\r\n      \r\n      // Add DST change message if needed\r\n      if (hasDSTChange && !occ.dst_message) {\r\n        debugLog('MBA9876DST Detected DST change for occurrence:', {\r\n          start: `${occ.start_date} ${occ.start_time}`,\r\n          end: `${occ.end_date} ${occ.end_time}`,\r\n          timezone: userTimezone\r\n        });\r\n        \r\n        // Add DST message to the occurrence\r\n        occ.dst_message = \"Elapsed time may be different than expected due to Daylight Savings Time.\";\r\n      }\r\n      \r\n      return formattedRange;\r\n    }\r\n    \r\n    // Fallback to pre-formatted dates if available\r\n    if (occ.formatted_start && occ.formatted_end) {\r\n      return `${occ.formatted_start} to ${occ.formatted_end}`;\r\n    }\r\n    \r\n    // Last resort fallback\r\n    return 'Date information unavailable';\r\n  };\r\n\r\n  // Calculate duration for the occurrence if not provided\r\n  const getOccurrenceDuration = (occ) => {\r\n    if (occ.duration) {\r\n      return occ.duration;\r\n    }\r\n    \r\n    // Try to calculate the duration if we have the necessary data\r\n    if (occ.start_date && occ.end_date && occ.start_time && occ.end_time) {\r\n      try {\r\n        // Create moment objects for start and end times\r\n        const startMoment = moment.utc(`${occ.start_date}T${occ.start_time}:00Z`);\r\n        const endMoment = moment.utc(`${occ.end_date}T${occ.end_time}:00Z`);\r\n        \r\n        // Calculate the difference in hours and days\r\n        const hoursDiff = endMoment.diff(startMoment, 'hours');\r\n        const daysDiff = endMoment.diff(startMoment, 'days');\r\n        \r\n        // Format the duration nicely\r\n        if (daysDiff > 0) {\r\n          return `${daysDiff} ${daysDiff === 1 ? 'day' : 'days'}, ${hoursDiff % 24} ${hoursDiff % 24 === 1 ? 'hour' : 'hours'}`;\r\n        } else {\r\n          return `${hoursDiff} ${hoursDiff === 1 ? 'hour' : 'hours'}`;\r\n        }\r\n      } catch (error) {\r\n        debugLog('MBA9876DST Error calculating duration:', error);\r\n      }\r\n    }\r\n    \r\n    return 'N/A';\r\n  };\r\n\r\n  // Get the cost value based on user type (professional vs client)\r\n  const getCostValue = () => {\r\n    // First check if the cost_summary object exists\r\n    if (data.cost_summary) {\r\n      if (isProfessional) {\r\n        // Display pro payout for professionals\r\n        const amount = data.cost_summary.total_sitter_payout || '0.00';\r\n        return typeof amount === 'number' ? amount.toFixed(2) : parseFloat(amount).toFixed(2);\r\n      } else {\r\n        // Display client cost for clients\r\n        const amount = data.cost_summary.total_client_cost || '0.00';\r\n        return typeof amount === 'number' ? amount.toFixed(2) : parseFloat(amount).toFixed(2);\r\n      }\r\n    }\r\n    \r\n    // Fallback to direct properties (for backward compatibility)\r\n    if (isProfessional) {\r\n      const amount = data.total_sitter_payout || '0.00';\r\n      return typeof amount === 'number' ? amount.toFixed(2) : parseFloat(amount).toFixed(2);\r\n    } else {\r\n      const amount = data.total_owner_cost || '0.00';\r\n      return typeof amount === 'number' ? amount.toFixed(2) : parseFloat(amount).toFixed(2);\r\n    }\r\n  };\r\n\r\n  // Function to toggle dates expansion\r\n  const toggleDatesExpansion = () => {\r\n    setShowAllDates(!showAllDates);\r\n  };\r\n\r\n  // Determine if we need to show the \"Show More\" button\r\n  const occurrences = data.occurrences || [];\r\n  const hasMoreDates = occurrences.length > 3;\r\n  \r\n  // Get visible occurrences based on expanded state\r\n  const visibleOccurrences = showAllDates ? occurrences : occurrences.slice(0, 3);\r\n  \r\n  // Count how many more dates are hidden\r\n  const hiddenDatesCount = Math.max(0, occurrences.length - 3);\r\n\r\n  return (\r\n    <View style={getCardStyle()}>\r\n      {/* Green bar on left or right side based on sender */}\r\n      {shouldShowAsApproval && (\r\n        <View style={[\r\n          styles.colorBar, \r\n          isFromMe ? styles.colorBarLeft : styles.colorBarRight\r\n        ]} />\r\n      )}\r\n      \r\n      {/* Green border for confirmation message */}\r\n      {isBookingConfirmed && (\r\n        <View style={styles.confirmationBorder} />\r\n      )}\r\n      \r\n      <View style={styles.cardContent}>\r\n        <View style={getHeaderStyle()}>\r\n          <MaterialCommunityIcons \r\n            name={getIcon()} \r\n            size={24} \r\n            color={isChangeRequest ? theme.colors.warning : \r\n                   isBookingConfirmed ? theme.colors.success : theme.colors.primary}\r\n          />\r\n          <Text style={[\r\n            styles.title,\r\n            isChangeRequest ? styles.changeRequestTitle : \r\n            isBookingConfirmed ? styles.confirmedTitle :\r\n            shouldShowAsApproval ? styles.approvalTitle : styles.requestTitle\r\n          ]}>\r\n            {getTitle()}\r\n          </Text>\r\n        </View>\r\n\r\n        <View style={styles.content}>\r\n          {/* Booking confirmation message specific content */}\r\n          {isBookingConfirmed ? (\r\n            <>\r\n              {/* Card content is clickable to view details */}\r\n              <TouchableOpacity \r\n                style={styles.confirmationContainerClickable}\r\n                onPress={handleOpenApprovalModal}\r\n                activeOpacity={0.7}\r\n              >\r\n                <View style={styles.confirmationContainer}>\r\n                  <Text style={styles.confirmationText}>\r\n                    This booking has been confirmed and is ready to go!\r\n                  </Text>\r\n                </View>\r\n                \r\n                <View style={styles.infoSection}>\r\n                  <View style={styles.row}>\r\n                    <Text style={styles.label}>Booking ID:</Text>\r\n                    <Text style={styles.value}>{data.booking_id || 'N/A'}</Text>\r\n                  </View>\r\n                  \r\n                  <View style={styles.row}>\r\n                    <Text style={styles.label}>Service:</Text>\r\n                    <Text style={styles.value}>{data.service_type || 'N/A'}</Text>\r\n                  </View>\r\n\r\n                  <View style={styles.row}>\r\n                    <Text style={styles.label}>{isProfessional ? 'Your Payout:' : 'Total Cost:'}</Text>\r\n                    <Text style={styles.value}>\r\n                      ${isProfessional ? \r\n                        (data.cost_summary?.total_sitter_payout || '0.00') : \r\n                        (data.cost_summary?.total_client_cost || '0.00')}\r\n                    </Text>\r\n                  </View>\r\n                </View>\r\n              </TouchableOpacity>\r\n              \r\n              {/* Buttons are separate from the clickable card content */}\r\n              <View style={styles.buttonContainer}>\r\n                {/* View Details button */}\r\n                <TouchableOpacity\r\n                  style={[styles.detailsButton, { flex: 1 }]}\r\n                  onPress={handleOpenApprovalModal}\r\n                >\r\n                  <Text style={styles.detailsButtonText}>View Details</Text>\r\n                </TouchableOpacity>\r\n                \r\n                {/* Edit Details button for professionals */}\r\n                {isProfessional && onEditDraft && (\r\n                  <TouchableOpacity \r\n                    style={[styles.editButton, { flex: 1 }]}\r\n                    onPress={onEditDraft}\r\n                  >\r\n                    <Text style={styles.editButtonText}>Edit Details</Text>\r\n                  </TouchableOpacity>\r\n                )}\r\n              </View>\r\n            </>\r\n          ) : (\r\n            /* Original content for other message types */\r\n            <>\r\n              <View style={styles.infoSection}>\r\n                <View style={styles.row}>\r\n                  <Text style={styles.label}>Booking ID:</Text>\r\n                  <Text style={styles.value}>{data.booking_id || 'N/A'}</Text>\r\n                </View>\r\n                <View style={styles.row}>\r\n                  <Text style={styles.label}>Service:</Text>\r\n                  <Text style={styles.value}>{data.service_type || 'N/A'}</Text>\r\n                </View>\r\n\r\n                <View style={styles.row}>\r\n                  <Text style={styles.label}>{isProfessional ? 'Your Payout:' : 'Total Cost:'}</Text>\r\n                  <Text style={styles.value}>\r\n                    ${getCostValue()}\r\n                  </Text>\r\n                </View>\r\n              </View>\r\n\r\n              <View style={styles.datesSection}>\r\n                {type !== 'request_changes' ? (\r\n                  <View style={styles.datesSectionHeader}>\r\n                    <Text style={styles.label}>Dates:</Text>\r\n                    {hasMoreDates && (\r\n                      <Text style={styles.datesCount}>({occurrences.length} total)</Text>\r\n                    )}\r\n                  </View>\r\n                ) : (\r\n                  null\r\n                )}\r\n                {visibleOccurrences.map((occ, index) => {\r\n                  const isLastVisibleItem = index === visibleOccurrences.length - 1;\r\n                  const showBottomBorder = !(!showAllDates && isLastVisibleItem && hasMoreDates);\r\n                  \r\n                  return (\r\n                    <View \r\n                      key={index} \r\n                      style={[\r\n                        styles.occurrenceContainer,\r\n                        showBottomBorder ? null : { borderBottomWidth: 0 }\r\n                      ]}\r\n                    >\r\n                      <View style={styles.occurrenceItem}>\r\n                        <Text style={styles.dateTimeText}>\r\n                          {formatOccurrenceDateRange(occ)}\r\n                        </Text>\r\n                        <Text style={styles.durationText}>\r\n                          Event Duration: {getOccurrenceDuration(occ)} ({occ.timezone || userTimezone.split('/')[1] || userTimezone})\r\n                        </Text>\r\n                        {occ.dst_message ? (\r\n                          <Text style={styles.dstMessage}>\r\n                            {occ.dst_message}\r\n                          </Text>\r\n                        ) : null}\r\n                      </View>\r\n                    </View>\r\n                  );\r\n                })}\r\n\r\n                {/* Show more/less dates button */}\r\n                {hasMoreDates && (\r\n                  <TouchableOpacity \r\n                    style={styles.showMoreButton} \r\n                    onPress={toggleDatesExpansion}\r\n                  >\r\n                    <Text style={styles.showMoreText}>\r\n                      {showAllDates ? \"Show Fewer Dates\" : `Show ${hiddenDatesCount} More Date${hiddenDatesCount !== 1 ? 's' : ''}`}\r\n                    </Text>\r\n                    <MaterialCommunityIcons \r\n                      name={showAllDates ? \"chevron-up\" : \"chevron-down\"} \r\n                      size={18} \r\n                      color={theme.colors.primary} \r\n                    />\r\n                  </TouchableOpacity>\r\n                )}\r\n              </View>\r\n\r\n              {isChangeRequest && (\r\n                <View style={styles.changeMessageContainer}>\r\n                  <Text style={styles.changeMessageLabel}>Change Request Message:</Text>\r\n                  <Text style={styles.changeMessageText}>{data.content || 'No details provided'}</Text>\r\n                </View>\r\n              )}\r\n\r\n              <View style={styles.buttonContainer}>\r\n                {/* Review Details button - visible to both users */}\r\n                <TouchableOpacity \r\n                  style={[\r\n                    styles.detailsButton,\r\n                    // Only disable the button if it's a regular message with the Booking Confirmed overlay\r\n                    // Don't disable for isAfterConfirmation messages (booking updates) or displayType === 'booking_update'\r\n                    (isConfirmed && !isBookingConfirmed && !isAfterConfirmation && displayType !== 'booking_update') && styles.disabledButton\r\n                  ]}\r\n                  onPress={handleOpenApprovalModal}\r\n                  disabled={isConfirmed && !isBookingConfirmed && !isAfterConfirmation && displayType !== 'booking_update'}\r\n                >\r\n                  <Text style={styles.detailsButtonText}>\r\n                    {isBookingConfirmed ? \"View Details\" : \"Review Details\"}\r\n                  </Text>\r\n                </TouchableOpacity>\r\n                \r\n                {/* Approve button - only visible to clients for approval requests */}\r\n                {type === 'approval' && !isProfessional && !isConfirmed && !hasChangeRequest && (\r\n                  <TouchableOpacity \r\n                    style={styles.approveButton}\r\n                    onPress={handleApprove}\r\n                  >\r\n                    <Text style={styles.approveButtonText}>Approve</Text>\r\n                  </TouchableOpacity>\r\n                )}\r\n                \r\n                {/* Edit button - visible to pros for booking requests */}\r\n                {type === 'request' && isProfessional && onEditDraft && !isConfirmed && (\r\n                  <TouchableOpacity \r\n                    style={styles.editButton}\r\n                    onPress={onEditDraft}\r\n                  >\r\n                    <Text style={styles.editButtonText}>Edit Draft</Text>\r\n                  </TouchableOpacity>\r\n                )}\r\n                \r\n                {/* Edit Details button - visible to pros for change requests */}\r\n                {isChangeRequest && isProfessional && onEditDraft && (\r\n                  <TouchableOpacity \r\n                    style={styles.editButton}\r\n                    onPress={onEditDraft}\r\n                  >\r\n                    <Text style={styles.editButtonText}>Edit Details</Text>\r\n                  </TouchableOpacity>\r\n                )}\r\n              </View>\r\n            </>\r\n          )}\r\n        </View>\r\n      </View>\r\n\r\n      {/* Status Overlay - shown on confirmed bookings or approval messages with changes requested */}\r\n      {shouldShowOverlay && (\r\n        <View style={styles.statusOverlay}>\r\n          <Text style={styles.statusText}>\r\n            {overlayText}\r\n          </Text>\r\n        </View>\r\n      )}\r\n\r\n      {/* Approval Modal */}\r\n      <BookingApprovalModal\r\n        visible={approvalModalVisible}\r\n        onClose={() => setApprovalModalVisible(false)}\r\n        bookingId={data.booking_id}\r\n        onApproveSuccess={handleApprovalSuccess}\r\n        onApproveError={handleApprovalError}\r\n        onRequestChangesSuccess={handleRequestChangesSuccess}\r\n        onRequestChangesError={handleRequestChangesError}\r\n        initialData={safeInitialData}\r\n        isProfessional={isProfessional}\r\n        // Only set read-only mode for confirmed messages that aren't booking updates\r\n        isReadOnly={(isConfirmed || isBookingConfirmed) && displayType !== 'booking_update' && !isAfterConfirmation}\r\n        // Only hide buttons for confirmed messages that aren't booking updates\r\n        hideButtons={(isConfirmed || isBookingConfirmed) && displayType !== 'booking_update' && !isAfterConfirmation}\r\n        modalTitle={\r\n          displayType === 'booking_update' ? \"Booking Update\" :\r\n          isAfterConfirmation ? \"Booking Update\" :\r\n          isBookingConfirmed || isConfirmed ? \"Booking Details\" : \r\n          \"Booking Approval Request\"\r\n        }\r\n      />\r\n    </View>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  card: {\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 12,\r\n    padding: 0, // Removed padding here as it's now on cardContent\r\n    margin: 8,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    maxWidth: '80%',\r\n    shadowColor: '#000',\r\n    shadowOffset: { width: 0, height: 2 },\r\n    shadowOpacity: 0.1,\r\n    shadowRadius: 4,\r\n    elevation: 3,\r\n    overflow: 'hidden', // To ensure the green bar doesn't overflow\r\n    position: 'relative', // To position the green bar\r\n  },\r\n  sentCard: {\r\n    alignSelf: 'flex-end',\r\n    marginLeft: '20%',\r\n  },\r\n  receivedCard: {\r\n    alignSelf: 'flex-start',\r\n    marginRight: '20%',\r\n  },\r\n  approvalCard: {\r\n    borderColor: theme.colors.border, // Changed to regular border color\r\n    borderWidth: 1,\r\n  },\r\n  confirmedCard: {\r\n    borderColor: theme.colors.success,\r\n    borderWidth: 2,\r\n  },\r\n  colorBar: {\r\n    width: 4, // Width of the green vertical bar\r\n    backgroundColor: theme.colors.primary, // Green color\r\n    position: 'absolute',\r\n    top: 0,\r\n    bottom: 0,\r\n    zIndex: 1,\r\n  },\r\n  colorBarLeft: {\r\n    left: 0,\r\n  },\r\n  colorBarRight: {\r\n    right: 0,\r\n  },\r\n  cardContent: {\r\n    padding: 12, // Moved padding here from card\r\n  },\r\n  header: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    marginBottom: 8,\r\n    paddingBottom: 8,\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: theme.colors.border,\r\n    gap: 8,\r\n  },\r\n  requestHeader: {\r\n    borderBottomColor: theme.colors.border + '40',\r\n  },\r\n  approvalHeader: {\r\n    borderBottomColor: theme.colors.border + '40',\r\n  },\r\n  confirmedHeader: {\r\n    borderBottomColor: theme.colors.success,\r\n  },\r\n  title: {\r\n    fontSize: 16,\r\n    fontWeight: 'bold',\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n  },\r\n  requestTitle: {\r\n    color: theme.colors.primary,\r\n  },\r\n  approvalTitle: {\r\n    color: theme.colors.primary, // Keep the approval request text the same color\r\n  },\r\n  changeRequestTitle: {\r\n    color: theme.colors.warning, // Orange color for change requests\r\n  },\r\n  content: {\r\n    gap: 8,\r\n  },\r\n  infoSection: {\r\n    gap: 4,\r\n    paddingBottom: 8,\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: theme.colors.border + '40',\r\n  },\r\n  row: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    gap: 8,\r\n  },\r\n  label: {\r\n    fontSize: 14,\r\n    fontWeight: '500',\r\n    color: theme.colors.text,\r\n    minWidth: 80,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  value: {\r\n    fontSize: 14,\r\n    color: theme.colors.text,\r\n    flex: 1,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  datesSection: {\r\n    gap: 4,\r\n  },\r\n  datesSectionHeader: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n  },\r\n  datesCount: {\r\n    fontSize: 14,\r\n    color: theme.colors.placeholder,\r\n    marginLeft: 8,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  occurrenceContainer: {\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: theme.colors.border + '40',\r\n    paddingBottom: 8,\r\n    marginBottom: 4,\r\n  },\r\n  occurrenceItem: {\r\n    gap: 2,\r\n    marginLeft: 4,\r\n  },\r\n  dateTimeText: {\r\n    fontSize: 14,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    fontStyle: 'italic', // Italicized date text\r\n  },\r\n  durationText: {\r\n    fontSize: 14,\r\n    color: theme.colors.placeHolderText, // Changed to placeholder text color\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  dstMessage: {\r\n    fontSize: 12,\r\n    color: theme.colors.error,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  buttonContainer: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    marginTop: 8,\r\n    gap: 8,\r\n  },\r\n  detailsButton: {\r\n    flex: 1,\r\n    padding: 8,\r\n    borderRadius: 8,\r\n    alignItems: 'center',\r\n    backgroundColor: theme.colors.primary, // Changed to primary color\r\n  },\r\n  detailsButtonText: {\r\n    color: 'white', // Changed text color to white for better contrast\r\n    fontSize: 14,\r\n    fontWeight: '500',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  approveButton: {\r\n    flex: 1,\r\n    padding: 8,\r\n    borderRadius: 8,\r\n    alignItems: 'center',\r\n    backgroundColor: theme.colors.surface,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n  },\r\n  approveButtonText: {\r\n    color: theme.colors.text,\r\n    fontSize: 14,\r\n    fontWeight: '500',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  editButton: {\r\n    flex: 1,\r\n    padding: 8,\r\n    borderRadius: 8,\r\n    alignItems: 'center',\r\n    backgroundColor: theme.colors.surface,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n  },\r\n  editButtonText: {\r\n    color: theme.colors.text,\r\n    fontSize: 14,\r\n    fontWeight: '500',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  disabledButton: {\r\n    backgroundColor: theme.colors.border,\r\n    opacity: 0.6,\r\n  },\r\n  statusOverlay: {\r\n    position: 'absolute',\r\n    top: 0,\r\n    left: 0,\r\n    right: 0,\r\n    bottom: 0,\r\n    backgroundColor: 'rgba(0, 0, 0, 0.4)',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    zIndex: 2,\r\n  },\r\n  statusText: {\r\n    color: 'white',\r\n    fontSize: 16,\r\n    fontWeight: 'bold',\r\n    padding: 8,\r\n    backgroundColor: 'rgba(0, 0, 0, 0.6)',\r\n    borderRadius: 4,\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n  },\r\n  changeMessageContainer: {\r\n    backgroundColor: theme.colors.background,\r\n    borderRadius: 8,\r\n    padding: 8,\r\n    marginTop: 4,\r\n    marginBottom: 4,\r\n    borderLeftWidth: 3,\r\n    borderLeftColor: theme.colors.warning,\r\n  },\r\n  changeMessageLabel: {\r\n    fontSize: 16,\r\n    fontWeight: '500',\r\n    color: theme.colors.text,\r\n    marginBottom: 4,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  changeMessageText: {\r\n    fontSize: 14,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    // fontStyle: 'italic',\r\n  },\r\n  showMoreButton: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    paddingVertical: 8,\r\n    marginTop: 8,\r\n    marginBottom: 4,\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 8,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.primary + '40',\r\n    paddingHorizontal: 12,\r\n    shadowColor: '#000',\r\n    shadowOffset: { width: 0, height: 1 },\r\n    shadowOpacity: 0.1,\r\n    shadowRadius: 1,\r\n    elevation: 1,\r\n  },\r\n  showMoreText: {\r\n    fontSize: 14,\r\n    color: theme.colors.primary,\r\n    marginRight: 5,\r\n    fontWeight: '500',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  confirmationContainerClickable: {\r\n    flex: 1,\r\n    width: '100%',\r\n    borderRadius: 8,\r\n  },\r\n  confirmationContainer: {\r\n    backgroundColor: theme.colors.success + '15', // Light green background\r\n    padding: 12,\r\n    borderRadius: 8,\r\n    marginBottom: 8,\r\n  },\r\n  confirmationText: {\r\n    fontSize: 14,\r\n    color: theme.colors.text,\r\n    textAlign: 'center',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    fontWeight: '500',\r\n  },\r\n  confirmedTitle: {\r\n    color: theme.colors.success,\r\n  },\r\n  confirmationBorder: {\r\n    position: 'absolute',\r\n    top: 0,\r\n    left: 0,\r\n    right: 0,\r\n    height: 4,\r\n    backgroundColor: theme.colors.success,\r\n  },\r\n});\r\n\r\nexport default BookingMessageCard; ","import React from 'react';\r\nimport { View, Text, StyleSheet } from 'react-native';\r\nimport { Modal, Portal, Button } from 'react-native-paper';\r\nimport { theme } from '../styles/theme';\r\n\r\nconst DraftConfirmationModal = ({ visible, onClose, onContinueExisting, onCreateNew }) => {\r\n  return (\r\n    <Portal>\r\n      <Modal\r\n        visible={visible}\r\n        onDismiss={onClose}\r\n        contentContainerStyle={styles.modalContainer}\r\n      >\r\n        <View style={styles.content}>\r\n          <Text style={styles.title}>Existing Draft Found</Text>\r\n          <Text style={styles.description}>\r\n            Would you like to continue with the existing draft or start a new one?\r\n          </Text>\r\n          <View style={styles.buttonContainer}>\r\n            <Button\r\n              mode=\"outlined\"\r\n              onPress={onCreateNew}\r\n              style={styles.button}\r\n              textColor={theme.colors.error}\r\n            >\r\n              Create New\r\n            </Button>\r\n            <Button\r\n              mode=\"contained\"\r\n              onPress={onContinueExisting}\r\n              style={styles.button}\r\n            >\r\n              Continue Existing\r\n            </Button>\r\n          </View>\r\n        </View>\r\n      </Modal>\r\n    </Portal>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  modalContainer: {\r\n    backgroundColor: theme.colors.surface,\r\n    padding: 20,\r\n    margin: 20,\r\n    borderRadius: 8,\r\n    maxWidth: 500,\r\n    alignSelf: 'center',\r\n  },\r\n  content: {\r\n    alignItems: 'center',\r\n  },\r\n  title: {\r\n    fontSize: 20,\r\n    fontWeight: 'bold',\r\n    marginBottom: 16,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n  },\r\n  description: {\r\n    fontSize: 16,\r\n    marginBottom: 24,\r\n    textAlign: 'center',\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  buttonContainer: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-around',\r\n    width: '100%',\r\n    gap: 16,\r\n  },\r\n  button: {\r\n    flex: 1,\r\n  },\r\n});\r\n\r\nexport default DraftConfirmationModal; ","import { useEffect, useCallback, useState, useRef } from 'react';\r\nimport websocketManager from '../utils/websocket';\r\nimport { getStorage, debugLog } from '../context/AuthContext';\r\nimport axios from 'axios';\r\nimport { API_BASE_URL } from '../config/config';\r\n\r\n/**\r\n * Custom hook to use WebSocket in React components\r\n * @param {string} messageType - Type of messages to subscribe to\r\n * @param {function} callback - Callback to handle received messages\r\n * @param {object} options - Additional options\r\n * @returns {object} WebSocket state and methods\r\n */\r\nconst useWebSocket = (messageType, callback, options = {}) => {\r\n  const { disabled = false, handlerId = Math.random().toString(36).substr(2, 9) } = options;\r\n  const [isConnected, setIsConnected] = useState(false);\r\n  const [connectionStatus, setConnectionStatus] = useState('disconnected');\r\n  const statusUpdateTimeRef = useRef(Date.now());\r\n  const handlerRegisteredRef = useRef(false);\r\n  const failedAttemptsRef = useRef(0);\r\n\r\n  // Initialize WebSocket connection\r\n  useEffect(() => {\r\n    if (disabled) return;\r\n\r\n    debugLog(`MBA3210: useWebSocket hook initializing for ${messageType}, handler ${handlerId}`);\r\n    let unregisterHandlers = [];\r\n    \r\n    const initialize = async () => {\r\n      try {\r\n        const token = await getStorage('userToken');\r\n        if (!token) {\r\n          debugLog('MBA3210: No token available for WebSocket connection');\r\n          return;\r\n        }\r\n        \r\n        // Initialize WebSocket connection\r\n        websocketManager.init(token);\r\n        \r\n        // Register handlers\r\n        if (messageType && !handlerRegisteredRef.current) {\r\n          // Register for specific message type\r\n          const unregister = websocketManager.registerHandler(\r\n            messageType, \r\n            callback, \r\n            `${handlerId}-${messageType}`\r\n          );\r\n          unregisterHandlers.push(unregister);\r\n          handlerRegisteredRef.current = true;\r\n          debugLog(`MBA3210: Registered handler for ${messageType}`);\r\n        }\r\n        \r\n        // Always register for connection status updates\r\n        const unregisterConn = websocketManager.registerHandler(\r\n          'connection',\r\n          (data) => {\r\n            const prevStatus = connectionStatus;\r\n            const prevConnected = isConnected;\r\n            statusUpdateTimeRef.current = Date.now();\r\n            \r\n            if (data.status === 'connected') {\r\n              debugLog('MBA3210: Setting connection status to connected');\r\n              setIsConnected(true);\r\n              setConnectionStatus('connected');\r\n              failedAttemptsRef.current = 0; // Reset failed attempts counter\r\n            } else {\r\n              debugLog('MBA3210: Setting connection status to disconnected');\r\n              setIsConnected(false);\r\n              setConnectionStatus('disconnected');\r\n            }\r\n            \r\n            debugLog(`MBA3210: Connection status changed in hook: ${prevStatus} -> ${data.status}`);\r\n            debugLog(`MBA3210: isConnected changed in hook: ${prevConnected} -> ${data.status === 'connected'}`);\r\n          },\r\n          `${handlerId}-connection`\r\n        );\r\n        unregisterHandlers.push(unregisterConn);\r\n        debugLog(`MBA3210: Registered connection status handler`);\r\n        \r\n        // Always register for user status updates (needed across components for online indicators)\r\n        const unregisterUserStatus = websocketManager.registerHandler(\r\n          'user_status_update',\r\n          (data) => {\r\n            // Call the callback if we're listening for user_status_update messages,\r\n            // or if the callback is meant to handle all message types\r\n            if (messageType === 'user_status_update' || messageType === '*') {\r\n              callback(data);\r\n            }\r\n            \r\n            debugLog(`MBA3210: Received user status update for user ${data.user_id}: ${data.is_online ? 'online' : 'offline'}`);\r\n          },\r\n          `${handlerId}-user_status_update`\r\n        );\r\n        unregisterHandlers.push(unregisterUserStatus);\r\n        debugLog(`MBA3210: Registered user status update handler`);\r\n        \r\n        // Check initial socket state\r\n        if (websocketManager.isConnected) {\r\n          debugLog('MBA3210: WebSocket manager reports connected on init, updating state');\r\n          setIsConnected(true);\r\n          setConnectionStatus('connected');\r\n        }\r\n        \r\n      } catch (error) {\r\n        debugLog(`MBA3210: Error initializing WebSocket in hook: ${error.message}`);\r\n      }\r\n    };\r\n    \r\n    initialize();\r\n    \r\n    // Check connection every second for the first 5 seconds\r\n    const initialConnectionCheck = setInterval(() => {\r\n      if (websocketManager.isConnected) {\r\n        debugLog('MBA3210: Initial connection check: WebSocket is connected');\r\n        setIsConnected(true);\r\n        setConnectionStatus('connected');\r\n        clearInterval(initialConnectionCheck);\r\n      } else {\r\n        debugLog('MBA3210: Initial connection check: WebSocket not connected yet');\r\n      }\r\n    }, 1000);\r\n    \r\n    // Clear the interval after 5 seconds if it hasn't been cleared already\r\n    const initialCheckTimeout = setTimeout(() => {\r\n      clearInterval(initialConnectionCheck);\r\n    }, 5000);\r\n    \r\n    // Cleanup handlers on unmount\r\n    return () => {\r\n      debugLog(`MBA3210: useWebSocket hook cleaning up for ${messageType}, handler ${handlerId}`);\r\n      unregisterHandlers.forEach(unregister => unregister());\r\n      clearInterval(initialConnectionCheck);\r\n      clearTimeout(initialCheckTimeout);\r\n      \r\n      handlerRegisteredRef.current = false;\r\n      \r\n      // We no longer disconnect WebSocket on unmount\r\n      // This allows the connection to persist when navigating between screens\r\n    };\r\n  }, [disabled, messageType, callback, handlerId]);\r\n  \r\n  // Add periodic check for connection status\r\n  useEffect(() => {\r\n    if (disabled) return;\r\n    \r\n    const checkStatus = setInterval(() => {\r\n      const now = Date.now();\r\n      const lastUpdate = statusUpdateTimeRef.current;\r\n      const secondsSinceUpdate = (now - lastUpdate) / 1000;\r\n      \r\n      // If it's been more than 30 seconds since we got a status update, check connection manually\r\n      if (secondsSinceUpdate > 30) {\r\n        debugLog(`MBA3210: [MY CONNECTION] No updates on MY OWN connection in ${secondsSinceUpdate.toFixed(0)} seconds, verifying status`);\r\n        \r\n        // Check actual connection state from the WebSocket manager\r\n        const actuallyConnected = websocketManager.isConnected;\r\n        \r\n        if (actuallyConnected !== isConnected) {\r\n          debugLog(`MBA3210: [MY CONNECTION] State mismatch detected - WebSocket manager: ${actuallyConnected}, hook state: ${isConnected}`);\r\n          \r\n          // Update our state to match reality\r\n          setIsConnected(actuallyConnected);\r\n          setConnectionStatus(actuallyConnected ? 'connected' : 'disconnected');\r\n        }\r\n        \r\n        // Try to send heartbeat if we think we're connected\r\n        if (isConnected) {\r\n          debugLog('MBA3210: [MY CONNECTION] Sending heartbeat to verify MY OWN connection');\r\n          websocketManager.send('heartbeat');\r\n        } else if (actuallyConnected) {\r\n          // Try to send heartbeat even if our state says we're not connected\r\n          // This helps ensure the backend knows we're still here\r\n          debugLog('MBA3210: [MY CONNECTION] Sending heartbeat despite disconnected state in hook');\r\n          websocketManager.send('heartbeat');\r\n        }\r\n        \r\n        // Reset the timer\r\n        statusUpdateTimeRef.current = now;\r\n      }\r\n    }, 15000); // Check every 15 seconds\r\n    \r\n    return () => clearInterval(checkStatus);\r\n  }, [disabled, isConnected]);\r\n\r\n  // Send a message through the WebSocket\r\n  const sendMessage = useCallback((type, data) => {\r\n    debugLog(`MBA3210: [MY CONNECTION] Attempting to send ${type} message through MY OWN WebSocket`);\r\n    \r\n    if (!isConnected) {\r\n      debugLog('MBA3210: [MY CONNECTION] Cannot send message, MY OWN WebSocket not connected, falling back to REST');\r\n      // Return a promise that resolves when the message is sent\r\n      return (async () => {\r\n        try {\r\n          const token = await getStorage('userToken');\r\n          if (!token) {\r\n            debugLog('MBA3210: [MY CONNECTION] No token available for REST message send');\r\n            return false;\r\n          }\r\n          \r\n          // Handle different message types\r\n          let endpoint = `${API_BASE_URL}/api/messages/v1/send_norm_message/`;\r\n          let payload = {\r\n            conversation_id: data.conversation_id,\r\n            content: data.content\r\n          };\r\n          \r\n          // Modify endpoint based on message type\r\n          if (type === 'request_booking') {\r\n            endpoint = `${API_BASE_URL}/api/messages/v1/send_request_booking/`;\r\n            // Add any additional booking request data\r\n            payload = {\r\n              ...payload,\r\n              ...data\r\n            };\r\n          }\r\n          \r\n          debugLog(`MBA3210: [MY CONNECTION] Sending message via REST API to ${endpoint} (fallback for failed WebSocket)`);\r\n          const response = await axios.post(endpoint, payload, {\r\n            headers: {\r\n              Authorization: `Bearer ${token}`,\r\n              'Content-Type': 'application/json'\r\n            }\r\n          });\r\n          \r\n          // Try WebSocket reconnection after sending message\r\n          setTimeout(() => {\r\n            if (websocketManager.reconnect) {\r\n              debugLog('MBA3210: [MY CONNECTION] Attempting reconnection after REST fallback');\r\n              websocketManager.reconnect();\r\n            }\r\n          }, 1000);\r\n          \r\n          return response.data;\r\n        } catch (error) {\r\n          debugLog(`MBA3210: [MY CONNECTION] Error sending message via REST fallback: ${error.message}`);\r\n          return false;\r\n        }\r\n      })();\r\n    }\r\n    \r\n    return websocketManager.send(type, data);\r\n  }, [isConnected]);\r\n\r\n  // Mark messages as read\r\n  const markMessagesAsRead = useCallback((conversationId, messageIds) => {\r\n    // Skip if no conversation or message IDs\r\n    if (!conversationId || !messageIds || messageIds.length === 0) {\r\n      debugLog('MBA3210: [MY CONNECTION] Skipping markMessagesAsRead - missing data');\r\n      return Promise.resolve(false);\r\n    }\r\n    \r\n    debugLog(`MBA3210: [MY CONNECTION] Marking messages as read for conversation ${conversationId}`);\r\n    \r\n    if (!isConnected) {\r\n      debugLog('MBA3210: [MY CONNECTION] Cannot mark messages as read through WebSocket, using REST API instead');\r\n      \r\n      // Return a promise that resolves when the messages are marked as read\r\n      return (async () => {\r\n        try {\r\n          const token = await getStorage('userToken');\r\n          if (!token) {\r\n            debugLog('MBA3210: [MY CONNECTION] No token available for REST mark as read');\r\n            return false;\r\n          }\r\n          \r\n          debugLog(`MBA3210: [MY CONNECTION] Sending mark_read via REST API for ${messageIds.length} messages (fallback)`);\r\n          const response = await axios.post(`${API_BASE_URL}/api/messages/v1/mark_read/`, {\r\n            conversation_id: conversationId,\r\n            message_ids: messageIds\r\n          }, {\r\n            headers: {\r\n              Authorization: `Bearer ${token}`,\r\n              'Content-Type': 'application/json'\r\n            }\r\n          });\r\n          \r\n          return response.data;\r\n        } catch (error) {\r\n          debugLog(`MBA3210: [MY CONNECTION] Error marking messages as read via REST fallback: ${error.message}`);\r\n          return false;\r\n        }\r\n      })();\r\n    }\r\n    \r\n    return websocketManager.markMessagesAsRead(conversationId, messageIds);\r\n  }, [isConnected]);\r\n\r\n  // Force a reconnection attempt\r\n  const reconnect = useCallback(() => {\r\n    debugLog('MBA3210: [MY CONNECTION] Hook requesting reconnection of MY OWN WebSocket');\r\n    \r\n    try {\r\n      // First reinitialize the connection\r\n      if (websocketManager.disconnect) {\r\n        debugLog('MBA3210: [MY CONNECTION] Disconnecting MY OWN existing WebSocket before reconnect');\r\n        websocketManager.disconnect();\r\n      }\r\n      \r\n      // Then attempt reconnection with a short delay\r\n      setTimeout(() => {\r\n        if (websocketManager.reconnect) {\r\n          debugLog('MBA3210: [MY CONNECTION] Calling websocketManager.reconnect() for MY OWN connection');\r\n          websocketManager.reconnect();\r\n        } else if (websocketManager.connect) {\r\n          debugLog('MBA3210: [MY CONNECTION] Calling websocketManager.connect() as fallback for MY OWN connection');\r\n          websocketManager.connect();\r\n        } else {\r\n          // If neither method exists, reinitialize the connection\r\n          debugLog('MBA3210: [MY CONNECTION] No reconnect method found, reinitializing MY OWN connection');\r\n          getStorage('userToken').then(token => {\r\n            if (token) {\r\n              websocketManager.init(token);\r\n            } else {\r\n              debugLog('MBA3210: [MY CONNECTION] No token available for WebSocket reconnection');\r\n            }\r\n          }).catch(error => {\r\n            debugLog(`MBA3210: [MY CONNECTION] Error getting token for reconnection: ${error.message}`);\r\n          });\r\n        }\r\n      }, 300);  // Short delay to ensure disconnect completes\r\n    } catch (error) {\r\n      debugLog(`MBA3210: [MY CONNECTION] Error during reconnection of MY OWN connection: ${error.message}`);\r\n    }\r\n  }, []);\r\n\r\n  // Explicitly disconnect the WebSocket\r\n  const disconnect = useCallback(() => {\r\n    if (disabled) return;\r\n    \r\n    debugLog(`MBA3210: useWebSocket hook explicitly disconnecting for ${messageType}, handler ${handlerId}`);\r\n    websocketManager.disconnect();\r\n    \r\n    // Update local state\r\n    setIsConnected(false);\r\n    setConnectionStatus('disconnected');\r\n    failedAttemptsRef.current = 0;\r\n  }, [disabled, messageType, handlerId]);\r\n\r\n  // Return WebSocket state and methods\r\n  return {\r\n    isConnected,\r\n    connectionStatus,\r\n    sendMessage,\r\n    markMessagesAsRead, \r\n    reconnect: websocketManager.reconnect ? websocketManager.reconnect.bind(websocketManager) : null,\r\n    disconnect,\r\n    simulateConnection: websocketManager.connect ? websocketManager.connect.bind(websocketManager) : null,\r\n    isUsingFallback: !isConnected\r\n  };\r\n};\r\n\r\nexport default useWebSocket; ","import React, { useState, useCallback, useRef, useEffect, useContext } from 'react';\r\nimport { View, StyleSheet, FlatList, KeyboardAvoidingView, Platform, SafeAreaView, StatusBar, TextInput, Text, TouchableOpacity, Dimensions, Alert, Image } from 'react-native';\r\nimport { Button, Card, Paragraph, useTheme, ActivityIndicator, Badge } from 'react-native-paper';\r\nimport { MaterialCommunityIcons } from '@expo/vector-icons'; // Import the icon library\r\nimport { theme } from '../styles/theme';\r\nimport { AuthContext, getStorage, debugLog } from '../context/AuthContext';\r\nimport RequestBookingModal from '../components/RequestBookingModal';\r\nimport BookingStepModal from '../components/BookingStepModal';\r\nimport { createBooking, BOOKING_STATES, mockConversations, mockMessages, CURRENT_USER_ID } from '../data/mockData';\r\nimport { format } from 'date-fns';\r\nimport { useNavigation } from '@react-navigation/native';\r\nimport { API_BASE_URL } from '../config/config';\r\nimport AsyncStorage from '@react-native-async-storage/async-storage';\r\nimport axios from 'axios';\r\nimport { navigateToFrom } from '../components/Navigation';\r\nimport BookingMessageCard from '../components/BookingMessageCard';\r\nimport { formatOccurrenceFromUTC } from '../utils/time_utils';\r\nimport DraftConfirmationModal from '../components/DraftConfirmationModal';\r\nimport useWebSocket from '../hooks/useWebSocket';\r\nimport MessageNotificationContext from '../context/MessageNotificationContext';\r\nimport {\r\n  getConnectionProfile,\r\n  getUserConnections,\r\n  approveBooking,\r\n  requestBookingChanges,\r\n  createDraftFromBooking,\r\n  // ... other imports from API.js\r\n} from '../api/API';\r\n\r\n// First, create a function to generate dynamic styles\r\nconst createStyles = (screenWidth, isCollapsed) => StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    backgroundColor: theme.colors.background,\r\n    paddingTop: screenWidth > 900 ? 0 : 0,\r\n    paddingRight: screenWidth > 900 ? 0 : 0,\r\n    paddingLeft: screenWidth > 900 ? 0 : 0,\r\n    height: screenWidth > 900 ? '100vh' : 'calc(100vh - 64px)',\r\n    overflow: 'hidden',\r\n    position: 'fixed',\r\n    top: screenWidth > 900 ? 0 : 64,\r\n    left: 0,\r\n    right: 0,\r\n    bottom: 0,\r\n  },\r\n  headerContainer: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    padding: 16,\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: theme.colors.border,\r\n  },\r\n  headerTitle: {\r\n    fontSize: 20,\r\n    fontWeight: 'bold',\r\n    color: theme.colors.primary,\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n  },\r\n  filterButton: {\r\n    marginLeft: 'auto',\r\n  },\r\n  contentContainer: {\r\n    flex: 1,\r\n    flexDirection: 'row',\r\n    justifyContent: 'center',\r\n    maxWidth: screenWidth > 900 ? '100%' : 900,\r\n    alignSelf: 'center',\r\n    width: '100%',\r\n    overflow: 'hidden',\r\n    height: '100%',\r\n  },\r\n  mainSection: {\r\n    flex: 1,\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    maxWidth: Platform.OS === 'web' ? \r\n      (screenWidth <= 900 ? '100%' : '70%') : \r\n      '100%',\r\n    alignSelf: screenWidth <= 900 ? 'stretch' : 'flex-start',\r\n    width: screenWidth <= 900 ? '100%' : 'auto',\r\n    height: '100%',\r\n  },\r\n  conversationListContainer: {\r\n    width: screenWidth <= 900 ? '100%' : '30%',\r\n    maxWidth: screenWidth < 900 ? '' : 600,\r\n    backgroundColor: theme.colors.surfaceContrast,\r\n    overflow: 'auto',\r\n  },\r\n  conversationItem: {\r\n    padding: 16,\r\n    maxWidth: screenWidth < 900 ? '' : 600,\r\n    width: '100%',\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: theme.colors.border,\r\n  },\r\n  selectedConversation: {\r\n    backgroundColor: theme.colors.primary + '20',\r\n    borderLeftWidth: 3,\r\n    borderLeftColor: theme.colors.primary,\r\n  },\r\n  conversationName: {\r\n    fontSize: 16,\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n    flex: 1,\r\n  },\r\n  messageSection: {\r\n    flex: 1,\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    overflow: 'hidden',\r\n    paddingHorizontal: 5,\r\n    backgroundColor: theme.colors.surface, // #FDFBF5\r\n    // Add bottom padding on mobile web to account for fixed input\r\n    ...(Platform.OS === 'web' && screenWidth <= 900 ? {\r\n      paddingBottom: 80, // Account for fixed input height\r\n    } : {}),\r\n  },\r\n  messageHeader: {\r\n    padding: 22,\r\n    backgroundColor: theme.colors.surfaceContrast,\r\n    width: '100%',\r\n    // marginVertical: 10,\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    shadowColor: '#000',\r\n    shadowOffset: { width: 0, height: .5 },\r\n    shadowOpacity: 0.1,\r\n    shadowRadius: 3,\r\n    elevation: 3,\r\n    zIndex: 1,\r\n  },\r\n  profilePhoto: {\r\n    width: 40,\r\n    height: 40,\r\n    borderRadius: 20,\r\n    marginRight: 12,\r\n  },\r\n  messageHeaderName: {\r\n    fontSize: 18,\r\n    fontWeight: 'bold',\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n  },\r\n  messagesContainer: {\r\n    flex: 1,\r\n    overflow: 'auto',\r\n    width: '100%',\r\n  },\r\n  messageList: {\r\n    width: '100%',\r\n    paddingBottom: 16,\r\n  },\r\n  inputSection: {\r\n    width: '100%',\r\n    backgroundColor: theme.colors.surfaceContrast,\r\n    padding: screenWidth > 600 ? 16 : 8,\r\n    shadowColor: '#000',\r\n    shadowOffset: { width: 0, height: -.5 },\r\n    shadowOpacity: 0.1,\r\n    shadowRadius: 3,\r\n    elevation: 3,\r\n    zIndex: 1,\r\n    // Fix for mobile browsers - position fixed at bottom\r\n    ...(Platform.OS === 'web' && screenWidth <= 900 ? {\r\n      position: 'fixed',\r\n      bottom: 0,\r\n      left: 0,\r\n      right: 0,\r\n      zIndex: 1000,\r\n    } : {}),\r\n  },\r\n  inputContainer: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    width: '100%',\r\n  },\r\n  attachButtonContainer: {\r\n    marginRight: 8,\r\n  },\r\n  attachButton: {\r\n    padding: 8,\r\n    backgroundColor: theme.colors.surfaceContrast,\r\n    borderRadius: 20,\r\n    width: 40,\r\n    height: 40,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n  },\r\n  inputInnerContainer: {\r\n    flex: 1,\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    backgroundColor: theme.colors.surfaceContrast,\r\n    borderRadius: 20,\r\n    marginRight: 8,\r\n  },\r\n  messageInput: {\r\n    flex: 1,\r\n    backgroundColor: theme.colors.background,\r\n    borderRadius: 20,\r\n    paddingHorizontal: 16,\r\n    paddingVertical: 8,\r\n    marginHorizontal: 8,\r\n  },\r\n  sendButton: {\r\n    borderRadius: 20,\r\n    marginLeft: 8,\r\n  },\r\n  messageCard: {\r\n    marginVertical: 4,\r\n    maxWidth: screenWidth > 900 ? '40%' : '75%',\r\n    borderRadius: 12,\r\n    overflow: 'hidden',\r\n  },\r\n  // This is for the messages that are sent and received\r\n  messageContent: {\r\n    paddingHorizontal: 8,\r\n    paddingVertical: 4,\r\n  },\r\n  sentMessage: {\r\n    alignSelf: 'flex-end',\r\n    backgroundColor: theme.colors.primary,\r\n  },\r\n  receivedMessage: {\r\n    alignSelf: 'flex-start',\r\n    backgroundColor: theme.colors.receivedMessage,\r\n  },\r\n  messageText: {\r\n    fontSize: 16,\r\n    lineHeight: 20,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  sentMessageContainer: {\r\n    alignItems: 'flex-end',\r\n    marginBottom: 4,\r\n  },\r\n  receivedMessageContainer: {\r\n    alignItems: 'flex-start',\r\n    marginBottom: 4,\r\n  },\r\n  senderAbove: {\r\n    fontWeight: 'bold',\r\n    marginBottom: 4,\r\n    fontSize: 12,\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n  },\r\n  sentSenderName: {\r\n    alignSelf: 'flex-end',\r\n  },\r\n  receivedSenderName: {\r\n    alignSelf: 'flex-start',\r\n  },\r\n  timestampBelow: {\r\n    fontSize: 12,\r\n    color: theme.colors.placeholder,\r\n    marginTop: 4,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  sentTimestamp: {\r\n    alignSelf: 'flex-end',\r\n  },\r\n  receivedTimestamp: {\r\n    alignSelf: 'flex-start',\r\n  },\r\n  sentMessageText: {\r\n    color: theme.colors.whiteText,\r\n  },\r\n  receivedMessageText: {\r\n    color: theme.colors.text,\r\n  },\r\n  webInput: {\r\n    flex: 1,\r\n    backgroundColor: 'transparent',\r\n    paddingVertical: '8px',\r\n    paddingLeft: '12px',\r\n    height: 24,\r\n    maxHeight: '120px', // This will accommodate 5 lines of text\r\n    border: '1px solid ' + theme.colors.border,\r\n    borderRadius: 20,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    fontSize: screenWidth <= 600 ? '14px' : 'inherit',\r\n    appearance: 'none',\r\n    touchAction: 'manipulation',\r\n    WebkitTapHighlightColor: 'transparent',\r\n    WebkitUserSelect: 'none',\r\n    userSelect: 'none',\r\n    resize: 'none',\r\n    overflowY: 'auto', // Enable scrolling\r\n    lineHeight: '20px',\r\n    paddingRight: '12px', // Add right padding for scroll bar\r\n  },\r\n  conversationContent: {\r\n    flex: 1,\r\n    width: '100%',\r\n  },\r\n  conversationHeader: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    marginBottom: 6,\r\n    width: '100%',\r\n  },\r\n  conversationNameContainer: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    flex: 1,\r\n  },\r\n  conversationTime: {\r\n    fontSize: 12,\r\n    color: theme.colors.placeholder,\r\n  },\r\n  conversationLastMessageContainer: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    width: '100%',\r\n    marginBottom: 6,\r\n  },\r\n  conversationLastMessage: {\r\n    fontSize: 14,\r\n    color: theme.colors.placeholder,\r\n    flex: 1,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  conversationUnreadBadge: {\r\n    position: 'relative',\r\n    backgroundColor: theme.colors.error,\r\n    borderRadius: 10,\r\n    minWidth: 18,\r\n    height: 18,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    paddingHorizontal: 4,\r\n    marginLeft: 8,\r\n  },\r\n  unreadMessage: {\r\n    color: theme.colors.text,\r\n    fontWeight: 'bold',\r\n  },\r\n  bookingStatusContainer: {\r\n    backgroundColor: theme.colors.primary + '20',\r\n    padding: 4,\r\n    borderRadius: 4,\r\n    alignSelf: 'flex-start',\r\n    marginTop: 2,\r\n  },\r\n  bookingStatus: {\r\n    fontSize: 12,\r\n    color: theme.colors.primary,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  requestBookingButton: {\r\n    marginTop: 4,\r\n    height: 28,\r\n    alignSelf: 'flex-start',\r\n  },\r\n  requestBookingLabel: {\r\n    fontSize: 12,\r\n    marginVertical: 0,\r\n  },\r\n  messageListContainer: {\r\n    flex: 1,\r\n  },\r\n  inputWrapper: {\r\n    position: 'absolute',\r\n    bottom: 0,\r\n    left: 0,\r\n    right: 0,\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    borderTopWidth: 1,\r\n    borderTopColor: theme.colors.border,\r\n    backgroundColor: theme.colors.surface,\r\n    zIndex: 1,\r\n    width: '100%',\r\n    padding: screenWidth > 600 ? 16 : 8,\r\n  },\r\n  dropdownMenu: {\r\n    position: 'absolute',\r\n    bottom: '100%',\r\n    left: 0,\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 8,\r\n    shadowColor: '#000',\r\n    shadowOffset: { width: 0, height: -2 },\r\n    shadowOpacity: 0.25,\r\n    shadowRadius: 3.84,\r\n    elevation: 5,\r\n    marginBottom: 8,\r\n    minWidth: 150,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n  },\r\n  dropdownItem: {\r\n    padding: 12,\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n  },\r\n  dropdownText: {\r\n    color: theme.colors.text,\r\n    fontSize: 14,\r\n    marginLeft: 8,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  activeConversationText: {\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  mobileMessageView: {\r\n    flex: 1,\r\n    width: '100%',\r\n    height: '100%',\r\n    position: 'relative',\r\n    backgroundColor: theme.colors.background,\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n  },\r\n  backButton: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    padding: 16,\r\n  },\r\n  backButtonText: {\r\n    marginLeft: 8,\r\n    color: theme.colors.primary,\r\n    fontSize: 16,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  mobileHeader: {\r\n    width: '100%',\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: theme.colors.border,\r\n    position: 'relative',\r\n    zIndex: 10,\r\n    shadowColor: '#000',\r\n    shadowOffset: { width: 0, height: 1 },\r\n    shadowOpacity: 0.1,\r\n    shadowRadius: 2,\r\n    elevation: 3,\r\n  },\r\n  mobileContent: {\r\n    flex: 1,\r\n    position: 'relative',\r\n    height: 'calc(100% - 56px)',\r\n  },\r\n  mobileContainer: {\r\n    paddingTop: 0,\r\n    paddingLeft: 0,\r\n    paddingRight: 0,\r\n  },\r\n  sendButtonMobile: {\r\n    width: 24,\r\n    height: 24,\r\n    minWidth: 0,\r\n    padding: 0,\r\n    marginLeft: 4,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n  },\r\n  mobileHeaderContent: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    position: 'relative',\r\n    paddingVertical: 16,\r\n    paddingHorizontal: 8,\r\n    width: '100%',\r\n    minHeight: 60,\r\n  },\r\n  mobileHeaderName: {\r\n    fontSize: 18,\r\n    fontWeight: 'bold',\r\n    color: theme.colors.text,\r\n    textAlign: 'center',\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n    flexWrap: 'wrap',\r\n    maxWidth: '70%',\r\n  },\r\n  mobileHeaderNameContainer: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    flexWrap: 'wrap',\r\n  },\r\n  backArrow: {\r\n    position: 'absolute',\r\n    left: 16,\r\n    zIndex: 10,\r\n    padding: 8,\r\n  },\r\n  bookingRequestCard: {\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 12,\r\n    padding: 16,\r\n    margin: 8,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    maxWidth: '75%',\r\n    position: 'relative',\r\n  },\r\n  sentBookingRequest: {\r\n    alignSelf: 'flex-end',\r\n    marginLeft: '20%',\r\n  },\r\n  receivedBookingRequest: {\r\n    alignSelf: 'flex-start',\r\n    marginRight: '20%',\r\n  },\r\n  bookingRequestHeader: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    marginBottom: 12,\r\n    gap: 8,\r\n  },\r\n  bookingRequestTitle: {\r\n    fontSize: 18,\r\n    fontWeight: 'bold',\r\n    color: theme.colors.primary,\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n  },\r\n  bookingRequestDetails: {\r\n    gap: 8,\r\n  },\r\n  inlineDetailRow: {\r\n    flexDirection: 'row',\r\n    // alignItems: 'flex-start',\r\n    gap: 8,\r\n    marginBottom: 8,\r\n  },\r\n  dateSection: {\r\n    gap: 8,\r\n  },\r\n  detailLabel: {\r\n    fontSize: 16,\r\n    fontWeight: '502',\r\n    color: theme.colors.text,\r\n    // minWidth: 70,\r\n  },\r\n  detailText: {\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n    flex: 1,\r\n  },\r\n  acceptButton: {\r\n    backgroundColor: theme.colors.primary,\r\n    padding: 12,\r\n    borderRadius: 8,\r\n    alignItems: 'center',\r\n    marginTop: 16,\r\n  },\r\n  acceptButtonText: {\r\n    color: theme.colors.surface,\r\n    fontSize: 16,\r\n    fontWeight: '500',\r\n  },\r\n  viewBookingButton: {\r\n    backgroundColor: theme.colors.primary,\r\n    padding: 12,\r\n    borderRadius: 8,\r\n    alignItems: 'center',\r\n    marginTop: 16,\r\n  },\r\n  viewBookingText: {\r\n    color: theme.colors.surface,\r\n    fontSize: 16,\r\n    fontWeight: '500',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  statusContainer: {\r\n    backgroundColor: theme.colors.primary + '15',\r\n    padding: 8,\r\n    borderRadius: 4,\r\n    marginBottom: 12,\r\n  },\r\n  statusText: {\r\n    color: theme.colors.primary,\r\n    fontSize: 14,\r\n    fontWeight: '500',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  deletedOverlay: {\r\n    position: 'absolute',\r\n    top: 0,\r\n    left: 0,\r\n    right: 0,\r\n    bottom: 0,\r\n    backgroundColor: 'rgba(0, 0, 0, 0.7)',\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    borderRadius: 12,\r\n  },\r\n  deletedText: {\r\n    color: theme.colors.surface,\r\n    fontSize: 18,\r\n    fontWeight: 'bold',\r\n  },\r\n  occurrenceItem: {\r\n    marginBottom: 12,\r\n    borderBottomWidth: 1,\r\n    borderColor: theme.colors.border,\r\n  },\r\n  occurrenceNumber: {\r\n    fontWeight: 'bold',\r\n    marginBottom: 4,\r\n    color: theme.colors.primary,\r\n  },\r\n  occurrenceDetails: {\r\n    backgroundColor: theme.colors.background,\r\n    padding: 8,\r\n    borderRadius: 4,\r\n  },\r\n  loadingContainer: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n  },\r\n  loadingText: {\r\n    marginTop: 12,\r\n    color: theme.colors.placeholder,\r\n    fontSize: 16,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  emptyText: {\r\n    padding: 16,\r\n    color: theme.colors.placeholder,\r\n    fontSize: 16,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    textAlign: 'center',\r\n  },\r\n  loadingMore: {\r\n    padding: 16,\r\n  },\r\n  searchContainer: {\r\n    padding: 16,\r\n    backgroundColor: theme.colors.surfaceContrast,\r\n  },\r\n  searchInputContainer: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 20,\r\n    paddingHorizontal: 12,\r\n    marginVertical: 6,\r\n    height: 40,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n  },\r\n  searchIcon: {\r\n    marginRight: 8,\r\n  },\r\n  clearButton: {\r\n    padding: 4,\r\n  },\r\n  searchInput: {\r\n    flex: 1,\r\n    height: '100%',\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    outline: 'none',  // Remove outline for web\r\n    WebkitTapHighlightColor: 'transparent', // Remove tap highlight on iOS/Safari\r\n    WebkitAppearance: 'none', // Standardize appearance\r\n  },\r\n  messageHeaderContent: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    flex: 1,\r\n  },\r\n  editDraftButton: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    backgroundColor: theme.colors.surface,\r\n    paddingHorizontal: 12,\r\n    paddingVertical: 6,\r\n    borderRadius: 16,\r\n    marginLeft: 'auto',\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.primary,\r\n  },\r\n  editDraftText: {\r\n    marginLeft: 4,\r\n    color: theme.colors.primary,\r\n    fontSize: 14,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  createBookingContainer: {\r\n    position: 'absolute',\r\n    top: 8,\r\n    left: 0,\r\n    right: 0,\r\n    paddingHorizontal: 16,\r\n    alignItems: 'center',\r\n    zIndex: 10,\r\n    pointerEvents: 'box-none',\r\n  },\r\n  createBookingHangingButton: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    backgroundColor: theme.colors.surface,\r\n    paddingHorizontal: screenWidth <= 600 ? 12 : 16,\r\n    paddingVertical: screenWidth <= 600 ? 8 : 10,\r\n    borderRadius: 20,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.primary,\r\n    shadowColor: '#000',\r\n    shadowOffset: { width: 0, height: 2 },\r\n    shadowOpacity: 0.1,\r\n    shadowRadius: 3,\r\n    elevation: 3,\r\n    width: '50%',\r\n    justifyContent: 'center',\r\n  },\r\n  createBookingHangingText: {\r\n    marginLeft: 8,\r\n    color: theme.colors.primary,\r\n    fontSize: screenWidth <= 600 ? 14 : 16,\r\n    fontWeight: '500',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  conversationUnreadBadge: {\r\n    position: 'relative',\r\n    backgroundColor: theme.colors.error,\r\n    borderRadius: 10,\r\n    minWidth: 18,\r\n    height: 18,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    paddingHorizontal: 4,\r\n  },\r\n  conversationUnreadText: {\r\n    color: theme.colors.whiteText,\r\n    fontSize: 11,\r\n    fontWeight: 'bold',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  timeContainer: {\r\n    flexDirection: 'column',\r\n    alignItems: 'flex-end',\r\n    justifyContent: 'flex-start',\r\n  },\r\n  unreadBadge: {\r\n    backgroundColor: theme.colors.error,\r\n    borderRadius: 10,\r\n    minWidth: 18,\r\n    height: 18,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    paddingHorizontal: 4,\r\n    marginLeft: 8,\r\n    alignSelf: 'flex-start',\r\n  },\r\n  \r\n  unreadBadgeText: {\r\n    color: 'white',\r\n    fontSize: 11,\r\n    fontWeight: 'bold',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  \r\n  conversationNameRow: {\r\n    flexDirection: 'row', \r\n    alignItems: 'center',\r\n    marginBottom: 4,\r\n  },\r\n  mobileEditDraftButton: {\r\n    marginRight: 10,\r\n    paddingHorizontal: 8,\r\n    paddingVertical: 4,\r\n    borderRadius: 12,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.primary,\r\n    backgroundColor: theme.colors.surface,\r\n    minWidth: 55,\r\n    alignSelf: 'flex-start',\r\n  },\r\n});\r\n\r\nconst MessageHistory = ({ navigation, route }) => {\r\n  const { colors } = useTheme();\r\n  const { screenWidth } = useContext(AuthContext);\r\n  const styles = createStyles(screenWidth, false);\r\n  \r\n  // Add loading states\r\n  const [isLoadingConversations, setIsLoadingConversations] = useState(true);\r\n  const [isLoadingMessages, setIsLoadingMessages] = useState(false);\r\n  const [isLoading, setIsLoading] = useState(false); // Add isLoading state for edit draft\r\n  const [isSearchFocused, setIsSearchFocused] = useState(false); // Add state for search input focus\r\n  \r\n  const [selectedConversation, setSelectedConversation] = useState(null);\r\n  const [selectedConversationData, setSelectedConversationData] = useState(null);\r\n  const [messages, setMessages] = useState([]);\r\n  const [isSending, setIsSending] = useState(false);\r\n  const [showRequestModal, setShowRequestModal] = useState(false);\r\n  const [showDropdown, setShowDropdown] = useState(false);\r\n  const { is_DEBUG, is_prototype, isCollapsed, isApprovedProfessional, userRole, timeSettings } = useContext(AuthContext);\r\n  const [conversations, setConversations] = useState([]);\r\n  const [filteredConversations, setFilteredConversations] = useState([]); // Add filtered conversations state\r\n  const [hasMore, setHasMore] = useState(true);\r\n  const [currentPage, setCurrentPage] = useState(1);\r\n  const [isLoadingMore, setIsLoadingMore] = useState(false);\r\n  const prevScreenWidthRef = useRef(screenWidth);\r\n  const hasLoadedInitialDataRef = useRef(false);\r\n  const [isInitialLoad, setIsInitialLoad] = useState(true);\r\n  const initialLoadRef = useRef(true);\r\n  const [showBookingStepModal, setShowBookingStepModal] = useState(false);\r\n  const [currentBookingId, setCurrentBookingId] = useState(null);\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const [hasDraft, setHasDraft] = useState(false);\r\n  const [draftData, setDraftData] = useState(null);\r\n  const [showDraftConfirmModal, setShowDraftConfirmModal] = useState(false);\r\n  const [wsConnectionStatus, setWsConnectionStatus] = useState('disconnected');\r\n  const [forceRerender, setForceRerender] = useState(0); // Add this state to help with scroll issues\r\n  const { resetNotifications, updateRoute, markConversationAsRead, getConversationUnreadCount } = useContext(MessageNotificationContext);\r\n\r\n  // Add a ref to track if we're handling route params\r\n  const isHandlingRouteParamsRef = useRef(false);\r\n\r\n  // Add a ref to track if messages have been fetched for the current conversation\r\n  const hasLoadedMessagesRef = useRef(false);\r\n\r\n  // Add a ref to track if we need to open booking creation\r\n  const shouldOpenBookingCreationRef = useRef(false);\r\n  \r\n  // Add a ref for the markMessagesAsRead function that will come from the useWebSocket hook\r\n  const markMessagesAsReadRef = useRef(null);\r\n\r\n  // Add a ref to track the last viewed conversation to avoid redundant API calls\r\n  const lastViewedConversationRef = useRef(null);\r\n\r\n  // Add these refs at the top level of the component, near other ref declarations\r\n  const isLoadingMoreRef = useRef(false);\r\n  const processedPagesRef = useRef(new Set());\r\n  const messageIdsRef = useRef(new Set());\r\n\r\n  // Outside the renderMessage callback, add a function to group messages by booking ID\r\n  const groupMessagesByBookingId = (messages) => {\r\n    const bookingMessages = {};\r\n    \r\n    // First pass: collect messages by booking ID\r\n    messages.forEach(message => {\r\n      if (message.metadata && message.metadata.booking_id) {\r\n        const bookingId = message.metadata.booking_id;\r\n        if (!bookingMessages[bookingId]) {\r\n          bookingMessages[bookingId] = [];\r\n        }\r\n        bookingMessages[bookingId].push({\r\n          messageId: message.message_id,\r\n          type: message.type_of_message,\r\n          timestamp: new Date(message.created_at || message.timestamp),\r\n          message: message\r\n        });\r\n      }\r\n    });\r\n    \r\n    // Second pass: sort messages by timestamp (newest first)\r\n    Object.keys(bookingMessages).forEach(bookingId => {\r\n      bookingMessages[bookingId].sort((a, b) => b.timestamp - a.timestamp);\r\n    });\r\n    \r\n    return bookingMessages;\r\n  };\r\n\r\n  // WebSocket message handler defined as a memoized callback\r\n  const handleWebSocketMessage = useCallback((data) => {\r\n    debugLog('MBA3210: Received WebSocket message:', data);\r\n    \r\n    try {\r\n      // Validate message data\r\n      if (!data || (!data.message_id && !data.conversation_id && !data.type)) {\r\n        debugLog('MBA3210: Invalid message data received');\r\n        return;\r\n      }\r\n      \r\n      // Handle user status updates\r\n      if (data.type === 'user_status_update' && data.user_id) {\r\n        debugLog('MBA3210: [OTHER USER STATUS] Received online status update for user ID:', data.user_id);\r\n        \r\n        // Normalize the user_id to string for comparison\r\n        const statusUserId = String(data.user_id);\r\n        const isOnline = !!data.is_online;\r\n        \r\n        debugLog(`MBA3210: [OTHER USER STATUS] Processing status change for user ${statusUserId}, online=${isOnline}`);\r\n        \r\n        // Update the conversations list with the new online status\r\n        setConversations(prevConversations => {\r\n          // Log the current conversations for debugging\r\n          debugLog(`MBA3210: [OTHER USER STATUS] Checking ${prevConversations.length} conversations for user ${statusUserId}`);\r\n          \r\n          // Apply the update\r\n          const updatedConversations = prevConversations.map(conv => {\r\n            // Normalize participant IDs to strings for comparison\r\n            const participant1Id = conv.participant1_id ? String(conv.participant1_id) : '';\r\n            const participant2Id = conv.participant2_id ? String(conv.participant2_id) : '';\r\n            \r\n            // Check if this conversation involves the user whose status changed\r\n            const matchesUser = (statusUserId === participant1Id || statusUserId === participant2Id);\r\n            \r\n            if (matchesUser) {\r\n              debugLog(`MBA3210: [OTHER USER STATUS] Found match in conversation ${conv.conversation_id}, setting other_participant_online=${isOnline}`);\r\n              \r\n              // Update this conversation with the new online status\r\n              return {\r\n                ...conv,\r\n                other_participant_online: isOnline\r\n              };\r\n            }\r\n            return conv;\r\n          });\r\n          \r\n          // Check if any conversations were updated\r\n          const updatedCount = updatedConversations.filter(\r\n            (conv, i) => conv.other_participant_online !== prevConversations[i].other_participant_online\r\n          ).length;\r\n          \r\n          debugLog(`MBA3210: [OTHER USER STATUS] Updated ${updatedCount} conversations with new status for user ${statusUserId}`);\r\n          \r\n          return updatedConversations;\r\n        });\r\n        \r\n        // Also update the selected conversation if it's affected\r\n        if (selectedConversationData) {\r\n          // Normalize participant IDs to strings\r\n          const selectedParticipant1Id = selectedConversationData.participant1_id \r\n            ? String(selectedConversationData.participant1_id) \r\n            : '';\r\n          const selectedParticipant2Id = selectedConversationData.participant2_id \r\n            ? String(selectedConversationData.participant2_id) \r\n            : '';\r\n          \r\n          // Check if selected conversation involves this user\r\n          if (statusUserId === selectedParticipant1Id || statusUserId === selectedParticipant2Id) {\r\n            debugLog(`MBA3210: [OTHER USER STATUS] Updating selected conversation with online status: ${isOnline} for user ${statusUserId}`);\r\n            \r\n            setSelectedConversationData(prev => ({\r\n              ...prev,\r\n              other_participant_online: isOnline\r\n            }));\r\n          }\r\n        }\r\n        \r\n        return;\r\n      }\r\n      \r\n      // If this message is for our current conversation\r\n      if (selectedConversation && data.conversation_id && \r\n          String(data.conversation_id) === String(selectedConversation)) {\r\n        \r\n        debugLog('MBA3210: Message is for current conversation, adding to list');\r\n        \r\n        // Add the new message to the list (at the beginning since FlatList is inverted)\r\n        setMessages(prevMessages => {\r\n          // Check if message already exists to avoid duplicates - be more thorough\r\n          const messageExists = prevMessages.some(msg => {\r\n            // Check by ID if available (most reliable)\r\n            if (msg.message_id && data.message_id && \r\n                String(msg.message_id) === String(data.message_id)) {\r\n              debugLog('MBA3210: Duplicate detected by ID');\r\n              return true;\r\n            }\r\n            \r\n            // Also check for messages with the same content, timestamp and sender\r\n            // to catch duplicates that might have different/temporary IDs\r\n            if (msg.content === data.content && \r\n                msg.sent_by_other_user === data.sent_by_other_user) {\r\n              \r\n              // If the timestamp exists, compare with some tolerance\r\n              if (msg.timestamp && data.timestamp) {\r\n                const timeDiff = Math.abs(\r\n                  new Date(msg.timestamp).getTime() - \r\n                  new Date(data.timestamp).getTime()\r\n                );\r\n                \r\n                // 5 seconds tolerance (messages sent close to each other)\r\n                if (timeDiff < 5000) {\r\n                  debugLog('MBA3210: Duplicate detected by content+timestamp');\r\n                  return true;\r\n                }\r\n              } else {\r\n                // If no timestamp, just assume it's the same message\r\n                debugLog('MBA3210: Duplicate detected by content+sender');\r\n                return true;\r\n              }\r\n            }\r\n            \r\n            // Check for optimistic messages that match\r\n            if (msg._isOptimistic && \r\n                msg.content === data.content && \r\n                !data.sent_by_other_user) {\r\n              debugLog('MBA3210: Found matching optimistic message, replacing');\r\n              return true;\r\n            }\r\n            \r\n            return false;\r\n          });\r\n          \r\n          if (messageExists) {\r\n            debugLog('MBA3210: Message already exists in the list, skipping');\r\n            \r\n            // For optimistic messages that now have a real ID, update them\r\n            if (data.message_id) {\r\n              return prevMessages.map(msg => {\r\n                if (msg._isOptimistic && \r\n                    msg.content === data.content && \r\n                    !data.sent_by_other_user) {\r\n                  // Replace the optimistic message with the real one\r\n                  return { ...data, _wasOptimistic: true };\r\n                }\r\n                return msg;\r\n              });\r\n            }\r\n            \r\n            return prevMessages;\r\n          }\r\n          \r\n          debugLog('MBA3210: Adding new message to list:', data.message_id);\r\n          return [data, ...prevMessages];\r\n        });\r\n        \r\n        // Mark the message as read if we're viewing this conversation\r\n        if (data.message_id && markMessagesAsReadRef.current && data.sent_by_other_user) {\r\n          debugLog('MBA3210: Marking message as read:', data.message_id);\r\n          markMessagesAsReadRef.current(selectedConversation, [data.message_id]);\r\n        }\r\n      } else if (data.conversation_id) {\r\n        // Update the conversation list for unread messages in other conversations\r\n        debugLog('MBA3210: Message is for another conversation, updating conversation list');\r\n        setConversations(prevConversations => \r\n          prevConversations.map(conv => \r\n            String(conv.conversation_id) === String(data.conversation_id)\r\n              ? {\r\n                  ...conv,\r\n                  last_message: data.content,\r\n                  last_message_time: data.timestamp,\r\n                  unread: true\r\n                }\r\n              : conv\r\n          )\r\n        );\r\n      }\r\n    } catch (error) {\r\n      debugLog('MBA3210: Error handling WebSocket message:', error);\r\n    }\r\n  }, [selectedConversation]);\r\n\r\n  // Initialize WebSocket with the message handler\r\n  const { isConnected, connectionStatus, markMessagesAsRead, reconnect, disconnect, simulateConnection, isUsingFallback } = useWebSocket(\r\n    'message', \r\n    handleWebSocketMessage,\r\n    { handlerId: 'message-history' }\r\n  );\r\n  \r\n  // Update our ref when markMessagesAsRead changes\r\n  useEffect(() => {\r\n    markMessagesAsReadRef.current = markMessagesAsRead;\r\n  }, [markMessagesAsRead]);\r\n  \r\n\r\n  // Add a function to manually force reconnection\r\n  const handleForceReconnect = useCallback(() => {\r\n    debugLog('MBA3210: [CONNECTION] User manually requested WebSocket reconnection');\r\n    if (typeof reconnect === 'function') {\r\n      reconnect();\r\n    }\r\n  }, [reconnect, selectedConversationData]);\r\n  \r\n  // Add a function to simulate connection for testing\r\n  // const handleSimulateConnection = useCallback(() => {\r\n  //   debugLog('MBA3210: User requested simulated connection');\r\n  //   if (typeof simulateConnection === 'function') {\r\n  //     simulateConnection();\r\n  //   }\r\n  // }, [simulateConnection]);\r\n  \r\n  // Update connection status UI and log more detailed information\r\n  useEffect(() => {\r\n    setWsConnectionStatus(connectionStatus);\r\n    // debugLog(`MBA3210: [MY CONNECTION] WebSocket connection status changed to ${connectionStatus}`);\r\n    // debugLog(`MBA3210: [MY CONNECTION] isConnected state: ${isConnected}`);\r\n    // debugLog(`MBA3210: [MY CONNECTION] isUsingFallback: ${isUsingFallback}`);\r\n    \r\n    // Add more debug logs to check actual WebSocket readyState\r\n    if (window && window.WebSocket) {\r\n      // debugLog(`MBA3210: [MY CONNECTION] WebSocket readyState constants: CONNECTING=${WebSocket.CONNECTING}, OPEN=${WebSocket.OPEN}, CLOSING=${WebSocket.CLOSING}, CLOSED=${WebSocket.CLOSED}`);\r\n    }\r\n    \r\n    // Only log status changes but don't trigger fetches here - that's handled in the mount effect\r\n    if ((connectionStatus === 'connected' && isConnected) || isUsingFallback) {\r\n      debugLog('MBA3210: [MY CONNECTION] Connection fully verified as connected or using fallback');\r\n    } else {\r\n      debugLog('MBA3210: [MY CONNECTION] Connection not fully verified, status and state mismatch');\r\n      // debugLog(`MBA3210: [MY CONNECTION] Details - status: ${connectionStatus}, isConnected: ${isConnected}`);\r\n    }\r\n  }, [connectionStatus, isConnected, isUsingFallback]);\r\n  \r\n  // Force reconnection on component mount to ensure connection\r\n  useEffect(() => {\r\n    // Short delay to allow other initializations to complete\r\n    const timer = setTimeout(() => {\r\n      debugLog('MBA3210: [MY CONNECTION] Forcing reconnection on component mount');\r\n      if (typeof reconnect === 'function') {\r\n        reconnect();\r\n      }\r\n    }, 1000);\r\n    \r\n    return () => clearTimeout(timer);\r\n  }, [reconnect]);\r\n  \r\n  // Remove the problematic effect and instead add a proper mount effect to load initial data\r\n  useEffect(() => {\r\n    if (!initialLoadRef.current) return; // Skip if not initial load\r\n\r\n    debugLog('MBA3210: Component mounted - initializing data');\r\n    \r\n    const initializeData = async () => {\r\n      try {\r\n        // Reset states\r\n        setConversations([]);\r\n        setMessages([]);\r\n        setSelectedConversation(null);\r\n        setSelectedConversationData(null);\r\n        setIsLoadingConversations(true);\r\n        setIsLoadingMessages(false);\r\n        setCurrentPage(1);\r\n        setHasMore(true);\r\n        lastViewedConversationRef.current = null;\r\n\r\n        // Handle URL parameters on web\r\n        if (Platform.OS === 'web') {\r\n          const currentUrl = new URL(window.location.href);\r\n          const urlConversationId = currentUrl.searchParams.get('conversationId');\r\n          \r\n          // Clear URL parameters\r\n          if (currentUrl.searchParams.has('conversationId')) {\r\n            currentUrl.searchParams.delete('conversationId');\r\n            window.history.replaceState({}, '', currentUrl.toString());\r\n            debugLog('MBA3210: Cleared URL parameters on initial load');\r\n          }\r\n\r\n          // If we have a conversation ID in URL, we'll use that instead of auto-selecting\r\n          if (urlConversationId) {\r\n            const conversationsData = await fetchConversations();\r\n            setSelectedConversation(urlConversationId);\r\n            return;\r\n          }\r\n        }\r\n\r\n        // If we have route params on initial load, handle them here\r\n        if (route.params?.conversationId) {\r\n          isHandlingRouteParamsRef.current = true;\r\n          \r\n          // Check if we should open booking creation (coming from Connections)\r\n          if (route.params.isProfessional === true) {\r\n            shouldOpenBookingCreationRef.current = true;\r\n            debugLog('MBA3210: Will open booking creation after data loads');\r\n          }\r\n          \r\n          const conversationsData = await fetchConversations();\r\n          setSelectedConversation(route.params.conversationId);\r\n          \r\n          navigation.setParams({ \r\n            messageId: null, \r\n            conversationId: null,\r\n            otherUserName: null,\r\n            isProfessional: null,\r\n            clientId: null\r\n          });\r\n          return;\r\n        }\r\n\r\n        // Normal initialization - only fetch conversations once\r\n        const conversationsData = await fetchConversations();\r\n        if (Platform.OS === 'web' && screenWidth > 900 && conversationsData?.length > 0) {\r\n          setSelectedConversation(conversationsData[0].conversation_id);\r\n        }\r\n      } catch (error) {\r\n        console.error('Error in initialization:', error);\r\n      } finally {\r\n        initialLoadRef.current = false;\r\n        setIsInitialLoad(false);\r\n        isHandlingRouteParamsRef.current = false;\r\n      }\r\n    };\r\n\r\n    initializeData();\r\n\r\n    return () => {\r\n      debugLog('MBA3210: Component unmounting - cleaning up');\r\n      \r\n      // No longer disconnect on component unmount\r\n      // This was causing message loss when switching tabs\r\n      \r\n      // Reset everything for future component mount\r\n      setConversations([]);\r\n      setMessages([]);\r\n      setSelectedConversation(null);\r\n      setSelectedConversationData(null);\r\n      initialLoadRef.current = true;\r\n      setIsInitialLoad(true);\r\n      isHandlingRouteParamsRef.current = false;\r\n      hasLoadedMessagesRef.current = false;\r\n      shouldOpenBookingCreationRef.current = false;\r\n      lastViewedConversationRef.current = null;\r\n      \r\n      // Clear the global selected conversation tracking\r\n      if (typeof window !== 'undefined') {\r\n        window.selectedConversationId = null;\r\n      }\r\n    };\r\n  }, []); // Empty dependency array means this runs once on mount\r\n  \r\n  // Modify route params effect to only handle non-reload cases\r\n  useEffect(() => {\r\n    // Skip if this is the initial load/reload or if we're already handling route params\r\n    if (initialLoadRef.current || isHandlingRouteParamsRef.current || !route.params?.conversationId) {\r\n      return;\r\n    }\r\n\r\n    if (is_DEBUG) {\r\n      console.log('MBA98765 Route params detected (non-reload):', {\r\n        messageId: route.params.messageId,\r\n        conversationId: route.params.conversationId,\r\n        otherUserName: route.params.otherUserName,\r\n        isProfessional: route.params.isProfessional,\r\n        clientId: route.params.clientId\r\n      });\r\n    }\r\n    \r\n    isHandlingRouteParamsRef.current = true;\r\n    \r\n    // Check if we should open booking creation (coming from Connections)\r\n    if (route.params.isProfessional === true) {\r\n      shouldOpenBookingCreationRef.current = true;\r\n      if (is_DEBUG) {\r\n        console.log('MBA98765 Will open booking creation after data loads');\r\n      }\r\n    }\r\n    \r\n    // Set the selected conversation and fetch data\r\n    setSelectedConversation(route.params.conversationId);\r\n    \r\n    // Reset pagination state\r\n    setCurrentPage(1);\r\n    setHasMore(true);\r\n    \r\n    // Fetch fresh conversations and messages\r\n    fetchConversations().then(() => {\r\n      isHandlingRouteParamsRef.current = false;\r\n    });\r\n    \r\n    // Clear the params to prevent re-fetching\r\n    navigation.setParams({ \r\n      messageId: null, \r\n      conversationId: null,\r\n      otherUserName: null,\r\n      isProfessional: null,\r\n      clientId: null\r\n    });\r\n  }, [route.params]);\r\n\r\n  // Effect to trigger booking creation once conversation data is loaded\r\n  useEffect(() => {\r\n    // Only run if we should open booking creation, have conversation data, and messages are loaded\r\n    if (shouldOpenBookingCreationRef.current && selectedConversationData && hasLoadedMessagesRef.current) {\r\n      if (is_DEBUG) {\r\n        console.log('MBA98765 Conversation data and messages loaded, triggering booking creation', {\r\n          conversationId: selectedConversationData.conversation_id,\r\n          isProfessional: selectedConversationData.is_professional,\r\n          hasDraft: hasDraft,\r\n          draftData: draftData ? 'exists' : 'none'\r\n        });\r\n      }\r\n      \r\n      // Reset the flag to prevent re-triggering\r\n      shouldOpenBookingCreationRef.current = false;\r\n      \r\n      // Add a small delay to ensure everything is properly loaded\r\n      setTimeout(() => {\r\n        handleCreateBooking();\r\n      }, 300);\r\n    }\r\n  }, [selectedConversationData, hasLoadedMessagesRef.current, hasDraft, draftData]);\r\n\r\n  // Keep the conversation selection effect but remove message fetching\r\n  useEffect(() => {\r\n    if (!selectedConversation || isInitialLoad) {\r\n      if (is_DEBUG) {\r\n        console.log('MBA98765 Skipping conversation data update - initial load or no conversation');\r\n      }\r\n      return;\r\n    }\r\n\r\n    // Skip redundant updates if we're already viewing this conversation\r\n    if (lastViewedConversationRef.current === selectedConversation) {\r\n      if (is_DEBUG) {\r\n        console.log('MBA98765 Skipping redundant conversation update - already viewing this conversation');\r\n      }\r\n      return;\r\n    }\r\n\r\n    if (is_DEBUG) {\r\n      console.log('MBA98765 Selected conversation changed:', {\r\n        id: selectedConversation,\r\n        type: typeof selectedConversation,\r\n        isHandlingRouteParams: isHandlingRouteParamsRef.current\r\n      });\r\n    }\r\n\r\n    // Update global tracking of selected conversation\r\n    if (typeof window !== 'undefined') {\r\n      window.selectedConversationId = selectedConversation;\r\n      debugLog(`MBA4321: Updated global selectedConversationId to ${selectedConversation}`);\r\n    }\r\n\r\n    // Find the conversation in our list\r\n    const conversation = conversations.find(conv => String(conv.conversation_id) === String(selectedConversation));\r\n    \r\n    if (conversation) {\r\n      debugLog(`MBA3210: [OTHER USER STATUS] Setting selected conversation to ${conversation.conversation_id} with user \"${conversation.other_user_name}\"`);\r\n      debugLog(`MBA3210: [OTHER USER STATUS] Initial online status for \"${conversation.other_user_name}\": ${conversation.other_participant_online ? 'ONLINE' : 'OFFLINE'}`);\r\n      \r\n      setSelectedConversationData(conversation);\r\n      \r\n      // Mark this conversation as read in the notification context\r\n      if (markConversationAsRead) {\r\n        debugLog(`MBA4321: Marking ONLY conversation ${selectedConversation} as read when selected`);\r\n        markConversationAsRead(selectedConversation);\r\n      }\r\n      \r\n      // Update URL on web platform\r\n      if (Platform.OS === 'web') {\r\n        const newUrl = new URL(window.location.href);\r\n        newUrl.searchParams.set('conversationId', selectedConversation);\r\n        window.history.replaceState({}, '', newUrl.toString());\r\n      }\r\n\r\n      // Reset pagination state\r\n      setCurrentPage(1);\r\n      setHasMore(true);\r\n      \r\n      // Reset message loading flag for new conversation\r\n      hasLoadedMessagesRef.current = false;\r\n      \r\n      // Update the last viewed conversation\r\n      lastViewedConversationRef.current = selectedConversation;\r\n    } else {\r\n      if (is_DEBUG) {\r\n        console.log('MBA98765 Could not find conversation data for ID:', selectedConversation);\r\n      }\r\n      debugLog(`MBA3210: [OTHER USER STATUS] Could not find conversation data for ID: ${selectedConversation}`);\r\n    }\r\n  }, [selectedConversation, conversations, isInitialLoad, markConversationAsRead]);\r\n\r\n  // Add cleanup when unmounting the component\r\n  useEffect(() => {\r\n    return () => {\r\n      // Clear the selected conversation tracking when unmounting\r\n      if (typeof window !== 'undefined') {\r\n        window.selectedConversationId = null;\r\n        debugLog('MBA4321: Cleared global selectedConversationId on unmount');\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  // Add dedicated effect for message fetching with optimizations\r\n  useEffect(() => {\r\n    if (!selectedConversation || isInitialLoad) {\r\n      return;\r\n    }\r\n\r\n    // Skip if we've already loaded messages for this conversation and nothing has changed\r\n    const hasSelectedConversationChanged = lastViewedConversationRef.current !== selectedConversation;\r\n    \r\n    if (!hasSelectedConversationChanged && hasLoadedMessagesRef.current) {\r\n      debugLog('MBA4321: Skipping message fetch - conversation unchanged and messages already loaded');\r\n      return;\r\n    }\r\n\r\n    if (is_DEBUG) {\r\n      console.log('MBA98765 Fetching messages for conversation:', {\r\n        id: selectedConversation,\r\n        hasLoaded: hasLoadedMessagesRef.current,\r\n        hasChanged: hasSelectedConversationChanged,\r\n        shouldOpenBookingCreation: shouldOpenBookingCreationRef.current\r\n      });\r\n    }\r\n\r\n    // Create a flag to track if this effect's async operation is still relevant\r\n    let isCurrentOperation = true;\r\n    \r\n    // Set loading flags\r\n    hasLoadedMessagesRef.current = true;\r\n    setIsLoadingMessages(true);\r\n    \r\n    // Fetch messages\r\n    fetchMessages(selectedConversation, 1)\r\n      .then(() => {\r\n        // Skip updates if component unmounted or conversation changed\r\n        if (!isCurrentOperation) return;\r\n        \r\n        setIsLoadingMessages(false);\r\n        \r\n        // After messages are loaded, if we need to open booking creation,\r\n        // we now have hasDraft and draftData set properly\r\n        if (shouldOpenBookingCreationRef.current && selectedConversationData) {\r\n          if (is_DEBUG) {\r\n            console.log('MBA98765 Messages loaded, now draft data is available');\r\n          }\r\n        }\r\n        \r\n        // Mark this specific conversation's notifications as read \r\n        // We do this here after successful message fetch to ensure it actually happened\r\n        if (markConversationAsRead && hasSelectedConversationChanged) {\r\n          debugLog(`MBA4321: Marking conversation ${selectedConversation} as read after successful message fetch`);\r\n          markConversationAsRead(selectedConversation);\r\n        }\r\n        \r\n        // Force a rerender to fix scrolling issues\r\n        setForceRerender(prev => prev + 1);\r\n      })\r\n      .catch(error => {\r\n        if (!isCurrentOperation) return;\r\n        setIsLoadingMessages(false);\r\n        console.error('Error fetching messages:', error);\r\n      });\r\n    \r\n    // Cleanup function\r\n    return () => {\r\n      isCurrentOperation = false;\r\n    };\r\n  }, [selectedConversation, isInitialLoad, markConversationAsRead]);\r\n\r\n  // Modify existing screen width effect\r\n  useEffect(() => {\r\n    const prevWidth = prevScreenWidthRef.current;\r\n    const hasWidthCrossedThreshold = \r\n      (prevWidth <= 900 && screenWidth > 900) || \r\n      (prevWidth > 900 && screenWidth <= 900);\r\n\r\n    if (is_DEBUG) {\r\n      console.log('MBA98765 Screen width change:', {\r\n        prev: prevWidth,\r\n        current: screenWidth,\r\n        crossedThreshold: hasWidthCrossedThreshold\r\n      });\r\n    }\r\n\r\n    prevScreenWidthRef.current = screenWidth;\r\n\r\n    // Only handle width threshold crossing\r\n    if (hasWidthCrossedThreshold) {\r\n      if (screenWidth > 900 && conversations.length > 0 && !selectedConversation) {\r\n        if (is_DEBUG) {\r\n          console.log('MBA98765 Auto-selecting first conversation on width change');\r\n        }\r\n        setSelectedConversation(conversations[0].conversation_id);\r\n      }\r\n    }\r\n  }, [screenWidth]);\r\n\r\n  // Update conversations list when main conversation list or search query changes\r\n  useEffect(() => {\r\n    if (searchQuery.trim() === '') {\r\n      setFilteredConversations(conversations);\r\n    } else {\r\n      const lowercaseQuery = searchQuery.trim().toLowerCase();\r\n      const filtered = conversations.filter(conv => \r\n        conv.other_user_name && conv.other_user_name.toLowerCase().includes(lowercaseQuery)\r\n      );\r\n      setFilteredConversations(filtered);\r\n    }\r\n  }, [conversations, searchQuery]);\r\n\r\n  // Modify fetchConversations to update filtered conversations\r\n  const fetchConversations = async () => {\r\n    try {\r\n      // Don't reload if already loading or if conversations are already loaded and this isn't initialization\r\n      if (isLoadingConversations && conversations.length > 0 && !initialLoadRef.current) {\r\n        debugLog('MBA3210: [OTHER USERS STATUS] Skipping duplicate conversation fetch - already loading');\r\n        return conversations;\r\n      }\r\n      \r\n      setIsLoadingConversations(true);\r\n      debugLog('MBA3210: [OTHER USERS STATUS] Starting to fetch conversations with online status data');\r\n\r\n      const token = await getStorage('userToken');\r\n      const requestUrl = `${API_BASE_URL}/api/conversations/v1/`;\r\n      \r\n      debugLog('MBA3210: [OTHER USERS STATUS] Making API request to get conversations with online statuses');\r\n      const response = await axios.get(requestUrl, {\r\n        headers: { \r\n          Authorization: `Bearer ${token}`,\r\n          'Content-Type': 'application/json'\r\n        }\r\n      });\r\n      \r\n      if (response.data && Array.isArray(response.data)) {\r\n        // Add default false value for other_participant_online if not present\r\n        const conversationsWithOnlineStatus = response.data.map(conv => ({\r\n          ...conv,\r\n          other_participant_online: conv.other_participant_online || false\r\n        }));\r\n        \r\n        // Log each conversation's online status for debugging\r\n        conversationsWithOnlineStatus.forEach(conv => {\r\n          const otherUserName = conv.other_user_name || 'Unknown';\r\n          debugLog(`MBA3210: [OTHER USERS STATUS] User \"${otherUserName}\" (conversation ${conv.conversation_id}) online status: ${conv.other_participant_online ? 'ONLINE' : 'OFFLINE'}`);\r\n        });\r\n        \r\n        debugLog(`MBA3210: [OTHER USERS STATUS] Fetched ${conversationsWithOnlineStatus.length} conversations with online status data`);\r\n        \r\n        setConversations(conversationsWithOnlineStatus);\r\n        setFilteredConversations(conversationsWithOnlineStatus); // Update filtered conversations too\r\n        return conversationsWithOnlineStatus;\r\n      }\r\n      return [];\r\n    } catch (error) {\r\n      console.error('Error fetching conversations:', error);\r\n      debugLog(`MBA3210: [OTHER USERS STATUS] Error fetching conversation status data: ${error.message}`);\r\n      return [];\r\n    } finally {\r\n      setIsLoadingConversations(false);\r\n    }\r\n  };\r\n\r\n  // Modify fetchMessages to handle pagination better and prevent duplicate requests\r\n  const fetchMessages = async (conversationId, page = 1) => {\r\n    try {\r\n      // Skip if we've already processed this page for the current conversation\r\n      const pageKey = `${conversationId}-${page}`;\r\n      if (processedPagesRef.current.has(pageKey) && page > 1) {\r\n        debugLog(`MBA4321: Skipping duplicate fetch for page ${page} of conversation ${conversationId}`);\r\n        return;\r\n      }\r\n      \r\n      if (page === 1) {\r\n        setIsLoadingMessages(true);\r\n        // Reset messages when fetching first page\r\n        setMessages([]);\r\n        // Clear processed pages and message IDs when starting fresh\r\n        processedPagesRef.current.clear();\r\n        messageIdsRef.current.clear();\r\n      } else {\r\n        // Set the loading ref first to block concurrent requests\r\n        if (isLoadingMoreRef.current) {\r\n          debugLog(`MBA4321: Already loading more messages, skipping request for page ${page}`);\r\n          return;\r\n        }\r\n        \r\n        // Mark that we're loading more\r\n        isLoadingMoreRef.current = true;\r\n        setIsLoadingMore(true);\r\n      }\r\n      \r\n      // Mark this page as being processed\r\n      processedPagesRef.current.add(pageKey);\r\n      \r\n      const token = await getStorage('userToken');\r\n      \r\n      const url = `${API_BASE_URL}/api/messages/v1/conversation/${conversationId}/?page=${page}`;\r\n      debugLog(`MBA4321: Fetching messages for conversation ${conversationId}, page ${page}`);\r\n\r\n      const response = await axios.get(url, {\r\n        headers: { \r\n          Authorization: `Bearer ${token}`,\r\n          'Content-Type': 'application/json'\r\n        }\r\n      });\r\n      \r\n      // Process messages to remove duplicates\r\n      const newMessages = response.data.messages || [];\r\n      const uniqueMessages = newMessages.filter(msg => {\r\n        // Skip messages we already have\r\n        if (msg.message_id && messageIdsRef.current.has(msg.message_id)) {\r\n          debugLog(`MBA4321: Skipping duplicate message ${msg.message_id}`);\r\n          return false;\r\n        }\r\n        \r\n        // Add to our set of seen message IDs\r\n        if (msg.message_id) {\r\n          messageIdsRef.current.add(msg.message_id);\r\n        }\r\n        \r\n        return true;\r\n      });\r\n      \r\n      debugLog(`MBA4321: Received ${newMessages.length} messages, ${uniqueMessages.length} unique for page ${page}`);\r\n      \r\n      // Update the messages state based on the page\r\n      if (page === 1) {\r\n        setMessages(uniqueMessages);\r\n        // Set draft data only on first page load\r\n        setHasDraft(response.data.has_draft || false);\r\n        setDraftData(response.data.draft_data || null);\r\n        \r\n        // Force a rerender after setting messages to fix scroll issues\r\n        setTimeout(() => {\r\n          setForceRerender(prev => prev + 1);\r\n        }, 100);\r\n      } else {\r\n        setMessages(prev => {\r\n          // Create a set of existing message IDs for quick lookups\r\n          const existingIds = new Set(prev.map(m => m.message_id).filter(Boolean));\r\n          \r\n          // Only add messages we don't already have\r\n          const messagesToAdd = uniqueMessages.filter(msg => \r\n            !msg.message_id || !existingIds.has(msg.message_id)\r\n          );\r\n          \r\n          debugLog(`MBA4321: Adding ${messagesToAdd.length} unique messages to existing ${prev.length} messages`);\r\n          \r\n          return [...prev, ...messagesToAdd];\r\n        });\r\n      }\r\n      \r\n      // Update pagination state\r\n      setHasMore(response.data.has_more);\r\n      setCurrentPage(page);\r\n\r\n    } catch (error) {\r\n      debugLog('MBABOSS [ERROR] Error in fetchMessages:', {\r\n        message: error.message,\r\n        response: error.response?.data,\r\n        status: error.response?.status,\r\n        url: error.config?.url,\r\n        method: error.config?.method\r\n      });\r\n    } finally {\r\n      setIsLoadingMessages(false);\r\n      setIsLoadingMore(false);\r\n      // Reset the loading ref after a short delay to prevent rapid consecutive calls\r\n      setTimeout(() => {\r\n        isLoadingMoreRef.current = false;\r\n      }, 300);\r\n    }\r\n  };\r\n\r\n  // Function to send a message\r\n  const SendNormalMessage = async (messageContent) => {\r\n    try {\r\n      const token = await getStorage('userToken');\r\n      const response = await axios.post(`${API_BASE_URL}/api/messages/v1/send_norm_message/`, {\r\n        conversation_id: selectedConversation,\r\n        content: messageContent\r\n      }, {\r\n        headers: { \r\n          Authorization: `Bearer ${token}`,\r\n          'Content-Type': 'application/json'\r\n        }\r\n      });\r\n\r\n      // Add new message to the beginning of the list since FlatList is inverted\r\n      setMessages(prevMessages => [response.data, ...prevMessages]);\r\n\r\n      // Update conversation's last message\r\n      setConversations(prev => prev.map(conv => \r\n        conv.conversation_id === selectedConversation \r\n          ? {\r\n              ...conv,\r\n              last_message: messageContent,\r\n              last_message_time: response.data.timestamp\r\n            }\r\n          : conv\r\n      ));\r\n\r\n      return response.data;\r\n    } catch (error) {\r\n      console.error('Error sending message:', error);\r\n      throw error;\r\n    }\r\n  };\r\n\r\n  // Update the handleCreateBooking function\r\n  const handleCreateBooking = async () => {\r\n    if (is_DEBUG) {\r\n      console.log('MBA98765 handleCreateBooking:', {\r\n        selectedConversationData,\r\n        selectedConversation,\r\n        isProfessional: selectedConversationData?.is_professional,\r\n        hasDraft,\r\n        draftData\r\n      });\r\n    }\r\n    \r\n    if (!selectedConversationData) {\r\n      console.log('MBA98765 No conversation data found, refreshing conversations');\r\n      await fetchConversations();\r\n      const updatedConversation = conversations.find(conv => conv.conversation_id === selectedConversation);\r\n      if (!updatedConversation) {\r\n        console.log('MBA98765 Still no conversation data after refresh');\r\n        return;\r\n      }\r\n      setSelectedConversationData(updatedConversation);\r\n      if (is_DEBUG) {\r\n        console.log('MBA98765 Updated conversation data:', updatedConversation);\r\n      }\r\n    }\r\n\r\n    // Check if current user is the professional by checking their role in the conversation\r\n    const isProfessional = selectedConversationData.is_professional === true;\r\n    \r\n    if (is_DEBUG) {\r\n      console.log('MBA98765 Is Professional?', isProfessional);\r\n    }\r\n\r\n    setShowDropdown(false); // Close dropdown first to prevent any UI issues\r\n\r\n    if (isProfessional) {\r\n      if (is_DEBUG) {\r\n        console.log('MBA98765 User is professional - checking for existing draft', { hasDraft, draftData });\r\n      }\r\n\r\n      if (hasDraft && draftData) {\r\n        // Show the draft confirmation modal\r\n        setShowDraftConfirmModal(true);\r\n      } else {\r\n        // No existing draft, create new one\r\n        await createNewDraft();\r\n      }\r\n    } else {\r\n      console.log('MBA98765 User is owner - showing request modal');\r\n      setShowRequestModal(true);\r\n    }\r\n  };\r\n\r\n  // Helper function to create a new draft\r\n  const createNewDraft = async () => {\r\n    try {\r\n      const token = await getStorage('userToken');\r\n      const response = await axios.post(\r\n        `${API_BASE_URL}/api/bookings/v1/create/`,\r\n        {\r\n          conversation_id: selectedConversation\r\n        },\r\n        {\r\n          headers: {\r\n            Authorization: `Bearer ${token}`,\r\n            'Content-Type': 'application/json'\r\n          }\r\n        }\r\n      );\r\n\r\n      if (is_DEBUG) {\r\n        console.log('MBA98765 Create draft response:', response.data);\r\n      }\r\n\r\n      // Refresh messages to update draft status\r\n      await fetchMessages(selectedConversation, 1);\r\n\r\n      // Open BookingStepModal with new draft\r\n      if (response.data.draft_id) {\r\n        setCurrentBookingId(response.data.draft_id);\r\n        setTimeout(() => {\r\n          setShowBookingStepModal(true);\r\n        }, 100);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error creating draft:', error);\r\n      Alert.alert('Error', 'Unable to create draft. Please try again.');\r\n    }\r\n  };\r\n\r\n  // Add the handleContinueExisting function\r\n  const handleContinueExisting = () => {\r\n    if (is_DEBUG) {\r\n      console.log('MBA98765 handleContinueExisting:', {\r\n        draftData,\r\n        showDraftConfirmModal,\r\n        showBookingStepModal\r\n      });\r\n    }\r\n\r\n    setShowDraftConfirmModal(false);\r\n    \r\n    // Use draft_id instead of booking_id\r\n    if (draftData?.draft_id) {\r\n      setCurrentBookingId(draftData.draft_id);\r\n      // Add a small delay to ensure modal state is updated\r\n      setTimeout(() => {\r\n        if (is_DEBUG) {\r\n          console.log('MBA98765 Opening BookingStepModal with draft:', draftData.draft_id);\r\n        }\r\n        setShowBookingStepModal(true);\r\n      }, 100);\r\n    } else {\r\n      console.error('MBA98765 No draft_id found in draftData:', draftData);\r\n    }\r\n  };\r\n\r\n  // Add the handleCreateNew function\r\n  const handleCreateNew = async () => {\r\n    setShowDraftConfirmModal(false);\r\n    await createNewDraft();\r\n  };\r\n\r\n  // Update loadMoreMessages to check current state before loading\r\n  const loadMoreMessages = useCallback(() => {\r\n    if (is_DEBUG) {\r\n      console.log('MBA98765 loadMoreMessages called:', {\r\n        hasMore,\r\n        isLoadingMore,\r\n        isLoadingMoreRef: isLoadingMoreRef.current,\r\n        currentPage,\r\n        selectedConversation\r\n      });\r\n    }\r\n    \r\n    if (hasMore && !isLoadingMoreRef.current && selectedConversation) {\r\n      debugLog(`MBA4321: Loading more messages for page ${currentPage + 1}`);\r\n      fetchMessages(selectedConversation, currentPage + 1);\r\n    }\r\n  }, [hasMore, currentPage, selectedConversation]);\r\n\r\n  const renderMessage = useCallback(({ item }) => {\r\n    // Create a map to keep track of which bookings have change requests and latest message timestamps\r\n    const bookingMessages = groupMessagesByBookingId(messages);\r\n    \r\n    // Track bookings that have been confirmed\r\n    const confirmedBookingIds = messages\r\n      .filter(m => m.type_of_message === 'booking_confirmed')\r\n      .map(m => m.metadata?.booking_id)\r\n      .filter(Boolean);\r\n    \r\n    // Find approval requests for already confirmed bookings\r\n    const bookingsWithUpdates = {};\r\n    \r\n    // For each confirmed booking, check if there are newer approval requests\r\n    confirmedBookingIds.forEach(bookingId => {\r\n      const messagesForBooking = messages.filter(m => \r\n        m.metadata?.booking_id === bookingId\r\n      ).sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));\r\n      \r\n      // Find the confirmation message for this booking\r\n      const confirmationMessage = messagesForBooking.find(m => \r\n        m.type_of_message === 'booking_confirmed'\r\n      );\r\n      \r\n      // Find any newer approval request messages for this booking\r\n      if (confirmationMessage) {\r\n        const confirmationTime = new Date(confirmationMessage.timestamp);\r\n        const newerApprovalRequests = messagesForBooking.filter(m => \r\n          m.type_of_message === 'send_approved_message' && \r\n          new Date(m.timestamp) > confirmationTime\r\n        );\r\n        \r\n        // If we found newer approval requests, mark this booking as having updates\r\n        if (newerApprovalRequests.length > 0) {\r\n          bookingsWithUpdates[bookingId] = true;\r\n          debugLog('MBA6428: Detected booking update for confirmed booking:', {\r\n            bookingId,\r\n            confirmationTime,\r\n            newerApprovalRequests: newerApprovalRequests.map(m => m.message_id)\r\n          });\r\n        }\r\n      }\r\n    });\r\n    \r\n    const hasChangeRequest = item.metadata?.booking_id && \r\n      messages.some(m => \r\n        m.type_of_message === 'request_changes' && \r\n        m.metadata?.booking_id === item.metadata.booking_id\r\n      );\r\n    \r\n    // Determine if booking is confirmed\r\n    const bookingIsConfirmed = item.metadata?.booking_id && \r\n      confirmedBookingIds.includes(item.metadata.booking_id);\r\n      \r\n    // Check if this confirmed booking has newer approval requests\r\n    const hasNewerApprovalRequests = item.metadata?.booking_id && \r\n      bookingsWithUpdates[item.metadata.booking_id];\r\n    \r\n    // Determine if this is the newest message for this booking\r\n    let isNewestMessage = false;\r\n    let messageCreatedAt = new Date(item.created_at || item.timestamp);\r\n    \r\n    if (item.metadata?.booking_id && bookingMessages[item.metadata.booking_id]) {\r\n      const bookingMessagesList = bookingMessages[item.metadata.booking_id];\r\n      \r\n      // Check if this is the newest message for this booking\r\n      isNewestMessage = bookingMessagesList.length > 0 && \r\n        bookingMessagesList[0].messageId === item.message_id;\r\n      \r\n      debugLog(`MBA7321: Message ${item.message_id} for booking ${item.metadata.booking_id} isNewestMessage: ${isNewestMessage}`);\r\n    }\r\n\r\n    if (item.type_of_message === 'initial_booking_request' || item.type_of_message === 'send_approved_message') {\r\n      const isFromMe = !item.sent_by_other_user;\r\n\r\n      // Determine if this booking has an associated change request\r\n      const bookingId = item.metadata?.booking_id;\r\n      const hasAssociatedChangeRequest = bookingId && messages.some(m => \r\n        m.type_of_message === 'request_changes' && \r\n        m.metadata?.booking_id === bookingId\r\n      );\r\n\r\n      // Check if this is an approval request message\r\n      const isApprovalMessage = item.type_of_message === 'send_approved_message';\r\n      \r\n      // Get booking status from metadata\r\n      const bookingStatus = bookingIsConfirmed ? \"Confirmed\" : item.metadata?.booking_status;\r\n      \r\n      // For approval requests: determine if this is for an already confirmed booking\r\n      // by checking if there's a booking_confirmed message with an earlier timestamp\r\n      const isUpdateToConfirmedBooking = isApprovalMessage && bookingIsConfirmed && bookingId && \r\n        messages.some(m => \r\n          m.type_of_message === 'booking_confirmed' && \r\n          m.metadata?.booking_id === bookingId &&\r\n          new Date(m.timestamp) < new Date(item.timestamp)\r\n        );\r\n      \r\n      // Check if there are newer request changes messages for this booking update\r\n      const hasNewerRequestChanges = isUpdateToConfirmedBooking && bookingId &&\r\n        messages.some(m =>\r\n          m.type_of_message === 'request_changes' &&\r\n          m.metadata?.booking_id === bookingId &&\r\n          new Date(m.timestamp) > new Date(item.timestamp)\r\n        );\r\n      \r\n      // Log info if this is an update to a confirmed booking\r\n      if (isUpdateToConfirmedBooking) {\r\n        debugLog('MBA6428: Detected approval request for already confirmed booking:', {\r\n          messageId: item.message_id,\r\n          bookingId,\r\n          isApprovalMessage,\r\n          bookingIsConfirmed,\r\n          isUpdateToConfirmedBooking,\r\n          hasNewerRequestChanges\r\n        });\r\n      }\r\n      \r\n      // Check if the pro should be able to edit the draft\r\n      const showEditDraft = selectedConversationData?.is_professional && \r\n        (item.type_of_message === 'initial_booking_request' || \r\n         (item.type_of_message === 'send_approved_message' && hasAssociatedChangeRequest));\r\n\r\n      // This is for logging purposes\r\n      if (showEditDraft) {\r\n        debugLog('MBA6428: Showing edit draft button for message:', {\r\n          messageId: item.message_id,\r\n          bookingId: bookingId,\r\n          type: item.type_of_message\r\n        });\r\n      }\r\n\r\n      // Get total owner cost\r\n      let totalOwnerCost = '0.00';\r\n      try {\r\n        if (item.metadata.cost_summary && item.metadata.cost_summary.total_client_cost) {\r\n          totalOwnerCost = item.metadata.cost_summary.total_client_cost;\r\n        }\r\n      } catch (error) {\r\n        console.error('Error parsing total cost:', error);\r\n      }\r\n\r\n      return (\r\n        <BookingMessageCard\r\n          type={item.type_of_message === 'initial_booking_request' ? 'request' : 'approval'}\r\n          displayType={isUpdateToConfirmedBooking ? 'booking_update' : undefined}\r\n          data={{\r\n            ...item.metadata,\r\n            booking_id: item.metadata.booking_id,\r\n            service_type: item.metadata.service_type,\r\n            total_owner_cost: totalOwnerCost,\r\n            occurrences: item.metadata.occurrences || []\r\n          }}\r\n          isFromMe={isFromMe}\r\n          onPress={() => {\r\n            // Navigate to booking details if we have a booking_id\r\n            if (item.metadata.booking_id) {\r\n              navigation.navigate('BookingDetails', { \r\n                bookingId: item.metadata.booking_id,\r\n                from: 'MessageHistory'\r\n              });\r\n            }\r\n          }}\r\n          isProfessional={selectedConversationData?.is_professional}\r\n          onApproveSuccess={(response) => {\r\n            // Update the messages list to reflect the approval\r\n            // You would typically update the booking status here\r\n            if (response && response.status) {\r\n              Alert.alert('Success', 'Booking approved successfully');\r\n              // Refresh messages to update the UI\r\n              fetchMessages(selectedConversation, 1);\r\n            }\r\n          }}\r\n          onApproveError={(error) => {\r\n            Alert.alert('Error', error || 'Failed to approve booking');\r\n          }}\r\n          onEditDraft={showEditDraft ? () => {\r\n            debugLog('MBA6428: Edit Draft button clicked, calling handleEditDraft with bookingId:', bookingId);\r\n            handleEditDraft(bookingId);\r\n          } : undefined}\r\n          bookingStatus={bookingStatus}\r\n          hasChangeRequest={hasAssociatedChangeRequest || hasNewerRequestChanges}\r\n          isNewestMessage={isNewestMessage}\r\n          messageCreatedAt={messageCreatedAt}\r\n          isAfterConfirmation={isUpdateToConfirmedBooking}\r\n        />\r\n      );\r\n    }\r\n\r\n    if (item.type_of_message === 'request_changes') {\r\n      const isFromMe = !item.sent_by_other_user;\r\n      \r\n      // Get booking details from metadata\r\n      const bookingId = item.metadata?.booking_id;\r\n      const serviceType = item.metadata?.service_type;\r\n      const bookingStatus = bookingIsConfirmed ? \"Confirmed\" : item.metadata?.booking_status;\r\n      \r\n      // For a request_changes message, it should be considered the newest if:\r\n      // 1. It's the most recent message for this booking (already calculated)\r\n      // 2. OR there are no newer approval requests for this booking after this request_changes message\r\n      let isNewestChangeRequest = isNewestMessage;\r\n      \r\n      if (!isNewestChangeRequest && item.type_of_message === 'request_changes' && bookingId) {\r\n        // Check if there are any newer approval messages\r\n        const hasNewerApprovalMessages = messages.some(m => \r\n          m.type_of_message === 'send_approved_message' && \r\n          m.metadata?.booking_id === bookingId &&\r\n          new Date(m.timestamp) > new Date(item.timestamp)\r\n        );\r\n        \r\n        // If there are no newer approval messages, this can be treated as the newest message\r\n        isNewestChangeRequest = !hasNewerApprovalMessages;\r\n        \r\n        debugLog('MBA4321: Checking if request_changes is effectively newest:', {\r\n          messageId: item.message_id,\r\n          originalIsNewest: isNewestMessage,\r\n          hasNewerApprovals: hasNewerApprovalMessages,\r\n          effectivelyNewest: isNewestChangeRequest\r\n        });\r\n      }\r\n      \r\n      // Check if this change request is related to a booking update\r\n      // (i.e., an approval that came after a booking confirmation)\r\n      const isRelatedToUpdate = bookingIsConfirmed && bookingId &&\r\n        messages.some(m => \r\n          (m.type_of_message === 'send_approved_message' || m.type_of_message === 'booking_confirmed') &&\r\n          m.metadata?.booking_id === bookingId\r\n        );\r\n      \r\n      // Log for debugging\r\n      debugLog('MBA4321: Rendering change request message:', {\r\n        bookingId,\r\n        isFromMe,\r\n        content: item.content,\r\n        metadata: item.metadata,\r\n        isNewestMessage,\r\n        isNewestChangeRequest,\r\n        isConfirmed: bookingIsConfirmed,\r\n        isRelatedToUpdate,\r\n        hasOlderBookingConfirmedMessage: messages.some(m => \r\n          m.type_of_message === 'booking_confirmed' && \r\n          m.metadata?.booking_id === bookingId &&\r\n          new Date(m.timestamp) < new Date(item.timestamp)\r\n        ),\r\n        hasOlderApprovalMessage: messages.some(m => \r\n          m.type_of_message === 'send_approved_message' && \r\n          m.metadata?.booking_id === bookingId &&\r\n          new Date(m.timestamp) < new Date(item.timestamp)\r\n        )\r\n      });\r\n      \r\n      return (\r\n        <BookingMessageCard\r\n          type=\"request_changes\"\r\n          data={{\r\n            ...item.metadata,\r\n            booking_id: bookingId,\r\n            service_type: serviceType,\r\n            cost_summary: item.metadata?.cost_summary || {},\r\n            occurrences: item.metadata?.occurrences || [],\r\n            content: item.content // Include the message content for display\r\n          }}\r\n          isFromMe={isFromMe}\r\n          onPress={() => {\r\n            // Navigate to booking details if we have a booking_id\r\n            if (bookingId) {\r\n              navigation.navigate('BookingDetails', { \r\n                bookingId: bookingId,\r\n                from: 'MessageHistory'\r\n              });\r\n            }\r\n          }}\r\n          isProfessional={selectedConversationData?.is_professional}\r\n          onApproveSuccess={(response) => {\r\n            if (response && response.status) {\r\n              Alert.alert('Success', 'Changes handled successfully');\r\n              fetchMessages(selectedConversation, 1);\r\n            }\r\n          }}\r\n          onApproveError={(error) => {\r\n            Alert.alert('Error', error || 'Failed to process changes');\r\n          }}\r\n          onEditDraft={selectedConversationData?.is_professional ? () => {\r\n            handleEditDraft(bookingId);\r\n          } : undefined}\r\n          bookingStatus={bookingStatus}\r\n          hasChangeRequest={false} // Change requests don't have change requests themselves\r\n          isNewestMessage={isNewestChangeRequest} // Use enhanced newest message check\r\n          messageCreatedAt={messageCreatedAt}\r\n          isAfterConfirmation={isRelatedToUpdate} // Flag for change requests after an update\r\n        />\r\n      );\r\n    }\r\n\r\n    // Handle booking confirmation messages\r\n    if (item.type_of_message === 'booking_confirmed') {\r\n      const isFromMe = !item.sent_by_other_user;\r\n      \r\n      // Get booking details from metadata\r\n      const bookingId = item.metadata?.booking_id;\r\n      const serviceType = item.metadata?.service_type;\r\n      \r\n      // Get cost info from metadata\r\n      let totalCost = '0.00';\r\n      let payout = '0.00';\r\n      try {\r\n        if (item.metadata.cost_summary) {\r\n          totalCost = item.metadata.cost_summary.total_client_cost || '0.00';\r\n          payout = item.metadata.cost_summary.total_sitter_payout || '0.00';\r\n        }\r\n      } catch (error) {\r\n        console.error('Error parsing cost data:', error);\r\n      }\r\n      \r\n      debugLog('MBA6428: Rendering booking confirmation message:', {\r\n        bookingId,\r\n        isFromMe,\r\n        metadata: item.metadata,\r\n        totalCost,\r\n        payout,\r\n        hasNewerApprovalRequests\r\n      });\r\n      \r\n      return (\r\n        <BookingMessageCard\r\n          type=\"booking_confirmed\"\r\n          data={{\r\n            booking_id: bookingId,\r\n            service_type: serviceType,\r\n            cost_summary: {\r\n              total_client_cost: totalCost,\r\n              total_sitter_payout: payout\r\n            }\r\n          }}\r\n          isFromMe={isFromMe}\r\n          onPress={() => {\r\n            // Navigate to booking details if we have a booking_id\r\n            if (bookingId) {\r\n              navigation.navigate('BookingDetails', { \r\n                bookingId: bookingId,\r\n                from: 'MessageHistory'\r\n              });\r\n            }\r\n          }}\r\n          isProfessional={selectedConversationData?.is_professional}\r\n          bookingStatus=\"Confirmed\"\r\n          isNewestMessage={isNewestMessage}\r\n          messageCreatedAt={messageCreatedAt}\r\n          onEditDraft={selectedConversationData?.is_professional ? () => {\r\n            debugLog('MBA6428: Edit Draft button clicked for confirmed booking with bookingId:', bookingId);\r\n            handleEditDraft(bookingId);\r\n          } : undefined}\r\n          hasNewerApprovalRequests={hasNewerApprovalRequests}\r\n        />\r\n      );\r\n    }\r\n\r\n    // Handle normal messages\r\n    const isFromMe = !item.sent_by_other_user;\r\n    return (\r\n      <View style={isFromMe ? styles.sentMessageContainer : styles.receivedMessageContainer}>\r\n        <View style={[\r\n          styles.messageCard, \r\n          isFromMe ? styles.sentMessage : styles.receivedMessage\r\n        ]}>\r\n          <View style={styles.messageContent}>\r\n            <Text style={[\r\n              styles.messageText,\r\n              isFromMe ? styles.sentMessageText : styles.receivedMessageText\r\n            ]}>\r\n              {item.content}\r\n            </Text>\r\n          </View>\r\n        </View>\r\n      </View>\r\n    );\r\n  }, [navigation, selectedConversationData, timeSettings, hasDraft, draftData, selectedConversation, fetchMessages, messages]);\r\n\r\n  const WebInput = () => {\r\n    const [message, setMessage] = useState('');\r\n    const inputRef = useRef(null);\r\n    const isProcessingRef = useRef(false);\r\n\r\n    const adjustHeight = () => {\r\n      if (inputRef.current) {\r\n        // Store the current scroll position\r\n        const scrollTop = inputRef.current.scrollTop;\r\n        \r\n        // Reset height to recalculate\r\n        inputRef.current.style.height = 'inherit';\r\n        \r\n        // Set new height\r\n        const newHeight = Math.min(inputRef.current.scrollHeight, 120);\r\n        inputRef.current.style.height = `${newHeight}px`;\r\n        \r\n        // If we've hit max height, restore scroll position\r\n        if (inputRef.current.scrollHeight > 120) {\r\n          inputRef.current.scrollTop = scrollTop;\r\n        }\r\n      }\r\n    };\r\n\r\n    const handleChange = (e) => {\r\n      setMessage(e.target.value);\r\n      adjustHeight();\r\n    };\r\n\r\n    const handleSend = async () => {\r\n      // Prevent duplicate sends by checking if we're already sending\r\n      if (message.trim() && !isSending && !isProcessingRef.current) {\r\n        isProcessingRef.current = true;\r\n        setIsSending(true);\r\n        \r\n        try {\r\n          // Clear input right away before API call to prevent double-sending\r\n          const messageToSend = message.trim(); // Save message content\r\n          setMessage(''); // Clear input field\r\n          if (inputRef.current) {\r\n            inputRef.current.style.height = '24px';\r\n            inputRef.current.scrollTop = 0;\r\n          }\r\n          \r\n          // Generate a unique temporary ID for optimistic update\r\n          const tempId = `temp-${Date.now()}-${Math.random().toString(36).substring(2, 9)}`;\r\n          \r\n          // Optimistically add message to UI immediately\r\n          const optimisticMessage = {\r\n            message_id: tempId,\r\n            content: messageToSend,\r\n            timestamp: new Date().toISOString(),\r\n            status: 'sent',\r\n            type_of_message: 'normal_message',\r\n            is_clickable: false,\r\n            sent_by_other_user: false,\r\n            _isOptimistic: true // Flag to identify this as an optimistic update\r\n          };\r\n          \r\n          // Add to messages state\r\n          setMessages(prevMessages => {\r\n            // First check if we already have this message (prevent doubles)\r\n            const messageExists = prevMessages.some(msg => \r\n              msg._isOptimistic && msg.content === messageToSend\r\n            );\r\n            \r\n            if (messageExists) {\r\n              debugLog('MBA3210: Skipping duplicate optimistic message');\r\n              return prevMessages;\r\n            }\r\n            \r\n            return [optimisticMessage, ...prevMessages];\r\n          });\r\n          \r\n          // Actually send the message to the server\r\n          const sentMessage = await SendNormalMessage(messageToSend);\r\n          \r\n          // Replace optimistic message with actual one\r\n          setMessages(prevMessages => {\r\n            // Remove optimistic message and add real one, ensuring no duplicates\r\n            const filteredMessages = prevMessages.filter(msg => \r\n              // Keep all messages that are NOT our optimistic update\r\n              !(msg._isOptimistic && msg.content === messageToSend)\r\n            );\r\n            \r\n            // Check if the real message is already in the list\r\n            const realMessageExists = filteredMessages.some(msg => \r\n              msg.message_id && sentMessage.message_id && \r\n              String(msg.message_id) === String(sentMessage.message_id)\r\n            );\r\n            \r\n            if (realMessageExists) {\r\n              debugLog('MBA3210: Real message already exists, skipping');\r\n              return filteredMessages;\r\n            }\r\n            \r\n            // Add the real message\r\n            return [sentMessage, ...filteredMessages];\r\n          });\r\n        } catch (error) {\r\n          console.error('Failed to send message:', error);\r\n          \r\n          // Restore the message in the input field on error\r\n          setMessage(message);\r\n          \r\n          // Remove optimistic message on error\r\n          setMessages(prevMessages => \r\n            prevMessages.filter(msg => !msg._isOptimistic)\r\n          );\r\n          \r\n          // Show error\r\n          Alert.alert('Error', 'Failed to send message. Please try again.');\r\n        } finally {\r\n          setIsSending(false);\r\n          \r\n          // Add delay before allowing another send\r\n          setTimeout(() => {\r\n            isProcessingRef.current = false;\r\n          }, 300);\r\n        }\r\n      }\r\n    };\r\n\r\n    return (\r\n      <View style={styles.inputInnerContainer}>\r\n        <textarea\r\n          ref={inputRef}\r\n          style={styles.webInput}\r\n          placeholder=\"Type a message...\"\r\n          value={message}\r\n          onChange={handleChange}\r\n          onKeyPress={(e) => {\r\n            if (e.key === 'Enter' && !e.shiftKey) {\r\n              e.preventDefault();\r\n              handleSend();\r\n            }\r\n          }}\r\n          disabled={isSending}\r\n          rows={1}\r\n        />\r\n        <Button \r\n          mode=\"contained\" \r\n          onPress={handleSend} \r\n          disabled={isSending}\r\n          style={[styles.sendButton, screenWidth <= 600 && styles.sendButtonMobile]}\r\n        >\r\n          {isSending ? (\r\n            <ActivityIndicator color={theme.colors.whiteText} size=\"small\" />\r\n          ) : screenWidth <= 600 ? (\r\n            <MaterialCommunityIcons name=\"arrow-up\" size={16} color={theme.colors.whiteText} />\r\n          ) : (\r\n            'Send'\r\n          )}\r\n        </Button>\r\n      </View>\r\n    );\r\n  };\r\n\r\n  const MobileInput = () => {\r\n    const [message, setMessage] = useState('');\r\n    const inputRef = useRef(null);\r\n    const isProcessingRef = useRef(false);\r\n\r\n    const handleSend = async () => {\r\n      // Prevent duplicate sends by checking if we're already sending\r\n      if (message.trim() && !isSending && !isProcessingRef.current) {\r\n        isProcessingRef.current = true;\r\n        setIsSending(true);\r\n        \r\n        try {\r\n          // Clear input right away before API call to prevent double-sending\r\n          const messageToSend = message.trim(); // Save message content\r\n          setMessage(''); // Clear input field immediately\r\n          \r\n          // Generate a unique temporary ID for optimistic update\r\n          const tempId = `temp-${Date.now()}-${Math.random().toString(36).substring(2, 9)}`;\r\n          \r\n          // Optimistically add message to UI immediately\r\n          const optimisticMessage = {\r\n            message_id: tempId,\r\n            content: messageToSend,\r\n            timestamp: new Date().toISOString(),\r\n            status: 'sent',\r\n            type_of_message: 'normal_message',\r\n            is_clickable: false,\r\n            sent_by_other_user: false,\r\n            _isOptimistic: true // Flag to identify this as an optimistic update\r\n          };\r\n          \r\n          // Add to messages state\r\n          setMessages(prevMessages => {\r\n            // First check if we already have this message (prevent doubles)\r\n            const messageExists = prevMessages.some(msg => \r\n              msg._isOptimistic && msg.content === messageToSend\r\n            );\r\n            \r\n            if (messageExists) {\r\n              debugLog('MBA3210: Skipping duplicate optimistic message');\r\n              return prevMessages;\r\n            }\r\n            \r\n            return [optimisticMessage, ...prevMessages];\r\n          });\r\n          \r\n          // Actually send the message to the server\r\n          const sentMessage = await SendNormalMessage(messageToSend);\r\n          \r\n          // Replace optimistic message with actual one\r\n          setMessages(prevMessages => {\r\n            // Remove optimistic message and add real one, ensuring no duplicates\r\n            const filteredMessages = prevMessages.filter(msg => \r\n              // Keep all messages that are NOT our optimistic update\r\n              !(msg._isOptimistic && msg.content === messageToSend)\r\n            );\r\n            \r\n            // Check if the real message is already in the list\r\n            const realMessageExists = filteredMessages.some(msg => \r\n              msg.message_id && sentMessage.message_id && \r\n              String(msg.message_id) === String(sentMessage.message_id)\r\n            );\r\n            \r\n            if (realMessageExists) {\r\n              debugLog('MBA3210: Real message already exists, skipping');\r\n              return filteredMessages;\r\n            }\r\n            \r\n            // Add the real message\r\n            return [sentMessage, ...filteredMessages];\r\n          });\r\n        } catch (error) {\r\n          console.error('Failed to send message:', error);\r\n          \r\n          // Restore the message in the input field on error\r\n          setMessage(message);\r\n          \r\n          // Remove optimistic message on error\r\n          setMessages(prevMessages => \r\n            prevMessages.filter(msg => !msg._isOptimistic)\r\n          );\r\n          \r\n          // Show error\r\n          Alert.alert('Error', 'Failed to send message. Please try again.');\r\n        } finally {\r\n          setIsSending(false);\r\n          \r\n          // Add delay before allowing another send\r\n          setTimeout(() => {\r\n            isProcessingRef.current = false;\r\n          }, 300);\r\n        }\r\n      }\r\n    };\r\n\r\n    return (\r\n      <View style={styles.inputContainer}>\r\n        <TextInput\r\n          ref={inputRef}\r\n          style={styles.input}\r\n          placeholder=\"Type a message...\"\r\n          value={message}\r\n          onChangeText={setMessage}\r\n          multiline\r\n          blurOnSubmit={false}\r\n          editable={!isSending}\r\n        />\r\n        <Button \r\n          mode=\"contained\" \r\n          onPress={handleSend}\r\n          disabled={isSending}\r\n        >\r\n          {isSending ? (\r\n            <ActivityIndicator color={theme.colors.primary} size=\"small\" />\r\n          ) : (\r\n            'Send'\r\n          )}\r\n        </Button>\r\n      </View>\r\n    );\r\n  };\r\n\r\n  const MessageInput = Platform.OS === 'web' ? <WebInput /> : <MobileInput />;\r\n  \r\n  const handleBookingRequest = async (modalData) => {\r\n    try {\r\n      const token = await getStorage('userToken');\r\n      \r\n      // First, create the booking request\r\n      const bookingRequestResponse = await axios.post(\r\n        `${API_BASE_URL}/api/bookings/v1/request_booking/`,\r\n        modalData,\r\n        {\r\n          headers: {\r\n            Authorization: `Bearer ${token}`,\r\n            'Content-Type': 'application/json'\r\n          }\r\n        }\r\n      );\r\n\r\n      if (is_DEBUG) {\r\n        console.log('MBABOSS Created booking with ID:', bookingRequestResponse.data.booking_id);\r\n      }\r\n\r\n      // Then, send the booking request message with the booking ID\r\n      const messageResponse = await axios.post(\r\n        `${API_BASE_URL}/api/messages/v1/send_request_booking/`,\r\n        {\r\n          ...modalData,\r\n          booking_id: bookingRequestResponse.data.booking_id\r\n        },\r\n        {\r\n          headers: {\r\n            Authorization: `Bearer ${token}`,\r\n            'Content-Type': 'application/json'\r\n          }\r\n        }\r\n      );\r\n\r\n      if (is_DEBUG) {\r\n        console.log('Sent message response:', messageResponse.data);\r\n      }\r\n\r\n      // Add the new message to the messages list\r\n      setMessages(prevMessages => [messageResponse.data, ...prevMessages]);\r\n\r\n      setShowRequestModal(false);\r\n    } catch (error) {\r\n      console.error('Error creating booking:', error);\r\n      Alert.alert(\r\n        'Error',\r\n        'Unable to create booking. Please try again.',\r\n        [{ text: 'OK' }]\r\n      );\r\n    }\r\n  };\r\n\r\n  // Add search functionality\r\n  const handleSearch = (text) => {\r\n    setSearchQuery(text);\r\n    // Filtering is now handled by the useEffect defined above\r\n  };\r\n\r\n  // Update conversation list to include search\r\n  const renderConversationList = () => (\r\n    <View style={styles.conversationListContainer}>\r\n      <View style={styles.searchContainer}>\r\n        <View style={[\r\n          styles.searchInputContainer, \r\n          isSearchFocused && { borderColor: theme.colors.primary }\r\n        ]}>\r\n          <MaterialCommunityIcons \r\n            name=\"magnify\" \r\n            size={20} \r\n            color={theme.colors.placeholder}\r\n            style={styles.searchIcon}\r\n          />\r\n          <TextInput\r\n            style={styles.searchInput}\r\n            placeholder=\"Search conversations\"\r\n            placeholderTextColor={theme.colors.placeholder}\r\n            value={searchQuery}\r\n            onChangeText={handleSearch}\r\n            onFocus={() => setIsSearchFocused(true)}\r\n            onBlur={() => setIsSearchFocused(false)}\r\n          />\r\n          {searchQuery.length > 0 && (\r\n            <TouchableOpacity \r\n              style={styles.clearButton}\r\n              onPress={() => setSearchQuery('')}\r\n            >\r\n              <MaterialCommunityIcons \r\n                name=\"close-circle\" \r\n                size={16} \r\n                color={theme.colors.placeholder}\r\n              />\r\n            </TouchableOpacity>\r\n          )}\r\n        </View>\r\n      </View>\r\n      {filteredConversations.map((conv) => {\r\n        const otherParticipantName = conv.participant1_id === CURRENT_USER_ID ? \r\n          conv.participant2_name : conv.participant1_name;\r\n        \r\n        if (is_DEBUG) {\r\n          console.log('MBA98765 Rendering conversation item:', {\r\n            convId: conv.conversation_id,\r\n            convIdType: typeof conv.conversation_id,\r\n            selectedId: selectedConversation,\r\n            selectedIdType: typeof selectedConversation,\r\n            isSelected: String(conv.conversation_id) === String(selectedConversation)\r\n          });\r\n        }\r\n        \r\n        const isSelected = String(conv.conversation_id) === String(selectedConversation);\r\n          \r\n        // Get unread count for this conversation from MessageNotificationContext\r\n        const unreadCount = getConversationUnreadCount ? \r\n          getConversationUnreadCount(String(conv.conversation_id)) : 0;\r\n        \r\n        // Only log if there are unread messages to reduce noise in logs\r\n        if (unreadCount > 0) {\r\n          debugLog(`MBA4321: Conversation ${conv.conversation_id} has ${unreadCount} unread messages`);\r\n        }\r\n          \r\n        return (\r\n          <TouchableOpacity\r\n            key={conv.conversation_id}\r\n            style={[\r\n              styles.conversationItem,\r\n              isSelected && styles.selectedConversation\r\n            ]}\r\n            onPress={() => {\r\n              if (is_DEBUG) {\r\n                console.log('MBA98765 Setting selected conversation:', {\r\n                  id: conv.conversation_id,\r\n                  type: typeof conv.conversation_id\r\n                });\r\n              }\r\n              \r\n              // Set the selected conversation\r\n              setSelectedConversation(conv.conversation_id);\r\n              \r\n              // Mark this conversation as read when clicked\r\n              if (markConversationAsRead && unreadCount > 0) {\r\n                debugLog(`MBA4321: Explicitly marking ONLY conversation ${conv.conversation_id} as read when clicked`);\r\n                markConversationAsRead(conv.conversation_id);\r\n              }\r\n            }}\r\n          >\r\n            <View style={styles.conversationContent}>\r\n              <View style={styles.conversationHeader}>\r\n                <View style={{ flexDirection: 'row', alignItems: 'center', flex: 1 }}>\r\n                  <Text style={styles.conversationName}>\r\n                    {otherParticipantName || conv.name || conv.other_user_name || 'Unknown'}\r\n                  </Text>\r\n                </View>\r\n                \r\n                <Text style={styles.conversationTime}>\r\n                  {new Date(conv.last_message_time).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}\r\n                </Text>\r\n              </View>\r\n              <View style={styles.conversationLastMessageContainer}>\r\n                <Text \r\n                  style={[\r\n                    styles.conversationLastMessage,\r\n                    isSelected && styles.activeConversationText,\r\n                    (conv.unread || unreadCount > 0) && !isSelected && styles.unreadMessage\r\n                  ]} \r\n                  numberOfLines={1}\r\n                >\r\n                  {conv.last_message}\r\n                </Text>\r\n                \r\n                {/* Show unread count badge next to the last message */}\r\n                {unreadCount > 0 && !isSelected && (\r\n                  <View style={styles.unreadBadge}>\r\n                    <Text style={styles.unreadBadgeText}>{unreadCount}</Text>\r\n                  </View>\r\n                )}\r\n              </View>\r\n              {conv.bookingStatus && (\r\n                <View style={[\r\n                  styles.bookingStatusContainer,\r\n                  styles[`booking${conv.bookingStatus}Status`] || styles.bookingPendingStatus\r\n                ]}>\r\n                  <Text style={styles.bookingStatus}>\r\n                    {conv.bookingStatus}\r\n                  </Text>\r\n                </View>\r\n              )}\r\n            </View>\r\n          </TouchableOpacity>\r\n        );\r\n      })}\r\n    </View>\r\n  );\r\n\r\n  // Update message header to include profile photo and edit draft button\r\n  const renderMessageHeader = () => (\r\n    <View style={styles.messageHeader}>\r\n      <View style={styles.messageHeaderContent}>\r\n        <Image\r\n          source={selectedConversationData?.profile_photo || require('../../assets/default-profile.png')}\r\n          style={styles.profilePhoto}\r\n        />\r\n        <Text style={styles.messageHeaderName}>\r\n          {selectedConversationData?.other_user_name}\r\n        </Text>\r\n        \r\n        {hasDraft && draftData?.draft_id && (\r\n          <TouchableOpacity \r\n            style={styles.editDraftButton}\r\n            onPress={() => {\r\n              if (draftData?.draft_id) {\r\n                handleOpenExistingDraft(draftData.draft_id);\r\n              }\r\n            }}\r\n          >\r\n            <MaterialCommunityIcons \r\n              name=\"pencil\" \r\n              size={20} \r\n              color={theme.colors.primary} \r\n            />\r\n            <Text style={styles.editDraftText}>Edit Draft</Text>\r\n          </TouchableOpacity>\r\n        )}\r\n      </View>\r\n    </View>\r\n  );\r\n\r\n  // Extract FlatList into a dedicated component\r\n  const MessageFlatList = React.memo(({ \r\n    messages, \r\n    renderMessage, \r\n    loadMoreMessages, \r\n    isLoadingMore, \r\n    hasMore, \r\n    forceRerender \r\n  }) => {\r\n    return (\r\n      <FlatList\r\n        data={messages}\r\n        renderItem={renderMessage}\r\n        keyExtractor={item => {\r\n          // Prioritize message_id if available\r\n          if (item.message_id) {\r\n            return `message-${item.message_id}`;\r\n          }\r\n          \r\n          // Create a more robust fallback key using multiple properties\r\n          const timestamp = item.timestamp || item.created_at || Date.now();\r\n          const senderHash = item.sent_by_other_user ? 'other' : 'self';\r\n          const contentHash = item.content ? \r\n            `${item.content.substring(0, 10)}-${item.content.length}` : \r\n            'no-content';\r\n          const typeHash = item.type_of_message || 'normal';\r\n          \r\n          // Combine all these factors for a more unique key\r\n          return `message-${timestamp}-${senderHash}-${typeHash}-${contentHash}`;\r\n        }}\r\n        style={styles.messageList}\r\n        onEndReached={loadMoreMessages}\r\n        onEndReachedThreshold={0.3} // Reduced threshold to prevent multiple triggers\r\n        inverted={true}\r\n        contentContainerStyle={{\r\n          flexGrow: 1,\r\n          justifyContent: 'flex-end',\r\n          paddingTop: 16,\r\n        }}\r\n        maintainVisibleContentPosition={{\r\n          minIndexForVisible: 0,\r\n          autoscrollToTopThreshold: 10\r\n        }}\r\n        ListFooterComponent={isLoadingMore && (\r\n          <ActivityIndicator \r\n            size=\"small\" \r\n            color={theme.colors.primary}\r\n            style={styles.loadingMore}\r\n          />\r\n        )}\r\n        initialNumToRender={20}\r\n        maxToRenderPerBatch={10} // Lower value to improve rendering performance\r\n        windowSize={15} // Optimized window size\r\n        removeClippedSubviews={false}\r\n        extraData={forceRerender}\r\n        getItemLayout={(data, index) => ({\r\n          length: 100, // Estimated item height\r\n          offset: 100 * index,\r\n          index,\r\n        })}\r\n      />\r\n    );\r\n  });\r\n\r\n  // Update renderMessageSection to use our new component\r\n  const renderMessageSection = () => {\r\n    if (!selectedConversation) {\r\n      return null;\r\n    }\r\n\r\n    return (\r\n      <View style={styles.mainSection}>\r\n        {screenWidth > 900 && renderMessageHeader()}\r\n        {/* Messages */}\r\n        <View style={styles.messageSection}>\r\n          {/* Create Booking Button overlay */}\r\n          {selectedConversationData?.is_professional && (\r\n            <View style={styles.createBookingContainer}>\r\n              <TouchableOpacity \r\n                style={styles.createBookingHangingButton}\r\n                onPress={handleCreateBooking}\r\n              >\r\n                <MaterialCommunityIcons \r\n                  name=\"calendar-plus\" \r\n                  size={20} \r\n                  color={theme.colors.primary} \r\n                />\r\n                <Text style={styles.createBookingHangingText}>\r\n                  Create Booking\r\n                </Text>\r\n              </TouchableOpacity>\r\n            </View>\r\n          )}\r\n          \r\n          <View style={styles.messagesContainer}>\r\n            {isLoadingMessages ? (\r\n              <View style={styles.loadingContainer}>\r\n                <ActivityIndicator size=\"large\" color={theme.colors.primary} />\r\n                <Text style={styles.loadingText}>Loading messages...</Text>\r\n              </View>\r\n            ) : messages.length === 0 ? (\r\n              <Text style={styles.emptyText}>\r\n                No messages yet, start the conversation!\r\n              </Text>\r\n            ) : (\r\n              <MessageFlatList\r\n                messages={messages}\r\n                renderMessage={renderMessage}\r\n                loadMoreMessages={loadMoreMessages}\r\n                isLoadingMore={isLoadingMore}\r\n                hasMore={hasMore}\r\n                forceRerender={forceRerender}\r\n              />\r\n            )}\r\n          </View>\r\n        </View>\r\n\r\n        {/* Input Section */}\r\n        <View style={styles.inputSection}>\r\n          <View style={styles.inputContainer}>\r\n            <View style={styles.attachButtonContainer}>\r\n              <TouchableOpacity \r\n                style={styles.attachButton}\r\n                onPress={() => setShowDropdown(!showDropdown)}\r\n              >\r\n                <MaterialCommunityIcons \r\n                  name={showDropdown ? \"close\" : \"plus\"} \r\n                  size={24} \r\n                  color={theme.colors.primary} \r\n                />\r\n              </TouchableOpacity>\r\n              {showDropdown && (\r\n                <View style={styles.dropdownMenu}>\r\n                  <TouchableOpacity \r\n                    style={styles.dropdownItem}\r\n                    onPress={() => {\r\n                      setShowDropdown(false);\r\n                    }}\r\n                  >\r\n                    <MaterialCommunityIcons \r\n                      name=\"image\" \r\n                      size={20} \r\n                      color={theme.colors.placeholder} \r\n                    />\r\n                    <Text style={[styles.dropdownText, { color: theme.colors.placeholder }]}>\r\n                      Coming Soon - Images\r\n                    </Text>\r\n                  </TouchableOpacity>\r\n                </View>\r\n              )}\r\n            </View>\r\n            {Platform.OS === 'web' ? <WebInput /> : <MobileInput />}\r\n          </View>\r\n        </View>\r\n      </View>\r\n    );\r\n  };\r\n\r\n  const renderMobileHeader = () => (\r\n    <View style={[\r\n      styles.mobileHeader,\r\n      { backgroundColor: theme.colors.surfaceContrast }  // Updated to use surfaceContrast\r\n    ]}>\r\n      <View style={styles.mobileHeaderContent}>\r\n        <TouchableOpacity \r\n          style={styles.backArrow}\r\n          onPress={() => setSelectedConversation(null)}\r\n        >\r\n          <MaterialCommunityIcons \r\n            name=\"arrow-left\" \r\n            size={24} \r\n            color={theme.colors.primary} \r\n          />\r\n        </TouchableOpacity>\r\n        \r\n        <View style={styles.mobileHeaderNameContainer}>\r\n          <Text style={styles.mobileHeaderName}>\r\n            {selectedConversationData?.name || selectedConversationData?.other_user_name}\r\n          </Text>\r\n        </View>\r\n        \r\n        {/* Add Edit Draft button positioned at the right */}\r\n        {hasDraft && draftData?.draft_id && (\r\n          <TouchableOpacity \r\n            style={[styles.editDraftButton, styles.mobileEditDraftButton, { \r\n              position: 'absolute', \r\n              right: 10,\r\n              top: '50%',\r\n              transform: [{ translateY: -20 }]  // Adjusted to perfectly align with text\r\n            }]}\r\n            onPress={() => {\r\n              if (draftData?.draft_id) {\r\n                handleOpenExistingDraft(draftData.draft_id);\r\n              }\r\n            }}\r\n          >\r\n            <MaterialCommunityIcons \r\n              name=\"pencil\" \r\n              size={16} \r\n              color={theme.colors.primary} \r\n            />\r\n            <View style={{ alignItems: 'center' }}>\r\n              <Text style={[styles.editDraftText, { fontSize: 12, lineHeight: 14 }]}>Edit</Text>\r\n              <Text style={[styles.editDraftText, { fontSize: 12, lineHeight: 14 }]}>Draft</Text>\r\n            </View>\r\n          </TouchableOpacity>\r\n        )}\r\n      </View>\r\n    </View>\r\n  );\r\n\r\n  // Update renderEmptyState to remove prototype references\r\n  const renderEmptyState = () => (\r\n    <View style={{\r\n      flex: 1,\r\n      justifyContent: 'center',\r\n      alignItems: 'center',\r\n      padding: 20,\r\n    }}>\r\n      <MaterialCommunityIcons \r\n        name=\"message-text-outline\" \r\n        size={64} \r\n        color={theme.colors.placeholder}\r\n        style={{ marginBottom: 16 }}\r\n      />\r\n      <Text style={{\r\n        fontSize: 20,\r\n        fontWeight: 'bold',\r\n        color: theme.colors.text,\r\n        marginBottom: 8,\r\n        textAlign: 'center'\r\n      }}>\r\n        No Messages Yet\r\n      </Text>\r\n      <Text style={{\r\n        fontSize: 16,\r\n        color: theme.colors.placeholder,\r\n        marginBottom: 24,\r\n        textAlign: 'center'\r\n      }}>\r\n        {userRole === 'professional' ? \r\n          'Create services to start getting bookings and messages from owners' :\r\n          'Search professionals to find services and start messaging'}\r\n      </Text>\r\n      <Button\r\n        mode=\"contained\"\r\n        onPress={() => navigateToFrom(navigation, userRole === 'professional' ? 'ServiceManager' : 'SearchProfessionalsListing', 'MessageHistory')}\r\n        style={{ borderRadius: 8 }}\r\n      >\r\n        {userRole === 'professional' ? 'Create Services' : 'Find Professionals'}\r\n      </Button>\r\n    </View>\r\n  );\r\n\r\n  const handleEditDraft = async (bookingId) => {\r\n    debugLog('MBA6428: handleEditDraft called with booking ID:', bookingId);\r\n    \r\n    if (!bookingId) {\r\n      debugLog('MBA6428: Error - No booking ID provided');\r\n      Alert.alert('Error', 'Missing booking information. Please try again.');\r\n      return;\r\n    }\r\n    \r\n    try {\r\n      setIsLoading(true);\r\n      debugLog('MBA6428: Calling createDraftFromBooking API with booking ID:', bookingId);\r\n      \r\n      // Call our new API function to create a draft from the booking\r\n      const response = await createDraftFromBooking(bookingId);\r\n      \r\n      // Check for error in response\r\n      if (response.error) {\r\n        debugLog('MBA6428: Error returned from createDraftFromBooking:', response);\r\n        Alert.alert('Error', response.message || 'Failed to create draft from booking. Please try again.');\r\n        return;\r\n      }\r\n      \r\n      if (response && response.draft_id) {\r\n        debugLog('MBA6428: Draft created successfully:', response);\r\n        \r\n        // Update local state with the new draft info\r\n        setHasDraft(true);\r\n        setDraftData(response.draft_data);\r\n        \r\n        // Use the returned draft_id for opening the booking step modal\r\n        setCurrentBookingId(response.draft_id);\r\n        \r\n        // Close any open modal and open the booking step modal\r\n        setShowDraftConfirmModal(false);\r\n        \r\n        // Add a small delay to ensure modal state is updated\r\n        setTimeout(() => {\r\n          debugLog('MBA6428: Opening BookingStepModal with draft:', response.draft_id);\r\n          setShowBookingStepModal(true);\r\n        }, 100);\r\n      } else {\r\n        debugLog('MBA6428: Error - Invalid response from createDraftFromBooking:', response);\r\n        Alert.alert('Error', 'Failed to create draft from booking. Please try again.');\r\n      }\r\n    } catch (error) {\r\n      debugLog('MBA6428: Error creating draft from booking:', error);\r\n      Alert.alert('Error', 'Failed to create draft from booking. Please try again.');\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  // New function for opening an existing draft directly\r\n  const handleOpenExistingDraft = (draftId) => {\r\n    debugLog('MBA6428: handleOpenExistingDraft called with draft ID:', draftId);\r\n    \r\n    if (!draftId) {\r\n      debugLog('MBA6428: Error - No draft ID provided');\r\n      Alert.alert('Error', 'Missing draft information. Please try again.');\r\n      return;\r\n    }\r\n    \r\n    try {\r\n      // Set the current booking ID to the provided draft ID\r\n      setCurrentBookingId(draftId);\r\n      \r\n      // Close any open modal and open the booking step modal\r\n      setShowDraftConfirmModal(false);\r\n      \r\n      // Add a small delay to ensure modal state is updated\r\n      setTimeout(() => {\r\n        debugLog('MBA6428: Opening BookingStepModal with existing draft:', draftId);\r\n        setShowBookingStepModal(true);\r\n      }, 100);\r\n    } catch (error) {\r\n      debugLog('MBA6428: Error opening booking modal with draft:', error);\r\n      Alert.alert('Error', 'Failed to open booking draft. Please try again.');\r\n    }\r\n  };\r\n\r\n  // Add polling for online status of the other participant\r\n  useEffect(() => {\r\n    if (!selectedConversationData || !selectedConversation) {\r\n      return; // No conversation selected, nothing to poll\r\n    }\r\n    \r\n    const otherUserName = selectedConversationData.other_user_name || 'Unknown user';\r\n    debugLog(`MBA3210: [OTHER USER STATUS] Setting up polling for \"${otherUserName}\" online status`);\r\n    \r\n    \r\n    return () => {\r\n      debugLog(`MBA3210: [OTHER USER STATUS] Cleaning up polling interval for \"${otherUserName}\"`);\r\n      // clearInterval(statusPollingInterval);\r\n    };\r\n  }, [selectedConversationData, selectedConversation]);\r\n\r\n  useEffect(() => {\r\n    // Clean up on component unmount\r\n    return () => {\r\n      debugLog('MBA3210: MessageHistory unmounting, cleaning up websocket references');\r\n      // No need to explicitly disconnect here - the hook will handle it\r\n    };\r\n  }, []);\r\n\r\n  // Replace the existing beforeunload effect that disconnects the WebSocket\r\n  useEffect(() => {\r\n    // When a user signs out or navigates away, make sure to disconnect\r\n    const handleBeforeUnload = () => {\r\n      debugLog('MBA3210: Page unloading, but keeping websocket alive for session restore');\r\n      // Deliberately NOT disconnecting websocket on page unload\r\n      // This was causing message loss when refreshing or switching tabs\r\n    };\r\n\r\n    if (typeof window !== 'undefined') {\r\n      window.addEventListener('beforeunload', handleBeforeUnload);\r\n    }\r\n\r\n    return () => {\r\n      if (typeof window !== 'undefined') {\r\n        window.removeEventListener('beforeunload', handleBeforeUnload);\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  // Add a useEffect to reset notifications when component mounts\r\n  useEffect(() => {\r\n    // Only reset notifications once when the component mounts\r\n    updateRoute && updateRoute('MessageHistory');\r\n    \r\n    // No need to reset all notifications, individual conversations will be marked as read when selected\r\n    \r\n    // Return cleanup function\r\n    return () => {\r\n      // If needed, add cleanup code here\r\n    };\r\n  }, []); // Empty dependency array to run only once on mount\r\n\r\n  // Add a useEffect to handle route updates and message notification resets when component mounts\r\n  useEffect(() => {\r\n    // Tell the notification context we're on the Messages screen\r\n    if (updateRoute) {\r\n      debugLog('MBA4321: Updating route in MessageNotificationContext to MessageHistory');\r\n      updateRoute('MessageHistory');\r\n      \r\n      // Important: DO NOT call resetNotifications() here\r\n      // That was causing all notifications to be cleared when opening MessageHistory\r\n      // Instead, we only mark the selected conversation as read when it's selected\r\n    }\r\n    \r\n    // Return cleanup function\r\n    return () => {\r\n      debugLog('MBA4321: Cleaning up message notification tracking for MessageHistory');\r\n    };\r\n  }, [updateRoute]);\r\n  \r\n  // Add an effect to mark the current conversation as read when selected\r\n  useEffect(() => {\r\n    if (selectedConversation && markConversationAsRead) {\r\n      debugLog(`MBA4321: Marking conversation ${selectedConversation} as read`);\r\n      markConversationAsRead(selectedConversation);\r\n    }\r\n  }, [selectedConversation, markConversationAsRead]);\r\n\r\n  // When component initializes, ensure we properly handle any route parameters\r\n  // that specify a conversation to open, but don't reset all notifications\r\n  useEffect(() => {\r\n    if (!initialLoadRef.current) return; // Skip if not initial load\r\n    \r\n    const initializeData = async () => {\r\n      try {\r\n        // Reset states\r\n        setConversations([]);\r\n        setMessages([]);\r\n        setSelectedConversation(null);\r\n        setSelectedConversationData(null);\r\n        setIsLoadingConversations(true);\r\n        setIsLoadingMessages(false);\r\n        setCurrentPage(1);\r\n        setHasMore(true);\r\n        lastViewedConversationRef.current = null;\r\n        \r\n        // Handle parameters first\r\n        let initialConversationId = null;\r\n        \r\n        // First check URL parameters on web\r\n        if (Platform.OS === 'web') {\r\n          const currentUrl = new URL(window.location.href);\r\n          const urlConversationId = currentUrl.searchParams.get('conversationId');\r\n          \r\n          if (urlConversationId) {\r\n            initialConversationId = urlConversationId;\r\n            debugLog(`MBA4321: Using conversation ID ${urlConversationId} from URL parameters`);\r\n          }\r\n        }\r\n        \r\n        // Next check route params if no URL param was found\r\n        if (!initialConversationId && route.params?.conversationId) {\r\n          initialConversationId = route.params.conversationId;\r\n          debugLog(`MBA4321: Using conversation ID ${initialConversationId} from route parameters`);\r\n          \r\n          // Check if we should open booking creation (coming from Services)\r\n          if (route.params.isProfessional === true) {\r\n            shouldOpenBookingCreationRef.current = true;\r\n          }\r\n        }\r\n        \r\n        // Fetch conversations\r\n        const conversationsData = await fetchConversations();\r\n        \r\n        // Set initial selected conversation - either from params or first one\r\n        if (initialConversationId) {\r\n          setSelectedConversation(initialConversationId);\r\n          debugLog(`MBA4321: Setting initially selected conversation to ${initialConversationId}`);\r\n        } else if (Platform.OS === 'web' && screenWidth > 900 && conversationsData?.length > 0) {\r\n          setSelectedConversation(conversationsData[0].conversation_id);\r\n          debugLog(`MBA4321: Auto-selecting first conversation ${conversationsData[0].conversation_id} on desktop`);\r\n        }\r\n        \r\n        // Important: We DON'T mark all conversations as read here\r\n        // Only the selected conversation will be marked as read when it's selected\r\n      } catch (error) {\r\n        console.error('Error initializing MessageHistory:', error);\r\n      } finally {\r\n        initialLoadRef.current = false;\r\n        setIsInitialLoad(false);\r\n      }\r\n    };\r\n    \r\n    initializeData();\r\n    \r\n    return () => {\r\n      debugLog('MBA4321: Cleaning up MessageHistory component');\r\n      lastViewedConversationRef.current = null;\r\n      \r\n      // Clear the global selected conversation tracking\r\n      if (typeof window !== 'undefined') {\r\n        window.selectedConversationId = null;\r\n      }\r\n      \r\n      // IMPORTANT: We no longer disconnect the WebSocket here\r\n      // This allows the connection to persist when navigating away from this screen\r\n    };\r\n  }, []);\r\n  \r\n  // Fix the beforeunload effect\r\n  useEffect(() => {\r\n    // Only run in browser environment\r\n    if (typeof window !== 'undefined') {\r\n      const handleBeforeUnload = () => {\r\n        debugLog('MBA3210: Page unloading, but keeping websocket alive for session restore');\r\n        // No longer disconnect WebSocket on page unload\r\n      };\r\n      \r\n      window.addEventListener('beforeunload', handleBeforeUnload);\r\n      \r\n      return () => {\r\n        window.removeEventListener('beforeunload', handleBeforeUnload);\r\n      };\r\n    }\r\n  }, []);\r\n\r\n  // Clear processed messages cache when switching conversations\r\n  useEffect(() => {\r\n    if (selectedConversation) {\r\n      // Reset our tracking refs when switching conversations\r\n      processedPagesRef.current.clear();\r\n      messageIdsRef.current.clear();\r\n      isLoadingMoreRef.current = false;\r\n    }\r\n  }, [selectedConversation]);\r\n\r\n  // Add a loading overlay component at the bottom of the return statement, before any modals\r\n  return (\r\n    <SafeAreaView style={[\r\n      styles.container,\r\n      screenWidth <= 900 && selectedConversation && styles.mobileContainer,\r\n      { marginLeft: screenWidth > 900 ? (isCollapsed ? 70 : 250) : 0 },\r\n    ]}>\r\n      {isLoadingConversations ? (\r\n        <View style={{ flex: 1, justifyContent: 'center', alignItems: 'center' }}>\r\n          <ActivityIndicator size=\"large\" color={theme.colors.primary} />\r\n          <Text style={{ marginTop: 16, color: theme.colors.placeholder }}>Loading conversations...</Text>\r\n        </View>\r\n      ) : conversations.length > 0 ? (\r\n        <>\r\n          <View style={styles.contentContainer}>\r\n            {screenWidth <= 900 ? (\r\n              selectedConversation ? (\r\n                <View style={styles.mobileMessageView}>\r\n                  {renderMobileHeader()}\r\n                  {renderMessageSection()}\r\n                </View>\r\n              ) : (\r\n                renderConversationList()\r\n              )\r\n            ) : (\r\n              <>\r\n                {renderConversationList()}\r\n                {renderMessageSection()}\r\n              </>\r\n            )}\r\n          </View>\r\n        </>\r\n      ) : (\r\n        renderEmptyState()\r\n      )}\r\n      \r\n      {/* Loading overlay for draft creation */}\r\n      {isLoading && (\r\n        <View style={{\r\n          position: 'absolute',\r\n          top: 0,\r\n          left: 0,\r\n          right: 0,\r\n          bottom: 0,\r\n          backgroundColor: 'rgba(0,0,0,0.4)',\r\n          justifyContent: 'center',\r\n          alignItems: 'center',\r\n          zIndex: 1000\r\n        }}>\r\n          <View style={{\r\n            backgroundColor: theme.colors.surface,\r\n            borderRadius: 12,\r\n            padding: 24,\r\n            alignItems: 'center',\r\n            shadowColor: '#000',\r\n            shadowOffset: { width: 0, height: 2 },\r\n            shadowOpacity: 0.25,\r\n            shadowRadius: 3.84,\r\n            elevation: 5,\r\n          }}>\r\n            <ActivityIndicator size=\"large\" color={theme.colors.primary} />\r\n            <Text style={{ marginTop: 16, color: theme.colors.text, fontFamily: theme.fonts.regular.fontFamily }}>\r\n              Creating draft from booking...\r\n            </Text>\r\n          </View>\r\n        </View>\r\n      )}\r\n      \r\n      <RequestBookingModal\r\n        visible={showRequestModal}\r\n        onClose={() => setShowRequestModal(false)}\r\n        onSubmit={handleBookingRequest}\r\n        conversationId={selectedConversation}\r\n      />\r\n\r\n      <BookingStepModal\r\n        visible={showBookingStepModal}\r\n        onClose={() => {\r\n          setShowBookingStepModal(false);\r\n          setCurrentBookingId(null);\r\n          \r\n          // Refresh message data when modal is closed to get latest draft status\r\n          if (selectedConversation) {\r\n            debugLog('MBA6428: Refreshing message data after closing BookingStepModal');\r\n            fetchMessages(selectedConversation, 1);\r\n          }\r\n        }}\r\n        navigation={navigation}\r\n        bookingId={currentBookingId}\r\n        onComplete={(bookingData) => {\r\n          debugLog('MBA6428: Booking completed:', bookingData);\r\n          debugLog('MBA6428: New booking message:', bookingData.message);\r\n          debugLog('MBA6428: Message metadata:', bookingData.message?.metadata);\r\n          debugLog('MBA6428: Is this an update?', bookingData.isUpdate);\r\n          \r\n          // Handle error case\r\n          if (bookingData.error) {\r\n            Alert.alert(\r\n              'Error',\r\n              bookingData.errorMessage || 'Failed to process booking. Please try again.'\r\n            );\r\n            \r\n            // Close the modal and clean up\r\n            setShowBookingStepModal(false);\r\n            setCurrentBookingId(null);\r\n            \r\n            // Refresh message data to get latest draft status\r\n            if (selectedConversation) {\r\n              debugLog('MBA6428: Refreshing message data after booking error');\r\n              fetchMessages(selectedConversation, 1);\r\n            }\r\n            \r\n            return;\r\n          }\r\n          \r\n          // Add the new booking message to the messages list\r\n          if (bookingData.message) {\r\n            setMessages(prevMessages => [bookingData.message, ...prevMessages]);\r\n            \r\n            // Update conversation's last message with appropriate text\r\n            const lastMessageText = bookingData.isUpdate \r\n              ? \"Updated Booking Request\" \r\n              : \"Approval Request\";\r\n              \r\n            setConversations(prev => prev.map(conv => \r\n              conv.conversation_id === selectedConversation \r\n                ? {\r\n                    ...conv,\r\n                    last_message: lastMessageText,\r\n                    last_message_time: bookingData.message.timestamp\r\n                  }\r\n                : conv\r\n            ));\r\n          }\r\n          \r\n          // Update draft state since the draft is deleted after booking creation\r\n          setHasDraft(false);\r\n          setDraftData(null);\r\n          \r\n          // Close the modal and clean up\r\n          setShowBookingStepModal(false);\r\n          setCurrentBookingId(null);\r\n          \r\n          // Refresh message data to get latest draft status\r\n          if (selectedConversation) {\r\n            debugLog('MBA6428: Refreshing message data after successful booking completion');\r\n            fetchMessages(selectedConversation, 1);\r\n          }\r\n\r\n          // Show success message to the user\r\n          const successMessage = bookingData.isUpdate\r\n            ? \"Booking update request sent successfully!\"\r\n            : \"Booking request sent successfully!\";\r\n          \r\n          Alert.alert(\"Success\", successMessage);\r\n        }}\r\n      />\r\n\r\n      <DraftConfirmationModal\r\n        visible={showDraftConfirmModal}\r\n        onClose={() => setShowDraftConfirmModal(false)}\r\n        onContinueExisting={handleContinueExisting}\r\n        onCreateNew={handleCreateNew}\r\n      />\r\n    </SafeAreaView>\r\n  );\r\n};\r\n\r\nexport default MessageHistory;\r\n\r\n","import React, { useContext, useState, useEffect } from 'react';\r\nimport { View, StyleSheet, Platform, SafeAreaView, Text, TouchableOpacity, StatusBar } from 'react-native';\r\nimport { List, Divider } from 'react-native-paper';\r\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\r\nimport { theme } from '../styles/theme';\r\nimport BackHeader from '../components/BackHeader';\r\nimport CrossPlatformView from '../components/CrossPlatformView';\r\nimport { AuthContext } from '../context/AuthContext';\r\n\r\nconst Settings = ({ navigation }) => {\r\n  const { screenWidth, isCollapsed, is_DEBUG } = useContext(AuthContext);\r\n  const [isMobile, setIsMobile] = useState(screenWidth <= 900);\r\n  const styles = createStyles(screenWidth, isCollapsed);\r\n\r\n  useEffect(() => {\r\n    const updateLayout = () => {\r\n      setIsMobile(screenWidth <= 900);\r\n    };\r\n    updateLayout();\r\n  }, [screenWidth]);\r\n\r\n  const settingsItems = [\r\n    { title: 'Change Password', icon: 'lock-reset', route: 'ChangePassword' },\r\n    { title: 'Notification Preferences', icon: 'bell-outline', route: 'NotificationPreferences' },\r\n    { title: 'Privacy Settings', icon: 'shield-account', route: 'PrivacySettings' },\r\n    { title: 'Language', icon: 'translate', route: 'LanguageSettings' },\r\n    { title: 'Display & Accessibility', icon: 'palette', route: 'DisplaySettings' },\r\n    { title: 'Data Usage', icon: 'chart-bar', route: 'DataUsage' },\r\n    { title: 'About', icon: 'information-outline', route: 'About' },\r\n  ];\r\n\r\n  const renderSettingsItems = () => {\r\n    return settingsItems.map((item, index) => (\r\n      <React.Fragment key={index}>\r\n        <List.Item\r\n          title={item.title}\r\n          titleStyle={styles.listItemTitle}\r\n          left={props => \r\n            Platform.OS === 'web' \r\n              ? <MaterialCommunityIcons \r\n                  name={item.icon} \r\n                  size={screenWidth <= 900 ? 20 : 24} \r\n                  color={theme.colors.primary} \r\n                />\r\n              : <List.Icon {...props} icon={item.icon} />\r\n          }\r\n          onPress={() => navigation.navigate(item.route)}\r\n          style={[\r\n            styles.webListItem,\r\n            { paddingHorizontal: screenWidth <= 900 ? 8 : 16 }\r\n          ]}\r\n        />\r\n        {index < settingsItems.length - 1 && <Divider />}\r\n      </React.Fragment>\r\n    ));\r\n  };\r\n\r\n  return (\r\n    <View style={styles.mainContainer}>\r\n      <SafeAreaView style={styles.container}>\r\n        <View style={styles.content}>\r\n          {isMobile && (\r\n            <BackHeader \r\n              title=\"Settings\" \r\n              onBackPress={() => navigation.navigate('More')} \r\n            />\r\n          )}\r\n          <View style={styles.webContent}>\r\n            <List.Section style={styles.listSection}>\r\n              {renderSettingsItems()}\r\n            </List.Section>\r\n          </View>\r\n        </View>\r\n      </SafeAreaView>\r\n    </View>\r\n  );\r\n};\r\n\r\nconst createStyles = (screenWidth, isCollapsed) => StyleSheet.create({\r\n  mainContainer: {\r\n    flex: 1,\r\n    backgroundColor: theme.colors.background,\r\n    height: '100vh',\r\n    overflow: 'hidden',\r\n    position: 'fixed',\r\n    top: 0,\r\n    left: 0,\r\n    right: 0,\r\n    bottom: 0,\r\n    marginLeft: screenWidth > 900 ? (isCollapsed ? 70 : 250) : 0,\r\n    transition: 'margin-left 0.3s ease',\r\n  },\r\n  container: {\r\n    flex: 1,\r\n  },\r\n  content: {\r\n    flex: 1,\r\n    backgroundColor: theme.colors.background,\r\n    paddingTop: Platform.OS === 'android' ? StatusBar.currentHeight : 0,\r\n  },\r\n  listSection: {\r\n    backgroundColor: theme.colors.surface,\r\n  },\r\n  webContent: {\r\n    width: '100%',\r\n    maxWidth: screenWidth > 900 ? 800 : 600,\r\n    alignSelf: 'center',\r\n    padding: screenWidth <= 900 ? 10 : 16,\r\n  },\r\n  webListItem: {\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: theme.colors.border,\r\n    paddingVertical: screenWidth <= 900 ? 8 : 12,\r\n  },\r\n  listItemTitle: {\r\n    fontSize: screenWidth <= 900 ? theme.fontSizes.medium : theme.fontSizes.large,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  warningContainer: {\r\n    backgroundColor: '#FFF3CD',\r\n    padding: theme.spacing.small,\r\n    marginHorizontal: theme.spacing.small,\r\n    marginTop: theme.spacing.small,\r\n    borderRadius: 4,\r\n  },\r\n  warningText: {\r\n    color: '#856404',\r\n    textAlign: 'center',\r\n  },\r\n});\r\n\r\nexport default Settings;\r\n","import React, { useContext } from 'react';\r\nimport { View, Text, StyleSheet, ScrollView, Platform } from 'react-native';\r\nimport { theme } from '../styles/theme';\r\nimport BackHeader from '../components/BackHeader';\r\nimport CrossPlatformView from '../components/CrossPlatformView';\r\nimport { useNavigation } from '@react-navigation/native';\r\nimport { AuthContext } from '../context/AuthContext';\r\nimport { handleBack } from '../components/Navigation';\r\n\r\nconst appName = 'Zen Exotics';\r\n\r\nconst privacy_policy_info = [\r\n  {sectionTitle: \"Information We Collect\", \r\n    paragraph: \"When you use {appName}, we collect several types of information to ensure the best experience for both professionals and pet owners. This includes:\", \r\n    listItems: {listItem: \"Personal Information: Name, email, phone number, address, and service preferences.\",\r\n                listItem: \"Payment Information: Card type, expiration date, and the last four digits of your payment card. Complete payment details are managed by third-party processors, and we do not store full card numbers.\",\r\n                listItem: \"Health Data: Medical information about your pets (e.g., medical history, medications, vaccinations, behavioral traits). By using this service, you consent to our use of this health data as we deem necessary for analytics, research, marketing, or any other purpose related to improving our services.\",\r\n                listItem: \"Device Data: We collect information about your device, including IP address, browser type, operating system, and other usage data.\",\r\n                listItem: \"Location Data: With your permission, we collect location information to match professionals and owners more effectively. Disabling location services may limit certain app features.\",\r\n                listItem: \"Payment Information: Card type, expiration date, and the last four digits of your payment card. Complete payment details are managed by third-party processors, and we do not store full card numbers.\",\r\n                listItem: \"Payment Information: Card type, expiration date, and the last four digits of your payment card. Complete payment details are managed by third-party processors, and we do not store full card numbers.\",\r\n                listItem: \"Payment Information: Card type, expiration date, and the last four digits of your payment card. Complete payment details are managed by third-party processors, and we do not store full card numbers.\",\r\n                listItem: \"Payment Information: Card type, expiration date, and the last four digits of your payment card. Complete payment details are managed by third-party processors, and we do not store full card numbers.\",\r\n                listItem: \"Payment Information: Card type, expiration date, and the last four digits of your payment card. Complete payment details are managed by third-party processors, and we do not store full card numbers.\",\r\n                listItem: \"Payment Information: Card type, expiration date, and the last four digits of your payment card. Complete payment details are managed by third-party processors, and we do not store full card numbers.\",\r\n                listItem: \"Payment Information: Card type, expiration date, and the last four digits of your payment card. Complete payment details are managed by third-party processors, and we do not store full card numbers.\",\r\n                listItem: \"Payment Information: Card type, expiration date, and the last four digits of your payment card. Complete payment details are managed by third-party processors, and we do not store full card numbers.\",\r\n    }},\r\n  {}\r\n];\r\n\r\nconst PrivacyPolicy = () => {\r\n  const navigation = useNavigation();\r\n\r\n  return (\r\n    <CrossPlatformView fullWidthHeader={true}>\r\n      <BackHeader \r\n        title=\"Privacy Policy\" \r\n        onBackPress={() => handleBack(navigation)} \r\n      />\r\n      <ScrollView \r\n        style={styles.container}\r\n        contentContainerStyle={styles.contentContainer}\r\n      >\r\n        <Text style={styles.title}>Privacy Policy for {appName}</Text>\r\n        <Text style={styles.date}>Effective Date: 10/21/2024</Text>\r\n        \r\n        <Text style={styles.paragraph}>\r\n          By accessing or using {appName}, you agree to the practices described in this Privacy Policy. If you do not agree with these terms, please discontinue the use of our services immediately.\r\n        </Text>\r\n\r\n        <Text style={styles.sectionTitle}>Information We Collect</Text>\r\n        <Text style={styles.paragraph}>\r\n          When you use {appName}, we collect several types of information to ensure the best experience for both professionals and pet owners. This includes:\r\n        </Text>\r\n        <Text style={styles.listItem}>• Personal Information: Name, email, phone number, address, and service preferences.</Text>\r\n        <Text style={styles.listItem}>• Payment Information: Card type, expiration date, and the last four digits of your payment card. Complete payment details are managed by third-party processors, and we do not store full card numbers.</Text>\r\n        <Text style={styles.listItem}>• Health Data: Medical information about your pets (e.g., medical history, medications, vaccinations, behavioral traits). By using this service, you consent to our use of this health data as we deem necessary for analytics, research, marketing, or any other purpose related to improving our services.</Text>\r\n        <Text style={styles.listItem}>• Device Data: We collect information about your device, including IP address, browser type, operating system, and other usage data.</Text>\r\n        <Text style={styles.listItem}>• Location Data: With your permission, we collect location information to match professionals and owners more effectively. Disabling location services may limit certain app features.</Text>\r\n        <Text style={styles.listItem}>• Cookies and Tracking: We use cookies and tracking technologies to improve user experience and monitor traffic patterns. You can disable cookies in your browser settings.</Text>\r\n\r\n        <Text style={styles.sectionTitle}>How We Use Your Data</Text>\r\n        <Text style={styles.paragraph}>We use the data we collect to:</Text>\r\n        <Text style={styles.listItem}>• Facilitate bookings and transactions between professionals and owners.</Text>\r\n        <Text style={styles.listItem}>• Verify professional eligibility through background checks.</Text>\r\n        <Text style={styles.listItem}>• Provide customer support and resolve disputes between users.</Text>\r\n        <Text style={styles.listItem}>• Improve app functionality through analytics and feedback.</Text>\r\n        <Text style={styles.listItem}>• Manage communications between professionals and owners.</Text>\r\n        <Text style={styles.listItem}>• Use health data for internal analysis and marketing purposes. We retain control over how this data is used.</Text>\r\n\r\n        <Text style={styles.sectionTitle}>Sharing of Information</Text>\r\n        <Text style={styles.paragraph}>We may share your data in the following ways:</Text>\r\n        <Text style={styles.listItem}>• With Other Users: For bookings, we share relevant information between professionals and pet owners.</Text>\r\n        <Text style={styles.listItem}>• With Third-Party Providers: Payment processors, analytics providers, and background check services may access limited information to perform their services.</Text>\r\n        <Text style={styles.listItem}>• Legal and Compliance Purposes: We may disclose information if required by law or to protect the safety and security of our users.</Text>\r\n        <Text style={styles.listItem}>• Business Transfers: In case of a merger, sale, or acquisition, your data may be transferred to a new owner.</Text>\r\n        <Text style={styles.listItem}>• Aggregated Data: We may share non-identifiable, aggregated data for research or business purposes.</Text>\r\n\r\n        <Text style={styles.sectionTitle}>Your Rights and Choices</Text>\r\n        <Text style={styles.listItem}>• Account Management: You can update or delete your account information through the app settings.</Text>\r\n        <Text style={styles.listItem}>• Health Data Access: You may review the health data associated with your pets but agree that we control its use.</Text>\r\n        <Text style={styles.listItem}>• Location Services: Manage your location preferences through your device settings.</Text>\r\n        <Text style={styles.listItem}>• Cookie Preferences: You can opt out of personalized ads and tracking through your browser settings.</Text>\r\n\r\n        <Text style={styles.sectionTitle}>Security and Data Retention</Text>\r\n        <Text style={styles.paragraph}>\r\n          We implement reasonable security measures to protect your data, though no system is entirely secure. We retain your data as long as needed for operational purposes or as required by law.\r\n        </Text>\r\n\r\n        <Text style={styles.sectionTitle}>International Data Transfers</Text>\r\n        <Text style={styles.paragraph}>\r\n          Your data may be processed or stored in countries outside your own. By using the app, you agree to these transfers, even if those countries have different data protection laws.\r\n        </Text>\r\n\r\n        <Text style={styles.sectionTitle}>Changes to This Privacy Policy</Text>\r\n        <Text style={styles.paragraph}>\r\n          We may update this policy from time to time to reflect changes in our practices or services. We will notify you of significant changes through the app or via email. Continued use of the app constitutes acceptance of the revised policy.\r\n        </Text>\r\n\r\n        <Text style={styles.sectionTitle}>Contact Us</Text>\r\n        <Text style={styles.paragraph}>\r\n          If you have questions or concerns about this policy, please contact us:\r\n        </Text>\r\n        <Text style={styles.listItem}>Email: zam.hh.llc@gmail.com</Text>\r\n        <Text style={styles.listItem}>Phone: 7195106341</Text>\r\n      </ScrollView>\r\n    </CrossPlatformView>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    padding: 20,\r\n    width: '100%',\r\n    maxWidth: 800,\r\n    alignSelf: 'center',\r\n  },\r\n  contentContainer: {\r\n    paddingBottom: Platform.OS === 'web' ? 16 : 80,\r\n  },\r\n  title: {\r\n    fontSize: 24,\r\n    fontWeight: 'bold',\r\n    marginBottom: 10,\r\n    color: theme.colors.primary,\r\n  },\r\n  date: {\r\n    fontSize: 16,\r\n    marginBottom: 20,\r\n    color: theme.colors.text,\r\n  },\r\n  sectionTitle: {\r\n    fontSize: 20,\r\n    fontWeight: 'bold',\r\n    marginTop: 20,\r\n    marginBottom: 10,\r\n    color: theme.colors.primary,\r\n  },\r\n  paragraph: {\r\n    fontSize: 16,\r\n    marginBottom: 10,\r\n    color: theme.colors.text,\r\n  },\r\n  listItem: {\r\n    fontSize: 16,\r\n    marginBottom: 5,\r\n    marginLeft: 10,\r\n    color: theme.colors.text,\r\n  },\r\n});\r\n\r\nexport default PrivacyPolicy;\r\n","import React from 'react';\r\nimport { View, Text, StyleSheet } from 'react-native';\r\nimport { theme } from '../styles/theme';\r\n\r\nconst ProfessionalSettings = () => {\r\n  return (\r\n    <View style={styles.container}>\r\n      <Text style={styles.title}>Professional Settings</Text>\r\n      <Text>Manage your professional profile and preferences here.</Text>\r\n    </View>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    padding: 20,\r\n    backgroundColor: theme.colors.background,\r\n  },\r\n  title: {\r\n    fontSize: 24,\r\n    fontWeight: 'bold',\r\n    marginBottom: 20,\r\n    color: theme.colors.primary,\r\n  },\r\n});\r\n\r\nexport default ProfessionalSettings;","import React, { useContext } from 'react';\r\nimport { View, Text, StyleSheet, ScrollView } from 'react-native';\r\nimport { theme } from '../styles/theme';\r\nimport BackHeader from '../components/BackHeader';\r\nimport CrossPlatformView from '../components/CrossPlatformView';\r\nimport { useNavigation } from '@react-navigation/native';\r\nimport { handleBack } from '../components/Navigation';\r\nimport { AuthContext } from '../context/AuthContext';\r\n\r\nconst appName = 'Zen Exotics';\r\n\r\nconst TermsOfService = () => {\r\n  const navigation = useNavigation();\r\n\r\n  return (\r\n    <CrossPlatformView fullWidthHeader={true}>\r\n      <BackHeader \r\n        title=\"Terms of Service\" \r\n        onBackPress={() => handleBack(navigation)} \r\n      />\r\n      <Text>Terms of Service coming soon. Right now we are in prototype mode, so no data is saved except for email/name if you choose to contact us through this platform, then it is saved for marketing purposes.</Text>\r\n      \r\n      <ScrollView \r\n        style={styles.container}\r\n        contentContainerStyle={styles.contentContainer}\r\n      >\r\n        <Text style={styles.title}>Terms of Service for {appName}</Text>\r\n\r\n        <Text style={styles.date}>Effective Date: 10/21/2024</Text>\r\n        \r\n        <Text style={styles.paragraph}>\r\n          Welcome to {appName}! By using our platform, mobile application, or any services offered through our platform (collectively, \"the Service\"), you agree to be bound by these Terms of Service (\"Terms\"). If you do not agree to these Terms, you must discontinue use of the Service immediately.\r\n        </Text>\r\n\r\n        <Text style={styles.sectionTitle}>1. Description of Service</Text>\r\n        <Text style={styles.paragraph}>\r\n          {appName} provides an online platform for connecting pet owners with professionals specializing in exotic animals, as well as dogs and cats. Users can book services, communicate with professionals, and manage pet-related services, including payments and reviews.\r\n        </Text>\r\n\r\n        <Text style={styles.sectionTitle}>2. User Accounts</Text>\r\n        <Text style={styles.paragraph}>\r\n          To use certain features of the Service, you must create an account. You are responsible for keeping your account information accurate and secure.\r\n        </Text>\r\n        <Text style={styles.listItem}>• Eligibility: Users must be at least 18 years old to create an account.</Text>\r\n        <Text style={styles.listItem}>• Account Security: You are responsible for all activities under your account. Notify us immediately if you suspect unauthorized use.</Text>\r\n        <Text style={styles.listItem}>• Account Termination: We reserve the right to suspend or terminate accounts at our sole discretion for violations of these Terms.</Text>\r\n\r\n        <Text style={styles.sectionTitle}>3. User Conduct and Acceptable Use</Text>\r\n        <Text style={styles.paragraph}>By using the Service, you agree:</Text>\r\n        <Text style={styles.listItem}>• To provide accurate and complete information.</Text>\r\n        <Text style={styles.listItem}>• Not to engage in fraudulent or unlawful activities.</Text>\r\n        <Text style={styles.listItem}>• Not to use the Service for spam, harassment, or abusive behavior toward other users.</Text>\r\n        <Text style={styles.listItem}>• To comply with all local, national, and international laws applicable to your activities on the platform.</Text>\r\n        <Text style={styles.paragraph}>Failure to comply with these rules may result in account suspension or termination.</Text>\r\n\r\n        <Text style={styles.sectionTitle}>4. Pet and Health Information</Text>\r\n        <Text style={styles.paragraph}>\r\n          You acknowledge that the Service involves the collection and sharing of health-related data for pets. By using the Service, you agree to provide accurate medical information for your animals and grant us permission to use and share this data as outlined in our Privacy Policy.\r\n        </Text>\r\n\r\n        <Text style={styles.sectionTitle}>5. Payment Terms</Text>\r\n        <Text style={styles.paragraph}>\r\n          All transactions between pet owners and professionals must be processed through the platform's payment system, powered by Stripe. You agree to the following:\r\n        </Text>\r\n        <Text style={styles.listItem}>• Booking Fees: You will be charged the agreed-upon amount at the time of booking.</Text>\r\n        <Text style={styles.listItem}>• Cancellations and Refunds: Cancellations are subject to our cancellation policy, which may result in partial or no refunds.</Text>\r\n        <Text style={styles.listItem}>• Payouts to Professionals: Professionals must provide accurate payment information and comply with local tax regulations.</Text>\r\n\r\n        <Text style={styles.sectionTitle}>6. Liability and Disclaimer of Warranties</Text>\r\n        <Text style={styles.paragraph}>\r\n          You acknowledge that {appName} does not guarantee the quality or safety of services provided by professionals. Our platform only facilitates connections between users.\r\n        </Text>\r\n        <Text style={styles.listItem}>• We are not liable for any injury, damage, or loss caused during the provision of pet care services.</Text>\r\n        <Text style={styles.listItem}>• The Service is provided \"as is\" and \"as available\" without warranties of any kind, express or implied.</Text>\r\n\r\n        <Text style={styles.sectionTitle}>7. Dispute Resolution Between Users</Text>\r\n        <Text style={styles.paragraph}>\r\n          Disputes between users (e.g., pet owners and professionals) must first be addressed directly between the parties. If no resolution is reached, {appName} may mediate but is not responsible for the outcome.\r\n        </Text>\r\n\r\n        <Text style={styles.sectionTitle}>8. Limitation of Liability</Text>\r\n        <Text style={styles.paragraph}>In no event shall {appName}, its affiliates, officers, employees, or partners be liable for:</Text>\r\n        <Text style={styles.listItem}>• Indirect, incidental, or consequential damages arising from the use of the Service.</Text>\r\n        <Text style={styles.listItem}>• Any claims exceeding the amount you paid through the Service within the last six months.</Text>\r\n\r\n        <Text style={styles.sectionTitle}>9. Termination and Suspension</Text>\r\n        <Text style={styles.paragraph}>We reserve the right to suspend or terminate access to the Service at any time without notice if:</Text>\r\n        <Text style={styles.listItem}>• You breach these Terms.</Text>\r\n        <Text style={styles.listItem}>• Your actions jeopardize the safety or security of the platform or other users.</Text>\r\n\r\n        <Text style={styles.sectionTitle}>10. Modifications to the Service and Terms</Text>\r\n        <Text style={styles.paragraph}>\r\n          We may modify these Terms or the Service at any time. Significant changes will be communicated via email or in-app notifications. Continued use of the Service after changes constitutes acceptance of the revised Terms.\r\n        </Text>\r\n\r\n        <Text style={styles.sectionTitle}>11. Intellectual Property Rights</Text>\r\n        <Text style={styles.paragraph}>\r\n          All content, trademarks, and logos on the platform are owned by or licensed to {appName}. You may not copy, modify, or distribute content without express permission.\r\n        </Text>\r\n\r\n        <Text style={styles.sectionTitle}>12. Governing Law and Dispute Resolution</Text>\r\n        <Text style={styles.paragraph}>\r\n          These Terms are governed by the laws of El Paso County, Colorado, without regard to conflict of law principles.\r\n        </Text>\r\n        <Text style={styles.listItem}>• Arbitration Clause: All disputes arising under these Terms shall be resolved through binding arbitration in Colorado Springs, Colorado.</Text>\r\n        <Text style={styles.listItem}>• Class Action Waiver: You agree to waive your right to participate in class action lawsuits.</Text>\r\n\r\n        <Text style={styles.sectionTitle}>13. Indemnification</Text>\r\n        <Text style={styles.paragraph}>\r\n          You agree to indemnify and hold harmless {appName}, its affiliates, officers, and employees from any claims, damages, or liabilities arising from your use of the Service or breach of these Terms.\r\n        </Text>\r\n\r\n        <Text style={styles.sectionTitle}>14. Third-Party Links and Services</Text>\r\n        <Text style={styles.paragraph}>\r\n          The platform may contain links to third-party websites or services. {appName} is not responsible for the content or actions of those third parties.\r\n        </Text>\r\n\r\n        <Text style={styles.sectionTitle}>15. Contact Us</Text>\r\n        <Text style={styles.paragraph}>\r\n          If you have questions about these Terms, please contact us:\r\n        </Text>\r\n        <Text style={styles.listItem}>Email: zam.hh.llc@gmail.com</Text>\r\n        <Text style={styles.listItem}>Phone: 7195106341</Text>\r\n\r\n        <Text style={styles.sectionTitle}>Acknowledgment of Agreement</Text>\r\n        <Text style={styles.paragraph}>\r\n          By accessing or using {appName}, you acknowledge that you have read, understood, and agreed to these Terms of Service.\r\n        </Text>\r\n      </ScrollView>\r\n    </CrossPlatformView>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    padding: 20,\r\n  },\r\n  contentContainer: {\r\n    paddingBottom: 80,\r\n  },\r\n  title: {\r\n    fontSize: 24,\r\n    fontWeight: 'bold',\r\n    marginBottom: 10,\r\n    color: theme.colors.primary,\r\n  },\r\n  date: {\r\n    fontSize: 16,\r\n    marginBottom: 20,\r\n    color: theme.colors.text,\r\n  },\r\n  sectionTitle: {\r\n    fontSize: 20,\r\n    fontWeight: 'bold',\r\n    marginTop: 20,\r\n    marginBottom: 10,\r\n    color: theme.colors.primary,\r\n  },\r\n  paragraph: {\r\n    fontSize: 16,\r\n    marginBottom: 10,\r\n    color: theme.colors.text,\r\n  },\r\n  listItem: {\r\n    fontSize: 16,\r\n    marginBottom: 5,\r\n    marginLeft: 10,\r\n    color: theme.colors.text,\r\n  },\r\n  testSection: {\r\n    marginBottom: 20,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    padding: 10,\r\n    borderRadius: 4,\r\n  },\r\n});\r\n\r\nexport default TermsOfService;\r\n","import React from 'react';\r\nimport { View, Text, StyleSheet, ScrollView } from 'react-native';\r\nimport { theme } from '../styles/theme';\r\n\r\nconst HelpFAQ = () => {\r\n  return (\r\n    <ScrollView style={styles.container}>\r\n      <Text style={styles.title}>Help / FAQ</Text>\r\n      <Text>Frequently asked questions and help topics go here...</Text>\r\n    </ScrollView>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    padding: 20,\r\n    backgroundColor: theme.colors.background,\r\n  },\r\n  title: {\r\n    fontSize: 24,\r\n    fontWeight: 'bold',\r\n    marginBottom: 20,\r\n    color: theme.colors.primary,\r\n  },\r\n});\r\n\r\nexport default HelpFAQ;","import React, { useState, useContext } from 'react';\r\nimport { View, Text, StyleSheet, TextInput, TouchableOpacity, Platform, Dimensions } from 'react-native';\r\nimport { theme } from '../styles/theme';\r\nimport BackHeader from '../components/BackHeader';\r\nimport CrossPlatformView from '../components/CrossPlatformView';\r\nimport { useNavigation } from '@react-navigation/native';\r\nimport axios from 'axios';\r\nimport { API_BASE_URL } from '../config/config';\r\nimport { AuthContext } from '../context/AuthContext';\r\nimport { useForm, ValidationError } from '@formspree/react';\r\n\r\nconst ContactUs = () => {\r\n  const navigation = useNavigation();\r\n  const { screenWidth } = useContext(AuthContext);\r\n  const [state, handleFormspreeSubmit] = useForm(\"mkgobpro\");\r\n  const [name, setName] = useState('');\r\n  const [email, setEmail] = useState('');\r\n  const [message, setMessage] = useState('');\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  const [successMessage, setSuccessMessage] = useState('');\r\n\r\n  // Calculate responsive widths\r\n  const isMobile = screenWidth < 768;\r\n  const contentWidth = isMobile ? '90%' : '600px';\r\n  const maxContentWidth = isMobile ? '100%' : '800px';\r\n\r\n  const handleSubmit = async () => {\r\n    if (!name || !email || !message) {\r\n      setSuccessMessage('Please fill in all fields');\r\n      return;\r\n    }\r\n\r\n    setIsSubmitting(true);\r\n    setSuccessMessage('');\r\n    \r\n    // Use backend API in production mode\r\n    try {\r\n      const response = await axios.post(`${API_BASE_URL}/api/users/v1/contact/`, {\r\n        name,\r\n        email,\r\n        message\r\n      });\r\n\r\n      if (response.status === 200) {\r\n        setSuccessMessage('Your message has been sent successfully!');\r\n        setName('');\r\n        setEmail('');\r\n        setMessage('');\r\n      } else {\r\n        throw new Error('Failed to send message');\r\n      }\r\n    } catch (error) {\r\n      setSuccessMessage(error.response?.data?.error || 'Failed to send message. Please try again later.');\r\n      console.error(error);\r\n    } finally {\r\n      setIsSubmitting(false);\r\n    }\r\n  };\r\n\r\n  // Show success message from either Formspree or backend\r\n  if (state.succeeded) {\r\n    return (\r\n      <CrossPlatformView fullWidthHeader={true} contentWidth={maxContentWidth}>\r\n        <BackHeader title=\"Contact Us\" onBackPress={() => navigation.navigate('More')} />\r\n        <View style={styles.container}>\r\n          <View style={[styles.contentWrapper, { width: contentWidth }]}>\r\n            <Text style={[styles.title, { color: theme.colors.primary }]}>\r\n              Thanks for reaching out!\r\n            </Text>\r\n            <Text style={styles.successMessage}>\r\n              We'll get back to you soon.\r\n            </Text>\r\n          </View>\r\n        </View>\r\n      </CrossPlatformView>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <CrossPlatformView \r\n      fullWidthHeader={true}\r\n      contentWidth={maxContentWidth}\r\n    >\r\n      <BackHeader \r\n        title=\"Contact Us\" \r\n        onBackPress={() => navigation.navigate('More')} \r\n      />\r\n      <View style={styles.container}>\r\n        <View style={[styles.contentWrapper, { width: contentWidth }]}>\r\n          <Text style={styles.title}>Contact Us</Text>\r\n          <Text style={styles.subtitle}>Get in touch with our support team</Text>\r\n          \r\n          <TextInput\r\n            style={styles.input}\r\n            placeholder=\"Your Name\"\r\n            value={name}\r\n            onChangeText={setName}\r\n            name=\"name\"\r\n          />\r\n          <ValidationError prefix=\"Name\" field=\"name\" errors={state.errors} />\r\n          <TextInput\r\n            style={styles.input}\r\n            placeholder=\"Your Email\"\r\n            value={email}\r\n            onChangeText={setEmail}\r\n            keyboardType=\"email-address\"\r\n            name=\"email\"\r\n            autoCapitalize=\"none\"\r\n          />\r\n          <ValidationError prefix=\"Email\" field=\"email\" errors={state.errors} />\r\n          \r\n          <TextInput\r\n            style={[styles.input, styles.messageInput]}\r\n            placeholder=\"Your Message\"\r\n            value={message}\r\n            onChangeText={setMessage}\r\n            multiline\r\n            name=\"message\"\r\n          />\r\n          <ValidationError prefix=\"Message\" field=\"message\" errors={state.errors} />\r\n          \r\n          {successMessage ? (\r\n            <Text style={styles.successMessage}>\r\n              {successMessage}\r\n            </Text>\r\n          ) : null}\r\n          \r\n          <TouchableOpacity \r\n            style={[styles.button, isSubmitting && styles.disabledButton]} \r\n            onPress={handleSubmit}\r\n            disabled={isSubmitting || (state.submitting)}\r\n          >\r\n            <Text style={styles.buttonText}>\r\n              {isSubmitting || (state.submitting) ? 'Sending...' : 'Send Message'}\r\n            </Text>\r\n          </TouchableOpacity>\r\n        </View>\r\n      </View>\r\n    </CrossPlatformView>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    width: '100%',\r\n    alignItems: 'center',\r\n    justifyContent: 'flex-start',\r\n    paddingVertical: 20,\r\n  },\r\n  contentWrapper: {\r\n    padding: 20,\r\n    alignItems: 'center',\r\n    backgroundColor: 'white',\r\n    borderRadius: 10,\r\n    shadowColor: '#000',\r\n    shadowOffset: { width: 0, height: 2 },\r\n    shadowOpacity: 0.1,\r\n    shadowRadius: 4,\r\n    elevation: 3,\r\n  },\r\n  title: {\r\n    fontSize: theme.fontSizes.largeLarge,\r\n    fontWeight: 'bold',\r\n    marginBottom: 10,\r\n    color: theme.colors.primary,\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n    textAlign: 'center',\r\n  },\r\n  subtitle: {\r\n    fontSize: theme.fontSizes.medium,\r\n    marginBottom: 20,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    textAlign: 'center',\r\n  },\r\n  input: {\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 5,\r\n    borderColor: theme.colors.border,\r\n    borderWidth: 1,\r\n    padding: 15,\r\n    marginBottom: 15,\r\n    fontSize: theme.fontSizes.medium,\r\n    width: '100%',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  messageInput: {\r\n    height: 120,\r\n    textAlignVertical: 'top',\r\n  },\r\n  button: {\r\n    backgroundColor: theme.colors.primary,\r\n    padding: 15,\r\n    borderRadius: 5,\r\n    alignItems: 'center',\r\n    width: '100%',\r\n    marginTop: 10,\r\n  },\r\n  buttonText: {\r\n    color: theme.colors.whiteText,\r\n    fontSize: theme.fontSizes.mediumLarge,\r\n    fontWeight: 'bold',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  successMessage: {\r\n    color: theme.colors.success,\r\n    textAlign: 'center',\r\n    marginBottom: 10,\r\n    fontSize: theme.fontSizes.medium,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    width: '100%',\r\n  },\r\n  disabledButton: {\r\n    opacity: 0.7,\r\n  },\r\n});\r\n\r\nexport default ContactUs;\r\n","import React, { useState, useRef, useEffect, forwardRef, memo } from 'react';\r\nimport { View, TextInput, StyleSheet, Platform } from 'react-native';\r\nimport { IconButton, useTheme } from 'react-native-paper';\r\nimport { MaterialIcons } from '@expo/vector-icons';\r\n\r\nconst SearchBar = forwardRef(({ placeholder, onChangeText, initialValue = '', style }, ref) => {\r\n  const { colors } = useTheme();\r\n  const [value, setValue] = useState(initialValue);\r\n  const inputRef = useRef(null);\r\n\r\n  useEffect(() => {\r\n    if (initialValue !== value) {\r\n      setValue(initialValue);\r\n    }\r\n  }, [initialValue]);\r\n\r\n  const handleChangeText = (text) => {\r\n    if (text !== value) {\r\n      setValue(text);\r\n      onChangeText(text);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <View style={[styles.container, style, { backgroundColor: colors.surface }]}>\r\n      <IconButton\r\n        icon={() => <MaterialIcons name=\"search\" size={24} color={colors.primary} />}\r\n        onPress={() => inputRef.current?.focus()}\r\n      />\r\n      <TextInput\r\n        ref={inputRef}\r\n        style={[styles.input, { color: colors.text }]}\r\n        placeholder={placeholder}\r\n        placeholderTextColor={colors.placeholder}\r\n        value={value}\r\n        onChangeText={handleChangeText}\r\n        autoFocus={true}\r\n        keyboardType=\"default\"\r\n        returnKeyType=\"search\"\r\n        blurOnSubmit={false}\r\n      />\r\n    </View>\r\n  );\r\n});\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    borderRadius: 25, // Make it circular\r\n    elevation: 2,\r\n    shadowColor: '#000',\r\n    shadowOffset: { width: 0, height: 2 },\r\n    shadowOpacity: 0.1,\r\n    shadowRadius: 2,\r\n  },\r\n  input: {\r\n    flex: 1,\r\n    fontSize: 16,\r\n    paddingVertical: 8,\r\n    paddingRight: 8,\r\n  },\r\n});\r\n\r\nexport default memo(SearchBar);\r\n","import React, { useState, useEffect, useCallback, useMemo } from 'react';\r\nimport { View, StyleSheet, FlatList, TouchableOpacity, Platform, SafeAreaView, StatusBar, TouchableWithoutFeedback } from 'react-native';\r\nimport { Chip, Card, Title, Paragraph, Button, Portal, Modal, useTheme } from 'react-native-paper';\r\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\r\nimport { theme } from '../styles/theme';\r\nimport SearchBar from '../components/SearchBar';\r\nimport { mockOwners } from '../data/mockData';\r\n\r\nconst Owners = ({ navigation }) => {\r\n  const { colors } = useTheme();\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const [selectedFilters, setSelectedFilters] = useState([]);\r\n  const [tempFilters, setTempFilters] = useState([]);\r\n  const [isFilterModalVisible, setIsFilterModalVisible] = useState(false);\r\n  const [owners, setOwners] = useState([]);\r\n\r\n  useEffect(() => {\r\n    fetchOwners();\r\n  }, []);\r\n\r\n  const fetchOwners = async () => {\r\n    try {\r\n      await new Promise(resolve => setTimeout(resolve, 1000));\r\n      setOwners(mockOwners);\r\n    } catch (error) {\r\n      console.error('Error fetching owners:', error);\r\n    }\r\n  };\r\n\r\n  const filters = [\r\n    { label: 'Dog Sitting', value: 'Dog' },\r\n    { label: 'Cat Sitting', value: 'Cat' },\r\n    { label: 'Exotic Sitting', value: 'Exotic' },\r\n    { label: 'Last Week', value: 'week' },\r\n    { label: 'Last Month', value: 'month' },\r\n    { label: 'Last Year', value: 'year' },\r\n  ];\r\n\r\n  const toggleFilter = useCallback((filter) => {\r\n    setTempFilters(prevFilters =>\r\n      prevFilters.includes(filter)\r\n        ? prevFilters.filter(f => f !== filter)\r\n        : [...prevFilters, filter]\r\n    );\r\n  }, []);\r\n\r\n  const applyFilters = useCallback(() => {\r\n    setSelectedFilters(tempFilters);\r\n    setIsFilterModalVisible(false);\r\n  }, [tempFilters]);\r\n\r\n  const filteredOwners = useMemo(() => {\r\n    return owners.filter(owner => {\r\n      const matchesSearch = owner.name.toLowerCase().includes(searchQuery.toLowerCase());\r\n      const matchesFilters = selectedFilters.length === 0 || selectedFilters.every(filter => {\r\n        if (['Dog', 'Cat', 'Exotic'].includes(filter)) {\r\n          return owner.pet_types.includes(filter);\r\n        }\r\n        const lastBookingDate = new Date(owner.last_booking);\r\n        const currentDate = new Date();\r\n        switch (filter) {\r\n          case 'week':\r\n            const weekAgo = new Date();\r\n            weekAgo.setDate(currentDate.getDate() - 7);\r\n            return lastBookingDate >= weekAgo;\r\n          case 'month':\r\n            const monthAgo = new Date();\r\n            monthAgo.setMonth(currentDate.getMonth() - 1);\r\n            return lastBookingDate >= monthAgo;\r\n          case 'year':\r\n            const yearAgo = new Date();\r\n            yearAgo.setFullYear(currentDate.getFullYear() - 1);\r\n            return lastBookingDate >= yearAgo;\r\n          default:\r\n            return true;\r\n        }\r\n      });\r\n      return matchesSearch && matchesFilters;\r\n    });\r\n  }, [owners, searchQuery, selectedFilters]);\r\n\r\n  const renderOwner = useCallback(({ item }) => (\r\n    <TouchableOpacity onPress={() => navigation.navigate('OwnerHistory', { ownerId: item.id })}>\r\n      <Card style={styles.ownerCard}>\r\n        <Card.Content>\r\n          <Title>{item.name}</Title>\r\n          <Paragraph>Last booking: {item.last_booking}</Paragraph>\r\n          <View style={styles.petTypes}>\r\n            {item.pet_types.map(pet => (\r\n              <Chip key={pet} style={styles.petChip}>{pet}</Chip>\r\n            ))}\r\n          </View>\r\n        </Card.Content>\r\n      </Card>\r\n    </TouchableOpacity>\r\n  ), [navigation]);\r\n\r\n  const handleSearchChange = useCallback((query) => {\r\n    setSearchQuery(query);\r\n  }, []);\r\n\r\n  return Platform.OS === 'web' ? (\r\n    <View style={styles.container}>\r\n      <View style={styles.searchAndFilterContainer}>\r\n        <TouchableWithoutFeedback onPress={() => {}}>\r\n          <SearchBar\r\n            placeholder=\"Search owners\"\r\n            onChangeText={handleSearchChange}\r\n            initialValue={searchQuery}\r\n            style={styles.searchBar}\r\n          />\r\n        </TouchableWithoutFeedback>\r\n        <Button \r\n          mode=\"outlined\" \r\n          onPress={() => {\r\n            setTempFilters(selectedFilters);\r\n            setIsFilterModalVisible(true);\r\n          }}\r\n          style={styles.filterButton}\r\n        >\r\n          Filters\r\n        </Button>\r\n      </View>\r\n      {filteredOwners.length > 0 ? (\r\n        <FlatList\r\n          data={filteredOwners}\r\n          renderItem={renderOwner}\r\n          keyExtractor={item => item.id}\r\n          contentContainerStyle={styles.ownerList}\r\n          keyboardShouldPersistTaps=\"handled\"\r\n          removeClippedSubviews={false}\r\n        />\r\n      ) : (\r\n        <View style={styles.noOwnersContainer}>\r\n          <Paragraph>No owners match your search or filters.</Paragraph>\r\n        </View>\r\n      )}\r\n      <Portal>\r\n        <Modal visible={isFilterModalVisible} onDismiss={() => setIsFilterModalVisible(false)} contentContainerStyle={styles.modalContainer}>\r\n          <TouchableOpacity onPress={() => setIsFilterModalVisible(false)} style={styles.closeIcon}>\r\n            <MaterialCommunityIcons name=\"close\" size={24} color=\"black\" />\r\n          </TouchableOpacity>\r\n          <Title style={styles.modalTitle}>Filters</Title>\r\n          <View style={styles.filtersContainer}>\r\n            {filters.map(filter => (\r\n              <Chip\r\n                key={filter.value}\r\n                style={styles.filterChip}\r\n                selected={tempFilters.includes(filter.value)}\r\n                onPress={() => toggleFilter(filter.value)}\r\n                icon={tempFilters.includes(filter.value) ? ({size, color}) => (\r\n                  <MaterialCommunityIcons name=\"check\" size={size} color={color} />\r\n                ) : undefined}\r\n              >\r\n                {filter.label}\r\n              </Chip>\r\n            ))}\r\n          </View>\r\n          <Button mode=\"contained\" onPress={applyFilters} style={styles.applyButton}>\r\n            Apply Filters\r\n          </Button>\r\n        </Modal>\r\n      </Portal>\r\n    </View>\r\n  ) : (\r\n    <SafeAreaView style={[styles.container, styles.androidSafeArea]}>\r\n      <View style={styles.searchAndFilterContainer}>\r\n        <TouchableWithoutFeedback onPress={() => {}}>\r\n          <SearchBar\r\n            placeholder=\"Search owners\"\r\n            onChangeText={handleSearchChange}\r\n            initialValue={searchQuery}\r\n            style={styles.searchBar}\r\n          />\r\n        </TouchableWithoutFeedback>\r\n        <Button \r\n          mode=\"outlined\" \r\n          onPress={() => {\r\n            setTempFilters(selectedFilters);\r\n            setIsFilterModalVisible(true);\r\n          }}\r\n          style={styles.filterButton}\r\n        >\r\n          Filters\r\n        </Button>\r\n      </View>\r\n      {filteredOwners.length > 0 ? (\r\n        <FlatList\r\n          data={filteredOwners}\r\n          renderItem={renderOwner}\r\n          keyExtractor={item => item.id}\r\n          contentContainerStyle={styles.ownerList}\r\n          keyboardShouldPersistTaps=\"handled\"\r\n          removeClippedSubviews={false}\r\n        />\r\n      ) : (\r\n        <View style={styles.noOwnersContainer}>\r\n          <Paragraph>No owners match your search or filters.</Paragraph>\r\n        </View>\r\n      )}\r\n      <Portal>\r\n        <Modal visible={isFilterModalVisible} onDismiss={() => setIsFilterModalVisible(false)} contentContainerStyle={styles.modalContainer}>\r\n          <TouchableOpacity onPress={() => setIsFilterModalVisible(false)} style={styles.closeIcon}>\r\n            <MaterialCommunityIcons name=\"close\" size={24} color=\"black\" />\r\n          </TouchableOpacity>\r\n          <Title style={styles.modalTitle}>Filters</Title>\r\n          <View style={styles.filtersContainer}>\r\n            {filters.map(filter => (\r\n              <Chip\r\n                key={filter.value}\r\n                style={styles.filterChip}\r\n                selected={tempFilters.includes(filter.value)}\r\n                onPress={() => toggleFilter(filter.value)}\r\n                icon={tempFilters.includes(filter.value) ? ({size, color}) => (\r\n                  <MaterialCommunityIcons name=\"check\" size={size} color={color} />\r\n                ) : undefined}\r\n              >\r\n                {filter.label}\r\n              </Chip>\r\n            ))}\r\n          </View>\r\n          <Button mode=\"contained\" onPress={applyFilters} style={styles.applyButton}>\r\n            Apply Filters\r\n          </Button>\r\n        </Modal>\r\n      </Portal>\r\n    </SafeAreaView>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    backgroundColor: theme.colors.background,\r\n  },\r\n  androidSafeArea: {\r\n    paddingTop: Platform.OS === 'android' ? StatusBar.currentHeight : 0,\r\n  },\r\n  searchAndFilterContainer: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    margin: 16,\r\n    maxWidth: 600,\r\n    alignSelf: 'center',\r\n    width: '100%',\r\n  },\r\n  searchBar: {\r\n    flex: 1,\r\n    marginRight: 8,\r\n    marginLeft: Platform.OS === 'web' ? 0 : 8,\r\n  },\r\n  filterButton: {\r\n    minWidth: 80,\r\n    marginRight: Platform.OS === 'web' ? 0 : 8,\r\n  },\r\n  ownerList: {\r\n    padding: 16,\r\n  },\r\n  ownerCard: {\r\n    marginBottom: 16,\r\n    maxWidth: 600,\r\n    alignSelf: 'center',\r\n    width: '100%',\r\n  },\r\n  petTypes: {\r\n    flexDirection: 'row',\r\n    marginTop: 8,\r\n  },\r\n  petChip: {\r\n    marginRight: 8,\r\n  },\r\n  noOwnersContainer: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n  },\r\n  modalContainer: {\r\n    backgroundColor: 'white',\r\n    padding: 20,\r\n    margin: 20,\r\n    borderRadius: 5,\r\n    maxWidth: 600,\r\n    alignSelf: 'center',\r\n    width: '90%',\r\n  },\r\n  modalTitle: {\r\n    marginBottom: 10,\r\n  },\r\n  filtersContainer: {\r\n    flexDirection: 'row',\r\n    flexWrap: 'wrap',\r\n    marginBottom: 20,\r\n  },\r\n  filterChip: {\r\n    margin: 4,\r\n  },\r\n  applyButton: {\r\n    marginTop: 10,\r\n  },\r\n  closeButton: {\r\n    marginTop: 10,\r\n    alignSelf: 'flex-end',\r\n  },\r\n  closeIcon: {\r\n    position: 'absolute',\r\n    top: 10,\r\n    right: 10,\r\n    zIndex: 1,\r\n  },\r\n});\r\n\r\nexport default Owners;\r\n","import React, { useState, useEffect } from 'react';\r\nimport {\r\n  Modal,\r\n  View,\r\n  Text,\r\n  TouchableOpacity,\r\n  StyleSheet,\r\n  ScrollView,\r\n  Switch,\r\n} from 'react-native';\r\nimport DateTimePicker from '@react-native-community/datetimepicker';\r\nimport DatePicker from './DatePicker';\r\nimport { theme } from '../styles/theme';\r\nimport { MaterialIcons } from '@expo/vector-icons';\r\n\r\nexport const CostCalculationModal = ({\r\n  visible,\r\n  onClose,\r\n  serviceName,\r\n  additionalRates = [],\r\n  professionalName = \"Professional\",\r\n  onContactPress,\r\n}) => {\r\n  const [startDate, setStartDate] = useState(new Date());\r\n  const [endDate, setEndDate] = useState(new Date());\r\n  const [additionalAnimals, setAdditionalAnimals] = useState(0);\r\n  const [isHolidayRate, setIsHolidayRate] = useState(false);\r\n  const [selectedRates, setSelectedRates] = useState({});\r\n  const [totalCost, setTotalCost] = useState(0);\r\n  const [platformFees, setPlatformFees] = useState(0);\r\n\r\n  const BASE_RATE = 20;\r\n  const ADDITIONAL_ANIMAL_RATE = 10;\r\n  const HOLIDAY_RATE = 40;\r\n  const PLATFORM_FEE_PERCENTAGE = 0.10;\r\n\r\n  const calculateTotalCost = () => {\r\n    // Start with either holiday rate or base rate\r\n    let subtotal = isHolidayRate ? HOLIDAY_RATE : BASE_RATE;\r\n    \r\n    // Add additional animal costs\r\n    subtotal += additionalAnimals * ADDITIONAL_ANIMAL_RATE;\r\n    \r\n    // Add any selected additional rates\r\n    Object.entries(selectedRates).forEach(([_, rate]) => {\r\n      if (rate.selected) {\r\n        subtotal += rate.amount;\r\n      }\r\n    });\r\n\r\n    setTotalCost(subtotal);\r\n    setPlatformFees(subtotal * PLATFORM_FEE_PERCENTAGE);\r\n  };\r\n\r\n  useEffect(() => {\r\n    // Initialize selectedRates object\r\n    const ratesObj = {};\r\n    additionalRates.forEach(rate => {\r\n      ratesObj[rate.title] = { ...rate, selected: false };\r\n    });\r\n    setSelectedRates(ratesObj);\r\n  }, [additionalRates]);\r\n\r\n  useEffect(() => {\r\n    calculateTotalCost();\r\n  }, [additionalAnimals, isHolidayRate, selectedRates]);\r\n\r\n  return (\r\n    <Modal\r\n      visible={visible}\r\n      animationType=\"slide\"\r\n      transparent={true}\r\n      onRequestClose={onClose}\r\n    >\r\n      <View style={styles.modalContainer}>\r\n        <View style={styles.modalContent}>\r\n          <TouchableOpacity \r\n            style={styles.closeIcon} \r\n            onPress={onClose}\r\n          >\r\n            <MaterialIcons name=\"close\" size={24} color={theme.colors.text} />\r\n          </TouchableOpacity>\r\n\r\n          <Text style={styles.modalTitle}>{serviceName}</Text>\r\n          \r\n          <ScrollView \r\n            style={styles.scrollContent} \r\n            showsVerticalScrollIndicator={true}\r\n            persistentScrollbar={true}\r\n          >\r\n            {/* Date Selection\r\n            <View style={styles.dateSection}>\r\n              <View style={styles.dateColumn}>\r\n                <Text style={styles.dateLabel}>Start Date:</Text>\r\n                <DatePicker\r\n                  value={startDate}\r\n                  mode=\"date\"\r\n                  onChange={(event, date) => {\r\n                    if (date) setStartDate(date);\r\n                  }}\r\n                />\r\n              </View>\r\n              \r\n              <View style={styles.dateColumn}>\r\n                <Text style={styles.dateLabel}>End Date:</Text>\r\n                <DatePicker\r\n                  value={endDate}\r\n                  mode=\"date\"\r\n                  onChange={(event, date) => {\r\n                    if (date) setEndDate(date);\r\n                  }}\r\n                />\r\n              </View>\r\n            </View> */}\r\n\r\n            {/* Base Rate */}\r\n            <View style={styles.rateItem}>\r\n              <Text>Base Rate</Text>\r\n              <Text>${BASE_RATE}</Text>\r\n            </View>\r\n\r\n            {/* Additional Animals */}\r\n            <View style={styles.rateItem}>\r\n              <Text>Additional Animals (${ADDITIONAL_ANIMAL_RATE} each)</Text>\r\n              <View style={styles.counterContainer}>\r\n                <TouchableOpacity \r\n                  onPress={() => setAdditionalAnimals(Math.max(0, additionalAnimals - 1))}\r\n                  style={styles.counterButton}\r\n                >\r\n                  <MaterialIcons name=\"remove\" size={24} color={theme.colors.primary} />\r\n                </TouchableOpacity>\r\n                <Text style={styles.counterText}>{additionalAnimals}</Text>\r\n                <TouchableOpacity \r\n                  onPress={() => setAdditionalAnimals(additionalAnimals + 1)}\r\n                  style={styles.counterButton}\r\n                >\r\n                  <MaterialIcons name=\"add\" size={24} color={theme.colors.primary} />\r\n                </TouchableOpacity>\r\n              </View>\r\n            </View>\r\n\r\n            {/* Holiday Rate */}\r\n            <View style={styles.rateItem}>\r\n              <Text>Holiday Rate (${HOLIDAY_RATE})</Text>\r\n              <Switch\r\n                value={isHolidayRate}\r\n                onValueChange={setIsHolidayRate}\r\n                trackColor={{ false: \"#767577\", true: theme.colors.primary }}\r\n              />\r\n            </View>\r\n\r\n            {/* Additional Rates */}\r\n            {Object.entries(selectedRates).map(([title, rate]) => (\r\n              <View key={title} style={styles.rateItem}>\r\n                <Text>{title} (${rate.amount})</Text>\r\n                <Switch\r\n                  value={rate.selected}\r\n                  onValueChange={(value) => {\r\n                    setSelectedRates({\r\n                      ...selectedRates,\r\n                      [title]: { ...rate, selected: value },\r\n                    });\r\n                  }}\r\n                  trackColor={{ false: \"#767577\", true: theme.colors.primary }}\r\n                />\r\n              </View>\r\n            ))}\r\n\r\n            {/* Total and Fees */}\r\n            <View style={styles.totalSection}>\r\n              <View style={styles.totalItem}>\r\n                <Text style={styles.totalLabel}>Subtotal:</Text>\r\n                <Text style={styles.totalAmount}>${totalCost}</Text>\r\n              </View>\r\n              <View style={styles.totalItem}>\r\n                <Text style={styles.totalLabel}>Service Fees (10%):</Text>\r\n                <Text style={styles.totalAmount}>${platformFees.toFixed(2)}</Text>\r\n              </View>\r\n              <View style={[styles.totalItem, styles.finalTotal]}>\r\n                <Text style={[styles.totalLabel, styles.finalTotalText]}>Total Cost:</Text>\r\n                <Text style={[styles.totalAmount, styles.finalTotalText]}>${(totalCost + platformFees).toFixed(2)}</Text>\r\n              </View>\r\n            </View>\r\n          </ScrollView>\r\n\r\n          <TouchableOpacity \r\n            style={styles.contactButton} \r\n            onPress={onContactPress}\r\n          >\r\n            <Text style={styles.contactButtonText}>Contact {professionalName}</Text>\r\n          </TouchableOpacity>\r\n        </View>\r\n      </View>\r\n    </Modal>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  modalContainer: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    backgroundColor: 'rgba(0, 0, 0, 0.5)',\r\n  },\r\n  modalContent: {\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 12,\r\n    padding: 20,\r\n    paddingRight: 15,\r\n    width: '90%',\r\n    maxHeight: '43%',\r\n    maxWidth: 400,\r\n  },\r\n  scrollContent: {\r\n    flexGrow: 0,\r\n    marginBottom: 10,\r\n    paddingRight: 12,\r\n    marginRight: -7,\r\n  },\r\n  modalTitle: {\r\n    fontSize: theme.fontSizes.large,\r\n    fontWeight: 'bold',\r\n    marginBottom: 15,\r\n    textAlign: 'center',\r\n    marginTop: 5,\r\n    paddingHorizontal: 30,\r\n  },\r\n  dateSection: {\r\n    marginBottom: 20,\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    gap: 16,\r\n  },\r\n  dateColumn: {\r\n    flex: 1,\r\n  },\r\n  dateLabel: {\r\n    marginBottom: 8,\r\n    fontSize: theme.fontSizes.smallMedium,\r\n    color: theme.colors.text,\r\n  },\r\n  rateItem: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    marginBottom: 15,\r\n  },\r\n  counterContainer: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n  },\r\n  counterButton: {\r\n    padding: 5,\r\n  },\r\n  counterText: {\r\n    marginHorizontal: 10,\r\n    fontSize: theme.fontSizes.medium,\r\n  },\r\n  totalSection: {\r\n    marginTop: 20,\r\n    borderTopWidth: 1,\r\n    borderTopColor: theme.colors.border,\r\n    paddingTop: 15,\r\n  },\r\n  totalItem: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    marginBottom: 10,\r\n  },\r\n  finalTotal: {\r\n    borderTopWidth: 1,\r\n    borderTopColor: theme.colors.border,\r\n    paddingTop: 10,\r\n    marginTop: 5,\r\n  },\r\n  totalLabel: {\r\n    fontSize: theme.fontSizes.medium,\r\n    fontWeight: '600',\r\n  },\r\n  totalAmount: {\r\n    fontSize: theme.fontSizes.medium,\r\n    fontWeight: 'bold',\r\n  },\r\n  finalTotalText: {\r\n    fontSize: theme.fontSizes.mediumLarge,\r\n    fontWeight: 'bold',\r\n    color: theme.colors.primary,\r\n  },\r\n  closeButton: {\r\n    backgroundColor: theme.colors.primary,\r\n    padding: 12,\r\n    borderRadius: 8,\r\n    alignItems: 'center',\r\n    marginTop: 10,\r\n  },\r\n  closeButtonText: {\r\n    color: theme.colors.surface,\r\n    fontSize: theme.fontSizes.medium,\r\n    fontWeight: '600',\r\n  },\r\n  closeIcon: {\r\n    position: 'absolute',\r\n    right: 15,\r\n    top: 15,\r\n    zIndex: 1,\r\n    padding: 5,\r\n  },\r\n  contactButton: {\r\n    backgroundColor: theme.colors.primary,\r\n    padding: 12,\r\n    borderRadius: 8,\r\n    alignItems: 'center',\r\n    marginTop: 10,\r\n  },\r\n  contactButtonText: {\r\n    color: theme.colors.surface,\r\n    fontSize: theme.fontSizes.medium,\r\n    fontWeight: '600',\r\n  },\r\n});\r\n","import React, { useState } from 'react';\r\nimport { View, Text, TouchableOpacity, StyleSheet } from 'react-native';\r\nimport { MaterialCommunityIcons, MaterialIcons } from '@expo/vector-icons';\r\nimport { theme } from '../styles/theme';\r\nimport { CostCalculationModal } from './CostCalculationModal';\r\nimport { mockConversations, mockMessages, createNewConversation } from '../data/mockData';\r\n\r\nexport const ServiceCard = ({ \r\n  service, \r\n  onHeartPress, \r\n  isFavorite, \r\n  professionalName,\r\n  professionalId,\r\n  navigation\r\n}) => {\r\n  const [isModalVisible, setIsModalVisible] = useState(false);\r\n\r\n  const handleContactPress = () => {\r\n    // Check if conversation already exists\r\n    const existingConversation = mockConversations.find(\r\n      conv => conv.professionalId === professionalId\r\n    );\r\n\r\n    if (existingConversation) {\r\n      navigation.replace('MessageHistory', {\r\n        selectedConversation: existingConversation.id,\r\n        professionalName: professionalName,\r\n        professionalId: professionalId\r\n      });\r\n    } else {\r\n      // Create new conversation using the helper function\r\n      const newConversation = createNewConversation(\r\n        professionalId,\r\n        professionalName,\r\n        'current_user_id', // Replace with actual current user ID\r\n        'Me' // Current user name\r\n      );\r\n\r\n      // Add new conversation to mockConversations\r\n      mockConversations.unshift(newConversation);\r\n\r\n      // Initialize empty messages array for this conversation\r\n      mockMessages[newConversation.id] = [];\r\n\r\n      // Navigate directly to MessageHistory\r\n      navigation.replace('MessageHistory', {\r\n        selectedConversation: newConversation.id,\r\n        professionalName: professionalName,\r\n        professionalId: professionalId\r\n      });\r\n    }\r\n    setIsModalVisible(false);\r\n  };\r\n\r\n  return (\r\n    <View style={styles.serviceCard}>\r\n      {/* <TouchableOpacity \r\n        style={styles.heartButton}\r\n        onPress={() => onHeartPress(service.id)}\r\n      >\r\n        <MaterialIcons \r\n          name={isFavorite ? \"favorite\" : \"favorite-border\"} \r\n          size={24} \r\n          color={theme.colors.primary} \r\n        />\r\n      </TouchableOpacity> */}\r\n      \r\n      <View style={styles.contentContainer}>\r\n        <MaterialCommunityIcons name={service.icon} size={30} color={theme.colors.primary} />\r\n        <Text numberOfLines={2} style={styles.serviceName}>{service.name}</Text>\r\n        <Text style={styles.startingPrice}>Starting at ${service.startingPrice}</Text>\r\n        <View style={styles.animalTypeContainer}>\r\n          {service.animalTypes.map((type, index) => (\r\n            <Text key={index} style={styles.animalType}>{type}</Text>\r\n          ))}\r\n        </View>\r\n      </View>\r\n\r\n      <TouchableOpacity \r\n        style={styles.calculateButton}\r\n        onPress={() => setIsModalVisible(true)}\r\n      >\r\n        <Text style={styles.calculateButtonText}>Calculate Cost</Text>\r\n      </TouchableOpacity>\r\n\r\n      <CostCalculationModal\r\n        visible={isModalVisible}\r\n        onClose={() => setIsModalVisible(false)}\r\n        serviceName={service.name}\r\n        additionalRates={service.additionalRates || []}\r\n        professionalName={professionalName}\r\n        professionalId={professionalId}\r\n        onContactPress={handleContactPress}\r\n      />\r\n    </View>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  serviceCard: {\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 12,\r\n    padding: 12,\r\n    marginRight: 12,\r\n    width: 280,\r\n    height: 220,\r\n    shadowColor: '#000',\r\n    shadowOffset: { width: 0, height: 2 },\r\n    shadowOpacity: 0.1,\r\n    shadowRadius: 4,\r\n    elevation: 3,\r\n    position: 'relative',\r\n    justifyContent: 'space-between',\r\n  },\r\n  heartButton: {\r\n    position: 'absolute',\r\n    right: 8,\r\n    top: 8,\r\n    zIndex: 1,\r\n  },\r\n  serviceName: {\r\n    fontSize: theme.fontSizes.mediumLarge,\r\n    fontWeight: '600',\r\n    marginTop: 8,\r\n    marginBottom: 6,\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n    flexShrink: 1,\r\n  },\r\n  startingPrice: {\r\n    fontSize: theme.fontSizes.medium + 2,\r\n    color: theme.colors.secondary,\r\n    marginBottom: 6,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  animalTypeContainer: {\r\n    flexDirection: 'row',\r\n    flexWrap: 'wrap',\r\n    gap: 4,\r\n    marginBottom: 8,\r\n  },\r\n  animalType: {\r\n    fontSize: theme.fontSizes.small + 2,\r\n    color: theme.colors.secondary,\r\n    backgroundColor: theme.colors.background,\r\n    borderRadius: 8,\r\n    paddingHorizontal: 6,\r\n    paddingVertical: 2,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  calculateButton: {\r\n    backgroundColor: theme.colors.primary,\r\n    padding: 10,\r\n    borderRadius: 8,\r\n    alignItems: 'center',\r\n    marginTop: 'auto',\r\n  },\r\n  calculateButtonText: {\r\n    color: theme.colors.surface,\r\n    fontSize: theme.fontSizes.medium,\r\n    fontWeight: '600',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  contentContainer: {\r\n    flex: 1,\r\n  },\r\n});\r\n\r\nexport default ServiceCard;","import React, { useState, useEffect, useContext } from 'react';\r\nimport { View, Text, StyleSheet, ScrollView, Image, TouchableOpacity, Platform, useWindowDimensions, Modal } from 'react-native';\r\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\r\nimport { theme } from '../styles/theme';\r\nimport BackHeader from '../components/BackHeader';\r\nimport CrossPlatformView from '../components/CrossPlatformView';\r\nimport * as ImagePicker from 'expo-image-picker';\r\nimport { useNavigation } from '@react-navigation/native';\r\nimport { AuthContext } from '../context/AuthContext';\r\nimport { Calendar } from 'react-native-calendars';\r\nimport { mockPets } from '../data/mockData';\r\nimport AsyncStorage from '@react-native-async-storage/async-storage';\r\nimport { SCREEN_WIDTH } from '../context/AuthContext';\r\nimport ServiceCard from '../components/ServiceCard';\r\nimport { mockServicesForCards } from '../data/mockData';\r\nimport { mockConversations, mockMessages } from '../data/mockData';\r\n// Conditionally import WebMap component\r\nconst WebMap = Platform.OS === 'web' ? require('react-leaflet').MapContainer : null;\r\n\r\n// Mock API function to fetch profile data\r\nconst fetchProfileData = () => {\r\n  return new Promise((resolve) => {\r\n    setTimeout(() => {\r\n      resolve({\r\n        // profilePhoto: 'https://example.com/profile-photo.jpg',\r\n        bio: \"Hi! I'm an experienced pet professional who loves all animals. I have 5 years of experience caring for dogs, cats, and exotic pets.\",\r\n        petPhotos: [\r\n          // 'https://example.com/pet-photo-1.jpg',\r\n          // 'https://example.com/pet-photo-2.jpg',\r\n        ],\r\n        services: ['Dog Boarding', 'Dog Walking', 'Drop-In Visits', 'House Sitting'],\r\n        rates: {\r\n          boarding: '35',\r\n          daycare: '25',\r\n          houseSitting: '40',\r\n          dropInVisits: '20',\r\n          dogWalking: '15'\r\n        },\r\n        name: 'John Doe',\r\n        location: 'New York, NY'\r\n      });\r\n    }, 1000);\r\n  });\r\n};\r\n\r\nconst mockReviews = [\r\n  {\r\n    id: 1,\r\n    name: 'Noah M.',\r\n    service: 'Fish Tank Cleaning',\r\n    date: 'Dec 02, 2024',\r\n    rating: 5,\r\n    text: 'Dina was fantastic with our dog! Sent lots of photos and clearly made sure she was comfortable. Will definitely use again!',\r\n    photo: 'https://via.placeholder.com/50'\r\n  },\r\n  {\r\n    id: 2,\r\n    name: 'Kaily J.',\r\n    service: 'Ferrier',\r\n    date: 'Nov 26, 2024',\r\n    rating: 4,\r\n    text: 'Dina always takes such good care of Elijah. He was having tummy problems today and she kept me updated all day on how he was doing.',\r\n    photo: 'https://via.placeholder.com/50'\r\n  },\r\n  {\r\n    id: 3,\r\n    name: 'Nadia U.',\r\n    service: 'Reptile Boarding & Habitat Maintenance',\r\n    date: 'Nov 19, 2024',\r\n    rating: 5,\r\n    text: 'She took such great care of our puppy! Sent pictures and videos the whole time, her backyard was super nice and clean ❤️ my puppy was definitely in great hands! Bonus her dogs were so sweet with our puppy.',\r\n    photo: 'https://via.placeholder.com/50'\r\n  },\r\n  {\r\n    id: 4,\r\n    name: 'Vanessa G.',\r\n    service: 'Bird Feeding',\r\n    date: 'Nov 19, 2024',\r\n    rating: 5,\r\n    text: 'Dina was great! She communicated through the whole stay and sent plenty of videos and photos. 10/10',\r\n    photo: 'https://via.placeholder.com/50'\r\n  }\r\n];\r\n\r\nconst useResponsiveLayout = () => {\r\n  const { width } = useWindowDimensions();\r\n  const [isWideScreen, setIsWideScreen] = useState(true);\r\n\r\n  useEffect(() => {\r\n    setIsWideScreen(Platform.OS === 'web' && width >= 900);\r\n  }, [width]);\r\n\r\n  return isWideScreen;\r\n};\r\n\r\n// Move this outside the component\r\nif (Platform.OS === 'web') {\r\n  const style = document.createElement('style');\r\n  style.textContent = `\r\n    .services-scroll::-webkit-scrollbar {\r\n      -webkit-appearance: none;\r\n    }\r\n\r\n    .services-scroll::-webkit-scrollbar:vertical {\r\n      width: 11px;\r\n    }\r\n\r\n    .services-scroll::-webkit-scrollbar:horizontal {\r\n      height: 11px;\r\n    }\r\n\r\n    .services-scroll::-webkit-scrollbar-thumb {\r\n      border-radius: 8px;\r\n      border: 2px solid white;\r\n      background-color: rgba(0, 0, 0, .5);\r\n    }\r\n  `;\r\n  document.head.appendChild(style);\r\n}\r\n\r\nconst ProfessionalProfile = ({ route, navigation }) => {\r\n  const { width: windowWidth } = useWindowDimensions();\r\n  const { screenWidth, isCollapsed, is_DEBUG } = useContext(AuthContext);\r\n  const [professionalData, setProfessionalData] = useState(null);\r\n  const [canGoBack, setCanGoBack] = useState(false);\r\n  const [bioModalVisible, setBioModalVisible] = useState(false);\r\n  const [reviewsModalVisible, setReviewsModalVisible] = useState(false);\r\n  const [specialistModalVisible, setSpecialistModalVisible] = useState(false);\r\n  const [favoriteServices, setFavoriteServices] = useState([]);\r\n  const [servicesModalVisible, setServicesModalVisible] = useState(false);\r\n  const [isMobile, setIsMobile] = useState(screenWidth <= 900);\r\n  const isWideScreen = useResponsiveLayout();\r\n\r\n  // Calculate marginLeft to account for sidebar on desktop\r\n  const marginLeft = screenWidth > 900 ? (isCollapsed ? 70 : 250) : 0;\r\n\r\n  // Debug component lifecycle\r\n  useEffect(() => {\r\n    if (is_DEBUG) {\r\n      console.log('MBA9999: ProfessionalProfile component mounted');\r\n    }\r\n    return () => {\r\n      if (is_DEBUG) {\r\n        console.log('MBA9999: ProfessionalProfile component unmounting');\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  // Debug professional data changes\r\n  useEffect(() => {\r\n    if (is_DEBUG) {\r\n      console.log('MBA9999: Professional data changed:', professionalData ? professionalData.name : 'null');\r\n    }\r\n  }, [professionalData]);\r\n\r\n  useEffect(() => {\r\n    const updateLayout = () => {\r\n      setIsMobile(screenWidth <= 900);\r\n    };\r\n    updateLayout();\r\n  }, [screenWidth]);\r\n\r\n  useEffect(() => {\r\n    // Check if we can go back and if SearchProfessionalsListing exists in history\r\n    const state = navigation.getState();\r\n    const hasHistory = state.routes.some(route => route.name === 'SearchProfessionalsListing');\r\n    setCanGoBack(navigation.canGoBack() && hasHistory);\r\n  }, [navigation]);\r\n\r\n  const handleBack = () => {\r\n    if (is_DEBUG) {\r\n      console.log('MBA9999: handleBack called, Platform:', Platform.OS);\r\n    }\r\n    \r\n    if (Platform.OS === 'web') {\r\n      sessionStorage.removeItem('currentProfessional');\r\n      if (is_DEBUG) {\r\n        console.log('MBA9999: Navigating back to SearchProfessionalsListing');\r\n      }\r\n      // Always use navigate to ensure consistent behavior\r\n      navigation.navigate('SearchProfessionalsListing');\r\n    } else {\r\n      if (is_DEBUG) {\r\n        console.log('MBA9999: Using navigation.goBack()');\r\n      }\r\n      navigation.goBack();\r\n    }\r\n  };\r\n\r\n  // Handle browser back button - REMOVED due to causing navigation issues\r\n  // The browser's native back button will work with React Navigation\r\n  // useEffect(() => {\r\n  //   if (Platform.OS === 'web') {\r\n  //     // Popstate handling removed - was causing automatic navigation\r\n  //   }\r\n  // }, []);\r\n\r\n  useEffect(() => {\r\n    const loadProfessionalData = async () => {\r\n      if (is_DEBUG) {\r\n        console.log('MBA9999: loadProfessionalData called', {\r\n          hasRouteParams: !!route?.params?.professional,\r\n          platform: Platform.OS\r\n        });\r\n      }\r\n      \r\n      if (route?.params?.professional) {\r\n        if (is_DEBUG) {\r\n          console.log('MBA9999: Setting professional data from route params:', route.params.professional.name);\r\n        }\r\n        setProfessionalData(route.params.professional);\r\n        // Also store in sessionStorage for web reload persistence\r\n        if (Platform.OS === 'web') {\r\n          sessionStorage.setItem('currentProfessional', JSON.stringify(route.params.professional));\r\n        }\r\n      } else if (Platform.OS === 'web') {\r\n        // Try to get professional data from sessionStorage on web reload\r\n        const storedProfessional = sessionStorage.getItem('currentProfessional');\r\n        if (is_DEBUG) {\r\n          console.log('MBA9999: Checking sessionStorage for professional data:', !!storedProfessional);\r\n        }\r\n        \r\n        if (storedProfessional) {\r\n          try {\r\n            const parsedProfessional = JSON.parse(storedProfessional);\r\n            if (is_DEBUG) {\r\n              console.log('MBA9999: Setting professional data from sessionStorage:', parsedProfessional.name);\r\n            }\r\n            setProfessionalData(parsedProfessional);\r\n          } catch (error) {\r\n            console.error('MBA9999: Error parsing stored professional data:', error);\r\n            // Only redirect if we can't parse the data\r\n            navigation.replace('SearchProfessionalsListing');\r\n          }\r\n        } else {\r\n          if (is_DEBUG) {\r\n            console.log('MBA9999: No professional data found, redirecting to search');\r\n          }\r\n          // If no data, redirect back to search\r\n          navigation.replace('SearchProfessionalsListing');\r\n        }\r\n      }\r\n    };\r\n\r\n    loadProfessionalData();\r\n  }, [route?.params?.professional, navigation, is_DEBUG]);\r\n\r\n  // Store professional data in AsyncStorage for mobile\r\n  useEffect(() => {\r\n    if (Platform.OS !== 'web' && professionalData) {\r\n      AsyncStorage.setItem('currentProfessional', JSON.stringify(professionalData));\r\n    }\r\n  }, [professionalData]);\r\n\r\n  const getContentWidth = () => {\r\n    if (Platform.OS === 'web') {\r\n      // Account for sidebar width on desktop\r\n      const availableWidth = screenWidth > 900 \r\n        ? windowWidth - (isCollapsed ? 70 : 250) \r\n        : windowWidth;\r\n      return Math.min(1000, availableWidth - 32); // 32px for padding\r\n    }\r\n    return windowWidth - 32; // 16px padding on each side\r\n  };\r\n\r\n  const toggleFavorite = (serviceId) => {\r\n    setFavoriteServices(prev => \r\n      prev.includes(serviceId) \r\n        ? prev.filter(id => id !== serviceId)\r\n        : [...prev, serviceId]\r\n    );\r\n  };\r\n\r\n  const renderServices = () => (\r\n    <View style={styles.servicesSection}>\r\n      <View style={styles.sectionHeader}>\r\n        <Text style={styles.sectionTitle}>Services</Text>\r\n        <TouchableOpacity \r\n          style={styles.seeAllButton}\r\n          onPress={() => setServicesModalVisible(true)}\r\n        >\r\n          <Text style={styles.seeAllButtonText}>See All</Text>\r\n        </TouchableOpacity>\r\n      </View>\r\n      <View style={styles.servicesWrapper}>\r\n        <ScrollView \r\n          horizontal\r\n          showsHorizontalScrollIndicator={true}\r\n          style={[\r\n            styles.servicesScroll,\r\n            Platform.OS === 'web' && { \r\n              className: 'services-scroll',\r\n              overflowX: 'scroll'\r\n            }\r\n          ]}\r\n          contentContainerStyle={styles.servicesScrollContent}\r\n          persistentScrollbar={true}\r\n        >\r\n          {mockServicesForCards.slice(0, 5).map(service => (\r\n            <ServiceCard \r\n              key={service.id}\r\n              service={service}\r\n              onHeartPress={toggleFavorite}\r\n              isFavorite={favoriteServices.includes(service.id)}\r\n              professionalName={professionalData.name}\r\n              professionalId={professionalData.id}\r\n              navigation={navigation}\r\n            />\r\n          ))}\r\n        </ScrollView>\r\n      </View>\r\n    </View>\r\n  );\r\n\r\n  if (!professionalData) {\r\n    return (\r\n      <CrossPlatformView fullWidthHeader={true}>\r\n        <BackHeader \r\n          title=\"Professional Profile\" \r\n          onBackPress={handleBack}\r\n        />\r\n        <View style={styles.centered}>\r\n          <Text>Loading...</Text>\r\n        </View>\r\n      </CrossPlatformView>\r\n    );\r\n  }\r\n\r\n  const renderProfilePhoto = () => {\r\n    if (professionalData.profilePicture) {\r\n      return <Image source={{ uri: professionalData.profilePicture }} style={styles.profilePhoto} />;\r\n    }\r\n    return (\r\n      <View style={[styles.profilePhoto, styles.profilePhotoPlaceholder]}>\r\n        <MaterialCommunityIcons name=\"account\" size={80} color={theme.colors.primary} />\r\n      </View>\r\n    );\r\n  };\r\n\r\n  const renderSpecialistExperience = () => (\r\n    <View style={styles.specialistSection}>\r\n      <Text style={styles.sectionTitle}>Specialist Experience</Text>\r\n      <TruncatedText text={professionalData?.bio || ''} />\r\n    </View>\r\n  );\r\n\r\n  const renderRatingStars = () => (\r\n    <View style={styles.ratingContainer}>\r\n      <MaterialCommunityIcons name=\"star\" size={24} color={theme.colors.primary} />\r\n      <Text style={styles.rating}>{professionalData.reviews}</Text>\r\n      <Text style={[styles.reviewCount, { marginLeft: 12 }]}>({professionalData.reviewCount || 50} reviews)</Text>\r\n    </View>\r\n  );\r\n\r\n  // Add new component for truncated text with Read More\r\n  const TruncatedText = ({ text, maxLines = 3 }) => (\r\n    <View>\r\n      <Text \r\n        numberOfLines={maxLines} \r\n        style={styles.specialistText}\r\n      >\r\n        {text}\r\n      </Text>\r\n      <TouchableOpacity \r\n        style={styles.readMoreButton}\r\n        onPress={() => setSpecialistModalVisible(true)}\r\n      >\r\n        <Text style={styles.readMoreText}>Read more</Text>\r\n      </TouchableOpacity>\r\n    </View>\r\n  );\r\n\r\n  const renderMap = () => {\r\n    if (Platform.OS === 'web' && WebMap) {\r\n      const { MapContainer, TileLayer, Marker } = require('react-leaflet');\r\n      return (\r\n        <View style={styles.mapContainer}>\r\n          <MapContainer\r\n            center={[38.8339, -104.8214]} // Default coordinates\r\n            zoom={13}\r\n            style={{ height: 400, width: '100%' }}\r\n          >\r\n            <TileLayer\r\n              url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\r\n              attribution='&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\r\n            />\r\n            <Marker position={[38.8339, -104.8214]} />\r\n          </MapContainer>\r\n        </View>\r\n      );\r\n    }\r\n    // For mobile, return null or a placeholder\r\n    return null;\r\n  };\r\n\r\n  const renderPets = () => {\r\n    if (!mockPets || mockPets.length === 0) return null;\r\n    \r\n    return (\r\n      <View style={styles.petsSection}>\r\n        <Text style={styles.sectionTitle}>Pets</Text>\r\n        {mockPets.map((pet, index) => (\r\n          <View key={pet.id} style={styles.petItem}>\r\n            <View style={styles.petPhoto}>\r\n              <MaterialCommunityIcons \r\n                name={pet.animal_type.toLowerCase() === 'dog' ? 'dog' : \r\n                      pet.animal_type.toLowerCase() === 'cat' ? 'cat' : 'snake'} \r\n                size={30} \r\n                color={theme.colors.primary} \r\n              />\r\n            </View>\r\n            <View style={styles.petInfo}>\r\n              <Text style={styles.petName}>{pet.name}</Text>\r\n              <Text style={styles.petBreed}>{pet.breed}</Text>\r\n              <Text style={styles.petDetails}>\r\n                {`${pet.weight} lbs, ${pet.age.years} years${pet.age.months ? ` ${pet.age.months} months` : ''}`}\r\n              </Text>\r\n            </View>\r\n          </View>\r\n        ))}\r\n      </View>\r\n    );\r\n  };\r\n\r\n  const styles2 = StyleSheet.create({\r\n    modalContent: {\r\n      backgroundColor: theme.colors.background,\r\n      padding: 24,\r\n      borderRadius: 12,\r\n      width: Platform.OS === 'web' ? \r\n        (screenWidth <= 650 ? '90%' : '60%') : \r\n        '90%',\r\n      maxWidth: 800,\r\n      maxHeight: '90%',\r\n    },\r\n  });\r\n\r\n  // Create services array from professionalData\r\n  const services = [\r\n    { name: 'Boarding', price: \"25\" },\r\n    { name: 'Doggy Day Care', price: \"30\" },\r\n    { name: 'House Sitting', price: \"40\" },\r\n    { name: 'Drop-In Visits', price: \"35\" },\r\n    { name: 'Dog Walking', price: \"45\" }\r\n  ];\r\n\r\n  const HomeFeature = ({ text }) => (\r\n    <View style={styles.featureBubble}>\r\n      <Text style={styles.featureText}>{text}</Text>\r\n    </View>\r\n  );\r\n\r\n  const renderReviews = () => (\r\n    <View style={styles.reviewsSection}>\r\n      <Text style={styles.sectionTitle}>Reviews</Text>\r\n      <View style={styles.reviewsGrid}>\r\n        {mockReviews.slice(0, 4).map(renderReview)}\r\n      </View>\r\n      <TouchableOpacity \r\n        style={styles.readMoreButton}\r\n        onPress={() => setReviewsModalVisible(true)}\r\n      >\r\n        <Text style={styles.readMoreText}>Read more reviews</Text>\r\n      </TouchableOpacity>\r\n    </View>\r\n  );\r\n\r\n  const renderReview = (review) => (\r\n    <View key={review.id} style={styles.reviewItem}>\r\n      <View style={styles.reviewHeader}>\r\n        <Image source={{ uri: review.photo }} style={styles.reviewerPhoto} />\r\n        <View style={styles.reviewerInfo}>\r\n          <Text style={styles.reviewerName}>{review.name}</Text>\r\n          <View style={styles.reviewMeta}>\r\n            <View style={styles.starContainer}>\r\n              {[...Array(5)].map((_, index) => (\r\n                <MaterialCommunityIcons\r\n                  key={index}\r\n                  name={index < review.rating ? \"star\" : \"star-outline\"}\r\n                  size={16}\r\n                  color={theme.colors.primary}\r\n                />\r\n              ))}\r\n            </View>\r\n            <View style={styles.serviceInfo}>\r\n              <MaterialCommunityIcons name=\"home\" size={16} color={theme.colors.secondary} />\r\n              <Text style={styles.serviceText}>{review.service} • {review.date}</Text>\r\n            </View>\r\n          </View>\r\n        </View>\r\n      </View>\r\n      <Text style={styles.reviewText}>{review.text}</Text>\r\n    </View>\r\n  );\r\n\r\n  const renderHomeSection = () => (\r\n    <View style={styles.homeSection}>\r\n      <Text style={styles.sectionTitle}>Home</Text>\r\n      <View style={styles.homeFeaturesGrid}>\r\n        <HomeFeature text=\"No children present\" />\r\n        <HomeFeature text=\"Has security system\" />\r\n        <HomeFeature text=\"Non-smoking household\" />\r\n        <HomeFeature text=\"Has 2 dogs\" />\r\n        <HomeFeature text=\"Dogs allowed on bed\" />\r\n        <HomeFeature text=\"Dogs allowed on furniture\" />\r\n        <HomeFeature text=\"Potty breaks every 0-2 hours\" />\r\n      </View>\r\n    </View>\r\n\r\n  );\r\n\r\n  const renderAboutSection = () => (\r\n    <View style={styles.aboutSection}>\r\n      <Text style={styles.sectionTitle}>About {professionalData.name}</Text>\r\n      <View style={styles.aboutSubsections}>\r\n        <View style={styles.communicationSection}>\r\n          <Text style={styles.subsectionTitle}>Communication</Text>\r\n          <Text>22 repeat pet parents</Text>\r\n          <Text>100% response rate</Text>\r\n          <Text>Usually responds in a few minutes</Text>\r\n          <Text>90% bookings with photo updates</Text>\r\n        </View>\r\n        <View style={styles.skillsSection}>\r\n          <Text style={styles.subsectionTitle}>Skills</Text>\r\n          <Text>3 years of experience</Text>\r\n        </View>\r\n      </View> \r\n    </View>\r\n  );\r\n\r\n  const renderAvailability = () => (\r\n    <View style={dynamicStyles.dynamicServicesBox}>\r\n      <View style={styles.calendarSection}>\r\n        <Text style={[styles.sectionTitle, { marginBottom: 0 }]}>Availability</Text>\r\n        <Calendar\r\n          style={styles.calendar}\r\n          theme={{\r\n            calendarBackground: theme.colors.surface,\r\n            selectedDayBackgroundColor: theme.colors.primary,\r\n            selectedDayTextColor: '#ffffff',\r\n            todayTextColor: theme.colors.primary,\r\n          }}\r\n        />\r\n      </View>\r\n    </View>\r\n  );\r\n\r\n  const renderGallery = () => {\r\n    return (\r\n      <View style={styles.gallerySection}>\r\n        <Text style={styles.sectionTitle}>53 Photos</Text>\r\n        <View style={styles.photoGrid}>\r\n          {[1, 2, 3, 4].map((_, index) => (\r\n            <Image \r\n              key={index}\r\n              source={{ uri: 'https://via.placeholder.com/150' }}\r\n              style={styles.galleryPhoto}\r\n                      />\r\n          ))}\r\n        </View>\r\n      </View>\r\n    );\r\n  };\r\n\r\n  const additionalStyles = StyleSheet.create({\r\n    servicesSection: {\r\n      marginBottom: 24,\r\n    },\r\n    sectionHeader: {\r\n      flexDirection: 'row',\r\n      justifyContent: 'space-between',\r\n      alignItems: 'center',\r\n      marginBottom: 16,\r\n    },\r\n    seeAllButton: {\r\n      borderWidth: 1,\r\n      borderColor: theme.colors.primary,\r\n      paddingHorizontal: 12,\r\n      paddingVertical: 6,\r\n      borderRadius: 8,\r\n      alignSelf: 'flex-start',\r\n      minWidth: 'auto',\r\n      width: 'auto',\r\n    },\r\n    seeAllButtonText: {\r\n      color: theme.colors.primary,\r\n      fontSize: 16,\r\n      fontWeight: '600',\r\n      textAlign: 'center',\r\n    },\r\n    servicesScroll: {\r\n      marginHorizontal: -24, // To counteract parent padding\r\n      paddingHorizontal: 24,\r\n    },\r\n    modalServicesGrid: {\r\n      flexDirection: 'row',\r\n      flexWrap: 'wrap',\r\n      gap: 16,\r\n      justifyContent: 'center',\r\n      padding: 16,\r\n    },\r\n  });\r\n\r\n  const handleContactPress = () => {\r\n    // Check if conversation already exists\r\n    const existingConversation = mockConversations.find(\r\n      conv => conv.professionalId === professionalData.id\r\n    );\r\n\r\n    if (existingConversation) {\r\n      // Use replace instead of navigate to avoid navigation stack issues\r\n      navigation.replace('MessageHistory', {\r\n        selectedConversation: existingConversation.id\r\n      });\r\n    } else {\r\n      // Create new conversation\r\n      const newConversation = {\r\n        id: `conv_${Date.now()}`,\r\n        name: professionalData.name,\r\n        professionalId: professionalData.id,\r\n        lastMessage: '',\r\n        timestamp: new Date().toISOString(),\r\n        unread: false,\r\n        bookingStatus: null\r\n      };\r\n\r\n      // Add new conversation to mockConversations\r\n      mockConversations.unshift(newConversation);\r\n\r\n      // Initialize empty messages array for this conversation\r\n      mockMessages[newConversation.id] = [];\r\n\r\n      // Use replace instead of navigate\r\n      navigation.replace('MessageHistory', {\r\n        selectedConversation: newConversation.id\r\n      });\r\n    }\r\n  };\r\n\r\n  // Create dynamic styles that account for sidebar\r\n  const createStyles = (screenWidth, isCollapsed) => StyleSheet.create({\r\n    mainContainer: {\r\n      flex: 1,\r\n      backgroundColor: theme.colors.background,\r\n      height: Platform.OS === 'web' ? '100vh' : '100%',\r\n      overflow: 'hidden',\r\n      position: Platform.OS === 'web' ? 'fixed' : 'relative',\r\n      top: 0,\r\n      left: 0,\r\n      right: 0,\r\n      bottom: 0,\r\n      marginLeft: screenWidth > 900 ? (isCollapsed ? 70 : 250) : 0,\r\n      transition: Platform.OS === 'web' ? 'margin-left 0.3s ease' : undefined,\r\n    },\r\n    dynamicProfileSection: {\r\n      backgroundColor: theme.colors.surface,\r\n      borderRadius: 12,\r\n      padding: 16,\r\n      marginBottom: 16,\r\n      alignItems: 'center',\r\n      width: '100%',\r\n      display: windowWidth >= 600 ? 'flex' : 'block',\r\n    },\r\n    dynamicProfileSectionMobile: {\r\n      backgroundColor: theme.colors.surface,\r\n      borderRadius: 12,\r\n      padding: 16,\r\n      marginBottom: 16,\r\n      alignItems: 'center',\r\n      width: '100%',\r\n      maxWidth: 500,\r\n      alignSelf: 'center',\r\n      display: 'flex',\r\n      flexDirection: 'column',\r\n      alignItems: 'center',\r\n    },\r\n    dynamicServicesBox: {\r\n      backgroundColor: theme.colors.surface,\r\n      padding: 24,\r\n      paddingTop: 0,\r\n      borderRadius: 12,\r\n      marginTop: 24,\r\n      shadowColor: '#000',\r\n      shadowOffset: { width: 0, height: 2 },\r\n      shadowOpacity: 0.2,\r\n      shadowRadius: 4,\r\n      elevation: 3,\r\n      width: '100%',\r\n      maxWidth: Platform.OS === 'web' ? 600 : undefined,\r\n      alignSelf: 'center',\r\n    },\r\n  });\r\n\r\n  const dynamicStyles = createStyles(screenWidth, isCollapsed);\r\n\r\n  // Add this new function to render profile section based on screen size\r\n  const renderProfileSection = () => {\r\n    if (windowWidth >= 600) {\r\n      // Web version - original layout\r\n      return (\r\n        <View style={[styles.leftColumn, !isWideScreen && styles.leftColumnMobile]}>\r\n          <View style={[styles.profileSection, !isWideScreen && styles.profileSectionMobile]}>\r\n            {renderProfilePhoto()}\r\n            <Text style={styles.name}>{professionalData.name}</Text>\r\n            <Text style={styles.location}>{professionalData.location}</Text>\r\n            {renderRatingStars()}\r\n            <TouchableOpacity style={styles.contactButton} onPress={handleContactPress}>\r\n              <Text style={styles.contactButtonText}>Contact {professionalData.name}</Text>\r\n            </TouchableOpacity>\r\n          </View>\r\n          {isWideScreen && renderAvailability()}\r\n          {isWideScreen && renderMap()}\r\n          {isWideScreen && mockPets && mockPets.length > 0 && renderPets()}\r\n        </View>\r\n      );\r\n    } else {\r\n      // Mobile version - fixed layout\r\n      return (\r\n        <View style={[dynamicStyles.dynamicProfileSection, dynamicStyles.dynamicProfileSectionMobile]}>\r\n          {renderProfilePhoto()}\r\n          <Text style={styles.name}>{professionalData.name}</Text>\r\n          <Text style={styles.location}>{professionalData.location}</Text>\r\n          {renderRatingStars()}\r\n          <TouchableOpacity style={styles.contactButton} onPress={handleContactPress}>\r\n            <Text style={styles.contactButtonText}>Contact {professionalData.name}</Text>\r\n          </TouchableOpacity>\r\n        </View>\r\n      );\r\n    }\r\n  };\r\n\r\n  return (\r\n    <View style={dynamicStyles.mainContainer}>\r\n      <CrossPlatformView fullWidthHeader={true} contentWidth=\"1200px\">\r\n        <BackHeader \r\n          title=\"Professional Profile\" \r\n          onBackPress={handleBack}\r\n        />\r\n        <ScrollView contentContainerStyle={styles.scrollViewContent}>\r\n          <View style={[styles.content, { width: getContentWidth() }]}>\r\n            <View style={[styles.twoColumnLayout, !isWideScreen && styles.singleColumnLayout]}>\r\n              {renderProfileSection()}\r\n              <View style={styles.rightColumn}>\r\n                {/* TODO: Add back after MVP launch */}\r\n                {/* {renderGallery()} */}\r\n                {renderServices()}\r\n                {!isWideScreen && renderAvailability()}\r\n                {renderSpecialistExperience()}\r\n                {renderReviews()}\r\n                {renderHomeSection()}\r\n                {!isWideScreen && renderMap()}\r\n              </View>\r\n            </View>\r\n          </View>\r\n        </ScrollView>\r\n\r\n        {/* Bio Modal */}\r\n        <Modal\r\n          visible={bioModalVisible}\r\n          animationType=\"slide\"\r\n          transparent={true}\r\n          onRequestClose={() => setBioModalVisible(false)}\r\n        >\r\n          <View style={styles.modalContainer}>\r\n            <View style={styles2.modalContent}>\r\n              <Text style={styles.bioText}>{professionalData.bio}</Text>\r\n              <TouchableOpacity \r\n                style={styles.closeButton}\r\n                onPress={() => setBioModalVisible(false)}\r\n              >\r\n                <Text style={styles.closeButtonText}>Close</Text>\r\n              </TouchableOpacity>\r\n            </View>\r\n          </View>\r\n        </Modal>\r\n\r\n        {/* Reviews Modal */}\r\n        <Modal\r\n          visible={reviewsModalVisible}\r\n          animationType=\"slide\"\r\n          transparent={true}\r\n          onRequestClose={() => setReviewsModalVisible(false)}\r\n        >\r\n          <View style={styles.modalContainer}>\r\n            <View style={styles2.modalContent}>\r\n              <View style={styles.modalHeader}>\r\n                <Text style={styles.modalTitle}>All Reviews</Text>\r\n                <TouchableOpacity \r\n                  style={styles.modalCloseIcon}\r\n                  onPress={() => setReviewsModalVisible(false)}\r\n                >\r\n                  <MaterialCommunityIcons name=\"close\" size={24} color={theme.colors.text} />\r\n                </TouchableOpacity>\r\n              </View>\r\n              <ScrollView \r\n                style={styles.modalScroll}\r\n                contentContainerStyle={styles.modalScrollContent}\r\n              >\r\n                {mockReviews.map((review) => (\r\n                  <View key={review.id} style={styles.modalReviewItem}>\r\n                    {renderReview(review)}\r\n                  </View>\r\n                ))}\r\n              </ScrollView>\r\n            </View>\r\n          </View>\r\n        </Modal>\r\n\r\n        {/* Specialist Experience Modal */}\r\n        <Modal\r\n          visible={specialistModalVisible}\r\n          animationType=\"slide\"\r\n          transparent={true}\r\n          onRequestClose={() => setSpecialistModalVisible(false)}\r\n        >\r\n          <View style={styles.modalContainer}>\r\n            <View style={styles2.modalContent}>\r\n              <View style={styles.modalHeader}>\r\n                <Text style={styles.modalTitle}>Specialist Experience</Text>\r\n                <TouchableOpacity \r\n                  style={styles.modalCloseIcon}\r\n                  onPress={() => setSpecialistModalVisible(false)}\r\n                >\r\n                  <MaterialCommunityIcons name=\"close\" size={24} color={theme.colors.text} />\r\n                </TouchableOpacity>\r\n              </View>\r\n              <ScrollView \r\n                style={styles.modalScroll}\r\n                contentContainerStyle={styles.modalScrollContent}\r\n              >\r\n                <Text style={styles.bioText}>{professionalData?.bio}</Text>\r\n              </ScrollView>\r\n            </View>\r\n          </View>\r\n        </Modal>\r\n\r\n        {/* Services Modal */}\r\n        <Modal\r\n          visible={servicesModalVisible}\r\n          animationType=\"slide\"\r\n          transparent={true}\r\n          onRequestClose={() => setServicesModalVisible(false)}\r\n        >\r\n          <View style={styles.modalContainer}>\r\n            <View style={styles2.modalContent}>\r\n              <View style={styles.modalHeader}>\r\n                <Text style={styles.modalTitle}>All Services</Text>\r\n                <TouchableOpacity \r\n                  style={styles.modalCloseIcon}\r\n                  onPress={() => setServicesModalVisible(false)}\r\n                >\r\n                  <MaterialCommunityIcons name=\"close\" size={24} color={theme.colors.text} />\r\n                </TouchableOpacity>\r\n              </View>\r\n              <ScrollView \r\n                style={styles.modalScroll}\r\n                contentContainerStyle={styles.modalScrollContent}\r\n              >\r\n                <View style={styles.modalServicesGrid}>\r\n                  {mockServicesForCards.map(service => (\r\n                    <ServiceCard \r\n                      key={service.id}\r\n                      service={service}\r\n                      onHeartPress={toggleFavorite}\r\n                      isFavorite={favoriteServices.includes(service.id)}\r\n                      professionalName={professionalData.name}\r\n                      professionalId={professionalData.id}\r\n                      navigation={navigation}\r\n                    />\r\n                  ))}\r\n                </View>\r\n              </ScrollView>\r\n            </View>\r\n          </View>\r\n        </Modal>\r\n      </CrossPlatformView>\r\n    </View>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  scrollViewContent: {\r\n    flexGrow: 1,\r\n    paddingBottom: Platform.OS === 'web' ? 16 : 80,\r\n    height: Platform.OS === 'web' ? 'calc(100vh - 124px)' : '100%',\r\n    overflow: 'auto',\r\n  },\r\n  content: {\r\n    alignSelf: 'center',\r\n    padding: 24,\r\n  },\r\n  topSection: {\r\n    flexDirection: Platform.OS === 'web' ? 'row' : 'column',\r\n    gap: 24,\r\n    marginBottom: 24,\r\n  },\r\n  gallerySection: {\r\n    maxHeight: 400,\r\n    overflow: 'hidden',\r\n    marginBottom: 24,\r\n  },\r\n  photoGrid: {\r\n    flexDirection: 'row',\r\n    flexWrap: 'wrap',\r\n    gap: 8,\r\n    maxHeight: 320,\r\n    overflow: 'auto',\r\n  },\r\n  bottomSection: {\r\n    flexDirection: Platform.OS === 'web' ? 'row' : 'column',\r\n    gap: 24,\r\n  },\r\n  servicesSection: {\r\n    flex: Platform.OS === 'web' ? 1 : undefined,\r\n    backgroundColor: theme.colors.background,\r\n    padding: 24,\r\n    borderRadius: 12,\r\n    shadowColor: '#000',\r\n    shadowOffset: {\r\n      width: 0,\r\n      height: 2,\r\n    },\r\n    shadowOpacity: 0.1,\r\n    shadowRadius: 4,\r\n    elevation: 3,\r\n  },\r\n  aboutSection: {\r\n    maxHeight: 300,\r\n    overflow: 'auto',\r\n    marginBottom: 24,\r\n    padding: 16,\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 12,\r\n  },\r\n  profileHeader: {\r\n    alignItems: Platform.OS === 'web' ? 'flex-start' : 'center',\r\n  },\r\n  profileInfo: {\r\n    alignItems: Platform.OS === 'web' ? 'flex-start' : 'center',\r\n  },\r\n  hostingSection: {\r\n    marginTop: 24,\r\n  },\r\n  hostTitle: {\r\n    fontSize: 18,\r\n    fontWeight: 'bold',\r\n    marginBottom: 12,\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n  },\r\n  weightRanges: {\r\n    gap: 8,\r\n  },\r\n  weightRange: {\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  galleryPhoto: {\r\n    width: Platform.OS === 'web' ? 100 : 50,\r\n    height: Platform.OS === 'web' ? 100 : 50,\r\n    borderRadius: 8,\r\n  },\r\n  centered: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n  },\r\n  profilePhoto: {\r\n    width: 120,\r\n    height: 120,\r\n    borderRadius: 60,\r\n    marginBottom: 16,\r\n    alignSelf: 'center',\r\n  },\r\n  profilePhotoPlaceholder: {\r\n    backgroundColor: theme.colors.surface,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    marginBottom: 10,\r\n  },\r\n  name: {\r\n    fontSize: 24,\r\n    fontWeight: 'bold',\r\n    marginBottom: 4,\r\n    textAlign: 'center',\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n  },\r\n  location: {\r\n    fontSize: 16,\r\n    color: theme.colors.secondary,\r\n    marginBottom: 8,\r\n    textAlign: 'center',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  section: {\r\n    padding: 20,\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: theme.colors.border,\r\n  },\r\n  sectionTitle: {\r\n    fontSize: 20,\r\n    fontWeight: 'bold',\r\n    marginBottom: 10,\r\n    color: theme.colors.primary,\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n  },\r\n  bioInput: {\r\n    backgroundColor: theme.colors.surface,\r\n  },\r\n  service: {\r\n    fontSize: 16,\r\n    marginBottom: 5,\r\n  },\r\n  rateItem: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    marginBottom: 10,\r\n  },\r\n  rateLabel: {\r\n    flex: 1,\r\n    fontSize: 16,\r\n  },\r\n  rateInput: {\r\n    flex: 1,\r\n    backgroundColor: theme.colors.surface,\r\n  },\r\n  photoGrid: {\r\n    flexDirection: 'row',\r\n    flexWrap: 'wrap',\r\n  },\r\n  petPhoto: {\r\n    width: 50,\r\n    height: 50,\r\n    borderRadius: 25,\r\n    backgroundColor: theme.colors.surface,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n  },\r\n  addPhotoButton: {\r\n    width: 100,\r\n    height: 100,\r\n    margin: 5,\r\n    borderRadius: 10,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.primary,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n  },\r\n  saveButton: {\r\n    margin: 20,\r\n  },\r\n  ratingContainer: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    marginBottom: 16,\r\n  },\r\n  rating: {\r\n    fontSize: 16,\r\n    fontWeight: 'bold',\r\n    marginLeft: 5,\r\n  },\r\n  reviewCount: {\r\n    fontSize: 14,\r\n    color: theme.colors.secondary,\r\n    marginLeft: 4,\r\n  },\r\n  contactButton: {\r\n    backgroundColor: theme.colors.primary,\r\n    padding: 12,\r\n    borderRadius: 8,\r\n    alignSelf: 'center',\r\n  },\r\n  contactButtonText: {\r\n    fontSize: 16,\r\n    fontWeight: 'bold',\r\n    color: theme.colors.surface,\r\n    textAlign: 'center',\r\n  },\r\n  statsContainer: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-around',\r\n    marginBottom: 20,\r\n  },\r\n  statItem: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    marginRight: 10,\r\n  },\r\n  statText: {\r\n    fontSize: 16,\r\n    marginLeft: 5,\r\n  },\r\n  bioText: {\r\n    fontSize: 18,\r\n    lineHeight: 28,\r\n    color: theme.colors.text,\r\n    overflow: 'hidden',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  serviceItem: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    marginBottom: 10,\r\n  },\r\n  serviceText: {\r\n    fontSize: 8,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  servicePrice: {\r\n    fontSize: 14,\r\n    color: theme.colors.secondary,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  skillsGrid: {\r\n    flexDirection: 'row',\r\n    flexWrap: 'wrap',\r\n  },\r\n  skillBadge: {\r\n    backgroundColor: theme.colors.surface,\r\n    padding: 10,\r\n    borderRadius: 5,\r\n    margin: 5,\r\n  },\r\n  skillText: {\r\n    fontSize: 16,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  photoGallery: {\r\n    flexDirection: 'row',\r\n  },\r\n  calculatorText: {\r\n    fontSize: 16,\r\n    color: theme.colors.secondary,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  additionalRatesButton: {\r\n    marginTop: 16,\r\n    paddingVertical: 12,\r\n    paddingHorizontal: 16,\r\n    borderRadius: 6,\r\n    backgroundColor: theme.colors.surface,\r\n    alignItems: 'center',\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.outline,\r\n  },\r\n  additionalRatesText: {\r\n    color: theme.colors.primary,\r\n    fontSize: 16,\r\n    fontWeight: '600',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  calendarSection: {\r\n    marginTop: 24,\r\n  },\r\n  readMoreButton: {\r\n    marginTop: 8,\r\n  },\r\n  readMoreText: {\r\n    color: theme.colors.primary,\r\n    fontSize: 16,\r\n    fontWeight: '600',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  reviewsSection: {\r\n    marginVertical: 32,\r\n    width: '100%',\r\n    backgroundColor: theme.colors.background,\r\n  },\r\n  reviewItem: {\r\n    marginBottom: 16,\r\n    backgroundColor: theme.colors.surface,\r\n    padding: 16,\r\n    borderRadius: 12,\r\n    maxWidth: Platform.OS === 'web' ? 600 : undefined,\r\n  },\r\n  servicesSection: {\r\n    backgroundColor: theme.colors.surface,\r\n    padding: 24,\r\n    borderRadius: 12,\r\n    shadowColor: '#000',\r\n    shadowOffset: { width: 0, height: 2 },\r\n    shadowOpacity: 0.1,\r\n    shadowRadius: 4,\r\n    elevation: 3,\r\n    marginBottom: 24,\r\n  },\r\n  mapContainer: {\r\n    height: 400,\r\n    width: '100%',\r\n    marginVertical: 24,\r\n  },\r\n  map: {\r\n    flex: 1,\r\n  },\r\n  petsSection: {\r\n    marginBottom: 24,\r\n    backgroundColor: theme.colors.surface,\r\n    padding: 16,\r\n    borderRadius: 12,\r\n  },\r\n  petItem: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    marginBottom: 12,\r\n    padding: 12,\r\n    borderRadius: 8,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    backgroundColor: theme.colors.background,\r\n  },\r\n  petInfo: {\r\n    marginLeft: 12,\r\n    flex: 1,\r\n  },\r\n  petName: {\r\n    fontSize: 16,\r\n    fontWeight: '600',\r\n    marginBottom: 2,\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n  },\r\n  petBreed: {\r\n    fontSize: 14,\r\n    color: theme.colors.secondary,\r\n    marginBottom: 2,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  petDetails: {\r\n    fontSize: 14,\r\n    color: theme.colors.secondary,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  modalContainer: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    backgroundColor: 'rgba(0, 0, 0, 0.5)',\r\n  },\r\n  aboutSubsections: {\r\n    flexDirection: Platform.OS === 'web' ? 'row' : 'column',\r\n    gap: 24,\r\n  },\r\n  communicationSection: {\r\n    flex: 1,\r\n  },\r\n  skillsSection: {\r\n    flex: 1,\r\n  },\r\n  homeDetails: {\r\n    flexDirection: 'row',\r\n    flexWrap: 'wrap',\r\n    gap: 16,\r\n  },\r\n  noReviews: {\r\n    fontSize: 16,\r\n    color: theme.colors.secondary,\r\n    fontStyle: 'italic',\r\n    textAlign: 'center',\r\n    marginTop: 16,\r\n  },\r\n  twoColumnLayout: {\r\n    flexDirection: 'row',\r\n    gap: 24,\r\n  },\r\n  singleColumnLayout: {\r\n    flexDirection: 'column',\r\n  },\r\n  leftColumn: {\r\n    flex: Platform.OS === 'web' ? 1 : undefined,\r\n    maxWidth: Platform.OS === 'web' ? 400 : undefined,\r\n  },\r\n  rightColumn: {\r\n    flex: Platform.OS === 'web' ? 2 : undefined,\r\n  },\r\n  calendar: {\r\n    height: 300,\r\n    marginTop: 16,\r\n  },\r\n  serviceText: {\r\n    fontSize: 12,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    fontWeight: '100',\r\n  },\r\n  homeFeaturesGrid: {\r\n    flexDirection: 'row',\r\n    flexWrap: 'wrap',\r\n    gap: 8,\r\n    marginTop: 16,\r\n  },\r\n  featureBubble: {\r\n    backgroundColor: theme.colors.surface,\r\n    paddingVertical: 8,\r\n    paddingHorizontal: 16,\r\n    borderRadius: 20,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.outline,\r\n  },\r\n  featureText: {\r\n    fontSize: 14,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  reviewItem: {\r\n    marginBottom: 24,\r\n    backgroundColor: theme.colors.surface,\r\n    padding: 16,\r\n    borderRadius: 12,\r\n  },\r\n  reviewHeader: {\r\n    flexDirection: 'row',\r\n    marginBottom: 12,\r\n  },\r\n  reviewerPhoto: {\r\n    width: 40,\r\n    height: 40,\r\n    borderRadius: 20,\r\n    marginRight: 12,\r\n  },\r\n  reviewerInfo: {\r\n    flex: 1,\r\n  },\r\n  reviewerName: {\r\n    fontSize: 16,\r\n    fontWeight: '600',\r\n    marginBottom: 4,\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n  },\r\n  serviceInfo: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    gap: 4,\r\n  },\r\n  reviewText: {\r\n    fontSize: 14,\r\n    lineHeight: 20,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  modalTitle: {\r\n    fontSize: 20,\r\n    fontWeight: '600',\r\n    marginBottom: 16,\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n  },\r\n  modalScroll: {\r\n    maxHeight: Platform.OS === 'web' ? '70vh' : '80%',\r\n  },\r\n  closeButton: {\r\n    marginTop: 16,\r\n    alignItems: 'center',\r\n    padding: 12,\r\n    backgroundColor: theme.colors.primary,\r\n    borderRadius: 8,\r\n  },\r\n  closeButtonText: {\r\n    color: '#fff',\r\n    fontSize: 16,\r\n    fontWeight: '600',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  modalHeader: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    marginBottom: 16,\r\n  },\r\n  modalCloseIcon: {\r\n    padding: 8,\r\n  },\r\n  modalScrollContent: {\r\n    paddingBottom: 24,\r\n  },\r\n  modalContainer: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    backgroundColor: 'rgba(0, 0, 0, 0.5)',\r\n    padding: Platform.OS === 'web' ? 40 : 20,\r\n  },\r\n  reviewsGrid: {\r\n    flexDirection: 'row',\r\n    flexWrap: 'wrap',\r\n    gap: 16,\r\n    marginTop: 16,\r\n  },\r\n  reviewItem: {\r\n    backgroundColor: theme.colors.surface,\r\n    padding: 16,\r\n    borderRadius: 12,\r\n    flex: 1,\r\n    minWidth: Platform.OS === 'web' ? 300 : '100%',\r\n    // maxWidth: Platform.OS === 'web' ? 'calc(50% - 8px)' : undefined,\r\n    marginBottom: 0, // Remove default margin since we're using gap\r\n  },\r\n  specialistSection: {\r\n    marginTop: 24,\r\n    backgroundColor: theme.colors.surface,\r\n    padding: 16,\r\n    borderRadius: 12,\r\n  },\r\n  specialistText: {\r\n    fontSize: 16,\r\n    lineHeight: 24,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  modalReviewItem: {\r\n    marginBottom: 16,\r\n    width: '100%',\r\n  },\r\n  leftColumnMobile: {\r\n    maxWidth: '100%',\r\n    alignItems: 'center',\r\n  },\r\n  seeAllButton: {\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.primary,\r\n    paddingHorizontal: 12,\r\n    paddingVertical: 6,\r\n    borderRadius: 8,\r\n    alignSelf: 'flex-start',\r\n    minWidth: 'auto',\r\n    width: 'auto',\r\n  },\r\n  seeAllButtonText: {\r\n    color: theme.colors.primary,\r\n    fontSize: 16,\r\n    fontWeight: '600',\r\n    textAlign: 'center',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  modalServicesGrid: {\r\n    flexDirection: 'row',\r\n    flexWrap: 'wrap',\r\n    gap: 16,\r\n    justifyContent: 'center',\r\n    padding: 16,\r\n  },\r\n  reviewMeta: {\r\n    gap: 4,\r\n  },\r\n  starContainer: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    marginBottom: 4,\r\n  },\r\n});\r\n\r\nexport default ProfessionalProfile;\r\n","import React, { useState, useEffect } from 'react';\r\nimport { View, Text, StyleSheet, TouchableOpacity, ActivityIndicator } from 'react-native';\r\nimport { theme } from '../styles/theme';\r\nimport axios from 'axios';\r\nimport AsyncStorage from '@react-native-async-storage/async-storage';\r\nimport { API_BASE_URL } from '../config/config';\r\n\r\nconst ContractList = () => {\r\n  const [contracts, setContracts] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    fetchContracts();\r\n  }, []);\r\n\r\n  const fetchContracts = async () => {\r\n    setLoading(true);\r\n    try {\r\n      const token = await AsyncStorage.getItem('userToken');\r\n      if (!token) {\r\n        console.error('No token found');\r\n        return;\r\n      }\r\n      const response = await axios.get(`${API_BASE_URL}/api/contracts/`, {\r\n        headers: {\r\n          Authorization: `Bearer ${token}`,\r\n        },\r\n      });\r\n      setContracts(response.data);\r\n    } catch (error) {\r\n      console.error('Error fetching contracts:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <View style={styles.loadingContainer}>\r\n        <ActivityIndicator size=\"large\" color={theme.colors.primary} />\r\n      </View>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <View style={styles.container}>\r\n      <Text style={styles.sectionTitle}>Your Contracts</Text>\r\n      {contracts.length === 0 ? (\r\n        <Text style={styles.noContractsText}>No contracts yet</Text>\r\n      ) : (\r\n        contracts.map((contract) => (\r\n          <View key={contract.id} style={styles.card}>\r\n            <Text style={styles.contractTitle}>{contract.title}</Text>\r\n            <Text style={styles.ownerName}>Owner: {contract.owner_name}</Text>\r\n            <View style={styles.buttonContainer}>\r\n              <TouchableOpacity style={styles.button}>\r\n                <Text style={styles.buttonText}>Share</Text>\r\n              </TouchableOpacity>\r\n              <TouchableOpacity style={styles.button}>\r\n                <Text style={styles.buttonText}>Edit</Text>\r\n              </TouchableOpacity>\r\n            </View>\r\n          </View>\r\n        ))\r\n      )}\r\n    </View>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    marginTop: 16,\r\n  },\r\n  loadingContainer: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    marginTop: 50,\r\n  },\r\n  sectionTitle: {\r\n    fontSize: theme.fontSizes.mediumLarge,\r\n    fontWeight: 'bold',\r\n    marginBottom: 8,\r\n    color: theme.colors.text,\r\n  },\r\n  noContractsText: {\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.text,\r\n    textAlign: 'center',\r\n    marginTop: 20,\r\n  },\r\n  card: {\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 8,\r\n    padding: 16,\r\n    marginBottom: 16,\r\n  },\r\n  contractTitle: {\r\n    fontSize: theme.fontSizes.medium,\r\n    fontWeight: 'bold',\r\n    color: theme.colors.primary,\r\n  },\r\n  ownerName: {\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.text,\r\n    marginTop: 4,\r\n  },\r\n  buttonContainer: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'flex-end',\r\n    marginTop: 8,\r\n  },\r\n  button: {\r\n    backgroundColor: theme.colors.primary,\r\n    paddingHorizontal: 12,\r\n    paddingVertical: 6,\r\n    borderRadius: 4,\r\n    marginLeft: 8,\r\n  },\r\n  buttonText: {\r\n    color: theme.colors.background,\r\n    fontWeight: 'bold',\r\n  },\r\n});\r\n\r\nexport default ContractList;\r\n","import React, { useState } from 'react';\r\nimport { View, Text, TouchableOpacity, Modal, Platform, StyleSheet } from 'react-native';\r\nimport { Picker } from '@react-native-picker/picker';\r\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\r\nimport { theme } from '../styles/theme';\r\n\r\nconst OwnerPicker = ({ owners, selectedOwner, onSelectOwner }) => {\r\n  const [showOwnerPicker, setShowOwnerPicker] = useState(false);\r\n\r\n  if (Platform.OS === 'web') {\r\n    return (\r\n      <Picker\r\n        selectedValue={selectedOwner}\r\n        onValueChange={(itemValue) => onSelectOwner(itemValue)}\r\n        style={styles.picker}\r\n      >\r\n        <Picker.Item label=\"Select a owner...\" value=\"\" />\r\n        {owners.map(owner => (\r\n          <Picker.Item key={owner.id} label={owner.name} value={owner.name} />\r\n        ))}\r\n      </Picker>\r\n    );\r\n  } else {\r\n    return (\r\n      <View>\r\n        <TouchableOpacity\r\n          style={styles.dropdownButton}\r\n          onPress={() => setShowOwnerPicker(true)}\r\n        >\r\n          <Text style={styles.dropdownButtonText}>\r\n            {selectedOwner || \"Select a owner...\"}\r\n          </Text>\r\n          <MaterialCommunityIcons \r\n            name=\"chevron-down\" \r\n            size={24} \r\n            color={theme.colors.primary} \r\n          />\r\n        </TouchableOpacity>\r\n        <Modal\r\n          visible={showOwnerPicker}\r\n          transparent={true}\r\n          animationType=\"slide\"\r\n          onRequestClose={() => setShowOwnerPicker(false)}\r\n        >\r\n          <View style={styles.pickerModalContainer}>\r\n            <View style={styles.pickerContainer}>\r\n              <Picker\r\n                selectedValue={selectedOwner}\r\n                onValueChange={(itemValue) => {\r\n                  onSelectOwner(itemValue);\r\n                  setShowOwnerPicker(false);\r\n                }}\r\n                style={styles.modalPicker}\r\n              >\r\n                <Picker.Item label=\"Select a owner...\" value=\"\" />\r\n                {owners.map(owner => (\r\n                  <Picker.Item key={owner.id} label={owner.name} value={owner.name} />\r\n                ))}\r\n              </Picker>\r\n            </View>\r\n            <TouchableOpacity\r\n              style={styles.pickerCloseButton}\r\n              onPress={() => setShowOwnerPicker(false)}\r\n            >\r\n              <Text style={styles.pickerCloseButtonText}>Close</Text>\r\n            </TouchableOpacity>\r\n          </View>\r\n        </Modal>\r\n      </View>\r\n    );\r\n  }\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  picker: {\r\n    backgroundColor: theme.colors.surface,\r\n    marginBottom: 8,\r\n    borderRadius: 4,\r\n    padding: Platform.OS === 'ios' ? 12 : 0,\r\n    width: '90%',\r\n  },\r\n  modalPicker: {\r\n    width: '90%',\r\n  },\r\n  dropdownButton: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 4,\r\n    padding: 12,\r\n    marginBottom: 16,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n  },\r\n  dropdownButtonText: {\r\n    color: theme.colors.text,\r\n  },\r\n  pickerModalContainer: {\r\n    flex: 1,\r\n    justifyContent: 'flex-end',\r\n    backgroundColor: 'rgba(0, 0, 0, 0.5)',\r\n  },\r\n  pickerContainer: {\r\n    backgroundColor: theme.colors.background,\r\n    borderTopLeftRadius: 20,\r\n    borderTopRightRadius: 20,\r\n    padding: 16,\r\n  },\r\n  pickerCloseButton: {\r\n    backgroundColor: theme.colors.primary,\r\n    padding: 16,\r\n    alignItems: 'center',\r\n  },\r\n  pickerCloseButtonText: {\r\n    color: theme.colors.background,\r\n    fontWeight: 'bold',\r\n  },\r\n});\r\n\r\nexport default OwnerPicker;\r\n","import React, { useState, useEffect } from 'react';\r\nimport { View, Text, StyleSheet, TouchableOpacity, Modal, TextInput, ScrollView, Platform } from 'react-native';\r\nimport { theme } from '../styles/theme';\r\nimport axios from 'axios';\r\nimport AsyncStorage from '@react-native-async-storage/async-storage';\r\nimport { API_BASE_URL } from '../config/config';\r\nimport OwnerPicker from './OwnerPicker'; // Import the new component\r\n\r\nconst ContractTemplate = ({ templates }) => {\r\n  const [isTemplateModalVisible, setTemplateModalVisible] = useState(false);\r\n  const [isEditModalVisible, setEditModalVisible] = useState(false);\r\n  const [selectedTemplate, setSelectedTemplate] = useState(null);\r\n  const [contractContent, setContractContent] = useState('');\r\n  const [owners, setOwners] = useState([]);\r\n  const [selectedOwner, setSelectedOwner] = useState('');\r\n\r\n  useEffect(() => {\r\n    fetchOwners();\r\n  }, []);\r\n\r\n  const fetchOwners = async () => {\r\n    try {\r\n      const token = await AsyncStorage.getItem('userToken');\r\n      if (!token) {\r\n        console.error('No token found');\r\n        return;\r\n      }\r\n      const response = await axios.get(`${API_BASE_URL}/api/clients/`, {\r\n        headers: {\r\n          Authorization: `Bearer ${token}`,\r\n        },\r\n      });\r\n      setOwners(response.data);\r\n    } catch (error) {\r\n      console.error('Error fetching owners:', error);\r\n    }\r\n  };\r\n\r\n  const handleTemplateSelect = (template) => {\r\n    setSelectedTemplate(template);\r\n    setContractContent(template.description);\r\n    setTemplateModalVisible(false);\r\n    setEditModalVisible(true);\r\n  };\r\n\r\n  const handleAddSignableField = () => {\r\n    setContractContent((prevContent) => `${prevContent}\\n[signable] ___________ [end signable]`);\r\n  };\r\n\r\n  const handleSubmitContract = async () => {\r\n    try {\r\n      const token = await AsyncStorage.getItem('userToken');\r\n      if (!token) {\r\n        console.error('No token found');\r\n        return;\r\n      }\r\n      const response = await axios.post(\r\n        `${API_BASE_URL}/api/contracts/`,\r\n        {\r\n          template: selectedTemplate.id,\r\n          content: contractContent,\r\n          owner: selectedOwner,\r\n        },\r\n        {\r\n          headers: {\r\n            Authorization: `Bearer ${token}`,\r\n          },\r\n        }\r\n      );\r\n      console.log('Contract submitted:', response.data);\r\n      setEditModalVisible(false);\r\n    } catch (error) {\r\n      console.error('Error submitting contract:', error);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <View style={styles.container}>\r\n      <Text style={styles.sectionTitle}>Create New Contract</Text>\r\n      <TouchableOpacity style={styles.button} onPress={() => setTemplateModalVisible(true)}>\r\n        <Text style={styles.buttonText}>Use Template</Text>\r\n      </TouchableOpacity>\r\n\r\n      {/* Template Selection Modal */}\r\n      <Modal\r\n        visible={isTemplateModalVisible}\r\n        transparent={true}\r\n        animationType=\"slide\"\r\n        onRequestClose={() => setTemplateModalVisible(false)}\r\n      >\r\n        <View style={styles.modalContainer}>\r\n          <View style={styles.modalContent}>\r\n            <Text style={styles.modalTitle}>Select a Template</Text>\r\n            <ScrollView contentContainerStyle={styles.templateGrid}>\r\n              {templates.length === 0 ? (\r\n                <Text style={styles.noTemplatesText}>No templates yet</Text>\r\n              ) : (\r\n                templates.map((template) => (\r\n                  <TouchableOpacity\r\n                    key={template.id}\r\n                    style={styles.templateBox}\r\n                    onPress={() => handleTemplateSelect(template)}\r\n                  >\r\n                    <Text style={styles.templateTitle}>{template.title}</Text>\r\n                  </TouchableOpacity>\r\n                ))\r\n              )}\r\n            </ScrollView>\r\n            <TouchableOpacity style={styles.closeButton} onPress={() => setTemplateModalVisible(false)}>\r\n              <Text style={styles.closeButtonText}>Close</Text>\r\n            </TouchableOpacity>\r\n          </View>\r\n        </View>\r\n      </Modal>\r\n\r\n      {/* Edit Contract Modal */}\r\n      <Modal\r\n        visible={isEditModalVisible}\r\n        transparent={true}\r\n        animationType=\"slide\"\r\n        onRequestClose={() => setEditModalVisible(false)}\r\n      >\r\n        <View style={styles.modalContainer}>\r\n          <View style={styles.modalContent}>\r\n            <Text style={styles.modalTitle}>Edit Contract</Text>\r\n            <View style={styles.ownerPickerContainer}>\r\n              <Text style={styles.sectionTitle}>Select a Owner</Text>\r\n              <OwnerPicker\r\n                owners={owners}\r\n                selectedOwner={selectedOwner}\r\n                onSelectOwner={setSelectedOwner}\r\n              />\r\n            </View>\r\n            <TextInput\r\n              style={styles.textArea}\r\n              placeholder=\"Contract Content\"\r\n              value={contractContent}\r\n              onChangeText={setContractContent}\r\n              multiline\r\n            />\r\n            <TouchableOpacity style={styles.button} onPress={handleAddSignableField}>\r\n              <Text style={styles.buttonText}>Add Signable Field</Text>\r\n            </TouchableOpacity>\r\n            <TouchableOpacity style={styles.button} onPress={handleSubmitContract}>\r\n              <Text style={styles.buttonText}>Submit Contract</Text>\r\n            </TouchableOpacity>\r\n            <TouchableOpacity style={styles.closeButton} onPress={() => setEditModalVisible(false)}>\r\n              <Text style={styles.closeButtonText}>Close</Text>\r\n            </TouchableOpacity>\r\n          </View>\r\n        </View>\r\n      </Modal>\r\n    </View>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    marginBottom: 16,\r\n  },\r\n  sectionTitle: {\r\n    fontSize: 18,\r\n    fontWeight: 'bold',\r\n    marginBottom: 8,\r\n    color: theme.colors.text,\r\n  },\r\n  button: {\r\n    backgroundColor: theme.colors.primary,\r\n    paddingHorizontal: 16,\r\n    paddingVertical: 12,\r\n    borderRadius: 8,\r\n    alignItems: 'center',\r\n    marginBottom: 10,\r\n  },\r\n  buttonText: {\r\n    color: theme.colors.background,\r\n    fontWeight: 'bold',\r\n    fontSize: 16,\r\n  },\r\n  modalContainer: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    backgroundColor: 'rgba(0, 0, 0, 0.5)',\r\n  },\r\n  modalContent: {\r\n    width: '80%',\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 10,\r\n    padding: 20,\r\n    alignItems: 'center',\r\n  },\r\n  modalTitle: {\r\n    fontSize: 20,\r\n    fontWeight: 'bold',\r\n    marginBottom: 20,\r\n  },\r\n  templateGrid: {\r\n    flexDirection: 'row',\r\n    flexWrap: 'wrap',\r\n    justifyContent: 'center',\r\n  },\r\n  templateBox: {\r\n    width: 100,\r\n    height: 100,\r\n    margin: 10,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    backgroundColor: theme.colors.primary,\r\n    borderRadius: 5,\r\n  },\r\n  templateTitle: {\r\n    color: theme.colors.background,\r\n    textAlign: 'center',\r\n  },\r\n  noTemplatesText: {\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n    textAlign: 'center',\r\n    marginTop: 20,\r\n  },\r\n  closeButton: {\r\n    marginTop: 20,\r\n    padding: 10,\r\n    backgroundColor: theme.colors.primary,\r\n    borderRadius: 5,\r\n  },\r\n  closeButtonText: {\r\n    color: theme.colors.background,\r\n    fontWeight: 'bold',\r\n  },\r\n  textArea: {\r\n    width: '100%',\r\n    height: 100,\r\n    padding: 10,\r\n    borderColor: theme.colors.primary,\r\n    borderWidth: 1,\r\n    borderRadius: 5,\r\n    marginBottom: 10,\r\n    textAlignVertical: 'top',\r\n  },\r\n  ownerPickerContainer: {\r\n    width: '100%', // Ensure the owner picker container takes full width\r\n    marginBottom: 10,\r\n  },\r\n  pickerModalContainer: {\r\n    flex: 1,\r\n    justifyContent: 'flex-end',\r\n    backgroundColor: 'rgba(0, 0, 0, 0.5)',\r\n  },\r\n  pickerContainer: {\r\n    backgroundColor: theme.colors.background,\r\n    borderTopLeftRadius: 20,\r\n    borderTopRightRadius: 20,\r\n    padding: 16,\r\n  },\r\n  pickerCloseButton: {\r\n    backgroundColor: theme.colors.primary,\r\n    padding: 16,\r\n    alignItems: 'center',\r\n  },\r\n  pickerCloseButtonText: {\r\n    color: theme.colors.background,\r\n    fontWeight: 'bold',\r\n  },\r\n});\r\n\r\nexport default ContractTemplate;\r\n","import React from 'react';\r\nimport { View, Text, StyleSheet, TouchableOpacity, ScrollView, ActivityIndicator } from 'react-native';\r\nimport { theme } from '../styles/theme';\r\n\r\nconst ChronicleSummary = ({ chronicles }) => {\r\n  if (!chronicles || chronicles.length === 0) {\r\n    return (\r\n      <View style={styles.emptyContainer}>\r\n        <Text style={styles.emptyText}>No chronicles yet</Text>\r\n      </View>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <ScrollView style={styles.container}>\r\n      <Text style={styles.sectionTitle}>Your Chronicles</Text>\r\n      {chronicles.map((chronicle) => (\r\n        <View key={chronicle.id} style={styles.card}>\r\n          <Text style={styles.chronicleTitle}>{chronicle.title}</Text>\r\n          <Text style={styles.ownerName}>Owner: {chronicle.owner}</Text>\r\n          <Text style={styles.petName}>Pet: {chronicle.pets.join(', ')}</Text>\r\n          <Text style={styles.summary}>{chronicle.summary}</Text>\r\n          <View style={styles.buttonContainer}>\r\n            <TouchableOpacity style={styles.button}>\r\n              <Text style={styles.buttonText}>Edit</Text>\r\n            </TouchableOpacity>\r\n            <TouchableOpacity style={styles.button}>\r\n              <Text style={styles.buttonText}>Send to Owner</Text>\r\n            </TouchableOpacity>\r\n          </View>\r\n        </View>\r\n      ))}\r\n    </ScrollView>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n  },\r\n  loadingContainer: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    minHeight: 200,\r\n  },\r\n  emptyContainer: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    minHeight: 200,\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 8,\r\n    padding: 20,\r\n    marginTop: 16,\r\n  },\r\n  emptyText: {\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n    textAlign: 'center',\r\n  },\r\n  sectionTitle: {\r\n    fontSize: 18,\r\n    fontWeight: 'bold',\r\n    marginBottom: 8,\r\n    color: theme.colors.text,\r\n  },\r\n  card: {\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 8,\r\n    padding: 16,\r\n    marginBottom: 16,\r\n  },\r\n  chronicleTitle: {\r\n    fontSize: 16,\r\n    fontWeight: 'bold',\r\n    color: theme.colors.primary,\r\n  },\r\n  ownerName: {\r\n    fontSize: 14,\r\n    color: theme.colors.text,\r\n    marginTop: 4,\r\n  },\r\n  petName: {\r\n    fontSize: 14,\r\n    color: theme.colors.text,\r\n    marginTop: 2,\r\n  },\r\n  summary: {\r\n    fontSize: 14,\r\n    color: theme.colors.text,\r\n    marginTop: 8,\r\n    marginBottom: 8,\r\n  },\r\n  buttonContainer: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'flex-end',\r\n    marginTop: 8,\r\n  },\r\n  button: {\r\n    backgroundColor: theme.colors.primary,\r\n    paddingHorizontal: 12,\r\n    paddingVertical: 6,\r\n    borderRadius: 4,\r\n    marginLeft: 8,\r\n  },\r\n  buttonText: {\r\n    color: theme.colors.background,\r\n    fontWeight: 'bold',\r\n  },\r\n});\r\n\r\nexport default ChronicleSummary;\r\n","import React, { useState, useRef, useLayoutEffect } from 'react';\r\nimport { View, Text, TextInput, TouchableOpacity, ScrollView, StyleSheet, Platform, Modal, Dimensions } from 'react-native';\r\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\r\nimport { theme } from '../styles/theme';\r\n\r\nconst { width: SCREEN_WIDTH } = Dimensions.get('window');\r\n\r\nconst QuestionInput = ({ value, onChange }) => {\r\n  const [showDropdown, setShowDropdown] = useState(false);\r\n  const [dropdownPosition, setDropdownPosition] = useState({ top: 0, left: 0, width: 0 });\r\n  const inputRef = useRef(null);\r\n\r\n  const [layout, setLayout] = useState(null);\r\n\r\nconst handleLayout = (event) => {\r\n  const { x, y, width, height } = event.nativeEvent.layout;\r\n    setLayout({ x, y, width, height });\r\n  };\r\n\r\n  const presetQuestions = [\r\n    \"What is your favorite animal?\",\r\n    \"How many pets do you have?\",\r\n    \"What's your experience with exotic pets?\",\r\n    \"Do you have any allergies to animals?\",\r\n    \"What type of exotic pet are you interested in?\",\r\n    \"Have you owned an exotic pet before?\",\r\n    \"Are you familiar with the care requirements for exotic pets?\",\r\n    \"Do you have a veterinarian experienced with exotic animals?\",\r\n    \"What's your living situation? (House, apartment, etc.)\",\r\n    \"Are there any local regulations about exotic pet ownership in your area?\",\r\n  ];\r\n\r\n  const handleChange = (text) => {\r\n    onChange(text);\r\n  };\r\n\r\n  useLayoutEffect(() => {\r\n    if (showDropdown && inputRef.current) {\r\n      inputRef.current.measure((fx, fy, width, height, px, py) => {\r\n        if (!isNaN(py) && !isNaN(height)) {\r\n          const newTop = py + height;\r\n          const newLeft = px;\r\n          const newWidth = width;\r\n            \r\n          setDropdownPosition({ top: newTop, left: newLeft, width: newWidth });\r\n        }\r\n      });\r\n    }\r\n\r\n    // Lock/unlock scrolling\r\n    if (Platform.OS === 'web') {\r\n      document.body.style.overflow = showDropdown ? 'hidden' : 'auto';\r\n    }\r\n\r\n    return () => {\r\n      if (Platform.OS === 'web') {\r\n        document.body.style.overflow = 'auto';\r\n      }\r\n    };\r\n  }, [showDropdown, layout]);\r\n\r\n  const toggleDropdown = () => {\r\n    setShowDropdown(!showDropdown);\r\n  };\r\n\r\n  return (\r\n    <View style={styles.outerContainer}>\r\n      <View style={styles.container}>\r\n        <View style={styles.inputContainer} ref={inputRef} onLayout={handleLayout}>\r\n          <TextInput\r\n            style={styles.input}\r\n            value={value}\r\n            onChangeText={handleChange}\r\n            placeholder=\"Enter or select a question\"\r\n            multiline\r\n          />\r\n          <TouchableOpacity \r\n            style={styles.dropdownButton}\r\n            onPress={toggleDropdown}\r\n          >\r\n            <MaterialCommunityIcons \r\n              name={showDropdown ? \"chevron-up\" : \"chevron-down\"} \r\n              size={24} \r\n              color={theme.colors.primary} \r\n            />\r\n          </TouchableOpacity>\r\n        </View>\r\n        <Modal\r\n          visible={showDropdown}\r\n          transparent={true}\r\n          animationType=\"none\"\r\n          onRequestClose={toggleDropdown}\r\n        >\r\n          <TouchableOpacity\r\n            style={styles.modalOverlay}\r\n            activeOpacity={1}\r\n            onPress={toggleDropdown}\r\n          >\r\n            <View style={[styles.dropdownContainer, { top: dropdownPosition.top, left: dropdownPosition.left, width: dropdownPosition.width }]}>\r\n              <ScrollView style={styles.dropdownList}>\r\n                {presetQuestions.map((q, i) => (\r\n                  <TouchableOpacity\r\n                    key={i}\r\n                    style={styles.dropdownItem}\r\n                    onPress={() => {\r\n                      handleChange(q);\r\n                      toggleDropdown();\r\n                    }}\r\n                  >\r\n                    <Text style={styles.dropdownItemText}>{q}</Text>\r\n                  </TouchableOpacity>\r\n                ))}\r\n              </ScrollView>\r\n            </View>\r\n          </TouchableOpacity>\r\n        </Modal>\r\n      </View>\r\n    </View>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  outerContainer: {\r\n    width: '100%',\r\n    alignItems: 'center',\r\n    marginBottom: 16,\r\n  },\r\n  container: {\r\n    width: SCREEN_WIDTH - 80, // Match the answer input width\r\n    maxWidth: 600,\r\n    alignItems: 'center',\r\n  },\r\n  inputContainer: {\r\n    width: '100%',\r\n    position: 'relative',\r\n  },\r\n  input: {\r\n    width: '100%',\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 4,\r\n    padding: 8,\r\n    minHeight: 60,\r\n    ...Platform.select({\r\n      web: {\r\n        border: `1px solid ${theme.colors.border}`,\r\n      },\r\n      default: {\r\n        borderWidth: 1,\r\n        borderColor: theme.colors.border,\r\n      },\r\n    }),\r\n  },\r\n  dropdownButton: {\r\n    position: 'absolute',\r\n    right: 8,\r\n    top: 8,\r\n    padding: 4,\r\n  },\r\n  modalOverlay: {\r\n    flex: 1,\r\n  },\r\n  dropdownContainer: {\r\n    position: 'absolute',\r\n    backgroundColor: theme.colors.background,\r\n    borderRadius: 4,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    maxHeight: 200,\r\n    zIndex: 1000, // Ensure it appears on top\r\n    ...Platform.select({\r\n      web: {\r\n        boxShadow: '0 2px 4px rgba(0,0,0,0.1)',\r\n      },\r\n      default: {\r\n        elevation: 4,\r\n      },\r\n    }),\r\n  },\r\n  dropdownList: {\r\n    maxHeight: 200,\r\n  },\r\n  dropdownItem: {\r\n    padding: 12,\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: theme.colors.border,\r\n  },\r\n  dropdownItemText: {\r\n    color: theme.colors.text,\r\n  },\r\n});\r\n\r\nexport default QuestionInput;\r\n","import React, { useState, useRef, useEffect } from 'react';\r\nimport { View, Text, StyleSheet, TextInput, TouchableOpacity, ScrollView, Modal, Platform, Dimensions, Image, ActivityIndicator, Pressable } from 'react-native';\r\nimport { Picker } from '@react-native-picker/picker';\r\nimport * as ImagePicker from 'expo-image-picker';\r\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\r\nimport { theme } from '../styles/theme';\r\nimport QuestionInput from './QuestionInput';\r\nimport OwnerPicker from './OwnerPicker';\r\n\r\nconst { width: screenWidth } = Dimensions.get('window');\r\n\r\nconst ChronicleForm = ({ onCreateChronicle }) => {\r\n  const [modalVisible, setModalVisible] = useState(false);\r\n  const [selectedOwner, setSelectedOwner] = useState('');\r\n  const [selectedPets, setSelectedPets] = useState([]);\r\n  const [questions, setQuestions] = useState([{ question: '', answer: '', isPreset: true }]);\r\n  const [summary, setSummary] = useState('');\r\n  const [photos, setPhotos] = useState([]);\r\n  const [isUploading, setIsUploading] = useState(false);\r\n  const [showOwnerPicker, setShowOwnerPicker] = useState(false);\r\n  const [isCreating, setIsCreating] = useState(false);\r\n\r\n  const mockOwners = [\r\n    { id: '1', name: 'John Doe', pets: [{ id: '1', name: 'Max' }, { id: '2', name: 'Bella' }] },\r\n    { id: '2', name: 'Jane Smith', pets: [{ id: '3', name: 'Luna' }, { id: '4', name: 'Charlie' }] }\r\n  ];\r\n\r\n  const pickImages = async () => {\r\n    try {\r\n      setIsUploading(true);\r\n      const result = await ImagePicker.launchImageLibraryAsync({\r\n        mediaTypes: ImagePicker.MediaTypeOptions.Images,\r\n        allowsMultipleSelection: true,\r\n        quality: 1,\r\n      });\r\n\r\n      if (!result.canceled) {\r\n        setPhotos([...photos, ...result.assets]);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error uploading images:', error);\r\n    } finally {\r\n      setIsUploading(false);\r\n    }\r\n  };\r\n\r\n  const updateQuestion = (index, field, value) => {\r\n    const newQuestions = [...questions];\r\n    newQuestions[index] = { ...newQuestions[index], [field]: value };\r\n    setQuestions(newQuestions);\r\n  };\r\n\r\n  const handleCreateChronicle = () => {\r\n    setIsCreating(true);\r\n    const newChronicle = {\r\n      id: Date.now(),\r\n      owner: selectedOwner,\r\n      pets: selectedPets,\r\n      summary,\r\n      questions,\r\n      photos,\r\n      title: `Chronicle for ${selectedOwner}`,\r\n    };\r\n\r\n    setTimeout(() => {\r\n      console.log('Sending data to backend:', newChronicle);\r\n      onCreateChronicle(newChronicle);\r\n      setIsCreating(false);\r\n      setModalVisible(false);\r\n      resetForm();\r\n    }, 2000);\r\n  };\r\n\r\n  const resetForm = () => {\r\n    setSelectedOwner('');\r\n    setSelectedPets([]);\r\n    setSummary('');\r\n    setQuestions([{ question: '', answer: '' }]);\r\n    setPhotos([]);\r\n  };\r\n\r\n  const addNewQuestion = () => {\r\n    setQuestions([...questions, { question: '', answer: '', isPreset: false }]);\r\n  };\r\n\r\n  const renderOwnerSelection = () => {\r\n    if (Platform.OS === 'web') {\r\n      return (\r\n        <Picker\r\n          selectedValue={selectedOwner}\r\n          onValueChange={(itemValue) => setSelectedOwner(itemValue)}\r\n          style={styles.picker}\r\n        >\r\n          <Picker.Item label=\"Select a owner...\" value=\"\" />\r\n          {mockOwners.map(owner => (\r\n            <Picker.Item key={owner.id} label={owner.name} value={owner.name} />\r\n          ))}\r\n        </Picker>\r\n      );\r\n    } else {\r\n      return (\r\n        <View>\r\n          <TouchableOpacity\r\n            style={styles.dropdownButton}\r\n            onPress={() => setShowOwnerPicker(true)}\r\n          >\r\n            <Text style={styles.dropdownButtonText}>\r\n              {selectedOwner || \"Select a owner...\"}\r\n            </Text>\r\n            <MaterialCommunityIcons \r\n              name=\"chevron-down\" \r\n              size={24} \r\n              color={theme.colors.primary} \r\n            />\r\n          </TouchableOpacity>\r\n          <Modal\r\n            visible={showOwnerPicker}\r\n            transparent={true}\r\n            animationType=\"slide\"\r\n          >\r\n            <View style={styles.pickerModalContainer}>\r\n              <View style={styles.pickerContainer}>\r\n                <Picker\r\n                  selectedValue={selectedOwner}\r\n                  onValueChange={(itemValue) => {\r\n                    setSelectedOwner(itemValue);\r\n                    setShowOwnerPicker(false);\r\n                  }}\r\n                >\r\n                  <Picker.Item label=\"Select a owner...\" value=\"\" />\r\n                  {mockOwners.map(owner => (\r\n                    <Picker.Item key={owner.id} label={owner.name} value={owner.name} />\r\n                  ))}\r\n                </Picker>\r\n              </View>\r\n              <TouchableOpacity\r\n                style={styles.pickerCloseButton}\r\n                onPress={() => setShowOwnerPicker(false)}\r\n              >\r\n                <Text style={styles.pickerCloseButtonText}>Close</Text>\r\n              </TouchableOpacity>\r\n            </View>\r\n          </Modal>\r\n        </View>\r\n      );\r\n    }\r\n  };\r\n\r\n  const PhotoPreview = ({ photo }) => (\r\n    <View style={styles.photoContainer}>\r\n      <Image source={{ uri: photo.uri }} style={styles.photo} />\r\n    </View>\r\n  );\r\n\r\n  return (\r\n    <View>\r\n      <TouchableOpacity style={styles.createButton} onPress={() => setModalVisible(true)}>\r\n        <Text style={styles.createButtonText}>Create New Chronicle</Text>\r\n      </TouchableOpacity>\r\n\r\n      <Modal\r\n        animationType=\"slide\"\r\n        transparent={true}\r\n        visible={modalVisible}\r\n        onRequestClose={() => setModalVisible(false)}\r\n      >\r\n        <View style={styles.modalContainer}>\r\n          <View style={[styles.modalContent, Platform.OS === 'web' && styles.webModalContent]}>\r\n            <View style={styles.modalHeader}>\r\n              <Text style={styles.modalTitle}>Create New Chronicle</Text>\r\n              <TouchableOpacity onPress={() => setModalVisible(false)}>\r\n                <Text style={styles.closeButtonText}>✕</Text>\r\n              </TouchableOpacity>\r\n            </View>\r\n\r\n            <ScrollView>\r\n              <Text style={styles.label}>Select Owner</Text>\r\n              <OwnerPicker\r\n                owners={mockOwners}\r\n                selectedOwner={selectedOwner}\r\n                onSelectOwner={setSelectedOwner}\r\n              />\r\n\r\n              <Text style={styles.label}>Select Pets</Text>\r\n              {selectedOwner && mockOwners.find(c => c.name === selectedOwner)?.pets.map(pet => (\r\n                <TouchableOpacity\r\n                  key={pet.id}\r\n                  style={[\r\n                    styles.petOption,\r\n                    selectedPets.includes(pet.name) && styles.selectedPet\r\n                  ]}\r\n                  onPress={() => {\r\n                    if (selectedPets.includes(pet.name)) {\r\n                      setSelectedPets(selectedPets.filter(p => p !== pet.name));\r\n                    } else {\r\n                      setSelectedPets([...selectedPets, pet.name]);\r\n                    }\r\n                  }}\r\n                >\r\n                  <Text style={styles.petOptionText}>{pet.name}</Text>\r\n                </TouchableOpacity>\r\n              ))}\r\n\r\n              <Text style={styles.label}>Summary</Text>\r\n              <TextInput\r\n                style={styles.summaryInput}\r\n                multiline\r\n                value={summary}\r\n                onChangeText={setSummary}\r\n                placeholder=\"Write a summary of the chronicle\"\r\n                textAlignVertical=\"top\"\r\n              />\r\n\r\n              {questions.map((item, index) => (\r\n                <View key={index} style={styles.questionContainer}>\r\n                  <Text style={styles.label}>Question {index + 1}</Text>\r\n                  <QuestionInput\r\n                    value={item.question}\r\n                    onChange={(text) => updateQuestion(index, 'question', text)}\r\n                  />\r\n                  <View style={styles.answerInputContainer}>\r\n                    <TextInput\r\n                      style={[styles.input, styles.answerInput]}\r\n                      value={item.answer}\r\n                      onChangeText={(text) => updateQuestion(index, 'answer', text)}\r\n                      placeholder=\"Enter answer\"\r\n                      multiline\r\n                    />\r\n                  </View>\r\n                </View>\r\n              ))}\r\n\r\n              <TouchableOpacity style={styles.addQuestionButton} onPress={addNewQuestion}>\r\n                <MaterialCommunityIcons name=\"plus\" size={20} color={theme.colors.primary} />\r\n                <Text style={styles.addQuestionButtonText}>Add Another Question</Text>\r\n              </TouchableOpacity>\r\n\r\n              <TouchableOpacity \r\n                style={styles.uploadButton} \r\n                onPress={pickImages}\r\n                disabled={isUploading}\r\n              >\r\n                <MaterialCommunityIcons \r\n                  name=\"camera\" \r\n                  size={24} \r\n                  color={isUploading ? theme.colors.disabled : theme.colors.primary} \r\n                />\r\n                <Text style={[\r\n                  styles.uploadButtonText,\r\n                  isUploading && styles.uploadingText\r\n                ]}>\r\n                  {isUploading ? 'Uploading...' : 'Upload Photos'}\r\n                </Text>\r\n                {isUploading && (\r\n                  <ActivityIndicator \r\n                    size=\"small\" \r\n                    color={theme.colors.primary} \r\n                    style={styles.uploadingSpinner} \r\n                  />\r\n                )}\r\n              </TouchableOpacity>\r\n\r\n              <ScrollView horizontal style={styles.photoPreview}>\r\n                {photos.map((photo, index) => (\r\n                  <PhotoPreview key={index} photo={photo} />\r\n                ))}\r\n              </ScrollView>\r\n            </ScrollView>\r\n\r\n            <View style={styles.modalButtonContainer}>\r\n              <TouchableOpacity \r\n                style={styles.cancelButton} \r\n                onPress={() => {\r\n                  setModalVisible(false);\r\n                  resetForm();\r\n                }}\r\n              >\r\n                <Text style={styles.cancelButtonText}>Cancel</Text>\r\n              </TouchableOpacity>\r\n              <TouchableOpacity \r\n                style={styles.submitButton} \r\n                onPress={handleCreateChronicle}\r\n                disabled={isCreating}\r\n              >\r\n                <Text style={styles.submitButtonText}>\r\n                  {isCreating ? 'Creating Chronicle...' : 'Create Chronicle'}\r\n                </Text>\r\n              </TouchableOpacity>\r\n            </View>\r\n          </View>\r\n        </View>\r\n      </Modal>\r\n    </View>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  createButton: {\r\n    backgroundColor: theme.colors.primary,\r\n    paddingHorizontal: 16,\r\n    paddingVertical: 12,\r\n    borderRadius: 8,\r\n    alignItems: 'center',\r\n    marginBottom: 16,\r\n  },\r\n  createButtonText: {\r\n    color: theme.colors.background,\r\n    fontWeight: 'bold',\r\n    fontSize: 16,\r\n  },\r\n  modalContainer: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    backgroundColor: 'rgba(0, 0, 0, 0.5)',\r\n  },\r\n  modalContent: {\r\n    backgroundColor: theme.colors.background,\r\n    borderRadius: 8,\r\n    padding: 16,\r\n    width: '90%',\r\n    maxHeight: '80%',\r\n  },\r\n  webModalContent: {\r\n    width: screenWidth > 600 ? '40%' : '90%',\r\n  },\r\n  modalHeader: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    marginBottom: 16,\r\n  },\r\n  modalTitle: {\r\n    fontSize: 20,\r\n    fontWeight: 'bold',\r\n    color: theme.colors.text,\r\n  },\r\n  closeButton: {\r\n    padding: 8,\r\n  },\r\n  closeButtonText: {\r\n    fontSize: 20,\r\n    color: theme.colors.text,\r\n    fontWeight: 'bold',\r\n  },\r\n  label: {\r\n    fontSize: 16,\r\n    fontWeight: 'bold',\r\n    marginBottom: 8,\r\n    color: theme.colors.text,\r\n  },\r\n  input: {\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 4,\r\n    marginBottom: 8,\r\n    minHeight: 20,\r\n  },\r\n  picker: {\r\n    backgroundColor: theme.colors.surface,\r\n    marginBottom: 8,\r\n    borderRadius: 4,\r\n    padding: Platform.OS === 'ios' ? 12 : 0,\r\n  },\r\n  petOption: {\r\n    padding: 8,\r\n    backgroundColor: theme.colors.surface,\r\n    marginBottom: 8,\r\n    borderRadius: 4,\r\n  },\r\n  selectedPet: {\r\n    backgroundColor: theme.colors.primary,\r\n  },\r\n  petOptionText: {\r\n    color: theme.colors.text,\r\n  },\r\n  uploadButton: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    padding: 12,\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 4,\r\n    marginTop: 16,\r\n  },\r\n  uploadButtonText: {\r\n    marginLeft: 8,\r\n    color: theme.colors.primary,\r\n    fontWeight: 'bold',\r\n  },\r\n  photoPreview: {\r\n    flexDirection: 'row',\r\n    marginTop: 16,\r\n  },\r\n  photoThumbnail: {\r\n    width: 80,\r\n    height: 80,\r\n    marginRight: 8,\r\n    borderRadius: 4,\r\n  },\r\n  questionContainer: {\r\n    marginBottom: 16,\r\n    width: '100%',\r\n    alignItems: 'center',\r\n  },\r\n  modalButtonContainer: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    marginTop: 16,\r\n  },\r\n  cancelButton: {\r\n    backgroundColor: theme.colors.error,\r\n    paddingHorizontal: 16,\r\n    paddingVertical: 12,\r\n    borderRadius: 4,\r\n    alignItems: 'center',\r\n    flex: 1,\r\n    marginRight: 8,\r\n  },\r\n  cancelButtonText: {\r\n    color: theme.colors.background,\r\n    fontWeight: 'bold',\r\n  },\r\n  submitButton: {\r\n    backgroundColor: theme.colors.primary,\r\n    paddingHorizontal: 16,\r\n    paddingVertical: 12,\r\n    borderRadius: 4,\r\n    alignItems: 'center',\r\n    flex: 1,\r\n    marginLeft: 8,\r\n  },\r\n  submitButtonText: {\r\n    color: theme.colors.background,\r\n    fontWeight: 'bold',\r\n  },\r\n  addQuestionButton: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    padding: 12,\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 4,\r\n    marginTop: 8,\r\n    marginBottom: 16,\r\n    zIndex: 1, // Lower than dropdown\r\n  },\r\n  addQuestionButtonText: {\r\n    marginLeft: 8,\r\n    zIndex: 1, // Lower than dropdown\r\n    color: theme.colors.primary,\r\n    fontWeight: 'bold',\r\n  },\r\n  answerInputContainer: {\r\n    width: '100%',\r\n    alignItems: 'center',\r\n  },\r\n  answerInput: {\r\n    width: screenWidth - 80,\r\n    maxWidth: 600,\r\n    minHeight: 60,\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 4,\r\n    padding: 8,\r\n    marginTop: 8,\r\n    ...Platform.select({\r\n      web: {\r\n        border: `1px solid ${theme.colors.border}`,\r\n      },\r\n      default: {\r\n        borderWidth: 1,\r\n        borderColor: theme.colors.border,\r\n      },\r\n    }),\r\n  },\r\n  summaryInput: {\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 4,\r\n    marginBottom: 8,\r\n    padding: 8,\r\n    height: 100, // Set a fixed height\r\n    textAlignVertical: 'top',\r\n    ...Platform.select({\r\n      web: {\r\n        minHeight: 100,\r\n      },\r\n      ios: {\r\n        paddingTop: 8, // Add some padding to the top for iOS\r\n      },\r\n      android: {\r\n        paddingTop: 8, // Add some padding to the top for Android\r\n      },\r\n    }),\r\n    ...Platform.select({\r\n      web: {\r\n        border: `1px solid ${theme.colors.border}`,\r\n      },\r\n      default: {\r\n        borderWidth: 1,\r\n        borderColor: theme.colors.border,\r\n      },\r\n    }),\r\n  },\r\n  dropdownButton: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 4,\r\n    padding: 12,\r\n    marginBottom: 16,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n  },\r\n  dropdownButtonText: {\r\n    color: theme.colors.text,\r\n  },\r\n  pickerModalContainer: {\r\n    flex: 1,\r\n    justifyContent: 'flex-end',\r\n    backgroundColor: 'rgba(0, 0, 0, 0.5)',\r\n  },\r\n  pickerContainer: {\r\n    backgroundColor: theme.colors.background,\r\n    borderTopLeftRadius: 20,\r\n    borderTopRightRadius: 20,\r\n    padding: 16,\r\n  },\r\n  pickerCloseButton: {\r\n    backgroundColor: theme.colors.primary,\r\n    padding: 16,\r\n    alignItems: 'center',\r\n  },\r\n  pickerCloseButtonText: {\r\n    color: theme.colors.background,\r\n    fontWeight: 'bold',\r\n  },\r\n  photoContainer: {\r\n    marginRight: 8,\r\n  },\r\n  photo: {\r\n    width: 100,\r\n    height: 100,\r\n    borderRadius: 8,\r\n  },\r\n});\r\n\r\nexport default ChronicleForm;\r\n","import React, { useState, useEffect } from 'react';\r\nimport { View, Text, StyleSheet, ScrollView, TouchableOpacity, SafeAreaView, StatusBar, Platform, ActivityIndicator } from 'react-native';\r\nimport { theme } from '../styles/theme';\r\nimport ContractList from '../components/ContractList';\r\nimport ContractTemplate from '../components/ContractTemplate'; // Import ContractTemplate\r\nimport ChronicleSummary from '../components/ChronicleSummary';\r\nimport ChronicleForm from '../components/ChronicleForm';\r\nimport axios from 'axios';\r\nimport AsyncStorage from '@react-native-async-storage/async-storage';\r\nimport { API_BASE_URL } from '../config/config';\r\n\r\nconst MyContracts = () => {\r\n  const [activeTab, setActiveTab] = useState('contracts');\r\n  const [chronicles, setChronicles] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [templates, setTemplates] = useState([]);\r\n\r\n  useEffect(() => {\r\n    if (activeTab === 'chronicles') {\r\n      fetchChronicles();\r\n    }\r\n  }, [activeTab]);\r\n\r\n  const fetchChronicles = async () => {\r\n    setLoading(true);\r\n    await new Promise(resolve => setTimeout(resolve, 1000));\r\n\r\n    const mockChronicles = [\r\n      {\r\n        id: 1,\r\n        title: 'Fluffy\\'s Adventure',\r\n        owner: 'John Doe',\r\n        pets: ['Fluffy'],\r\n        summary: 'Fluffy had a great time at the park today!',\r\n      },\r\n      {\r\n        id: 2,\r\n        title: 'Max\\'s Playdate',\r\n        owner: 'Jane Smith',\r\n        pets: ['Max'],\r\n        summary: 'Max enjoyed playing with other dogs at the beach.',\r\n      },\r\n    ];\r\n\r\n    setChronicles(mockChronicles);\r\n    setLoading(false);\r\n  };\r\n\r\n  const fetchTemplates = async () => {\r\n    try {\r\n      const token = await AsyncStorage.getItem('userToken');\r\n      if (!token) {\r\n        console.error('No token found');\r\n        return;\r\n      }\r\n      const response = await axios.get(`${API_BASE_URL}/api/contracts/templates/`, {\r\n        headers: {\r\n          Authorization: `Bearer ${token}`,\r\n        },\r\n      });\r\n      setTemplates(response.data);\r\n    } catch (error) {\r\n      console.error('Error fetching templates:', error);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchTemplates(); // Fetch templates when component mounts\r\n  }, []);\r\n\r\n  const handleCreateChronicle = (newChronicle) => {\r\n    setChronicles((prevChronicles) => [...prevChronicles, newChronicle]);\r\n  };\r\n\r\n  return (\r\n    <SafeAreaView style={styles.safeArea}>\r\n      <ScrollView contentContainerStyle={styles.scrollViewContent}>\r\n        <View style={styles.container}>\r\n          <Text style={styles.title}>My Contracts & Chronicles</Text>\r\n          \r\n          <View style={styles.tabContainer}>\r\n            <TouchableOpacity\r\n              style={[styles.tab, activeTab === 'contracts' && styles.activeTab]}\r\n              onPress={() => setActiveTab('contracts')}\r\n            >\r\n              <Text style={[styles.tabText, activeTab === 'contracts' && styles.activeTabText]}>Contracts</Text>\r\n            </TouchableOpacity>\r\n            <TouchableOpacity\r\n              style={[styles.tab, activeTab === 'chronicles' && styles.activeTab]}\r\n              onPress={() => setActiveTab('chronicles')}\r\n            >\r\n              <Text style={[styles.tabText, activeTab === 'chronicles' && styles.activeTabText]}>Critter Chronicles</Text>\r\n            </TouchableOpacity>\r\n          </View>\r\n\r\n          {activeTab === 'contracts' && (\r\n            <View style={styles.contentContainer}>\r\n              <ContractTemplate templates={templates} />\r\n              <ContractList />\r\n            </View>\r\n          )}\r\n\r\n          {activeTab === 'chronicles' && (\r\n            <View style={styles.contentContainer}>\r\n              {loading ? (\r\n                <View style={styles.loadingContainer}>\r\n                  <ActivityIndicator size=\"large\" color={theme.colors.primary} />\r\n                </View>\r\n              ) : (\r\n                <>\r\n                  <ChronicleForm onCreateChronicle={handleCreateChronicle} />\r\n                  <ChronicleSummary chronicles={chronicles} />\r\n                </>\r\n              )}\r\n            </View>\r\n          )}\r\n        </View>\r\n      </ScrollView>\r\n    </SafeAreaView>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  safeArea: {\r\n    flex: 1,\r\n    backgroundColor: theme.colors.background,\r\n    paddingTop: Platform.OS === 'android' ? StatusBar.currentHeight : 0,\r\n  },\r\n  scrollViewContent: {\r\n    flexGrow: 1,\r\n  },\r\n  container: {\r\n    flex: 1,\r\n    padding: 16,\r\n    alignItems: 'center',\r\n  },\r\n  title: {\r\n    fontSize: 24,\r\n    fontWeight: 'bold',\r\n    marginBottom: 16,\r\n    color: theme.colors.primary,\r\n    textAlign: 'center',\r\n  },\r\n  tabContainer: {\r\n    flexDirection: 'row',\r\n    marginBottom: 16,\r\n    width: '100%',\r\n    maxWidth: 500,\r\n  },\r\n  tab: {\r\n    flex: 1,\r\n    paddingVertical: 12,\r\n    alignItems: 'center',\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 8,\r\n    marginHorizontal: 4,\r\n  },\r\n  activeTab: {\r\n    backgroundColor: theme.colors.primary,\r\n  },\r\n  tabText: {\r\n    color: theme.colors.text,\r\n    fontWeight: 'bold',\r\n  },\r\n  activeTabText: {\r\n    color: theme.colors.background,\r\n  },\r\n  contentContainer: {\r\n    width: '100%',\r\n    maxWidth: 500,\r\n  },\r\n  loadingContainer: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    minHeight: 200,\r\n  },\r\n  useTemplateButton: {\r\n    backgroundColor: theme.colors.primary,\r\n    padding: 10,\r\n    borderRadius: 5,\r\n    marginBottom: 16,\r\n    alignItems: 'center',\r\n  },\r\n  useTemplateButtonText: {\r\n    color: theme.colors.background,\r\n    fontWeight: 'bold',\r\n  },\r\n  modalContainer: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    backgroundColor: 'rgba(0, 0, 0, 0.5)',\r\n  },\r\n  modalContent: {\r\n    width: '80%',\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 10,\r\n    padding: 20,\r\n    alignItems: 'center',\r\n  },\r\n  modalTitle: {\r\n    fontSize: 20,\r\n    fontWeight: 'bold',\r\n    marginBottom: 20,\r\n  },\r\n  templateGrid: {\r\n    flexDirection: 'row',\r\n    flexWrap: 'wrap',\r\n    justifyContent: 'center',\r\n  },\r\n  templateBox: {\r\n    width: 100,\r\n    height: 100,\r\n    backgroundColor: theme.colors.primary,\r\n    margin: 10,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    borderRadius: 5,\r\n  },\r\n  templateTitle: {\r\n    color: theme.colors.background,\r\n    textAlign: 'center',\r\n  },\r\n  closeButton: {\r\n    marginTop: 20,\r\n    padding: 10,\r\n    backgroundColor: theme.colors.primary,\r\n    borderRadius: 5,\r\n  },\r\n  closeButtonText: {\r\n    color: theme.colors.background,\r\n    fontWeight: 'bold',\r\n  },\r\n});\r\n\r\nexport default MyContracts;\r\n","import React, { useState, useContext, useEffect } from 'react';\r\nimport { View, StyleSheet, Platform, SafeAreaView, TouchableOpacity, StatusBar, Text, TextInput, ActivityIndicator, Dimensions } from 'react-native';\r\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\r\nimport { theme } from '../styles/theme';\r\nimport { AuthContext } from '../context/AuthContext';\r\nimport CustomButton from '../components/CustomButton';\r\nimport axios from 'axios';\r\nimport { API_BASE_URL } from '../config/config';\r\nimport AsyncStorage from '@react-native-async-storage/async-storage';\r\n\r\nconst { width: screenWidth } = Dimensions.get('window');\r\n\r\nconst ChangePassword = ({ navigation }) => {\r\n  const [currentPassword, setCurrentPassword] = useState('');\r\n  const [newPassword, setNewPassword] = useState('');\r\n  const [confirmPassword, setConfirmPassword] = useState('');\r\n  const [error, setError] = useState('');\r\n  const [success, setSuccess] = useState('');\r\n  const [loading, setLoading] = useState(false);\r\n  const [showCurrentPassword, setShowCurrentPassword] = useState(false);\r\n  const [showNewPassword, setShowNewPassword] = useState(false);\r\n  const [showConfirmPassword, setShowConfirmPassword] = useState(false);\r\n  const { isSignedIn, screenWidth: contextScreenWidth, isCollapsed } = useContext(AuthContext);\r\n  const [token, setToken] = useState(null);\r\n\r\n  useEffect(() => {\r\n    const getToken = async () => {\r\n      const storedToken = await AsyncStorage.getItem('userToken');\r\n      setToken(storedToken);\r\n    };\r\n    getToken();\r\n  }, []);\r\n\r\n  const handleChangePassword = async () => {\r\n    setError('');\r\n    setSuccess('');\r\n\r\n    if (newPassword !== confirmPassword) {\r\n      setError('New passwords do not match');\r\n      return;\r\n    }\r\n\r\n    if (!isSignedIn || !token) {\r\n      setError('You are not authenticated. Please log in again.');\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    try {\r\n      const response = await axios.post(\r\n        `${API_BASE_URL}/api/users/change-password/`,\r\n        {\r\n          current_password: currentPassword,\r\n          new_password: newPassword,\r\n        },\r\n        {\r\n          headers: { Authorization: `Bearer ${token}` },\r\n        }\r\n      );\r\n\r\n      if (response.status === 200) {\r\n        setSuccess('Password changed successfully');\r\n        setCurrentPassword('');\r\n        setNewPassword('');\r\n        setConfirmPassword('');\r\n      }\r\n    } catch (error) {\r\n      setError(error.response?.data?.error || 'Failed to change password');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleForgotPassword = () => {\r\n    navigation.navigate('ResetPassword');\r\n  };\r\n\r\n  const styles = createStyles(contextScreenWidth, isCollapsed);\r\n\r\n  return (\r\n    <View style={styles.container}>\r\n      <SafeAreaView style={styles.safeArea}>\r\n        <View style={styles.content}>\r\n          <TouchableOpacity onPress={() => navigation.navigate('MyProfile', { initialTab: 'settings_payments' })} style={styles.backButton}>\r\n            <MaterialCommunityIcons name=\"arrow-left\" size={24} color={theme.colors.text} />\r\n            <Text style={styles.backText}>Change Password</Text>\r\n          </TouchableOpacity>\r\n          \r\n          <View style={styles.card}>\r\n            <Text style={styles.title}>Change Password</Text>\r\n            \r\n            <View style={styles.inputContainer}>\r\n              <TextInput\r\n                style={styles.input}\r\n                placeholder=\"Current Password\"\r\n                value={currentPassword}\r\n                onChangeText={setCurrentPassword}\r\n                secureTextEntry={!showCurrentPassword}\r\n                placeholderTextColor={theme.colors.placeHolderText}\r\n              />\r\n              <TouchableOpacity\r\n                style={styles.eyeIcon}\r\n                onPress={() => setShowCurrentPassword(!showCurrentPassword)}\r\n              >\r\n                <MaterialCommunityIcons\r\n                  name={showCurrentPassword ? \"eye-off\" : \"eye\"}\r\n                  size={20}\r\n                  color={theme.colors.placeHolderText}\r\n                />\r\n              </TouchableOpacity>\r\n            </View>\r\n\r\n            <View style={styles.inputContainer}>\r\n              <TextInput\r\n                style={styles.input}\r\n                placeholder=\"New Password\"\r\n                value={newPassword}\r\n                onChangeText={setNewPassword}\r\n                secureTextEntry={!showNewPassword}\r\n                placeholderTextColor={theme.colors.placeHolderText}\r\n              />\r\n              <TouchableOpacity\r\n                style={styles.eyeIcon}\r\n                onPress={() => setShowNewPassword(!showNewPassword)}\r\n              >\r\n                <MaterialCommunityIcons\r\n                  name={showNewPassword ? \"eye-off\" : \"eye\"}\r\n                  size={20}\r\n                  color={theme.colors.placeHolderText}\r\n                />\r\n              </TouchableOpacity>\r\n            </View>\r\n\r\n            <View style={styles.inputContainer}>\r\n              <TextInput\r\n                style={styles.input}\r\n                placeholder=\"Confirm New Password\"\r\n                value={confirmPassword}\r\n                onChangeText={setConfirmPassword}\r\n                secureTextEntry={!showConfirmPassword}\r\n                placeholderTextColor={theme.colors.placeHolderText}\r\n              />\r\n              <TouchableOpacity\r\n                style={styles.eyeIcon}\r\n                onPress={() => setShowConfirmPassword(!showConfirmPassword)}\r\n              >\r\n                <MaterialCommunityIcons\r\n                  name={showConfirmPassword ? \"eye-off\" : \"eye\"}\r\n                  size={20}\r\n                  color={theme.colors.placeHolderText}\r\n                />\r\n              </TouchableOpacity>\r\n            </View>\r\n\r\n            {error ? <Text style={styles.errorText}>{error}</Text> : null}\r\n            {success ? <Text style={styles.successText}>{success}</Text> : null}\r\n\r\n            <CustomButton \r\n              title=\"Change Password\" \r\n              onPress={handleChangePassword}\r\n              disabled={loading}\r\n              style={styles.button}\r\n            />\r\n\r\n            {loading && <ActivityIndicator size=\"large\" color={theme.colors.primary} style={styles.loader} />}\r\n\r\n            <TouchableOpacity onPress={handleForgotPassword} style={styles.forgotPasswordButton}>\r\n              <Text style={styles.forgotPasswordText}>Forgot Password?</Text>\r\n            </TouchableOpacity>\r\n          </View>\r\n        </View>\r\n      </SafeAreaView>\r\n    </View>\r\n  );\r\n};\r\n\r\nconst createStyles = (screenWidth, isCollapsed) => StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    backgroundColor: theme.colors.background,\r\n    marginLeft: screenWidth > 900 ? (isCollapsed ? 70 : 250) : 0,\r\n    transition: 'margin-left 0.3s ease',\r\n  },\r\n  safeArea: {\r\n    flex: 1,\r\n    paddingTop: Platform.OS === 'android' ? StatusBar.currentHeight : 0,\r\n  },\r\n  content: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    padding: 20,\r\n  },\r\n  backButton: {\r\n    position: 'absolute',\r\n    top: 20,\r\n    left: 20,\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    zIndex: 1,\r\n  },\r\n  backText: {\r\n    marginLeft: 8,\r\n    fontSize: 18,\r\n    fontWeight: '600',\r\n    color: theme.colors.text,\r\n  },\r\n  card: {\r\n    backgroundColor: theme.colors.surfaceContrast,\r\n    borderRadius: 12,\r\n    padding: 40,\r\n    width: '100%',\r\n    maxWidth: 400,\r\n    shadowColor: '#000',\r\n    shadowOffset: {\r\n      width: 0,\r\n      height: 2,\r\n    },\r\n    shadowOpacity: 0.1,\r\n    shadowRadius: 8,\r\n    elevation: 5,\r\n  },\r\n  title: {\r\n    fontSize: 28,\r\n    fontWeight: '600',\r\n    color: theme.colors.text,\r\n    textAlign: 'center',\r\n    marginBottom: 30,\r\n  },\r\n  inputContainer: {\r\n    position: 'relative',\r\n    marginBottom: 20,\r\n  },\r\n  input: {\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 8,\r\n    padding: 15,\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    paddingRight: 50,\r\n  },\r\n  eyeIcon: {\r\n    position: 'absolute',\r\n    right: 15,\r\n    top: 15,\r\n    padding: 5,\r\n  },\r\n  button: {\r\n    marginTop: 10,\r\n    marginBottom: 20,\r\n  },\r\n  errorText: {\r\n    color: theme.colors.error,\r\n    textAlign: 'center',\r\n    marginBottom: 15,\r\n    fontSize: 14,\r\n  },\r\n  successText: {\r\n    color: theme.colors.success || '#4CAF50',\r\n    textAlign: 'center',\r\n    marginBottom: 15,\r\n    fontSize: 14,\r\n  },\r\n  loader: {\r\n    marginTop: 10,\r\n  },\r\n  forgotPasswordButton: {\r\n    alignItems: 'center',\r\n    marginTop: 10,\r\n  },\r\n  forgotPasswordText: {\r\n    color: theme.colors.primary,\r\n    fontSize: 14,\r\n    textDecorationLine: 'underline',\r\n  },\r\n});\r\n\r\nexport default ChangePassword;\r\n","import React, { useEffect, useRef } from 'react';\r\nimport { View, Text, TouchableOpacity, ScrollView, StyleSheet, Platform } from 'react-native';\r\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\r\nimport { theme } from '../styles/theme';\r\n\r\nconst CustomMultiSelect = ({\r\n  label,\r\n  data,\r\n  value,\r\n  onChange,\r\n  placeholder,\r\n  isOpen,\r\n  setIsOpen,\r\n  containerStyle,\r\n  zIndex = 1,\r\n}) => {\r\n  const dropdownRef = useRef(null);\r\n\r\n  useEffect(() => {\r\n    if (Platform.OS === 'web') {\r\n      const handleClickOutside = (event) => {\r\n        if (dropdownRef.current && !dropdownRef.current.contains(event.target)) {\r\n          setIsOpen(false);\r\n        }\r\n      };\r\n\r\n      document.addEventListener('mousedown', handleClickOutside);\r\n      return () => {\r\n        document.removeEventListener('mousedown', handleClickOutside);\r\n      };\r\n    }\r\n  }, [setIsOpen]);\r\n\r\n  const getDisplayText = () => {\r\n    if (value.length === 0) return placeholder;\r\n    \r\n    const selectedItems = value.map(v => data.find(item => item.value === v)?.label || '');\r\n    const displayText = selectedItems[0];\r\n    \r\n    if (selectedItems.length > 1) {\r\n      return displayText.length > 30 \r\n        ? displayText.substring(0, 30) + '...'\r\n        : displayText + ', ...';\r\n    } else {\r\n      return displayText.length > 30 \r\n        ? displayText.substring(0, 30) + '...'\r\n        : displayText;\r\n    }\r\n  };\r\n\r\n  const handleRemoveItem = (itemValue, event) => {\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n    const newValue = value.filter(v => v !== itemValue);\r\n    onChange(newValue);\r\n  };\r\n\r\n  const handleItemSelect = (itemValue, event) => {\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n    const newValue = value.includes(itemValue)\r\n      ? value.filter(v => v !== itemValue)\r\n      : [...value, itemValue];\r\n    onChange(newValue);\r\n  };\r\n\r\n  return (\r\n    <View style={[styles.container, { zIndex }, containerStyle]}>\r\n      {label && <Text style={styles.label}>{label}</Text>}\r\n      <View ref={dropdownRef} style={styles.dropdownContainer}>\r\n        <TouchableOpacity\r\n          style={styles.header}\r\n          onPress={() => setIsOpen(!isOpen)}\r\n        >\r\n          <Text style={value.length ? styles.selectedText : styles.placeholderText}>\r\n            {getDisplayText()}\r\n          </Text>\r\n          <MaterialCommunityIcons \r\n            name={isOpen ? \"chevron-up\" : \"chevron-down\"} \r\n            size={24} \r\n            color={theme.colors.primary} \r\n          />\r\n        </TouchableOpacity>\r\n\r\n        {isOpen && (\r\n          <View style={[styles.dropdown, { zIndex: zIndex + 1 }]}>\r\n            <ScrollView \r\n              nestedScrollEnabled={true}\r\n              style={styles.scrollView}\r\n              contentContainerStyle={styles.scrollViewContent}\r\n            >\r\n              {data.map((item) => (\r\n                <TouchableOpacity\r\n                  key={item.value}\r\n                  style={styles.item}\r\n                  onPress={(e) => handleItemSelect(item.value, e)}\r\n                  activeOpacity={0.7}\r\n                >\r\n                  <Text style={styles.itemText}>{item.label}</Text>\r\n                  {value.includes(item.value) && (\r\n                    <MaterialCommunityIcons \r\n                      name=\"check\" \r\n                      size={24} \r\n                      color={theme.colors.primary}\r\n                    />\r\n                  )}\r\n                </TouchableOpacity>\r\n              ))}\r\n            </ScrollView>\r\n          </View>\r\n        )}\r\n\r\n        {!isOpen && value.length > 0 && (\r\n          <View style={styles.chipsContainer}>\r\n            {value.map((v) => {\r\n              const item = data.find(item => item.value === v);\r\n              if (!item) return null;\r\n              return (\r\n                <View key={v} style={styles.chip}>\r\n                  <Text style={styles.chipText}>{item.label}</Text>\r\n                  <TouchableOpacity \r\n                    onPress={(e) => handleRemoveItem(v, e)}\r\n                    style={styles.chipRemove}\r\n                  >\r\n                    <MaterialCommunityIcons \r\n                      name=\"close\" \r\n                      size={18} \r\n                      color={theme.colors.text} \r\n                    />\r\n                  </TouchableOpacity>\r\n                </View>\r\n              );\r\n            })}\r\n          </View>\r\n        )}\r\n      </View>\r\n    </View>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    position: 'relative',\r\n  },\r\n  dropdownContainer: {\r\n    position: 'relative',\r\n  },\r\n  header: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    // height: 50,\r\n    padding: 6,\r\n    // paddingHorizontal: 12,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    borderRadius: 8,\r\n    backgroundColor: theme.colors.background,\r\n  },\r\n  dropdown: {\r\n    position: 'absolute',\r\n    top: '100%',\r\n    left: 0,\r\n    right: 0,\r\n    maxHeight: 200,\r\n    backgroundColor: theme.colors.background,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    borderRadius: 8,\r\n    marginTop: 4,\r\n    elevation: 1000,\r\n    shadowColor: '#000',\r\n    shadowOffset: {\r\n      width: 0,\r\n      height: 2,\r\n    },\r\n    shadowOpacity: 0.25,\r\n    shadowRadius: 3.84,\r\n    zIndex: 9999,\r\n  },\r\n  scrollView: {\r\n    maxHeight: 200,\r\n  },\r\n  scrollViewContent: {\r\n    flexGrow: 1,\r\n  },\r\n  item: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    padding: 12,\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: theme.colors.border,\r\n  },\r\n  itemText: {\r\n    fontSize: theme.fontSizes.medium + 2,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  placeholderText: {\r\n    color: theme.colors.placeholderText,\r\n    fontSize: theme.fontSizes.medium + 2,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  selectedText: {\r\n    color: theme.colors.text,\r\n    fontSize: theme.fontSizes.medium + 2,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  chipsContainer: {\r\n    flexDirection: 'row',\r\n    flexWrap: 'wrap',\r\n    // padding: 8,\r\n    gap: 8,\r\n    marginTop: 8,\r\n  },\r\n  chip: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    backgroundColor: theme.colors.background,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.primary,\r\n    borderRadius: 16,\r\n    paddingVertical: 4,\r\n    paddingHorizontal: 8,\r\n  },\r\n  chipText: {\r\n    fontSize: theme.fontSizes.small + 2,\r\n    color: theme.colors.text,\r\n    marginRight: 4,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  chipRemove: {\r\n    padding: 2,\r\n  },\r\n  label: {\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.text,\r\n    marginBottom: theme.spacing.small,\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n  },\r\n});\r\n\r\nexport default CustomMultiSelect;","import React, { useState } from 'react';\r\nimport { View, Text, StyleSheet, Modal, TouchableOpacity, TouchableWithoutFeedback } from 'react-native';\r\nimport { theme } from '../styles/theme';\r\n\r\nconst Tooltip = ({ children, content, position = 'right' }) => {\r\n  const [visible, setVisible] = useState(false);\r\n\r\n  return (\r\n    <View>\r\n      <TouchableOpacity onPress={() => setVisible(true)}>\r\n        {children}\r\n      </TouchableOpacity>\r\n      <Modal\r\n        transparent\r\n        visible={visible}\r\n        onRequestClose={() => setVisible(false)}\r\n      >\r\n        <TouchableWithoutFeedback onPress={() => setVisible(false)}>\r\n          <View style={styles.modalOverlay}>\r\n            <View style={[styles.tooltipContainer, styles[position]]}>\r\n              <View style={styles.tooltipHeader}>\r\n                <TouchableOpacity onPress={() => setVisible(false)} style={styles.closeButton}>\r\n                  <Text style={styles.closeButtonText}>×</Text>\r\n                </TouchableOpacity>\r\n              </View>\r\n              <Text style={styles.tooltipText}>{content}</Text>\r\n            </View>\r\n          </View>\r\n        </TouchableWithoutFeedback>\r\n      </Modal>\r\n    </View>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  modalOverlay: {\r\n    flex: 1,\r\n    backgroundColor: 'rgba(0, 0, 0, 0.5)',\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n  },\r\n  tooltipContainer: {\r\n    backgroundColor: theme.colors.surface,\r\n    padding: theme.spacing.medium,\r\n    borderRadius: 8,\r\n    maxWidth: 300,\r\n    shadowColor: \"#000\",\r\n    shadowOffset: {\r\n      width: 0,\r\n      height: 2,\r\n    },\r\n    shadowOpacity: 0.25,\r\n    shadowRadius: 3.84,\r\n    elevation: 5,\r\n  },\r\n  tooltipText: {\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.text,\r\n    textAlign: 'center',\r\n  },\r\n  right: {\r\n    marginLeft: theme.spacing.medium,\r\n  },\r\n  left: {\r\n    marginRight: theme.spacing.medium,\r\n  },\r\n  top: {\r\n    marginBottom: theme.spacing.medium,\r\n  },\r\n  bottom: {\r\n    marginTop: theme.spacing.medium,\r\n  },\r\n  tooltipHeader: {\r\n    alignItems: 'flex-end',\r\n    marginBottom: theme.spacing.small,\r\n  },\r\n  closeButton: {\r\n    width: 24,\r\n    height: 24,\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    borderRadius: 12,\r\n  },\r\n  closeButtonText: {\r\n    fontSize: 20,\r\n    color: theme.colors.text,\r\n    lineHeight: 20,\r\n  },\r\n});\r\n\r\nexport default Tooltip; ","import React, { useState } from 'react';\r\nimport { View, Text, StyleSheet, TouchableOpacity, ScrollView, TextInput } from 'react-native';\r\nimport { theme } from '../styles/theme';\r\nimport { SERVICE_TYPES } from '../data/mockData';\r\n\r\nconst ServiceTypeSelect = ({ value, onChange }) => {\r\n  const [showSuggestions, setShowSuggestions] = useState(false);\r\n  const [filteredServices, setFilteredServices] = useState([]);\r\n\r\n  const handleTextChange = (text) => {\r\n    onChange(text);\r\n    if (text.length > 0) {\r\n      const filtered = SERVICE_TYPES.filter(service => \r\n        service.toLowerCase().includes(text.toLowerCase())\r\n      );\r\n      setFilteredServices(filtered);\r\n      setShowSuggestions(true);\r\n    } else {\r\n      setShowSuggestions(false);\r\n    }\r\n  };\r\n\r\n  const handleSelectService = (service) => {\r\n    onChange(service);\r\n    setShowSuggestions(false);\r\n  };\r\n\r\n  return (\r\n    <View style={styles.container}>\r\n      <TextInput\r\n        style={styles.input}\r\n        placeholder=\"Search services...\"\r\n        value={value}\r\n        onChangeText={handleTextChange}\r\n        onFocus={() => value.length > 0 && setShowSuggestions(true)}\r\n        onBlur={() => {\r\n          // Delay hiding suggestions to allow for suggestion selection\r\n          setTimeout(() => {\r\n            setShowSuggestions(false);\r\n          }, 150);\r\n        }}\r\n      />\r\n      {showSuggestions && (\r\n        <View style={styles.suggestionsWrapper}>\r\n          <ScrollView \r\n            style={styles.suggestionsContainer}\r\n            keyboardShouldPersistTaps=\"always\"\r\n            nestedScrollEnabled={true}\r\n          >\r\n            {filteredServices.map((service, index) => (\r\n              <TouchableOpacity\r\n                key={index}\r\n                style={styles.suggestionItem}\r\n                onPress={() => handleSelectService(service)}\r\n              >\r\n                <Text>{service}</Text>\r\n              </TouchableOpacity>\r\n            ))}\r\n          </ScrollView>\r\n        </View>\r\n      )}\r\n    </View>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    width: '100%',\r\n    position: 'relative',\r\n    marginRight: theme.spacing.medium,\r\n    marginBottom: theme.spacing.medium,\r\n    zIndex: 1000,\r\n  },\r\n  input: {\r\n    height: 48,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    borderRadius: 8,\r\n    paddingHorizontal: theme.spacing.medium,\r\n    backgroundColor: theme.colors.surface,\r\n    width: '100%',\r\n  },\r\n  suggestionsWrapper: {\r\n    position: 'absolute',\r\n    top: '100%',\r\n    left: 0,\r\n    right: 0,\r\n    maxHeight: 200,\r\n    backgroundColor: theme.colors.background,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    borderRadius: 8,\r\n    zIndex: 1000,\r\n    shadowColor: \"#000\",\r\n    shadowOffset: {\r\n      width: 0,\r\n      height: 2,\r\n    },\r\n    shadowOpacity: 0.1,\r\n    shadowRadius: 3,\r\n    elevation: 3,\r\n  },\r\n  suggestionsContainer: {\r\n    flex: 1,\r\n  },\r\n  suggestionItem: {\r\n    padding: theme.spacing.medium,\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: theme.colors.border,\r\n  },\r\n});\r\n\r\nexport default ServiceTypeSelect; ","import React, { useState, useRef, useCallback, useContext } from 'react';\r\nimport { View, Text, StyleSheet, TouchableOpacity, Platform, TextInput, ScrollView, Switch } from 'react-native';\r\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\r\nimport Dropdown from 'react-native-element-dropdown/src/components/Dropdown';\r\nimport DateTimePicker from '@react-native-community/datetimepicker';\r\nimport { theme } from '../styles/theme';\r\nimport Slider from '@react-native-community/slider';\r\nimport { GooglePlacesAutocomplete } from 'react-native-google-places-autocomplete';\r\nimport DatePicker from '../components/DatePicker';\r\nimport { debounce } from 'lodash';\r\nimport MultiSelect from 'react-native-element-dropdown/src/components/MultiSelect';\r\nimport CustomMultiSelect from '../components/CustomMultiSelect';\r\nimport { SERVICE_TYPES, GENERAL_CATEGORIES } from '../data/mockData';\r\nimport { AuthContext, debugLog } from '../context/AuthContext';\r\nimport Tooltip from './Tooltip';\r\nimport ServiceTypeSelect from './ServiceTypeSelect';\r\nimport { searchProfessionals } from '../api/API';\r\n\r\n// All available animal types from CategorySelectionStep\r\nconst ALL_ANIMAL_TYPES = [\r\n  // Farm animals\r\n  'Horse', 'Cow', 'Sheep', 'Goat', 'Pig',\r\n  // Domestic\r\n  'Dogs', 'Cats', 'Bird', 'Rabbit', 'Hamster',\r\n  // Reptiles\r\n  'Snake', 'Lizard', 'Turtle', 'Gecko', 'Chameleon',\r\n  // Aquatic\r\n  'Fish', 'Frog', 'Newt', 'Axolotl',\r\n  // Invertebrates\r\n  'Spider', 'Scorpion', 'Crab', 'Snail', 'Millipede'\r\n];\r\n\r\n// Supported locations for MVP launch\r\nconst SUPPORTED_LOCATIONS = [\r\n  // Denver Metro Area\r\n//   { display: \"Denver, Colorado\", city: \"Denver\", state: \"Colorado\", zips: [\"80201\", \"80202\", \"80203\", \"80204\", \"80205\", \"80206\", \"80207\", \"80208\", \"80209\", \"80210\", \"80211\", \"80212\", \"80213\", \"80214\", \"80215\", \"80216\", \"80217\", \"80218\", \"80219\", \"80220\", \"80221\", \"80222\", \"80223\", \"80224\", \"80225\", \"80226\", \"80227\", \"80228\", \"80229\", \"80230\", \"80231\", \"80232\", \"80233\", \"80234\", \"80235\", \"80236\", \"80237\", \"80238\", \"80239\", \"80246\", \"80247\", \"80248\", \"80249\", \"80250\", \"80251\", \"80252\", \"80256\", \"80257\", \"80258\", \"80259\", \"80260\", \"80261\", \"80262\", \"80263\", \"80264\", \"80265\", \"80266\", \"80271\", \"80273\", \"80274\", \"80279\", \"80280\", \"80281\", \"80290\", \"80291\", \"80293\", \"80294\", \"80295\", \"80299\"] },\r\n//   { display: \"Aurora, Colorado\", city: \"Aurora\", state: \"Colorado\", zips: [\"80010\", \"80011\", \"80012\", \"80013\", \"80014\", \"80015\", \"80016\", \"80017\", \"80018\", \"80019\", \"80040\", \"80041\", \"80042\", \"80044\", \"80045\", \"80046\", \"80047\"] },\r\n//   { display: \"Lakewood, Colorado\", city: \"Lakewood\", state: \"Colorado\", zips: [\"80214\", \"80215\", \"80226\", \"80227\", \"80228\", \"80232\", \"80401\"] },\r\n//   { display: \"Thornton, Colorado\", city: \"Thornton\", state: \"Colorado\", zips: [\"80023\", \"80229\", \"80233\", \"80241\"] },\r\n//   { display: \"Arvada, Colorado\", city: \"Arvada\", state: \"Colorado\", zips: [\"80001\", \"80002\", \"80003\", \"80004\", \"80005\", \"80006\", \"80007\", \"80403\"] },\r\n//   { display: \"Westminster, Colorado\", city: \"Westminster\", state: \"Colorado\", zips: [\"80003\", \"80020\", \"80021\", \"80030\", \"80031\", \"80234\"] },\r\n//   { display: \"Centennial, Colorado\", city: \"Centennial\", state: \"Colorado\", zips: [\"80112\", \"80121\", \"80122\", \"80016\"] },\r\n  \r\n  // Colorado Springs Area\r\n  { display: \"Colorado Springs, Colorado\", city: \"Colorado Springs\", state: \"Colorado\", zips: [\"80901\", \"80902\", \"80903\", \"80904\", \"80905\", \"80906\", \"80907\", \"80908\", \"80909\", \"80910\", \"80911\", \"80912\", \"80913\", \"80914\", \"80915\", \"80916\", \"80917\", \"80918\", \"80919\", \"80920\", \"80921\", \"80922\", \"80923\", \"80924\", \"80925\", \"80926\", \"80927\", \"80928\", \"80929\", \"80930\", \"80931\", \"80932\", \"80933\", \"80934\", \"80935\", \"80936\", \"80937\", \"80938\", \"80939\", \"80941\", \"80942\", \"80946\", \"80947\", \"80949\", \"80950\", \"80951\", \"80960\", \"80962\", \"80970\", \"80977\", \"80995\", \"80997\"] },\r\n  \r\n  // Boulder Area\r\n//   { display: \"Boulder, Colorado\", city: \"Boulder\", state: \"Colorado\", zips: [\"80301\", \"80302\", \"80303\", \"80304\", \"80305\", \"80309\", \"80310\", \"80314\"] },\r\n  \r\n  // Fort Collins Area\r\n//   { display: \"Fort Collins, Colorado\", city: \"Fort Collins\", state: \"Colorado\", zips: [\"80521\", \"80522\", \"80523\", \"80524\", \"80525\", \"80526\", \"80527\", \"80528\"] },\r\n  \r\n  // Pueblo Area\r\n//   { display: \"Pueblo, Colorado\", city: \"Pueblo\", state: \"Colorado\", zips: [\"81001\", \"81002\", \"81003\", \"81004\", \"81005\", \"81006\", \"81007\", \"81008\", \"81009\", \"81010\", \"81011\", \"81012\"] }\r\n];\r\n\r\n// Create a flat list of all searchable items (cities and zip codes)\r\nconst getAllSearchableLocations = () => {\r\n  const searchableItems = [];\r\n  \r\n  SUPPORTED_LOCATIONS.forEach(location => {\r\n    // Add the city\r\n    searchableItems.push({\r\n      display: location.display,\r\n      searchText: `${location.city}, ${location.state}`,\r\n      type: 'city'\r\n    });\r\n    \r\n    // Add all zip codes for this city\r\n    location.zips.forEach(zip => {\r\n      searchableItems.push({\r\n        display: `${zip}, ${location.city}, ${location.state}`,\r\n        searchText: zip,\r\n        type: 'zip'\r\n      });\r\n    });\r\n  });\r\n  \r\n  return searchableItems;\r\n};\r\n\r\nconst ALL_SEARCHABLE_LOCATIONS = getAllSearchableLocations();\r\n\r\nconst generalCategoriesData = GENERAL_CATEGORIES.map(category => ({\r\n  label: category,\r\n  value: category.toLowerCase().replace(/\\s+/g, '-')\r\n}));\r\n\r\nconst LocationInput = ({ value, onChange, suggestions, onSuggestionSelect }) => {\r\n  const locationInputRef = useRef(null);\r\n\r\n  const debouncedSearch = useCallback(\r\n    debounce((text) => {\r\n      if (text.length < 1) {\r\n        onSuggestionSelect([]);\r\n        return;\r\n      }\r\n      \r\n      // Search through supported locations\r\n      const filteredLocations = ALL_SEARCHABLE_LOCATIONS.filter(location =>\r\n        location.searchText.toLowerCase().includes(text.toLowerCase()) ||\r\n        location.display.toLowerCase().includes(text.toLowerCase())\r\n      ).slice(0, 5); // Limit to 5 results\r\n      \r\n      // If no matches found, show \"not supported\" message\r\n      if (filteredLocations.length === 0) {\r\n        onSuggestionSelect([{\r\n          display: `We're not available in \"${text}\" yet - coming soon!`,\r\n          searchText: text,\r\n          type: 'not_supported'\r\n        }]);\r\n      } else {\r\n        onSuggestionSelect(filteredLocations);\r\n      }\r\n    }, 100), // Reduced from 300ms to 100ms for faster response\r\n    [onSuggestionSelect]\r\n  );\r\n\r\n  return (\r\n    <View style={[styles.locationInputWrapper, { zIndex: 2 }]}>\r\n      <TextInput\r\n        ref={locationInputRef}\r\n        style={styles.locationInput}\r\n        placeholder=\"Enter city or zip in Colorado\"\r\n        value={value}\r\n        onChangeText={(text) => {\r\n          onChange(text);\r\n          if (text.length < 1) {\r\n            onSuggestionSelect([]);\r\n          } else {\r\n            debouncedSearch(text);\r\n          }\r\n        }}\r\n        onFocus={() => {\r\n          // Re-show suggestions if there's text and we have suggestions\r\n          if (value.length > 0) {\r\n            debouncedSearch(value);\r\n          }\r\n        }}\r\n        onBlur={() => {\r\n          // Delay hiding suggestions to allow for suggestion selection\r\n          setTimeout(() => {\r\n            onSuggestionSelect([]);\r\n          }, 150);\r\n        }}\r\n      />\r\n      {suggestions.length > 0 && (\r\n        <View style={styles.suggestionsWrapper}>\r\n          <ScrollView \r\n            style={styles.suggestionsContainer}\r\n            keyboardShouldPersistTaps=\"always\"\r\n            nestedScrollEnabled={true}\r\n          >\r\n            {suggestions.map((suggestion, index) => (\r\n              <TouchableOpacity\r\n                key={index}\r\n                style={[\r\n                  styles.suggestionItem,\r\n                  suggestion.type === 'not_supported' && styles.suggestionItemNotSupported\r\n                ]}\r\n                onPress={() => {\r\n                  if (suggestion.type !== 'not_supported') {\r\n                    onChange(suggestion.display);\r\n                    onSuggestionSelect([]);\r\n                  }\r\n                }}\r\n                disabled={suggestion.type === 'not_supported'}\r\n              >\r\n                <Text style={[\r\n                  styles.suggestionText,\r\n                  suggestion.type === 'not_supported' && styles.suggestionTextNotSupported\r\n                ]}>\r\n                  {suggestion.display}\r\n                </Text>\r\n                {suggestion.type === 'zip' && (\r\n                  <Text style={styles.suggestionType}>ZIP Code</Text>\r\n                )}\r\n              </TouchableOpacity>\r\n            ))}\r\n          </ScrollView>\r\n        </View>\r\n      )}\r\n    </View>\r\n  );\r\n};\r\n\r\nconst OtherAnimalInput = ({ value, onChange, suggestions, onSuggestionSelect, isVisible, onClose, onAnimalSelect }) => {\r\n  const animalInputRef = useRef(null);\r\n\r\n  const debouncedSearch = useCallback(\r\n    debounce((text) => {\r\n      if (text.length < 1) {\r\n        onSuggestionSelect([]);\r\n        return;\r\n      }\r\n      \r\n      const filteredAnimals = ALL_ANIMAL_TYPES.filter(animal =>\r\n        animal.toLowerCase().includes(text.toLowerCase())\r\n      );\r\n      onSuggestionSelect(filteredAnimals);\r\n    }, 300),\r\n    [onSuggestionSelect]\r\n  );\r\n\r\n  if (!isVisible) return null;\r\n\r\n  return (\r\n    <View style={styles.otherAnimalInputWrapper}>\r\n      <View style={styles.otherAnimalHeader}>\r\n        <Text style={styles.otherAnimalTitle}>Search for animal type</Text>\r\n        <TouchableOpacity onPress={onClose} style={styles.closeButton}>\r\n          <MaterialCommunityIcons name=\"close\" size={20} color={theme.colors.text} />\r\n        </TouchableOpacity>\r\n      </View>\r\n      <TextInput\r\n        ref={animalInputRef}\r\n        style={styles.animalInput}\r\n        placeholder=\"Type animal name (e.g., Snake, Turtle, Horse)\"\r\n        value={value}\r\n        onChangeText={(text) => {\r\n          onChange(text);\r\n          debouncedSearch(text);\r\n        }}\r\n        autoFocus={true}\r\n      />\r\n      {suggestions.length > 0 && (\r\n        <View style={styles.animalSuggestionsWrapper}>\r\n          <ScrollView \r\n            style={styles.animalSuggestionsContainer}\r\n            keyboardShouldPersistTaps=\"always\"\r\n            nestedScrollEnabled={true}\r\n          >\r\n            {suggestions.map((animal, index) => (\r\n              <TouchableOpacity\r\n                key={index}\r\n                style={styles.animalSuggestionItem}\r\n                onPress={() => {\r\n                  onAnimalSelect(animal);\r\n                  onChange('');\r\n                  onSuggestionSelect([]);\r\n                  onClose();\r\n                }}\r\n              >\r\n                <Text style={styles.animalSuggestionText}>{animal}</Text>\r\n              </TouchableOpacity>\r\n            ))}\r\n          </ScrollView>\r\n        </View>\r\n      )}\r\n    </View>\r\n  );\r\n};\r\n\r\nconst AnimalTypeButton = ({ icon, label, selected, onPress }) => (\r\n  <TouchableOpacity \r\n    style={[styles.animalTypeButton, selected && styles.animalTypeButtonSelected]} \r\n    onPress={onPress}\r\n  >\r\n    <MaterialCommunityIcons \r\n      name={icon} \r\n      size={24} \r\n      color={selected ? theme.colors.whiteText : theme.colors.text} \r\n    />\r\n    <Text style={[styles.animalTypeLabel, selected && styles.animalTypeLabelSelected]}>\r\n      {label}\r\n    </Text>\r\n  </TouchableOpacity>\r\n);\r\n\r\nconst SearchRefiner = ({ onFiltersChange, onShowProfessionals, isMobile, onSearchResults, initialFilters }) => {\r\n  const [location, setLocation] = useState(initialFilters?.location || '');\r\n  const [locationSuggestions, setLocationSuggestions] = useState([]);\r\n  const [service, setService] = useState(initialFilters?.service_query || '');\r\n  const [selectedAnimals, setSelectedAnimals] = useState(initialFilters?.animal_types || []);\r\n  const [overnightService, setOvernightService] = useState(initialFilters?.overnight_service || false);\r\n  const [priceRange, setPriceRange] = useState(initialFilters?.price_max || 200);\r\n  const [startDate, setStartDate] = useState(new Date());\r\n  const [endDate, setEndDate] = useState(new Date());\r\n  const [verifiedOnly, setVerifiedOnly] = useState(false);\r\n  const [insuredOnly, setInsuredOnly] = useState(false);\r\n  const [showOtherAnimalInput, setShowOtherAnimalInput] = useState(false);\r\n  const [otherAnimalSearch, setOtherAnimalSearch] = useState('');\r\n  const [otherAnimalSuggestions, setOtherAnimalSuggestions] = useState([]);\r\n  const [isSearching, setIsSearching] = useState(false);\r\n  const { screenWidth } = useContext(AuthContext);\r\n\r\n  // Update state when initialFilters change\r\n  React.useEffect(() => {\r\n    if (initialFilters) {\r\n      setLocation(initialFilters.location || '');\r\n      setService(initialFilters.service_query || '');\r\n      setSelectedAnimals(initialFilters.animal_types || []);\r\n      setOvernightService(initialFilters.overnight_service || false);\r\n      setPriceRange(initialFilters.price_max || 200);\r\n    }\r\n  }, [initialFilters]);\r\n\r\n  const handleAnimalSelect = (animal) => {\r\n    if (selectedAnimals.includes(animal)) {\r\n      setSelectedAnimals(selectedAnimals.filter(a => a !== animal));\r\n    } else {\r\n      setSelectedAnimals([...selectedAnimals, animal]);\r\n    }\r\n  };\r\n\r\n  const handleOtherAnimalClose = () => {\r\n    setShowOtherAnimalInput(false);\r\n    setOtherAnimalSearch('');\r\n    setOtherAnimalSuggestions([]);\r\n  };\r\n\r\n  const handleSearch = async () => {\r\n    setIsSearching(true);\r\n    \r\n    try {\r\n      debugLog('MBA9999', 'Starting professional search with filters:', {\r\n        selectedAnimals,\r\n        location,\r\n        service,\r\n        overnightService,\r\n        priceRange\r\n      });\r\n\r\n      // Prepare search parameters\r\n      const searchParams = {\r\n        animal_types: selectedAnimals,\r\n        location: location.trim(),\r\n        service_query: service.trim(),\r\n        overnight_service: overnightService,\r\n        price_min: 0,\r\n        price_max: priceRange,\r\n        radius_miles: 30,\r\n        page: 1,\r\n        page_size: 20\r\n      };\r\n\r\n      // Call the search API\r\n      const results = await searchProfessionals(searchParams);\r\n      \r\n      debugLog('MBA9999', 'Search completed successfully:', results);\r\n\r\n      // Pass results and search parameters to parent component\r\n      if (onSearchResults) {\r\n        onSearchResults(results, searchParams);\r\n      }\r\n\r\n      // Show professionals list\r\n      if (onShowProfessionals) {\r\n        onShowProfessionals();\r\n      }\r\n\r\n    } catch (error) {\r\n      debugLog('MBA9999', 'Search failed:', error);\r\n      // TODO: Show error toast to user\r\n      console.error('Search failed:', error);\r\n    } finally {\r\n      setIsSearching(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <ScrollView style={styles.container}>\r\n      <View style={styles.header}>\r\n        <Text style={styles.title}>Refine Search</Text>\r\n        <TouchableOpacity style={styles.personButton} onPress={onShowProfessionals}>\r\n          <MaterialCommunityIcons name=\"account-group\" size={24} color={theme.colors.text} />\r\n        </TouchableOpacity>\r\n        {isMobile && (\r\n          <View style={styles.headerButtons}>\r\n            <TouchableOpacity \r\n              style={styles.iconButton}\r\n              onPress={() => {\r\n                if (onShowProfessionals) {\r\n                  // Pass a special parameter to indicate we want to switch to map view\r\n                  onShowProfessionals('map');\r\n                }\r\n              }}\r\n            >\r\n              <MaterialCommunityIcons name=\"map\" size={24} color={theme.colors.text} />\r\n            </TouchableOpacity>\r\n          </View>\r\n        )}\r\n      </View>\r\n\r\n      <Text style={styles.label}>I'm looking for services for my:</Text>\r\n      <View style={styles.animalSelectionWrapper}>\r\n        <View style={styles.animalTypesContainer}>\r\n          <AnimalTypeButton\r\n            icon=\"dog\"\r\n            label=\"Dogs\"\r\n            selected={selectedAnimals.includes('Dogs')}\r\n            onPress={() => handleAnimalSelect('Dogs')}\r\n          />\r\n          <AnimalTypeButton\r\n            icon=\"cat\"\r\n            label=\"Cats\"\r\n            selected={selectedAnimals.includes('Cats')}\r\n            onPress={() => handleAnimalSelect('Cats')}\r\n          />\r\n          <TouchableOpacity \r\n            style={[styles.animalTypeButton, showOtherAnimalInput && styles.animalTypeButtonSelected]} \r\n            onPress={() => setShowOtherAnimalInput(!showOtherAnimalInput)}\r\n          >\r\n            <MaterialCommunityIcons \r\n              name=\"dots-horizontal\" \r\n              size={24} \r\n              color={showOtherAnimalInput ? theme.colors.whiteText : theme.colors.text} \r\n            />\r\n            <Text style={[styles.animalTypeLabel, showOtherAnimalInput && styles.animalTypeLabelSelected]}>\r\n              Other\r\n            </Text>\r\n          </TouchableOpacity>\r\n        </View>\r\n        \r\n        {showOtherAnimalInput && (\r\n          <OtherAnimalInput\r\n            value={otherAnimalSearch}\r\n            onChange={setOtherAnimalSearch}\r\n            suggestions={otherAnimalSuggestions}\r\n            onSuggestionSelect={setOtherAnimalSuggestions}\r\n            isVisible={showOtherAnimalInput}\r\n            onClose={handleOtherAnimalClose}\r\n            onAnimalSelect={handleAnimalSelect}\r\n          />\r\n        )}\r\n      </View>\r\n\r\n      {/* Display selected animals */}\r\n      {selectedAnimals.length > 0 && (\r\n        <View style={styles.selectedAnimalsContainer}>\r\n          <Text style={styles.selectedAnimalsLabel}>Selected animals:</Text>\r\n          <View style={styles.selectedAnimalsList}>\r\n            {selectedAnimals.map((animal, index) => (\r\n              <TouchableOpacity\r\n                key={index}\r\n                style={styles.selectedAnimalTag}\r\n                onPress={() => handleAnimalSelect(animal)}\r\n              >\r\n                <Text style={styles.selectedAnimalText}>{animal}</Text>\r\n                <MaterialCommunityIcons name=\"close\" size={16} color={theme.colors.whiteText} />\r\n              </TouchableOpacity>\r\n            ))}\r\n          </View>\r\n        </View>\r\n      )}\r\n\r\n      {/* Location Input */}\r\n      <Text style={styles.label}>Location</Text>\r\n      <View style={styles.locationContainer}>\r\n      <LocationInput\r\n        value={location}\r\n        onChange={setLocation}\r\n        suggestions={locationSuggestions}\r\n        onSuggestionSelect={setLocationSuggestions}\r\n      />\r\n        {/* <TouchableOpacity style={[styles.useLocationButton, { marginBottom: 16 }]}>\r\n          <MaterialCommunityIcons name=\"crosshairs-gps\" size={20} color={theme.colors.text} />\r\n          <Text style={styles.useLocationText}>Use My Location</Text>\r\n        </TouchableOpacity> */}\r\n      </View>\r\n\r\n      {/* Service Input */}\r\n      <Text style={styles.label}>What service do you need? (e.g., Dog Walking, Pet Sitting)</Text>\r\n      <ServiceTypeSelect\r\n        value={service}\r\n        onChange={setService}\r\n      />\r\n\r\n      {/* Overnight Service */}\r\n      <View style={styles.switchContainer}>\r\n        <Text style={styles.label}>Overnight Service</Text>\r\n        <Switch\r\n          value={overnightService}\r\n          onValueChange={setOvernightService}\r\n          trackColor={{ false: theme.colors.border, true: theme.colors.primary }}\r\n        />\r\n      </View>\r\n\r\n      {/* Price Range */}\r\n      <Text style={styles.label}>Price Range</Text>\r\n      <View style={styles.priceContainer}>\r\n        <Text style={styles.priceLabel}>$0</Text>\r\n        <Slider\r\n          style={styles.slider}\r\n          minimumValue={0}\r\n          maximumValue={250}\r\n          value={priceRange}\r\n          onValueChange={setPriceRange}\r\n          minimumTrackTintColor={theme.colors.primary}\r\n          maximumTrackTintColor={theme.colors.border}\r\n          thumbTintColor={theme.colors.primary}\r\n          step={1}\r\n        />\r\n        <Text style={styles.priceLabel}>${Math.round(priceRange)}</Text>\r\n      </View>\r\n\r\n      {/* TODO: Add back after MVP launch \r\n      Date Selection\r\n      <Text style={styles.label}>Date Range</Text>\r\n      <View style={styles.datePickersContainer}>\r\n        <DatePicker\r\n          label=\"Start Date\"\r\n          value={startDate}\r\n          onChange={setStartDate}\r\n        />\r\n        <DatePicker\r\n          label=\"End Date\"\r\n          value={endDate}\r\n          onChange={setEndDate}\r\n        />\r\n      </View> */}\r\n\r\n      {/* TODO: Add back after MVP launch \r\n      Verification Options\r\n      <View style={styles.checkboxContainer}>\r\n        <View style={styles.checkboxRow}>\r\n          <TouchableOpacity \r\n            style={styles.checkbox} \r\n            onPress={() => setVerifiedOnly(!verifiedOnly)}\r\n          >\r\n            {verifiedOnly && <MaterialCommunityIcons name=\"check\" size={20} color={theme.colors.primary} />}\r\n          </TouchableOpacity>\r\n          <View style={styles.checkboxLabelContainer}>\r\n            <Text style={styles.checkboxLabel}>Verified Professionals Only</Text>\r\n            <Tooltip \r\n              content=\"Verified professionals have completed our background check and identity verification process.\"\r\n              position=\"right\"\r\n            >\r\n              <MaterialCommunityIcons name=\"help-circle-outline\" size={20} color={theme.colors.text} />\r\n            </Tooltip>\r\n          </View>\r\n      </View>\r\n\r\n        <View style={styles.checkboxRow}>\r\n          <TouchableOpacity \r\n            style={styles.checkbox} \r\n            onPress={() => setInsuredOnly(!insuredOnly)}\r\n          >\r\n            {insuredOnly && <MaterialCommunityIcons name=\"check\" size={20} color={theme.colors.primary} />}\r\n          </TouchableOpacity>\r\n          <View style={styles.checkboxLabelContainer}>\r\n            <Text style={styles.checkboxLabel}>Insured Service Providers</Text>\r\n            <Tooltip \r\n              content=\"Insured providers maintain current liability insurance coverage for their services.\"\r\n              position=\"right\"\r\n            >\r\n              <MaterialCommunityIcons name=\"help-circle-outline\" size={20} color={theme.colors.text} />\r\n            </Tooltip>\r\n          </View>\r\n        </View>\r\n      </View> */}\r\n\r\n      {/* Search Button - Always show */}\r\n      <TouchableOpacity \r\n        style={[styles.searchButton, isSearching && styles.searchButtonDisabled]}\r\n        onPress={handleSearch}\r\n        disabled={isSearching}\r\n      >\r\n        <Text style={styles.searchButtonText}>\r\n          {isSearching ? 'Searching...' : 'Search'}\r\n        </Text>\r\n      </TouchableOpacity>\r\n    </ScrollView>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    padding: theme.spacing.medium,\r\n    backgroundColor: theme.colors.surface,\r\n    height: '100%',\r\n    width: '100%',\r\n    overflow: 'visible',\r\n  },\r\n  header: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    marginBottom: theme.spacing.xlarge,\r\n    gap: theme.spacing.small,\r\n  },\r\n  title: {\r\n    fontSize: theme.fontSizes.xlarge,\r\n    fontWeight: '600',\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n  },\r\n  section: {\r\n    marginBottom: theme.spacing.xlarge,\r\n    position: 'relative',\r\n  },\r\n  label: {\r\n    fontSize: theme.fontSizes.medium,\r\n    fontWeight: '500',\r\n    color: theme.colors.text,\r\n    marginVertical: theme.spacing.small,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  dropdown: {\r\n    height: 48,\r\n    backgroundColor: theme.colors.background,\r\n    borderRadius: 8,\r\n    padding: theme.spacing.medium,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n  },\r\n  locationInputWrapper: {\r\n    position: 'relative',\r\n    marginBottom: theme.spacing.small,\r\n    zIndex: 1100,\r\n  },\r\n  locationInput: {\r\n    height: 48,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    borderRadius: 8,\r\n    paddingHorizontal: theme.spacing.medium,\r\n    backgroundColor: theme.colors.background,\r\n    fontSize: theme.fontSizes.medium,\r\n  },\r\n  suggestionsWrapper: {\r\n    position: 'absolute',\r\n    top: '100%',\r\n    left: 0,\r\n    right: 0,\r\n    maxHeight: 200,\r\n    backgroundColor: theme.colors.background,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    borderRadius: 8,\r\n    zIndex: 1100,\r\n    shadowColor: \"#000\",\r\n    shadowOffset: {\r\n      width: 0,\r\n      height: 2,\r\n    },\r\n    shadowOpacity: 0.1,\r\n    shadowRadius: 3,\r\n    elevation: 3,\r\n  },\r\n  suggestionsContainer: {\r\n    flex: 1,\r\n  },\r\n  suggestionItem: {\r\n    padding: theme.spacing.medium,\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: theme.colors.border,\r\n  },\r\n  suggestionItemNotSupported: {\r\n    backgroundColor: theme.colors.background,\r\n  },\r\n  suggestionText: {\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  suggestionTextNotSupported: {\r\n    color: theme.colors.placeholderText,\r\n    fontStyle: 'italic',\r\n  },\r\n  suggestionType: {\r\n    fontSize: theme.fontSizes.small,\r\n    color: theme.colors.placeholderText,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  datePickersContainer: {\r\n    flexDirection: 'column',\r\n    gap: theme.spacing.medium,\r\n    marginRight: 16,\r\n    zIndex: 500,\r\n  },\r\n  datePickerWrapper: {\r\n    width: '100%',\r\n  },\r\n  dateLabel: {\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.text,\r\n    marginBottom: 8,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    fontWeight: '500',\r\n  },\r\n  dateInput: {\r\n    height: 48,\r\n    backgroundColor: theme.colors.background,\r\n    borderRadius: 8,\r\n    padding: theme.spacing.medium,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    fontSize: theme.fontSizes.medium,\r\n  },\r\n  priceRangeContainer: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    gap: theme.spacing.medium,\r\n    marginTop: theme.spacing.small,\r\n  },\r\n  slider: {\r\n    flex: 1,\r\n    height: 48,\r\n    marginHorizontal: theme.spacing.medium,\r\n  },\r\n  priceText: {\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    minWidth: 50,\r\n  },\r\n  selectedText: {\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.text,\r\n    fontWeight: '500',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  placeholderText: {\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.placeholderText,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  dropdownContainer: {\r\n    backgroundColor: theme.colors.background,\r\n    borderRadius: 8,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    overflow: 'hidden',\r\n  },\r\n  dropdownItem: {\r\n    padding: theme.spacing.medium,\r\n  },\r\n  dropdownItemSelected: {\r\n    backgroundColor: theme.colors.surface,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.primary,\r\n    borderRadius: 8,\r\n    margin: 4,\r\n  },\r\n  dropdownItemText: {\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  dropdownItemTextSelected: {\r\n    color: theme.colors.primary,\r\n    fontWeight: '500',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  personButton: {\r\n    padding: theme.spacing.small,\r\n    borderRadius: 8,\r\n    marginLeft: 'auto',\r\n  },\r\n  showProfessionalsButton: {\r\n    backgroundColor: theme.colors.primary,\r\n    padding: theme.spacing.medium,\r\n    borderRadius: 8,\r\n    alignItems: 'center',\r\n    marginTop: theme.spacing.large,\r\n  },\r\n  showProfessionalsText: {\r\n    color: theme.colors.whiteText,\r\n    fontSize: theme.fontSizes.medium,\r\n    fontWeight: '600',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  locationContainer: {\r\n    flexDirection: 'column',\r\n    width: '100%',\r\n    gap: theme.spacing.small,\r\n    zIndex: 1100,\r\n    position: 'relative',\r\n  },\r\n  useLocationButton: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    padding: theme.spacing.small,\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 8,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    gap: 4,\r\n    alignSelf: 'flex-start',\r\n  },\r\n  useLocationText: {\r\n    color: theme.colors.text,\r\n    fontSize: theme.fontSizes.small,\r\n  },\r\n  input: {\r\n    height: 48,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    borderRadius: 8,\r\n    paddingHorizontal: theme.spacing.medium,\r\n    backgroundColor: theme.colors.surface,\r\n  },\r\n  animalTypesContainer: {\r\n    flexDirection: 'row',\r\n    flexWrap: 'wrap',\r\n    gap: theme.spacing.small,\r\n    marginTop: theme.spacing.small,\r\n    marginBottom: theme.spacing.medium,\r\n    zIndex: 800,\r\n  },\r\n  animalTypeButton: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    padding: theme.spacing.small,\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 20,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    gap: 4,\r\n  },\r\n  animalTypeButtonSelected: {\r\n    backgroundColor: theme.colors.primary,\r\n    borderColor: theme.colors.primary,\r\n  },\r\n  animalTypeLabel: {\r\n    color: theme.colors.text,\r\n    fontSize: theme.fontSizes.small,\r\n  },\r\n  animalTypeLabelSelected: {\r\n    color: theme.colors.whiteText,\r\n  },\r\n  switchContainer: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    justifyContent: Platform.OS === 'web' ? 'space-between' : 'flex-start',\r\n    marginVertical: theme.spacing.small,\r\n    gap: theme.spacing.medium,\r\n    zIndex: 700,\r\n  },\r\n  priceContainer: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    gap: theme.spacing.small,\r\n    zIndex: 600,\r\n  },\r\n  priceLabel: {\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.text,\r\n    minWidth: 50,\r\n  },\r\n  checkboxContainer: {\r\n    marginTop: theme.spacing.medium,\r\n    gap: theme.spacing.small,\r\n    zIndex: 400,\r\n  },\r\n  checkboxRow: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    gap: theme.spacing.small,\r\n  },\r\n  checkbox: {\r\n    width: 24,\r\n    height: 24,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    borderRadius: 4,\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    backgroundColor: theme.colors.surface,\r\n  },\r\n  checkboxLabel: {\r\n    flex: 1,\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.text,\r\n  },\r\n  headerButtons: {\r\n    flexDirection: 'row',\r\n    gap: theme.spacing.small,\r\n  },\r\n  iconButton: {\r\n    padding: theme.spacing.small,\r\n    borderRadius: 8,\r\n  },\r\n  checkboxLabelContainer: {\r\n    flex: 1,\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    justifyContent: 'space-between',\r\n    paddingRight: theme.spacing.small,\r\n  },\r\n  searchButton: {\r\n    backgroundColor: theme.colors.primary,\r\n    padding: theme.spacing.medium,\r\n    borderRadius: 8,\r\n    alignItems: 'center',\r\n    marginTop: theme.spacing.large,\r\n    marginBottom: theme.spacing.large,\r\n  },\r\n  searchButtonText: {\r\n    color: theme.colors.whiteText,\r\n    fontSize: theme.fontSizes.medium,\r\n    fontWeight: '600',\r\n  },\r\n  searchButtonDisabled: {\r\n    backgroundColor: theme.colors.border,\r\n    opacity: 0.6,\r\n  },\r\n  otherAnimalInputWrapper: {\r\n    backgroundColor: theme.colors.background,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    borderRadius: 8,\r\n    marginTop: theme.spacing.small,\r\n    shadowColor: \"#000\",\r\n    shadowOffset: {\r\n      width: 0,\r\n      height: 2,\r\n    },\r\n    shadowOpacity: 0.1,\r\n    shadowRadius: 3,\r\n    elevation: 3,\r\n  },\r\n  otherAnimalHeader: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    padding: theme.spacing.medium,\r\n  },\r\n  otherAnimalTitle: {\r\n    fontSize: theme.fontSizes.medium,\r\n    fontWeight: '600',\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  closeButton: {\r\n    padding: theme.spacing.small,\r\n    borderRadius: 8,\r\n  },\r\n  animalInput: {\r\n    height: 48,\r\n    borderWidth: 0,\r\n    borderRadius: 8,\r\n    paddingHorizontal: theme.spacing.medium,\r\n    backgroundColor: theme.colors.background,\r\n    fontSize: theme.fontSizes.medium,\r\n    marginHorizontal: theme.spacing.medium,\r\n    marginBottom: theme.spacing.small,\r\n  },\r\n  animalSuggestionsWrapper: {\r\n    flex: 1,\r\n  },\r\n  animalSuggestionsContainer: {\r\n    flex: 1,\r\n  },\r\n  animalSuggestionItem: {\r\n    padding: theme.spacing.medium,\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: theme.colors.border,\r\n  },\r\n  animalSuggestionText: {\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  animalSelectionWrapper: {\r\n    flexDirection: 'column',\r\n    gap: theme.spacing.small,\r\n  },\r\n  selectedAnimalsContainer: {\r\n    marginTop: theme.spacing.medium,\r\n    padding: theme.spacing.medium,\r\n    backgroundColor: theme.colors.background,\r\n    borderRadius: 8,\r\n  },\r\n  selectedAnimalsLabel: {\r\n    fontSize: theme.fontSizes.medium,\r\n    fontWeight: '500',\r\n    color: theme.colors.text,\r\n    marginBottom: theme.spacing.small,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  selectedAnimalsList: {\r\n    flexDirection: 'row',\r\n    flexWrap: 'wrap',\r\n    gap: theme.spacing.small,\r\n  },\r\n  selectedAnimalTag: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    padding: theme.spacing.small,\r\n    backgroundColor: theme.colors.primary,\r\n    borderRadius: 8,\r\n    gap: theme.spacing.small,\r\n  },\r\n  selectedAnimalText: {\r\n    color: theme.colors.whiteText,\r\n    fontSize: theme.fontSizes.medium,\r\n    fontWeight: '500',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n});\r\n\r\nexport default SearchRefiner; ","import React from 'react';\r\nimport { View, Text, FlatList, StyleSheet, Image, TouchableOpacity, Platform } from 'react-native';\r\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\r\nimport { theme } from '../styles/theme';\r\n\r\nimport { BACKEND_TO_FRONTEND_TIME_UNIT } from '../data/mockData';\r\nimport { debugLog } from '../context/AuthContext';\r\n\r\nconst ProfessionalCard = ({ professional, index, onPress }) => {\r\n  // Debug log for unit_of_time mapping\r\n  if (professional.primary_service?.unit_of_time) {\r\n    debugLog(\"MBA4001: Unit of time mapping\", {\r\n      backend_value: professional.primary_service.unit_of_time,\r\n      frontend_value: BACKEND_TO_FRONTEND_TIME_UNIT[professional.primary_service.unit_of_time],\r\n      professional_name: professional.name\r\n    });\r\n  }\r\n  \r\n  const handlePress = () => {\r\n    if (onPress) {\r\n      onPress();\r\n    }\r\n  };\r\n\r\n  // Get profile picture source - use default if no URL provided\r\n  const getProfilePictureSource = () => {\r\n    if (professional.profile_picture_url) {\r\n      return { uri: professional.profile_picture_url };\r\n    }\r\n    return require('../../assets/default-profile.png');\r\n  };\r\n\r\n  return (\r\n    <TouchableOpacity style={styles.listItem} onPress={handlePress}>\r\n      <View style={styles.cardContent}>\r\n        <View style={styles.leftSection}>\r\n          <Image \r\n            source={getProfilePictureSource()} \r\n            style={styles.profileImage}\r\n          />\r\n        </View>\r\n        \r\n        <View style={styles.mainContent}>\r\n          <View style={styles.header}>\r\n            <View style={styles.nameSection}>\r\n              <Text style={styles.name}>{index + 1}. {professional.primary_service?.service_name || 'Various Services'}</Text>\r\n              <Text style={styles.location}>{professional.location}</Text>\r\n              <Text style={styles.distance}>{professional.name}</Text>\r\n            </View>\r\n            \r\n            <View style={styles.priceSection}>\r\n              <Text style={styles.fromText}>from</Text>\r\n              <Text style={styles.amount}>\r\n                <Text style={styles.dollarSign}>$</Text>\r\n                {professional.primary_service ? professional.primary_service.price_per_visit : 'N/A'}\r\n              </Text>\r\n              <Text style={styles.perNight}>\r\n                {professional.primary_service ? \r\n                  (BACKEND_TO_FRONTEND_TIME_UNIT[professional.primary_service.unit_of_time] || professional.primary_service.unit_of_time) : \r\n                  'per visit'}\r\n              </Text>\r\n            </View>\r\n          </View>\r\n        </View>\r\n      </View>\r\n\r\n      {/* TODO: Comment out reviews section until we implement reviews */}\r\n      {/* \r\n      <View style={styles.reviewSection}>\r\n        <View style={styles.ratingContainer}>\r\n          <MaterialCommunityIcons name=\"star\" size={16} color=\"#FFD700\" />\r\n          <Text style={styles.ratingText}>{professional.rating}</Text>\r\n          <Text style={styles.dot}> • </Text>\r\n          <Text style={styles.reviews}>{professional.reviewCount} reviews</Text>\r\n          {professional.repeat_owners && (\r\n            <>\r\n              <Text style={styles.dot}> • </Text>\r\n              <MaterialCommunityIcons name=\"sync\" size={16} color={theme.colors.text} />\r\n              <Text style={styles.repeatOwners}> {professional.repeat_owners} repeat owners</Text>\r\n            </>\r\n          )}\r\n        </View>\r\n        \r\n        {professional.bestReview && (\r\n          <View style={styles.bestReviewContainer}>\r\n            <Image \r\n              source={require('../../assets/default-profile.png')}\r\n              style={styles.reviewerImage}\r\n            />\r\n            <View style={styles.bestReviewTextContainer}>\r\n              <Text style={styles.bestReview} numberOfLines={2}>\r\n                \"{professional.bestReview}\"\r\n                <Text style={styles.readMore}> Read more</Text>\r\n              </Text>\r\n            </View>\r\n          </View>\r\n        )}\r\n      </View>\r\n      */}\r\n    </TouchableOpacity>\r\n  );\r\n};\r\n\r\nconst ProfessionalList = ({ professionals, onLoadMore, onProfessionalSelect, isMobile, filters, onFilterPress, searchParams = null }) => {\r\n  \r\n  // Function to generate appropriate empty state message\r\n  const getEmptyStateMessage = () => {\r\n    if (!searchParams) {\r\n      return {\r\n        title: \"No professionals found\",\r\n        message: \"Please try adjusting your search criteria.\"\r\n      };\r\n    }\r\n\r\n    const { animal_types = [], location = '', service_query = '', overnight_service = false } = searchParams;\r\n    \r\n    // Check if location is Colorado Springs area\r\n    const isColoradoSprings = location.toLowerCase().includes('colorado springs') || \r\n                             location.toLowerCase().includes('colorado') ||\r\n                             location === '';\r\n\r\n    // If no professionals in Colorado Springs area at all\r\n    if (isColoradoSprings && animal_types.length === 0 && !service_query && !overnight_service) {\r\n      return {\r\n        title: \"No professionals in the Colorado Springs area yet!\",\r\n        message: \"Please come back later when we onboard more professionals to your area.\"\r\n      };\r\n    }\r\n\r\n    // Build specific message based on search criteria\r\n    let criteria = [];\r\n    \r\n    if (animal_types.length > 0) {\r\n      const animalText = animal_types.length === 1 ? \r\n        `${animal_types[0]} care` : \r\n        `care for ${animal_types.join(', ')}`;\r\n      criteria.push(animalText);\r\n    }\r\n    \r\n    if (service_query) {\r\n      criteria.push(`\"${service_query}\" services`);\r\n    }\r\n    \r\n    if (overnight_service) {\r\n      criteria.push('overnight services');\r\n    }\r\n    \r\n    if (location && !isColoradoSprings) {\r\n      criteria.push(`in ${location}`);\r\n    }\r\n\r\n    if (criteria.length > 0) {\r\n      const criteriaText = criteria.join(', ');\r\n      return {\r\n        title: `No professionals found with ${criteriaText}`,\r\n        message: \"Please try adjusting your search parameters or expanding your search area.\"\r\n      };\r\n    }\r\n\r\n    return {\r\n      title: \"No professionals found\",\r\n      message: \"Please try adjusting your search criteria.\"\r\n    };\r\n  };\r\n\r\n  const renderEmptyState = () => {\r\n    const emptyState = getEmptyStateMessage();\r\n    \r\n    debugLog(\"MBA4001: Showing empty state\", {\r\n      searchParams,\r\n      emptyStateTitle: emptyState.title,\r\n      emptyStateMessage: emptyState.message\r\n    });\r\n    \r\n    return (\r\n      <View style={styles.emptyStateContainer}>\r\n        <MaterialCommunityIcons \r\n          name=\"account-search\" \r\n          size={80} \r\n          color={theme.colors.textSecondary} \r\n        />\r\n        <Text style={styles.emptyStateTitle}>{emptyState.title}</Text>\r\n        <Text style={styles.emptyStateMessage}>{emptyState.message}</Text>\r\n        <TouchableOpacity \r\n          style={styles.adjustSearchButton}\r\n          onPress={() => onFilterPress && onFilterPress()}\r\n        >\r\n          <Text style={styles.adjustSearchButtonText}>Adjust Search</Text>\r\n        </TouchableOpacity>\r\n      </View>\r\n    );\r\n  };\r\n\r\n  const renderHeader = () => (\r\n    <View style={[styles.header, {borderBottomWidth: 1, borderBottomColor: theme.colors.border, paddingBottom: theme.spacing.medium}]}>\r\n      <View style={styles.headerContent}>\r\n        <Text style={styles.headerTitle}>Pet Care Professionals</Text>\r\n        <View style={styles.filterChips}>\r\n          {filters?.categories?.map((filter, index) => (\r\n            <View key={index} style={styles.filterChip}>\r\n              <Text style={styles.filterChipText}>{filter}</Text>\r\n            </View>\r\n          ))}\r\n        </View>\r\n      </View>\r\n      <View style={styles.headerButtons}>\r\n        <TouchableOpacity style={styles.filterButton} onPress={onFilterPress}>\r\n          <MaterialCommunityIcons name=\"filter\" size={24} color={theme.colors.text} />\r\n        </TouchableOpacity>\r\n        {isMobile && (\r\n          <TouchableOpacity \r\n            style={styles.filterButton} \r\n            onPress={() => {\r\n              // Navigate to the map view\r\n              if (onFilterPress) {\r\n                // Pass a special parameter to indicate we want to switch to map view\r\n                onFilterPress('map');\r\n              }\r\n            }}\r\n          >\r\n            <MaterialCommunityIcons name=\"map\" size={24} color={theme.colors.text} />\r\n          </TouchableOpacity>\r\n        )}\r\n      </View>\r\n    </View>\r\n  );\r\n\r\n  // If no professionals, show empty state\r\n  if (!professionals || professionals.length === 0) {\r\n    return (\r\n      <View style={styles.container}>\r\n        {renderHeader()}\r\n        {renderEmptyState()}\r\n      </View>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <View style={styles.container}>\r\n      {renderHeader()}\r\n      <FlatList\r\n        data={professionals}\r\n        renderItem={({ item, index }) => (\r\n          <ProfessionalCard \r\n            professional={item}\r\n            index={index}\r\n            onPress={() => onProfessionalSelect(item)}\r\n          />\r\n        )}\r\n        keyExtractor={(item) => item.professional_id.toString()}\r\n        onEndReached={onLoadMore}\r\n        onEndReachedThreshold={0.5}\r\n        contentContainerStyle={styles.listContent}\r\n      />\r\n    </View>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    width: '100%',\r\n    backgroundColor: theme.colors.surfaceContrast,\r\n  },\r\n  listContent: {\r\n    flexGrow: 1,\r\n    // padding: theme.spacing.medium,\r\n  },\r\n  listItem: {\r\n    width: '100%',\r\n    backgroundColor: theme.colors.surfaceContrast,\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: theme.colors.border,\r\n    shadowColor: \"#000\",\r\n    shadowOffset: {\r\n      width: 0,\r\n      height: 2,\r\n    },\r\n    shadowOpacity: 0.1,\r\n    shadowRadius: 3,\r\n    elevation: 3,\r\n  },\r\n  cardContent: {\r\n    flexDirection: 'row',\r\n    paddingHorizontal: theme.spacing.medium,\r\n    paddingTop: theme.spacing.medium,\r\n    paddingBottom: theme.spacing.medium,\r\n  },\r\n  leftSection: {\r\n    marginRight: theme.spacing.medium,\r\n  },\r\n  profileImage: {\r\n    width: 80,\r\n    height: 80,\r\n    borderRadius: 40,\r\n  },\r\n  mainContent: {\r\n    flex: 1,\r\n  },\r\n  header: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'flex-start',\r\n  },\r\n  nameSection: {\r\n    flex: 1,\r\n    marginRight: theme.spacing.medium,\r\n  },\r\n  name: {\r\n    fontSize: theme.fontSizes.large,\r\n    fontWeight: '600',\r\n    color: theme.colors.text,\r\n    marginBottom: 4,\r\n  },\r\n  location: {\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.textSecondary,\r\n    marginBottom: 2,\r\n  },\r\n  distance: {\r\n    fontSize: theme.fontSizes.small,\r\n    color: theme.colors.textSecondary,\r\n  },\r\n  priceSection: {\r\n    alignItems: 'flex-end',\r\n  },\r\n  fromText: {\r\n    fontSize: theme.fontSizes.small,\r\n    color: theme.colors.textSecondary,\r\n  },\r\n  amount: {\r\n    fontSize: theme.fontSizes.large + 4,\r\n    fontWeight: '600',\r\n    color: theme.colors.primary,\r\n    marginVertical: 2,\r\n  },\r\n  dollarSign: {\r\n    color: theme.colors.primary,\r\n  },\r\n  perNight: {\r\n    fontSize: theme.fontSizes.small,\r\n    color: theme.colors.textSecondary,\r\n  },\r\n  reviewSection: {\r\n    paddingHorizontal: theme.spacing.medium,\r\n    paddingVertical: theme.spacing.small,\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: theme.colors.border,\r\n  },\r\n  ratingContainer: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    marginBottom: theme.spacing.small,\r\n  },\r\n  ratingText: {\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.text,\r\n    fontWeight: '500',\r\n    marginLeft: 4,\r\n  },\r\n  dot: {\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.textSecondary,\r\n  },\r\n  reviews: {\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.textSecondary,\r\n  },\r\n  repeatOwners: {\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.textSecondary,\r\n  },\r\n  bestReviewContainer: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n  },\r\n  reviewerImage: {\r\n    width: 32,\r\n    height: 32,\r\n    borderRadius: 16,\r\n    marginRight: theme.spacing.small,\r\n  },\r\n  bestReviewTextContainer: {\r\n    flex: 1,\r\n  },\r\n  bestReview: {\r\n    flex: 1,\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.text,\r\n    fontStyle: 'italic',\r\n  },\r\n  readMore: {\r\n    color: theme.colors.primary,\r\n    fontStyle: 'normal',\r\n    fontWeight: '500',\r\n  },\r\n  header: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'flex-start',\r\n    paddingHorizontal: theme.spacing.medium,\r\n    paddingTop: theme.spacing.medium,\r\n    backgroundColor: theme.colors.surfaceContrast,\r\n    \r\n  },\r\n  mobileHeaderRight: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n  },\r\n  headerContent: {\r\n    flex: 1,\r\n    marginRight: theme.spacing.medium,\r\n  },\r\n  headerTitle: {\r\n    fontSize: theme.fontSizes.large,\r\n    fontWeight: '600',\r\n    color: theme.colors.text,\r\n    marginBottom: theme.spacing.small,\r\n  },\r\n  filterChips: {\r\n    flexDirection: 'row',\r\n    flexWrap: 'wrap',\r\n    gap: theme.spacing.small,\r\n  },\r\n  filterChip: {\r\n    backgroundColor: theme.colors.background,\r\n    paddingHorizontal: theme.spacing.medium,\r\n    paddingVertical: theme.spacing.small,\r\n    borderRadius: 16,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n  },\r\n  filterChipText: {\r\n    fontSize: theme.fontSizes.small,\r\n    color: theme.colors.text,\r\n  },\r\n  filterButton: {\r\n    padding: theme.spacing.small,\r\n    borderRadius: 8,\r\n  },\r\n  headerButtons: {\r\n    flexDirection: 'row',\r\n    gap: theme.spacing.small,\r\n  },\r\n  emptyStateContainer: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    padding: theme.spacing.large,\r\n  },\r\n  emptyStateTitle: {\r\n    fontSize: theme.fontSizes.large,\r\n    fontWeight: '600',\r\n    color: theme.colors.text,\r\n    marginTop: theme.spacing.medium,\r\n    marginBottom: theme.spacing.small,\r\n    textAlign: 'center',\r\n  },\r\n  emptyStateMessage: {\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.textSecondary,\r\n    textAlign: 'center',\r\n    marginBottom: theme.spacing.large,\r\n    lineHeight: 22,\r\n  },\r\n  adjustSearchButton: {\r\n    paddingHorizontal: theme.spacing.large,\r\n    paddingVertical: theme.spacing.medium,\r\n    borderRadius: 8,\r\n    backgroundColor: theme.colors.primary,\r\n  },\r\n  adjustSearchButtonText: {\r\n    fontSize: theme.fontSizes.medium,\r\n    fontWeight: '600',\r\n    color: theme.colors.whiteText,\r\n  },\r\n});\r\n\r\nexport default ProfessionalList;","import React, { useState, useRef, useEffect } from 'react';\r\nimport { View, StyleSheet, Platform } from 'react-native';\r\nimport { MapContainer, TileLayer, Marker, Popup, useMap } from 'react-leaflet';\r\nimport { theme } from '../styles/theme';\r\nimport { BACKEND_TO_FRONTEND_TIME_UNIT } from '../data/mockData';\r\nimport 'leaflet/dist/leaflet.css';\r\nimport L from 'leaflet';\r\n\r\n// Fix for default marker icons in Leaflet\r\ndelete L.Icon.Default.prototype._getIconUrl;\r\nL.Icon.Default.mergeOptions({\r\n  iconRetinaUrl: require('leaflet/dist/images/marker-icon-2x.png'),\r\n  iconUrl: require('leaflet/dist/images/marker-icon.png'),\r\n  shadowUrl: require('leaflet/dist/images/marker-shadow.png'),\r\n});\r\n\r\nconst MapView = ({ professionals, onMarkerPress, region, isMobile, onShowServicesModal }) => {\r\n  if (Platform.OS === 'web') {\r\n    return (\r\n      <WebMapComponent\r\n        professionals={professionals}\r\n        onMarkerPress={onMarkerPress}\r\n        region={region}\r\n        isMobile={isMobile}\r\n        onShowServicesModal={onShowServicesModal}\r\n      />\r\n    );\r\n  }\r\n\r\n  return (\r\n    <NativeMapComponent\r\n      professionals={professionals}\r\n      onMarkerPress={onMarkerPress}\r\n      region={region}\r\n      isMobile={isMobile}\r\n      onShowServicesModal={onShowServicesModal}\r\n    />\r\n  );\r\n};\r\n\r\n// Custom marker component that handles hover behavior\r\nconst HoverMarker = ({ professional, onShowServicesModal }) => {\r\n  const markerRef = useRef(null);\r\n  const popupRef = useRef(null);\r\n\r\n  const MarkerIcon = L.divIcon({\r\n    className: 'custom-marker',\r\n    html: `<div style=\"\r\n    width: 32px;\r\n    height: 32px;\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n  \">\r\n    <svg viewBox=\"0 0 24 24\" width=\"32\" height=\"32\">\r\n      <path fill=\"${theme.colors.primary}\" d=\"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z\"/>\r\n    </svg>\r\n  </div>`,\r\n    iconSize: [32, 32],\r\n    iconAnchor: [16, 32],\r\n    popupAnchor: [0, -32],\r\n  });\r\n\r\n  const formatTimeUnit = (unit) => {\r\n    return BACKEND_TO_FRONTEND_TIME_UNIT[unit] || unit;\r\n  };\r\n\r\n  const handleViewDetails = () => {\r\n    if (onShowServicesModal) {\r\n      onShowServicesModal(professional);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    const marker = markerRef.current;\r\n    if (marker) {\r\n      const leafletMarker = marker.getElement ? marker : marker._leaflet_marker;\r\n      \r\n      if (leafletMarker) {\r\n        leafletMarker.on('mouseover', () => {\r\n          if (popupRef.current) {\r\n            popupRef.current.openOn(marker._map);\r\n          }\r\n        });\r\n      }\r\n    }\r\n  }, []);\r\n\r\n  return (\r\n    <Marker\r\n      ref={markerRef}\r\n      position={[professional.coordinates.latitude, professional.coordinates.longitude]}\r\n      icon={MarkerIcon}\r\n    >\r\n      <Popup\r\n        ref={popupRef}\r\n        closeButton={true}\r\n        autoClose={false}\r\n        closeOnClick={false}\r\n        closeOnEscapeKey={true}\r\n      >\r\n        <div style={styles.popupContent}>\r\n          <h3 style={{\r\n            margin: '0 0 8px 0',\r\n            fontSize: '18px',\r\n            fontWeight: '600',\r\n            fontFamily: theme.fonts.header.fontFamily,\r\n            color: theme.colors.text,\r\n          }}>{professional.name}</h3>\r\n          <p style={{\r\n            margin: '0 0 4px 0',\r\n            fontSize: '14px',\r\n            color: theme.colors.textSecondary,\r\n          }}>{professional.location}</p>\r\n          <p style={{\r\n            margin: '0 0 8px 0',\r\n            fontSize: '14px',\r\n            color: theme.colors.text,\r\n            fontWeight: '500',\r\n          }}>{professional.primary_service?.service_name}</p>\r\n          <p style={{\r\n            margin: '0 0 12px 0',\r\n            fontSize: '16px',\r\n            fontWeight: '600',\r\n            color: theme.colors.primary,\r\n          }}>from ${professional.primary_service?.price_per_visit || 'N/A'}/{formatTimeUnit(professional.primary_service?.unit_of_time || 'visit')}</p>\r\n          <button \r\n            style={{\r\n              backgroundColor: theme.colors.primary,\r\n              color: theme.colors.whiteText,\r\n              border: 'none',\r\n              padding: '10px 16px',\r\n              borderRadius: '8px',\r\n              fontSize: '14px',\r\n              fontWeight: '500',\r\n              cursor: 'pointer',\r\n              width: '100%',\r\n            }}\r\n            onClick={handleViewDetails}\r\n          >\r\n            View Details\r\n          </button>\r\n        </div>\r\n      </Popup>\r\n    </Marker>\r\n  );\r\n};\r\n\r\nconst WebMapComponent = ({ professionals, onMarkerPress, region, isMobile, onShowServicesModal }) => {\r\n  const formatTimeUnit = (unit) => {\r\n    return BACKEND_TO_FRONTEND_TIME_UNIT[unit] || unit;\r\n  };\r\n\r\n  const handleViewDetails = (professional) => {\r\n    if (onShowServicesModal) {\r\n      onShowServicesModal(professional);\r\n    }\r\n  };\r\n\r\n  // Calculate map bounds and center based on professionals\r\n  const calculateMapBounds = () => {\r\n    const validProfessionals = professionals.filter(professional => \r\n      professional.coordinates && \r\n      professional.coordinates.latitude && \r\n      professional.coordinates.longitude\r\n    );\r\n\r\n    if (validProfessionals.length === 0) {\r\n      // Default to provided region if no professionals\r\n      return {\r\n        center: [region.latitude, region.longitude],\r\n        zoom: 13\r\n      };\r\n    }\r\n\r\n    if (validProfessionals.length === 1) {\r\n      // Single professional - center on them\r\n      const prof = validProfessionals[0];\r\n      return {\r\n        center: [prof.coordinates.latitude, prof.coordinates.longitude],\r\n        zoom: 14\r\n      };\r\n    }\r\n\r\n    // Multiple professionals - calculate bounds\r\n    const lats = validProfessionals.map(p => p.coordinates.latitude);\r\n    const lngs = validProfessionals.map(p => p.coordinates.longitude);\r\n    \r\n    const minLat = Math.min(...lats);\r\n    const maxLat = Math.max(...lats);\r\n    const minLng = Math.min(...lngs);\r\n    const maxLng = Math.max(...lngs);\r\n\r\n    const centerLat = (minLat + maxLat) / 2;\r\n    const centerLng = (minLng + maxLng) / 2;\r\n\r\n    // Calculate zoom level based on bounds\r\n    const latDiff = maxLat - minLat;\r\n    const lngDiff = maxLng - minLng;\r\n    const maxDiff = Math.max(latDiff, lngDiff);\r\n\r\n    let zoom = 13;\r\n    if (maxDiff > 0.5) zoom = 10;\r\n    else if (maxDiff > 0.2) zoom = 11;\r\n    else if (maxDiff > 0.1) zoom = 12;\r\n    else if (maxDiff > 0.05) zoom = 13;\r\n    else zoom = 14;\r\n\r\n    return {\r\n      center: [centerLat, centerLng],\r\n      zoom: zoom\r\n    };\r\n  };\r\n\r\n  const mapBounds = calculateMapBounds();\r\n\r\n  return (\r\n    <div style={styles.mapContainer}>\r\n      <MapContainer\r\n        center={mapBounds.center}\r\n        zoom={mapBounds.zoom}\r\n        style={{ height: '100%', width: '100%' }}\r\n        key={`${mapBounds.center[0]}-${mapBounds.center[1]}-${mapBounds.zoom}`}\r\n      >\r\n        <TileLayer\r\n          url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\r\n          attribution='&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\r\n        />\r\n        {professionals.filter(professional => \r\n          professional.coordinates && \r\n          professional.coordinates.latitude && \r\n          professional.coordinates.longitude\r\n        ).map((professional, index) => (\r\n          <HoverMarker\r\n            key={professional.professional_id}\r\n            professional={professional}\r\n            onShowServicesModal={onShowServicesModal}\r\n          />\r\n        ))}\r\n      </MapContainer>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst NativeMapComponent = ({ professionals, onMarkerPress, region, isMobile }) => {\r\n  return (\r\n    <View style={styles.mapContainer}>\r\n      {/* Implement native map component here if needed */}\r\n    </View>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  mapContainer: {\r\n    flex: 1,\r\n    backgroundColor: theme.colors.background,\r\n    height: '100%',\r\n    width: '100%',\r\n    overflow: 'hidden',\r\n  },\r\n  map: {\r\n    flex: 1,\r\n    height: '100%',\r\n    width: '100%',\r\n  },\r\n  markerContainer: {\r\n    backgroundColor: theme.colors.primary,\r\n    borderRadius: 20,\r\n    padding: theme.spacing.small,\r\n    borderWidth: 2,\r\n    borderColor: 'white',\r\n  },\r\n  markerText: {\r\n    color: theme.colors.whiteText,\r\n    fontWeight: 'bold',\r\n  },\r\n  calloutContainer: {\r\n    backgroundColor: theme.colors.surface,\r\n    padding: theme.spacing.small,\r\n    borderRadius: 8,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n  },\r\n  calloutText: {\r\n    color: theme.colors.text,\r\n    fontSize: theme.fontSizes.small,\r\n  },\r\n  popupContent: {\r\n    padding: 16,\r\n    minWidth: 250,\r\n    maxWidth: 300,\r\n  },\r\n});\r\n\r\nexport default MapView;","import React, { useState, useEffect } from 'react';\r\nimport { View, Text, Modal, TouchableOpacity, ScrollView, StyleSheet, ActivityIndicator, Dimensions, Alert } from 'react-native';\r\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\r\nimport { theme } from '../styles/theme';\r\nimport { getProfessionalServicesDetailed, createConversation } from '../api/API';\r\nimport { debugLog } from '../context/AuthContext';\r\nimport { useNavigation } from '@react-navigation/native';\r\n\r\nconst ProfessionalServicesModal = ({ visible, onClose, professional, primaryService }) => {\r\n  const navigation = useNavigation();\r\n  const [services, setServices] = useState([]);\r\n  const [selectedService, setSelectedService] = useState(null);\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState(null);\r\n  const [showTooltip, setShowTooltip] = useState(null);\r\n  const [mobileView, setMobileView] = useState('services'); // 'services' or 'details'\r\n  const [isCreatingConversation, setIsCreatingConversation] = useState(false);\r\n  \r\n  const { width: screenWidth } = Dimensions.get('window');\r\n  const isMobile = screenWidth <= 768;\r\n  const isSmallMobile = screenWidth <= 600;\r\n\r\n  useEffect(() => {\r\n    if (visible && professional?.professional_id) {\r\n      fetchServices();\r\n    }\r\n  }, [visible, professional?.professional_id]);\r\n\r\n  useEffect(() => {\r\n    // Set the primary service as selected when services load\r\n    if (services.length > 0 && primaryService) {\r\n      const primaryServiceData = services.find(s => s.service_id === primaryService.service_id);\r\n      if (primaryServiceData) {\r\n        setSelectedService(primaryServiceData);\r\n      } else {\r\n        // Fallback to first service if primary not found\r\n        setSelectedService(services[0]);\r\n      }\r\n    } else if (services.length > 0) {\r\n      setSelectedService(services[0]);\r\n    }\r\n  }, [services, primaryService]);\r\n\r\n  const fetchServices = async () => {\r\n    setLoading(true);\r\n    setError(null);\r\n    try {\r\n      debugLog('MBA9999', 'Fetching services for professional:', professional.professional_id);\r\n      const servicesData = await getProfessionalServicesDetailed(professional.professional_id);\r\n      setServices(servicesData);\r\n    } catch (err) {\r\n      debugLog('MBA9999', 'Error fetching professional services:', err);\r\n      setError('Failed to load services');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleClose = () => {\r\n    setSelectedService(null);\r\n    setServices([]);\r\n    setError(null);\r\n    setShowTooltip(null);\r\n    setMobileView('services');\r\n    onClose();\r\n  };\r\n\r\n  const handleServiceSelect = (service) => {\r\n    setSelectedService(service);\r\n    if (isMobile) {\r\n      setMobileView('details');\r\n    }\r\n  };\r\n\r\n  const handleBackToServices = () => {\r\n    setMobileView('services');\r\n  };\r\n\r\n  const formatAnimalTypes = (animalTypes) => {\r\n    if (!animalTypes || typeof animalTypes !== 'object') return 'Various animals';\r\n    const types = Object.keys(animalTypes);\r\n    if (types.length === 0) return 'Various animals';\r\n    if (types.length === 1) return types[0];\r\n    if (types.length === 2) return `${types[0]} & ${types[1]}`;\r\n    return `${types[0]}, ${types[1]} & ${types.length - 2} more`;\r\n  };\r\n\r\n  const renderAdditionalRates = (rates) => {\r\n    if (!rates || rates.length === 0) return null;\r\n    \r\n    return (\r\n      <View style={styles.detailSection}>\r\n        <Text style={styles.detailLabel}>Additional Rates</Text>\r\n        {rates.map((rate) => (\r\n          <View key={rate.rate_id} style={styles.additionalRateItem}>\r\n            <View style={styles.additionalRateRow}>\r\n              <View style={styles.additionalRateTitleContainer}>\r\n                {rate.description && (\r\n                  <TouchableOpacity \r\n                    style={styles.infoIcon}\r\n                    onPress={() => setShowTooltip(showTooltip === rate.rate_id ? null : rate.rate_id)}\r\n                  >\r\n                    <MaterialCommunityIcons \r\n                      name=\"information-outline\" \r\n                      size={16} \r\n                      color={theme.colors.primary} \r\n                    />\r\n                  </TouchableOpacity>\r\n                )}\r\n                <Text style={styles.additionalRateTitle}>{rate.title}</Text>\r\n              </View>\r\n              <Text style={styles.additionalRatePrice}>${rate.rate}</Text>\r\n            </View>\r\n\r\n          </View>\r\n        ))}\r\n      </View>\r\n    );\r\n  };\r\n\r\n  const renderServiceDetails = (service) => (\r\n    <>\r\n      <View style={styles.detailSection}>\r\n        <Text style={styles.detailLabel}>Description</Text>\r\n        <Text style={styles.detailText}>{service.description}</Text>\r\n      </View>\r\n\r\n      <View style={styles.detailSection}>\r\n        <Text style={styles.detailLabel}>Animal Types</Text>\r\n        <Text style={styles.detailText}>{formatAnimalTypes(service.animal_types)}</Text>\r\n      </View>\r\n\r\n      <View style={styles.detailSection}>\r\n        <Text style={styles.detailLabel}>Base Rate</Text>\r\n        <Text style={styles.detailText}>${service.base_rate} per {service.unit_of_time}</Text>\r\n      </View>\r\n\r\n      <View style={styles.detailSection}>\r\n        <Text style={styles.detailLabel}>Additional Animal Rate</Text>\r\n        <Text style={styles.detailText}>\r\n          ${service.additional_animal_rate} (applies after {service.applies_after} animal{service.applies_after > 1 ? 's' : ''})\r\n        </Text>\r\n      </View>\r\n\r\n      {service.holiday_rate && \r\n       service.holiday_rate !== '$0' && \r\n       service.holiday_rate !== '$0.00' && \r\n       service.holiday_rate !== '0%' && \r\n       service.holiday_rate !== '0.00%' && \r\n       service.holiday_rate !== '0' && (\r\n        <View style={styles.detailSection}>\r\n          <Text style={styles.detailLabel}>Holiday Rate</Text>\r\n          <Text style={styles.detailText}>{service.holiday_rate}</Text>\r\n        </View>\r\n      )}\r\n\r\n      {service.is_overnight && (\r\n        <View style={styles.detailSection}>\r\n          <Text style={styles.overnightBadge}>Overnight Service</Text>\r\n        </View>\r\n      )}\r\n\r\n      {renderAdditionalRates(service.additional_rates)}\r\n    </>\r\n  );\r\n\r\n  const handleCreateConversation = async () => {\r\n    if (!professional?.professional_id) {\r\n      Alert.alert('Error', 'Professional information not available');\r\n      return;\r\n    }\r\n\r\n    setIsCreatingConversation(true);\r\n    try {\r\n      debugLog('MBA3456', 'Creating conversation with professional:', professional.professional_id);\r\n      const response = await createConversation(professional.professional_id);\r\n      \r\n      debugLog('MBA3456', 'Conversation created, navigating to MessageHistory with ID:', response.conversation_id);\r\n      \r\n      // Close the modal first\r\n      onClose();\r\n      \r\n      // Navigate to MessageHistory with the conversation ID\r\n      navigation.navigate('MessageHistory', { \r\n        conversationId: response.conversation_id,\r\n        otherUserName: professional.name\r\n      });\r\n    } catch (err) {\r\n      debugLog('MBA3456', 'Error creating conversation:', err);\r\n      Alert.alert('Error', 'Failed to create conversation. Please try again.');\r\n    } finally {\r\n      setIsCreatingConversation(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Modal\r\n      visible={visible}\r\n      onRequestClose={handleClose}\r\n      animationType=\"slide\"\r\n      transparent={true}\r\n    >\r\n      <View style={styles.modalOverlay}>\r\n        <View style={[styles.modalContainer, isSmallMobile && styles.modalContainerSmallMobile]}>\r\n          {/* Header */}\r\n          <View style={styles.header}>\r\n            <View style={styles.headerLeft}>\r\n              <Text style={styles.professionalName}>{professional?.name}</Text>\r\n              <Text style={styles.professionalLocation}>{professional?.location}</Text>\r\n            </View>\r\n            <TouchableOpacity onPress={handleClose} style={styles.closeButton}>\r\n              <MaterialCommunityIcons name=\"close\" size={24} color={theme.colors.text} />\r\n            </TouchableOpacity>\r\n          </View>\r\n\r\n          {loading ? (\r\n            <View style={styles.loadingContainer}>\r\n              <ActivityIndicator size=\"large\" color={theme.colors.primary} />\r\n              <Text style={styles.loadingText}>Loading services...</Text>\r\n            </View>\r\n          ) : error ? (\r\n            <View style={styles.errorContainer}>\r\n              <Text style={styles.errorText}>{error}</Text>\r\n              <TouchableOpacity style={styles.retryButton} onPress={fetchServices}>\r\n                <Text style={styles.retryText}>Retry</Text>\r\n              </TouchableOpacity>\r\n            </View>\r\n          ) : (\r\n            <View style={[styles.content, isMobile && styles.contentMobile]}>\r\n              {/* Mobile: Services List View */}\r\n              {isMobile && mobileView === 'services' && (\r\n                <View style={styles.mobileServicesView}>\r\n                  <Text style={styles.sectionTitle}>Services</Text>\r\n                  <ScrollView style={styles.servicesScrollView}>\r\n                    {services.map((service) => (\r\n                      <TouchableOpacity\r\n                        key={service.service_id}\r\n                        style={styles.mobileServiceItem}\r\n                        onPress={() => handleServiceSelect(service)}\r\n                      >\r\n                        <View style={styles.mobileServiceContent}>\r\n                          <Text style={styles.mobileServiceName}>\r\n                            {service.service_name}\r\n                          </Text>\r\n                          <Text style={styles.mobileServicePrice}>\r\n                            ${service.base_rate}/{service.unit_of_time}\r\n                          </Text>\r\n                        </View>\r\n                        <MaterialCommunityIcons \r\n                          name=\"chevron-right\" \r\n                          size={24} \r\n                          color={theme.colors.textSecondary} \r\n                        />\r\n                      </TouchableOpacity>\r\n                    ))}\r\n                  </ScrollView>\r\n                </View>\r\n              )}\r\n\r\n              {/* Mobile: Service Details View */}\r\n              {isMobile && mobileView === 'details' && selectedService && (\r\n                <View style={styles.mobileDetailsView}>\r\n                  <View style={styles.mobileDetailsHeader}>\r\n                    <TouchableOpacity \r\n                      style={styles.backButton}\r\n                      onPress={handleBackToServices}\r\n                    >\r\n                      <MaterialCommunityIcons \r\n                        name=\"arrow-left\" \r\n                        size={24} \r\n                        color={theme.colors.primary} \r\n                      />\r\n                    </TouchableOpacity>\r\n                    <Text style={styles.mobileDetailsTitle}>{selectedService.service_name}</Text>\r\n                  </View>\r\n                  <ScrollView style={styles.mobileDetailsScrollView}>\r\n                    {renderServiceDetails(selectedService)}\r\n                  </ScrollView>\r\n                </View>\r\n              )}\r\n\r\n              {/* Desktop: Two-panel layout */}\r\n              {!isMobile && (\r\n                <>\r\n                  {/* Services List (Left Side) */}\r\n                  <View style={styles.servicesList}>\r\n                    <Text style={styles.sectionTitle}>Services</Text>\r\n                    <ScrollView style={styles.servicesScrollView}>\r\n                      {services.map((service) => (\r\n                        <TouchableOpacity\r\n                          key={service.service_id}\r\n                          style={[\r\n                            styles.serviceItem,\r\n                            selectedService?.service_id === service.service_id && styles.serviceItemSelected\r\n                          ]}\r\n                          onPress={() => handleServiceSelect(service)}\r\n                        >\r\n                          <Text style={[\r\n                            styles.serviceName,\r\n                            selectedService?.service_id === service.service_id && styles.serviceNameSelected\r\n                          ]}>\r\n                            {service.service_name}\r\n                          </Text>\r\n                          <Text style={[\r\n                            styles.servicePrice,\r\n                            selectedService?.service_id === service.service_id && styles.servicePriceSelected\r\n                          ]}>\r\n                            ${service.base_rate}/{service.unit_of_time}\r\n                          </Text>\r\n                        </TouchableOpacity>\r\n                      ))}\r\n                    </ScrollView>\r\n                  </View>\r\n\r\n                  {/* Service Details (Right Side) */}\r\n                  <View style={styles.serviceDetails}>\r\n                    {selectedService ? (\r\n                      <ScrollView style={styles.detailsScrollView}>\r\n                        <Text style={styles.detailsTitle}>{selectedService.service_name}</Text>\r\n                        {renderServiceDetails(selectedService)}\r\n                      </ScrollView>\r\n                    ) : (\r\n                      <View style={styles.noSelectionContainer}>\r\n                        <Text style={styles.noSelectionText}>Select a service to view details</Text>\r\n                      </View>\r\n                    )}\r\n                  </View>\r\n                </>\r\n              )}\r\n            </View>\r\n          )}\r\n\r\n          {/* Contact Button */}\r\n          {!loading && !error && (\r\n            <View style={styles.footer}>\r\n              <TouchableOpacity \r\n                style={[styles.contactButton, isCreatingConversation && styles.contactButtonDisabled]} \r\n                onPress={handleCreateConversation}\r\n                disabled={isCreatingConversation}\r\n              >\r\n                {isCreatingConversation ? (\r\n                  <View style={styles.contactButtonContent}>\r\n                    <ActivityIndicator size=\"small\" color={theme.colors.whiteText} />\r\n                    <Text style={[styles.contactButtonText, { marginLeft: 8 }]}>Creating conversation...</Text>\r\n                  </View>\r\n                ) : (\r\n                  <Text style={styles.contactButtonText}>Contact {professional?.name}</Text>\r\n                )}\r\n              </TouchableOpacity>\r\n            </View>\r\n          )}\r\n        </View>\r\n      </View>\r\n\r\n      {/* Separate Modal for Tooltip */}\r\n      <Modal\r\n        visible={showTooltip !== null}\r\n        transparent\r\n        animationType=\"fade\"\r\n        onRequestClose={() => setShowTooltip(null)}\r\n      >\r\n        <TouchableOpacity \r\n          style={styles.tooltipModalOverlay}\r\n          activeOpacity={1}\r\n          onPress={() => setShowTooltip(null)}\r\n        >\r\n          <View style={styles.tooltipModalContent}>\r\n            <View style={styles.tooltipHeader}>\r\n              <Text style={styles.tooltipTitle}>\r\n                {services.find(s => s.additional_rates?.find(r => r.rate_id === showTooltip))?.additional_rates?.find(r => r.rate_id === showTooltip)?.title || 'Rate Info'}\r\n              </Text>\r\n              <TouchableOpacity \r\n                style={styles.tooltipCloseButton}\r\n                onPress={() => setShowTooltip(null)}\r\n              >\r\n                <MaterialCommunityIcons \r\n                  name=\"close\" \r\n                  size={18} \r\n                  color={theme.colors.text} \r\n                />\r\n              </TouchableOpacity>\r\n            </View>\r\n            <Text style={styles.tooltipText}>\r\n              {services.find(s => s.additional_rates?.find(r => r.rate_id === showTooltip))?.additional_rates?.find(r => r.rate_id === showTooltip)?.description || ''}\r\n            </Text>\r\n          </View>\r\n        </TouchableOpacity>\r\n      </Modal>\r\n    </Modal>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  modalOverlay: {\r\n    flex: 1,\r\n    backgroundColor: 'rgba(0, 0, 0, 0.5)',\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    padding: 20,\r\n  },\r\n  modalContainer: {\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 12,\r\n    width: '90%',\r\n    maxWidth: 800,\r\n    maxHeight: '80%',\r\n    overflow: 'hidden',\r\n  },\r\n  modalContainerSmallMobile: {\r\n    width: 'calc(100% - 10px)',\r\n    height: 'calc(100% - 10px)',\r\n    maxWidth: 'none',\r\n    maxHeight: 'none',\r\n    borderRadius: 8,\r\n  },\r\n  header: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    padding: 20,\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: theme.colors.border,\r\n  },\r\n  headerLeft: {\r\n    flex: 1,\r\n  },\r\n  professionalName: {\r\n    fontSize: 20,\r\n    fontWeight: '600',\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n  },\r\n  professionalLocation: {\r\n    fontSize: 14,\r\n    color: theme.colors.textSecondary,\r\n    marginTop: 4,\r\n  },\r\n  closeButton: {\r\n    padding: 8,\r\n  },\r\n  loadingContainer: {\r\n    padding: 40,\r\n    alignItems: 'center',\r\n  },\r\n  loadingText: {\r\n    marginTop: 16,\r\n    color: theme.colors.textSecondary,\r\n  },\r\n  errorContainer: {\r\n    padding: 40,\r\n    alignItems: 'center',\r\n  },\r\n  errorText: {\r\n    color: theme.colors.error,\r\n    textAlign: 'center',\r\n    marginBottom: 16,\r\n  },\r\n  retryButton: {\r\n    backgroundColor: theme.colors.primary,\r\n    paddingHorizontal: 20,\r\n    paddingVertical: 10,\r\n    borderRadius: 8,\r\n  },\r\n  retryText: {\r\n    color: theme.colors.whiteText,\r\n    fontWeight: '500',\r\n  },\r\n  content: {\r\n    flexDirection: 'row',\r\n    flex: 1,\r\n  },\r\n  contentMobile: {\r\n    flexDirection: 'column',\r\n  },\r\n  // Mobile styles\r\n  mobileServicesView: {\r\n    flex: 1,\r\n    padding: 20,\r\n  },\r\n  mobileServiceItem: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    justifyContent: 'space-between',\r\n    padding: 16,\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: theme.colors.border,\r\n  },\r\n  mobileServiceContent: {\r\n    flex: 1,\r\n  },\r\n  mobileServiceName: {\r\n    fontSize: 16,\r\n    fontWeight: '500',\r\n    color: theme.colors.text,\r\n    marginBottom: 4,\r\n  },\r\n  mobileServicePrice: {\r\n    fontSize: 14,\r\n    color: theme.colors.textSecondary,\r\n  },\r\n  mobileDetailsView: {\r\n    flex: 1,\r\n  },\r\n  mobileDetailsHeader: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    padding: 20,\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: theme.colors.border,\r\n  },\r\n  backButton: {\r\n    padding: 8,\r\n    marginRight: 12,\r\n  },\r\n  mobileDetailsTitle: {\r\n    fontSize: 18,\r\n    fontWeight: '600',\r\n    color: theme.colors.text,\r\n    flex: 1,\r\n  },\r\n  mobileDetailsScrollView: {\r\n    flex: 1,\r\n    padding: 20,\r\n  },\r\n  // Desktop styles\r\n  servicesList: {\r\n    width: '40%',\r\n    borderRightWidth: 1,\r\n    borderRightColor: theme.colors.border,\r\n    padding: 20,\r\n  },\r\n  sectionTitle: {\r\n    fontSize: 18,\r\n    fontWeight: '600',\r\n    color: theme.colors.text,\r\n    marginBottom: 16,\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n  },\r\n  servicesScrollView: {\r\n    flex: 1,\r\n  },\r\n  serviceItem: {\r\n    padding: 12,\r\n    borderRadius: 8,\r\n    marginBottom: 8,\r\n    backgroundColor: theme.colors.background,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n  },\r\n  serviceItemSelected: {\r\n    backgroundColor: theme.colors.primary,\r\n    borderColor: theme.colors.primary,\r\n  },\r\n  serviceName: {\r\n    fontSize: 14,\r\n    fontWeight: '500',\r\n    color: theme.colors.text,\r\n    marginBottom: 4,\r\n  },\r\n  serviceNameSelected: {\r\n    color: theme.colors.whiteText,\r\n  },\r\n  servicePrice: {\r\n    fontSize: 12,\r\n    color: theme.colors.textSecondary,\r\n  },\r\n  servicePriceSelected: {\r\n    color: theme.colors.whiteText,\r\n  },\r\n  serviceDetails: {\r\n    flex: 1,\r\n    padding: 20,\r\n  },\r\n  detailsScrollView: {\r\n    flex: 1,\r\n  },\r\n  detailsTitle: {\r\n    fontSize: 24,\r\n    fontWeight: '600',\r\n    color: theme.colors.text,\r\n    marginBottom: 20,\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n  },\r\n  detailSection: {\r\n    marginBottom: 20,\r\n  },\r\n  detailLabel: {\r\n    fontSize: 14,\r\n    fontWeight: '600',\r\n    color: theme.colors.text,\r\n    marginBottom: 8,\r\n  },\r\n  detailText: {\r\n    fontSize: 14,\r\n    color: theme.colors.textSecondary,\r\n    lineHeight: 20,\r\n  },\r\n  overnightBadge: {\r\n    backgroundColor: theme.colors.primary,\r\n    color: theme.colors.whiteText,\r\n    paddingHorizontal: 12,\r\n    paddingVertical: 6,\r\n    borderRadius: 16,\r\n    fontSize: 12,\r\n    fontWeight: '500',\r\n    alignSelf: 'flex-start',\r\n  },\r\n  additionalRateItem: {\r\n    paddingVertical: 8,\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: theme.colors.border,\r\n    position: 'relative',\r\n  },\r\n  additionalRateRow: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    justifyContent: 'space-between',\r\n  },\r\n  additionalRateTitleContainer: {\r\n    flexDirection: 'row',\r\n    alignItems: 'flex-start',\r\n    flex: 1,\r\n  },\r\n  additionalRateTitle: {\r\n    fontSize: 14,\r\n    color: theme.colors.text,\r\n    flex: 1,\r\n    marginLeft: 4,\r\n  },\r\n  infoIcon: {\r\n    padding: 2,\r\n    marginTop: -2,\r\n  },\r\n  additionalRatePrice: {\r\n    fontSize: 14,\r\n    fontWeight: '500',\r\n    color: theme.colors.primary,\r\n    marginLeft: 16,\r\n  },\r\n  tooltipModalOverlay: {\r\n    flex: 1,\r\n    backgroundColor: 'rgba(0, 0, 0, 0.5)',\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n  },\r\n  tooltipModalContent: {\r\n    backgroundColor: theme.colors.surface,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n    borderRadius: 12,\r\n    padding: 16,\r\n    margin: 20,\r\n    maxWidth: 300,\r\n    shadowColor: '#000',\r\n    shadowOffset: {\r\n      width: 0,\r\n      height: 4,\r\n    },\r\n    shadowOpacity: 0.2,\r\n    shadowRadius: 8,\r\n    elevation: 10,\r\n  },\r\n  tooltipHeader: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    marginBottom: 12,\r\n  },\r\n  tooltipTitle: {\r\n    fontSize: 16,\r\n    fontWeight: '600',\r\n    color: theme.colors.text,\r\n    flex: 1,\r\n  },\r\n  tooltipCloseButton: {\r\n    padding: 4,\r\n    marginLeft: 8,\r\n  },\r\n  tooltipText: {\r\n    fontSize: 14,\r\n    color: theme.colors.textSecondary,\r\n    lineHeight: 20,\r\n  },\r\n  noSelectionContainer: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n  },\r\n  noSelectionText: {\r\n    color: theme.colors.textSecondary,\r\n    fontSize: 16,\r\n  },\r\n  footer: {\r\n    padding: 20,\r\n    borderTopWidth: 1,\r\n    borderTopColor: theme.colors.border,\r\n  },\r\n  contactButton: {\r\n    backgroundColor: theme.colors.primary,\r\n    paddingVertical: 16,\r\n    borderRadius: 8,\r\n    alignItems: 'center',\r\n  },\r\n  contactButtonDisabled: {\r\n    backgroundColor: theme.colors.placeholder,\r\n    opacity: 0.7,\r\n  },\r\n  contactButtonContent: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n  },\r\n  contactButtonText: {\r\n    color: theme.colors.whiteText,\r\n    fontSize: 16,\r\n    fontWeight: '600',\r\n  },\r\n});\r\n\r\nexport default ProfessionalServicesModal; ","import React, { useState, useEffect, useContext } from 'react';\r\nimport { View, StyleSheet, Platform, Dimensions, TouchableOpacity, Text, useWindowDimensions, SafeAreaView } from 'react-native';\r\nimport SearchRefiner from '../components/SearchRefiner';\r\nimport ProfessionalList from '../components/ProfessionalList';\r\nimport MapView from '../components/MapView';\r\nimport ProfessionalServicesModal from '../components/ProfessionalServicesModal';\r\nimport { theme } from '../styles/theme';\r\n// import { mockProfessionals } from '../data/mockData'; // TODO: Remove mock data after implementing real search\r\nimport MaterialCommunityIcons from '@expo/vector-icons/MaterialCommunityIcons';\r\nimport { AuthContext, debugLog } from '../context/AuthContext';\r\nimport BackHeader from '../components/BackHeader';\r\nimport { searchProfessionals } from '../api/API';\r\n\r\nconst SearchProfessionalsListing = ({ navigation, route }) => {\r\n  const { width: windowWidth } = useWindowDimensions();\r\n  const { screenWidth, isCollapsed } = useContext(AuthContext);\r\n  const [isSingleView, setIsSingleView] = useState(screenWidth <= 1200);\r\n  const [isMobile, setIsMobile] = useState(screenWidth <= 900);\r\n  const [activeView, setActiveView] = useState(isSingleView ? 'filters' : 'all');\r\n  const [professionals, setProfessionals] = useState([]); // Start with empty array\r\n  const [filters, setFilters] = useState({});\r\n  const [isMapMinimized, setIsMapMinimized] = useState(false);\r\n  const [isLeftColumnExpanded, setIsLeftColumnExpanded] = useState(true);\r\n  const [showingSearch, setShowingSearch] = useState(true);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [searchResults, setSearchResults] = useState(null);\r\n  const [currentSearchParams, setCurrentSearchParams] = useState(null);\r\n  const [region, setRegion] = useState({\r\n    latitude: 38.8339,\r\n    longitude: -104.8214,\r\n    latitudeDelta: 0.0922,\r\n    longitudeDelta: 0.0421,\r\n  });\r\n  const [activeFilters, setActiveFilters] = useState({\r\n    categories: ['Dogs', 'Within 5 miles'],\r\n    // Add other filter categories as needed\r\n  });\r\n  const [servicesModalVisible, setServicesModalVisible] = useState(false);\r\n  const [selectedProfessional, setSelectedProfessional] = useState(null);\r\n\r\n  useEffect(() => {\r\n    const updateLayout = () => {\r\n      setIsSingleView(screenWidth <= 1200);\r\n      setIsMobile(screenWidth <= 900);\r\n      setActiveView(screenWidth <= 1200 ? 'filters' : 'all');\r\n    };\r\n    updateLayout();\r\n  }, [screenWidth]);\r\n\r\n  useEffect(() => {\r\n    const unsubscribe = navigation.addListener('focus', () => {\r\n      if (isSingleView) {\r\n        setActiveView('filters');\r\n      }\r\n    });\r\n\r\n    return unsubscribe;\r\n  }, [navigation, isSingleView]);\r\n\r\n  // Load initial professionals when component mounts\r\n  useEffect(() => {\r\n    loadInitialProfessionals();\r\n  }, []);\r\n\r\n  const loadInitialProfessionals = async () => {\r\n    setIsLoading(true);\r\n    try {\r\n      debugLog('MBA9999', 'Loading initial professionals for Colorado Springs');\r\n      \r\n      // Load first 20 professionals in Colorado Springs area with no filters\r\n      const searchParams = {\r\n        animal_types: [],\r\n        location: 'Colorado Springs, Colorado',\r\n        service_query: '',\r\n        overnight_service: false,\r\n        price_min: 0,\r\n        price_max: 999999,\r\n        radius_miles: 30,\r\n        page: 1,\r\n        page_size: 20\r\n      };\r\n      \r\n      const results = await searchProfessionals(searchParams);\r\n      \r\n      debugLog('MBA9999', 'Initial professionals loaded:', results);\r\n      setSearchResults(results);\r\n      setProfessionals(results.professionals || []);\r\n      setCurrentSearchParams(searchParams);\r\n      \r\n    } catch (error) {\r\n      debugLog('MBA9999', 'Error loading initial professionals:', error);\r\n      console.error('Error loading initial professionals:', error);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleSearchResults = (results, searchParams = null) => {\r\n    debugLog('MBA9999', 'Received search results:', results);\r\n    setSearchResults(results);\r\n    setProfessionals(results.professionals || []);\r\n    if (searchParams) {\r\n      setCurrentSearchParams(searchParams);\r\n    }\r\n  };\r\n\r\n  const handleFiltersChange = (newFilters) => {\r\n    setFilters(newFilters);\r\n    // Implement filtering logic here\r\n  };\r\n\r\n  const handleLoadMore = () => {\r\n    // Implement pagination logic\r\n  };\r\n\r\n  const handleProfessionalSelect = (professional) => {\r\n    // Instead of navigating to profile, show services modal\r\n    setSelectedProfessional(professional);\r\n    setServicesModalVisible(true);\r\n  };\r\n\r\n  const handleShowServicesModal = (professional) => {\r\n    setSelectedProfessional(professional);\r\n    setServicesModalVisible(true);\r\n  };\r\n\r\n  const handleCloseServicesModal = () => {\r\n    setServicesModalVisible(false);\r\n    setSelectedProfessional(null);\r\n  };\r\n\r\n  const toggleMapSize = () => {\r\n    setIsMapMinimized(!isMapMinimized);\r\n  };\r\n\r\n  const handleShowProfessionals = (view) => {\r\n    setShowingSearch(false);\r\n    if (isSingleView) {\r\n      if (view === 'map') {\r\n        setActiveView('map');\r\n      } else {\r\n        setActiveView('list');\r\n      }\r\n    }\r\n  };\r\n\r\n  const toggleLeftColumn = () => {\r\n    setIsLeftColumnExpanded(!isLeftColumnExpanded);\r\n    // If we're expanding the left column, make sure the map is minimized\r\n    if (!isLeftColumnExpanded) {\r\n      setIsMapMinimized(true);\r\n    }\r\n  };\r\n\r\n  const createStyles = (screenWidth, isCollapsed) => StyleSheet.create({\r\n    mainContainer: {\r\n      flex: 1,\r\n      backgroundColor: theme.colors.background,\r\n      position: 'fixed',\r\n      top: 0,\r\n      left: 0,\r\n      right: 0,\r\n      bottom: 0,\r\n      marginLeft: screenWidth > 900 ? (isCollapsed ? 70 : 250) : 0,\r\n      transition: 'margin-left 0.3s ease',\r\n    },\r\n    container: {\r\n      flex: 1,\r\n      display: 'flex',\r\n      flexDirection: 'column',\r\n      height: '100vh',\r\n      overflow: 'hidden',\r\n    },\r\n    content: {\r\n      flex: 1,\r\n      flexDirection: 'row',\r\n      height: isMobile ? '100%' : 'calc(100vh - 64px)',\r\n      overflow: 'hidden',\r\n    },\r\n    leftColumn: {\r\n      height: '100%',\r\n      borderRightWidth: 1,\r\n      borderRightColor: theme.colors.border,\r\n      backgroundColor: theme.colors.background,\r\n      transition: 'width 0.3s ease',\r\n      position: 'relative',\r\n      zIndex: 1,\r\n    },\r\n    leftColumnToggle: {\r\n      position: 'absolute',\r\n      top: '50%',\r\n      right: -16,\r\n      transform: [{ translateY: -20 }],\r\n      zIndex: 2000,\r\n      backgroundColor: theme.colors.surface,\r\n      padding: theme.spacing.small,\r\n      borderRadius: 20,\r\n      shadowColor: \"#000\",\r\n      shadowOffset: {\r\n        width: 0,\r\n        height: 2,\r\n      },\r\n      shadowOpacity: 0.1,\r\n      shadowRadius: 3,\r\n      elevation: 3,\r\n      width: 32,\r\n      height: 32,\r\n      alignItems: 'center',\r\n      justifyContent: 'center',\r\n      borderWidth: 1,\r\n      borderColor: theme.colors.border,\r\n    },\r\n    mapColumn: {\r\n      flex: 1,\r\n      backgroundColor: theme.colors.background,\r\n      height: '100%',\r\n      transition: 'width 0.3s ease',\r\n      position: 'relative',\r\n      zIndex: 0,\r\n    },\r\n    toggleButton: {\r\n      position: 'absolute',\r\n      top: theme.spacing.medium,\r\n      right: theme.spacing.medium,\r\n      zIndex: 1000,\r\n      backgroundColor: theme.colors.surface,\r\n      padding: theme.spacing.small,\r\n      borderRadius: 8,\r\n      shadowColor: \"#000\",\r\n      shadowOffset: {\r\n        width: 0,\r\n        height: 2,\r\n      },\r\n      shadowOpacity: 0.1,\r\n      shadowRadius: 3,\r\n      elevation: 3,\r\n    },\r\n    toggleButtonText: {\r\n      color: theme.colors.primary,\r\n      fontSize: theme.fontSizes.medium,\r\n      fontFamily: theme.fonts.regular.fontFamily,\r\n      fontWeight: '500',\r\n    },\r\n    containerMobile: {\r\n      flex: 1,\r\n      backgroundColor: theme.colors.background,\r\n      height: '100%',\r\n      overflow: 'hidden',\r\n    },\r\n    mobileHeader: {\r\n      flexDirection: 'row',\r\n      justifyContent: 'space-between',\r\n      alignItems: 'center',\r\n      borderBottomWidth: 2,\r\n      padding: 10,\r\n      marginHorizontal: 10,\r\n      backgroundColor: theme.colors.background,\r\n    },\r\n    mobileHeaderText: {\r\n      fontSize: theme.fontSizes.large,\r\n      fontWeight: '500',\r\n      fontFamily: theme.fonts.header.fontFamily,\r\n    },\r\n    \r\n    headerIcon: {\r\n      padding: 8,\r\n      marginLeft: 16,\r\n    },\r\n    searchButton: {\r\n      backgroundColor: theme.colors.primary,\r\n      padding: 10,\r\n      alignItems: 'center',\r\n      borderRadius: 5,\r\n      margin: 10,\r\n    },\r\n    searchButtonText: {\r\n      color: theme.colors.whiteText,\r\n      fontSize: theme.fontSizes.medium + 2,\r\n      fontFamily: theme.fonts.regular.fontFamily,\r\n    },\r\n    mapToggleButton: {\r\n      position: 'absolute',\r\n      top: theme.spacing.medium,\r\n      right: theme.spacing.medium,\r\n      zIndex: 1000,\r\n      backgroundColor: theme.colors.surface,\r\n      padding: theme.spacing.small,\r\n      borderRadius: 8,\r\n      shadowColor: \"#000\",\r\n      shadowOffset: {\r\n        width: 0,\r\n        height: 2,\r\n      },\r\n      shadowOpacity: 0.1,\r\n      shadowRadius: 3,\r\n      elevation: 3,\r\n    },\r\n  });\r\n\r\n  const styles = createStyles(screenWidth, isCollapsed);\r\n\r\n  const renderContent = () => {\r\n    if (!isSingleView) {\r\n      const leftColumnWidth = isLeftColumnExpanded ? '50%' : '33.333%';\r\n      const mapColumnWidth = isMapMinimized ? '50%' : '66.666%';\r\n\r\n      return (\r\n        <>\r\n          <View style={[styles.leftColumn, { width: leftColumnWidth }]}>\r\n            <TouchableOpacity \r\n              style={[styles.toggleButton, styles.leftColumnToggle]} \r\n              onPress={toggleLeftColumn}\r\n            >\r\n              <MaterialCommunityIcons \r\n                name={isLeftColumnExpanded ? \"chevron-left\" : \"chevron-right\"} \r\n                size={24} \r\n                color={theme.colors.primary} \r\n              />\r\n            </TouchableOpacity>\r\n            {showingSearch ? (\r\n              <SearchRefiner \r\n                onFiltersChange={handleFiltersChange}\r\n                onShowProfessionals={handleShowProfessionals}\r\n                onSearchResults={handleSearchResults}\r\n                initialFilters={currentSearchParams}\r\n              />\r\n            ) : (\r\n            <ProfessionalList\r\n              professionals={professionals}\r\n              onLoadMore={handleLoadMore}\r\n              onProfessionalSelect={handleProfessionalSelect}\r\n              isMobile={isMobile}\r\n              filters={activeFilters}\r\n              searchParams={currentSearchParams}\r\n              onFilterPress={(view) => {\r\n                if (view === 'map') {\r\n                  setActiveView('map');\r\n                } else {\r\n                  setShowingSearch(true);\r\n                }\r\n              }}\r\n            />\r\n            )}\r\n          </View>\r\n          <View style={[styles.mapColumn, { width: mapColumnWidth }]}>\r\n            <TouchableOpacity \r\n              style={[styles.toggleButton, styles.mapToggleButton]} \r\n              onPress={toggleMapSize}\r\n            >\r\n              <MaterialCommunityIcons \r\n                name={isMapMinimized ? \"arrow-expand\" : \"arrow-collapse\"} \r\n                size={24} \r\n                color={theme.colors.primary} \r\n              />\r\n            </TouchableOpacity>\r\n            <MapView\r\n              professionals={professionals}\r\n              onMarkerPress={handleProfessionalSelect}\r\n              onShowServicesModal={handleShowServicesModal}\r\n              region={region}\r\n              isMobile={isMobile}\r\n            />\r\n          </View>\r\n        </>\r\n      );\r\n    }\r\n\r\n    // Single view (below 1200px)\r\n    return (\r\n      <View style={styles.containerMobile}>\r\n        {activeView === 'filters' && (\r\n          <>\r\n            <SearchRefiner \r\n              onFiltersChange={handleFiltersChange} \r\n              onShowProfessionals={handleShowProfessionals}\r\n              onSearchResults={handleSearchResults}\r\n              isMobile={isSingleView}\r\n              initialFilters={currentSearchParams}\r\n            />\r\n          </>\r\n        )}\r\n        \r\n        {activeView === 'list' && (\r\n          <>\r\n            <ProfessionalList\r\n              professionals={professionals}\r\n              onLoadMore={handleLoadMore}\r\n              onProfessionalSelect={handleProfessionalSelect}\r\n              isMobile={isSingleView}\r\n              filters={activeFilters}\r\n              searchParams={currentSearchParams}\r\n              onFilterPress={(view) => {\r\n                if (view === 'map') {\r\n                  setActiveView('map');\r\n                } else {\r\n                  setActiveView('filters');\r\n                }\r\n              }}\r\n            />\r\n          </>\r\n        )}\r\n        \r\n        {activeView === 'map' && (\r\n          <>\r\n            <View style={styles.mobileHeader}>\r\n              <TouchableOpacity onPress={() => setActiveView('list')}>\r\n                <MaterialCommunityIcons name=\"arrow-left\" size={24} color={theme.colors.primary} />\r\n              </TouchableOpacity>\r\n            </View>\r\n            <MapView\r\n              professionals={professionals}\r\n              onMarkerPress={handleProfessionalSelect}\r\n              onShowServicesModal={handleShowServicesModal}\r\n              region={region}\r\n              isMobile={isSingleView}\r\n            />\r\n          </>\r\n        )}\r\n      </View>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <View style={styles.mainContainer}>\r\n      <SafeAreaView style={styles.container}>\r\n        <View style={styles.content}>\r\n          {renderContent()}\r\n        </View>\r\n      </SafeAreaView>\r\n      \r\n      {/* Professional Services Modal */}\r\n      <ProfessionalServicesModal\r\n        visible={servicesModalVisible}\r\n        onClose={handleCloseServicesModal}\r\n        professional={selectedProfessional}\r\n        primaryService={selectedProfessional?.primary_service}\r\n      />\r\n    </View>\r\n  );\r\n};\r\n\r\nexport default SearchProfessionalsListing;\r\n\r\n","import React, { useState, useEffect, useContext } from 'react';\r\nimport { View, Text, StyleSheet, TextInput, FlatList, TouchableOpacity, ActivityIndicator, Platform, Dimensions, ScrollView } from 'react-native';\r\nimport { useNavigation } from '@react-navigation/native';\r\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\r\nimport { theme } from '../styles/theme';\r\nimport BackHeader from '../components/BackHeader';\r\nimport BookingCard from '../components/BookingCard';\r\nimport { AuthContext } from '../context/AuthContext';\r\nimport AsyncStorage from '@react-native-async-storage/async-storage';\r\nimport axios from 'axios';\r\nimport { handleBack, navigateToFrom } from '../components/Navigation';\r\nimport { API_BASE_URL } from '../config/config';\r\nimport { supportsHover } from '../utils/deviceUtils';\r\n\r\nconst MyBookings = () => {\r\n  const navigation = useNavigation();\r\n  const { isApprovedProfessional, userRole, is_DEBUG, isCollapsed, screenWidth } = useContext(AuthContext);\r\n  const [isMobile, setIsMobile] = useState(screenWidth < 900);\r\n  const [isWideScreen, setIsWideScreen] = useState(screenWidth >= 1200);\r\n  const [activeTab, setActiveTab] = useState(userRole === 'professional' ? 'professional' : 'owner');\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const [bookings, setBookings] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  const [page, setPage] = useState(1);\r\n  const [hasMore, setHasMore] = useState(true);\r\n  const [isLoadingMore, setIsLoadingMore] = useState(false);\r\n  const [activeFilter, setActiveFilter] = useState('all');\r\n  const [hoveredFilter, setHoveredFilter] = useState(null);\r\n  \r\n  // Check if device supports hover\r\n  const deviceSupportsHover = supportsHover();\r\n\r\n  useEffect(() => {\r\n    const updateLayout = () => {\r\n      setIsMobile(Dimensions.get('window').width < 900);\r\n      setIsWideScreen(Dimensions.get('window').width >= 1200);\r\n    };\r\n\r\n    const subscription = Dimensions.addEventListener('change', updateLayout);\r\n    return () => {\r\n      subscription?.remove();\r\n    };\r\n  }, []);\r\n\r\n  // Handle role changes\r\n  useEffect(() => {\r\n    if (userRole === 'professional' && isApprovedProfessional) {\r\n      setActiveTab('professional');\r\n    }\r\n  }, [userRole, isApprovedProfessional]);\r\n\r\n  const fetchBookings = async (pageNum = 1, isLoadMore = false) => {\r\n    if (isLoadMore) {\r\n      setIsLoadingMore(true);\r\n    } else {\r\n      setLoading(true);\r\n      setError(null);\r\n    }\r\n\r\n    try {\r\n      let token = Platform.OS === 'web' ? sessionStorage.getItem('userToken') : await AsyncStorage.getItem('userToken');\r\n      if (!token) {\r\n        throw new Error('No authentication token found');\r\n      }\r\n\r\n      if (is_DEBUG) {\r\n        console.log('MBA1234 Fetching bookings:', {\r\n          isApprovedProfessional,\r\n          userRole,\r\n          activeTab,\r\n          page: pageNum,\r\n          status: activeFilter\r\n        });\r\n      }\r\n\r\n      const response = await axios.get(\r\n        `${API_BASE_URL}/api/bookings/v1/`,\r\n        { \r\n          headers: { Authorization: `Bearer ${token}` },\r\n          params: {\r\n            page: pageNum,\r\n            page_size: 20,\r\n            status: activeFilter\r\n          }\r\n        }\r\n      );\r\n\r\n      const newBookings = activeTab === 'professional' \r\n        ? response.data.bookings.professional_bookings || []\r\n        : response.data.bookings.owner_bookings || [];\r\n\r\n      if (isLoadMore) {\r\n        setBookings(prev => [...prev, ...newBookings]);\r\n      } else {\r\n        setBookings(newBookings);\r\n      }\r\n\r\n      setHasMore(newBookings.length === 20);\r\n      setPage(pageNum);\r\n    } catch (error) {\r\n      console.error('Error fetching bookings:', error);\r\n      setError('Failed to fetch bookings');\r\n    } finally {\r\n      setLoading(false);\r\n      setIsLoadingMore(false);\r\n    }\r\n  };\r\n\r\n  // Fetch bookings when component mounts or when dependencies change\r\n  useEffect(() => {\r\n    if (is_DEBUG) {\r\n      console.log('MBA1234 Fetching bookings due to dependency change:', {\r\n        activeTab,\r\n        userRole,\r\n        isApprovedProfessional,\r\n        activeFilter\r\n      });\r\n    }\r\n    setPage(1);\r\n    setBookings([]);\r\n    fetchBookings(1);\r\n  }, [activeTab, userRole, isApprovedProfessional, activeFilter]);\r\n\r\n  // Handle search\r\n  const handleSearch = (query) => {\r\n    setSearchQuery(query);\r\n    \r\n    if (!query.trim()) {\r\n      setPage(1);\r\n      setBookings([]);\r\n      fetchBookings(1);\r\n      return;\r\n    }\r\n\r\n    const searchLower = query.toLowerCase();\r\n    const filtered = bookings.filter(booking => {\r\n      if (activeTab === 'professional') {\r\n        return (\r\n          booking.id.toLowerCase().includes(searchLower) ||\r\n          booking.ownerName.toLowerCase().includes(searchLower)\r\n        );\r\n      } else {\r\n        return (\r\n          booking.id.toLowerCase().includes(searchLower) ||\r\n          booking.professionalName.toLowerCase().includes(searchLower)\r\n        );\r\n      }\r\n    });\r\n\r\n    setBookings(filtered);\r\n  };\r\n\r\n  const handleLoadMore = () => {\r\n    if (!isLoadingMore && hasMore) {\r\n      fetchBookings(page + 1, true);\r\n    }\r\n  };\r\n\r\n  const handleViewDetails = async (booking) => {\r\n    if (is_DEBUG) {\r\n      console.log('MBA1234 Navigating to booking details:', {\r\n        bookingId: booking.booking_id || booking.id,\r\n        isProfessional: activeTab === 'professional'\r\n      });\r\n    }\r\n    \r\n    await navigateToFrom(navigation, 'BookingDetails', 'MyBookings', {\r\n      bookingId: booking.booking_id || booking.id,\r\n      isProfessional: activeTab === 'professional'\r\n    });\r\n  };\r\n\r\n  const handleCancelBooking = async (bookingId) => {\r\n    if (is_DEBUG) {\r\n      console.log('MBA1234 Cancel booking:', bookingId);\r\n    }\r\n  };\r\n\r\n  const renderBookingCard = ({ item }) => (\r\n    <BookingCard\r\n      booking={{\r\n        id: item.booking_id || item.id,\r\n        ownerName: item.owner_name || item.ownerName,\r\n        professionalName: item.professional_name || item.professionalName,\r\n        serviceName: item.service_type || item.serviceName,\r\n        date: item.start_date || item.date,\r\n        time: item.start_time || item.time,\r\n        status: item.status\r\n      }}\r\n      type={activeTab}\r\n      onViewDetails={() => handleViewDetails(item)}\r\n      onCancel={() => handleCancelBooking(item.booking_id || item.id)}\r\n    />\r\n  );\r\n\r\n  const EmptyStateMessage = () => (\r\n    <View style={styles.emptyStateContainer}>\r\n      <MaterialCommunityIcons \r\n        name={error ? \"alert-circle-outline\" : \"calendar-blank-outline\"} \r\n        size={64} \r\n        color={error ? theme.colors.error : theme.colors.primary} \r\n      />\r\n      <Text style={styles.emptyStateTitle}>\r\n        {error ? 'Error Getting Bookings' : 'No Bookings Found'}\r\n      </Text>\r\n      <Text style={styles.emptyStateSubtitle}>\r\n        {error \r\n          ? 'There was an error fetching your bookings. Please try again later.' \r\n          : activeTab === 'professional' \r\n            ? isApprovedProfessional \r\n              ? 'Create a service to start receiving bookings'\r\n              : 'Apply to become a professional to start receiving bookings'\r\n            : 'Browse available services to make your first booking'\r\n        }\r\n      </Text>\r\n      {!error && (\r\n        <TouchableOpacity\r\n          style={styles.createServiceButton}\r\n          onPress={() => navigation.navigate(\r\n            activeTab === 'professional'\r\n              ? isApprovedProfessional\r\n                ? 'ServiceManager'\r\n                : 'BecomeProfessional'\r\n              : 'SearchProfessionalsListing'\r\n          )}\r\n        >\r\n          <Text style={styles.createServiceButtonText}>\r\n            {activeTab === 'professional'\r\n              ? isApprovedProfessional\r\n                ? 'Create Service'\r\n                : 'Become Professional'\r\n              : 'Browse Services'\r\n            }\r\n          </Text>\r\n        </TouchableOpacity>\r\n      )}\r\n      {error && (\r\n        <TouchableOpacity\r\n          style={styles.retryButton}\r\n          onPress={() => fetchBookings(1)}\r\n        >\r\n          <Text style={styles.retryButtonText}>Retry</Text>\r\n        </TouchableOpacity>\r\n      )}\r\n    </View>\r\n  );\r\n\r\n  const renderFooter = () => {\r\n    if (!isLoadingMore) return null;\r\n    return (\r\n      <View style={styles.loadingMoreContainer}>\r\n        <ActivityIndicator size=\"small\" color={theme.colors.primary} />\r\n      </View>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <View style={[\r\n      styles.container,\r\n      { marginLeft: isMobile ? 0 : (isCollapsed ? 70 : 250) }\r\n    ]}>\r\n      <View style={[styles.content, { marginTop: isMobile ? 60 : 0 }]}>\r\n        <View style={styles.mainContent}>\r\n          <View style={styles.headerSection}>\r\n            <Text style={styles.title}>My Bookings</Text>\r\n            {isApprovedProfessional && (\r\n              <View style={styles.tabContainer}>\r\n                <TouchableOpacity\r\n                  style={[styles.tab, activeTab === 'professional' && styles.activeTab]}\r\n                  onPress={() => setActiveTab('professional')}\r\n                >\r\n                  <Text style={[styles.tabText, activeTab === 'professional' && styles.activeTabText]}>\r\n                    Your Bookings\r\n                  </Text>\r\n                </TouchableOpacity>\r\n                <TouchableOpacity\r\n                  style={[styles.tab, activeTab === 'owner' && styles.activeTab]}\r\n                  onPress={() => setActiveTab('owner')}\r\n                >\r\n                  <Text style={[styles.tabText, activeTab === 'owner' && styles.activeTabText]}>\r\n                    Owner Bookings\r\n                  </Text>\r\n                </TouchableOpacity>\r\n              </View>\r\n            )}\r\n          </View>\r\n          <View style={styles.bookingsContent}>\r\n            {loading ? (\r\n              <View style={styles.loadingContainer}>\r\n                <ActivityIndicator size=\"large\" color={theme.colors.primary} />\r\n              </View>\r\n            ) : bookings.length > 0 ? (\r\n              <View style={styles.bookingsContent}>\r\n                <View style={styles.stickyHeader}>\r\n                  <View style={[styles.stickyHeaderContent, { \r\n                    flexDirection: isWideScreen ? 'row' : 'column'\r\n                  }]}>\r\n                    <View style={[\r\n                      styles.searchContainer, \r\n                      isWideScreen ? { flex: 0.4, marginRight: 'auto' } : null\r\n                    ]}>\r\n                      <MaterialCommunityIcons name=\"magnify\" size={24} color={theme.colors.mybookings.searchBar} />\r\n                      <TextInput\r\n                        style={[styles.searchInput, { color: theme.colors.mybookings.searchBar, width: '100%', height: '100%' }]}\r\n                        placeholder=\"Search by pet name, owner, or date\"\r\n                        value={searchQuery}\r\n                        onChangeText={handleSearch}\r\n                        outlineStyle=\"none\"\r\n                      />\r\n                    </View>\r\n\r\n                    <View style={[\r\n                      styles.filtersWrapper,\r\n                      isWideScreen ? { flex: 0.6, alignItems: 'flex-end' } : null\r\n                    ]}>\r\n                      <ScrollView \r\n                        horizontal \r\n                        showsHorizontalScrollIndicator={false}\r\n                        contentContainerStyle={styles.filterScrollContent}\r\n                      >\r\n                        <View style={styles.filterContainer}>\r\n                          <TouchableOpacity \r\n                            style={[\r\n                              styles.filterButton,\r\n                              styles.allButton,\r\n                              deviceSupportsHover && hoveredFilter === 'all' && styles.filterButtonHovered\r\n                            ]}\r\n                            onPress={() => setActiveFilter('all')}\r\n                            onMouseEnter={() => deviceSupportsHover && setHoveredFilter('all')}\r\n                            onMouseLeave={() => deviceSupportsHover && setHoveredFilter(null)}\r\n                          >\r\n                            <View style={styles.filterContent}>\r\n                              <MaterialCommunityIcons \r\n                                name=\"filter-variant\" \r\n                                size={16} \r\n                                color=\"#0784C6\" \r\n                              />\r\n                              <Text style={[styles.filterText, styles.allButtonText]}>\r\n                                All\r\n                              </Text>\r\n                              {activeFilter === 'all' && (\r\n                                <MaterialCommunityIcons \r\n                                  name=\"check\" \r\n                                  size={16} \r\n                                  color=\"#0784C6\" \r\n                                  style={styles.checkmark}\r\n                                />\r\n                              )}\r\n                            </View>\r\n                          </TouchableOpacity>\r\n                          <TouchableOpacity \r\n                            style={[\r\n                              styles.filterButton,\r\n                              styles.pendingButton,\r\n                              deviceSupportsHover && hoveredFilter === 'pending' && styles.filterButtonHovered\r\n                            ]}\r\n                            onPress={() => setActiveFilter('pending')}\r\n                            onMouseEnter={() => deviceSupportsHover && setHoveredFilter('pending')}\r\n                            onMouseLeave={() => deviceSupportsHover && setHoveredFilter(null)}\r\n                          >\r\n                            <View style={styles.filterContent}>\r\n                              <MaterialCommunityIcons \r\n                                name=\"clock-outline\" \r\n                                size={16} \r\n                                color={theme.colors.mybookings.secondary}\r\n                              />\r\n                              <Text style={[styles.filterText, styles.pendingButtonText]}>\r\n                                Pending\r\n                              </Text>\r\n                              {activeFilter === 'pending' && (\r\n                                <MaterialCommunityIcons \r\n                                  name=\"check\" \r\n                                  size={16} \r\n                                  color={theme.colors.mybookings.secondary}\r\n                                  style={styles.checkmark}\r\n                                />\r\n                              )}\r\n                            </View>\r\n                          </TouchableOpacity>\r\n                          <TouchableOpacity \r\n                            style={[\r\n                              styles.filterButton,\r\n                              styles.confirmedButton,\r\n                              deviceSupportsHover && hoveredFilter === 'confirmed' && styles.filterButtonHovered\r\n                            ]}\r\n                            onPress={() => setActiveFilter('confirmed')}\r\n                            onMouseEnter={() => deviceSupportsHover && setHoveredFilter('confirmed')}\r\n                            onMouseLeave={() => deviceSupportsHover && setHoveredFilter(null)}\r\n                          >\r\n                            <View style={styles.filterContent}>\r\n                              <MaterialCommunityIcons \r\n                                name=\"check-circle-outline\" \r\n                                size={16} \r\n                                color=\"#898974\"\r\n                              />\r\n                              <Text style={[styles.filterText, styles.confirmedButtonText]}>\r\n                                Confirmed\r\n                              </Text>\r\n                              {activeFilter === 'confirmed' && (\r\n                                <MaterialCommunityIcons \r\n                                  name=\"check\" \r\n                                  size={16} \r\n                                  color=\"#898974\"\r\n                                  style={styles.checkmark}\r\n                                />\r\n                              )}\r\n                            </View>\r\n                          </TouchableOpacity>\r\n                          <TouchableOpacity \r\n                            style={[\r\n                              styles.filterButton,\r\n                              styles.completedButton,\r\n                              deviceSupportsHover && hoveredFilter === 'completed' && styles.filterButtonHovered\r\n                            ]}\r\n                            onPress={() => setActiveFilter('completed')}\r\n                            onMouseEnter={() => deviceSupportsHover && setHoveredFilter('completed')}\r\n                            onMouseLeave={() => deviceSupportsHover && setHoveredFilter(null)}\r\n                          >\r\n                            <View style={styles.filterContent}>\r\n                              <MaterialCommunityIcons \r\n                                name=\"flag-checkered\" \r\n                                size={16} \r\n                                color={theme.colors.mybookings.completedText}\r\n                              />\r\n                              <Text style={[styles.filterText, styles.completedButtonText]}>\r\n                                Completed\r\n                              </Text>\r\n                              {activeFilter === 'completed' && (\r\n                                <MaterialCommunityIcons \r\n                                  name=\"check\" \r\n                                  size={16} \r\n                                  color={theme.colors.mybookings.completedText}\r\n                                  style={styles.checkmark}\r\n                                />\r\n                              )}\r\n                            </View>\r\n                          </TouchableOpacity>\r\n                        </View>\r\n                      </ScrollView>\r\n                    </View>\r\n                  </View>\r\n                </View>\r\n\r\n                <FlatList\r\n                  data={bookings}\r\n                  renderItem={renderBookingCard}\r\n                  keyExtractor={item => (item.booking_id || item.id || Math.random().toString()).toString()}\r\n                  contentContainerStyle={styles.listContainer}\r\n                  onEndReached={handleLoadMore}\r\n                  onEndReachedThreshold={0.5}\r\n                  ListFooterComponent={renderFooter}\r\n                  ListHeaderComponent={<View style={[styles.listHeaderSpacing, { height: isWideScreen ? 130 : 190 }]} />}\r\n                />\r\n              </View>\r\n            ) : (\r\n              <EmptyStateMessage />\r\n            )}\r\n          </View>\r\n        </View>\r\n      </View>\r\n    </View>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    height: '100vh',\r\n    backgroundColor: theme.colors.surface,\r\n    position: 'fixed',\r\n    top: 0,\r\n    right: 0,\r\n    bottom: 0,\r\n    left: 0,\r\n    overflow: 'hidden',\r\n    transition: 'margin-left 0.3s ease',\r\n  },\r\n  content: {\r\n    flex: 1,\r\n    height: '100%',\r\n    overflow: 'auto',\r\n  },\r\n  mainContent: {\r\n    flex: 1,\r\n    width: '100%',\r\n    alignSelf: 'center',\r\n    backgroundColor: theme.colors.background,\r\n  },\r\n  headerSection: {\r\n    width: '100%',\r\n    backgroundColor: theme.colors.surfaceContrast,\r\n    paddingHorizontal: 24,\r\n    paddingTop: 24,\r\n    zIndex: 2,\r\n  },\r\n  bookingsContent: {\r\n    flex: 1,\r\n    backgroundColor: theme.colors.surface,\r\n    position: 'relative',\r\n  },\r\n  title: {\r\n    fontSize: 32,\r\n    fontWeight: '600',\r\n    color: theme.colors.text,\r\n    marginBottom: 24,\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n  },\r\n  tabContainer: {\r\n    flexDirection: 'row',\r\n    gap: 32,\r\n  },\r\n  tab: {\r\n    paddingBottom: 8,\r\n    borderBottomWidth: 2,\r\n    borderBottomColor: 'transparent',\r\n  },\r\n  activeTab: {\r\n    borderBottomColor: theme.colors.primary,\r\n  },\r\n  tabText: {\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  activeTabText: {\r\n    color: theme.colors.primary,\r\n    fontWeight: '500',\r\n  },\r\n  stickyHeader: {\r\n    position: 'absolute',\r\n    top: 0,\r\n    left: 0,\r\n    right: 0,\r\n    backgroundColor: theme.colors.surfaceContrast,\r\n    zIndex: 2,\r\n    marginHorizontal: 24,\r\n    marginTop: 24,\r\n    shadowColor: '#000',\r\n    shadowOffset: { width: 0, height: 2 },\r\n    shadowOpacity: 0.1,\r\n    shadowRadius: 4,\r\n    borderRadius: 8,\r\n    padding: 16,\r\n  },\r\n  stickyHeaderContent: {\r\n    width: '100%',\r\n    gap: 16,\r\n  },\r\n  searchContainer: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    backgroundColor: theme.colors.surfaceContrast,\r\n    borderRadius: 8,\r\n    padding: 12,\r\n    borderWidth: 1,\r\n    borderColor: '#CCCBC9', // #CCCBC9\r\n  },\r\n  filterScrollContent: {\r\n    flexGrow: 0,\r\n  },\r\n  filtersWrapper: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'flex-end',\r\n    marginRight: -16,\r\n  },\r\n  filterContainer: {\r\n    flexDirection: 'row',\r\n    gap: 8,\r\n    backgroundColor: theme.colors.surfaceContrast,\r\n    paddingVertical: 8,\r\n    paddingLeft: 4,\r\n    paddingRight: 16,\r\n  },\r\n  filterButton: {\r\n    paddingHorizontal: 12,\r\n    paddingVertical: 6,\r\n    borderRadius: 16,\r\n    justifyContent: 'center',\r\n    ...(Platform.OS === 'web' && {\r\n      transition: 'all 0.2s ease-in-out',\r\n      cursor: 'pointer',\r\n    })\r\n  },\r\n  filterButtonHovered: {\r\n    transform: [{ scale: 1.05 }],\r\n    shadowColor: '#000',\r\n    shadowOffset: {\r\n      width: 0,\r\n      height: 2,\r\n    },\r\n    shadowOpacity: 0.1,\r\n    shadowRadius: 4,\r\n    elevation: 5,\r\n  },\r\n  filterContent: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    gap: 6,\r\n  },\r\n  checkmark: {\r\n    marginLeft: 4,\r\n  },\r\n  allButton: {\r\n    backgroundColor: '#EFF9FF', // #EFF9FF\r\n  },\r\n  allButtonText: {\r\n    color: '#0784C6', // #0784C6\r\n  },\r\n  pendingButton: {\r\n    backgroundColor: theme.colors.mybookings.main,\r\n  },\r\n  pendingButtonText: {\r\n    color: theme.colors.mybookings.secondary,\r\n  },\r\n  confirmedButton: {\r\n    backgroundColor: '#E8E9E2', // #E8E9E2\r\n  },\r\n  confirmedButtonText: {\r\n    color: '#898974', // #898974\r\n  },\r\n  completedButton: {\r\n    backgroundColor: '#F5F5F4', // #F5F5F4\r\n  },\r\n  completedButtonText: {\r\n    color: theme.colors.mybookings.completedText,\r\n  },\r\n  filterText: {\r\n    fontSize: 14,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    textAlign: 'center',\r\n  },\r\n  listHeaderSpacing: {\r\n    paddingTop: 16,\r\n  },\r\n  listContainer: {\r\n    paddingHorizontal: 24,\r\n    paddingBottom: 34,\r\n  },\r\n  loadingContainer: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n  },\r\n  loadingMoreContainer: {\r\n    paddingVertical: 16,\r\n    alignItems: 'center',\r\n  },\r\n  emptyStateContainer: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    paddingHorizontal: 24,\r\n  },\r\n  emptyStateTitle: {\r\n    fontSize: theme.fontSizes.large,\r\n    fontWeight: '600',\r\n    color: theme.colors.text,\r\n    marginTop: 16,\r\n    textAlign: 'center',\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n  },\r\n  emptyStateSubtitle: {\r\n    fontSize: 16,\r\n    color: theme.colors.placeholder,\r\n    textAlign: 'center',\r\n    marginTop: 8,\r\n    marginBottom: 24,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  createServiceButton: {\r\n    backgroundColor: theme.colors.primary,\r\n    paddingHorizontal: 24,\r\n    paddingVertical: 12,\r\n    borderRadius: 8,\r\n    marginTop: 8,\r\n  },\r\n  createServiceButtonText: {\r\n    color: theme.colors.surface,\r\n    fontSize: 16,\r\n    fontWeight: '600',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  retryButton: {\r\n    backgroundColor: theme.colors.error,\r\n    paddingHorizontal: 24,\r\n    paddingVertical: 12,\r\n    borderRadius: 8,\r\n    marginTop: 8,\r\n  },\r\n  retryButtonText: {\r\n    color: theme.colors.surface,\r\n    fontSize: 16,\r\n    fontWeight: '600',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  searchInput: {\r\n    outlineStyle: 'none',\r\n    outlineWidth: 0,\r\n    outline: 'none',\r\n    marginLeft: 8,\r\n  },\r\n});\r\n\r\nexport default MyBookings;","import React, { useState, useEffect, useContext, useCallback } from 'react';\r\nimport { View, StyleSheet, ActivityIndicator, Platform, Dimensions } from 'react-native';\r\nimport { useNavigation, useFocusEffect } from '@react-navigation/native';\r\nimport ServiceManager from '../components/ServiceManager';\r\nimport { theme } from '../styles/theme';\r\nimport BackHeader from '../components/BackHeader';\r\nimport { handleBack } from '../components/Navigation';\r\nimport AsyncStorage from '@react-native-async-storage/async-storage';\r\nimport { getProfessionalServices } from '../api/API';\r\nimport { AuthContext, debugLog } from '../context/AuthContext';\r\nimport { useToast } from '../components/ToastProvider';\r\n\r\nconst ServiceManagerScreen = () => {\r\n  const navigation = useNavigation();\r\n  const [services, setServices] = useState([]);\r\n  const [hasUnsavedChanges, setHasUnsavedChanges] = useState(false);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [isMobile, setIsMobile] = useState(Dimensions.get('window').width < 900);\r\n  const { isCollapsed, is_DEBUG, isSignedIn, userRole } = useContext(AuthContext);\r\n  const showToast = useToast();\r\n\r\n  useEffect(() => {\r\n    const updateLayout = () => {\r\n      setIsMobile(Dimensions.get('window').width < 900);\r\n    };\r\n\r\n    const subscription = Dimensions.addEventListener('change', updateLayout);\r\n    return () => {\r\n      subscription?.remove();\r\n    };\r\n  }, []);\r\n\r\n  const fetchServices = async () => {\r\n    try {\r\n      setIsLoading(true);\r\n      const data = await getProfessionalServices();\r\n      if (is_DEBUG) console.log('MBA7890: Fetched services:', data);\r\n      setServices(data);\r\n    } catch (error) {\r\n      console.error('MBA7890: Error fetching services:', error);\r\n      showToast({\r\n        message: 'Failed to load services',\r\n        type: 'error',\r\n        duration: 3000\r\n      });\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    // Only fetch services if user is signed in and has a role\r\n    if (isSignedIn && userRole) {\r\n      debugLog('MBA7890', 'Fetching services for user:', { userRole, isSignedIn });\r\n      fetchServices();\r\n    } else {\r\n      // Clear services if user is not signed in\r\n      setServices([]);\r\n      setIsLoading(false);\r\n    }\r\n  }, [isSignedIn, userRole]);\r\n\r\n  // Effect to handle unsaved changes\r\n  useEffect(() => {\r\n    if (hasUnsavedChanges) {\r\n      fetchServices();\r\n      setHasUnsavedChanges(false);\r\n    }\r\n  }, [hasUnsavedChanges]);\r\n\r\n  // Fetch services when screen comes into focus (ensures fresh data after navigation)\r\n  useFocusEffect(\r\n    useCallback(() => {\r\n      if (isSignedIn && userRole) {\r\n        debugLog('MBA7890', 'Screen focused, fetching services for user:', { userRole, isSignedIn });\r\n        fetchServices();\r\n      }\r\n    }, [isSignedIn, userRole])\r\n  );\r\n\r\n  useEffect(() => {\r\n    const setRouteHistory = async () => {\r\n      const currentRoute = 'ServiceManager';\r\n      let previousRoute;\r\n\r\n      if (Platform.OS === 'web') {\r\n        previousRoute = sessionStorage.getItem('previousRoute');\r\n        sessionStorage.setItem('previousRoute', previousRoute || '');\r\n        sessionStorage.setItem('currentRoute', currentRoute);\r\n      } else {\r\n        previousRoute = await AsyncStorage.getItem('previousRoute');\r\n        await AsyncStorage.setItem('previousRoute', previousRoute || '');\r\n        await AsyncStorage.setItem('currentRoute', currentRoute);\r\n      }\r\n\r\n      if (!previousRoute) {\r\n        previousRoute = 'Dashboard';\r\n        if (Platform.OS === 'web') {\r\n          sessionStorage.setItem('previousRoute', previousRoute || '');\r\n          sessionStorage.setItem('currentRoute', currentRoute);\r\n        } else {\r\n          await AsyncStorage.setItem('previousRoute', previousRoute || '');\r\n          await AsyncStorage.setItem('currentRoute', currentRoute);\r\n        }\r\n      }\r\n    };\r\n    setRouteHistory();\r\n  }, []);\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <View style={[styles.container, styles.loadingContainer]}>\r\n        <ActivityIndicator size=\"large\" color={theme.colors.primary} />\r\n      </View>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <View style={[\r\n      styles.container,\r\n      { marginLeft: !isMobile ? (isCollapsed ? 70 : 250) : 0 }\r\n    ]}>\r\n      {isMobile && (\r\n        <BackHeader \r\n          title=\"Service Manager\" \r\n          onBackPress={() => handleBack(navigation)} \r\n        />\r\n      )}\r\n      <View style={[styles.content, { marginTop: isMobile ? 20 : 0 }]}>\r\n        <ServiceManager\r\n          services={services || []}\r\n          setServices={setServices}\r\n          setHasUnsavedChanges={setHasUnsavedChanges}\r\n          isProfessionalTab={false}\r\n          isMobile={isMobile}\r\n        />\r\n      </View>\r\n    </View>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    height: '100vh',\r\n    backgroundColor: theme.colors.surface,\r\n    position: 'fixed',\r\n    top: 0,\r\n    right: 0,\r\n    bottom: 0,\r\n    left: 0,\r\n    overflow: 'hidden',\r\n    transition: 'margin-left 0.3s ease',\r\n  },\r\n  content: {\r\n    flex: 1,\r\n    height: '100%',\r\n    overflow: 'auto',\r\n  },\r\n  loadingContainer: {\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n  },\r\n});\r\n\r\nexport default ServiceManagerScreen; ","import React, { useState, useCallback } from 'react';\r\nimport {\r\n  View,\r\n  Text,\r\n  ScrollView,\r\n  StyleSheet,\r\n  TouchableOpacity,\r\n  Image,\r\n  Platform,\r\n  TextInput\r\n} from 'react-native';\r\nimport { useTheme, Searchbar } from 'react-native-paper';\r\nimport { BLOG_POSTS } from '../data/mockData';\r\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\r\nimport BackHeader from '../components/BackHeader';\r\nimport { theme } from '../styles/theme';\r\nimport { navigateToFrom } from '../components/Navigation';\r\n\r\nconst BlogScreen = ({ navigation }) => {\r\n  const theme = useTheme();\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const [filteredPosts, setFilteredPosts] = useState(BLOG_POSTS);\r\n\r\n  const handleBack = () => {\r\n    navigation.navigate('More');\r\n  };\r\n\r\n  const handleSearch = useCallback((query) => {\r\n    setSearchQuery(query);\r\n    const lowercaseQuery = query.toLowerCase();\r\n    const filtered = BLOG_POSTS.filter(post => \r\n      post.title.toLowerCase().includes(lowercaseQuery) ||\r\n      post.author.name.toLowerCase().includes(lowercaseQuery) ||\r\n      post.content.toLowerCase().includes(lowercaseQuery)\r\n    );\r\n    setFilteredPosts(filtered);\r\n  }, []);\r\n\r\n  const renderBlogPost = (post) => {\r\n    const truncatedContent = post.content.slice(0, 200) + '...';\r\n\r\n    return (\r\n      <TouchableOpacity\r\n        key={post.id}\r\n        style={[styles.blogCard, { backgroundColor: theme.colors.surface }]}\r\n        onPress={() => navigateToFrom(navigation, 'Blog', 'BlogPost', { post })}\r\n      >\r\n        <View style={styles.authorContainer}>\r\n          <Image\r\n            source={{ uri: post.author.profilePicture }}\r\n            style={styles.authorImage}\r\n          />\r\n          <View style={styles.blogContent}>\r\n            <Text style={[styles.title, { color: theme.colors.primary }]}>{post.title}</Text>\r\n            <View style={styles.authorInfo}>\r\n              <Text style={[styles.authorName, { color: theme.colors.secondary }]}>\r\n                {post.author.name}\r\n              </Text>\r\n              <Text style={styles.dot}> • </Text>\r\n              <Text style={styles.readTime}>{post.readTime}</Text>\r\n            </View>\r\n            <Text style={styles.preview} numberOfLines={3}>\r\n              {truncatedContent}\r\n            </Text>\r\n            <View style={styles.tags}>\r\n              {post.tags.map((tag, index) => (\r\n                <View \r\n                  key={index} \r\n                  style={[styles.tag, { backgroundColor: theme.colors.primary + '20' }]}\r\n                >\r\n                  <Text style={[styles.tagText, { color: theme.colors.primary }]}>{tag}</Text>\r\n                </View>\r\n              ))}\r\n            </View>\r\n            <View style={styles.stats}>\r\n              <View style={styles.stat}>\r\n                <MaterialCommunityIcons name=\"heart-outline\" size={20} color={theme.colors.secondary} />\r\n                <Text style={styles.statText}>{post.likes}</Text>\r\n              </View>\r\n              <View style={styles.stat}>\r\n                <MaterialCommunityIcons name=\"comment-outline\" size={20} color={theme.colors.secondary} />\r\n                <Text style={styles.statText}>{post.comments}</Text>\r\n              </View>\r\n              <View style={styles.stat}>\r\n                <MaterialCommunityIcons name=\"share-outline\" size={20} color={theme.colors.secondary} />\r\n                <Text style={styles.statText}>{post.shares}</Text>\r\n              </View>\r\n            </View>\r\n          </View>\r\n        </View>\r\n      </TouchableOpacity>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <View style={[styles.container, { backgroundColor: theme.colors.background }]}>\r\n      <BackHeader \r\n        title=\"Blog\" \r\n        onBackPress={handleBack}\r\n      />\r\n      <View style={styles.searchBarContainer}>\r\n        {Platform.OS === 'web' ? (\r\n          <View style={[styles.searchBar, { backgroundColor: theme.colors.surface }]}>\r\n            <MaterialCommunityIcons name=\"magnify\" size={24} color={theme.colors.primary} />\r\n            <TextInput\r\n              placeholder=\"Search by title, author, or content\"\r\n              onChangeText={handleSearch}\r\n              value={searchQuery}\r\n              style={styles.webSearchInput}\r\n            />\r\n            {searchQuery ? (\r\n              <TouchableOpacity onPress={() => handleSearch('')}>\r\n                <MaterialCommunityIcons name=\"close-circle\" size={24} color={theme.colors.primary} />\r\n              </TouchableOpacity>\r\n            ) : null}\r\n          </View>\r\n        ) : (\r\n          <Searchbar\r\n            placeholder=\"Search by title, author, or content\"\r\n            onChangeText={handleSearch}\r\n            value={searchQuery}\r\n            style={styles.searchBar}\r\n            icon=\"magnify\"\r\n            clearIcon=\"close-circle\"\r\n          />\r\n        )}\r\n      </View>\r\n      <ScrollView style={styles.scrollView}>\r\n        {filteredPosts.length > 0 ? (\r\n          filteredPosts.map(renderBlogPost)\r\n        ) : (\r\n          <View style={styles.noResultsContainer}>\r\n            <MaterialCommunityIcons \r\n              name=\"magnify-close\" \r\n              size={48} \r\n              color={theme.colors.secondary} \r\n            />\r\n            <Text style={[styles.noResultsText, { color: theme.colors.secondary }]}>\r\n              No blog posts found\r\n            </Text>\r\n          </View>\r\n        )}\r\n      </ScrollView>\r\n    </View>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n  },\r\n  searchBarContainer: {\r\n    margin: 16,\r\n  },\r\n  searchBar: {\r\n    elevation: 4,\r\n    borderRadius: 8,\r\n    backgroundColor: theme.colors.surface,\r\n    shadowColor: '#000',\r\n    shadowOffset: { width: 0, height: 2 },\r\n    shadowOpacity: 0.25,\r\n    shadowRadius: 3.84,\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    padding: 8,\r\n  },\r\n  searchInput: {\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n  },\r\n  scrollView: {\r\n    flex: 1,\r\n  },\r\n  blogCard: {\r\n    margin: 16,\r\n    padding: 16,\r\n    borderRadius: 12,\r\n    elevation: 4,\r\n    shadowColor: '#000',\r\n    shadowOffset: { width: 0, height: 2 },\r\n    shadowOpacity: 0.25,\r\n    shadowRadius: 3.84,\r\n  },\r\n  authorContainer: {\r\n    flexDirection: 'row',\r\n  },\r\n  authorImage: {\r\n    width: 40,\r\n    height: 40,\r\n    borderRadius: 20,\r\n    marginRight: 12,\r\n  },\r\n  blogContent: {\r\n    flex: 1,\r\n  },\r\n  title: {\r\n    fontSize: 20,\r\n    fontWeight: 'bold',\r\n    marginBottom: 8,\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n  },\r\n  authorInfo: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    marginBottom: 8,\r\n  },\r\n  authorName: {\r\n    fontSize: 14,\r\n    fontWeight: '500',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  dot: {\r\n    marginHorizontal: 4,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  readTime: {\r\n    fontSize: 14,\r\n    color: '#666',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  preview: {\r\n    fontSize: 14,\r\n    lineHeight: 20,\r\n    marginBottom: 12,\r\n    color: '#444',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  tags: {\r\n    flexDirection: 'row',\r\n    flexWrap: 'wrap',\r\n    marginBottom: 12,\r\n  },\r\n  tag: {\r\n    paddingHorizontal: 8,\r\n    paddingVertical: 4,\r\n    borderRadius: 16,\r\n    marginRight: 8,\r\n    marginBottom: 8,\r\n  },\r\n  tagText: {\r\n    fontSize: 12,\r\n    fontWeight: '500',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  stats: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'flex-start',\r\n    marginTop: 8,\r\n  },\r\n  stat: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    marginRight: 16,\r\n  },\r\n  statText: {\r\n    marginLeft: 4,\r\n    color: '#666',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  noResultsContainer: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    padding: 20,\r\n    marginTop: 40,\r\n  },\r\n  noResultsText: {\r\n    fontSize: 18,\r\n    fontWeight: '500',\r\n    marginTop: 16,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  webSearchInput: {\r\n    flex: 1,\r\n    padding: 8,\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n    border: 'none',\r\n    backgroundColor: 'transparent',\r\n    WebkitTapHighlightColor: 'transparent',\r\n    outlineWidth: 0,\r\n    outlineStyle: 'none',\r\n    boxShadow: 'none',\r\n    borderColor: 'transparent',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n});\r\n\r\nexport default BlogScreen;","import React, { useState, useEffect } from 'react';\r\nimport {\r\n  View,\r\n  Text,\r\n  ScrollView,\r\n  StyleSheet,\r\n  Image,\r\n  TouchableOpacity,\r\n  Linking,\r\n  Platform\r\n} from 'react-native';\r\nimport { useTheme } from 'react-native-paper';\r\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\r\nimport BackHeader from '../components/BackHeader';\r\nimport { theme } from '../styles/theme';\r\nimport AsyncStorage from '@react-native-async-storage/async-storage';\r\nimport { BLOG_POSTS } from '../data/mockData';\r\nimport { handleBack, navigateToFrom } from '../components/Navigation';\r\n\r\nconst BlogPost = ({ route, navigation }) => {\r\n  const [post, setPost] = useState(null);\r\n  const theme = useTheme();\r\n\r\n  // Validate post data structure\r\n  const isValidPost = (postData) => {\r\n    return postData && \r\n           typeof postData === 'object' && \r\n           postData.author && \r\n           typeof postData.author === 'object' &&\r\n           postData.author.name &&\r\n           postData.author.profilePicture &&\r\n           postData.author.bio &&\r\n           postData.title &&\r\n           postData.content &&\r\n           Array.isArray(postData.tags);\r\n  };\r\n\r\n  useEffect(() => {\r\n    const loadPost = async () => {\r\n      try {\r\n        // Try to get post from route params first\r\n        if (route?.params?.post && isValidPost(route.params.post)) {\r\n          setPost(route.params.post);\r\n          // Store the post data\r\n          if (Platform.OS === 'web') {\r\n            sessionStorage.setItem('currentBlogPost', JSON.stringify(route.params.post));\r\n          } else {\r\n            await AsyncStorage.setItem('currentBlogPost', JSON.stringify(route.params.post));\r\n          }\r\n          return;\r\n        }\r\n\r\n        // If no route params or invalid post, try to load from storage\r\n        let storedPost;\r\n        if (Platform.OS === 'web') {\r\n          storedPost = sessionStorage.getItem('currentBlogPost');\r\n        } else {\r\n          storedPost = await AsyncStorage.getItem('currentBlogPost');\r\n        }\r\n\r\n        if (storedPost) {\r\n          const parsedPost = JSON.parse(storedPost);\r\n          if (isValidPost(parsedPost)) {\r\n            setPost(parsedPost);\r\n            return;\r\n          }\r\n        }\r\n\r\n        // If no valid post found in storage, try to find it in BLOG_POSTS\r\n        if (route?.params?.postId) {\r\n          const foundPost = BLOG_POSTS.find(p => p.id === route.params.postId);\r\n          if (foundPost && isValidPost(foundPost)) {\r\n            setPost(foundPost);\r\n            return;\r\n          }\r\n        }\r\n\r\n        // If still no valid post, redirect to blog list\r\n        navigateToFrom(navigation, 'Blog', 'BlogPost');\r\n      } catch (error) {\r\n        console.error('Error loading blog post:', error);\r\n        navigateToFrom(navigation, 'Blog', 'BlogPost');\r\n      }\r\n    };\r\n\r\n    loadPost();\r\n  }, [route?.params]);\r\n\r\n  // If no post data is available, show an error state\r\n  if (!post || !isValidPost(post)) {\r\n    return (\r\n      <View style={[styles.mainContainer, { backgroundColor: theme.colors.background }]}>\r\n        <BackHeader \r\n          title=\"Blog Post\"\r\n          onBackPress={() => handleBack(navigation)}\r\n        />\r\n        <View style={styles.errorContainer}>\r\n          <MaterialCommunityIcons \r\n            name=\"alert-circle-outline\" \r\n            size={48} \r\n            color={theme.colors.error} \r\n          />\r\n          <Text style={[styles.errorText, { color: theme.colors.error }]}>\r\n            Blog post not found or invalid\r\n          </Text>\r\n          <TouchableOpacity\r\n            style={[styles.errorButton, { backgroundColor: theme.colors.primary }]}\r\n            onPress={() => navigateToFrom(navigation, 'Blog', 'BlogPost')}\r\n          >\r\n            <Text style={[styles.errorButtonText, { color: theme.colors.surface }]}>\r\n              Go to Blog List\r\n            </Text>\r\n          </TouchableOpacity>\r\n        </View>\r\n      </View>\r\n    );\r\n  }\r\n\r\n  const handleReferencePress = (reference) => {\r\n    if (reference.url) {\r\n      Linking.openURL(reference.url);\r\n    } else if (reference.doi) {\r\n      Linking.openURL(`https://doi.org/${reference.doi}`);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <View style={[styles.mainContainer, { backgroundColor: theme.colors.background }]}>\r\n      <BackHeader \r\n        title={post.title}\r\n        onBackPress={() => handleBack(navigation)}\r\n      />\r\n      <ScrollView style={styles.container}>\r\n        <View style={styles.header}>\r\n          <View style={styles.authorContainer}>\r\n            <Image\r\n              source={{ uri: post.author.profilePicture }}\r\n              style={styles.authorImage}\r\n            />\r\n            <View style={styles.authorInfo}>\r\n              <Text style={[styles.authorName, { color: theme.colors.secondary }]}>\r\n                {post.author.name}\r\n              </Text>\r\n              <Text style={styles.authorBio}>{post.author.bio}</Text>\r\n              <View style={styles.postInfo}>\r\n                <Text style={styles.date}>{post.publishDate}</Text>\r\n                <Text style={styles.dot}> • </Text>\r\n                <Text style={styles.readTime}>{post.readTime}</Text>\r\n              </View>\r\n            </View>\r\n          </View>\r\n        </View>\r\n\r\n        <View style={styles.tags}>\r\n          {post.tags.map((tag, index) => (\r\n            <View \r\n              key={index} \r\n              style={[styles.tag, { backgroundColor: theme.colors.primary + '20' }]}\r\n            >\r\n              <Text style={[styles.tagText, { color: theme.colors.primary }]}>{tag}</Text>\r\n            </View>\r\n          ))}\r\n        </View>\r\n\r\n        <Text style={[styles.content, { color: theme.colors.text }]}>{post.content}</Text>\r\n\r\n        <View style={styles.stats}>\r\n          <TouchableOpacity style={styles.stat}>\r\n            <MaterialCommunityIcons name=\"heart-outline\" size={24} color={theme.colors.secondary} />\r\n            <Text style={styles.statText}>{post.likes}</Text>\r\n          </TouchableOpacity>\r\n          <TouchableOpacity style={styles.stat}>\r\n            <MaterialCommunityIcons name=\"comment-outline\" size={24} color={theme.colors.secondary} />\r\n            <Text style={styles.statText}>{post.comments}</Text>\r\n          </TouchableOpacity>\r\n          <TouchableOpacity style={styles.stat}>\r\n            <MaterialCommunityIcons name=\"share-outline\" size={24} color={theme.colors.secondary} />\r\n            <Text style={styles.statText}>{post.shares}</Text>\r\n          </TouchableOpacity>\r\n        </View>\r\n\r\n        <View style={styles.references}>\r\n          <Text style={[styles.referencesTitle, { color: theme.colors.primary }]}>References</Text>\r\n          {post.references.map((reference, index) => (\r\n            <TouchableOpacity\r\n              key={index}\r\n              style={styles.reference}\r\n              onPress={() => handleReferencePress(reference)}\r\n            >\r\n              <Text style={styles.referenceText}>\r\n                {reference.authors} ({reference.year || 'n.d.'}). {reference.title}. {reference.publication}.\r\n                {reference.doi && ` DOI: ${reference.doi}`}\r\n              </Text>\r\n            </TouchableOpacity>\r\n          ))}\r\n        </View>\r\n      </ScrollView>\r\n    </View>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  mainContainer: {\r\n    flex: 1,\r\n  },\r\n  container: {\r\n    flex: 1,\r\n  },\r\n  header: {\r\n    padding: 16,\r\n  },\r\n  authorContainer: {\r\n    flexDirection: 'row',\r\n    marginBottom: 16,\r\n  },\r\n  authorImage: {\r\n    width: 50,\r\n    height: 50,\r\n    borderRadius: 25,\r\n    marginRight: 12,\r\n  },\r\n  authorInfo: {\r\n    flex: 1,\r\n  },\r\n  authorName: {\r\n    fontSize: 16,\r\n    fontWeight: '600',\r\n    marginBottom: 4,\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n  },\r\n  authorBio: {\r\n    fontSize: 14,\r\n    color: '#666',\r\n    marginBottom: 4,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  postInfo: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n  },\r\n  date: {\r\n    fontSize: 14,\r\n    color: '#666',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  dot: {\r\n    marginHorizontal: 4,\r\n    color: '#666',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  readTime: {\r\n    fontSize: 14,\r\n    color: '#666',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  tags: {\r\n    flexDirection: 'row',\r\n    flexWrap: 'wrap',\r\n    padding: 16,\r\n    paddingTop: 0,\r\n  },\r\n  tag: {\r\n    paddingHorizontal: 12,\r\n    paddingVertical: 6,\r\n    borderRadius: 16,\r\n    marginRight: 8,\r\n    marginBottom: 8,\r\n  },\r\n  tagText: {\r\n    fontSize: 14,\r\n    fontWeight: '500',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  content: {\r\n    fontSize: 16,\r\n    lineHeight: 24,\r\n    padding: 16,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  stats: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-around',\r\n    padding: 16,\r\n    borderTopWidth: 1,\r\n    borderBottomWidth: 1,\r\n    borderColor: '#eee',\r\n  },\r\n  stat: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n  },\r\n  statText: {\r\n    marginLeft: 8,\r\n    fontSize: 16,\r\n    color: '#666',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  references: {\r\n    padding: 16,\r\n  },\r\n  referencesTitle: {\r\n    fontSize: 20,\r\n    fontWeight: 'bold',\r\n    marginBottom: 12,\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n  },\r\n  reference: {\r\n    marginBottom: 12,\r\n  },\r\n  referenceText: {\r\n    fontSize: 14,\r\n    color: '#444',\r\n    lineHeight: 20,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  errorContainer: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    padding: 20,\r\n  },\r\n  errorText: {\r\n    fontSize: 18,\r\n    fontWeight: '500',\r\n    marginTop: 16,\r\n    marginBottom: 24,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  errorButton: {\r\n    paddingHorizontal: 20,\r\n    paddingVertical: 10,\r\n    borderRadius: 8,\r\n  },\r\n  errorButtonText: {\r\n    fontSize: 16,\r\n    fontWeight: '500',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n});\r\n\r\nexport default BlogPost;","import React, { useState, useContext } from 'react';\r\nimport { View, Text, StyleSheet, TextInput, TouchableOpacity, Platform, ScrollView, Clipboard, Modal, FlatList } from 'react-native';\r\nimport { theme } from '../styles/theme';\r\nimport BackHeader from '../components/BackHeader';\r\nimport CrossPlatformView from '../components/CrossPlatformView';\r\nimport { useNavigation } from '@react-navigation/native';\r\nimport { AuthContext } from '../context/AuthContext';\r\nimport { useForm, ValidationError } from '@formspree/react';\r\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\r\n\r\nconst CrossPlatformContent = ({ children }) => {\r\n  // For web, we need to add a div with margin auto to center content\r\n  if (Platform.OS === 'web') {\r\n    return (\r\n      <View style={{ \r\n        width: '100%', \r\n        maxWidth: 550, \r\n        marginLeft: 'auto', \r\n        marginRight: 'auto',\r\n        paddingHorizontal: 15\r\n      }}>\r\n        {children}\r\n      </View>\r\n    );\r\n  }\r\n  // For native, just return children\r\n  return <>{children}</>;\r\n};\r\n\r\nconst ValidationModal = ({ visible, message, onClose }) => {\r\n  return (\r\n    <Modal\r\n      visible={visible}\r\n      transparent\r\n      animationType=\"fade\"\r\n      onRequestClose={onClose}\r\n    >\r\n      <View style={styles.modalOverlay}>\r\n        <View style={styles.modalContent}>\r\n          <Text style={styles.modalText}>{message}</Text>\r\n          <TouchableOpacity\r\n            style={styles.modalButton}\r\n            onPress={onClose}\r\n          >\r\n            <Text style={styles.modalButtonText}>OK</Text>\r\n          </TouchableOpacity>\r\n        </View>\r\n      </View>\r\n    </Modal>\r\n  );\r\n};\r\n\r\nconst CityDropdown = ({ selectedCity, onSelectCity }) => {\r\n  const [isOpen, setIsOpen] = useState(false);\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  \r\n  const cities = [\r\n    { id: '1', name: 'Colorado Springs' },\r\n    { id: '2', name: 'Denver' },\r\n    { id: '3', name: 'Boulder' },\r\n    { id: '4', name: 'Fort Collins' },\r\n    { id: '5', name: 'Pueblo' },\r\n    { id: '6', name: 'Aurora' },\r\n    { id: '7', name: 'Littleton' },\r\n    { id: '8', name: 'Castle Rock' },\r\n    { id: '9', name: 'Parker' },\r\n    { id: '10', name: 'Centennial' },\r\n    { id: '11', name: 'Other' }\r\n  ];\r\n\r\n  const filteredCities = cities.filter(city => \r\n    city.name.toLowerCase().includes(searchQuery.toLowerCase())\r\n  );\r\n\r\n  // Always include \"Other\" in the results if it's not already there\r\n  const displayCities = filteredCities.some(city => city.name === 'Other')\r\n    ? filteredCities\r\n    : [...filteredCities, { id: '11', name: 'Other' }];\r\n\r\n  const renderCityItem = ({ item }) => (\r\n    <TouchableOpacity\r\n      style={[\r\n        styles.cityItem,\r\n        item.name === 'Other' && styles.otherCityItem\r\n      ]}\r\n      onPress={() => {\r\n        onSelectCity(item.name);\r\n        setIsOpen(false);\r\n      }}\r\n    >\r\n      <Text style={[\r\n        styles.cityItemText,\r\n        item.name === 'Other' && styles.otherCityText\r\n      ]}>\r\n        {item.name}\r\n      </Text>\r\n    </TouchableOpacity>\r\n  );\r\n\r\n  return (\r\n    <View style={styles.dropdownContainer}>\r\n      <TouchableOpacity\r\n        style={[styles.dropdownButton, !selectedCity && styles.requiredField]}\r\n        onPress={() => setIsOpen(!isOpen)}\r\n      >\r\n        <Text style={styles.dropdownButtonText}>\r\n          {selectedCity || 'Select your city'}\r\n        </Text>\r\n        <MaterialCommunityIcons\r\n          name={isOpen ? \"chevron-up\" : \"chevron-down\"}\r\n          size={24}\r\n          color={theme.colors.primary}\r\n        />\r\n      </TouchableOpacity>\r\n\r\n      {isOpen && (\r\n        <View style={styles.dropdownList}>\r\n          <TextInput\r\n            style={styles.searchInput}\r\n            placeholder=\"Search cities...\"\r\n            value={searchQuery}\r\n            onChangeText={setSearchQuery}\r\n          />\r\n          <FlatList\r\n            data={displayCities}\r\n            renderItem={renderCityItem}\r\n            keyExtractor={item => item.id}\r\n            style={styles.cityList}\r\n          />\r\n        </View>\r\n      )}\r\n    </View>\r\n  );\r\n};\r\n\r\nconst Waitlist = () => {\r\n  const navigation = useNavigation();\r\n  const { is_prototype, screenWidth } = useContext(AuthContext);\r\n  const [state, handleFormspreeSubmit] = useForm(\"mkgobpro\");\r\n  \r\n  // Form state\r\n  const [firstName, setFirstName] = useState('');\r\n  const [lastName, setLastName] = useState('');\r\n  const [email, setEmail] = useState('');\r\n  const [phone, setPhone] = useState('');\r\n  const [petInfo, setPetInfo] = useState('');\r\n  const [selectedServices, setSelectedServices] = useState([]);\r\n  const [userType, setUserType] = useState('');\r\n  const [hesitations, setHesitations] = useState('');\r\n  const [desiredFeatures, setDesiredFeatures] = useState('');\r\n  const [newsletter, setNewsletter] = useState(false);\r\n  const [agreeToTerms, setAgreeToTerms] = useState(false);\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  const [otherService, setOtherService] = useState('');\r\n  const [showOtherInput, setShowOtherInput] = useState(false);\r\n  const [streetAddress, setStreetAddress] = useState('');\r\n  const [aptUnit, setAptUnit] = useState('');\r\n  const [city, setCity] = useState('');\r\n  const [stateRegion, setStateRegion] = useState('');\r\n  const [zipCode, setZipCode] = useState('');\r\n  const [referralSource, setReferralSource] = useState('');\r\n  const [otherReferralSource, setOtherReferralSource] = useState('');\r\n  const [validationModal, setValidationModal] = useState({\r\n    visible: false,\r\n    message: ''\r\n  });\r\n  const [emailError, setEmailError] = useState('');\r\n  const [phoneError, setPhoneError] = useState('');\r\n  const [selectedCity, setSelectedCity] = useState('');\r\n  const [otherCity, setOtherCity] = useState('');\r\n  const [cityError, setCityError] = useState('');\r\n\r\n  // Calculate responsive widths\r\n  const isMobile = screenWidth < 768;\r\n  const maxContentWidth = '100%';\r\n\r\n  // Navigation handler for back button\r\n  const handleBackToSignup = () => {\r\n    navigation.navigate('SignUp');\r\n  };\r\n\r\n  const services = [\r\n    'Pet Sitting',\r\n    'Grooming',\r\n    'Training',\r\n    'Veterinary Services',\r\n    'Farm/Homestead Care',\r\n    'Care Consulting',\r\n    'Other'\r\n  ];\r\n\r\n  const userTypes = [\r\n    'Pet owner in need of services',\r\n    'Care specialist (sitter, groomer, ferrier, fish tank cleaner, etc)',\r\n    'Both'\r\n  ];\r\n\r\n  const referralSources = [\r\n    'Nextdoor',\r\n    'Reddit',\r\n    'Google',\r\n    'Other - Enter name of Person who referred you or other referral source for a free sticker'\r\n  ];\r\n\r\n  // Validation functions\r\n  const validateEmail = (email) => {\r\n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\r\n    return emailRegex.test(email);\r\n  };\r\n\r\n  const formatPhoneNumber = (text) => {\r\n    // Remove all non-numeric characters\r\n    const cleaned = text.replace(/\\D/g, '');\r\n    \r\n    // Format as (XXX) XXX-XXXX\r\n    const match = cleaned.match(/^(\\d{0,3})(\\d{0,3})(\\d{0,4})$/);\r\n    if (match) {\r\n      const [, area, prefix, line] = match;\r\n      let formatted = '';\r\n      if (area) formatted += `(${area}`;\r\n      if (prefix) formatted += `) ${prefix}`;\r\n      if (line) formatted += `-${line}`;\r\n      return formatted;\r\n    }\r\n    return cleaned;\r\n  };\r\n\r\n  const handlePhoneChange = (text) => {\r\n    const formatted = formatPhoneNumber(text);\r\n    setPhone(formatted);\r\n    setPhoneError('');\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    \r\n    // Reset validation errors\r\n    setEmailError('');\r\n    setPhoneError('');\r\n    setCityError('');\r\n\r\n    // Validate email\r\n    if (!validateEmail(email)) {\r\n      setEmailError('Please enter a valid email address');\r\n      setValidationModal({\r\n        visible: true,\r\n        message: 'Please enter a valid email address'\r\n      });\r\n      return;\r\n    }\r\n\r\n    // Validate phone\r\n    if (!phone) {\r\n      setPhoneError('Please enter a valid phone number');\r\n      setValidationModal({\r\n        visible: true,\r\n        message: 'Please enter a valid phone number'\r\n      });\r\n      return;\r\n    }\r\n\r\n    // Validate city\r\n    if (!selectedCity) {\r\n      setCityError('Please select your city');\r\n      setValidationModal({\r\n        visible: true,\r\n        message: 'Please select your city'\r\n      });\r\n      return;\r\n    }\r\n\r\n    // Validate other city input if \"Other\" is selected\r\n    if (selectedCity === 'Other' && !otherCity.trim()) {\r\n      setCityError('Please specify your city');\r\n      setValidationModal({\r\n        visible: true,\r\n        message: 'Please specify your city'\r\n      });\r\n      return;\r\n    }\r\n\r\n    if (!email || !firstName || !lastName || !phone || !petInfo || selectedServices.length === 0 || !userType || !agreeToTerms || !referralSource) {\r\n      setValidationModal({\r\n        visible: true,\r\n        message: 'Please fill in all required fields'\r\n      });\r\n      return;\r\n    }\r\n\r\n    // Check if Other is selected but no input provided for services\r\n    if (selectedServices.includes('Other') && !otherService.trim()) {\r\n      setValidationModal({\r\n        visible: true,\r\n        message: 'Please specify the other service you are interested in'\r\n      });\r\n      return;\r\n    }\r\n\r\n    // Check if Other is selected but no input provided for referral source\r\n    if (referralSource === 'Other - Enter name of Person who referred you or other referral source for a free sticker' && !otherReferralSource.trim()) {\r\n      setValidationModal({\r\n        visible: true,\r\n        message: 'Please specify where you heard about us'\r\n      });\r\n      return;\r\n    }\r\n\r\n    setIsSubmitting(true);\r\n\r\n    try {\r\n      const formData = {\r\n        firstName,\r\n        lastName,\r\n        email,\r\n        phone,\r\n        petInfo,\r\n        services: selectedServices.includes('Other') \r\n          ? [...selectedServices.filter(s => s !== 'Other'), `Other - ${otherService.trim()}`].join(', ')\r\n          : selectedServices.join(', '),\r\n        userType,\r\n        hesitations,\r\n        desiredFeatures,\r\n        newsletter: newsletter ? 'Yes' : 'No',\r\n        agreeToTerms: agreeToTerms ? 'Yes' : 'No',\r\n        referralSource: referralSource === 'Other - Enter name of Person who referred you or other referral source for a free sticker' \r\n          ? `Other - ${otherReferralSource.trim()}`\r\n          : referralSource,\r\n        // Flatten address fields\r\n        streetAddress: streetAddress || '',\r\n        aptUnit: aptUnit || '',\r\n        city: selectedCity === 'Other' ? `Other - ${otherCity.trim()}` : selectedCity,\r\n        stateRegion: stateRegion || '',\r\n        zipCode: zipCode || '',\r\n      };\r\n\r\n      console.log('MBA9876: Submitting form data:', formData);\r\n      const response = await handleFormspreeSubmit(formData);\r\n      console.log('MBA9876: Formspree response:', response);\r\n\r\n      if (state.succeeded) {\r\n        // Reset form\r\n        setFirstName('');\r\n        setLastName('');\r\n        setEmail('');\r\n        setPhone('');\r\n        setPetInfo('');\r\n        setSelectedServices([]);\r\n        setOtherService('');\r\n        setShowOtherInput(false);\r\n        setUserType('');\r\n        setHesitations('');\r\n        setDesiredFeatures('');\r\n        setNewsletter(false);\r\n        setAgreeToTerms(false);\r\n        setStreetAddress('');\r\n        setAptUnit('');\r\n        setCity('');\r\n        setStateRegion('');\r\n        setZipCode('');\r\n        setReferralSource('');\r\n        setOtherReferralSource('');\r\n      }\r\n    } catch (error) {\r\n      console.error('MBA9876: Error submitting form:', error);\r\n      console.error('MBA9876: Error response:', error.response?.data);\r\n      setValidationModal({\r\n        visible: true,\r\n        message: error.response?.data?.error || 'An error occurred while submitting the form. Please try again.'\r\n      });\r\n    } finally {\r\n      setIsSubmitting(false);\r\n    }\r\n  };\r\n\r\n  const toggleService = (service) => {\r\n    setSelectedServices(prev => {\r\n      if (service === 'Other') {\r\n        setShowOtherInput(!prev.includes('Other'));\r\n      }\r\n      return prev.includes(service)\r\n        ? prev.filter(s => s !== service)\r\n        : [...prev, service];\r\n    });\r\n  };\r\n\r\n  const handleCopyLink = async () => {\r\n    try {\r\n      await Clipboard.setString('https://crittrcove.com/waitlist');\r\n      alert('Link copied to clipboard!');\r\n    } catch (error) {\r\n      console.error('Failed to copy link:', error);\r\n    }\r\n  };\r\n\r\n  if (state.succeeded) {\r\n    return (\r\n      <CrossPlatformView fullWidthHeader={true} contentWidth={maxContentWidth}>\r\n        <BackHeader \r\n          title=\"Join Waitlist\" \r\n          onBackPress={handleBackToSignup} \r\n        />\r\n        <ScrollView \r\n          style={styles.scrollView} \r\n          contentContainerStyle={styles.scrollViewContent}\r\n        >\r\n          <CrossPlatformContent>\r\n            <View style={styles.container}>\r\n              <View style={styles.contentWrapper}>\r\n                <Text style={[styles.title, { color: theme.colors.primary }]}>\r\n                  Thank you for joining the CrittrCove waitlist!\r\n                </Text>\r\n                <Text style={styles.successMessage}>\r\n                  As a waitlist member, you'll enjoy exclusive early access to the app, priority placement, \r\n                  special gifts, and a unique profile badge to highlight your role as a founding member of CrittrCove.\r\n                </Text>\r\n                <View style={styles.referralSection}>\r\n                  <Text style={[styles.title, { fontSize: theme.fontSizes.large, marginTop: 20 }]}>\r\n                    Want Another Custom Pet Sticker? 🎁\r\n                  </Text>\r\n                  <Text style={styles.successMessage}>\r\n                    Share CrittrCove with your pet-loving friends! When they join the waitlist using this link:\r\n                  </Text>\r\n                  <View style={styles.linkContainer}>\r\n                    <Text style={styles.link}>https://crittrcove.com/waitlist</Text>\r\n                    <TouchableOpacity onPress={handleCopyLink} style={styles.copyButton}>\r\n                      <MaterialCommunityIcons name=\"content-copy\" size={20} color={theme.colors.primary} />\r\n                    </TouchableOpacity>\r\n                  </View>\r\n                  <Text style={styles.successMessage}>\r\n                    and mention your name, we'll send you another custom sticker featuring your pet. It's our way of saying thank you for helping\r\n                    grow our community!\r\n                  </Text>\r\n                  <Text style={[styles.successMessage, { fontStyle: 'italic' }]}>\r\n                    Simply tell your friends to mention your name when they sign up, and we'll take care of the rest.\r\n                  </Text>\r\n                </View>\r\n                <Text style={styles.successMessage}>\r\n                  Stay tuned for exciting updates!\r\n                </Text>\r\n              </View>\r\n            </View>\r\n          </CrossPlatformContent>\r\n        </ScrollView>\r\n      </CrossPlatformView>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <CrossPlatformView fullWidthHeader={true} contentWidth={maxContentWidth}>\r\n      <BackHeader \r\n        title=\"Join Waitlist\" \r\n        onBackPress={handleBackToSignup} \r\n      />\r\n      <ScrollView \r\n        style={styles.scrollView} \r\n        contentContainerStyle={styles.scrollViewContent}\r\n      >\r\n        <CrossPlatformContent>\r\n          <View style={styles.container}>\r\n            <View style={styles.contentWrapper}>\r\n              <Text style={styles.title}>Join the CrittrCove Waitlist!</Text>\r\n              <Text style={styles.description}>\r\n                Welcome to Critter Cove's early sign-up, the ultimate pet care marketplace for all pets—whether furry, feathery, or scaly! \r\n                Our app connects local pet care specialists with pet owners, offering reliable and loving care for your beloved companions.\r\n              </Text>\r\n              <Text style={styles.description}>\r\n                By joining our waitlist, you'll gain early access to exclusive features, special gifts, education, discounts, a custom sticker featuring your pet (if you so wish), and a profile badge as a founding member of the Critter Cove community.\r\n              </Text>\r\n\r\n              <Text style={styles.requiredFieldNote}>\r\n                <Text style={styles.requiredAsterisk}>*</Text> indicates required field\r\n              </Text>\r\n\r\n              <View style={styles.formSection}>\r\n                <View style={styles.nameContainer}>\r\n                  <View style={styles.nameField}>\r\n                    <Text style={styles.label}>First Name <Text style={styles.requiredAsterisk}>*</Text></Text>\r\n                    <TextInput\r\n                      style={styles.input}\r\n                      value={firstName}\r\n                      onChangeText={setFirstName}\r\n                      placeholder=\"First Name\"\r\n                    />\r\n                  </View>\r\n                  <View style={styles.nameField}>\r\n                    <Text style={styles.label}>Last Name <Text style={styles.requiredAsterisk}>*</Text></Text>\r\n                    <TextInput\r\n                      style={styles.input}\r\n                      value={lastName}\r\n                      onChangeText={setLastName}\r\n                      placeholder=\"Last Name\"\r\n                    />\r\n                  </View>\r\n                </View>\r\n\r\n                <Text style={styles.label}>Email <Text style={styles.requiredAsterisk}>*</Text></Text>\r\n                <TextInput\r\n                  style={[styles.input, emailError ? styles.inputError : null]}\r\n                  value={email}\r\n                  onChangeText={(text) => {\r\n                    setEmail(text);\r\n                    setEmailError('');\r\n                  }}\r\n                  placeholder=\"Email\"\r\n                  keyboardType=\"email-address\"\r\n                  autoCapitalize=\"none\"\r\n                />\r\n                {emailError ? <Text style={styles.errorText}>{emailError}</Text> : null}\r\n\r\n                <Text style={styles.label}>Phone Number <Text style={styles.requiredAsterisk}>*</Text></Text>\r\n                <TextInput\r\n                  style={[styles.input, phoneError ? styles.inputError : null]}\r\n                  value={phone}\r\n                  onChangeText={handlePhoneChange}\r\n                  placeholder=\"(XXX) XXX-XXXX\"\r\n                  keyboardType=\"numeric\"\r\n                  maxLength={14}\r\n                />\r\n                {phoneError ? <Text style={styles.errorText}>{phoneError}</Text> : null}\r\n\r\n                <Text style={styles.label}>Do you currently own pets? If yes, tell us all about them! <Text style={styles.requiredAsterisk}>*</Text></Text>\r\n                <TextInput\r\n                  style={[styles.input, styles.textArea]}\r\n                  value={petInfo}\r\n                  onChangeText={setPetInfo}\r\n                  placeholder=\"Tell us about your pets\"\r\n                  multiline\r\n                  numberOfLines={4}\r\n                />\r\n\r\n                <Text style={styles.label}>What kind of pet care services are you most interested in? <Text style={styles.requiredAsterisk}>*</Text></Text>\r\n                <View style={styles.checkboxGroup}>\r\n                  {services.map((service) => (\r\n                    <View key={service}>\r\n                      <TouchableOpacity \r\n                        style={styles.checkboxContainer}\r\n                        onPress={() => toggleService(service)}\r\n                      >\r\n                        <MaterialCommunityIcons\r\n                          name={selectedServices.includes(service) ? \"checkbox-marked\" : \"checkbox-blank-outline\"}\r\n                          size={24}\r\n                          color={theme.colors.primary}\r\n                          style={styles.checkboxIcon}\r\n                        />\r\n                        <Text style={styles.checkboxLabel}>{service}</Text>\r\n                      </TouchableOpacity>\r\n                      {service === 'Other' && selectedServices.includes('Other') && (\r\n                        <View style={styles.otherInputContainer}>\r\n                          <Text style={styles.label}>Please specify other service <Text style={styles.requiredAsterisk}>*</Text></Text>\r\n                          <TextInput\r\n                            style={[styles.input, styles.otherInput]}\r\n                            value={otherService}\r\n                            onChangeText={setOtherService}\r\n                            placeholder=\"Enter other service\"\r\n                          />\r\n                        </View>\r\n                      )}\r\n                    </View>\r\n                  ))}\r\n                </View>\r\n\r\n                <Text style={styles.label}>Are you signing up as a: <Text style={styles.requiredAsterisk}>*</Text></Text>\r\n                <View style={styles.radioGroup}>\r\n                  {userTypes.map((type) => (\r\n                    <TouchableOpacity \r\n                      key={type}\r\n                      style={styles.radioContainer}\r\n                      onPress={() => setUserType(type)}\r\n                    >\r\n                      <View style={[styles.radio, userType === type && styles.radioSelected]} />\r\n                      <Text style={styles.radioLabel}>{type}</Text>\r\n                    </TouchableOpacity>\r\n                  ))}\r\n                </View>\r\n\r\n                <Text style={styles.label}>Where did you hear about us? <Text style={styles.requiredAsterisk}>*</Text></Text>\r\n                <View style={styles.radioGroup}>\r\n                  {referralSources.map((source) => (\r\n                    <TouchableOpacity \r\n                      key={source}\r\n                      style={styles.radioContainer}\r\n                      onPress={() => setReferralSource(source)}\r\n                    >\r\n                      <View style={[styles.radio, referralSource === source && styles.radioSelected]} />\r\n                      <Text style={styles.radioLabel}>{source}</Text>\r\n                    </TouchableOpacity>\r\n                  ))}\r\n                </View>\r\n                {referralSource === 'Other - Enter name of Person who referred you or other referral source for a free sticker' && (\r\n                  <View>\r\n                    <Text style={styles.label}>Please specify where you heard about us <Text style={styles.requiredAsterisk}>*</Text></Text>\r\n                    <TextInput\r\n                      style={styles.input}\r\n                      value={otherReferralSource}\r\n                      onChangeText={setOtherReferralSource}\r\n                      placeholder=\"Enter referral source\"\r\n                    />\r\n                  </View>\r\n                )}\r\n\r\n                <Text style={styles.label}>Which city are you located in? <Text style={styles.requiredAsterisk}>*</Text></Text>\r\n                <CityDropdown\r\n                  selectedCity={selectedCity}\r\n                  onSelectCity={(city) => {\r\n                    setSelectedCity(city);\r\n                    setCityError('');\r\n                  }}\r\n                />\r\n                {selectedCity === 'Other' && (\r\n                  <View style={styles.otherInputContainer}>\r\n                    <Text style={styles.label}>Please specify your city <Text style={styles.requiredAsterisk}>*</Text></Text>\r\n                    <TextInput\r\n                      style={[styles.input, cityError && styles.inputError]}\r\n                      value={otherCity}\r\n                      onChangeText={(text) => {\r\n                        setOtherCity(text);\r\n                        setCityError('');\r\n                      }}\r\n                      placeholder=\"Enter your city\"\r\n                    />\r\n                  </View>\r\n                )}\r\n                {cityError ? <Text style={styles.errorText}>{cityError}</Text> : null}\r\n\r\n                <Text style={styles.label}>What hesitations do you have about using an app to connect you to local pet care? <Text style={styles.optional}>(Optional)</Text></Text>\r\n                <TextInput\r\n                  style={[styles.input, styles.textArea]}\r\n                  value={hesitations}\r\n                  onChangeText={setHesitations}\r\n                  placeholder=\"Share your concerns\"\r\n                  multiline\r\n                  numberOfLines={4}\r\n                />\r\n\r\n                <Text style={styles.label}>What features or tools would make Critter Cove perfect for you? <Text style={styles.optional}>(Optional)</Text></Text>\r\n                <TextInput\r\n                  style={[styles.input, styles.textArea]}\r\n                  value={desiredFeatures}\r\n                  onChangeText={setDesiredFeatures}\r\n                  placeholder=\"Share your ideas\"\r\n                  multiline\r\n                  numberOfLines={4}\r\n                />\r\n\r\n                <View style={styles.addressSection}>\r\n                  <Text style={styles.label}>Mailing Address <Text style={styles.optional}>(Optional)</Text></Text>\r\n                  <Text style={styles.addressNote}>\r\n                    🎁 <Text style={{ fontStyle: 'italic' }}> Want a custom sticker featuring your pet? Add your mailing address and we'll send you one for joining the waitlist!</Text>\r\n                  </Text>\r\n                  <TextInput\r\n                    style={styles.input}\r\n                    value={streetAddress}\r\n                    onChangeText={setStreetAddress}\r\n                    placeholder=\"Street Address\"\r\n                  />\r\n                  <TextInput\r\n                    style={styles.input}\r\n                    value={aptUnit}\r\n                    onChangeText={setAptUnit}\r\n                    placeholder=\"Apartment/Unit # (if applicable)\"\r\n                  />\r\n                  <View style={styles.cityStateContainer}>\r\n                    <TextInput\r\n                      style={[styles.input, styles.cityInput]}\r\n                      value={city}\r\n                      onChangeText={setCity}\r\n                      placeholder=\"City\"\r\n                    />\r\n                    <TextInput\r\n                      style={[styles.input, styles.stateInput]}\r\n                      value={stateRegion}\r\n                      onChangeText={setStateRegion}\r\n                      placeholder=\"State\"\r\n                      maxLength={2}\r\n                      autoCapitalize=\"characters\"\r\n                    />\r\n                    <TextInput\r\n                      style={[styles.input, styles.zipInput]}\r\n                      value={zipCode}\r\n                      onChangeText={setZipCode}\r\n                      placeholder=\"ZIP\"\r\n                      keyboardType=\"numeric\"\r\n                      maxLength={5}\r\n                    />\r\n                  </View>\r\n                </View>\r\n\r\n                <Text style={styles.label}>Would you like to be added to the email newsletter for updates on the app, pet care tips, discounts and more? <Text style={styles.optional}>(Optional)</Text></Text>\r\n                <View style={styles.buttonContainer}>\r\n                  <TouchableOpacity \r\n                    style={[styles.button, newsletter && styles.buttonSelected]}\r\n                    onPress={() => setNewsletter(true)}\r\n                  >\r\n                    <Text style={[styles.buttonText, newsletter && styles.buttonTextSelected]}>Yes</Text>\r\n                  </TouchableOpacity>\r\n                  <TouchableOpacity \r\n                    style={[styles.button, !newsletter && styles.buttonSelected]}\r\n                    onPress={() => setNewsletter(false)}\r\n                  >\r\n                    <Text style={[styles.buttonText, !newsletter && styles.buttonTextSelected]}>No</Text>\r\n                  </TouchableOpacity>\r\n                </View>\r\n\r\n                <Text style={styles.label}>I agree to the terms and conditions and understand my data will be used to improve the app experience. <Text style={styles.requiredAsterisk}>*</Text></Text>\r\n                <View style={styles.buttonContainer}>\r\n                  <TouchableOpacity \r\n                    style={[styles.button, agreeToTerms && styles.buttonSelected]}\r\n                    onPress={() => setAgreeToTerms(true)}\r\n                  >\r\n                    <Text style={[styles.buttonText, agreeToTerms && styles.buttonTextSelected]}>Yes</Text>\r\n                  </TouchableOpacity>\r\n                  <TouchableOpacity \r\n                    style={[styles.button, !agreeToTerms && styles.buttonSelected]}\r\n                    onPress={() => setAgreeToTerms(false)}\r\n                  >\r\n                    <Text style={[styles.buttonText, !agreeToTerms && styles.buttonTextSelected]}>No</Text>\r\n                  </TouchableOpacity>\r\n                </View>\r\n\r\n                <TouchableOpacity \r\n                  style={[styles.submitButton, (isSubmitting || !agreeToTerms) && styles.disabledButton]}\r\n                  onPress={handleSubmit}\r\n                  disabled={isSubmitting || !agreeToTerms}\r\n                >\r\n                  <Text style={styles.submitButtonText}>\r\n                    {isSubmitting ? 'Submitting...' : 'Join Waitlist'}\r\n                  </Text>\r\n                </TouchableOpacity>\r\n              </View>\r\n            </View>\r\n          </View>\r\n        </CrossPlatformContent>\r\n      </ScrollView>\r\n      <ValidationModal\r\n        visible={validationModal.visible}\r\n        message={validationModal.message}\r\n        onClose={() => setValidationModal({ visible: false, message: '' })}\r\n      />\r\n    </CrossPlatformView>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  scrollView: {\r\n    flex: 1,\r\n    width: '100%',\r\n  },\r\n  scrollViewContent: {\r\n    flexGrow: 1,\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    width: '100%',\r\n  },\r\n  container: {\r\n    width: '100%',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    paddingVertical: 20,\r\n  },\r\n  contentWrapper: {\r\n    padding: 20,\r\n    backgroundColor: 'white',\r\n    borderRadius: 10,\r\n    shadowColor: '#000',\r\n    shadowOffset: { width: 0, height: 2 },\r\n    shadowOpacity: 0.1,\r\n    shadowRadius: 4,\r\n    elevation: 3,\r\n    width: '100%',\r\n  },\r\n  title: {\r\n    fontSize: theme.fontSizes.largeLarge,\r\n    fontWeight: 'bold',\r\n    marginBottom: 10,\r\n    color: theme.colors.primary,\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n    textAlign: 'center',\r\n  },\r\n  description: {\r\n    fontSize: theme.fontSizes.medium,\r\n    marginBottom: 20,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    textAlign: 'center',\r\n    lineHeight: 24,\r\n  },\r\n  formSection: {\r\n    width: '100%',\r\n  },\r\n  nameContainer: {\r\n    flexDirection: 'row',\r\n    gap: 10,\r\n    marginBottom: 15,\r\n  },\r\n  nameField: {\r\n    flex: 1,\r\n  },\r\n  label: {\r\n    fontSize: theme.fontSizes.medium,\r\n    marginBottom: 5,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    fontWeight: '500',\r\n  },\r\n  input: {\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 5,\r\n    borderColor: theme.colors.border,\r\n    borderWidth: 1,\r\n    padding: 15,\r\n    marginBottom: 15,\r\n    fontSize: theme.fontSizes.medium,\r\n    width: '100%',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  textArea: {\r\n    height: 100,\r\n    textAlignVertical: 'top',\r\n  },\r\n  checkboxGroup: {\r\n    marginBottom: 15,\r\n  },\r\n  checkboxContainer: {\r\n    flexDirection: 'row',\r\n    alignItems: 'flex-start',\r\n    marginBottom: 10,\r\n    paddingRight: 10,\r\n  },\r\n  checkboxIcon: {\r\n    marginRight: 10,\r\n  },\r\n  checkboxLabel: {\r\n    flex: 1,\r\n    fontSize: theme.fontSizes.medium,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  radioGroup: {\r\n    marginBottom: 15,\r\n  },\r\n  radioContainer: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    marginBottom: 10,\r\n  },\r\n  radio: {\r\n    width: 20,\r\n    height: 20,\r\n    borderRadius: 10,\r\n    borderWidth: 2,\r\n    borderColor: theme.colors.primary,\r\n    marginRight: 10,\r\n  },\r\n  radioSelected: {\r\n    backgroundColor: theme.colors.primary,\r\n  },\r\n  radioLabel: {\r\n    fontSize: theme.fontSizes.medium,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  submitButton: {\r\n    backgroundColor: theme.colors.primary,\r\n    padding: 15,\r\n    borderRadius: 5,\r\n    alignItems: 'center',\r\n    width: '100%',\r\n    marginTop: 20,\r\n  },\r\n  submitButtonText: {\r\n    color: theme.colors.whiteText,\r\n    fontSize: theme.fontSizes.mediumLarge,\r\n    fontWeight: 'bold',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  disabledButton: {\r\n    opacity: 0.7,\r\n  },\r\n  successMessage: {\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    textAlign: 'center',\r\n    marginBottom: 15,\r\n    lineHeight: 24,\r\n  },\r\n  otherInputContainer: {\r\n    paddingLeft: 34,\r\n    width: '100%',\r\n  },\r\n  otherInput: {\r\n    marginTop: 5,\r\n    marginBottom: 10,\r\n    width: '90%',\r\n  },\r\n  addressSection: {\r\n    marginBottom: 20,\r\n  },\r\n  cityStateContainer: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    gap: 10,\r\n  },\r\n  cityInput: {\r\n    flex: 2,\r\n    marginBottom: 0,\r\n  },\r\n  stateInput: {\r\n    flex: 1,\r\n    marginBottom: 0,\r\n  },\r\n  zipInput: {\r\n    flex: 1,\r\n    marginBottom: 0,\r\n  },\r\n  addressNote: {\r\n    fontSize: theme.fontSizes.small,\r\n    color: theme.colors.text,\r\n    marginBottom: 10,\r\n    // fontStyle: 'italic',\r\n    paddingHorizontal: 5,\r\n  },\r\n  optional: {\r\n    color: theme.colors.secondary,\r\n    fontSize: theme.fontSizes.small,\r\n    fontStyle: 'italic',\r\n  },\r\n  referralSection: {\r\n    backgroundColor: theme.colors.surface,\r\n    padding: 20,\r\n    borderRadius: 10,\r\n    marginVertical: 20,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.border,\r\n  },\r\n  buttonContainer: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'flex-start',\r\n    gap: 10,\r\n    marginBottom: 20,\r\n  },\r\n  button: {\r\n    paddingVertical: 8,\r\n    paddingHorizontal: 24,\r\n    borderRadius: 5,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.primary,\r\n    backgroundColor: 'white',\r\n    minWidth: 80,\r\n    alignItems: 'center',\r\n  },\r\n  buttonSelected: {\r\n    backgroundColor: theme.colors.primary,\r\n  },\r\n  buttonText: {\r\n    color: theme.colors.primary,\r\n    fontSize: theme.fontSizes.medium,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    fontWeight: '500',\r\n  },\r\n  buttonTextSelected: {\r\n    color: 'white',\r\n  },\r\n  requiredFieldNote: {\r\n    fontSize: theme.fontSizes.small,\r\n    color: theme.colors.text,\r\n    marginBottom: 20,\r\n    fontStyle: 'italic',\r\n  },\r\n  requiredAsterisk: {\r\n    color: '#FF0000',\r\n    fontSize: theme.fontSizes.medium,\r\n  },\r\n  linkContainer: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    backgroundColor: theme.colors.surface,\r\n    padding: 10,\r\n    borderRadius: 5,\r\n    marginVertical: 10,\r\n  },\r\n  link: {\r\n    color: theme.colors.primary,\r\n    fontSize: theme.fontSizes.medium,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    marginRight: 10,\r\n  },\r\n  copyButton: {\r\n    padding: 5,\r\n  },\r\n  modalOverlay: {\r\n    flex: 1,\r\n    backgroundColor: 'rgba(0, 0, 0, 0.5)',\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n  },\r\n  modalContent: {\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 8,\r\n    padding: 20,\r\n    width: '90%',\r\n    maxWidth: 400,\r\n    alignItems: 'center',\r\n  },\r\n  modalText: {\r\n    fontSize: theme.fontSizes.medium,\r\n    marginBottom: 20,\r\n    textAlign: 'center',\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  modalButton: {\r\n    backgroundColor: theme.colors.primary,\r\n    paddingVertical: 12,\r\n    paddingHorizontal: 24,\r\n    borderRadius: 8,\r\n    minWidth: 100,\r\n    alignItems: 'center',\r\n  },\r\n  modalButtonText: {\r\n    color: theme.colors.surface,\r\n    fontSize: theme.fontSizes.medium,\r\n    fontWeight: '500',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  inputError: {\r\n    borderColor: '#FF0000',\r\n    borderWidth: 1,\r\n  },\r\n  errorText: {\r\n    color: '#FF0000',\r\n    fontSize: theme.fontSizes.small,\r\n    marginTop: -10,\r\n    marginBottom: 15,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  dropdownContainer: {\r\n    marginBottom: 15,\r\n    zIndex: 1000,\r\n  },\r\n  dropdownButton: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 5,\r\n    borderColor: theme.colors.border,\r\n    borderWidth: 1,\r\n    padding: 15,\r\n  },\r\n  dropdownButtonText: {\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  dropdownList: {\r\n    position: 'absolute',\r\n    top: '100%',\r\n    left: 0,\r\n    right: 0,\r\n    backgroundColor: 'white',\r\n    borderRadius: 5,\r\n    borderColor: theme.colors.border,\r\n    borderWidth: 1,\r\n    marginTop: 5,\r\n    maxHeight: 300,\r\n    zIndex: 1000,\r\n  },\r\n  searchInput: {\r\n    padding: 10,\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: theme.colors.border,\r\n    fontSize: theme.fontSizes.medium,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  cityList: {\r\n    maxHeight: 250,\r\n  },\r\n  cityItem: {\r\n    padding: 15,\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: theme.colors.border,\r\n  },\r\n  cityItemText: {\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  requiredField: {\r\n    borderColor: '#FF0000',\r\n    borderWidth: 1,\r\n  },\r\n  otherCityItem: {\r\n    borderTopWidth: 1,\r\n    borderTopColor: theme.colors.border,\r\n    backgroundColor: theme.colors.surface,\r\n  },\r\n  otherCityText: {\r\n    color: theme.colors.primary,\r\n    fontWeight: '500',\r\n  },\r\n});\r\n\r\nexport default Waitlist; ","import React from 'react';\r\nimport { View, Text, StyleSheet, Button } from 'react-native';\r\nimport { useToast } from '../components/ToastProvider';\r\nimport { theme } from '../styles/theme';\r\n\r\nconst TestToast = () => {\r\n  const showToast = useToast();\r\n\r\n  const showSuccessToast = () => {\r\n    showToast({\r\n      message: 'Success! Operation completed successfully.',\r\n      type: 'success',\r\n      duration: 3000\r\n    });\r\n  };\r\n\r\n  const showErrorToast = () => {\r\n    showToast({\r\n      message: 'Error! Something went wrong.',\r\n      type: 'error',\r\n      duration: 3000\r\n    });\r\n  };\r\n\r\n  const showInfoToast = () => {\r\n    showToast({\r\n      message: 'Info: This is an informational message.',\r\n      type: 'info',\r\n      duration: 3000\r\n    });\r\n  };\r\n\r\n  const showWarningToast = () => {\r\n    showToast({\r\n      message: 'Warning: This action may have consequences.',\r\n      type: 'warning',\r\n      duration: 3000\r\n    });\r\n  };\r\n\r\n  const showLongToast = () => {\r\n    showToast({\r\n      message: 'This is a longer toast message that will stay visible for 5 seconds to demonstrate how longer messages look.',\r\n      type: 'info',\r\n      duration: 5000\r\n    });\r\n  };\r\n\r\n  return (\r\n    <View style={styles.container}>\r\n      <Text style={styles.title}>Toast Notification Test</Text>\r\n      \r\n      <View style={styles.buttonContainer}>\r\n        <Button \r\n          title=\"Show Success Toast\" \r\n          onPress={showSuccessToast}\r\n          color={theme.colors.primary}\r\n        />\r\n      </View>\r\n      \r\n      <View style={styles.buttonContainer}>\r\n        <Button \r\n          title=\"Show Error Toast\" \r\n          onPress={showErrorToast}\r\n          color={theme.colors.error}\r\n        />\r\n      </View>\r\n      \r\n      <View style={styles.buttonContainer}>\r\n        <Button \r\n          title=\"Show Info Toast\" \r\n          onPress={showInfoToast}\r\n          color={theme.colors.info || '#29B6F6'}\r\n        />\r\n      </View>\r\n      \r\n      <View style={styles.buttonContainer}>\r\n        <Button \r\n          title=\"Show Warning Toast\" \r\n          onPress={showWarningToast}\r\n          color={theme.colors.warning || '#FFA726'}\r\n        />\r\n      </View>\r\n      \r\n      <View style={styles.buttonContainer}>\r\n        <Button \r\n          title=\"Show Long Toast\" \r\n          onPress={showLongToast}\r\n          color=\"#9C27B0\"\r\n        />\r\n      </View>\r\n    </View>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    padding: 20,\r\n    backgroundColor: theme.colors.background,\r\n  },\r\n  title: {\r\n    fontSize: 24,\r\n    fontWeight: 'bold',\r\n    marginBottom: 30,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts?.medium?.fontFamily || undefined,\r\n  },\r\n  buttonContainer: {\r\n    width: '100%',\r\n    marginVertical: 10,\r\n    maxWidth: 300,\r\n  }\r\n});\r\n\r\nexport default TestToast; ","import React, { useContext, useState } from 'react';\r\nimport { View, Text, StyleSheet, TouchableOpacity, Image, Animated, Platform } from 'react-native';\r\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\r\nimport { theme } from '../styles/theme';\r\nimport { AuthContext, debugLog } from '../context/AuthContext';\r\nimport { supportsHover } from '../utils/deviceUtils';\r\n\r\nconst ConnectionCard = ({ connection, type, onViewProfile, onCreateBooking }) => {\r\n  // Determine if this is a client or professional connection\r\n  const isClient = type === 'clients';\r\n  const { screenWidth } = useContext(AuthContext);\r\n  const isMobile = screenWidth < 900;\r\n  const isWideScreen = screenWidth >= 1200;\r\n  const isExtraWideScreen = screenWidth >= 2500;\r\n  \r\n  // State for button hover effects\r\n  const [isViewMessagesHovered, setIsViewMessagesHovered] = useState(false);\r\n  const [isCreateBookingHovered, setIsCreateBookingHovered] = useState(false);\r\n  \r\n  // Check if device supports hover\r\n  const deviceSupportsHover = supportsHover();\r\n  \r\n  // Determine booking status tag\r\n  const getBookingStatusTag = () => {\r\n    if (connection.active_bookings_count > 0) {\r\n      return {\r\n        icon: \"calendar-check\",\r\n        iconColor: \"#4CAF50\",\r\n        text: \"Active Bookings\",\r\n        containerStyle: styles.activeBookingsContainer,\r\n        textStyle: styles.activeBookingsText\r\n      };\r\n    } else if (connection.has_past_booking === 1) {\r\n      return {\r\n        icon: \"history\",\r\n        iconColor: \"#9C27B0\",\r\n        text: \"Past Bookings\",\r\n        containerStyle: styles.pastBookingsContainer,\r\n        textStyle: styles.pastBookingsText\r\n      };\r\n    } else {\r\n      return {\r\n        icon: \"calendar-remove\",\r\n        iconColor: \"#898974\",\r\n        text: \"No Bookings Yet\",\r\n        containerStyle: styles.noBookingsContainer,\r\n        textStyle: styles.noBookingsText\r\n      };\r\n    }\r\n  };\r\n  \r\n  const bookingStatus = getBookingStatusTag();\r\n  \r\n  debugLog('MBA9452: Rendering ConnectionCard:', {\r\n    connectionId: connection.id,\r\n    connectionName: connection.name,\r\n    connectionType: type,\r\n    conversationId: connection.conversation_id,\r\n    hasActivePastBooking: connection.has_past_booking,\r\n    activeBookingsCount: connection.active_bookings_count,\r\n    isMobile,\r\n    isWideScreen,\r\n    isExtraWideScreen,\r\n    screenWidth\r\n  });\r\n  \r\n  return (\r\n    <View style={styles.card}>\r\n      <View style={styles.contentContainer}>\r\n        <View style={styles.topRow}>\r\n          <View style={[\r\n            styles.profileInfo,\r\n            !isExtraWideScreen && styles.profileInfoWrap\r\n          ]}>\r\n            <Image \r\n              source={connection.avatar ? { uri: connection.avatar } : require('../../assets/default-profile.png')} \r\n              style={styles.avatar} \r\n            />\r\n            \r\n            <View style={[\r\n              styles.nameContainer,\r\n              isWideScreen && styles.nameContainerWide\r\n            ]}>\r\n              <Text style={styles.name}>{connection.name}</Text>\r\n              \r\n              {isClient ? (\r\n                <View style={styles.petsContainer}>\r\n                  <Text style={styles.petsLabel}>Pets: </Text>\r\n                  <Text style={[\r\n                    styles.petsText,\r\n                    isWideScreen && styles.petsTextWide\r\n                  ]}>\r\n                    {connection.pets?.length > 0 \r\n                      ? connection.pets.map(pet => `${pet.name} (${pet.species})`).join(', ') \r\n                      : 'No pets added yet'}\r\n                  </Text>\r\n                </View>\r\n              ) : (\r\n                <View style={styles.servicesContainer}>\r\n                  <Text style={styles.servicesLabel}>Services: </Text>\r\n                  <Text style={[\r\n                    styles.servicesText,\r\n                    isWideScreen && styles.servicesTextWide\r\n                  ]}>\r\n                    {connection.services?.join(', ') || 'No services'}\r\n                  </Text>\r\n                </View>\r\n              )}\r\n              \r\n              <View style={bookingStatus.containerStyle}>\r\n                <MaterialCommunityIcons name={bookingStatus.icon} size={14} color={bookingStatus.iconColor} />\r\n                <Text style={bookingStatus.textStyle}>\r\n                  {bookingStatus.text}\r\n                </Text>\r\n              </View>\r\n            </View>\r\n          </View>\r\n          \r\n          {!isMobile && (\r\n            <View style={[\r\n              styles.buttonSection,\r\n              !isExtraWideScreen && styles.buttonSectionWrap\r\n            ]}>\r\n              <TouchableOpacity \r\n                style={[\r\n                  styles.viewProfileButton,\r\n                  isViewMessagesHovered && styles.buttonHovered\r\n                ]}\r\n                onPress={() => {\r\n                  debugLog('MBA4321 View Messages button clicked', {\r\n                    connectionName: connection.name,\r\n                    conversationId: connection.conversation_id\r\n                  });\r\n                  onViewProfile(connection);\r\n                }}\r\n                onMouseEnter={() => deviceSupportsHover && setIsViewMessagesHovered(true)}\r\n                onMouseLeave={() => deviceSupportsHover && setIsViewMessagesHovered(false)}\r\n              >\r\n                <Text style={styles.viewProfileText}>View Messages</Text>\r\n              </TouchableOpacity>\r\n              \r\n              {isClient && (\r\n                <TouchableOpacity \r\n                  style={[\r\n                    styles.createBookingButton,\r\n                    isCreateBookingHovered && styles.buttonHovered\r\n                  ]}\r\n                  onPress={() => {\r\n                    debugLog('MBA4321 Create Booking button clicked', {\r\n                      connectionName: connection.name,\r\n                      conversationId: connection.conversation_id\r\n                    });\r\n                    onCreateBooking(connection);\r\n                  }}\r\n                  onMouseEnter={() => deviceSupportsHover && setIsCreateBookingHovered(true)}\r\n                  onMouseLeave={() => deviceSupportsHover && setIsCreateBookingHovered(false)}\r\n                >\r\n                  <Text style={styles.createBookingText}>Create Booking</Text>\r\n                </TouchableOpacity>\r\n              )}\r\n            </View>\r\n          )}\r\n        </View>\r\n\r\n        {connection.last_booking && (\r\n          <View style={styles.statusSection}>\r\n            <View style={styles.lastBookingContainer}>\r\n              <MaterialCommunityIcons name=\"calendar-clock\" size={16} color={theme.colors.text} />\r\n              <Text style={styles.lastBookingText}>\r\n                Last booking: {connection.last_booking}\r\n              </Text>\r\n            </View>\r\n      \r\n            {connection.upcoming_booking && (\r\n              <View style={styles.upcomingContainer}>\r\n                <MaterialCommunityIcons name=\"calendar-check\" size={16} color={theme.colors.primary} />\r\n                <Text style={styles.upcomingText}>\r\n                  Upcoming Booking\r\n                </Text>\r\n              </View>\r\n            )}\r\n          </View>\r\n        )}\r\n\r\n        {isMobile && (\r\n          <View style={styles.mobileBtnSection}>\r\n            <TouchableOpacity \r\n              style={[\r\n                styles.viewProfileButton,\r\n                isViewMessagesHovered && styles.buttonHovered\r\n              ]}\r\n              onPress={() => {\r\n                debugLog('MBA4321 View Messages button clicked (mobile)', {\r\n                  connectionName: connection.name,\r\n                  conversationId: connection.conversation_id\r\n                });\r\n                onViewProfile(connection);\r\n              }}\r\n              onMouseEnter={() => deviceSupportsHover && setIsViewMessagesHovered(true)}\r\n              onMouseLeave={() => deviceSupportsHover && setIsViewMessagesHovered(false)}\r\n            >\r\n              <Text style={styles.viewProfileText}>View Messages</Text>\r\n            </TouchableOpacity>\r\n            \r\n            {isClient && (\r\n              <TouchableOpacity \r\n                style={[\r\n                  styles.createBookingButton,\r\n                  isCreateBookingHovered && styles.buttonHovered\r\n                ]}\r\n                onPress={() => {\r\n                  debugLog('MBA4321 Create Booking button clicked (mobile)', {\r\n                    connectionName: connection.name,\r\n                    conversationId: connection.conversation_id\r\n                  });\r\n                  onCreateBooking(connection);\r\n                }}\r\n                onMouseEnter={() => deviceSupportsHover && setIsCreateBookingHovered(true)}\r\n                onMouseLeave={() => deviceSupportsHover && setIsCreateBookingHovered(false)}\r\n              >\r\n                <Text style={styles.createBookingText}>Create Booking</Text>\r\n              </TouchableOpacity>\r\n            )}\r\n          </View>\r\n        )}\r\n      </View>\r\n    </View>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  card: {\r\n    backgroundColor: theme.colors.surfaceContrast,\r\n    borderRadius: 8,\r\n    // marginBottom: 16,\r\n    padding: 16,\r\n    elevation: 2,\r\n    shadowColor: '#000',\r\n    shadowOffset: { width: 0, height: 2 },\r\n    shadowOpacity: 0.1,\r\n    shadowRadius: 4,\r\n    width: '100%',\r\n  },\r\n  contentContainer: {\r\n    width: '100%',\r\n  },\r\n  topRow: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'flex-start',\r\n    width: '100%',\r\n    flexWrap: 'wrap',\r\n  },\r\n  profileInfo: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    flex: 1,\r\n    minWidth: 0,\r\n  },\r\n  profileInfoWrap: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    flex: 1,\r\n    minWidth: '70%',\r\n  },\r\n  avatar: {\r\n    width: 60,\r\n    height: 60,\r\n    borderRadius: 30,\r\n    marginRight: 16,\r\n    flexShrink: 0,\r\n  },\r\n  nameContainer: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    minWidth: 0,\r\n    marginRight: 16,\r\n  },\r\n  nameContainerWide: {\r\n    maxWidth: '60%',\r\n  },\r\n  name: {\r\n    fontSize: 18,\r\n    fontWeight: '600',\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n    marginBottom: 8,\r\n  },\r\n  petsContainer: {\r\n    flexDirection: 'row',\r\n    flexWrap: 'wrap',\r\n    alignItems: 'center',\r\n    marginBottom: 8,\r\n  },\r\n  petsLabel: {\r\n    fontSize: 14,\r\n    fontWeight: '600',\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    flexShrink: 0,\r\n  },\r\n  petsText: {\r\n    fontSize: 14,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    flex: 1,\r\n    minWidth: 0,\r\n  },\r\n  petsTextWide: {\r\n    maxWidth: '80%',\r\n    whiteSpace: 'nowrap',\r\n    overflow: 'hidden',\r\n    textOverflow: 'ellipsis',\r\n  },\r\n  servicesContainer: {\r\n    flexDirection: 'row',\r\n    flexWrap: 'wrap',\r\n    alignItems: 'center',\r\n    marginBottom: 8,\r\n  },\r\n  servicesLabel: {\r\n    fontSize: 14,\r\n    fontWeight: '600',\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    flexShrink: 0,\r\n  },\r\n  servicesText: {\r\n    fontSize: 14,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    flex: 1,\r\n    minWidth: 0,\r\n  },\r\n  servicesTextWide: {\r\n    maxWidth: '80%',\r\n    whiteSpace: 'nowrap',\r\n    overflow: 'hidden',\r\n    textOverflow: 'ellipsis',\r\n  },\r\n  statusSection: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    paddingVertical: 8,\r\n    marginTop: 8,\r\n  },\r\n  lastBookingContainer: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n  },\r\n  lastBookingText: {\r\n    marginLeft: 6,\r\n    fontSize: 14,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  noBookingsContainer: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    backgroundColor: '#F2F2F0',\r\n    borderRadius: 4,\r\n    padding: 4,\r\n    marginTop: 8,\r\n    alignSelf: 'flex-start',\r\n  },\r\n  noBookingsText: {\r\n    fontSize: 12,\r\n    color: '#898974',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    marginLeft: 6,\r\n  },\r\n  pastBookingsContainer: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    backgroundColor: '#F9F2FC',\r\n    borderRadius: 4,\r\n    padding: 4,\r\n    marginTop: 8,\r\n    alignSelf: 'flex-start',\r\n  },\r\n  pastBookingsText: {\r\n    marginLeft: 6,\r\n    fontSize: 12,\r\n    color: '#9C27B0',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  upcomingContainer: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    backgroundColor: '#F0F9E5',\r\n    padding: 6,\r\n    borderRadius: 16,\r\n  },\r\n  upcomingText: {\r\n    marginLeft: 6,\r\n    fontSize: 14,\r\n    color: theme.colors.primary,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    fontWeight: '500',\r\n  },\r\n  buttonSection: {\r\n    flexDirection: 'row',\r\n    gap: 12,\r\n    alignItems: 'center',\r\n    justifyContent: 'flex-end',\r\n    flexShrink: 0,\r\n  },\r\n  buttonSectionWrap: {\r\n    marginTop: 12,\r\n    marginLeft: 'auto',\r\n  },\r\n  mobileBtnSection: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'flex-end',\r\n    gap: 12,\r\n    marginTop: 12,\r\n  },\r\n  viewProfileButton: {\r\n    paddingVertical: 8,\r\n    paddingHorizontal: 16,\r\n    backgroundColor: '#F0F9E5',\r\n    borderRadius: 6,\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    transition: 'transform 0.2s ease, box-shadow 0.2s ease',\r\n  },\r\n  viewProfileText: {\r\n    color: theme.colors.primary,\r\n    fontSize: 14,\r\n    fontWeight: '600',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  createBookingButton: {\r\n    paddingVertical: 8,\r\n    paddingHorizontal: 16,\r\n    backgroundColor: theme.colors.primary,\r\n    borderRadius: 6,\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    transition: 'transform 0.2s ease, box-shadow 0.2s ease',\r\n  },\r\n  createBookingText: {\r\n    color: theme.colors.surfaceContrast,\r\n    fontSize: 14,\r\n    fontWeight: '600',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  buttonHovered: {\r\n    transform: [{translateY: -3}],\r\n    boxShadow: '0px 6px 10px rgba(0, 0, 0, 0.15)',\r\n  },\r\n  activeBookingsContainer: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    backgroundColor: '#F0F9E5',\r\n    borderRadius: 4,\r\n    padding: 4,\r\n    marginTop: 8,\r\n    alignSelf: 'flex-start',\r\n  },\r\n  activeBookingsText: {\r\n    marginLeft: 6,\r\n    fontSize: 12,\r\n    color: '#4CAF50',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n});\r\n\r\nexport default ConnectionCard; ","import React, { useState, useEffect, useContext, useRef } from 'react';\r\nimport { View, Text, StyleSheet, TextInput, FlatList, TouchableOpacity, ActivityIndicator, Platform, Dimensions, ScrollView, Modal } from 'react-native';\r\nimport { useNavigation } from '@react-navigation/native';\r\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\r\nimport { theme } from '../styles/theme';\r\nimport ConnectionCard from '../components/ConnectionCard';\r\nimport { AuthContext, debugLog } from '../context/AuthContext';\r\nimport AsyncStorage from '@react-native-async-storage/async-storage';\r\nimport { navigateToFrom } from '../components/Navigation';\r\nimport { getUserConnections, inviteClient } from '../api/API';\r\nimport { supportsHover } from '../utils/deviceUtils';\r\n\r\nconst Connections = () => {\r\n  const navigation = useNavigation();\r\n  const { isApprovedProfessional, userRole, isCollapsed, screenWidth } = useContext(AuthContext);\r\n  const [isMobile, setIsMobile] = useState(screenWidth < 900);\r\n  const [isWideScreen, setIsWideScreen] = useState(screenWidth >= 1500);\r\n  const [activeTab, setActiveTab] = useState('clients');\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const [connections, setConnections] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  const [page, setPage] = useState(1);\r\n  const [hasMore, setHasMore] = useState(true);\r\n  const [isLoadingMore, setIsLoadingMore] = useState(false);\r\n  const [activeFilter, setActiveFilter] = useState('all');\r\n  const [hoveredFilter, setHoveredFilter] = useState(null);\r\n  const [showInviteModal, setShowInviteModal] = useState(false);\r\n  const [inviteEmail, setInviteEmail] = useState('');\r\n  const [isInviting, setIsInviting] = useState(false);\r\n  const [searchFocused, setSearchFocused] = useState(false);\r\n  const searchInputRef = useRef(null);\r\n  const [allConnections, setAllConnections] = useState([]);\r\n  const [invitationType, setInvitationType] = useState('email');\r\n  const [generatedLink, setGeneratedLink] = useState('');\r\n  const [inviteError, setInviteError] = useState('');\r\n  const [inviteSuccess, setInviteSuccess] = useState('');\r\n  const [isInviteButtonHovered, setIsInviteButtonHovered] = useState(false);\r\n  const [isCreateServiceButtonHovered, setIsCreateServiceButtonHovered] = useState(false);\r\n\r\n  // Check if device supports hover\r\n  const deviceSupportsHover = supportsHover();\r\n\r\n  // Update layout based on screen size\r\n  useEffect(() => {\r\n    const updateLayout = () => {\r\n      setIsMobile(Dimensions.get('window').width < 900);\r\n      setIsWideScreen(Dimensions.get('window').width >= 1200);\r\n    };\r\n\r\n    const subscription = Dimensions.addEventListener('change', updateLayout);\r\n    return () => {\r\n      subscription?.remove();\r\n    };\r\n  }, []);\r\n\r\n  // Set the initial tab based on role\r\n  useEffect(() => {\r\n    if (userRole === 'professional') {\r\n      setActiveTab('clients');\r\n    } else {\r\n      setActiveTab('professionals');\r\n    }\r\n  }, [userRole]);\r\n\r\n  // Handle navigation based on the user role\r\n  useEffect(() => {\r\n    const handleRoleNavigation = async () => {\r\n      debugLog('MBA4321 Checking user role for navigation', { userRole });\r\n      if (userRole === 'petOwner') {\r\n        // Store Dashboard as the current route before navigating\r\n        if (Platform.OS === 'web') {\r\n          sessionStorage.setItem('previousRoute', '');\r\n          sessionStorage.setItem('currentRoute', 'Dashboard');\r\n        } else {\r\n          await AsyncStorage.setItem('previousRoute', '');\r\n          await AsyncStorage.setItem('currentRoute', 'Dashboard');\r\n        }\r\n        debugLog('MBA4321 User is pet owner, navigating to Dashboard');\r\n        navigation.navigate('Dashboard');\r\n      }\r\n    };\r\n\r\n    handleRoleNavigation();\r\n  }, [userRole, navigation]);\r\n\r\n  const fetchConnections = async (pageNum = 1, isLoadMore = false) => {\r\n    setLoading(!isLoadMore);\r\n    isLoadMore && setIsLoadingMore(true);\r\n    \r\n    debugLog('MBA4321 Fetching connections:', {\r\n      page: pageNum,\r\n      isLoadMore\r\n    });\r\n\r\n    try {\r\n      const response = await getUserConnections(pageNum);\r\n      \r\n      debugLog('MBA4321 Response from API:', response);\r\n\r\n      const connectionsList = response.connections || [];\r\n      \r\n      if (isLoadMore) {\r\n        const newConnections = [...connections, ...connectionsList];\r\n        setConnections(newConnections);\r\n        setAllConnections(newConnections);\r\n      } else {\r\n        setConnections(connectionsList);\r\n        setAllConnections(connectionsList);\r\n      }\r\n\r\n      setHasMore(connectionsList.length === 20);\r\n      setPage(pageNum);\r\n    } catch (error) {\r\n      debugLog('MBA4321 Error fetching connections:', error);\r\n      setError('Failed to fetch connections');\r\n    } finally {\r\n      setLoading(false);\r\n      setIsLoadingMore(false);\r\n    }\r\n  };\r\n\r\n  // Update useEffect to only fetch once and not refetch when filter changes\r\n  useEffect(() => {\r\n    debugLog('MBA4321 Fetching connections due to dependency change:', {\r\n      activeTab,\r\n      userRole\r\n    });\r\n    setPage(1);\r\n    setConnections([]);\r\n    fetchConnections(1);\r\n  }, [activeTab, userRole]);\r\n\r\n  // Add new useEffect to filter connections locally when filter changes\r\n  useEffect(() => {\r\n    debugLog('MBA4321 Filtering connections locally based on:', {\r\n      activeFilter\r\n    });\r\n    if (allConnections.length > 0) {\r\n      filterConnectionsLocally();\r\n    }\r\n  }, [activeFilter, allConnections]);\r\n\r\n  // Add function to filter connections locally\r\n  const filterConnectionsLocally = () => {\r\n    if (!allConnections.length) return;\r\n    \r\n    debugLog('MBA9452: Filtering connections locally with filter:', activeFilter);\r\n    \r\n    if (activeFilter === 'all') {\r\n      setConnections(allConnections);\r\n      return;\r\n    }\r\n    \r\n    // Filter based on activeFilter\r\n    let filtered = [];\r\n    \r\n    switch (activeFilter) {\r\n      case 'active_bookings':\r\n        filtered = allConnections.filter(connection => \r\n          connection.active_bookings_count > 0\r\n        );\r\n        break;\r\n      case 'no_bookings':\r\n        filtered = allConnections.filter(connection => \r\n          connection.active_bookings_count === 0 && connection.has_past_booking === 0\r\n        );\r\n        break;\r\n      case 'past_bookings':\r\n        filtered = allConnections.filter(connection => \r\n          connection.active_bookings_count === 0 && connection.has_past_booking === 1\r\n        );\r\n        break;\r\n      default:\r\n        filtered = allConnections;\r\n    }\r\n    \r\n    setConnections(filtered);\r\n  };\r\n\r\n  // Handle search\r\n  const handleSearch = (query) => {\r\n    setSearchQuery(query);\r\n    \r\n    // If query is empty, reapply the current filter\r\n    if (!query.trim()) {\r\n      debugLog('MBA9452: Empty search query, reapplying current filter');\r\n      filterConnectionsLocally();\r\n      return;\r\n    }\r\n\r\n    debugLog('MBA9452: Searching connections with query:', query);\r\n    \r\n    // Get the base set of connections to search from (already filtered by activeFilter)\r\n    let baseConnections = [];\r\n    if (activeFilter === 'all') {\r\n      baseConnections = allConnections;\r\n    } else {\r\n      // Re-apply the active filter to get the current filtered set\r\n      switch (activeFilter) {\r\n        case 'active_bookings':\r\n          baseConnections = allConnections.filter(connection => \r\n            connection.active_bookings_count > 0\r\n          );\r\n          break;\r\n        case 'no_bookings':\r\n          baseConnections = allConnections.filter(connection => \r\n            connection.active_bookings_count === 0 && connection.has_past_booking === 0\r\n          );\r\n          break;\r\n        case 'past_bookings':\r\n          baseConnections = allConnections.filter(connection => \r\n            connection.active_bookings_count === 0 && connection.has_past_booking === 1\r\n          );\r\n          break;\r\n        default:\r\n          baseConnections = allConnections;\r\n      }\r\n    }\r\n    \r\n    // Filter the already filtered list based on search query\r\n    const searchLower = query.toLowerCase();\r\n    const filtered = baseConnections.filter(connection => \r\n      connection.name.toLowerCase().includes(searchLower) || \r\n      (activeTab === 'clients' && connection.pets?.some(pet => \r\n        pet.name?.toLowerCase().includes(searchLower) || \r\n        pet.species?.toLowerCase().includes(searchLower)\r\n      ))\r\n    );\r\n\r\n    setConnections(filtered);\r\n  };\r\n\r\n  const handleLoadMore = () => {\r\n    if (!isLoadingMore && hasMore) {\r\n      fetchConnections(page + 1, true);\r\n    }\r\n  };\r\n\r\n  const handleViewMessages = async (connection) => {\r\n    debugLog('MBA4321 Navigating to messages with connection:', {\r\n      connectionId: connection.id,\r\n      connectionName: connection.name,\r\n      conversationId: connection.conversation_id\r\n    });\r\n    \r\n    // Navigate to MessageHistory screen with conversation ID\r\n    await navigateToFrom(navigation, 'MessageHistory', 'Connections', {\r\n      conversationId: connection.conversation_id,\r\n      otherUserName: connection.name\r\n      // No isProfessional flag here as we don't want to trigger booking creation\r\n    });\r\n  };\r\n\r\n  const handleCreateBooking = async (connection) => {\r\n    debugLog('MBA4321 Creating booking with client:', {\r\n      clientId: connection.id,\r\n      clientName: connection.name,\r\n      conversationId: connection.conversation_id\r\n    });\r\n    \r\n    // Navigate directly to the MessageHistory screen with the conversation ID\r\n    await navigateToFrom(navigation, 'MessageHistory', 'Connections', {\r\n      conversationId: connection.conversation_id,\r\n      otherUserName: connection.name,\r\n      clientId: connection.client_id, // Include client_id for potential future use\r\n      isProfessional: true // Since this is called from the professional's perspective\r\n    });\r\n  };\r\n\r\n  const handleInviteClient = () => {\r\n    debugLog('MBA4321 Opening invite client modal');\r\n    setInviteEmail('');\r\n    setGeneratedLink('');\r\n    setInviteError('');\r\n    setInviteSuccess('');\r\n    setInvitationType('email');\r\n    setShowInviteModal(true);\r\n  };\r\n  \r\n  const handleSendInvite = async () => {\r\n    setInviteError('');\r\n    setInviteSuccess('');\r\n    \r\n    if (invitationType === 'email') {\r\n      if (!inviteEmail || !inviteEmail.includes('@')) {\r\n        setInviteError('Please enter a valid email address');\r\n        debugLog('MBA4321 Invalid email format:', inviteEmail);\r\n        return;\r\n      }\r\n    }\r\n    \r\n    setIsInviting(true);\r\n    debugLog('MBA4321 Creating invitation:', { \r\n      type: invitationType, \r\n      email: invitationType === 'email' ? inviteEmail : null \r\n    });\r\n    \r\n    try {\r\n      const response = await inviteClient(invitationType, invitationType === 'email' ? inviteEmail : null);\r\n      debugLog('MBA4321 Invitation created successfully:', response);\r\n      \r\n      if (invitationType === 'email') {\r\n        setInviteSuccess(`Invitation sent to ${inviteEmail}`);\r\n        setInviteEmail('');\r\n      } else {\r\n        setGeneratedLink(response.invitation_link);\r\n        setInviteSuccess('Invitation link created successfully!');\r\n      }\r\n      \r\n      // Refresh the connections list only if needed\r\n      if (activeFilter === 'pending' || activeFilter === 'all') {\r\n        fetchConnections(1);\r\n      }\r\n    } catch (error) {\r\n      debugLog('MBA4321 Error creating invitation:', error);\r\n      setInviteError(error.response?.data?.error || 'Failed to send invitation. Please try again.');\r\n    } finally {\r\n      setIsInviting(false);\r\n    }\r\n  };\r\n\r\n  const handleCopyLink = () => {\r\n    if (generatedLink) {\r\n      navigator.clipboard.writeText(generatedLink);\r\n      setInviteSuccess('Link copied to clipboard!');\r\n    }\r\n  };\r\n\r\n  const EmptyStateMessage = ({ type }) => {\r\n    const messages = {\r\n      clients: {\r\n        all: \"You don't have any clients yet. Invite a client to get started!\",\r\n        active: \"You don't have any active clients.\",\r\n        pending: \"You don't have any pending client requests.\",\r\n        past: \"You don't have any past clients.\"\r\n      },\r\n      professionals: {\r\n        all: \"You're not connected with any professionals yet.\",\r\n        active: \"You don't have any active professionals.\",\r\n        pending: \"You don't have any pending professional connections.\",\r\n        past: \"You don't have any past professional connections.\"\r\n      }\r\n    };\r\n\r\n    return (\r\n      <View style={styles.emptyContainer}>\r\n        <MaterialCommunityIcons \r\n          name={type === 'clients' ? 'account-group-outline' : 'account-tie-outline'} \r\n          size={80} \r\n          color={theme.colors.primary} \r\n        />\r\n        <Text style={styles.emptyText}>{messages[type][activeFilter]}</Text>\r\n        {type === 'clients' && userRole === 'professional' && (\r\n          <TouchableOpacity \r\n            style={styles.inviteButton}\r\n            onPress={handleInviteClient}\r\n          >\r\n            <Text style={styles.inviteButtonText}>Invite Client</Text>\r\n          </TouchableOpacity>\r\n        )}\r\n      </View>\r\n    );\r\n  };\r\n\r\n  const renderFooter = () => {\r\n    if (isLoadingMore) {\r\n      debugLog('MBA4321 Loading more connections');\r\n      return (\r\n        <View style={styles.footer}>\r\n          <ActivityIndicator size=\"small\" color={theme.colors.primary} />\r\n        </View>\r\n      );\r\n    }\r\n    \r\n    if (!hasMore && connections.length > 0) {\r\n      debugLog('MBA4321 No more connections to load');\r\n      return (\r\n        <View style={styles.footer}>\r\n          <Text style={styles.footerText}>No more {activeTab} to load</Text>\r\n          {userRole === 'professional' && activeTab === 'clients' && (\r\n            <TouchableOpacity \r\n              style={[\r\n                styles.createServiceButton,\r\n                isCreateServiceButtonHovered && styles.buttonHovered\r\n              ]}\r\n              onPress={() => {\r\n                debugLog('MBA4321 Create Service button clicked in footer');\r\n                navigateToFrom(navigation, 'ServiceManager', 'Connections');\r\n              }}\r\n              onMouseEnter={() => deviceSupportsHover && setIsCreateServiceButtonHovered(true)}\r\n              onMouseLeave={() => deviceSupportsHover && setIsCreateServiceButtonHovered(false)}\r\n            >\r\n              <Text style={styles.createServiceButtonText}>Create a Service to Get More Clients</Text>\r\n            </TouchableOpacity>\r\n          )}\r\n        </View>\r\n      );\r\n    }\r\n    \r\n    return null;\r\n  };\r\n\r\n  const renderItem = ({ item }) => {\r\n    debugLog('MBA4321 Rendering connection item:', item);\r\n    return (\r\n      <View style={[\r\n        styles.cardWrapper,\r\n        isMobile && styles.mobileCardWrapper,\r\n        isWideScreen && styles.wideScreenCardWrapper\r\n      ]}>\r\n        <ConnectionCard\r\n          connection={item}\r\n          type={activeTab}\r\n          onViewProfile={() => handleViewMessages(item)}\r\n          onCreateBooking={activeTab === 'clients' ? () => handleCreateBooking(item) : null}\r\n        />\r\n      </View>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <View style={[\r\n      styles.container,\r\n      { marginLeft: isMobile ? 0 : (isCollapsed ? 70 : 250) }\r\n    ]}>\r\n      <View style={[styles.content, { marginTop: isMobile ? 60 : 0 }]}>\r\n        <View style={styles.mainContent}>\r\n          <View style={styles.headerSection}>\r\n            <Text style={styles.title}>Connections</Text>\r\n            <View style={styles.tabContainer}>\r\n              {userRole === 'professional' && (\r\n                <TouchableOpacity\r\n                  style={[styles.tab, activeTab === 'clients' && styles.activeTab]}\r\n                  onPress={() => setActiveTab('clients')}\r\n                >\r\n                  <Text style={[styles.tabText, activeTab === 'clients' && styles.activeTabText]}>\r\n                    My Clients\r\n                  </Text>\r\n                </TouchableOpacity>\r\n              )}\r\n              {/* My Professionals tab commented out until implementation\r\n              <TouchableOpacity\r\n                style={[styles.tab, activeTab === 'professionals' && styles.activeTab]}\r\n                onPress={() => setActiveTab('professionals')}\r\n              >\r\n                <Text style={[styles.tabText, activeTab === 'professionals' && styles.activeTabText]}>\r\n                  My Professionals\r\n                </Text>\r\n              </TouchableOpacity>\r\n              */}\r\n            </View>\r\n          </View>\r\n          <View style={styles.connectionsContent}>\r\n            {loading ? (\r\n              <View style={styles.loadingContainer}>\r\n                <ActivityIndicator size=\"large\" color={theme.colors.primary} />\r\n              </View>\r\n            ) : (\r\n              <View style={styles.connectionsContent}>\r\n                <View style={styles.stickyHeader}>\r\n                  <View style={[styles.stickyHeaderContent, { \r\n                    flexDirection: isWideScreen ? 'row' : 'column'\r\n                  }]}>\r\n                    <View style={[\r\n                      styles.searchAndInviteContainer,\r\n                      isWideScreen ? { flex: 0.4, marginRight: 'auto', flexDirection: 'row', alignItems: 'center' } : { flexDirection: 'row', alignItems: 'center' }\r\n                    ]}>\r\n                      <View style={[\r\n                        styles.searchContainer,\r\n                        searchFocused && styles.searchContainerFocused\r\n                      ]}>\r\n                        <MaterialCommunityIcons \r\n                          name=\"magnify\" \r\n                          size={24} \r\n                          color={searchFocused ? theme.colors.primary : \"#666\"} \r\n                        />\r\n                        <TextInput\r\n                          ref={searchInputRef}\r\n                          style={styles.searchInput}\r\n                          placeholder={activeTab === 'clients' \r\n                            ? \"Search by client name or pet\" \r\n                            : \"Search by professional name or service\"\r\n                          }\r\n                          value={searchQuery}\r\n                          onChangeText={handleSearch}\r\n                          onFocus={() => setSearchFocused(true)}\r\n                          onBlur={() => setSearchFocused(false)}\r\n                        />\r\n                        {searchQuery ? (\r\n                          <TouchableOpacity \r\n                            onPress={() => {\r\n                              setSearchQuery('');\r\n                              filterConnectionsLocally();\r\n                            }}\r\n                          >\r\n                            <MaterialCommunityIcons name=\"close-circle\" size={20} color=\"#777\" />\r\n                          </TouchableOpacity>\r\n                        ) : null}\r\n                      </View>\r\n                      \r\n                      {activeTab === 'clients' && userRole === 'professional' && (\r\n                        <TouchableOpacity \r\n                          style={[\r\n                            styles.inviteButtonSmall,\r\n                            isInviteButtonHovered && styles.buttonHovered\r\n                          ]}\r\n                          onPress={handleInviteClient}\r\n                          onMouseEnter={() => deviceSupportsHover && setIsInviteButtonHovered(true)}\r\n                          onMouseLeave={() => deviceSupportsHover && setIsInviteButtonHovered(false)}\r\n                        >\r\n                          <MaterialCommunityIcons name=\"account-plus\" size={16} color={theme.colors.surface} />\r\n                          <Text style={styles.inviteButtonSmallText}>Invite</Text>\r\n                        </TouchableOpacity>\r\n                      )}\r\n                    </View>\r\n\r\n                    <View style={[\r\n                      styles.filtersWrapper,\r\n                      isWideScreen ? { flex: 0.6, alignItems: 'flex-end' } : null\r\n                    ]}>\r\n                      <ScrollView \r\n                        horizontal \r\n                        showsHorizontalScrollIndicator={false}\r\n                        contentContainerStyle={styles.filterScrollContent}\r\n                      >\r\n                        <View style={styles.filterContainer}>\r\n                          <TouchableOpacity \r\n                            style={[\r\n                              styles.filterButton,\r\n                              styles.allButton,\r\n                              Platform.OS === 'web' && hoveredFilter === 'all' && styles.filterButtonHovered\r\n                            ]}\r\n                            onPress={() => setActiveFilter('all')}\r\n                            onMouseEnter={() => deviceSupportsHover && setHoveredFilter('all')}\r\n                            onMouseLeave={() => deviceSupportsHover && setHoveredFilter(null)}\r\n                          >\r\n                            <View style={styles.filterContent}>\r\n                              <MaterialCommunityIcons \r\n                                name=\"filter-variant\" \r\n                                size={16} \r\n                                color=\"#0784C6\" \r\n                              />\r\n                              <Text style={[styles.filterText, styles.allButtonText]}>\r\n                                All\r\n                              </Text>\r\n                              {activeFilter === 'all' && (\r\n                                <MaterialCommunityIcons \r\n                                  name=\"check\" \r\n                                  size={16} \r\n                                  color=\"#0784C6\" \r\n                                  style={styles.checkmark}\r\n                                />\r\n                              )}\r\n                            </View>\r\n                          </TouchableOpacity>\r\n                          <TouchableOpacity \r\n                            style={[\r\n                              styles.filterButton,\r\n                              styles.activeBookingsButton,\r\n                              Platform.OS === 'web' && hoveredFilter === 'active_bookings' && styles.filterButtonHovered\r\n                            ]}\r\n                            onPress={() => setActiveFilter('active_bookings')}\r\n                            onMouseEnter={() => deviceSupportsHover && setHoveredFilter('active_bookings')}\r\n                            onMouseLeave={() => deviceSupportsHover && setHoveredFilter(null)}\r\n                          >\r\n                            <View style={styles.filterContent}>\r\n                              <MaterialCommunityIcons \r\n                                name=\"calendar-check\" \r\n                                size={16} \r\n                                color=\"#4CAF50\"\r\n                              />\r\n                              <Text style={[styles.filterText, styles.activeBookingsButtonText]}>\r\n                                Active Bookings\r\n                              </Text>\r\n                              {activeFilter === 'active_bookings' && (\r\n                                <MaterialCommunityIcons \r\n                                  name=\"check\" \r\n                                  size={16} \r\n                                  color=\"#4CAF50\"\r\n                                  style={styles.checkmark}\r\n                                />\r\n                              )}\r\n                            </View>\r\n                          </TouchableOpacity>\r\n                          <TouchableOpacity \r\n                            style={[\r\n                              styles.filterButton,\r\n                              styles.noBookingsButton,\r\n                              Platform.OS === 'web' && hoveredFilter === 'no_bookings' && styles.filterButtonHovered\r\n                            ]}\r\n                            onPress={() => setActiveFilter('no_bookings')}\r\n                            onMouseEnter={() => deviceSupportsHover && setHoveredFilter('no_bookings')}\r\n                            onMouseLeave={() => deviceSupportsHover && setHoveredFilter(null)}\r\n                          >\r\n                            <View style={styles.filterContent}>\r\n                              <MaterialCommunityIcons \r\n                                name=\"calendar-remove\" \r\n                                size={16} \r\n                                color=\"#898974\"\r\n                              />\r\n                              <Text style={[styles.filterText, styles.noBookingsButtonText]}>\r\n                                No Bookings\r\n                              </Text>\r\n                              {activeFilter === 'no_bookings' && (\r\n                                <MaterialCommunityIcons \r\n                                  name=\"check\" \r\n                                  size={16} \r\n                                  color=\"#898974\"\r\n                                  style={styles.checkmark}\r\n                                />\r\n                              )}\r\n                            </View>\r\n                          </TouchableOpacity>\r\n                          <TouchableOpacity \r\n                            style={[\r\n                              styles.filterButton,\r\n                              styles.pastBookingsButton,\r\n                              Platform.OS === 'web' && hoveredFilter === 'past_bookings' && styles.filterButtonHovered\r\n                            ]}\r\n                            onPress={() => setActiveFilter('past_bookings')}\r\n                            onMouseEnter={() => deviceSupportsHover && setHoveredFilter('past_bookings')}\r\n                            onMouseLeave={() => deviceSupportsHover && setHoveredFilter(null)}\r\n                          >\r\n                            <View style={styles.filterContent}>\r\n                              <MaterialCommunityIcons \r\n                                name=\"history\" \r\n                                size={16} \r\n                                color=\"#9C27B0\"\r\n                              />\r\n                              <Text style={[styles.filterText, styles.pastBookingsButtonText]}>\r\n                                Past Bookings\r\n                              </Text>\r\n                              {activeFilter === 'past_bookings' && (\r\n                                <MaterialCommunityIcons \r\n                                  name=\"check\" \r\n                                  size={16} \r\n                                  color=\"#9C27B0\"\r\n                                  style={styles.checkmark}\r\n                                />\r\n                              )}\r\n                            </View>\r\n                          </TouchableOpacity>\r\n                        </View>\r\n                      </ScrollView>\r\n                    </View>\r\n                  </View>\r\n                </View>\r\n\r\n                {connections.length > 0 ? (\r\n                  <FlatList\r\n                    data={connections}\r\n                    renderItem={renderItem}\r\n                    keyExtractor={item => item.client_id.toString()}\r\n                    contentContainerStyle={styles.listContainer}\r\n                    onEndReached={handleLoadMore}\r\n                    onEndReachedThreshold={0.5}\r\n                    ListFooterComponent={renderFooter}\r\n                    ListHeaderComponent={<View style={[styles.listHeaderSpacing, { height: isWideScreen ? 130 : 190 }]} />}\r\n                    numColumns={isWideScreen ? 3 : (isMobile ? 1 : 2)}\r\n                    key={isWideScreen ? 'three-columns' : (isMobile ? 'one-column' : 'two-columns')}\r\n                    columnWrapperStyle={!isMobile && styles.columnWrapper}\r\n                  />\r\n                ) : searchQuery ? (\r\n                  <View style={styles.emptyContainer}>\r\n                    <View style={[styles.listHeaderSpacing, { height: isWideScreen ? 130 : 190 }]} />\r\n                    <MaterialCommunityIcons \r\n                      name=\"magnify-close\" \r\n                      size={80} \r\n                      color={theme.colors.placeholder} \r\n                    />\r\n                    <Text style={styles.emptyText}>\r\n                      No {activeTab} found matching \"{searchQuery}\"\r\n                    </Text>\r\n                    <TouchableOpacity \r\n                      style={styles.inviteButton}\r\n                      onPress={() => {\r\n                        setSearchQuery('');\r\n                        filterConnectionsLocally();\r\n                      }}\r\n                    >\r\n                      <Text style={styles.inviteButtonText}>Clear Search</Text>\r\n                    </TouchableOpacity>\r\n                  </View>\r\n                ) : (\r\n                  <EmptyStateMessage type={activeTab} />\r\n                )}\r\n              </View>\r\n            )}\r\n          </View>\r\n        </View>\r\n        \r\n        {/* Invite Client Modal */}\r\n        <Modal\r\n          visible={showInviteModal}\r\n          transparent={true}\r\n          animationType=\"fade\"\r\n          onRequestClose={() => setShowInviteModal(false)}\r\n        >\r\n          <View style={styles.modalOverlay}>\r\n            <View style={styles.modalContent}>\r\n              <View style={styles.modalHeader}>\r\n                <Text style={styles.modalTitle}>Invite Client</Text>\r\n                <TouchableOpacity \r\n                  style={styles.closeButton}\r\n                  onPress={() => setShowInviteModal(false)}\r\n                >\r\n                  <MaterialCommunityIcons name=\"close\" size={24} color=\"#666\" />\r\n                </TouchableOpacity>\r\n              </View>\r\n              \r\n              <Text style={styles.modalText}>\r\n                Invite a client to connect with you on CrittrCove. \r\n                You can either send them an email invitation or generate a link to share.\r\n              </Text>\r\n              \r\n              <View style={styles.inviteTypeToggle}>\r\n                <TouchableOpacity\r\n                  style={[\r\n                    styles.inviteTypeButton,\r\n                    invitationType === 'email' && styles.inviteTypeButtonActive\r\n                  ]}\r\n                  onPress={() => {\r\n                    setInvitationType('email');\r\n                    setInviteError('');\r\n                    setInviteSuccess('');\r\n                  }}\r\n                >\r\n                  <MaterialCommunityIcons \r\n                    name=\"email-outline\" \r\n                    size={20} \r\n                    color={invitationType === 'email' ? theme.colors.primary : \"#666\"} \r\n                  />\r\n                  <Text \r\n                    style={[\r\n                      styles.inviteTypeText,\r\n                      invitationType === 'email' && styles.inviteTypeTextActive\r\n                    ]}\r\n                  >\r\n                    Email Invitation\r\n                  </Text>\r\n                </TouchableOpacity>\r\n                \r\n                <TouchableOpacity\r\n                  style={[\r\n                    styles.inviteTypeButton,\r\n                    invitationType === 'link' && styles.inviteTypeButtonActive\r\n                  ]}\r\n                  onPress={() => {\r\n                    setInvitationType('link');\r\n                    setInviteError('');\r\n                    setInviteSuccess('');\r\n                  }}\r\n                >\r\n                  <MaterialCommunityIcons \r\n                    name=\"link-variant\" \r\n                    size={20} \r\n                    color={invitationType === 'link' ? theme.colors.primary : \"#666\"} \r\n                  />\r\n                  <Text \r\n                    style={[\r\n                      styles.inviteTypeText,\r\n                      invitationType === 'link' && styles.inviteTypeTextActive\r\n                    ]}\r\n                  >\r\n                    Generate Link\r\n                  </Text>\r\n                </TouchableOpacity>\r\n              </View>\r\n              \r\n              {invitationType === 'email' ? (\r\n                <View style={styles.inputContainer}>\r\n                  <Text style={styles.inputLabel}>Client's Email Address</Text>\r\n                  <TextInput\r\n                    style={styles.emailInput}\r\n                    placeholder=\"client@example.com\"\r\n                    value={inviteEmail}\r\n                    onChangeText={setInviteEmail}\r\n                    keyboardType=\"email-address\"\r\n                    autoCapitalize=\"none\"\r\n                  />\r\n                </View>\r\n              ) : generatedLink ? (\r\n                <View style={styles.linkContainer}>\r\n                  <Text style={styles.inputLabel}>Shareable Invitation Link</Text>\r\n                  <View style={styles.generatedLinkContainer}>\r\n                    <Text \r\n                      style={styles.generatedLink}\r\n                      numberOfLines={1}\r\n                      ellipsizeMode=\"middle\"\r\n                    >\r\n                      {generatedLink}\r\n                    </Text>\r\n                    {Platform.OS === 'web' && (\r\n                      <TouchableOpacity \r\n                        style={styles.copyButton}\r\n                        onPress={handleCopyLink}\r\n                      >\r\n                        <MaterialCommunityIcons name=\"content-copy\" size={20} color={theme.colors.primary} />\r\n                      </TouchableOpacity>\r\n                    )}\r\n                  </View>\r\n                </View>\r\n              ) : null}\r\n              \r\n              {inviteError ? (\r\n                <Text style={styles.errorText}>{inviteError}</Text>\r\n              ) : null}\r\n              \r\n              {inviteSuccess ? (\r\n                <Text style={styles.successText}>{inviteSuccess}</Text>\r\n              ) : null}\r\n              \r\n              <View style={styles.modalButtons}>\r\n                <TouchableOpacity\r\n                  style={styles.cancelButton}\r\n                  onPress={() => setShowInviteModal(false)}\r\n                >\r\n                  <Text style={styles.cancelButtonText}>Close</Text>\r\n                </TouchableOpacity>\r\n                \r\n                {!generatedLink || invitationType === 'email' ? (\r\n                  <TouchableOpacity\r\n                    style={[\r\n                      styles.sendInviteButton,\r\n                      (invitationType === 'email' && (!inviteEmail || !inviteEmail.includes('@'))) && styles.disabledButton,\r\n                      isInviting && styles.disabledButton\r\n                    ]}\r\n                    onPress={handleSendInvite}\r\n                    disabled={isInviting || (invitationType === 'email' && (!inviteEmail || !inviteEmail.includes('@')))}\r\n                  >\r\n                    {isInviting ? (\r\n                      <ActivityIndicator size=\"small\" color={theme.colors.surface} />\r\n                    ) : (\r\n                      <Text style={styles.sendInviteButtonText}>\r\n                        {invitationType === 'email' ? 'Send Invitation' : 'Generate Link'}\r\n                      </Text>\r\n                    )}\r\n                  </TouchableOpacity>\r\n                ) : null}\r\n              </View>\r\n            </View>\r\n          </View>\r\n        </Modal>\r\n      </View>\r\n    </View>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    height: '100vh',\r\n    backgroundColor: theme.colors.surface,\r\n    position: 'fixed',\r\n    top: 0,\r\n    right: 0,\r\n    bottom: 0,\r\n    left: 0,\r\n    overflow: 'hidden',\r\n    transition: 'margin-left 0.3s ease',\r\n  },\r\n  content: {\r\n    flex: 1,\r\n    height: '100%',\r\n    overflow: 'auto',\r\n  },\r\n  mainContent: {\r\n    flex: 1,\r\n    width: '100%',\r\n    alignSelf: 'center',\r\n    backgroundColor: theme.colors.background,\r\n    position: 'relative',\r\n  },\r\n  headerSection: {\r\n    width: '100%',\r\n    backgroundColor: theme.colors.surfaceContrast,\r\n    paddingHorizontal: 24,\r\n    paddingTop: 24,\r\n    zIndex: 2,\r\n  },\r\n  connectionsContent: {\r\n    flex: 1,\r\n    backgroundColor: theme.colors.surface,\r\n    position: 'relative',\r\n  },\r\n  title: {\r\n    fontSize: 32,\r\n    fontWeight: '600',\r\n    color: theme.colors.text,\r\n    marginBottom: 24,\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n  },\r\n  tabContainer: {\r\n    flexDirection: 'row',\r\n    gap: 32,\r\n  },\r\n  tab: {\r\n    paddingBottom: 8,\r\n    borderBottomWidth: 2,\r\n    borderBottomColor: 'transparent',\r\n  },\r\n  activeTab: {\r\n    borderBottomColor: theme.colors.primary,\r\n  },\r\n  tabText: {\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  activeTabText: {\r\n    color: theme.colors.primary,\r\n    fontWeight: '500',\r\n  },\r\n  stickyHeader: {\r\n    position: 'absolute',\r\n    top: 0,\r\n    left: 0,\r\n    right: 0,\r\n    backgroundColor: theme.colors.surfaceContrast,\r\n    zIndex: 2,\r\n    marginHorizontal: 24,\r\n    marginTop: 24,\r\n    shadowColor: '#000',\r\n    shadowOffset: { width: 0, height: 2 },\r\n    shadowOpacity: 0.1,\r\n    shadowRadius: 4,\r\n    borderRadius: 8,\r\n    padding: 16,\r\n  },\r\n  stickyHeaderContent: {\r\n    width: '100%',\r\n    gap: 16,\r\n  },\r\n  searchAndInviteContainer: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    gap: 12,\r\n  },\r\n  searchContainer: {\r\n    flex: 1,\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    backgroundColor: theme.colors.surfaceContrast,\r\n    borderRadius: 8,\r\n    padding: 12,\r\n    borderWidth: 1,\r\n    borderColor: '#CCCBC9',\r\n    minHeight: 48,\r\n  },\r\n  searchContainerFocused: {\r\n    borderColor: theme.colors.primary,\r\n    borderWidth: 2,\r\n    shadowColor: theme.colors.primary,\r\n    shadowOffset: { width: 0, height: 0 },\r\n    shadowOpacity: 0.1,\r\n    shadowRadius: 4,\r\n  },\r\n  searchInput: {\r\n    flex: 1,\r\n    color: '#666',\r\n    fontSize: 16,\r\n    marginLeft: 8,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    outlineStyle: 'none',\r\n    outlineWidth: 0,\r\n    WebkitAppearance: 'none',\r\n    padding: 0,\r\n    minHeight: 24,\r\n    ...(Platform.OS === 'web' && {\r\n      caretColor: theme.colors.primary,\r\n    }),\r\n  },\r\n  inviteButtonSmall: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    paddingVertical: 10,\r\n    paddingHorizontal: 12,\r\n    borderRadius: 8,\r\n    backgroundColor: theme.colors.primary,\r\n    gap: 6,\r\n    ...(Platform.OS === 'web' && {\r\n      transition: 'all 0.2s ease',\r\n      cursor: 'pointer',\r\n    })\r\n  },\r\n  inviteButtonSmallText: {\r\n    color: theme.colors.surface,\r\n    fontSize: 14,\r\n    fontWeight: '600',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  filtersWrapper: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'flex-end',\r\n    marginRight: -16,\r\n  },\r\n  filterScrollContent: {\r\n    flexGrow: 0,\r\n  },\r\n  filterContainer: {\r\n    flexDirection: 'row',\r\n    gap: 8,\r\n    backgroundColor: theme.colors.surfaceContrast,\r\n    paddingVertical: 8,\r\n    paddingLeft: 4,\r\n    paddingRight: 16,\r\n  },\r\n  filterButton: {\r\n    paddingHorizontal: 12,\r\n    paddingVertical: 6,\r\n    borderRadius: 16,\r\n    justifyContent: 'center',\r\n    ...(Platform.OS === 'web' && {\r\n      transition: 'all 0.2s ease-in-out',\r\n      cursor: 'pointer',\r\n    })\r\n  },\r\n  filterButtonHovered: {\r\n    transform: [{ scale: 1.05 }],\r\n    shadowColor: '#000',\r\n    shadowOffset: {\r\n      width: 0,\r\n      height: 2,\r\n    },\r\n    shadowOpacity: 0.1,\r\n    shadowRadius: 4,\r\n    elevation: 5,\r\n  },\r\n  filterContent: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    gap: 6,\r\n  },\r\n  checkmark: {\r\n    marginLeft: 4,\r\n  },\r\n  allButton: {\r\n    backgroundColor: '#EFF9FF',\r\n  },\r\n  allButtonText: {\r\n    color: '#0784C6',\r\n  },\r\n  activeBookingsButton: {\r\n    backgroundColor: '#E8F5E9',\r\n  },\r\n  activeBookingsButtonText: {\r\n    color: '#4CAF50',\r\n  },\r\n  noBookingsButton: {\r\n    backgroundColor: '#E8E9E2',\r\n  },\r\n  noBookingsButtonText: {\r\n    color: '#898974',\r\n  },\r\n  pastBookingsButton: {\r\n    backgroundColor: '#F3E5F5',\r\n  },\r\n  pastBookingsButtonText: {\r\n    color: '#9C27B0',\r\n  },\r\n  filterText: {\r\n    fontSize: 14,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    textAlign: 'center',\r\n  },\r\n  listHeaderSpacing: {\r\n    paddingTop: 16,\r\n  },\r\n  listContainer: {\r\n    paddingHorizontal: 24,\r\n    paddingBottom: 34,\r\n    alignItems: 'stretch',\r\n    width: '100%',\r\n  },\r\n  loadingContainer: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n  },\r\n  loadingMoreContainer: {\r\n    paddingVertical: 16,\r\n    alignItems: 'center',\r\n  },\r\n  emptyContainer: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    paddingHorizontal: 24,\r\n  },\r\n  emptyText: {\r\n    fontSize: 16,\r\n    color: theme.colors.placeholder,\r\n    textAlign: 'center',\r\n    marginTop: 8,\r\n    marginBottom: 24,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  inviteButton: {\r\n    backgroundColor: theme.colors.primary,\r\n    paddingHorizontal: 24,\r\n    paddingVertical: 12,\r\n    borderRadius: 8,\r\n    marginTop: 8,\r\n  },\r\n  inviteButtonText: {\r\n    color: theme.colors.surface,\r\n    fontSize: 16,\r\n    fontWeight: '600',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  footer: {\r\n    paddingVertical: 16,\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    width: '100%',\r\n  },\r\n  footerText: {\r\n    color: theme.colors.placeholder,\r\n    fontSize: 16,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    textAlign: 'center',\r\n    marginBottom: 12,\r\n  },\r\n  createServiceButton: {\r\n    paddingVertical: 10,\r\n    paddingHorizontal: 16,\r\n    backgroundColor: theme.colors.primary,\r\n    borderRadius: 8,\r\n    marginTop: 8,\r\n    ...(Platform.OS === 'web' && {\r\n      transition: 'all 0.2s ease',\r\n      cursor: 'pointer',\r\n    })\r\n  },\r\n  createServiceButtonText: {\r\n    color: theme.colors.surface,\r\n    fontSize: 16,\r\n    fontWeight: '600',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  modalOverlay: {\r\n    flex: 1,\r\n    backgroundColor: 'rgba(0, 0, 0, 0.5)',\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n  },\r\n  modalContent: {\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 12,\r\n    padding: 24,\r\n    width: '90%',\r\n    maxWidth: 500,\r\n    shadowColor: '#000',\r\n    shadowOffset: { width: 0, height: 2 },\r\n    shadowOpacity: 0.25,\r\n    shadowRadius: 4,\r\n    elevation: 5,\r\n  },\r\n  modalHeader: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    marginBottom: 16,\r\n  },\r\n  modalTitle: {\r\n    fontSize: 20,\r\n    fontWeight: '600',\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n  },\r\n  closeButton: {\r\n    padding: 4,\r\n  },\r\n  modalText: {\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n    marginBottom: 24,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    lineHeight: 24,\r\n  },\r\n  inviteTypeToggle: {\r\n    flexDirection: 'row',\r\n    gap: 12,\r\n    marginBottom: 24,\r\n  },\r\n  inviteTypeButton: {\r\n    flex: 1,\r\n    padding: 12,\r\n    borderWidth: 1,\r\n    borderColor: '#CCCBC9',\r\n    borderRadius: 8,\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    gap: 6,\r\n    ...(Platform.OS === 'web' && {\r\n      cursor: 'pointer',\r\n    }),\r\n  },\r\n  inviteTypeButtonActive: {\r\n    borderColor: theme.colors.primary,\r\n    backgroundColor: 'rgba(7, 132, 198, 0.05)',\r\n  },\r\n  inviteTypeText: {\r\n    fontSize: 16,\r\n    color: '#666',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  inviteTypeTextActive: {\r\n    color: theme.colors.primary,\r\n    fontWeight: '500',\r\n  },\r\n  inputContainer: {\r\n    marginBottom: 24,\r\n  },\r\n  inputLabel: {\r\n    fontSize: 16,\r\n    fontWeight: '500',\r\n    color: theme.colors.text,\r\n    marginBottom: 8,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  emailInput: {\r\n    borderWidth: 1,\r\n    borderColor: '#CCCBC9',\r\n    borderRadius: 8,\r\n    padding: 12,\r\n    fontSize: 16,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  linkContainer: {\r\n    marginBottom: 24,\r\n  },\r\n  generatedLinkContainer: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    gap: 12,\r\n    padding: 12,\r\n    borderWidth: 1,\r\n    borderColor: '#CCCBC9',\r\n    borderRadius: 8,\r\n    backgroundColor: 'rgba(0, 0, 0, 0.02)',\r\n  },\r\n  generatedLink: {\r\n    flex: 1,\r\n    color: theme.colors.text,\r\n    fontSize: 16,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  copyButton: {\r\n    padding: 8,\r\n    ...(Platform.OS === 'web' && {\r\n      cursor: 'pointer',\r\n    }),\r\n  },\r\n  errorText: {\r\n    color: theme.colors.error || '#D32F2F',\r\n    fontSize: 16,\r\n    marginBottom: 16,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  successText: {\r\n    color: theme.colors.success || '#4CAF50',\r\n    fontSize: 16,\r\n    marginBottom: 16,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  modalButtons: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'flex-end',\r\n    gap: 12,\r\n    marginTop: 8,\r\n  },\r\n  cancelButton: {\r\n    paddingVertical: 10,\r\n    paddingHorizontal: 16,\r\n    borderRadius: 8,\r\n    borderWidth: 1,\r\n    borderColor: '#CCCBC9',\r\n    backgroundColor: theme.colors.surface,\r\n    ...(Platform.OS === 'web' && {\r\n      cursor: 'pointer',\r\n    }),\r\n  },\r\n  cancelButtonText: {\r\n    color: theme.colors.text,\r\n    fontSize: 16,\r\n    fontWeight: '500',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  sendInviteButton: {\r\n    paddingVertical: 10,\r\n    paddingHorizontal: 16,\r\n    borderRadius: 8,\r\n    backgroundColor: theme.colors.primary,\r\n    minWidth: 140,\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    ...(Platform.OS === 'web' && {\r\n      cursor: 'pointer',\r\n    }),\r\n  },\r\n  sendInviteButtonText: {\r\n    color: theme.colors.surface,\r\n    fontSize: 16,\r\n    fontWeight: '600',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  disabledButton: {\r\n    backgroundColor: '#CCCCCC',\r\n    opacity: 0.7,\r\n    ...(Platform.OS === 'web' && {\r\n      cursor: 'not-allowed',\r\n    }),\r\n  },\r\n  columnWrapper: {\r\n    flexWrap: 'wrap',\r\n    justifyContent: 'space-between',\r\n    gap: 16,\r\n    width: '100%',\r\n  },\r\n  cardWrapper: {\r\n    flex: 1,\r\n    width: '100%',\r\n    marginBottom: 16,\r\n  },\r\n  mobileCardWrapper: {\r\n    maxWidth: '100%',\r\n  },\r\n  wideScreenCardWrapper: {\r\n    maxWidth: 'calc(50% - 11px)',\r\n    // width: 'calc(33.33% - 11px)',\r\n  },\r\n  buttonHovered: {\r\n    transform: [{translateY: -3}],\r\n    shadowColor: '#000',\r\n    shadowOffset: { width: 0, height: 6 },\r\n    shadowOpacity: 0.15,\r\n    shadowRadius: 10,\r\n    elevation: 5,\r\n  },\r\n});\r\n\r\nexport default Connections; ","import React, { useEffect, useState, useContext } from 'react';\r\nimport { Platform, View, Text, TouchableOpacity, StyleSheet } from 'react-native';\r\nimport { Provider as PaperProvider } from 'react-native-paper';\r\nimport { NavigationContainer } from '@react-navigation/native';\r\nimport { createStackNavigator, TransitionPresets } from '@react-navigation/stack';\r\nimport { createBottomTabNavigator } from '@react-navigation/bottom-tabs';\r\nimport Navigation from './src/components/Navigation';\r\nimport { theme } from './src/styles/theme';\r\nimport { AuthProvider, AuthContext, debugLog, getStorage, setStorage } from './src/context/AuthContext';\r\nimport { MessageNotificationProvider } from './src/context/MessageNotificationContext';\r\nimport { API_BASE_URL } from './src/config/config';\r\nimport AsyncStorage from '@react-native-async-storage/async-storage';\r\nimport { createNavigationContainerRef } from '@react-navigation/native';\r\nimport { Linking } from 'react-native';\r\nimport { useNavigation } from '@react-navigation/native';\r\nimport { navigateToFrom } from './src/components/Navigation';\r\nimport { TutorialProvider } from './src/context/TutorialContext';\r\nimport { ToastProvider } from './src/components/ToastProvider';\r\n\r\n// Import all your screen components\r\nimport HomeScreen from './src/screens/HomeScreen';\r\nimport AboutScreen from './src/screens/AboutScreen';\r\nimport MyProfile from './src/screens/MyProfile';\r\nimport SignIn from './src/screens/SignIn';\r\nimport SignUp from './src/screens/SignUp';\r\nimport ResetPassword from './src/screens/ResetPassword';\r\nimport ResetPasswordConfirm from './src/screens/ResetPasswordConfirm';\r\n// import Dashboard from './src/screens/Dashboard';\r\nimport Dashboard from './src/screens/Dashboard';\r\nimport BecomeProfessional from './src/screens/BecomeProfessional';\r\nimport MoreScreen from './src/screens/MoreScreen';\r\nimport AvailabilitySettings from './src/screens/AvailabilitySettings';\r\n// import Messages from './src/screens/Messages';\r\nimport OwnerHistory from './src/screens/OwnerHistory';\r\nimport MessageHistory from './src/screens/MessageHistory';\r\nimport Settings from './src/screens/Settings';\r\nimport PrivacyPolicy from './src/screens/PrivacyPolicy';\r\nimport ProfessionalSettings from './src/screens/ProfessionalSettings';\r\nimport TermsOfService from './src/screens/TermsOfService';\r\nimport HelpFAQ from './src/screens/HelpFAQ';\r\nimport ContactUs from './src/screens/ContactUs';\r\nimport Owners from './src/screens/Owners';\r\nimport ProfessionalProfile from './src/screens/ProfessionalProfile';\r\nimport MyContracts from './src/screens/MyContracts';\r\nimport ChangePassword from './src/screens/ChangePassword';\r\nimport SearchProfessionalsListing from './src/screens/SearchProfessionalsListing';\r\nimport MyBookings from './src/screens/MyBookings';\r\nimport ServiceManagerScreen from './src/screens/ServiceManagerScreen';\r\nimport BlogScreen from './src/screens/BlogScreen';\r\nimport BlogPost from './src/screens/BlogPost';\r\nimport Waitlist from './src/screens/Waitlist';\r\nimport TestToast from './src/screens/TestToast';\r\nimport Connections from './src/screens/Connections';\r\n\r\nconst Stack = createStackNavigator();\r\nconst Tab = createBottomTabNavigator();\r\n\r\nconst screens = [\r\n  { name: 'Home', component: HomeScreen },\r\n  { name: 'About', component: AboutScreen },\r\n  { name: 'MyProfile', component: MyProfile },  \r\n  { name: 'SignIn', component: SignIn },\r\n  { name: 'SignUp', component: SignUp },\r\n  { name: 'Invite', component: SignUp },\r\n  { name: 'ResetPassword', component: ResetPassword },\r\n  { name: 'ResetPasswordConfirm', component: ResetPasswordConfirm },\r\n  { name: 'SearchProfessionalsListing', component: SearchProfessionalsListing },\r\n  { name: 'OwnerHistory', component: OwnerHistory },\r\n  { name: 'MessageHistory', component: MessageHistory },\r\n  { name: 'Dashboard', component: Dashboard },\r\n  { name: 'BecomeProfessional', component: BecomeProfessional },\r\n  { name: 'More', component: MoreScreen },\r\n  { name: 'Owners', component: Owners },\r\n  { name: 'AvailabilitySettings', component: AvailabilitySettings },\r\n  { name: 'Settings', component: Settings },\r\n  { name: 'PrivacyPolicy', component: PrivacyPolicy },\r\n  { name: 'ProfessionalSettings', component: ProfessionalSettings },\r\n  { name: 'TermsOfService', component: TermsOfService },\r\n  { name: 'HelpFAQ', component: HelpFAQ },\r\n  { name: 'ContactUs', component: ContactUs },\r\n  { name: 'ProfessionalProfile', component: ProfessionalProfile },\r\n  { name: 'MyContracts', component: MyContracts },\r\n  { name: 'ChangePassword', component: ChangePassword },\r\n  { name: 'MyBookings', component: MyBookings },\r\n  { name: 'ServiceManager', component: ServiceManagerScreen },\r\n  { name: 'Blog', component: BlogScreen },\r\n  { name: 'BlogPost', component: BlogPost },\r\n  { name: 'Waitlist', component: Waitlist },\r\n  { name: 'TestToast', component: TestToast },\r\n  { name: 'Connections', component: Connections },\r\n];\r\n\r\nconst linking = {\r\n  enabled: true,\r\n  prefixes: [\r\n    'https://staging.crittrcove.com',\r\n    'http://staging.crittrcove.com',\r\n    `${API_BASE_URL}`\r\n  ],\r\n  config: {\r\n    screens: {\r\n      Home: '*',  // This will catch all unmatched routes\r\n      About: 'about',\r\n      MyProfile: 'my-profile',\r\n      SignIn: 'signin',\r\n      SignUp: {\r\n        path: 'signup/:token?',\r\n        parse: {\r\n          token: (token) => token || null\r\n        }\r\n      },\r\n      Invite: {\r\n        path: 'invite/:token',\r\n        exact: true,\r\n        parse: {\r\n          token: (token) => token\r\n        },\r\n        stringify: {\r\n          token: (token) => token\r\n        }\r\n      },\r\n      ResetPassword: 'reset-password',\r\n      ResetPasswordConfirm: 'reset-password/:uid/:token',\r\n      SearchProfessionalsListing: 'search-professionals-listing',\r\n      OwnerHistory: 'owner-history',\r\n      MessageHistory: {\r\n        path: 'message-history',\r\n        parse: {\r\n          messageId: (messageId) => messageId || null,\r\n          senderName: (senderName) => senderName || 'Unknown User'\r\n        }\r\n      },\r\n      Dashboard: 'Dashboard',\r\n      BecomeProfessional: 'become-professional',\r\n      More: 'more',\r\n      Owners: 'owners',\r\n      AvailabilitySettings: 'availability-settings',\r\n      Settings: 'settings',\r\n      PrivacyPolicy: 'privacy-policy',\r\n      ProfessionalSettings: 'professional-settings',\r\n      TermsOfService: 'terms-of-service',\r\n      HelpFAQ: 'help-faq',\r\n      ContactUs: 'contact-us',\r\n      ProfessionalProfile: {\r\n        path: 'professional-profile',\r\n        parse: {\r\n          professional: (professional) => undefined\r\n        }\r\n      },\r\n      MyContracts: 'my-contracts',\r\n      ChangePassword: 'change-password',\r\n      MyBookings: 'my-bookings',\r\n      ServiceManager: 'service-manager',\r\n      Blog: 'blog',\r\n      BlogPost: 'blog-post',\r\n      Waitlist: 'waitlist',\r\n      TestToast: 'test-toast',\r\n      Connections: 'connections',\r\n    }\r\n  }\r\n};\r\n\r\n\r\nexport const navigationRef = createNavigationContainerRef();\r\n\r\nexport function navigate(name, params) {\r\n  if (navigationRef.isReady()) {\r\n    navigationRef.navigate(name, params);\r\n  }\r\n}\r\n\r\nfunction TabNavigator() {\r\n  return (\r\n    <Tab.Navigator tabBar={props => <Navigation {...props} />}>\r\n      {screens.map(screen => (\r\n        <Tab.Screen \r\n          key={screen.name}\r\n          name={screen.name} \r\n          component={screen.component} \r\n          options={{ headerShown: false }} \r\n        />\r\n      ))}\r\n    </Tab.Navigator>\r\n  );\r\n}\r\n\r\nconst MVPWarning = () => {\r\n  const [isVisible, setIsVisible] = useState(true);\r\n  const navigation = useNavigation();\r\n\r\n  useEffect(() => {\r\n    const checkBannerStatus = async () => {\r\n      const hidden = await getStorage('mvp_banner_hidden');\r\n      if (hidden === 'true') {\r\n        setIsVisible(false);\r\n      }\r\n    };\r\n    checkBannerStatus();\r\n  }, []);\r\n\r\n  const hideBanner = async () => {\r\n    await setStorage('mvp_banner_hidden', 'true');\r\n    setIsVisible(false);\r\n  };\r\n\r\n  if (!isVisible) return null;\r\n\r\n  return (\r\n    <View style={styles.warningBanner}>\r\n      <View style={styles.warningContent}>\r\n        <TouchableOpacity \r\n          style={styles.closeButton}\r\n          onPress={hideBanner}\r\n        >\r\n          <Text style={styles.closeButtonText}>✕</Text>\r\n        </TouchableOpacity>\r\n        <Text style={styles.warningText}>\r\n          🚧 MVP MODE: Features are still under development.\r\n        </Text>\r\n        <TouchableOpacity \r\n          style={styles.waitlistButton}\r\n          onPress={() => navigateToFrom(navigation, 'Waitlist', 'Home')}\r\n        >\r\n          <Text style={styles.waitlistButtonText}>Join Waitlist</Text>\r\n        </TouchableOpacity>\r\n      </View>\r\n    </View>\r\n  );\r\n};\r\n\r\nfunction AppContent() {\r\n  const authContext = useContext(AuthContext);\r\n  const { checkAuthStatus, is_DEBUG } = authContext;\r\n  const [initialRoute, setInitialRoute] = useState(null);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [isVisible, setIsVisible] = useState(true);\r\n  const [inviteToken, setInviteToken] = useState(null);\r\n\r\n  // Check for invitation in the URL\r\n  useEffect(() => {\r\n    if (Platform.OS === 'web') {\r\n      const url = window.location.pathname;\r\n      if (authContext.debugLog) {\r\n        authContext.debugLog('MBA6666 App - Current URL path:', url);\r\n      }\r\n      \r\n      if (url.includes('/invite/')) {\r\n        const pathParts = url.split('/');\r\n        const inviteIndex = pathParts.findIndex(part => part === 'invite');\r\n        if (inviteIndex !== -1 && pathParts.length > inviteIndex + 1) {\r\n          const token = pathParts[inviteIndex + 1];\r\n          if (authContext.debugLog) {\r\n            authContext.debugLog('MBA6666 Found invitation token in URL:', token);\r\n          }\r\n          setInviteToken(token);\r\n        }\r\n      }\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const initializeApp = async () => {\r\n      try {\r\n        const authStatus = await checkAuthStatus();\r\n        let route = 'Home';\r\n\r\n        // If we have an invite token, go to SignUp\r\n        if (inviteToken) {\r\n          if (authContext.debugLog) {\r\n            authContext.debugLog('MBA6666 Setting initial route to SignUp with token:', inviteToken);\r\n          }\r\n          route = 'SignUp';\r\n        }\r\n        // Only change route if user is authenticated and no invite token\r\n        else if (authStatus.isAuthenticated) {\r\n          route = authStatus.userRole === 'professional' ? 'Dashboard' : 'Home';\r\n        }\r\n\r\n        setInitialRoute(route);\r\n      } catch (error) {\r\n        console.error('Error initializing app:', error);\r\n        setInitialRoute(inviteToken ? 'SignUp' : 'Home');\r\n      } finally {\r\n        setIsLoading(false);\r\n      }\r\n    };\r\n\r\n    initializeApp();\r\n  }, [inviteToken]);\r\n\r\n  // Handle route changes without triggering auth checks\r\n  useEffect(() => {\r\n    if (!isLoading && initialRoute && Platform.OS !== 'web') {\r\n      AsyncStorage.setItem('lastRoute', initialRoute)\r\n        .catch(error => console.error('Error storing route:', error));\r\n    }\r\n  }, [initialRoute, isLoading]);\r\n\r\n  if (isLoading || !initialRoute) {\r\n    return null; // Or a loading spinner component\r\n  }\r\n\r\n  return (\r\n    <>\r\n      {/* {isVisible && <MVPWarning />} */}\r\n      {Platform.OS === 'web' ? (\r\n        <Stack.Navigator\r\n          initialRouteName={initialRoute}\r\n          screenOptions={{\r\n            headerShown: true,\r\n            header: ({ navigation }) => <Navigation navigation={navigation} />,\r\n            ...TransitionPresets.SlideFromRightIOS,\r\n            presentation: 'card',\r\n            animation: 'slide_from_right'\r\n          }}\r\n        >\r\n          {screens.map(screen => (\r\n            <Stack.Screen \r\n              key={screen.name}\r\n              name={screen.name} \r\n              component={screen.component}\r\n              options={{\r\n                headerShown: true,\r\n                animation: 'slide_from_right'\r\n              }}\r\n            />\r\n          ))}\r\n        </Stack.Navigator>\r\n      ) : (\r\n        <TabNavigator />\r\n      )}\r\n    </>\r\n  );\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    height: '100%',\r\n  },\r\n  warningBanner: {\r\n    backgroundColor: '#ffebee',\r\n    padding: Platform.OS === 'web' ? 12 : 10,\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: '#ef5350',\r\n    width: '100%',\r\n    flexShrink: 0, // Prevent banner from shrinking\r\n  },\r\n  warningContent: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    justifyContent: 'space-between',\r\n    flexWrap: 'wrap',\r\n    gap: 10,\r\n    maxWidth: 1200,\r\n    marginHorizontal: 'auto',\r\n    width: '100%',\r\n  },\r\n  warningText: {\r\n    color: '#c62828',\r\n    textAlign: 'center',\r\n    fontSize: Platform.OS === 'web' ? 15 : 14,\r\n    flexShrink: 1,\r\n    flex: 1,\r\n    marginHorizontal: 15,\r\n  },\r\n  waitlistButton: {\r\n    backgroundColor: '#ef5350',\r\n    paddingHorizontal: 15,\r\n    paddingVertical: 8,\r\n    borderRadius: 20,\r\n    marginLeft: 'auto',\r\n  },\r\n  waitlistButtonText: {\r\n    color: 'white',\r\n    fontSize: Platform.OS === 'web' ? 14 : 13,\r\n    fontWeight: '600',\r\n  },\r\n  closeButton: {\r\n    width: 24,\r\n    height: 24,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    marginRight: 5,\r\n  },\r\n  closeButtonText: {\r\n    color: '#c62828',\r\n    fontSize: 18,\r\n    fontWeight: '600',\r\n  },\r\n});\r\n\r\nexport default function App() {\r\n  return (\r\n    <NavigationContainer\r\n      ref={navigationRef}\r\n      linking={linking}\r\n      onStateChange={async (state) => {\r\n        if (Platform.OS !== 'web' && state?.routes?.length > 0) {\r\n          const currentRoute = state.routes[state.routes.length - 1].name;\r\n          await AsyncStorage.setItem('lastRoute', currentRoute)\r\n            .catch(error => console.error('Error storing route:', error));\r\n        }\r\n      }}\r\n    >\r\n      <AuthProvider>\r\n        <MessageNotificationProvider>\r\n          <TutorialProvider>\r\n            <PaperProvider theme={theme}>\r\n              <ToastProvider>\r\n                <AppContent />\r\n              </ToastProvider>\r\n            </PaperProvider>\r\n          </TutorialProvider>\r\n        </MessageNotificationProvider>\r\n      </AuthProvider>\r\n    </NavigationContainer>\r\n  );\r\n}\r\n\r\n","import React from 'react';\r\nimport { View } from 'react-native';\r\nimport { Text } from 'react-native-paper';\r\n\r\nexport default function AboutScreen() {\r\n  return (\r\n    <View style={{ flex: 1, justifyContent: 'center', alignItems: 'center' }}>\r\n      <Text>About Screen</Text>\r\n    </View>\r\n  );\r\n}","import axios from 'axios';\r\nimport { API_BASE_URL } from '../config/config';\r\nimport { debugLog } from '../context/AuthContext';\r\nimport { Platform } from 'react-native';\r\nimport { convertToUTC, formatDateForAPI, formatTimeForAPI } from '../utils/time_utils';\r\n\r\n// Get all professional services for service manager screen\r\nexport const getProfessionalServices = async () => {\r\n  try {\r\n    debugLog('MBA7890: Fetching professional services');\r\n    \r\n    const response = await axios.get(`${API_BASE_URL}/api/services/v1/professional/services/`);\r\n    \r\n    return response.data;\r\n  } catch (error) {\r\n    debugLog('MBA7890: Error fetching professional services:', error);\r\n    debugLog('MBA7890: Error details:', error.response?.data || error.message);\r\n    throw error;\r\n  }\r\n};\r\n\r\n// Get all available services for a pro and\r\n// return the selected ones in the draft\r\nexport const getBookingAvailableServices = async (bookingId) => {\r\n  try {\r\n    const response = await axios.get(\r\n      `${API_BASE_URL}/api/booking_drafts/v1/${bookingId}/available_services/`\r\n    );\r\n    return response.data;\r\n  } catch (error) {\r\n    debugLog('MBA12345 Error fetching available services:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\nexport const getBookingAvailablePets = async (bookingId) => {\r\n  try {\r\n    const response = await axios.get(\r\n      `${API_BASE_URL}/api/booking_drafts/v1/${bookingId}/available_pets/`\r\n    );\r\n    return response.data;\r\n  } catch (error) {\r\n    debugLog('MBA12345 Error fetching available pets:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\nexport const approveBooking = async (bookingId) => {\r\n  try {\r\n    const response = await axios.post(\r\n      `${API_BASE_URL}/api/bookings/v1/${bookingId}/approve/`,\r\n      {}  // Empty body since we don't need to send any data\r\n    );\r\n    return response.data;\r\n  } catch (error) {\r\n    debugLog('Error approving booking:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Get detailed booking information by ID\r\n * @param {string|number} bookingId - ID of the booking to retrieve\r\n * @returns {Promise<Object>} - Detailed booking information\r\n */\r\nexport const getBookingDetails = async (bookingId) => {\r\n  try {\r\n    debugLog('MBA88899', 'Fetching booking details for ID:', bookingId);\r\n\r\n    const response = await axios.get(\r\n      `${API_BASE_URL}/api/bookings/v1/${bookingId}/details/`\r\n    );\r\n    \r\n    debugLog('MBA88899', 'Booking details fetched successfully');\r\n    return response.data;\r\n  } catch (error) {\r\n    debugLog('MBA88899', 'Error fetching booking details:', error.response?.data || error.message);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Request changes to a booking\r\n * @param {string|number} bookingId - ID of the booking to request changes for\r\n * @param {string} message - Message explaining the requested changes\r\n * @returns {Promise<Object>} - Response from the API\r\n */\r\nexport const requestBookingChanges = async (bookingId, message) => {\r\n  try {\r\n    debugLog('MBA88899 Requesting changes for booking ID:', bookingId);\r\n    debugLog('MBA88899 Change request message:', message);\r\n    \r\n    const response = await axios.post(\r\n      `${API_BASE_URL}/api/bookings/v1/${bookingId}/request-changes/`,\r\n      { message }\r\n    );\r\n    \r\n    debugLog('MBA88899 Change request submitted successfully');\r\n    return response.data;\r\n  } catch (error) {\r\n    debugLog('MBA88899 Error requesting booking changes:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\nexport const updateBookingDraftPetsAndServices = async (draftId, data) => {\r\n  try {\r\n    const response = await axios.patch(\r\n      `${API_BASE_URL}/api/booking_drafts/v1/${draftId}/update_pets_and_services/`,\r\n      data\r\n    );\r\n\r\n    debugLog('MBA12345 Draft update response:', response.data);\r\n\r\n    return response.data;\r\n  } catch (error) {\r\n    debugLog('MBA12345 Error updating booking draft:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\nexport const updateBookingDraftTimeAndDate = async (draftId, startDate, endDate, startTime, endTime) => {\r\n    try {\r\n        debugLog('MBA5asdt3f4321 - Updating booking draft time and date:', {\r\n            draftId,\r\n            startDate,\r\n            endDate,\r\n            startTime,\r\n            endTime\r\n        });\r\n\r\n        const response = await axios.post(\r\n            `${API_BASE_URL}/api/booking_drafts/v1/update-time-and-date/${draftId}/`,\r\n            {\r\n                start_date: startDate,\r\n                end_date: endDate,\r\n                start_time: startTime,\r\n                end_time: endTime\r\n            }\r\n        );\r\n\r\n        debugLog('MBA5asdt3f4321 - Booking draft time and date update response:', response.data);\r\n        return response.data;\r\n    } catch (error) {\r\n        debugLog('MBA5asdt3f4321 Error updating booking draft time and date:', error);\r\n        throw error;\r\n    }\r\n};\r\n\r\nexport const updateBookingDraftMultipleDays = async (draftId, data, timeSettings) => {\r\n    try {\r\n        // Get the user's timezone from timeSettings, with fallback to US/Mountain\r\n        const userTimezone = timeSettings?.timezone || 'US/Mountain';\r\n        \r\n        debugLog('MBA8800: Updating booking draft multiple days:', {\r\n            draftId,\r\n            data,\r\n            userTimezone\r\n        });\r\n\r\n        // Handle different formats of dates array\r\n        const utcDates = data.dates.map(dateItem => {\r\n            // Check what format the date is in\r\n            let dateStr, startTimeStr, endTimeStr, endDateStr;\r\n            let isServiceOvernight = false;\r\n            \r\n            // If the dateItem already has date and times (from non-overnight date range)\r\n            if (dateItem.date && dateItem.start_time && dateItem.end_time) {\r\n                debugLog('MBA8800: Using provided occurrence data format', dateItem);\r\n                return {\r\n                    date: dateItem.date,\r\n                    startTime: dateItem.start_time,\r\n                    endDate: dateItem.end_date || dateItem.date, // Always include endDate\r\n                    endTime: dateItem.end_time,\r\n                    is_overnight: dateItem.is_overnight || false\r\n                };\r\n            }\r\n            \r\n            // If the dateItem already has date and times (formatted in BookingStepModal)\r\n            if (dateItem.date && dateItem.startTime && dateItem.endTime) {\r\n                debugLog('MBA8800: Using provided date and times', dateItem);\r\n                return {\r\n                    date: dateItem.date,\r\n                    startTime: dateItem.startTime,\r\n                    endDate: dateItem.endDate || dateItem.date, // Always include endDate\r\n                    endTime: dateItem.endTime,\r\n                    is_overnight: dateItem.is_overnight || false\r\n                };\r\n            }\r\n            \r\n            // For multiple days format from DateSelectionCard\r\n            if (dateItem instanceof Date) {\r\n                // Format the date for API\r\n                dateStr = formatDateForAPI(dateItem);\r\n                \r\n                // Determine which time to use - if individual times exist, use those\r\n                let dayTimes = data.times;\r\n                const dateKey = dateItem.toISOString().split('T')[0];\r\n                \r\n                if (data.times[dateKey] && data.times.hasIndividualTimes) {\r\n                    dayTimes = data.times[dateKey];\r\n                }\r\n                \r\n                // Get the time strings\r\n                if (typeof dayTimes.startTime === 'string') {\r\n                    startTimeStr = dayTimes.startTime;\r\n                } else if (dayTimes.startTime?.hours !== undefined) {\r\n                    startTimeStr = `${String(dayTimes.startTime.hours).padStart(2, '0')}:${String(dayTimes.startTime.minutes || 0).padStart(2, '0')}`;\r\n                } else {\r\n                    // Default time if missing\r\n                    startTimeStr = '09:00';\r\n                }\r\n                \r\n                if (typeof dayTimes.endTime === 'string') {\r\n                    endTimeStr = dayTimes.endTime;\r\n                } else if (dayTimes.endTime?.hours !== undefined) {\r\n                    endTimeStr = `${String(dayTimes.endTime.hours).padStart(2, '0')}:${String(dayTimes.endTime.minutes || 0).padStart(2, '0')}`;\r\n                } else {\r\n                    // Default time if missing\r\n                    endTimeStr = '17:00';\r\n                }\r\n                \r\n                debugLog('MBA8800: Formatted times for date:', dateKey, { startTimeStr, endTimeStr });\r\n                \r\n                // Determine if the end time might cross to the next day\r\n                // Check if end time is midnight or earlier than start time, indicating day boundary crossing\r\n                const isMidnightEnd = endTimeStr === '00:00';\r\n                const isTimeBeforeStart = \r\n                    (parseInt(endTimeStr.split(':')[0], 10) < parseInt(startTimeStr.split(':')[0], 10)) ||\r\n                    (parseInt(endTimeStr.split(':')[0], 10) === parseInt(startTimeStr.split(':')[0], 10) && \r\n                     parseInt(endTimeStr.split(':')[1], 10) < parseInt(startTimeStr.split(':')[1], 10));\r\n                \r\n                const needsNextDayDate = isMidnightEnd || isTimeBeforeStart;\r\n                \r\n                // Calculate end date - either same day or next day\r\n                const endDateObj = needsNextDayDate \r\n                  ? new Date(dateItem.getTime() + 24*60*60*1000) // Next day if crossing midnight\r\n                  : new Date(dateItem);\r\n                \r\n                endDateStr = formatDateForAPI(endDateObj);\r\n                \r\n                debugLog('MBA8800: End date calculation in API.js:', {\r\n                  needsNextDayDate,\r\n                  isMidnightEnd,\r\n                  isTimeBeforeStart,\r\n                  startTimeStr,\r\n                  endTimeStr,\r\n                  originalDate: dateStr,\r\n                  calculatedEndDate: endDateStr\r\n                });\r\n                \r\n                // Set overnight based on service, not just time\r\n                isServiceOvernight = dayTimes.isOvernightForced || false;\r\n            } else {\r\n                // If the data is in some other format, we need to extract the date and times\r\n                debugLog('MBA8800: Unexpected date format', dateItem);\r\n                throw new Error('Unexpected date format');\r\n            }\r\n            \r\n            // Convert to UTC using user's timezone\r\n            const { date: utcStartDate, time: utcStartTime } = convertToUTC(\r\n                dateStr,\r\n                startTimeStr,\r\n                userTimezone\r\n            );\r\n\r\n            const { date: utcEndDate, time: utcEndTime } = convertToUTC(\r\n                endDateStr || dateStr, // Use endDateStr if available, otherwise use dateStr\r\n                endTimeStr,\r\n                userTimezone\r\n            );\r\n\r\n            return {\r\n                date: utcStartDate,\r\n                startTime: utcStartTime,\r\n                endDate: utcEndDate, // Always include endDate\r\n                endTime: utcEndTime,\r\n                is_overnight: isServiceOvernight\r\n            };\r\n        });\r\n\r\n        debugLog('MBA8800: Converted UTC dates:', utcDates);\r\n\r\n        const response = await axios.post(\r\n            `${API_BASE_URL}/api/booking_drafts/v1/update-multiple-days/${draftId}/`,\r\n            { dates: utcDates }\r\n        );\r\n\r\n        debugLog('MBA8800: Booking draft multiple days update response:', response.data);\r\n        return response.data;\r\n    } catch (error) {\r\n        debugLog('MBA8800: Error updating booking draft multiple days:', error);\r\n        throw error;\r\n    }\r\n};\r\n\r\nexport const updateBookingDraftRecurring = async (draftId, recurringData) => {\r\n    try {\r\n        debugLog('MBA5asdt3f4321 - Updating booking draft recurring dates:', {\r\n            draftId,\r\n            recurringData\r\n        });\r\n\r\n        const response = await axios.post(\r\n            `${API_BASE_URL}/api/booking_drafts/v1/update-recurring/${draftId}/`,\r\n            recurringData\r\n        );\r\n\r\n        debugLog('MBA5asdt3f4321 - Booking draft recurring update response:', response.data);\r\n        return response.data;\r\n    } catch (error) {\r\n        debugLog('MBA5asdt3f4321 Error updating booking draft recurring dates:', error);\r\n        throw error;\r\n    }\r\n};\r\n\r\n/**\r\n * Get user's time settings (timezone and military time preference)\r\n * @returns {Promise<Object>} Object containing timezone and use_military_time\r\n */\r\nexport const getTimeSettings = async () => {\r\n  try {\r\n    const response = await axios.get(\r\n      `${API_BASE_URL}/api/users/v1/time-settings/`\r\n    );\r\n    return response.data;\r\n  } catch (error) {\r\n    debugLog('MBA12345 Error fetching time settings', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Update user's time settings\r\n * @param {Object} settings - Object containing timezone and/or use_military_time\r\n * @returns {Promise<Object>} Updated time settings\r\n */\r\nexport const updateTimeSettings = async (settings) => {\r\n  try {\r\n    // Ensure settings is an object\r\n    const data = typeof settings === 'object' ? settings : { timezone: settings };\r\n    \r\n    debugLog('MBA12345 Sending time settings update', data);\r\n\r\n    const response = await axios.post(\r\n      `${API_BASE_URL}/api/users/v1/update-time-settings/`,\r\n      data\r\n    );\r\n    return response.data;\r\n  } catch (error) {\r\n    debugLog('MBA12345 Error updating time settings', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Get user's name from the backend\r\n * @returns {Promise<Object>} Object containing name and first_name\r\n */\r\nexport const getUserName = async () => {\r\n  try {\r\n    const response = await axios.get(\r\n      `${API_BASE_URL}/api/users/v1/get-name/`\r\n    );\r\n    return response.data;\r\n  } catch (error) {\r\n    debugLog('MBA12345 Error fetching user name', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Get user profile data\r\n * @returns {Promise<Object>} - User profile data\r\n */\r\nexport const userProfile = async () => {\r\n  try {\r\n    debugLog('MBA12345', 'Fetching user profile data');\r\n    \r\n    const response = await axios.get(`${API_BASE_URL}/api/users/v1/profile/`);\r\n    \r\n    debugLog('MBA12345', 'User profile data fetched successfully:', {\r\n      name: response.data.name,\r\n      email: response.data.email,\r\n      address: response.data.address\r\n    });\r\n    \r\n    return response.data;\r\n  } catch (error) {\r\n    debugLog('MBA12345', 'Error in userProfile:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Update user profile information\r\n * @param {Object} profileData - Data to update in the user profile\r\n * @returns {Promise<Object>} - Only the updated fields\r\n */\r\nexport const updateProfileInfo = async (profileData) => {\r\n  try {\r\n    debugLog('MBA76543', 'Updating profile info with data:', profileData);\r\n    \r\n    // Handle FormData differently than JSON\r\n    const isFormData = profileData instanceof FormData;\r\n    \r\n    debugLog('MBA76543', `Making ${isFormData ? 'FormData' : 'JSON'} request to update profile`);\r\n    \r\n    const config = {\r\n      method: 'patch',\r\n      url: `${API_BASE_URL}/api/users/v1/update-profile/`,\r\n      data: profileData\r\n    };\r\n    \r\n    // Only set content-type for non-FormData\r\n    if (!isFormData) {\r\n      config.headers = { 'Content-Type': 'application/json' };\r\n    }\r\n    \r\n    const response = await axios(config);\r\n    \r\n    debugLog('MBA76543', 'Profile updated successfully with response:', response.data);\r\n    return response.data;\r\n  } catch (error) {\r\n    debugLog('MBA76543', 'Error updating profile info:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Add a new pet to the user's account\r\n * This function sends pet data to the backend to create a new pet record\r\n * @param {Object} petData - Object containing the pet details\r\n * @returns {Promise<Object>} - Created pet data from the backend\r\n */\r\nexport const addPet = async (petData) => {\r\n  try {\r\n    debugLog('MBA789', 'Adding new pet with data:', petData);\r\n\r\n    const response = await axios.post(\r\n      `${API_BASE_URL}/api/pets/v1/add-pet/`,\r\n      petData\r\n    );\r\n    \r\n    debugLog('MBA789', 'Pet added successfully:', response.data);\r\n    \r\n    // Return the data in a standardized format\r\n    return response.data;\r\n  } catch (error) {\r\n    debugLog('MBA789', 'Error adding pet:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Update an existing pet\r\n * This function sends updated pet data to the backend to update an existing pet record\r\n * @param {string|number} petId - The ID of the pet to update\r\n * @param {Object} petData - Object containing the updated pet details\r\n * @returns {Promise<Object>} - Updated pet data from the backend\r\n */\r\nexport const updatePet = async (petId, petData) => {\r\n  try {\r\n    debugLog('MBA789', 'Updating pet with ID:', petId, 'and data:', petData);\r\n\r\n    const response = await axios.patch(\r\n      `${API_BASE_URL}/api/pets/v1/${petId}/`,\r\n      petData\r\n    );\r\n    \r\n    debugLog('MBA789', 'Pet updated successfully:', response.data);\r\n    return response.data;\r\n  } catch (error) {\r\n    debugLog('MBA789', 'Error updating pet:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Fix the owner of a pet by assigning the current user\r\n * This is used to repair pets that have a null owner field\r\n * @param {string|number} petId - The ID of the pet to fix\r\n * @returns {Promise<Object>} - Updated pet data from the backend\r\n */\r\nexport const fixPetOwner = async (petId) => {\r\n  try {\r\n    debugLog('MBA789', 'Fixing owner for pet with ID:', petId);\r\n\r\n    const response = await axios.post(\r\n      `${API_BASE_URL}/api/pets/v1/${petId}/fix-owner/`,\r\n      {}\r\n    );\r\n    \r\n    debugLog('MBA789', 'Pet owner fixed successfully:', response.data);\r\n    return response.data;\r\n  } catch (error) {\r\n    debugLog('MBA789', 'Error fixing pet owner:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Delete a pet from the user's account\r\n * This function sends a DELETE request to remove a pet record\r\n * @param {string|number} petId - The ID of the pet to delete\r\n * @returns {Promise<Object>} - Success response from the backend\r\n */\r\nexport const deletePet = async (petId) => {\r\n  try {\r\n    debugLog('MBA789', 'Deleting pet with ID:', petId);\r\n\r\n    const response = await axios.delete(\r\n      `${API_BASE_URL}/api/pets/v1/${petId}/`\r\n    );\r\n    \r\n    debugLog('MBA789', 'Pet deleted successfully:', response.data);\r\n    return response.data;\r\n  } catch (error) {\r\n    debugLog('MBA789', 'Error deleting pet:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Creates a new professional service\r\n * @param {Object} serviceData - Data for the new service\r\n * @returns {Promise<Object>} - The created service data\r\n */\r\nexport const createService = async (serviceData) => {\r\n  try {\r\n    // Log the data we're sending to the server\r\n    debugLog('MBA54321', 'Creating new service - sending data to backend:', serviceData);\r\n\r\n    // Format animal_types as a dictionary mapping animal types to their categories\r\n    let formattedAnimalTypes = {};\r\n    \r\n    if (serviceData.animal_types && Array.isArray(serviceData.animal_types)) {\r\n      // Convert array format to dictionary\r\n      serviceData.animal_types.forEach(animal => {\r\n        if (typeof animal === 'object' && animal.name && animal.category) {\r\n          formattedAnimalTypes[animal.name] = animal.category;\r\n        } else if (typeof animal === 'string') {\r\n          formattedAnimalTypes[animal] = 'Other';\r\n        }\r\n      });\r\n    } else if (serviceData.animal_types && typeof serviceData.animal_types === 'object') {\r\n      // If it's already a dictionary, use it directly\r\n      formattedAnimalTypes = serviceData.animal_types;\r\n    } else if (serviceData.animal_type) {\r\n      // Fallback to legacy single animal_type\r\n      formattedAnimalTypes[serviceData.animal_type] = 'Other';\r\n    } else {\r\n      // Default\r\n      formattedAnimalTypes['Other'] = 'Other';\r\n    }\r\n    \r\n    // Format additional rates to ensure rate values are strings\r\n    const formattedAdditionalRates = (serviceData.additional_rates || []).map(rate => ({\r\n      ...rate,\r\n      rate: String(rate.rate)\r\n    }));\r\n    \r\n    // Make sure all numeric values are properly formatted as strings to avoid type issues\r\n    const formattedData = {\r\n      ...serviceData,\r\n      base_rate: String(serviceData.base_rate),\r\n      additional_animal_rate: String(serviceData.additional_animal_rate || 0),\r\n      holiday_rate: String(serviceData.holiday_rate || 0),\r\n      animal_types: formattedAnimalTypes,\r\n      additional_rates: formattedAdditionalRates\r\n    };\r\n    \r\n    // Log we're sending the additional rates too\r\n    debugLog('MBA54321', 'Sending additional rates to backend:', formattedData.additional_rates);\r\n\r\n    const response = await axios.post(`${API_BASE_URL}/api/services/v1/create/`, formattedData);\r\n\r\n    debugLog('MBA54321', 'Service created successfully - backend response:', response.data);\r\n    return response.data;\r\n  } catch (error) {\r\n    debugLog('MBA54321', 'Error creating service:', error);\r\n    debugLog('MBA54321', 'Error response data:', error.response?.data);\r\n    \r\n    // Rethrow the original error - axios interceptor will handle auth errors\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Delete a service by ID\r\n * @param {number} serviceId - ID of the service to delete\r\n * @returns {Promise<Object>} Response data with success message or error details\r\n */\r\nexport const deleteService = async (serviceId) => {\r\n  try {\r\n    debugLog('MBA7890: Deleting service with ID:', serviceId);\r\n\r\n    const response = await axios.delete(`${API_BASE_URL}/api/services/v1/delete/${serviceId}/`);\r\n\r\n    debugLog('MBA7890: Service deleted successfully - backend response:', response.data);\r\n    return response.data;\r\n  } catch (error) {\r\n    debugLog('MBA7890: Error deleting service:', error);\r\n    debugLog('MBA7890: Error response data:', error.response?.data);\r\n    throw error;\r\n  }\r\n};\r\n\r\n// Function to update an existing service\r\nexport const updateService = async (serviceData) => {\r\n  try {\r\n    debugLog('API updateService', 'Updating service with data:', serviceData);\r\n    \r\n    const response = await axios.patch(`${API_BASE_URL}/api/services/v1/update/${serviceData.service_id}/`, serviceData);\r\n    \r\n    debugLog('API updateService Response:', response.data);\r\n    return response.data;\r\n  } catch (error) {\r\n    debugLog('API updateService Error:', error.response?.data || error.message);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Get professional's client connections, returning necessary client data\r\n * @param {number} page - Page number for pagination\r\n * @returns {Promise<Object>} Object containing connections and pagination info\r\n */\r\nexport const getUserConnections = async (page = 1) => {\r\n  try {\r\n    debugLog('MBA4321 Fetching client connections, page:', page);\r\n    \r\n    const response = await axios.get(`${API_BASE_URL}/api/bookings/v1/connections/`, {\r\n      params: {\r\n        page\r\n      }\r\n    });\r\n    \r\n    debugLog('MBA4321 Connections response:', response.data);\r\n    \r\n    return response.data;\r\n  } catch (error) {\r\n    debugLog('MBA4321 Error fetching connections:', error);\r\n    debugLog('MBA4321 Error details:', error.response?.data || error.message);\r\n    \r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Get profile details for a specific connection\r\n * @param {string} userId - The ID of the user to get profile details for\r\n * @param {string} type - The type of connection ('client' or 'professional')\r\n * @returns {Promise<Object>} Object containing detailed profile info\r\n */\r\nexport const getConnectionProfile = async (userId, type = 'client') => {\r\n  try {\r\n    debugLog('MBA4321 Fetching connection profile:', { userId, type });\r\n    \r\n    const response = await axios.get(`${API_BASE_URL}/api/connections/v1/profile/${userId}/`, {\r\n      params: { type }\r\n    });\r\n    \r\n    debugLog('MBA4321 Connection profile response:', response.data);\r\n    \r\n    return response.data;\r\n  } catch (error) {\r\n    debugLog('MBA4321 Error fetching connection profile:', error);\r\n    debugLog('MBA4321 Error details:', error.response?.data || error.message);\r\n    \r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Invite a client to connect with a professional via email or link\r\n * \r\n * @param {string} type - Type of invitation: 'email' or 'link'\r\n * @param {string} email - The email address of the client to invite (required if type is 'email')\r\n * @returns {Promise<Object>} Object containing result of invitation, including invitation_link for link invitations\r\n */\r\nexport const inviteClient = async (type = 'email', email = null) => {\r\n  try {\r\n    debugLog('MBA4321 Inviting client:', { type, email });\r\n    \r\n    const response = await axios.post(`${API_BASE_URL}/api/users/v1/invitations/`, {\r\n      type,\r\n      email,\r\n      is_professional_invite: true\r\n    });\r\n    \r\n    debugLog('MBA4321 Invite client response:', response.data);\r\n    \r\n    return response.data;\r\n  } catch (error) {\r\n    debugLog('MBA4321 Error inviting client:', error);\r\n    debugLog('MBA4321 Error details:', error.response?.data || error.message);\r\n    \r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Send a referral to invite someone to join CrittrCove\r\n * \r\n * @param {string} type - Type of invitation: 'email' or 'link'\r\n * @param {string} email - The email address to refer (required if type is 'email')\r\n * @param {string} referralType - The type of referral: 'client_to_client', 'client_to_professional', or 'professional_to_professional'\r\n * @returns {Promise<Object>} Object containing result of referral, including invitation_link for link referrals\r\n */\r\nexport const sendReferral = async (type = 'email', email = null, referralType) => {\r\n  try {\r\n    debugLog('MBA4321 Sending referral:', { type, email, referralType });\r\n    \r\n    const response = await axios.post(`${API_BASE_URL}/api/users/v1/invitations/`, {\r\n      type,\r\n      email,\r\n      is_professional_invite: false,\r\n      referral_type: referralType\r\n    });\r\n    \r\n    debugLog('MBA4321 Send referral response:', response.data);\r\n    \r\n    return response.data;\r\n  } catch (error) {\r\n    debugLog('MBA4321 Error sending referral:', error);\r\n    debugLog('MBA4321 Error details:', error.response?.data || error.message);\r\n    \r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Get a list of all invitations created by the current user\r\n * \r\n * @param {string} type - Type of invitations to fetch: 'all', 'professional', or 'referral'\r\n * @returns {Promise<Array>} Array of invitation objects\r\n */\r\nexport const getInvitations = async (type = 'all') => {\r\n  try {\r\n    debugLog('MBA4321 Getting invitations:', { type });\r\n    \r\n    const response = await axios.get(`${API_BASE_URL}/api/users/v1/invitations/?type=${type}`);\r\n    \r\n    debugLog('MBA4321 Get invitations response:', response.data);\r\n    \r\n    return response.data;\r\n  } catch (error) {\r\n    debugLog('MBA4321 Error getting invitations:', error);\r\n    debugLog('MBA4321 Error details:', error.response?.data || error.message);\r\n    \r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Get details of a specific invitation\r\n * \r\n * @param {string} token - The invitation token\r\n * @returns {Promise<Object>} Invitation details\r\n */\r\nexport const getInvitationDetails = async (token) => {\r\n  try {\r\n    debugLog('MBA4321 Getting invitation details:', { token });\r\n    \r\n    const response = await axios.get(`${API_BASE_URL}/api/users/v1/invitations/${token}/`);\r\n    \r\n    debugLog('MBA4321 Get invitation details response:', response.data);\r\n    \r\n    return response.data;\r\n  } catch (error) {\r\n    debugLog('MBA4321 Error getting invitation details:', error);\r\n    debugLog('MBA4321 Error details:', error.response?.data || error.message);\r\n    \r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Verify if an invitation is valid\r\n * This endpoint doesn't require authentication\r\n * \r\n * @param {string} token - The invitation token\r\n * @returns {Promise<Object>} Object with valid flag and invitation details\r\n */\r\nexport const verifyInvitation = async (token) => {\r\n  try {\r\n    debugLog('MBA4321 Verifying invitation:', { token });\r\n    debugLog('MBA4321 Verification endpoint:', `${API_BASE_URL}/api/users/v1/invitations/${token}/verify/`);\r\n    \r\n    // Don't use the authenticated API client since this doesn't require auth\r\n    const response = await axios.get(`${API_BASE_URL}/api/users/v1/invitations/${token}/verify/`);\r\n    \r\n    debugLog('MBA4321 Verify invitation response:', response.data);\r\n    \r\n    return response.data;\r\n  } catch (error) {\r\n    debugLog('MBA4321 Error verifying invitation:', error);\r\n    debugLog('MBA4321 Error details:', error.response?.data || error.message);\r\n    \r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Accept an invitation and create a connection between client and professional\r\n * \r\n * @param {string} token - The invitation token\r\n * @returns {Promise<Object>} Result of accepting the invitation\r\n */\r\nexport const acceptInvitation = async (token) => {\r\n  try {\r\n    debugLog('MBA4321 Accepting invitation:', { token });\r\n    \r\n    const response = await axios.post(`${API_BASE_URL}/api/users/v1/invitations/${token}/accept/`);\r\n    \r\n    debugLog('MBA4321 Accept invitation response:', response.data);\r\n    \r\n    return response.data;\r\n  } catch (error) {\r\n    debugLog('MBA4321 Error accepting invitation:', error);\r\n    debugLog('MBA4321 Error details:', error.response?.data || error.message);\r\n    \r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Delete/cancel an invitation\r\n * \r\n * @param {string} token - The invitation token\r\n * @returns {Promise<void>}\r\n */\r\nexport const deleteInvitation = async (token) => {\r\n  try {\r\n    debugLog('MBA4321 Deleting invitation:', { token });\r\n    \r\n    await axios.delete(`${API_BASE_URL}/api/users/v1/invitations/${token}/`);\r\n    \r\n    debugLog('MBA4321 Delete invitation success');\r\n    \r\n    return true;\r\n  } catch (error) {\r\n    debugLog('MBA4321 Error deleting invitation:', error);\r\n    debugLog('MBA4321 Error details:', error.response?.data || error.message);\r\n    \r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Resend an invitation email\r\n * \r\n * @param {string} token - The invitation token\r\n * @returns {Promise<Object>} Result of resending the invitation\r\n */\r\nexport const resendInvitation = async (token) => {\r\n  try {\r\n    debugLog('MBA4321 Resending invitation:', { token });\r\n    \r\n    const response = await axios.post(`${API_BASE_URL}/api/users/v1/invitations/${token}/resend/`);\r\n    \r\n    debugLog('MBA4321 Resend invitation response:', response.data);\r\n    \r\n    return response.data;\r\n  } catch (error) {\r\n    debugLog('MBA4321 Error resending invitation:', error);\r\n    debugLog('MBA4321 Error details:', error.response?.data || error.message);\r\n    \r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Update booking draft rates and recalculate cost summary\r\n * @param {string} draftId - The ID of the booking draft to update\r\n * @param {Array} occurrences - Array of occurrence objects with updated rates\r\n * @returns {Promise<Object>} Updated draft data\r\n */\r\nexport const updateBookingDraftRates = async (draftId, occurrences) => {\r\n    try {\r\n        debugLog('MBA98765 - Updating booking draft rates:', {\r\n            draftId,\r\n            occurrences\r\n        });\r\n\r\n        const response = await axios.post(\r\n            `${API_BASE_URL}/api/booking_drafts/v1/update-rates/${draftId}/`,\r\n            {\r\n                occurrences\r\n            }\r\n        );\r\n\r\n        debugLog('MBA98765 - Booking draft rates update response:', response.data);\r\n        return response.data;\r\n    } catch (error) {\r\n        debugLog('MBA98765 Error updating booking draft rates:', error);\r\n        throw error;\r\n    }\r\n};\r\n\r\n/**\r\n * Create a booking from a draft\r\n * Called when the professional confirms a booking from the booking step modal\r\n * @param {string} conversationId - The ID of the conversation containing the draft\r\n * @returns {Promise<Object>} Response containing the new booking information and message\r\n */\r\nexport const createBookingFromDraft = async (conversationId) => {\r\n    try {\r\n        debugLog('MBA66777 - Creating booking from draft:', {\r\n            conversationId\r\n        });\r\n\r\n        const response = await axios.post(\r\n            `${API_BASE_URL}/api/bookings/v1/create-from-draft/`,\r\n            {\r\n                conversation_id: conversationId\r\n            }\r\n        );\r\n\r\n        debugLog('MBA66777 - Booking created from draft:', response.data);\r\n        return response.data;\r\n    } catch (error) {\r\n        debugLog('MBA66777 Error creating booking from draft:', error);\r\n        throw error;\r\n    }\r\n};\r\n\r\n/**\r\n * Gets the dates and times for a booking draft\r\n * @param {string} draftId - The ID of the draft\r\n * @returns {Promise<Object>} - Draft dates and times data\r\n */\r\nexport const getBookingDraftDatesAndTimes = async (draftId) => {\r\n  try {\r\n    debugLog('MBA9876: Fetching booking draft dates and times:', draftId);\r\n    \r\n    const response = await axios.get(\r\n      `${API_BASE_URL}/api/booking_drafts/v1/${draftId}/dates_and_times/`\r\n    );\r\n    \r\n    debugLog('MBA9876: Draft dates and times fetched successfully');\r\n    return response.data;\r\n  } catch (error) {\r\n    debugLog('MBA9876: Error fetching booking draft dates and times:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Creates a draft from an existing booking for editing purposes\r\n * @param {number} bookingId - The ID of the booking to create a draft from\r\n * @returns {Promise<Object>} Response containing the draft ID and draft data\r\n */\r\nexport const createDraftFromBooking = async (bookingId) => {\r\n  try {\r\n    debugLog('MBA6428: Creating draft from booking:', { bookingId });\r\n    \r\n    const response = await axios.post(\r\n      `${API_BASE_URL}/api/booking_drafts/v1/create-from-booking/${bookingId}/`,\r\n      {}  // No body needed for this request\r\n    );\r\n    \r\n    debugLog('MBA6428: Draft created successfully:', response.data);\r\n    return response.data;\r\n  } catch (error) {\r\n    debugLog('MBA6428: Error creating draft from booking:', error);\r\n    // Return a structured error object instead of throwing\r\n    if (error.response?.data) {\r\n      return {\r\n        error: true,\r\n        status: error.response.status,\r\n        message: error.response.data.error || 'Failed to create draft from booking',\r\n        data: error.response.data\r\n      };\r\n    }\r\n    // Still throw for network errors or other unexpected issues\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Search for professionals based on various criteria\r\n * @param {Object} searchParams - Search parameters\r\n * @param {Array} searchParams.animal_types - Array of animal types (e.g., ['dogs', 'cats'])\r\n * @param {string} searchParams.location - Location string (city, zip, etc.)\r\n * @param {string} searchParams.service_query - Service search query\r\n * @param {boolean} searchParams.overnight_service - Whether overnight service is required\r\n * @param {number} searchParams.price_min - Minimum price\r\n * @param {number} searchParams.price_max - Maximum price\r\n * @param {number} searchParams.radius_miles - Search radius in miles (default 30)\r\n * @param {number} searchParams.page - Page number for pagination (default 1)\r\n * @param {number} searchParams.page_size - Number of results per page (default 20)\r\n * @returns {Promise<Object>} - Search results with professionals array and pagination info\r\n */\r\nexport const searchProfessionals = async (searchParams = {}) => {\r\n  try {\r\n    debugLog('MBA9999', 'Searching professionals with params:', searchParams);\r\n    \r\n    const response = await axios.post(`${API_BASE_URL}/api/professionals/v1/search/`, searchParams);\r\n    \r\n    debugLog('MBA9999', 'Professional search completed successfully');\r\n    return response.data;\r\n  } catch (error) {\r\n    debugLog('MBA9999', 'Error searching professionals:', error.response?.data || error.message);\r\n    \r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Get detailed services for a specific professional (for client view)\r\n * @param {number} professionalId - The ID of the professional\r\n * @returns {Promise<Array>} - Array of detailed service objects with rates and descriptions\r\n */\r\nexport const getProfessionalServicesDetailed = async (professionalId) => {\r\n  try {\r\n    debugLog('MBA9999', 'Getting detailed services for professional:', professionalId);\r\n    \r\n    const response = await axios.get(`${API_BASE_URL}/api/professionals/v1/services/${professionalId}/`);\r\n    \r\n    debugLog('MBA9999', 'Professional services fetched successfully');\r\n    return response.data;\r\n  } catch (error) {\r\n    debugLog('MBA9999', 'Error fetching professional services:', error.response?.data || error.message);\r\n    \r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Create a conversation between the current user (client) and a professional\r\n * @param {number} professionalId - The ID of the professional to contact\r\n * @returns {Promise<Object>} - Object containing conversation_id, is_professional, and other_user_name\r\n */\r\nexport const createConversation = async (professionalId) => {\r\n  try {\r\n    debugLog('MBA3456', 'Creating conversation with professional:', professionalId);\r\n    \r\n    const response = await axios.post(`${API_BASE_URL}/api/conversations/v1/create/`, {\r\n      professional_id: professionalId\r\n    });\r\n    \r\n    debugLog('MBA3456', 'Conversation created successfully:', response.data);\r\n    return response.data;\r\n  } catch (error) {\r\n    debugLog('MBA3456', 'Error creating conversation:', error.response?.data || error.message);\r\n    \r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Get count of unread messages for the current user\r\n * @returns {Promise<Object>} - Object containing unread message count\r\n */\r\nexport const getUnreadMessageCount = async () => {\r\n  try {\r\n    debugLog(\"MBA4321: Fetching unread message count\");\r\n    \r\n    const response = await axios.get(`${API_BASE_URL}/api/messages/v1/unread-count/`);\r\n    \r\n    debugLog(\"MBA4321: Unread count fetched:\", response.data);\r\n    return response.data;\r\n  } catch (error) {\r\n    debugLog(\"MBA4321: Error with unread message count:\", error.message);\r\n    \r\n    throw error;\r\n  }\r\n};\r\n\r\n","import React, { useState, useContext, useEffect } from 'react';\r\nimport { View, Text, StyleSheet, TouchableOpacity, Dimensions, Platform, SafeAreaView, Image } from 'react-native';\r\nimport { MaterialCommunityIcons, MaterialIcons } from '@expo/vector-icons';\r\nimport { theme } from '../styles/theme';\r\nimport { AuthContext, debugLog, getStorage, setStorage } from '../context/AuthContext';\r\nimport MessageNotificationContext from '../context/MessageNotificationContext';\r\nimport AsyncStorage from '@react-native-async-storage/async-storage';\r\nimport { Appbar, Menu, useTheme, Avatar } from 'react-native-paper';\r\nimport { useNavigation, useRoute } from '@react-navigation/native';\r\nimport { BackHandler } from 'react-native';\r\nimport Animated, { useSharedValue, useAnimatedStyle, withTiming, interpolate } from 'react-native-reanimated';\r\n\r\nlet previousRoute, currentRoute;\r\n\r\nexport const handleBack = async (navigation) => {\r\n  try {\r\n    // Get previous and current routes from storage\r\n    const previousRoute = await getStorage('previousRoute');\r\n    const currentRoute = await getStorage('currentRoute');\r\n    \r\n    debugLog('MBAuieo2o34nf handleBack - routes from storage', { previousRoute, currentRoute });\r\n    \r\n    if (previousRoute) {\r\n      // Get the active tab from the previous route if it exists\r\n      const activeTab = await getStorage('MyProfileActiveTab');\r\n      debugLog('MBAuieo2o34nf handleBack - active tab from storage', { activeTab });\r\n      \r\n      // Navigate to the previous route\r\n      if (previousRoute === 'MyProfile' && activeTab) {\r\n        navigation.navigate(previousRoute, { initialTab: activeTab });\r\n      } else {\r\n        navigation.navigate(previousRoute);\r\n      }\r\n      \r\n      // Update storage with new current and previous routes\r\n      await setStorage('currentRoute', previousRoute);\r\n      await setStorage('previousRoute', currentRoute);\r\n      \r\n      debugLog('MBAuieo2o34nf handleBack - navigation complete', { \r\n        newCurrentRoute: previousRoute,\r\n        newPreviousRoute: currentRoute\r\n      });\r\n    } else {\r\n      // If no previous route, go to More screen\r\n      navigation.navigate('Dashboard');\r\n      debugLog('MBAuieo2o34nf handleBack - no previous route, going to More');\r\n    }\r\n  } catch (error) {\r\n    debugLog('MBAuieo2o34nf handleBack - error', error);\r\n    // If there's an error, go to More screen\r\n    navigation.navigate('Dashboard');\r\n  }\r\n};\r\n\r\nexport const navigateToFrom = async (navigation, toLocation, fromLocation, params = {}) => {\r\n  try {\r\n    // Store current route as previous before navigation\r\n    const currentRoute = await getStorage('currentRoute');\r\n    await setStorage('previousRoute', currentRoute);\r\n    \r\n    // Special handling for MyProfile screen\r\n    if (toLocation === 'MyProfile') {\r\n      const activeTab = await getStorage('MyProfileActiveTab');\r\n      if (activeTab) {\r\n        params.initialTab = activeTab;\r\n      }\r\n    }\r\n    \r\n    // Navigate to the new screen\r\n    navigation.navigate(toLocation, params);\r\n    \r\n    // Update current route in storage\r\n    await setStorage('currentRoute', toLocation);\r\n    \r\n    debugLog('MBAuieo2o34nf navigateToFrom - navigation complete', {\r\n      from: fromLocation,\r\n      to: toLocation,\r\n      params,\r\n      previousRoute: currentRoute,\r\n      newCurrentRoute: toLocation\r\n    });\r\n  } catch (error) {\r\n    debugLog('MBAuieo2o34nf navigateToFrom - error', error);\r\n  }\r\n};\r\n\r\nexport default function Navigation({ state, descriptors, navigation }) {\r\n  const [visible, setVisible] = useState(false);\r\n  const [isMobile, setIsMobile] = useState(Dimensions.get('window').width < 900);\r\n  const [isMenuOpen, setIsMenuOpen] = useState(false);\r\n  const { colors } = useTheme();\r\n  const { \r\n    isSignedIn, \r\n    is_DEBUG, \r\n    userRole, \r\n    isCollapsed, \r\n    setIsCollapsed, \r\n    switchRole, \r\n    screenWidth, \r\n    signOut,\r\n    isApprovedProfessional \r\n  } = useContext(AuthContext);\r\n  \r\n  // Get message notification state\r\n  const {\r\n    hasUnreadMessages,\r\n    unreadCount,\r\n    resetNotifications,\r\n    updateRoute\r\n  } = useContext(MessageNotificationContext);\r\n  \r\n  const [currentRoute, setCurrentRoute] = useState('');\r\n  const [notificationCount, setNotificationCount] = useState(3); // We can make this dynamic later\r\n\r\n  // Animation values for hamburger menu\r\n  const line1Rotation = useSharedValue(0);\r\n  const line2Opacity = useSharedValue(1);\r\n  const line3Rotation = useSharedValue(0);\r\n  const line1TranslateY = useSharedValue(0);\r\n  const line3TranslateY = useSharedValue(0);\r\n\r\n  // Animated hamburger menu component\r\n  const AnimatedHamburgerMenu = ({ size = 28, color = theme.colors.text }) => {\r\n    const line1Style = useAnimatedStyle(() => ({\r\n      width: size,\r\n      height: 3,\r\n      backgroundColor: color,\r\n      marginVertical: 2,\r\n      borderRadius: 1.5,\r\n      transform: [\r\n        { translateY: line1TranslateY.value },\r\n        { rotate: `${line1Rotation.value}deg` }\r\n      ],\r\n    }));\r\n\r\n    const line2Style = useAnimatedStyle(() => ({\r\n      width: size,\r\n      height: 3,\r\n      backgroundColor: color,\r\n      marginVertical: 2,\r\n      borderRadius: 1.5,\r\n      opacity: line2Opacity.value,\r\n    }));\r\n\r\n    const line3Style = useAnimatedStyle(() => ({\r\n      width: size,\r\n      height: 3,\r\n      backgroundColor: color,\r\n      marginVertical: 2,\r\n      borderRadius: 1.5,\r\n      transform: [\r\n        { translateY: line3TranslateY.value },\r\n        { rotate: `${line3Rotation.value}deg` }\r\n      ],\r\n    }));\r\n\r\n    return (\r\n      <View style={{ alignItems: 'center', justifyContent: 'center' }}>\r\n        <Animated.View style={line1Style} />\r\n        <Animated.View style={line2Style} />\r\n        <Animated.View style={line3Style} />\r\n      </View>\r\n    );\r\n  };\r\n\r\n  // Animation function for hamburger menu\r\n  const animateHamburgerMenu = (toX) => {\r\n    const duration = 300;\r\n    \r\n    debugLog('MBA4477: Animating hamburger menu', { toX, isMenuOpen });\r\n    \r\n    if (toX) {\r\n      // Transform to X\r\n      line1Rotation.value = withTiming(45, { duration });\r\n      line2Opacity.value = withTiming(0, { duration });\r\n      line3Rotation.value = withTiming(-45, { duration });\r\n      line1TranslateY.value = withTiming(7, { duration });\r\n      line3TranslateY.value = withTiming(-7, { duration });\r\n    } else {\r\n      // Transform back to hamburger\r\n      line1Rotation.value = withTiming(0, { duration });\r\n      line2Opacity.value = withTiming(1, { duration });\r\n      line3Rotation.value = withTiming(0, { duration });\r\n      line1TranslateY.value = withTiming(0, { duration });\r\n      line3TranslateY.value = withTiming(0, { duration });\r\n    }\r\n  };\r\n\r\n  // Add effect to log state changes\r\n  useEffect(() => {\r\n    if (is_DEBUG) {\r\n      console.log('MBA98386196v Navigation State Update:', {\r\n        isSignedIn,\r\n        userRole,\r\n        isApprovedProfessional,\r\n        currentRoute\r\n      });\r\n    }\r\n  }, [isSignedIn, userRole, isApprovedProfessional, currentRoute]);\r\n\r\n  // Update animation when menu state changes\r\n  useEffect(() => {\r\n    animateHamburgerMenu(isMenuOpen);\r\n  }, [isMenuOpen]);\r\n\r\n  const openMenu = () => setVisible(true);\r\n  const closeMenu = () => setVisible(false);\r\n  const toggleMenu = () => setIsMenuOpen(!isMenuOpen);\r\n\r\n  useEffect(() => {\r\n    const updateLayout = () => {\r\n      setIsMobile(Dimensions.get('window').width < 900);\r\n    };\r\n\r\n    const subscription = Dimensions.addEventListener('change', updateLayout);\r\n\r\n    return () => {\r\n      subscription?.remove();\r\n    };\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const updateCurrentRoute = async () => {\r\n      try {\r\n        let route;\r\n        \r\n        route = await getStorage('currentRoute');\r\n        \r\n        // Only log in debug mode, not every time\r\n        if (is_DEBUG && route !== currentRoute) {\r\n          console.log('MBA98386196v Current Route Updated:', route);\r\n        }\r\n        \r\n        // Only update if the route has actually changed\r\n        if (route && route !== currentRoute) {\r\n          setCurrentRoute(route);\r\n          \r\n          // Update message notification context with new route\r\n          // Avoiding infinite loops by checking if the route changed\r\n          updateRoute && updateRoute(route);\r\n          \r\n          // Only reset notifications when navigating to MessageHistory\r\n          if (route === 'MessageHistory' && hasUnreadMessages) {\r\n            resetNotifications && resetNotifications(route);\r\n          }\r\n        }\r\n      } catch (error) {\r\n        console.error('Error updating current route:', error);\r\n      }\r\n    };\r\n\r\n    updateCurrentRoute();\r\n    // Add navigation state listener\r\n    const unsubscribe = navigation.addListener('state', updateCurrentRoute);\r\n    return unsubscribe;\r\n  }, [navigation, resetNotifications, updateRoute, hasUnreadMessages, is_DEBUG]);\r\n\r\n  // Listen for browser back/forward navigation and update currentRoute\r\n  useEffect(() => {\r\n    if (Platform.OS === 'web') {\r\n      const handlePopState = async () => {\r\n        const route = await getStorage('currentRoute');\r\n        debugLog('MBAuieo2o34nf popstate detected, updating currentRoute from storage', { route });\r\n        if (route && route !== currentRoute) {\r\n          setCurrentRoute(route);\r\n          updateRoute && updateRoute(route);\r\n        }\r\n      };\r\n      window.addEventListener('popstate', handlePopState);\r\n      return () => window.removeEventListener('popstate', handlePopState);\r\n    }\r\n  }, [currentRoute, updateRoute]);\r\n\r\n  // Sync currentRoute in storage with navigation state changes\r\n  useEffect(() => {\r\n    const updateCurrentRouteInStorage = async () => {\r\n      try {\r\n        const navState = navigation.getState && navigation.getState();\r\n        let routeName = '';\r\n        if (navState) {\r\n          const route = navState.routes[navState.index];\r\n          routeName = route?.name || '';\r\n        }\r\n        if (routeName) {\r\n          await setStorage('currentRoute', routeName);\r\n          debugLog('MBAuieo2o34nf navigation state change - set currentRoute in storage', { routeName });\r\n          setCurrentRoute(routeName);\r\n          updateRoute && updateRoute(routeName);\r\n        }\r\n      } catch (error) {\r\n        debugLog('MBAuieo2o34nf error updating currentRoute in storage', error);\r\n      }\r\n    };\r\n    const unsubscribe = navigation.addListener('state', updateCurrentRouteInStorage);\r\n    return unsubscribe;\r\n  }, [navigation, updateRoute]);\r\n\r\n  const handleNavigation = async (screenName, tabName = null) => {\r\n    closeMenu();\r\n    \r\n    // Only log in debug mode to reduce console spam\r\n    if (is_DEBUG) {\r\n      console.log('MBA98386196v Navigating to:', screenName, tabName ? `with tab: ${tabName}` : '');\r\n      console.log('MBA98386196v Current route before:', currentRoute);\r\n    }\r\n    \r\n    try {\r\n      // Don't do anything if we're already on this screen\r\n      if (screenName === currentRoute) {\r\n        // Special case: if we're on MessageHistory and have unread messages, reset notifications\r\n        if (screenName === 'MessageHistory' && hasUnreadMessages) {\r\n          resetNotifications && resetNotifications();\r\n        }\r\n        \r\n        return;\r\n      }\r\n      \r\n      setStorage('previousRoute', currentRoute);\r\n      setStorage('currentRoute', screenName);\r\n      \r\n      // Update local state\r\n      setCurrentRoute(screenName);\r\n      \r\n      // Update the MessageNotificationContext with the new route\r\n      updateRoute && updateRoute(screenName);\r\n      \r\n      // Reset message notifications when navigating to MessageHistory\r\n      if (screenName === 'MessageHistory' && hasUnreadMessages) {\r\n        resetNotifications && resetNotifications();\r\n      }\r\n      \r\n      // If we have a tab parameter, pass it in the params\r\n      if (tabName) {\r\n        navigateToFrom(navigation, screenName, currentRoute, { screen: tabName });\r\n      } else {\r\n        navigateToFrom(navigation, screenName, currentRoute);\r\n      }\r\n      \r\n      if (is_DEBUG) {\r\n        console.log('MBA98386196v Current route after:', screenName);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error handling navigation:', error);\r\n      navigateToFrom(navigation, screenName, currentRoute);\r\n    }\r\n  };\r\n\r\n  // Initialize route tracking on component mount\r\n  useEffect(() => {\r\n    const initializeRouteTracking = async () => {\r\n      try {\r\n        const currentRoute = await getStorage('currentRoute');\r\n        if (!currentRoute) {\r\n          const initialRoute = isSignedIn \r\n            ? 'Dashboard'\r\n            : 'Home';\r\n          await setStorage('currentRoute', initialRoute);\r\n        }\r\n      } catch (error) {\r\n        console.error('Error initializing route tracking:', error);\r\n      }\r\n    };\r\n\r\n    initializeRouteTracking();\r\n  }, [isSignedIn, userRole]);\r\n\r\n  const handleRoleSwitch = async (newRole) => {\r\n    try {\r\n      // Get current screen before switching\r\n      const currentScreen = currentRoute;\r\n      \r\n      if (is_DEBUG) {\r\n        console.log('MBA98386196v Role switch initiated:', {\r\n          from: userRole,\r\n          to: newRole,\r\n          currentScreen\r\n        });\r\n      }\r\n      \r\n      await switchRole(newRole);\r\n      await setStorage('userRole', newRole);\r\n      \r\n      // Handle different screens according to requirements\r\n      switch (currentScreen) {\r\n        case 'MyProfile':\r\n          // For MyProfile, preserve the tab if it's common between roles\r\n          const params = navigation.getState().routes.find(route => route.name === 'MyProfile')?.params;\r\n          const currentTab = params?.screen || params?.initialTab || 'profile_info';\r\n          \r\n          if (is_DEBUG) {\r\n            console.log('MBA98386196v MyProfile tab preservation:', {\r\n              currentTab,\r\n              newRole\r\n            });\r\n          }\r\n          \r\n          // Check if we need to change the tab\r\n          let newTab = currentTab;\r\n          \r\n          // If switching to owner and current tab is professional-only, switch to profile_info\r\n          if (newRole === 'petOwner' && currentTab === 'services_availability') {\r\n            newTab = 'profile_info';\r\n          }\r\n          \r\n          // Navigate back to MyProfile with the appropriate tab\r\n          navigateToFrom(navigation, 'MyProfile', currentScreen, { screen: newTab });\r\n          break;\r\n          \r\n        case 'MessageHistory':\r\n          // For MessageHistory, just stay on the same screen without reload\r\n          navigateToFrom(navigation, 'MessageHistory', currentScreen);\r\n          break;\r\n          \r\n        case 'MyBookings':\r\n          // For MyBookings, stay on the same screen but switch tabs based on the new role\r\n          const activeTab = newRole === 'professional' ? 'professional' : 'owner';\r\n          if (is_DEBUG) {\r\n            console.log('MBA98386196v MyBookings tab switch:', {\r\n              newRole,\r\n              activeTab\r\n            });\r\n          }\r\n          // Pass the appropriate tab parameter\r\n          navigateToFrom(navigation, 'MyBookings', currentScreen, { screen: activeTab });\r\n          break;\r\n          \r\n        case 'Connections':\r\n          // For Connections, stay on the same screen but switch tabs based on the new role\r\n          const connectionsTab = newRole === 'professional' ? 'clients' : 'professionals';\r\n          if (is_DEBUG) {\r\n            console.log('MBA98386196v Connections tab switch:', {\r\n              newRole,\r\n              connectionsTab\r\n            });\r\n          }\r\n          // Pass the appropriate tab parameter\r\n          navigateToFrom(navigation, 'Connections', currentScreen, { screen: connectionsTab });\r\n          break;\r\n          \r\n        case 'Dashboard':\r\n          // For Dashboard, stay on the same screen\r\n          navigateToFrom(navigation, 'Dashboard', currentScreen);\r\n          break;\r\n          \r\n        case 'SearchProfessionalsListing':\r\n          // When client is on search pros and switches to pro, go to pro dashboard\r\n          if (newRole === 'professional') {\r\n            navigateToFrom(navigation, 'Dashboard', currentScreen);\r\n          } else {\r\n            // If somehow a pro is on this screen and switches to client, stay here\r\n            navigateToFrom(navigation, currentScreen, currentScreen);\r\n          }\r\n          break;\r\n          \r\n        case 'ServiceManager':\r\n          // When professional is on services and switches to client, go to client dashboard\r\n          if (newRole === 'petOwner') {\r\n            navigateToFrom(navigation, 'Dashboard', currentScreen);\r\n          } else {\r\n            // Should never happen, but if somehow client is on this screen and switches to pro, stay here\r\n            navigateToFrom(navigation, currentScreen, currentScreen);\r\n          }\r\n          break;\r\n          \r\n        default:\r\n          // For any other screen, navigate to the same screen\r\n          // This maintains the current behavior for unspecified screens\r\n          navigateToFrom(navigation, currentScreen, currentScreen);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error switching role:', error);\r\n    }\r\n  };\r\n\r\n  const handleLogout = async () => {\r\n    try {\r\n      if (is_DEBUG) {\r\n        console.log('MBA98386196v Logging out user');\r\n      }\r\n      await signOut();\r\n      if (Platform.OS === 'web') {\r\n        sessionStorage.removeItem('currentRoute');\r\n        sessionStorage.removeItem('previousRoute');\r\n        sessionStorage.removeItem('userRole');\r\n      } else {\r\n        await AsyncStorage.removeItem('currentRoute');\r\n        await AsyncStorage.removeItem('previousRoute');\r\n        await AsyncStorage.removeItem('userRole');\r\n      }\r\n      setCurrentRoute('');\r\n      navigation.navigate('SignIn');\r\n    } catch (error) {\r\n      console.error('Error during logout:', error);\r\n    }\r\n  };\r\n\r\n  const renderMenuItems = () => {\r\n    if (!isSignedIn) {\r\n      if (isMobile) {\r\n        return [\r\n          { title: 'Sign In', icon: 'login', route: 'SignIn' },\r\n          { title: 'Sign Up', icon: 'account-plus', route: 'SignUp' },\r\n          // { title: 'Become a Pro', icon: 'account-heart', route: 'BecomeProfessional' },\r\n          { title: 'Search Pros', icon: 'magnify', route: 'SearchProfessionalsListing' },\r\n          // { title: 'More', icon: 'dots-horizontal', route: 'More' },\r\n        ];\r\n      }\r\n      return [\r\n        { title: 'Sign In', icon: 'login', route: 'SignIn' },\r\n        { title: 'Sign Up', icon: 'account-plus', route: 'SignUp' },\r\n        // { title: 'More', icon: 'dots-horizontal', route: 'More' },\r\n      ];\r\n    } else if (userRole === 'professional') {\r\n      return [\r\n        { title: 'Dashboard', icon: 'view-dashboard', route: 'Dashboard' },\r\n        { title: 'Messages', icon: 'message-text', route: 'MessageHistory' },\r\n        { title: 'Services', icon: 'briefcase', route: 'ServiceManager' },\r\n        { title: 'Connections', icon: 'account-group', route: 'Connections' },\r\n        // { title: 'Bookings', icon: 'calendar', route: 'MyBookings' },\r\n        { title: 'Profile', icon: 'account', route: 'MyProfile', tab: 'profile_info' },\r\n      ];\r\n    } else {\r\n      return [\r\n        { title: 'Dashboard', icon: 'view-dashboard', route: 'Dashboard' },\r\n        { title: 'Messages', icon: 'message-text', route: 'MessageHistory' },\r\n        { title: 'Search Pros', icon: 'magnify', route: 'SearchProfessionalsListing' },\r\n        // { title: 'Bookings', icon: 'calendar', route: 'MyBookings' },\r\n        { title: 'Profile', icon: 'account', route: 'MyProfile', tab: 'profile_info' },\r\n        // ...(!isApprovedProfessional ? [{ title: 'Become a Pro', icon: 'account-heart', route: 'BecomeProfessional' }] : []),\r\n      ];\r\n    }\r\n  };\r\n\r\n  const renderMobileNavBar = () => {\r\n    const menuItems = renderMenuItems();\r\n    const itemWidth = Dimensions.get('window').width / menuItems.length;\r\n    return (\r\n      <View style={[styles.customNavBar, { backgroundColor: theme.colors.surfaceContrast }]}>\r\n        {menuItems.map((item, index) => (\r\n          <TouchableOpacity\r\n            key={index}\r\n            style={[styles.navButton, { width: itemWidth }]}\r\n            onPress={() => handleNavigation(item.route, item.tab)}\r\n          >\r\n            <MaterialCommunityIcons \r\n              name={item.icon} \r\n              size={24} \r\n              color={theme.colors.text} \r\n            />\r\n            <Text style={[styles.navText, { color: theme.colors.text }]} numberOfLines={2} ellipsizeMode=\"tail\">\r\n              {item.title}\r\n            </Text>\r\n          </TouchableOpacity>\r\n        ))}\r\n      </View>\r\n    );\r\n  };\r\n\r\n  const renderDesktopSidebar = () => {\r\n    const menuItems = renderMenuItems();\r\n    const sidebarWidth = isCollapsed ? 70 : 250;\r\n    const isProfessionalRole = userRole === 'professional';\r\n    const isOwnerRole = userRole === 'petOwner';\r\n\r\n    if (is_DEBUG) {\r\n      console.log('MBA98386196v Rendering Sidebar:', {\r\n        userRole,\r\n        isApprovedProfessional,\r\n        currentRoute,\r\n        isProfessionalRole,\r\n        isOwnerRole\r\n      });\r\n    }\r\n\r\n    return (\r\n      <View style={[styles.sidebarContainer, { width: sidebarWidth }]}>\r\n        <View style={styles.sidebarLogoContainer}>\r\n          <TouchableOpacity onPress={() => handleNavigation('Home', 'Overview')} style={styles.logoButton}>\r\n            <Image \r\n              source={require('../../assets/crittrcove-high-resolution-logo-transparent.png')}\r\n              style={[styles.sidebarLogo, { width: isCollapsed ? 40 : 150, tintColor: theme.colors.primary }]}\r\n              resizeMode=\"contain\"\r\n            />\r\n          </TouchableOpacity>\r\n        </View>\r\n        <TouchableOpacity \r\n          style={styles.collapseButton}\r\n          onPress={() => setIsCollapsed(!isCollapsed)}\r\n        >\r\n          <MaterialCommunityIcons \r\n            name={isCollapsed ? 'chevron-right' : 'chevron-left'} \r\n            size={24} \r\n            color={theme.colors.primary}\r\n          />\r\n        </TouchableOpacity>\r\n        <View style={styles.menuItems}>\r\n          {!isCollapsed && (\r\n            <View style={styles.roleToggleContainer}>\r\n              <Text style={styles.roleToggleTitle}>Switch Role:</Text>\r\n              <View style={styles.roleButtonsContainer}>\r\n                <TouchableOpacity\r\n                  style={[\r\n                    styles.roleButton,\r\n                    isOwnerRole && styles.roleButtonActive\r\n                  ]}\r\n                  onPress={() => {\r\n                    if (is_DEBUG) {\r\n                      console.log('MBA98386196v Owner Role Button Press:', {\r\n                        currentRole: userRole,\r\n                        isApprovedProfessional\r\n                      });\r\n                    }\r\n                    if (isProfessionalRole) {\r\n                      handleRoleSwitch('petOwner');\r\n                    }\r\n                  }}\r\n                  activeOpacity={0.7}\r\n                >\r\n                  <Text style={[\r\n                    styles.roleButtonText,\r\n                    isOwnerRole && styles.roleButtonTextActive\r\n                  ]}>Owner</Text>\r\n                </TouchableOpacity>\r\n                <TouchableOpacity\r\n                  style={[\r\n                    styles.roleButton,\r\n                    isProfessionalRole && styles.roleButtonActive,\r\n                    !isApprovedProfessional && styles.roleButtonDisabled\r\n                  ]}\r\n                  onPress={() => {\r\n                    if (is_DEBUG) {\r\n                      console.log('MBA98386196v Professional Role Button Press:', {\r\n                        currentRole: userRole,\r\n                        isApprovedProfessional\r\n                      });\r\n                    }\r\n                    if (isOwnerRole && isApprovedProfessional) {\r\n                      handleRoleSwitch('professional');\r\n                    }\r\n                  }}\r\n                  disabled={!isApprovedProfessional}\r\n                  activeOpacity={isApprovedProfessional ? 0.7 : 1}\r\n                >\r\n                  <Text style={[\r\n                    styles.roleButtonText,\r\n                    isProfessionalRole && styles.roleButtonTextActive,\r\n                    !isApprovedProfessional && styles.roleButtonTextDisabled\r\n                  ]}>Professional</Text>\r\n                </TouchableOpacity>\r\n              </View>\r\n            </View>\r\n          )}\r\n          {menuItems.map((item, index) => {\r\n            const isActive = currentRoute === item.route || \r\n                           (item.route === 'More' && item.title === 'Settings' && currentRoute === 'More');\r\n            \r\n            // Check if this is the Messages tab and we have unread messages\r\n            const showNotification = item.title === 'Messages' && hasUnreadMessages;\r\n\r\n            return (\r\n              <TouchableOpacity\r\n                key={index}\r\n                style={[\r\n                  styles.sidebarItem,\r\n                  isActive && styles.activeItem\r\n                ]}\r\n                onPress={() => handleNavigation(item.route, item.tab || 'Overview')}\r\n              >\r\n                <View style={{ position: 'relative' }}>\r\n                  <MaterialCommunityIcons \r\n                    name={item.icon} \r\n                    size={24} \r\n                    color={isActive ? theme.colors.primary : \"#4B5563\"}\r\n                  />\r\n                  {showNotification && (\r\n                    <View style={styles.messageNotificationBadge}>\r\n                      {unreadCount > 0 && (\r\n                        <Text style={styles.messageNotificationText}>{unreadCount}</Text>\r\n                      )}\r\n                    </View>\r\n                  )}\r\n                </View>\r\n                {!isCollapsed && (\r\n                  <Text style={[\r\n                    styles.sidebarItemText, \r\n                    { color: isActive ? theme.colors.primary : \"#4B5563\" }\r\n                  ]}>\r\n                    {item.title}\r\n                    {item.title === 'Messages' && hasUnreadMessages && unreadCount > 0 && (\r\n                      <Text style={{ color: theme.colors.error }}>{` (${unreadCount})`}</Text>\r\n                    )}\r\n                  </Text>\r\n                )}\r\n              </TouchableOpacity>\r\n            );\r\n          })}\r\n        </View>\r\n        <TouchableOpacity\r\n          style={[styles.logoutButton, { width: sidebarWidth }]}\r\n          onPress={handleLogout}\r\n        >\r\n          <MaterialCommunityIcons \r\n            name=\"logout\" \r\n            size={24} \r\n            color=\"#F26969\"\r\n          />\r\n          {!isCollapsed && (\r\n            <Text style={styles.logoutText}>Logout</Text>\r\n          )}\r\n        </TouchableOpacity>\r\n      </View>\r\n    );\r\n  };\r\n\r\n  const renderWebNavItems = () => {\r\n    const menuItems = renderMenuItems();\r\n    return menuItems.map((item, index) => (\r\n      <TouchableOpacity\r\n        key={index}\r\n        style={styles.webNavItem}\r\n        onPress={() => handleNavigation(item.route)}\r\n      >\r\n        <Text style={styles.webNavText}>{item.title}</Text>\r\n      </TouchableOpacity>\r\n    ));\r\n  };\r\n\r\n  const renderMobileHeader = () => {\r\n    const logoSize = screenWidth <= 470 ? { width: 100, height: 30 } : { width: 150, height: 40 };\r\n    const isProfessionalRole = userRole === 'professional';\r\n    const isOwnerRole = userRole === 'petOwner';\r\n    \r\n    // Update notification count to include message notifications\r\n    const totalNotifications = hasUnreadMessages ? (notificationCount + unreadCount) : notificationCount;\r\n    \r\n    return (\r\n      <View style={[styles.mobileHeader, { backgroundColor: theme.colors.surfaceContrast }]}>\r\n        <View style={styles.mobileHeaderContent}>\r\n          <TouchableOpacity onPress={() => handleNavigation('Home', 'Overview')} style={styles.logoButton}>\r\n            <Image \r\n              source={require('../../assets/crittrcove-high-resolution-logo-transparent.png')} \r\n              style={[\r\n                styles.mobileLogo,\r\n                { tintColor: theme.colors.primary },\r\n                logoSize\r\n              ]} \r\n            />\r\n          </TouchableOpacity>\r\n          <View style={styles.mobileRightContent}>\r\n            {/* <TouchableOpacity onPress={() => handleNavigation('Notifications', 'Overview')} style={styles.iconButton}>\r\n              <MaterialCommunityIcons name=\"bell-outline\" size={24} color={theme.colors.text} />\r\n              {totalNotifications > 0 && (\r\n                <View style={styles.notificationBadge}>\r\n                  <Text style={styles.notificationText}>{totalNotifications}</Text>\r\n                </View>\r\n              )}\r\n            </TouchableOpacity> */}\r\n            <TouchableOpacity onPress={toggleMenu} style={styles.profileContainer}>\r\n              <View style={styles.hamburgerMenuContainer}>\r\n                <AnimatedHamburgerMenu size={28} color={theme.colors.text} />\r\n              </View>\r\n            </TouchableOpacity>\r\n          </View>\r\n        </View>\r\n        {isMenuOpen && (\r\n          <View style={[styles.mobileMenu, { backgroundColor: theme.colors.surfaceContrast }]}>\r\n            {isSignedIn && (\r\n              <View style={styles.mobileRoleToggleContainer}>\r\n                <Text style={styles.mobileRoleToggleTitle}>Switch Role:</Text>\r\n                <View style={styles.mobileRoleButtonsContainer}>\r\n                  <TouchableOpacity\r\n                    style={[\r\n                      styles.mobileRoleButton,\r\n                      isOwnerRole && styles.mobileRoleButtonActive\r\n                    ]}\r\n                    onPress={() => {\r\n                      if (is_DEBUG) {\r\n                        console.log('MBA98386196v Mobile Owner Role Button Press:', {\r\n                          currentRole: userRole,\r\n                          isApprovedProfessional\r\n                        });\r\n                      }\r\n                      if (isProfessionalRole) {\r\n                        handleRoleSwitch('petOwner');\r\n                        setIsMenuOpen(false);\r\n                      }\r\n                    }}\r\n                    activeOpacity={0.7}\r\n                  >\r\n                    <Text style={[\r\n                      styles.mobileRoleButtonText,\r\n                      isOwnerRole && styles.mobileRoleButtonTextActive\r\n                    ]}>Owner</Text>\r\n                  </TouchableOpacity>\r\n                  <TouchableOpacity\r\n                    style={[\r\n                      styles.mobileRoleButton,\r\n                      isProfessionalRole && styles.mobileRoleButtonActive,\r\n                      !isApprovedProfessional && styles.mobileRoleButtonDisabled\r\n                    ]}\r\n                    onPress={() => {\r\n                      if (is_DEBUG) {\r\n                        console.log('MBA98386196v Mobile Professional Role Button Press:', {\r\n                          currentRole: userRole,\r\n                          isApprovedProfessional\r\n                        });\r\n                      }\r\n                      if (isOwnerRole && isApprovedProfessional) {\r\n                        handleRoleSwitch('professional');\r\n                        setIsMenuOpen(false);\r\n                      }\r\n                    }}\r\n                    disabled={!isApprovedProfessional}\r\n                    activeOpacity={isApprovedProfessional ? 0.7 : 1}\r\n                  >\r\n                    <Text style={[\r\n                      styles.mobileRoleButtonText,\r\n                      isProfessionalRole && styles.mobileRoleButtonTextActive,\r\n                      !isApprovedProfessional && styles.mobileRoleButtonTextDisabled\r\n                    ]}>Professional</Text>\r\n                  </TouchableOpacity>\r\n                </View>\r\n              </View>\r\n            )}\r\n            {renderMenuItems().map((item, index) => {\r\n              const showNotification = item.title === 'Messages' && hasUnreadMessages;\r\n              \r\n              return (\r\n                <TouchableOpacity\r\n                  key={index}\r\n                  style={styles.mobileMenuItem}\r\n                  onPress={() => {\r\n                    handleNavigation(item.route, item.tab || 'Overview');\r\n                    setIsMenuOpen(false);\r\n                  }}\r\n                >\r\n                  <View style={{ flexDirection: 'row', alignItems: 'center', position: 'relative' }}>\r\n                    <MaterialCommunityIcons name={item.icon} size={24} color={theme.colors.text} />\r\n                    {showNotification && (\r\n                      <View style={styles.mobileMessageNotificationBadge}>\r\n                        {unreadCount > 0 && (\r\n                          <Text style={styles.mobileMessageNotificationText}>{unreadCount}</Text>\r\n                        )}\r\n                      </View>\r\n                    )}\r\n                  </View>\r\n                  <Text style={styles.mobileMenuItemText}>\r\n                    {item.title}\r\n                    {item.title === 'Messages' && hasUnreadMessages && unreadCount > 0 && (\r\n                      <Text style={{ color: theme.colors.error }}>{` (${unreadCount})`}</Text>\r\n                    )}\r\n                  </Text>\r\n                </TouchableOpacity>\r\n              );\r\n            })}\r\n            {isSignedIn && (\r\n              <TouchableOpacity\r\n                style={[styles.mobileMenuItem, styles.mobileLogoutItem]}\r\n                onPress={() => {\r\n                  handleLogout();\r\n                  setIsMenuOpen(false);\r\n                }}\r\n              >\r\n                <MaterialCommunityIcons name=\"logout\" size={24} color=\"#F26969\" />\r\n                <Text style={[styles.mobileMenuItemText, styles.mobileLogoutText]}>Logout</Text>\r\n              </TouchableOpacity>\r\n            )}\r\n          </View>\r\n        )}\r\n      </View>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <>\r\n      {Platform.OS === 'web' ? (\r\n        <>\r\n          {!isMobile && isSignedIn && (\r\n            <View style={styles.navContainer}>\r\n              {renderDesktopSidebar()}\r\n            </View>\r\n          )}\r\n          {(isMobile || !isSignedIn) && renderMobileHeader()}\r\n        </>\r\n      ) : (\r\n        <View style={styles.container}>\r\n          {renderMobileNavBar()}\r\n        </View>\r\n      )}\r\n    </>\r\n  );\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    display: 'flex',\r\n    // alignItems: 'center',\r\n    // justifyContent: 'center',\r\n    backgroundColor: theme.colors.primary,\r\n  },\r\n  content: {\r\n    flex: 1,\r\n  },\r\n  header: {\r\n    backgroundColor: theme.colors.primary,\r\n  },\r\n  titleContainer: {\r\n    justifyContent: 'center',\r\n  },\r\n  titleContainer2: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    flexDirection: 'row',\r\n    justifyContent: 'flex-start',\r\n  },\r\n  title: {\r\n    textAlign: 'left',\r\n    marginLeft: theme.spacing.medium,\r\n    fontSize: theme.fontSizes.large,\r\n    color: theme.colors.text,\r\n    fontWeight: 'bold',\r\n    fontFamily: theme.fonts.header.fontFamily,\r\n  },\r\n  desktopNav: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'flex-end',\r\n    alignItems: 'center',\r\n  },\r\n  navItem: {\r\n    marginHorizontal: theme.spacing.medium,\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.text,\r\n    cursor: 'pointer',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    fontWeight: '600',\r\n  },\r\n  customNavBar: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-around',\r\n    alignItems: 'center',\r\n    backgroundColor: theme.colors.primary,\r\n    position: 'absolute',\r\n    bottom: 0,\r\n    left: 0,\r\n    right: 0,\r\n    paddingVertical: 10,\r\n    borderTopWidth: 1,\r\n    borderTopColor: theme.colors.border,\r\n  },\r\n  navButton: {\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    height: 60,\r\n    paddingHorizontal: 5,\r\n  },\r\n  navText: {\r\n    color: theme.colors.whiteText,\r\n    fontSize: theme.fontSizes.small,\r\n    marginTop: 5,\r\n    textAlign: 'center',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    fontWeight: '600',\r\n  },\r\n  webNavItem: {\r\n    marginHorizontal: theme.spacing.medium,\r\n  },\r\n  webNavText: {\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.whiteText,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    fontWeight: '600',\r\n  },\r\n  navLinkContainer: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    marginHorizontal: 6,\r\n  },\r\n  sidebarContainer: {\r\n    height: '100%',\r\n    minHeight: '100vh',\r\n    backgroundColor: theme.colors.surfaceContrast,\r\n    borderRightWidth: 0,\r\n    position: 'fixed',\r\n    left: 0,\r\n    top: 0,\r\n    bottom: 0,\r\n    zIndex: 1000,\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    transition: 'width 0.3s ease',\r\n    borderTopRightRadius: 24,\r\n    borderBottomRightRadius: 24,\r\n  },\r\n  sidebarLogoContainer: {\r\n    padding: 16,\r\n    borderBottomWidth: 3,\r\n    borderBottomColor: theme.colors.surface,\r\n    alignItems: 'center',\r\n    backgroundColor: theme.colors.surfaceContrast,\r\n  },\r\n  logoButton: {\r\n    alignItems: 'center',\r\n  },\r\n  sidebarLogo: {\r\n    height: 50,\r\n    resizeMode: 'contain',\r\n  },\r\n  collapseButton: {\r\n    position: 'absolute',\r\n    right: -16,\r\n    top: '50%',\r\n    transform: [{ translateY: -20 }],\r\n    width: 32,\r\n    height: 40,\r\n    backgroundColor: theme.colors.surfaceContrast,\r\n    borderWidth: 0,\r\n    borderRadius: 8,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    zIndex: 1001,\r\n  },\r\n  menuItems: {\r\n    flex: 1,\r\n    padding: 16,\r\n    backgroundColor: theme.colors.surfaceContrast,\r\n  },\r\n  sidebarItem: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    padding: 12,\r\n    marginBottom: 8,\r\n    borderRadius: 8,\r\n    backgroundColor: 'transparent',\r\n    cursor: 'pointer',\r\n  },\r\n  sidebarItemText: {\r\n    marginLeft: 12,\r\n    fontSize: theme.fontSizes.medium,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    fontWeight: '500',\r\n  },\r\n  logoutButton: {\r\n    width: '100%',\r\n    padding: 16,\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    borderTopWidth: 0,\r\n    backgroundColor: theme.colors.surfaceContrast,\r\n    borderBottomRightRadius: 24,\r\n  },\r\n  logoutText: {\r\n    marginLeft: 12,\r\n    fontSize: theme.fontSizes.medium,\r\n    color: '#F26969',\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    fontWeight: '500',\r\n  },\r\n  headerRight: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    gap: 16,\r\n    marginRight: 16,\r\n  },\r\n  notificationButton: {\r\n    position: 'relative',\r\n    padding: 8,\r\n  },\r\n  notificationBadge: {\r\n    position: 'absolute',\r\n    top: 4,\r\n    right: 4,\r\n    backgroundColor: theme.colors.error,\r\n    borderRadius: 10,\r\n    minWidth: 20,\r\n    height: 20,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n  },\r\n  notificationCount: {\r\n    color: theme.colors.whiteText,\r\n    fontSize: 12,\r\n    fontWeight: 'bold',\r\n  },\r\n  profileButton: {\r\n    borderRadius: 20,\r\n    overflow: 'hidden',\r\n  },\r\n  menuContent: {\r\n    marginTop: 45,\r\n  },\r\n  mobileHeader: {\r\n    width: '100%',\r\n    paddingVertical: 10,\r\n    paddingHorizontal: 20,\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: 'rgba(255,255,255,0.1)',\r\n    position: 'relative',\r\n  },\r\n  mobileHeaderContent: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    width: '100%',\r\n  },\r\n  mobileLogo: {\r\n    resizeMode: 'contain',\r\n  },\r\n  mobileRightContent: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    gap: 15,\r\n  },\r\n  mobileMenu: {\r\n    position: 'absolute',\r\n    top: '100%',\r\n    right: 20,\r\n    backgroundColor: theme.colors.surface,\r\n    borderRadius: 8,\r\n    padding: 8,\r\n    shadowColor: '#000',\r\n    shadowOffset: { width: 0, height: 2 },\r\n    shadowOpacity: 0.25,\r\n    shadowRadius: 3.84,\r\n    elevation: 5,\r\n    zIndex: 1000,\r\n    minWidth: 200,\r\n  },\r\n  mobileMenuItem: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    padding: 12,\r\n    borderRadius: 8,\r\n  },\r\n  mobileMenuItemText: {\r\n    marginLeft: 12,\r\n    fontSize: 16,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n  },\r\n  profileContainer: {\r\n    width: 44,\r\n    height: 44,\r\n    borderRadius: 22,\r\n    overflow: 'hidden',\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n  },\r\n  iconButton: {\r\n    padding: 8,\r\n    position: 'relative',\r\n  },\r\n  notificationText: {\r\n    color: theme.colors.whiteText,\r\n    fontSize: 12,\r\n    fontWeight: 'bold',\r\n  },\r\n  navContainer: {\r\n    position: 'fixed',\r\n    top: 0,\r\n    left: 0,\r\n    bottom: 0,\r\n    zIndex: 1000,\r\n    backgroundColor: theme.colors.surface,\r\n    borderRightWidth: 1,\r\n    borderRightColor: theme.colors.border,\r\n  },\r\n  activeItem: {\r\n    backgroundColor: '#F0F9E5',\r\n  },\r\n  roleToggleContainer: {\r\n    padding: 12,\r\n    marginBottom: 16,\r\n    borderRadius: 8,\r\n    backgroundColor: '#F0F9E5',\r\n  },\r\n  roleToggleTitle: {\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    fontWeight: '600',\r\n    marginBottom: 8,\r\n  },\r\n  roleButtonsContainer: {\r\n    flexDirection: 'row',\r\n    gap: 8,\r\n  },\r\n  roleButton: {\r\n    flex: 1,\r\n    padding: 8,\r\n    borderRadius: 6,\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.primary,\r\n    cursor: 'pointer',\r\n  },\r\n  roleButtonDisabled: {\r\n    opacity: 0.5,\r\n    borderColor: theme.colors.border,\r\n    cursor: 'not-allowed',\r\n  },\r\n  roleButtonText: {\r\n    fontSize: theme.fontSizes.small,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    color: theme.colors.primary,\r\n  },\r\n  roleButtonTextDisabled: {\r\n    color: theme.colors.border,\r\n  },\r\n  roleButtonActive: {\r\n    backgroundColor: theme.colors.primary,\r\n  },\r\n  roleButtonTextActive: {\r\n    color: theme.colors.surface,\r\n  },\r\n  mobileRoleToggleContainer: {\r\n    padding: 16,\r\n    marginBottom: 8,\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: theme.colors.border,\r\n  },\r\n  mobileRoleToggleTitle: {\r\n    fontSize: theme.fontSizes.medium,\r\n    color: theme.colors.text,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    fontWeight: '600',\r\n    marginBottom: 8,\r\n  },\r\n  mobileRoleButtonsContainer: {\r\n    flexDirection: 'row',\r\n    gap: 8,\r\n  },\r\n  mobileRoleButton: {\r\n    flex: 1,\r\n    padding: 8,\r\n    borderRadius: 6,\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.primary,\r\n  },\r\n  mobileRoleButtonDisabled: {\r\n    opacity: 0.5,\r\n    borderColor: theme.colors.border,\r\n  },\r\n  mobileRoleButtonText: {\r\n    fontSize: theme.fontSizes.small,\r\n    fontFamily: theme.fonts.regular.fontFamily,\r\n    color: theme.colors.primary,\r\n  },\r\n  mobileRoleButtonTextDisabled: {\r\n    color: theme.colors.border,\r\n  },\r\n  mobileRoleButtonActive: {\r\n    backgroundColor: theme.colors.primary,\r\n  },\r\n  mobileRoleButtonTextActive: {\r\n    color: theme.colors.surface,\r\n  },\r\n  mobileLogoutItem: {\r\n    borderTopWidth: 1,\r\n    borderTopColor: theme.colors.border,\r\n    marginTop: 8,\r\n  },\r\n  mobileLogoutText: {\r\n    color: '#F26969',\r\n  },\r\n  messageNotificationDot: {\r\n    position: 'absolute',\r\n    top: -2,\r\n    right: -2,\r\n    width: 10,\r\n    height: 10,\r\n    borderRadius: 5,\r\n    backgroundColor: theme.colors.error,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.surface,\r\n  },\r\n  \r\n  mobileMessageNotificationDot: {\r\n    position: 'absolute',\r\n    top: -2,\r\n    right: -2,\r\n    width: 8,\r\n    height: 8,\r\n    borderRadius: 4,\r\n    backgroundColor: theme.colors.error,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.surfaceContrast,\r\n  },\r\n  messageNotificationBadge: {\r\n    position: 'absolute',\r\n    top: -8,\r\n    right: -8,\r\n    minWidth: 18,\r\n    height: 18,\r\n    borderRadius: 9,\r\n    backgroundColor: theme.colors.error,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.surface,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    paddingHorizontal: 2,\r\n  },\r\n  messageNotificationText: {\r\n    color: 'white',\r\n    fontSize: 10,\r\n    fontWeight: 'bold',\r\n  },\r\n  mobileMessageNotificationBadge: {\r\n    position: 'absolute',\r\n    top: -8,\r\n    right: -8,\r\n    minWidth: 16,\r\n    height: 16,\r\n    borderRadius: 8,\r\n    backgroundColor: theme.colors.error,\r\n    borderWidth: 1,\r\n    borderColor: theme.colors.surfaceContrast,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    paddingHorizontal: 2,\r\n  },\r\n  mobileMessageNotificationText: {\r\n    color: 'white',\r\n    fontSize: 9,\r\n    fontWeight: 'bold',\r\n  },\r\n  hamburgerMenuContainer: {\r\n    width: 28,\r\n    height: 28,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n  },\r\n});\r\n","/**\r\n * Debug logging utility function\r\n * @param {string} message - The message to log\r\n * @param {any} data - Optional data to log\r\n */\r\nexport const debugLog = (message, data) => {\r\n  if (process.env.NODE_ENV !== 'production') {\r\n    // Log the actual process.env.NODE_ENV value\r\n    console.log('MBA1234: Current process.env.NODE_ENV:', process.env.NODE_ENV);\r\n    \r\n    if (data) {\r\n      console.log(message, data);\r\n    } else {\r\n      console.log(message);\r\n    }\r\n  }\r\n}; ","// src/config/config.js\r\nimport { Platform } from 'react-native';\r\nimport { debugLog } from '../utils/logging';\r\nimport { \r\n  STAGING_API_BASE_URL_ANDROID, \r\n  STAGING_API_BASE_URL_IOS, \r\n  STAGING_API_BASE_URL_WEB,\r\n  PRODUCTION_API_BASE_URL_ANDROID,\r\n  PRODUCTION_API_BASE_URL_IOS,\r\n  PRODUCTION_API_BASE_URL_WEB,\r\n  DEV_API_BASE_URL_ANDROID,\r\n  DEV_API_BASE_URL_IOS,\r\n  DEV_API_BASE_URL_WEB,\r\n  NODE_ENV \r\n} from '@env';\r\n\r\n// Log all environment variables to help debug\r\nconsole.log('MBA1234: All environment variables:', {\r\n  NODE_ENV,\r\n  process_env_NODE_ENV: process.env.NODE_ENV,\r\n  STAGING_API_BASE_URL_ANDROID,\r\n  STAGING_API_BASE_URL_IOS,\r\n  STAGING_API_BASE_URL_WEB,\r\n  PRODUCTION_API_BASE_URL_ANDROID,\r\n  PRODUCTION_API_BASE_URL_IOS,\r\n  PRODUCTION_API_BASE_URL_WEB,\r\n  DEV_API_BASE_URL_ANDROID,\r\n  DEV_API_BASE_URL_IOS,\r\n  DEV_API_BASE_URL_WEB,\r\n  platform: Platform.OS\r\n});\r\n\r\ndebugLog(\"MBA1234: Environment Variables Loaded\", {\r\n  NODE_ENV,\r\n  STAGING_API_BASE_URL_ANDROID,\r\n  STAGING_API_BASE_URL_IOS,\r\n  STAGING_API_BASE_URL_WEB,\r\n  PRODUCTION_API_BASE_URL_ANDROID,\r\n  PRODUCTION_API_BASE_URL_IOS,\r\n  PRODUCTION_API_BASE_URL_WEB,\r\n  DEV_API_BASE_URL_ANDROID,\r\n  DEV_API_BASE_URL_IOS,\r\n  DEV_API_BASE_URL_WEB,\r\n  platform: Platform.OS\r\n});\r\n\r\nconst isDevelopment = NODE_ENV === 'development';\r\nconst isStaging = NODE_ENV === 'staging';\r\nconst isProduction = NODE_ENV === 'production';\r\n\r\ndebugLog(\"MBA1234: Environment Configuration\", {\r\n  NODE_ENV,\r\n  isDevelopment,\r\n  isStaging,\r\n  isProduction,\r\n  platform: Platform.OS\r\n});\r\n\r\nlet API_BASE_URL;\r\n\r\nif (Platform.OS === 'android') {\r\n  API_BASE_URL = isDevelopment ? DEV_API_BASE_URL_ANDROID : isStaging ? STAGING_API_BASE_URL_ANDROID : PRODUCTION_API_BASE_URL_ANDROID;\r\n} else if (Platform.OS === 'ios') {\r\n  API_BASE_URL = isDevelopment ? DEV_API_BASE_URL_IOS : isStaging ? STAGING_API_BASE_URL_IOS : PRODUCTION_API_BASE_URL_IOS;\r\n} else {\r\n  API_BASE_URL = isDevelopment ? DEV_API_BASE_URL_WEB : isStaging ? STAGING_API_BASE_URL_WEB : PRODUCTION_API_BASE_URL_WEB;\r\n}\r\n\r\ndebugLog(\"MBA1234: Selected API Base URL\", { API_BASE_URL });\r\n\r\nexport { API_BASE_URL };\r\n","import React, { createContext, useState, useEffect, useContext, useRef } from 'react';\r\nimport AsyncStorage from '@react-native-async-storage/async-storage';\r\nimport axios from 'axios';\r\nimport { API_BASE_URL } from '../config/config';\r\nimport { Dimensions, Platform } from 'react-native';\r\nimport { navigate } from '../../App';\r\nimport { navigateToFrom } from '../components/Navigation';\r\nimport { initStripe } from '../utils/StripeService';\r\nimport { getUserName, getTimeSettings } from '../api/API';\r\n\r\nexport const SCREEN_WIDTH = Dimensions.get('window').width;\r\nexport const SCREEN_HEIGHT = Dimensions.get('window').height;\r\n\r\n// Create a debug logging utility\r\nlet debugEnabled = true;\r\n\r\nexport const setDebugEnabled = (enabled) => {\r\n  debugEnabled = enabled;\r\n};\r\n\r\nexport const debugLog = (message, ...data) => {\r\n  if (debugEnabled && !message.includes('MBA3210')) {\r\n    if (data.length > 0) {\r\n      console.log(`${message}:`, ...data);\r\n    } else {\r\n      console.log(`${message}`);\r\n    }\r\n  }\r\n};\r\n\r\n// Authentication state management class with proper synchronization\r\nclass AuthService {\r\n  constructor() {\r\n    this.accessToken = null;\r\n    this.refreshToken = null;\r\n    this.isRefreshing = false;\r\n    this.refreshSubscribers = [];\r\n    this.tokenExpiryTime = null;\r\n    this.lastValidation = null;\r\n    this.authStateCallbacks = new Set();\r\n    this.isSigningOut = false;\r\n    this.lastTokenCheck = 0;\r\n    \r\n    // For testing - reduce refresh thresholds\r\n    this.TOKEN_REFRESH_THRESHOLD = 10 * 1000; // 10 seconds - increased for safety buffer\r\n    // This provides protection against:\r\n    // 1. Slow backend responses (2-5 seconds)\r\n    // 2. Network latency/timeouts\r\n    // 3. High server load scenarios\r\n    // Token refresh will start with 10s buffer, plenty of time for completion\r\n    this.TOKEN_PREEMPTIVE_REFRESH = 3 * 1000; // 3 seconds for testing\r\n    this.VALIDATION_CACHE_TIME = 30 * 1000; // 30 seconds cache\r\n    \r\n    // console.log('MBA1111 AuthService initialized with increased safety buffer (10s refresh threshold)');\r\n  }\r\n\r\n  // Register callback for auth state changes\r\n  onAuthStateChange(callback) {\r\n    this.authStateCallbacks.add(callback);\r\n    return () => this.authStateCallbacks.delete(callback);\r\n  }\r\n\r\n  // Notify all callbacks of auth state changes\r\n  notifyAuthStateChange(state) {\r\n    debugLog('MBA1111 Notifying auth state change:', state);\r\n    this.authStateCallbacks.forEach(callback => {\r\n      try {\r\n        callback(state);\r\n      } catch (error) {\r\n        console.error('MBA1111 Error in auth state callback:', error);\r\n      }\r\n    });\r\n  }\r\n\r\n  // Parse JWT token to get expiry time\r\n  parseJwt(token) {\r\n    try {\r\n      if (!token) return null;\r\n      \r\n      const base64Url = token.split('.')[1];\r\n      const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');\r\n      let jsonPayload;\r\n      \r\n      if (typeof atob === 'function') {\r\n        // Browser environment\r\n        jsonPayload = decodeURIComponent(\r\n          atob(base64)\r\n            .split('')\r\n            .map(c => '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2))\r\n            .join('')\r\n        );\r\n      } else {\r\n        // React Native environment\r\n        jsonPayload = decodeURIComponent(\r\n          Buffer.from(base64, 'base64')\r\n            .toString('binary')\r\n            .split('')\r\n            .map(c => '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2))\r\n            .join('')\r\n        );\r\n      }\r\n      \r\n      return JSON.parse(jsonPayload);\r\n    } catch (error) {\r\n      console.error('MBA1111 Error parsing JWT:', error);\r\n      return null;\r\n    }\r\n  }\r\n\r\n  // Calculate time until token expires in milliseconds\r\n  getTimeUntilExpiry(token) {\r\n    const parsedToken = this.parseJwt(token);\r\n    if (!parsedToken || !parsedToken.exp) return 0;\r\n    \r\n    const expiryTime = parsedToken.exp * 1000; // Convert to milliseconds\r\n    this.tokenExpiryTime = expiryTime;\r\n    \r\n    return expiryTime - Date.now();\r\n  }\r\n\r\n  // Check if we should refresh the token\r\n  shouldRefreshToken(token) {\r\n    if (!token) return false;\r\n    \r\n    const timeUntilExpiry = this.getTimeUntilExpiry(token);\r\n    const shouldRefresh = timeUntilExpiry < this.TOKEN_REFRESH_THRESHOLD && timeUntilExpiry > 0;\r\n    \r\n    if (shouldRefresh) {\r\n      debugLog(`MBA1111 Token should be refreshed - expires in ${Math.round(timeUntilExpiry/1000)} seconds`);\r\n    }\r\n    \r\n    return shouldRefresh;\r\n  }\r\n\r\n  // Refresh JWT tokens\r\n  async refreshTokens() {\r\n    debugLog('MBA1111 refreshTokens called');\r\n    \r\n    try {\r\n      // Prevent concurrent refresh attempts\r\n      if (this.isRefreshing) {\r\n        debugLog('MBA1111 Token refresh already in progress, subscribing');\r\n        return new Promise((resolve, reject) => {\r\n          this.refreshSubscribers.push({ resolve, reject });\r\n          \r\n          // Add timeout to prevent hanging forever\r\n          setTimeout(() => {\r\n            const index = this.refreshSubscribers.findIndex(sub => sub.resolve === resolve);\r\n            if (index !== -1) {\r\n              this.refreshSubscribers.splice(index, 1);\r\n              reject(new Error('Token refresh timeout'));\r\n            }\r\n          }, 10000); // 10 second timeout\r\n        });\r\n      }\r\n      \r\n      this.isRefreshing = true;\r\n      this.refreshSubscribers = [];\r\n      \r\n      if (!this.refreshToken) {\r\n        throw new Error('No refresh token available');\r\n      }\r\n      \r\n      // Check if refresh token is expired\r\n      const refreshTokenExpiry = this.getTimeUntilExpiry(this.refreshToken);\r\n      if (refreshTokenExpiry <= 0) {\r\n        debugLog('MBA1111 Refresh token is expired, cannot refresh');\r\n        throw new Error('Refresh token expired');\r\n      }\r\n      \r\n      const refreshStartTime = Date.now();\r\n      debugLog('MBA1111 Making refresh token request to backend');\r\n      \r\n      // Make the actual refresh request without using interceptors\r\n      const response = await fetch(`${API_BASE_URL}/api/token/refresh/`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({\r\n          refresh: this.refreshToken\r\n        })\r\n      });\r\n      \r\n      if (!response.ok) {\r\n        const errorData = await response.json().catch(() => ({}));\r\n        debugLog('MBA1111 Token refresh failed with status:', response.status, errorData);\r\n        throw new Error(`Token refresh failed: ${response.status}`);\r\n      }\r\n      \r\n      const data = await response.json();\r\n      const { access, refresh } = data;\r\n      \r\n      if (!access) {\r\n        throw new Error('No access token in refresh response');\r\n      }\r\n      \r\n      this.accessToken = access;\r\n      \r\n      // Handle refresh token rotation if new refresh token is provided\r\n      if (refresh) {\r\n        debugLog('MBA1111 New refresh token received, updating stored refresh token');\r\n        this.refreshToken = refresh;\r\n        await setStorage('refreshToken', refresh);\r\n      }\r\n      \r\n      // Store new access token\r\n      await setStorage('userToken', access);\r\n      \r\n      const refreshDuration = Date.now() - refreshStartTime;\r\n      debugLog(`MBA1111 Token refresh successful in ${refreshDuration}ms`);\r\n      \r\n      // Resolve all waiting requests\r\n      this.refreshSubscribers.forEach(({ resolve }) => {\r\n        try {\r\n          resolve(access);\r\n        } catch (error) {\r\n          debugLog('MBA1111 Error resolving refresh subscriber:', error);\r\n        }\r\n      });\r\n      \r\n      return access;\r\n      \r\n    } catch (error) {\r\n      debugLog('MBA1111 Token refresh failed:', error);\r\n      \r\n      // Reject all waiting requests\r\n      this.refreshSubscribers.forEach(({ reject }) => {\r\n        try {\r\n          reject(error);\r\n        } catch (err) {\r\n          debugLog('MBA1111 Error rejecting refresh subscriber:', err);\r\n        }\r\n      });\r\n      \r\n      // Clear invalid tokens\r\n      await this.clearTokens();\r\n      throw error;\r\n      \r\n    } finally {\r\n      this.isRefreshing = false;\r\n      this.refreshSubscribers = [];\r\n      debugLog('MBA1111 Token refresh process completed');\r\n    }\r\n  }\r\n\r\n  // Get access token with automatic refresh\r\n  async getAccessToken() {\r\n    // If signing out, return null\r\n    if (this.isSigningOut) {\r\n      debugLog('MBA1111 getAccessToken: signing out, returning null');\r\n      return null;\r\n    }\r\n    \r\n    // Check if current token is expired\r\n    if (this.accessToken) {\r\n      const timeUntilExpiry = this.getTimeUntilExpiry(this.accessToken);\r\n      if (timeUntilExpiry <= 0) {\r\n        debugLog('MBA1111 getAccessToken: current token is expired, clearing it');\r\n        this.accessToken = null;\r\n      }\r\n    }\r\n    \r\n    // If no access token but we have refresh token, try to refresh\r\n    if (!this.accessToken && this.refreshToken) {\r\n      debugLog('MBA1111 getAccessToken: no access token but have refresh token, attempting refresh');\r\n      try {\r\n        await this.refreshTokens();\r\n      } catch (error) {\r\n        debugLog('MBA1111 getAccessToken: failed to refresh token:', error);\r\n        return null;\r\n      }\r\n    }\r\n    \r\n    // Check if current token needs refresh (but isn't expired yet)\r\n    if (this.accessToken && this.shouldRefreshToken(this.accessToken)) {\r\n      const timeUntilExpiry = this.getTimeUntilExpiry(this.accessToken);\r\n      if (timeUntilExpiry > 0) {\r\n        debugLog('MBA1111 getAccessToken: token needs refresh but still valid, attempting refresh');\r\n        try {\r\n          await this.refreshTokens();\r\n        } catch (error) {\r\n          debugLog('MBA1111 getAccessToken: failed to refresh token:', error);\r\n          // If refresh fails but token is still valid, return current token\r\n          if (this.getTimeUntilExpiry(this.accessToken) > 0) {\r\n            debugLog('MBA1111 getAccessToken: refresh failed but token still valid, returning current token');\r\n            return this.accessToken;\r\n          }\r\n          return null;\r\n        }\r\n      }\r\n    }\r\n    \r\n    if (this.accessToken) {\r\n      const timeUntilExpiry = this.getTimeUntilExpiry(this.accessToken);\r\n      if (timeUntilExpiry > 0) {\r\n        return this.accessToken;\r\n      } else {\r\n        debugLog('MBA1111 getAccessToken: token is expired, returning null');\r\n        this.accessToken = null;\r\n        return null;\r\n      }\r\n    } else {\r\n      debugLog('MBA1111 getAccessToken: returning null, no token available');\r\n      return null;\r\n    }\r\n  }\r\n\r\n  // Validate token with caching\r\n  async validateToken(token) {\r\n    const now = Date.now();\r\n    \r\n    // Use client-side validation for recent checks\r\n    if (this.lastValidation && now - this.lastValidation < this.VALIDATION_CACHE_TIME) {\r\n      debugLog('MBA1111 Using cached token validation');\r\n      const timeUntilExpiry = this.getTimeUntilExpiry(token);\r\n      return timeUntilExpiry > 0;\r\n    }\r\n    \r\n    debugLog('MBA1111 Performing server-side token validation');\r\n    try {\r\n      const response = await axios.post(`${API_BASE_URL}/api/token/verify/`, {\r\n        token: token\r\n      });\r\n\r\n      this.lastValidation = now;\r\n      // debugLog('MBA1111 Token validation successful');\r\n      return response.status === 200;\r\n    } catch (error) {\r\n      debugLog('MBA1111 Token validation failed:', error.response?.status);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  // Clear tokens from storage\r\n  async clearTokens() {\r\n    debugLog('MBA1111 Clearing tokens');\r\n    try {\r\n      if (Platform.OS === 'web') {\r\n        sessionStorage.removeItem('userToken');\r\n        sessionStorage.removeItem('refreshToken');\r\n      } else {\r\n        await AsyncStorage.multiRemove(['userToken', 'refreshToken']);\r\n      }\r\n      this.accessToken = null;\r\n      this.refreshToken = null;\r\n      \r\n      debugLog('MBA1111 Tokens cleared successfully');\r\n    } catch (error) {\r\n      console.error('MBA1111 Error clearing tokens:', error);\r\n    }\r\n  }\r\n\r\n  // Set tokens in storage\r\n  async setTokens(accessToken, refreshToken) {\r\n    debugLog('MBA1111 Setting tokens');\r\n    try {\r\n      this.accessToken = accessToken;\r\n      this.refreshToken = refreshToken;\r\n\r\n      if (Platform.OS === 'web') {\r\n        sessionStorage.setItem('userToken', accessToken);\r\n        sessionStorage.setItem('refreshToken', refreshToken);\r\n      } else {\r\n        await AsyncStorage.multiSet([\r\n          ['userToken', accessToken],\r\n          ['refreshToken', refreshToken]\r\n        ]);\r\n      }\r\n      \r\n      debugLog('MBA1111 Tokens set successfully');\r\n    } catch (error) {\r\n      console.error('MBA1111 Error setting tokens:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  // Initialize auth service\r\n  async initialize() {\r\n    debugLog('MBA1111 Starting AuthService.initialize()');\r\n    try {\r\n      let accessToken, refreshToken;\r\n      \r\n      accessToken = await getStorage('userToken');\r\n      refreshToken = await getStorage('refreshToken');\r\n      \r\n      this.accessToken = accessToken;\r\n      this.refreshToken = refreshToken;\r\n\r\n      debugLog('MBA1111 Tokens retrieved:', {\r\n        hasAccessToken: !!this.accessToken,\r\n        hasRefreshToken: !!this.refreshToken\r\n      });\r\n      \r\n      // Check if token needs immediate refresh\r\n      if (this.accessToken && this.shouldRefreshToken(this.accessToken)) {\r\n        debugLog('MBA1111 Token needs refresh during init');\r\n        try {\r\n          await this.refreshTokens();\r\n        } catch (err) {\r\n          debugLog('MBA1111 Failed to refresh token during init:', err);\r\n        }\r\n      }\r\n\r\n      return {\r\n        hasAccessToken: !!this.accessToken,\r\n        hasRefreshToken: !!this.refreshToken\r\n      };\r\n    } catch (error) {\r\n      console.error('MBA1111 Error in AuthService.initialize():', error);\r\n      return { hasAccessToken: false, hasRefreshToken: false };\r\n    }\r\n  }\r\n\r\n  // Force sign out with reason\r\n  forceSignOut(reason) {\r\n    if (this.isSigningOut) return;\r\n    \r\n    debugLog(`MBA1111 Force sign out triggered. Reason: ${reason}`);\r\n    this.isSigningOut = true;\r\n    \r\n    // Notify auth state change\r\n    this.notifyAuthStateChange({\r\n      type: 'FORCE_SIGN_OUT',\r\n      reason: reason,\r\n      timestamp: new Date().toISOString()\r\n    });\r\n  }\r\n}\r\n\r\nexport const AuthContext = createContext();\r\n\r\n// Storage helper functions\r\nexport const getStorage = async (key) => {\r\n  try {\r\n    if (Platform.OS === 'web') {\r\n      const value = sessionStorage.getItem(key);\r\n      // debugLog('MBA1111 getStorage web:', { key, hasValue: !!value });\r\n      return value;\r\n    } else {\r\n      const value = await AsyncStorage.getItem(key);\r\n      // debugLog('MBA1111 getStorage mobile:', { key, hasValue: !!value });\r\n      return value;\r\n    }\r\n  } catch (error) {\r\n    console.error('MBA1111 Error getting from storage:', error);\r\n    return null;\r\n  }\r\n};\r\n\r\nexport const setStorage = async (key, value) => {\r\n  try {\r\n    if (Platform.OS === 'web') {\r\n      sessionStorage.setItem(key, value);\r\n      debugLog('MBA1111 setStorage web:', { key, value });\r\n    } else {\r\n      await AsyncStorage.setItem(key, value);\r\n      debugLog('MBA1111 setStorage mobile:', { key, value });\r\n    }\r\n  } catch (error) {\r\n    console.error('MBA1111 Error setting storage:', error);\r\n  }\r\n};\r\n\r\n// Production flag\r\nconst is_PRODUCTION = false;\r\n\r\nexport const IsProduction = () => {\r\n  return is_PRODUCTION;\r\n};\r\n\r\nexport const AuthProvider = ({ children }) => {\r\n  const authService = useRef(new AuthService());\r\n  const isInitializedRef = useRef(false);\r\n  const signOutTimeoutRef = useRef(null);\r\n  \r\n  const [isSignedIn, setIsSignedIn] = useState(false);\r\n  const [userRole, setUserRole] = useState(null);\r\n  const [isApprovedProfessional, setIsApprovedProfessional] = useState(false);\r\n  const [loading, setLoading] = useState(true);\r\n  const [screenWidth, setScreenWidth] = useState(Dimensions.get('window').width);\r\n  const [firstName, setFirstName] = useState('');\r\n  const [name, setName] = useState('');\r\n  const [isCollapsed, setIsCollapsed] = useState(false);\r\n  const [timeSettings, setTimeSettings] = useState({\r\n    timezone: 'UTC',\r\n    timezone_abbrev: 'UTC',\r\n    use_military_time: false\r\n  });\r\n  const [is_prototype, setIsPrototype] = useState(false);\r\n  const [is_DEBUG, setIsDebug] = useState(true);\r\n\r\n  // Sign out function with comprehensive cleanup and reason tracking\r\n  const signOut = async (reason = 'user_action') => {\r\n    debugLog('MBA1111 signOut called with reason:', reason);\r\n    \r\n    try {\r\n      // Prevent concurrent sign out operations\r\n      if (authService.current.isSigningOut) {\r\n        debugLog('MBA1111 Sign out already in progress, skipping');\r\n        return;\r\n      }\r\n      \r\n      authService.current.isSigningOut = true;\r\n      \r\n      // Clear any pending sign out\r\n      if (signOutTimeoutRef.current) {\r\n        clearTimeout(signOutTimeoutRef.current);\r\n        signOutTimeoutRef.current = null;\r\n      }\r\n      \r\n      // Close websocket connection first\r\n      try {\r\n        const websocketManager = (await import('../utils/websocket')).default;\r\n        websocketManager.disconnect();\r\n        debugLog('MBA1111 WebSocket disconnected during signOut');\r\n      } catch (error) {\r\n        debugLog('MBA1111 Error disconnecting websocket:', error);\r\n      }\r\n      \r\n      // Clear tokens and storage\r\n      await authService.current.clearTokens();\r\n      await AsyncStorage.multiRemove(['userRole', 'isApprovedProfessional']);\r\n      \r\n      // Clear sessionStorage items for web\r\n      if (Platform.OS === 'web') {\r\n        sessionStorage.removeItem('userRole');\r\n        sessionStorage.removeItem('isApprovedProfessional');\r\n        sessionStorage.removeItem('currentProfessional');\r\n        sessionStorage.setItem('explicitSignOut', 'true');\r\n      }\r\n      \r\n      debugLog('MBA1111 Storage cleared during sign out');\r\n      \r\n      // Reset all auth state\r\n      setIsSignedIn(false);\r\n      setFirstName('');\r\n      setName('');\r\n      setUserRole(null);\r\n      setIsApprovedProfessional(false);\r\n      setTimeSettings({\r\n        timezone: 'UTC',\r\n        timezone_abbrev: 'UTC',\r\n        use_military_time: false\r\n      });\r\n      \r\n      // Clear auth service state\r\n      authService.current.accessToken = null;\r\n      authService.current.refreshToken = null;\r\n      \r\n      // Navigate to sign in\r\n      setTimeout(() => {\r\n        navigate('SignIn');\r\n      }, 0);\r\n      \r\n      debugLog('MBA1111 Sign out completed successfully');\r\n      \r\n    } catch (error) {\r\n      debugLog('MBA1111 Error during sign out:', error);\r\n    } finally {\r\n      authService.current.isSigningOut = false;\r\n    }\r\n  };\r\n\r\n  // Listen for auth state changes from AuthService\r\n  useEffect(() => {\r\n    const unsubscribe = authService.current.onAuthStateChange((state) => {\r\n      debugLog('MBA1111 Auth state change received:', state);\r\n      \r\n      if (state.type === 'FORCE_SIGN_OUT') {\r\n        // Clear the signing out flag and trigger sign out\r\n        authService.current.isSigningOut = false;\r\n        signOut(state.reason);\r\n      }\r\n    });\r\n\r\n    return unsubscribe;\r\n  }, []);\r\n\r\n  // Set up axios interceptors with consolidated error handling\r\n  useEffect(() => {\r\n    debugLog('MBA1111 Setting up consolidated axios interceptors');\r\n    \r\n    // Circuit breaker for 401 errors\r\n    let consecutiveAuth401Errors = 0;\r\n    const MAX_401_RETRIES = 3;\r\n    \r\n    const requestInterceptor = axios.interceptors.request.use(\r\n      async (config) => {\r\n        // debugLog(`MBA1111 Request interceptor called for: ${config.method?.toUpperCase()} ${config.url}`);\r\n        \r\n        if (!is_prototype) {\r\n          try {\r\n            const token = await authService.current.getAccessToken();\r\n            if (token) {\r\n              config.headers.Authorization = `Bearer ${token}`;\r\n              // debugLog(`MBA1111 Token added to request: ${config.method?.toUpperCase()} ${config.url}`);\r\n            } else {\r\n              debugLog(`MBA1111 No token available for request: ${config.method?.toUpperCase()} ${config.url}`);\r\n            }\r\n          } catch (error) {\r\n            console.error('MBA1111 Error getting access token for request:', error);\r\n            debugLog(`MBA1111 Token error for request: ${config.method?.toUpperCase()} ${config.url}`, error);\r\n          }\r\n        } else {\r\n          debugLog(`MBA1111 Prototype mode - skipping token for: ${config.method?.toUpperCase()} ${config.url}`);\r\n        }\r\n        \r\n        return config;\r\n      },\r\n      (error) => {\r\n        debugLog('MBA1111 Request interceptor error:', error);\r\n        return Promise.reject(error);\r\n      }\r\n    );\r\n\r\n    const responseInterceptor = axios.interceptors.response.use(\r\n      (response) => {\r\n        // debugLog(`MBA1111 Response success: ${response.status} ${response.config.method?.toUpperCase()} ${response.config.url}`);\r\n        // Reset circuit breaker on successful response\r\n        consecutiveAuth401Errors = 0;\r\n        return response;\r\n      },\r\n      async (error) => {\r\n        const originalRequest = error.config;\r\n        debugLog(`MBA1111 Response error: ${error.response?.status} ${error.config.method?.toUpperCase()} ${error.config.url}`);\r\n        \r\n        // Handle 401 errors with circuit breaker\r\n        if (error.response?.status === 401 && !originalRequest._retry) {\r\n          consecutiveAuth401Errors++;\r\n          debugLog(`MBA1111 401 error detected (${consecutiveAuth401Errors}/${MAX_401_RETRIES}), attempting token refresh`);\r\n          \r\n          // Circuit breaker: Stop trying after too many consecutive failures\r\n          if (consecutiveAuth401Errors >= MAX_401_RETRIES) {\r\n            debugLog('MBA1111 Circuit breaker triggered: Too many consecutive 401 errors, forcing sign out');\r\n            authService.current.forceSignOut('too_many_auth_failures');\r\n            return Promise.reject(error);\r\n          }\r\n          \r\n          originalRequest._retry = true;\r\n          \r\n          try {\r\n            // Skip auth logging calls to prevent infinite loops\r\n            const isAuthLoggingCall = originalRequest.url?.includes('/api/core/log-auth-event/');\r\n            \r\n            if (!isAuthLoggingCall) {\r\n              // Only attempt refresh for non-logging calls\r\n              debugLog('MBA1111 Attempting token refresh for failed request');\r\n              \r\n              // Add timeout to token refresh\r\n              const refreshPromise = authService.current.refreshTokens();\r\n              const timeoutPromise = new Promise((_, reject) => \r\n                setTimeout(() => reject(new Error('Token refresh timeout')), 8000)\r\n              );\r\n              \r\n              await Promise.race([refreshPromise, timeoutPromise]);\r\n              \r\n              // Retry original request with new token\r\n              const newToken = await authService.current.getAccessToken();\r\n              if (newToken) {\r\n                originalRequest.headers.Authorization = `Bearer ${newToken}`;\r\n                debugLog('MBA1111 Retrying request with new token');\r\n                return axios(originalRequest);\r\n              } else {\r\n                debugLog('MBA1111 No new token available after refresh');\r\n                throw new Error('No token available after refresh');\r\n              }\r\n            } else {\r\n              // For auth logging calls, just fail silently\r\n              debugLog('MBA1111 Auth logging call failed, not retrying to prevent loops');\r\n              throw error;\r\n            }\r\n          } catch (refreshError) {\r\n            debugLog('MBA1111 Token refresh failed:', refreshError);\r\n            \r\n            // If this was a timeout or repeated failure, force sign out\r\n            if (refreshError.message.includes('timeout') || consecutiveAuth401Errors >= 2) {\r\n              debugLog('MBA1111 Token refresh timeout or repeated failure, forcing sign out');\r\n              authService.current.forceSignOut('token_refresh_failed');\r\n            }\r\n            \r\n            throw error;\r\n          }\r\n        }\r\n        \r\n        return Promise.reject(error);\r\n      }\r\n    );\r\n\r\n    return () => {\r\n      axios.interceptors.request.eject(requestInterceptor);\r\n      axios.interceptors.response.eject(responseInterceptor);\r\n    };\r\n  }, [is_prototype]);\r\n\r\n  // Window focus handling with proper debouncing\r\n  useEffect(() => {\r\n    if (!isSignedIn || is_prototype) return;\r\n    \r\n    let focusCheckTimeout = null;\r\n    \r\n    const handleWindowFocus = () => {\r\n      // Clear any pending check\r\n      if (focusCheckTimeout) {\r\n        clearTimeout(focusCheckTimeout);\r\n      }\r\n      \r\n      // Debounce the focus check\r\n      focusCheckTimeout = setTimeout(async () => {\r\n        // debugLog('MBA1111 Window regained focus, checking token');\r\n        \r\n        if (authService.current && !authService.current.isSigningOut) {\r\n          const token = authService.current.accessToken;\r\n          if (token && authService.current.shouldRefreshToken(token)) {\r\n            debugLog('MBA1111 Token needs refresh on focus');\r\n            try {\r\n              await authService.current.refreshTokens();\r\n            } catch (error) {\r\n              debugLog('MBA1111 Error refreshing token on focus:', error);\r\n            }\r\n          }\r\n        }\r\n      }, 500); // 500ms debounce\r\n    };\r\n    \r\n    // Set up event listeners only for web\r\n    if (Platform.OS === 'web' && typeof window !== 'undefined') {\r\n      window.addEventListener('focus', handleWindowFocus);\r\n      \r\n      document.addEventListener('visibilitychange', () => {\r\n        if (document.visibilityState === 'visible') {\r\n          handleWindowFocus();\r\n        }\r\n      });\r\n    }\r\n    \r\n    return () => {\r\n      if (focusCheckTimeout) {\r\n        clearTimeout(focusCheckTimeout);\r\n      }\r\n      \r\n      if (Platform.OS === 'web' && typeof window !== 'undefined') {\r\n        window.removeEventListener('focus', handleWindowFocus);\r\n        document.removeEventListener('visibilitychange', handleWindowFocus);\r\n      }\r\n    };\r\n  }, [isSignedIn, is_prototype]);\r\n\r\n  // Initialize auth state\r\n  useEffect(() => {\r\n    const init = async () => {\r\n      if (isInitializedRef.current) return;\r\n      \r\n      try {\r\n        debugLog('MBA1111 Initializing auth state');\r\n        const { hasAccessToken, hasRefreshToken } = await authService.current.initialize();\r\n        \r\n        if (hasAccessToken || hasRefreshToken) {\r\n          const token = await authService.current.getAccessToken();\r\n          if (token) {\r\n            const isValid = await authService.current.validateToken(token);\r\n            if (isValid) {\r\n              setIsSignedIn(true);\r\n              await fetchUserName();\r\n              const status = await getProfessionalStatus(token);\r\n              \r\n              // Check for stored user role preference first\r\n              let storedRole = null;\r\n              try {\r\n                storedRole = await getStorage('userRole');\r\n              } catch (error) {\r\n                console.error('MBA1111 Error getting stored role:', error);\r\n              }\r\n              \r\n              // Use stored role if valid, otherwise use suggested role\r\n              const finalRole = (storedRole && (storedRole === 'professional' || storedRole === 'petOwner')) \r\n                ? storedRole \r\n                : status.suggestedRole;\r\n              \r\n              debugLog('MBA1111 Role selection:', { \r\n                storedRole, \r\n                suggestedRole: status.suggestedRole, \r\n                finalRole,\r\n                isApprovedProfessional: status.isApprovedProfessional \r\n              });\r\n              \r\n              setUserRole(finalRole);\r\n              setIsApprovedProfessional(status.isApprovedProfessional);\r\n              await fetchTimeSettings();\r\n            } else {\r\n              await signOut('token_validation_failed');\r\n            }\r\n          } else {\r\n            await signOut('no_valid_token');\r\n          }\r\n        } else {\r\n          // No tokens available - this is normal for new users\r\n          debugLog('MBA1111 No tokens found during initialization');\r\n        }\r\n      } catch (error) {\r\n        console.error('MBA1111 Error initializing auth state:', error);\r\n        await signOut('initialization_error');\r\n      } finally {\r\n        setLoading(false);\r\n        isInitializedRef.current = true;\r\n      }\r\n    };\r\n\r\n    init();\r\n  }, []);\r\n\r\n  // Fetch user name\r\n  const fetchUserName = async () => {\r\n    try {\r\n      debugLog('MBA1111 Fetching user name');\r\n      const userData = await getUserName();\r\n      debugLog('MBA1111 User name response:', userData);\r\n      setFirstName(userData.first_name);\r\n      setName(userData.name);\r\n    } catch (error) {\r\n      console.error('MBA1111 Error fetching user name:', error.response ? error.response.data : error.message);\r\n      setFirstName('');\r\n      setName('');\r\n    }\r\n  };\r\n\r\n  // Get professional status\r\n  const getProfessionalStatus = async (token) => {\r\n    try {\r\n      const response = await axios.get(`${API_BASE_URL}/api/professional-status/v1/`, {\r\n        headers: { Authorization: `Bearer ${token}` }\r\n      });\r\n      \r\n      debugLog('MBA1111 Professional status response:', response.data);\r\n\r\n      const { is_approved } = response.data;\r\n      \r\n      setIsApprovedProfessional(is_approved);\r\n      if (Platform.OS === 'web') {\r\n        sessionStorage.setItem('isApprovedProfessional', String(is_approved));\r\n      } else {\r\n        await AsyncStorage.setItem('isApprovedProfessional', String(is_approved));\r\n      }\r\n\r\n      return {\r\n        isApprovedProfessional: is_approved,\r\n        suggestedRole: is_approved ? 'professional' : 'petOwner'\r\n      };\r\n    } catch (error) {\r\n      console.error('MBA1111 Error getting professional status:', error.response?.data || error);\r\n      return {\r\n        isApprovedProfessional: false,\r\n        suggestedRole: 'petOwner'\r\n      };\r\n    }\r\n  };\r\n\r\n  // Sign in function\r\n  const signIn = async (token, refreshTokenValue, navigation) => {\r\n    try {\r\n      debugLog('MBA1111 Starting sign in process');\r\n\r\n      // Clear signing out flag\r\n      authService.current.isSigningOut = false;\r\n      \r\n      await authService.current.setTokens(token, refreshTokenValue);\r\n      setIsSignedIn(true);\r\n      \r\n      // Fetch user name immediately after setting tokens\r\n      await fetchUserName();\r\n      \r\n      // Fetch time settings immediately to ensure they're available\r\n      try {\r\n        const timeSettingsData = await getTimeSettings();\r\n        setTimeSettings(timeSettingsData);\r\n        debugLog('MBA1111 Time settings fetched during sign in:', timeSettingsData);\r\n      } catch (timeError) {\r\n        console.error('MBA1111 Error fetching time settings during sign in:', timeError);\r\n      }\r\n      \r\n      const status = await getProfessionalStatus(token);\r\n      const initialRole = status.suggestedRole;\r\n      \r\n      setUserRole(initialRole);\r\n      setIsApprovedProfessional(status.isApprovedProfessional);\r\n      \r\n      // Store the role\r\n      if (Platform.OS === 'web') {\r\n        sessionStorage.setItem('userRole', initialRole);\r\n      } else {\r\n        await AsyncStorage.setItem('userRole', initialRole);\r\n      }\r\n\r\n      debugLog('MBA1111 Sign in successful:', { initialRole, isApprovedProfessional: status.isApprovedProfessional });\r\n\r\n      // Navigate to dashboard after successful sign in\r\n      if (navigation) {\r\n        setTimeout(() => {\r\n          navigateToFrom(navigation, 'Dashboard', 'SignIn');\r\n        }, 0);\r\n      }\r\n\r\n      return {\r\n        userRole: initialRole,\r\n        isApprovedProfessional: status.isApprovedProfessional\r\n      };\r\n    } catch (error) {\r\n      debugLog('MBA1111 Sign in error:', error);\r\n      console.error('MBA1111 Error during sign in:', error);\r\n      throw error;\r\n    }\r\n  };\r\n\r\n  // Switch role function\r\n  const switchRole = async (navigation) => {\r\n    if (isApprovedProfessional) {\r\n      debugLog('MBA1111 Switching role, current role:', userRole);\r\n      \r\n      const newRole = userRole === 'professional' ? 'petOwner' : 'professional';\r\n      setUserRole(newRole);\r\n      try {\r\n        if (Platform.OS === \"web\") {\r\n          sessionStorage.setItem('userRole', newRole);\r\n        } else {\r\n          await AsyncStorage.setItem('userRole', newRole);\r\n        }\r\n        \r\n        // Navigate to Dashboard if switching to pet owner from Connections screen\r\n        const currentRoute = navigation?.getCurrentRoute?.()?.name;\r\n        if (newRole === 'petOwner' && currentRoute === 'Connections') {\r\n          debugLog('MBA1111 Navigating to Dashboard from Connections when switching to pet owner');\r\n          navigate('Dashboard');\r\n        }\r\n        \r\n        debugLog('MBA1111 Role switched to:', newRole);\r\n      } catch (error) {\r\n        console.error('MBA1111 Error updating role in storage:', error);\r\n      }\r\n    } else {\r\n      console.log('MBA1111 User is not an approved professional, cannot switch roles');\r\n    }\r\n  };\r\n\r\n  // Fetch time settings\r\n  const fetchTimeSettings = async () => {\r\n    if (is_prototype) return;\r\n    \r\n    try {\r\n      const settings = await getTimeSettings();\r\n      setTimeSettings(settings);\r\n      debugLog('MBA1111 Time settings response:', settings);\r\n    } catch (error) {\r\n      console.error('MBA1111 Error fetching time settings:', error.response ? error.response.data : error.message);\r\n    }\r\n  };\r\n\r\n  // Check auth status\r\n  const checkAuthStatus = async () => {\r\n    try {\r\n      const token = await authService.current.getAccessToken();\r\n      if (!token) {\r\n        return { isAuthenticated: false };\r\n      }\r\n\r\n      const isValid = await authService.current.validateToken(token);\r\n      if (!isValid) {\r\n        await signOut('auth_status_check_failed');\r\n        return { isAuthenticated: false };\r\n      }\r\n\r\n      debugLog('MBA1111 checkAuthStatus', { isAuthenticated: true, userRole, isApprovedProfessional });\r\n\r\n      return {\r\n        isAuthenticated: true,\r\n        userRole: userRole,\r\n        isApprovedProfessional: isApprovedProfessional\r\n      };\r\n    } catch (error) {\r\n      console.error('MBA1111 Error checking auth status:', error);\r\n      return { isAuthenticated: false };\r\n    }\r\n  };\r\n\r\n  // Screen width handling\r\n  useEffect(() => {\r\n    const handleDimensionsChange = ({ window }) => {\r\n      setScreenWidth(window.width);\r\n    };\r\n\r\n    const subscription = Dimensions.addEventListener('change', handleDimensionsChange);\r\n\r\n    return () => {\r\n      if (subscription?.remove) {\r\n        subscription.remove();\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  // State consistency checker\r\n  useEffect(() => {\r\n    if (loading || is_prototype) return;\r\n    \r\n    const checkStateConsistency = async () => {\r\n      try {\r\n        const hasStoredTokens = !!(await getStorage('userToken')) || !!(await getStorage('refreshToken'));\r\n        const hasMemoryTokens = !!(authService.current.accessToken) || !!(authService.current.refreshToken);\r\n        \r\n        // debugLog('MBA1111 State consistency check:', {\r\n        //   isSignedIn,\r\n        //   hasStoredTokens,\r\n        //   hasMemoryTokens,\r\n        //   isSigningOut: authService.current.isSigningOut\r\n        // });\r\n        \r\n        // If we think user is signed in but no tokens exist anywhere\r\n        if (isSignedIn && !hasStoredTokens && !hasMemoryTokens && !authService.current.isSigningOut) {\r\n          debugLog('MBA1111 STATE INCONSISTENCY DETECTED: UI shows signed in but no tokens exist');\r\n          await signOut('state_inconsistency_no_tokens');\r\n          return;\r\n        }\r\n        \r\n        // If we think user is not signed in but tokens exist\r\n        if (!isSignedIn && (hasStoredTokens || hasMemoryTokens) && !authService.current.isSigningOut) {\r\n          debugLog('MBA1111 STATE INCONSISTENCY DETECTED: UI shows signed out but tokens exist');\r\n          \r\n          // Try to restore the session\r\n          try {\r\n            const token = await authService.current.getAccessToken();\r\n            if (token) {\r\n              const isValid = await authService.current.validateToken(token);\r\n              if (isValid) {\r\n                debugLog('MBA1111 Restoring session with valid tokens');\r\n                \r\n                setIsSignedIn(true);\r\n                await fetchUserName();\r\n                const status = await getProfessionalStatus(token);\r\n                setUserRole(status.suggestedRole);\r\n                setIsApprovedProfessional(status.isApprovedProfessional);\r\n                return;\r\n              }\r\n            }\r\n          } catch (error) {\r\n            debugLog('MBA1111 Failed to restore session:', error);\r\n          }\r\n          \r\n          // If restoration failed, clear everything\r\n          await signOut('state_inconsistency_invalid_tokens');\r\n        }\r\n      } catch (error) {\r\n        debugLog('MBA1111 Error in state consistency check:', error);\r\n      }\r\n    };\r\n    \r\n    // Run initial check after a delay\r\n    const initialCheck = setTimeout(checkStateConsistency, 2000);\r\n    \r\n    // Run periodic checks every 30 seconds\r\n    const consistencyInterval = setInterval(checkStateConsistency, 30000);\r\n    \r\n    return () => {\r\n      clearTimeout(initialCheck);\r\n      clearInterval(consistencyInterval);\r\n    };\r\n  }, [isSignedIn, loading, is_prototype]);\r\n\r\n  // Token refresh monitoring with PROACTIVE refresh triggers\r\n  useEffect(() => {\r\n    if (!isSignedIn || is_prototype) return;\r\n    \r\n    const monitorAndRefreshToken = async () => {\r\n      try {\r\n        // Get the current token (this will automatically refresh if needed)\r\n        const token = await authService.current.getAccessToken();\r\n        \r\n        if (token) {\r\n          const timeUntilExpiry = authService.current.getTimeUntilExpiry(token);\r\n          const shouldRefresh = authService.current.shouldRefreshToken(token);\r\n          \r\n          if (timeUntilExpiry < 0) {\r\n            debugLog('MBA1111 TOKEN EXPIRED DETECTED in monitor');\r\n          }\r\n          \r\n          // PROACTIVE REFRESH: If token should be refreshed, trigger it now\r\n          if (shouldRefresh && !authService.current.isRefreshing) {\r\n            debugLog('MBA1111 Token monitor triggering proactive refresh');\r\n            try {\r\n              await authService.current.refreshTokens();\r\n              debugLog('MBA1111 Proactive token refresh completed successfully');\r\n            } catch (error) {\r\n              debugLog('MBA1111 Proactive token refresh failed:', error);\r\n            }\r\n          }\r\n        } else {\r\n          debugLog('MBA1111 Token monitor: No token available');\r\n        }\r\n      } catch (error) {\r\n        debugLog('MBA1111 Error in token monitor:', error);\r\n      }\r\n    };\r\n    \r\n    // Monitor every 2 seconds during testing\r\n    const monitorInterval = setInterval(monitorAndRefreshToken, 2000);\r\n    \r\n    return () => clearInterval(monitorInterval);\r\n  }, [isSignedIn, is_prototype]);\r\n\r\n  // Debug function to check token status\r\n  const debugTokenStatus = () => {\r\n    const token = authService.current.accessToken;\r\n    if (!token) {\r\n      debugLog('MBA1111 No access token available');\r\n      return;\r\n    }\r\n    \r\n    const timeUntilExpiry = authService.current.getTimeUntilExpiry(token);\r\n    const isExpired = timeUntilExpiry <= 0;\r\n    const shouldRefresh = authService.current.shouldRefreshToken(token);\r\n    \r\n    debugLog('MBA1111 Token status:', {\r\n      hasToken: !!token,\r\n      timeUntilExpirySeconds: Math.round(timeUntilExpiry / 1000),\r\n      isExpired,\r\n      shouldRefresh,\r\n      isRefreshing: authService.current.isRefreshing,\r\n      isSigningOut: authService.current.isSigningOut\r\n    });\r\n  };\r\n\r\n  return (\r\n    <AuthContext.Provider\r\n      value={{\r\n        isSignedIn,\r\n        userRole,\r\n        isApprovedProfessional,\r\n        loading,\r\n        screenWidth,\r\n        firstName,\r\n        name,\r\n        is_prototype,\r\n        is_DEBUG,\r\n        is_PRODUCTION,\r\n        timeSettings,\r\n        isCollapsed,\r\n        setIsCollapsed,\r\n        signIn,\r\n        signOut,\r\n        switchRole,\r\n        setIsDebug,\r\n        setIsPrototype,\r\n        checkAuthStatus,\r\n        fetchTimeSettings,\r\n        debugTokenStatus,\r\n      }}\r\n    >\r\n      {children}\r\n    </AuthContext.Provider>\r\n  );\r\n};\r\n","import React, { createContext, useState, useEffect, useContext, useRef } from 'react';\r\nimport { AuthContext, debugLog } from './AuthContext';\r\nimport { getUnreadMessageCount } from '../api/API';\r\nimport websocketManager from '../utils/websocket';\r\nimport { getStorage } from './AuthContext';\r\nimport { Platform } from 'react-native';\r\n\r\n// Create the context\r\nexport const MessageNotificationContext = createContext();\r\n\r\nexport const MessageNotificationProvider = ({ children }) => {\r\n  const [hasUnreadMessages, setHasUnreadMessages] = useState(false);\r\n  const [unreadCount, setUnreadCount] = useState(0);\r\n  const [conversationCounts, setConversationCounts] = useState({});\r\n  const [currentRoute, setCurrentRoute] = useState('');\r\n  const [websocketInitialized, setWebsocketInitialized] = useState(false);\r\n  const [lastApiCheck, setLastApiCheck] = useState(0);\r\n  const { isSignedIn } = useContext(AuthContext);\r\n  \r\n  // Use refs to track initialization state and prevent duplicate calls\r\n  const initialCheckDoneRef = useRef(false);\r\n  const pendingCheckRef = useRef(false);\r\n  const reconnectIntervalRef = useRef(null);\r\n  const debounceTimerRef = useRef(null);\r\n  const websocketDataReceivedRef = useRef(false);\r\n  const lastCheckTimeRef = useRef(0);  // Track last time we checked\r\n  const MIN_CHECK_INTERVAL = 5000; // Minimum 5 seconds between API checks\r\n  \r\n  // Add ref for tracking fallback strategy\r\n  const websocketTimeoutRef = useRef(null);\r\n  const websocketRetryAttemptsRef = useRef(0);\r\n  const MAX_WEBSOCKET_RETRIES = 12; // After 12 retries (60 seconds), fall back to API\r\n  const WEBSOCKET_RETRY_INTERVAL = 5000; // 5 second wait between retries\r\n  \r\n  // Add connection status tracking\r\n  const lastHeartbeatReceivedRef = useRef(0);\r\n  const lastHeartbeatSentRef = useRef(0);\r\n  const heartbeatTimeoutRef = useRef(null);\r\n  const connectionHealthyRef = useRef(true); // Track if connection is healthy\r\n  const HEARTBEAT_TIMEOUT = 40000; // 40 seconds timeout for heartbeat responses\r\n  \r\n  // Add session-based flag to track if we already made an API call in this session\r\n  const initialApiCallMadeRef = useRef(false);\r\n\r\n  // Add cache for the API response\r\n  const [lastApiResponse, setLastApiResponse] = useState(null);\r\n  const WEBSOCKET_DATA_LIFETIME = 30000; // Consider WebSocket data valid for 30 seconds\r\n  const CACHE_LIFETIME = 300000; // Consider API cache valid for 5 minutes (increased from 2)\r\n\r\n  // Add a lastApiCheckRef at the top of the component with other refs\r\n  const lastApiCheckRef = useRef(0);\r\n\r\n  // Function to check if we have unread messages based on conversations\r\n  const checkUnreadMessages = async (force = false) => {\r\n    try {\r\n      // If there's already a check in progress, don't start another one\r\n      if (pendingCheckRef.current) {\r\n        debugLog('MBA4321: Skipping unread check - another check is already in progress');\r\n        return hasUnreadMessages;\r\n      }\r\n      \r\n      // Stack trace logging to help identify what's triggering API calls\r\n      const stackTrace = new Error().stack;\r\n      debugLog(`MBA4321: checkUnreadMessages called from:\\n${stackTrace}`);\r\n      \r\n      // Set pending flag before proceeding\r\n      pendingCheckRef.current = true;\r\n      \r\n      // For forced refreshes, we should just make the API call immediately\r\n      if (force) {\r\n        debugLog('MBA432wihe21: Forced API call for unread messages');\r\n        return await makeApiCall();\r\n      }\r\n\r\n      // NEW LOGIC: Check if websocket is connected first\r\n      const websocketConnected = websocketManager && websocketManager.isWebSocketConnected();\r\n      debugLog(`MBA4321: WebSocket connected: ${websocketConnected}`);\r\n      \r\n      // If WebSocket is connected and we've received data, return current state - no API call needed\r\n      if (websocketConnected && websocketDataReceivedRef.current) {\r\n        debugLog('MBA4321: WebSocket is connected and data received, using current state');\r\n        pendingCheckRef.current = false;\r\n        return hasUnreadMessages;\r\n      }\r\n      \r\n      // Check if this is a page load (first time check)\r\n      if (!initialApiCallMadeRef.current) {\r\n        debugLog('MBA4321: First check on page load, implementing progressive WebSocket wait');\r\n        \r\n        // Clear any existing timeout\r\n        if (websocketTimeoutRef.current) {\r\n          clearTimeout(websocketTimeoutRef.current);\r\n        }\r\n        \r\n        // Wait for WebSocket using progressive checks, with final API fallback\r\n        return await waitForWebSocketWithFallback();\r\n      }\r\n      \r\n      // We already made an initial call for this session and WebSocket isn't connected\r\n      // However, we're not forcing a refresh, so just use current state\r\n      debugLog('MBA4321: Using existing state, we already made an initial API call');\r\n      pendingCheckRef.current = false;\r\n      return hasUnreadMessages;\r\n    } catch (error) {\r\n      debugLog('MBA4321: Error in checkUnreadMessages:', error);\r\n      pendingCheckRef.current = false;\r\n      return hasUnreadMessages;\r\n    }\r\n  };\r\n\r\n  // Function to wait for WebSocket with progressive checks and final API fallback\r\n  const waitForWebSocketWithFallback = async () => {\r\n    // Reset attempt counter\r\n    websocketRetryAttemptsRef.current = 0;\r\n    \r\n    // IMPORTANT: If this is a fresh page load, ALWAYS make an API call first to get accurate state\r\n    // The problem was that we would rely only on WebSocket which might miss messages that arrived\r\n    // while the user was offline\r\n    if (!initialApiCallMadeRef.current) {\r\n      debugLog('MBA432wihe21: Fresh page load - making initial API call to get accurate unread count');\r\n      return await makeApiCall();\r\n    }\r\n    \r\n    return new Promise((resolve) => {\r\n      // Define the progressive check function\r\n      const checkWebSocketAndWait = () => {\r\n        // First check if WebSocket is connected\r\n        const connected = websocketManager && websocketManager.isWebSocketConnected();\r\n        \r\n        // Check if we've received any data (either from WebSocket or separate handlers)\r\n        if (websocketDataReceivedRef.current) {\r\n          debugLog('MBA4321: WebSocket data received during wait, using current state');\r\n          pendingCheckRef.current = false;\r\n          resolve(hasUnreadMessages);\r\n          return;\r\n        }\r\n        \r\n        // Increment attempt counter\r\n        websocketRetryAttemptsRef.current++;\r\n        debugLog(`MBA4321: WebSocket wait attempt ${websocketRetryAttemptsRef.current}/${MAX_WEBSOCKET_RETRIES}, connected: ${connected}`);\r\n        \r\n        // If connected, send a heartbeat to check if we get a response\r\n        if (connected) {\r\n          debugLog('MBA4321: WebSocket is connected, sending heartbeat request');\r\n          websocketManager.send('heartbeat', { timestamp: Date.now() });\r\n          lastHeartbeatSentRef.current = Date.now();\r\n        }\r\n        \r\n        // If reached max attempts, fall back to API\r\n        if (websocketRetryAttemptsRef.current >= MAX_WEBSOCKET_RETRIES) {\r\n          debugLog('MBA432wihe21: Max WebSocket wait attempts reached, falling back to API');\r\n          // Make the API call and resolve with its result\r\n          makeApiCall().then(result => resolve(result));\r\n          return;\r\n        }\r\n        \r\n        // Schedule next check (after 5-second wait)\r\n        websocketTimeoutRef.current = setTimeout(checkWebSocketAndWait, WEBSOCKET_RETRY_INTERVAL);\r\n      };\r\n      \r\n      // Start the first check\r\n      checkWebSocketAndWait();\r\n    });\r\n  };\r\n  \r\n  // Extract API call logic to separate function\r\n  const makeApiCall = async () => {\r\n    // Add new logging with the special prefix\r\n    debugLog('MBA432wihe21: makeApiCall called, checking if necessary');\r\n    \r\n    // Check if we've made an API call in the last minute (60000ms)\r\n    // This prevents frequent API calls which can disrupt components like BookingApprovalModal\r\n    const now = Date.now();\r\n    const timeSinceLastCheck = now - lastApiCheckRef.current;\r\n    \r\n    // Skip API calls if we've checked in the last minute, unless the connection is unhealthy\r\n    if (timeSinceLastCheck < 60000 && websocketDataReceivedRef.current && connectionHealthyRef.current) {\r\n      debugLog('MBA432wihe21: Skipping API call - checked recently and connection is healthy');\r\n      return hasUnreadMessages;\r\n    }\r\n    \r\n    debugLog('MBA432wihe21: Making API call for unread messages');\r\n    \r\n    try {\r\n      // Call the API to get unread message count\r\n      const result = await getUnreadMessageCount();\r\n      const count = result.unread_count || 0;\r\n      const conversationUnreadCounts = result.conversation_counts || {};\r\n      \r\n      debugLog('MBA432wihe21: Unread message count from API:', count);\r\n      \r\n      // Update the API response cache\r\n      setLastApiResponse({\r\n        unread_count: count,\r\n        conversation_counts: conversationUnreadCounts,\r\n        timestamp: now\r\n      });\r\n      \r\n      // Update state based on API response\r\n      setUnreadCount(count);\r\n      setHasUnreadMessages(count > 0);\r\n      setConversationCounts(conversationUnreadCounts);\r\n      setLastApiCheck(now);\r\n      lastCheckTimeRef.current = now;\r\n      lastApiCheckRef.current = now;\r\n      \r\n      // Mark initialization as complete\r\n      initialCheckDoneRef.current = true;\r\n      \r\n      // Mark that we've made an API call in this session\r\n      initialApiCallMadeRef.current = true;\r\n      \r\n      // Mark that we've received data\r\n      websocketDataReceivedRef.current = true;\r\n      \r\n      // Clear pending flag\r\n      pendingCheckRef.current = false;\r\n      \r\n      return count > 0;\r\n    } catch (error) {\r\n      debugLog('MBA432wihe21: Error in API call:', error);\r\n      pendingCheckRef.current = false;\r\n      return hasUnreadMessages;\r\n    }\r\n  };\r\n\r\n  // Debounced version of checkUnreadMessages to prevent excessive API calls\r\n  const debouncedCheckUnreadMessages = (force = false) => {\r\n    // Clear any existing timer\r\n    if (debounceTimerRef.current) {\r\n      clearTimeout(debounceTimerRef.current);\r\n    }\r\n    \r\n    // Set a new timer to delay the API call\r\n    debounceTimerRef.current = setTimeout(() => {\r\n      checkUnreadMessages(force);\r\n      debounceTimerRef.current = null;\r\n    }, 300); // 300ms debounce time\r\n  };\r\n\r\n  // Check how many unread messages a specific conversation has\r\n  const getConversationUnreadCount = (conversationId) => {\r\n    if (!conversationId) return 0;\r\n    return conversationCounts[conversationId] || 0;\r\n  };\r\n\r\n  // Check if user is currently on the Messages screen\r\n  const isOnMessagesScreen = () => {\r\n    return currentRoute === 'MessageHistory';\r\n  };\r\n\r\n  // Helper to handle new message notifications\r\n  const handleNewMessageNotification = (conversationId = null) => {\r\n    // Only update unread count if user is not on messages screen\r\n    // or if they're on messages screen but not viewing this conversation\r\n    debugLog(`MBA4321: Adding unread message notification for conversation ${conversationId}`);\r\n    setHasUnreadMessages(true);\r\n    setUnreadCount(prevCount => {\r\n      const newCount = prevCount + 1;\r\n      debugLog(`MBA4321: Increasing total unread count from ${prevCount} to ${newCount}`);\r\n      return newCount;\r\n    });\r\n    \r\n    // If we have a conversation ID, update that count too\r\n    if (conversationId) {\r\n      setConversationCounts(prevCounts => {\r\n        const prevConvCount = prevCounts[conversationId] || 0;\r\n        const newConvCount = prevConvCount + 1;\r\n        \r\n        debugLog(`MBA4321: Conversation ${conversationId} unread count: ${prevConvCount} → ${newConvCount}`);\r\n        \r\n        return {\r\n          ...prevCounts,\r\n          [conversationId]: newConvCount\r\n        };\r\n      });\r\n    }\r\n  };\r\n\r\n  // Function to handle incoming new messages\r\n  const onNewMessage = (messageData) => {\r\n    debugLog('MBA4321: onNewMessage called with data:', messageData);\r\n    \r\n    // Only create notification if the message is from another user\r\n    if (messageData && messageData.sent_by_other_user) {\r\n      const conversationId = messageData.conversation_id;\r\n      \r\n      // Check if user is viewing this specific conversation\r\n      if (isOnMessagesScreen() && conversationId && \r\n          String(conversationId) === String(window.selectedConversationId)) {\r\n        debugLog('MBA4321: User is viewing this specific conversation, not creating notification');\r\n        return;\r\n      }\r\n      \r\n      // Log which conversation is getting a new message notification\r\n      debugLog(`MBA4321: New message from ${messageData.sender_name || 'unknown'} in conversation ${conversationId}`);\r\n      \r\n      // Handle notification with conversation ID\r\n      handleNewMessageNotification(conversationId);\r\n      \r\n      // Mark that we've received data from WebSocket\r\n      websocketDataReceivedRef.current = true;\r\n      \r\n      // Also update the API response cache with this new count\r\n      // Update the cached counts if we have them\r\n      if (lastApiResponse) {\r\n        const updatedCounts = { ...lastApiResponse.conversation_counts };\r\n        updatedCounts[conversationId] = (updatedCounts[conversationId] || 0) + 1;\r\n        \r\n        setLastApiResponse({\r\n          unread_count: lastApiResponse.unread_count + 1,\r\n          conversation_counts: updatedCounts,\r\n          timestamp: Date.now()\r\n        });\r\n      }\r\n    }\r\n  };\r\n\r\n  // Initialize global variable to track selected conversation across components\r\n  useEffect(() => {\r\n    if (typeof window !== 'undefined') {\r\n      window.selectedConversationId = null;\r\n    }\r\n  }, []);\r\n\r\n  // Mark a specific conversation as read\r\n  const markConversationAsRead = async (conversationId) => {\r\n    debugLog('MBA4321: Marking conversation as read:', conversationId);\r\n    \r\n    // Update the global variable to track which conversation is currently selected\r\n    if (typeof window !== 'undefined') {\r\n      window.selectedConversationId = conversationId;\r\n    }\r\n    \r\n    // Clear this conversation's unread count from local state\r\n    if (conversationId && conversationCounts[conversationId]) {\r\n      const previousCount = conversationCounts[conversationId] || 0;\r\n      \r\n      // Update the unread count and conversation counts\r\n      setUnreadCount(prevCount => {\r\n        const newCount = Math.max(0, prevCount - previousCount);\r\n        debugLog(`MBA4321: Reducing total unread count from ${prevCount} to ${newCount} after reading conversation ${conversationId}`);\r\n        return newCount;\r\n      });\r\n      \r\n      // Create new conversation counts object without this conversation\r\n      const newCounts = { ...conversationCounts };\r\n      delete newCounts[conversationId];\r\n      setConversationCounts(newCounts);\r\n      \r\n      // Update API response cache if we have it\r\n      if (lastApiResponse) {\r\n        const updatedCounts = { ...lastApiResponse.conversation_counts };\r\n        delete updatedCounts[conversationId];\r\n        \r\n        setLastApiResponse({\r\n          unread_count: Math.max(0, lastApiResponse.unread_count - previousCount),\r\n          conversation_counts: updatedCounts,\r\n          timestamp: Date.now()\r\n        });\r\n      }\r\n      \r\n      // Update hasUnreadMessages based on whether any conversations still have unread messages\r\n      const stillHasUnread = Object.keys(newCounts).length > 0;\r\n      setHasUnreadMessages(stillHasUnread);\r\n      debugLog(`MBA4321: After marking conversation ${conversationId} as read, still have unread messages: ${stillHasUnread}`);\r\n      \r\n      // List remaining unread conversations\r\n      if (stillHasUnread) {\r\n        const remainingConvs = Object.keys(newCounts).map(id => `${id}:${newCounts[id]}`).join(', ');\r\n        debugLog(`MBA4321: Remaining unread conversations: ${remainingConvs}`);\r\n      }\r\n    }\r\n    \r\n    // The backend automatically marks messages as read when \r\n    // get_conversation_messages is called, so we don't need to make another API call here\r\n    \r\n    debugLog('MBA4321: Updated unread state after marking conversation as read');\r\n  };\r\n\r\n  // Update route information\r\n  const updateRoute = (routeName) => {\r\n    if (!routeName || routeName === currentRoute) return;\r\n    \r\n    debugLog('MBA4321: Updating route to:', routeName);\r\n    setCurrentRoute(routeName);\r\n  };\r\n\r\n  // Initialize WebSocket connection when signed in - do this once globally\r\n  useEffect(() => {\r\n    const initializeWebSocket = async () => {\r\n      if (!isSignedIn) {\r\n        if (websocketInitialized) {\r\n          debugLog('MBA4321: User signed out, force disconnecting WebSocket');\r\n          websocketManager.disconnect(true); // Force disconnect on sign-out\r\n          setWebsocketInitialized(false);\r\n          \r\n          // Clear any reconnect interval\r\n          if (reconnectIntervalRef.current) {\r\n            clearInterval(reconnectIntervalRef.current);\r\n            reconnectIntervalRef.current = null;\r\n          }\r\n          \r\n          // Clear any WebSocket timeout\r\n          if (websocketTimeoutRef.current) {\r\n            clearTimeout(websocketTimeoutRef.current);\r\n            websocketTimeoutRef.current = null;\r\n          }\r\n          \r\n          // Clear heartbeat timeout\r\n          if (heartbeatTimeoutRef.current) {\r\n            clearTimeout(heartbeatTimeoutRef.current);\r\n            heartbeatTimeoutRef.current = null;\r\n          }\r\n          \r\n          // Reset retry attempts and connection state\r\n          websocketRetryAttemptsRef.current = 0;\r\n          websocketDataReceivedRef.current = false;\r\n          connectionHealthyRef.current = false;\r\n          initialApiCallMadeRef.current = false;\r\n        }\r\n        return;\r\n      }\r\n    \r\n      try {\r\n        const token = await getStorage('userToken');\r\n        if (!token) {\r\n          debugLog('MBA4321: No token available for WebSocket connection');\r\n          return;\r\n        }\r\n        \r\n        debugLog('MBA4321: Initializing WebSocket connection');\r\n        websocketManager.init(token);\r\n        setWebsocketInitialized(true);\r\n        \r\n        // Reset WebSocket retry attempts when initialization starts\r\n        websocketRetryAttemptsRef.current = 0;\r\n        \r\n        // IMPORTANT: Always make an initial API call on page load/refresh to get accurate count\r\n        // This ensures we start with the correct server state\r\n        setTimeout(() => {\r\n          debugLog('MBA432wihe21: Forcing initial API check on page load to get accurate count');\r\n          makeApiCall();\r\n        }, 500);\r\n      } catch (error) {\r\n        debugLog('MBA4321: Error initializing WebSocket:', error);\r\n      }\r\n    };\r\n    \r\n    // Function to check WebSocket connection health\r\n    const checkConnectionHealth = () => {\r\n      // Only proceed if signed in and initialized\r\n      if (!isSignedIn || !websocketInitialized) return;\r\n      \r\n      const now = Date.now();\r\n      const timeSinceLastHeartbeat = now - lastHeartbeatReceivedRef.current;\r\n      \r\n      // Log the current connection state\r\n      debugLog(`MBA4321: Connection health check - Last heartbeat: ${timeSinceLastHeartbeat}ms ago`);\r\n      \r\n      // If we haven't received a heartbeat in a while, connection might be dead\r\n      if (timeSinceLastHeartbeat > HEARTBEAT_TIMEOUT) {\r\n        debugLog('MBA4321: Connection seems unhealthy, attempting reconnection');\r\n        connectionHealthyRef.current = false;\r\n        \r\n        // Reset the WebSocket data received flag if connection is unhealthy\r\n        websocketDataReceivedRef.current = false;\r\n        \r\n        // Attempt to reconnect\r\n        websocketManager.reconnectIfNeeded();\r\n        \r\n        // Start progressive retry only if we haven't received data in a while\r\n        if (timeSinceLastHeartbeat > 120000) { // 2 minutes\r\n          startProgressiveWebSocketRetry();\r\n        }\r\n      } else {\r\n        // Connection seems healthy, just send a heartbeat to keep it alive\r\n        debugLog('MBA4321: Connection seems healthy, sending heartbeat');\r\n        connectionHealthyRef.current = true;\r\n        \r\n        // Send heartbeat to keep connection alive\r\n        if (websocketManager && websocketManager.isWebSocketConnected()) {\r\n          websocketManager.send('heartbeat', { timestamp: now });\r\n          lastHeartbeatSentRef.current = now;\r\n        }\r\n      }\r\n    };\r\n    \r\n    // Function to start progressive WebSocket retry with fallback to API\r\n    const startProgressiveWebSocketRetry = () => {\r\n      // Clear any existing timeout\r\n      if (websocketTimeoutRef.current) {\r\n        clearTimeout(websocketTimeoutRef.current);\r\n      }\r\n      \r\n      // Reset retry counter if we're starting fresh\r\n      if (initialCheckDoneRef.current) {\r\n        websocketRetryAttemptsRef.current = 0;\r\n      }\r\n      \r\n      // If we've already received WebSocket data, no need to retry\r\n      if (websocketDataReceivedRef.current) {\r\n        debugLog('MBA4321: WebSocket data already received, skipping retry process');\r\n        return;\r\n      }\r\n      \r\n      // Check if the WebSocket is already connected\r\n      const isConnected = websocketManager && websocketManager.isWebSocketConnected();\r\n      if (isConnected) {\r\n        debugLog('MBA4321: WebSocket is already connected, sending heartbeat to verify');\r\n        websocketManager.send('heartbeat', { timestamp: Date.now() });\r\n        lastHeartbeatSentRef.current = Date.now();\r\n        \r\n        // Set a single timeout to check if we got heartbeat response\r\n        websocketTimeoutRef.current = setTimeout(() => {\r\n          if (!websocketDataReceivedRef.current) {\r\n            debugLog('MBA432wihe21: No heartbeat response received, falling back to API');\r\n            checkUnreadMessages(true);\r\n          }\r\n        }, 5000); // Wait 5 seconds for heartbeat response\r\n        \r\n        return;\r\n      }\r\n      \r\n      // WebSocket isn't connected, let's use our waitForWebSocketWithFallback\r\n      // which is already implemented in checkUnreadMessages\r\n      checkUnreadMessages(false);\r\n    };\r\n    \r\n    initializeWebSocket();\r\n    \r\n    // Clean up on unmount\r\n    return () => {\r\n      if (reconnectIntervalRef.current) {\r\n        debugLog('MBA4321: Cleaning up WebSocket reconnect interval');\r\n        clearInterval(reconnectIntervalRef.current);\r\n        reconnectIntervalRef.current = null;\r\n      }\r\n      \r\n      // Clear debounce timer if it exists\r\n      if (debounceTimerRef.current) {\r\n        clearTimeout(debounceTimerRef.current);\r\n        debounceTimerRef.current = null;\r\n      }\r\n      \r\n      // Clear WebSocket timeout if it exists\r\n      if (websocketTimeoutRef.current) {\r\n        clearTimeout(websocketTimeoutRef.current);\r\n        websocketTimeoutRef.current = null;\r\n      }\r\n      \r\n      // Clear heartbeat timeout\r\n      if (heartbeatTimeoutRef.current) {\r\n        clearTimeout(heartbeatTimeoutRef.current);\r\n        heartbeatTimeoutRef.current = null;\r\n      }\r\n      \r\n      // Note: We don't disconnect the WebSocket on unmount \r\n      // This allows the connection to persist when navigating between tabs\r\n    };\r\n  }, [isSignedIn]);\r\n\r\n  // Register a websocket handler for new message notifications\r\n  useEffect(() => {\r\n    if (!isSignedIn || !websocketInitialized) return;\r\n\r\n    debugLog('MBA4321: Setting up WebSocket message handler');\r\n    \r\n    // Register handlers for relevant event types\r\n    const messageHandler = websocketManager.registerHandler('message', (data) => {\r\n      debugLog('MBA4321: Message notification received via WebSocket:', data);\r\n      \r\n      // Update heartbeat timestamp since we're receiving messages\r\n      lastHeartbeatReceivedRef.current = Date.now();\r\n      \r\n      // Mark connection as healthy\r\n      connectionHealthyRef.current = true;\r\n      \r\n      // First check if we need to make an initial API call to ensure correct state\r\n      if (!initialApiCallMadeRef.current) {\r\n        debugLog('MBA432wihe21: No initial API call made yet, making one now to ensure correct state');\r\n        makeApiCall();\r\n        return;\r\n      }\r\n      \r\n      onNewMessage(data);\r\n    }, 'notification-context');\r\n    \r\n    const unreadUpdateHandler = websocketManager.registerHandler('unread_update', (data) => {\r\n      debugLog('MBA4321: Unread update received via WebSocket:', data);\r\n      \r\n      // Update heartbeat timestamp\r\n      lastHeartbeatReceivedRef.current = Date.now();\r\n      \r\n      // Mark connection as healthy\r\n      connectionHealthyRef.current = true;\r\n      \r\n      // Update the state directly from the WebSocket data\r\n      if (data && typeof data.unread_count !== 'undefined') {\r\n        setUnreadCount(data.unread_count);\r\n        setHasUnreadMessages(data.unread_count > 0);\r\n        setConversationCounts(data.conversation_counts || {});\r\n        \r\n        // Also update the API response cache with this new data\r\n        setLastApiResponse({\r\n          unread_count: data.unread_count,\r\n          conversation_counts: data.conversation_counts || {},\r\n          timestamp: Date.now()\r\n        });\r\n        \r\n        setLastApiCheck(Date.now()); // Consider websocket updates as api checks\r\n        \r\n        // Mark that we've received data from WebSocket\r\n        websocketDataReceivedRef.current = true;\r\n        \r\n        // Mark initialization as complete since we got data from WebSocket\r\n        initialCheckDoneRef.current = true;\r\n      }\r\n    }, 'unread-update-context');\r\n    \r\n    // Add a heartbeat acknowledgment handler\r\n    const heartbeatHandler = websocketManager.registerHandler('heartbeat_ack', (data) => {\r\n      debugLog('MBA4321: Heartbeat acknowledgment received');\r\n      \r\n      // Update heartbeat timestamp\r\n      lastHeartbeatReceivedRef.current = Date.now();\r\n      \r\n      // Mark connection as healthy\r\n      connectionHealthyRef.current = true;\r\n      \r\n      // Mark that we've received data from WebSocket\r\n      websocketDataReceivedRef.current = true;\r\n    }, 'heartbeat-context');\r\n    \r\n    // Handle WebSocket connection/disconnection\r\n    const connectionHandler = websocketManager.registerHandler('connection', (data) => {\r\n      debugLog('MBA4321: WebSocket connection event:', data);\r\n      \r\n      // Record heartbeat if we've established connection\r\n      if (data.status === 'connected') {\r\n        lastHeartbeatReceivedRef.current = Date.now();\r\n        connectionHealthyRef.current = true;\r\n      } else {\r\n        // Only reset the WebSocket data flag if connection was explicitly closed\r\n        // This prevents unnecessary API calls when the connection is temporarily unstable\r\n        if (data.forced) {\r\n          websocketDataReceivedRef.current = false;\r\n          connectionHealthyRef.current = false;\r\n          debugLog('MBA4321: Connection forcibly closed, resetting WebSocket data flag');\r\n        }\r\n      }\r\n      \r\n      // If we're (re)connecting and haven't done an initial check yet, do it now\r\n      if (data.status === 'connected' && !initialCheckDoneRef.current) {\r\n        // Use a small delay to avoid race conditions with other initialization\r\n        setTimeout(() => {\r\n          // Only call API if we haven't received WebSocket data yet\r\n          if (!websocketDataReceivedRef.current) {\r\n            debugLog('MBA432wihe21: in connection handler');\r\n            checkUnreadMessages(true);\r\n          }\r\n        }, 1000);\r\n      }\r\n    }, 'connection-context');\r\n    \r\n    // Cleanup function to unregister handlers\r\n    return () => {\r\n      debugLog('MBA4321: Cleaning up WebSocket handlers');\r\n      messageHandler();\r\n      unreadUpdateHandler();\r\n      connectionHandler();\r\n      heartbeatHandler();\r\n    };\r\n  }, [isSignedIn, websocketInitialized]);\r\n\r\n  // Setup visibility change listener to reconnect when tab becomes visible\r\n  useEffect(() => {\r\n    if (!isSignedIn) return;\r\n    \r\n    const handleVisibilityChange = () => {\r\n      if (Platform.OS === 'web' && document.visibilityState === 'visible') {\r\n        debugLog('MBA4321: Tab became visible, ensuring WebSocket connection');\r\n        \r\n        // First check if the WebSocket is already connected\r\n        const isWSConnected = websocketManager && websocketManager.isWebSocketConnected();\r\n        debugLog(`MBA4321: WebSocket connection status on visibility change: ${isWSConnected ? 'Connected' : 'Disconnected'}`);\r\n        \r\n        // If WebSocket is already connected, we don't need to do anything\r\n        if (isWSConnected) {\r\n          debugLog('MBA4321: WebSocket is already connected, no reconnection needed');\r\n          \r\n          // Optionally send a heartbeat to verify connection is still good\r\n          websocketManager.send('heartbeat', { timestamp: Date.now() });\r\n          lastHeartbeatSentRef.current = Date.now();\r\n          \r\n          // Reset the WebSocket data received flag since we have a good connection\r\n          websocketDataReceivedRef.current = true;\r\n          connectionHealthyRef.current = true;\r\n          \r\n          return;\r\n        }\r\n        \r\n        // WebSocket isn't connected, try to reconnect\r\n        if (websocketManager && typeof websocketManager.reconnectIfNeeded === 'function') {\r\n          debugLog('MBA4321: WebSocket not connected, attempting reconnection');\r\n          websocketManager.reconnectIfNeeded();\r\n          \r\n          // Start progressive retry instead of immediate API call\r\n          // Reset retry attempts counter first\r\n          websocketRetryAttemptsRef.current = 0;\r\n          \r\n          const startProgressiveRetry = () => {\r\n            // Check if WebSocket connected during the retry process\r\n            const nowConnected = websocketManager && websocketManager.isWebSocketConnected();\r\n            \r\n            // If WebSocket is now connected or data is received, we're done\r\n            if (nowConnected || websocketDataReceivedRef.current) {\r\n              debugLog('MBA4321: WebSocket reconnected successfully, stopping retry process');\r\n              // Clear any scheduled retry\r\n              if (websocketTimeoutRef.current) {\r\n                clearTimeout(websocketTimeoutRef.current);\r\n                websocketTimeoutRef.current = null;\r\n              }\r\n              return;\r\n            }\r\n            \r\n            // Increment retry counter\r\n            websocketRetryAttemptsRef.current++;\r\n            debugLog(`MBA4321: WebSocket reconnection attempt ${websocketRetryAttemptsRef.current}/${MAX_WEBSOCKET_RETRIES}`);\r\n            \r\n            if (websocketRetryAttemptsRef.current >= MAX_WEBSOCKET_RETRIES) {\r\n              // Max retries reached, fall back to API\r\n              debugLog('MBA432wihe21: Max retries reached, fall back to API');\r\n              debouncedCheckUnreadMessages(true);\r\n              return;\r\n            }\r\n            \r\n            // Try to reconnect again after interval\r\n            websocketTimeoutRef.current = setTimeout(startProgressiveRetry, WEBSOCKET_RETRY_INTERVAL);\r\n          };\r\n          \r\n          // Start the retry process after a short delay to allow immediate reconnection to complete\r\n          setTimeout(startProgressiveRetry, 1000);\r\n        }\r\n      }\r\n    };\r\n    \r\n    if (Platform.OS === 'web' && typeof document !== 'undefined') {\r\n      document.addEventListener('visibilitychange', handleVisibilityChange);\r\n    }\r\n    \r\n    return () => {\r\n      if (Platform.OS === 'web' && typeof document !== 'undefined') {\r\n        document.removeEventListener('visibilitychange', handleVisibilityChange);\r\n      }\r\n      \r\n      // Clear WebSocket timeout if it exists\r\n      if (websocketTimeoutRef.current) {\r\n        clearTimeout(websocketTimeoutRef.current);\r\n        websocketTimeoutRef.current = null;\r\n      }\r\n      \r\n      // Clear heartbeat timeout\r\n      if (heartbeatTimeoutRef.current) {\r\n        clearTimeout(heartbeatTimeoutRef.current);\r\n        heartbeatTimeoutRef.current = null;\r\n      }\r\n    };\r\n  }, [isSignedIn]); // Remove lastApiCheck from dependencies\r\n\r\n  // Modified fallback strategy with much less frequent API calls\r\n  useEffect(() => {\r\n    if (!isSignedIn) {\r\n      setHasUnreadMessages(false);\r\n      setUnreadCount(0);\r\n      setConversationCounts({});\r\n      websocketDataReceivedRef.current = false;\r\n      initialApiCallMadeRef.current = false;\r\n      \r\n      // Clear any WebSocket timeout\r\n      if (websocketTimeoutRef.current) {\r\n        clearTimeout(websocketTimeoutRef.current);\r\n        websocketTimeoutRef.current = null;\r\n      }\r\n      \r\n      return;\r\n    }\r\n    \r\n    // Always get fresh unread count on page load or sign-in\r\n    // This ensures we start with correct state\r\n    if (!initialApiCallMadeRef.current) {\r\n      debugLog('MBA4321: Ensuring we get fresh unread count on page load/sign-in');\r\n      \r\n      const initialCheckTimeout = setTimeout(() => {\r\n        if (!initialApiCallMadeRef.current) {\r\n          debugLog('MBA432wihe21: Making initial API call to get fresh unread count');\r\n          makeApiCall();\r\n        }\r\n      }, 1000); // Short delay to allow WebSocket initialization\r\n      \r\n      // Clear timeout on cleanup\r\n      return () => clearTimeout(initialCheckTimeout);\r\n    }\r\n    \r\n    // No polling needed - WebSocket is the primary data source\r\n    \r\n    return () => {};\r\n  }, [isSignedIn]);\r\n\r\n  // Create a memoized value for the context to reduce rerenders\r\n  const contextValue = {\r\n    hasUnreadMessages,\r\n    unreadCount,\r\n    conversationCounts,\r\n    getConversationUnreadCount,\r\n    updateRoute,\r\n    checkUnreadMessages: debouncedCheckUnreadMessages, // Use debounced version\r\n    onNewMessage,\r\n    markConversationAsRead,\r\n    resetNotifications: (routeName, conversationId) => {\r\n      // If a route is provided, set it as the current route\r\n      if (routeName && routeName !== currentRoute) {\r\n        setCurrentRoute(routeName);\r\n      }\r\n      \r\n      // If a specific conversation ID is provided, only clear that conversation's notifications\r\n      if (conversationId) {\r\n        debugLog(`MBA4321: Resetting notifications for specific conversation: ${conversationId}`);\r\n        markConversationAsRead(conversationId);\r\n        return;\r\n      }\r\n      \r\n      // IMPORTANT: Do NOT reset all notifications just because we're on the MessageHistory screen\r\n      // This was the bug - we were clearing all notifications even when only one conversation was viewed\r\n      \r\n      // Only reset all notifications if explicitly requested with a special flag\r\n      if (routeName === 'RESET_ALL') {\r\n        debugLog('MBA4321: Explicitly resetting ALL message notifications');\r\n        setHasUnreadMessages(false);\r\n        setUnreadCount(0);\r\n        setConversationCounts({});\r\n      }\r\n    }\r\n  };\r\n\r\n  return (\r\n    <MessageNotificationContext.Provider value={contextValue}>\r\n      {children}\r\n    </MessageNotificationContext.Provider>\r\n  );\r\n};\r\n\r\nexport default MessageNotificationContext; ","// theme.js\r\nimport { DefaultTheme } from 'react-native-paper';\r\n\r\nexport const theme = {\r\n  ...DefaultTheme,\r\n  // the regular and header fonts are the fonts used in the app\r\n  fonts: {\r\n    ...DefaultTheme.fonts,\r\n    regular: {\r\n      fontFamily: 'PlayfairDisplay',\r\n    },\r\n    medium: {\r\n      fontFamily: 'PlayfairDisplay-Medium',\r\n    },\r\n    header: {\r\n      fontFamily: 'Futura',\r\n    }\r\n  },\r\n  typography: {\r\n    header: {\r\n      fontFamily: 'Futura',\r\n    },\r\n    body: {\r\n      fontFamily: 'PlayfairDisplay',\r\n    }\r\n  },\r\n  colors: {\r\n    ...DefaultTheme.colors,\r\n    mainColors: {\r\n      main: '#6A6C51', // #6A6C51\r\n      secondary: '#5D6C51', // #5D6C51\r\n      tertiary: '#516C53', // #516C53\r\n      quaternary: '#516C61', // #516C61\r\n      quinary: '#516A6C', // #516A6C\r\n      senary: '#515D6C', // #515D6C\r\n    },\r\n    proDashboard: {\r\n      main: '#F0F9E5', // #F0F9E5\r\n      secondary: '#E7F3F8', // #E7F3F8\r\n      tertiary: '#FEF0DA', // #FEF0DA\r\n      quaternary: '#E1E2DB', // #E1E2DB\r\n    },\r\n    mybookings: {\r\n      main: '#FFF7ED', // #FFF7ED Pending indicator background\r\n      secondary: '#EA580E', // #EA580E Pending indicator text\r\n      tertiary: '#6A6C51', // #6A6C51\r\n      ownerName: '#4B4C3B', // #4B4C3B Owner name text color\r\n      metaText: '#959885', // #959885 Date/time/service text color\r\n      confirmedBg: '#E8E9E2', // #E8E9E2 Confirmed button background\r\n      confirmedText: '#898974', // #898974 Confirmed button text\r\n      completedBg: '#F5F5F4', // #F5F5F4 Completed button background\r\n      completedText: '#898983', // #898983 Completed button text\r\n      searchBar: 'rgb(183, 183, 183)', // Search bar text color\r\n    },\r\n    primary: '#6A6C51', // #6A6C51\r\n    secondary: '#516C61', // #516C61\r\n    background: '#f6f6f6', // #f6f6f6\r\n    backgroundContrast: '#F6F3FC', // #F6F3FC\r\n    calendarColor: '#A99E6B', // #A99E6B\r\n    calendarColorYellowBrown: '#8A8C6D', // #8A8C6D\r\n    text: 'black', // #000000\r\n    whiteText: 'white', // #FFFFFF\r\n    placeHolderText: '#A9A9A9', // #A9A9A9\r\n    accent: '#03dac4', // #03dac4\r\n    error: '#B00020', // #B00020\r\n    warning: '#FFA726', // Orange warning color\r\n    info: '#29B6F6', // Light blue info color\r\n    surface: '#F9FAFB', // #F9FAFB\r\n    surfaceContrast: '#FFFFFF', // #FFFFFF\r\n    border: 'rgb(183, 183, 183)', // 'rgb(183, 183, 183)'\r\n    bgColorModern: 'rgb(239, 239, 239)',\r\n    modernBorder: '#E0E0E0', // #E0E0E0\r\n    inputBackground: '#f6f6f6', // #f6f6f6\r\n    receivedMessage: '#e7eae6', // #e7eae6\r\n    danger: '#A52A2A', // #A52A2A\r\n  },\r\n  fontSizes: {\r\n    small: 12,\r\n    smallMedium: 14,\r\n    medium: 16,\r\n    mediumLarge: 18,\r\n    large: 20,\r\n    largeLarge: 24,\r\n    extraLarge: 26,\r\n  },\r\n  spacing: {\r\n    small: 8,\r\n    medium: 16,\r\n    large: 24,\r\n  },\r\n};","import { format, parse } from 'date-fns';\r\nimport { formatInTimeZone, toZonedTime, fromZonedTime, utcToZonedTime, getTimezoneOffset } from 'date-fns-tz';\r\nimport moment from 'moment-timezone';\r\nimport { debugLog } from '../context/AuthContext';\r\n// import { format as formatDate } from 'date-fns';\r\nimport { parseISO } from 'date-fns';\r\n\r\n/**\r\n * Formats a date string into \"MMM d\" format (e.g., \"Mar 5\")\r\n */\r\nexport const formatDate = (dateString) => {\r\n    if (!dateString) return '';\r\n    \r\n    debugLog('MBA5677: Formatting date input', dateString);\r\n    \r\n    try {\r\n        // First try to parse as ISO date\r\n        const parsedDate = parseISO(dateString);\r\n        \r\n        // Check if the parsed date is valid\r\n        if (!isNaN(parsedDate.getTime())) {\r\n            const month = parsedDate.toLocaleString('default', { month: 'short' });\r\n            const day = parsedDate.getDate();\r\n            debugLog('MBA5677: Parsed as ISO date', { parsedDate, month, day });\r\n            return `${month} ${day}`;\r\n        }\r\n        \r\n        // Fallback to parse as YYYY-MM-DD format\r\n        const date = parse(dateString, 'yyyy-MM-dd', new Date());\r\n        \r\n        // Check if the parsed date is valid\r\n        if (!isNaN(date.getTime())) {\r\n            const month = date.toLocaleString('default', { month: 'short' });\r\n            const day = date.getDate();\r\n            debugLog('MBA5677: Parsed with date-fns', { date, month, day });\r\n            return `${month} ${day}`;\r\n        }\r\n        \r\n        // If both parsing methods failed, try moment\r\n        const momentDate = moment(dateString);\r\n        if (momentDate.isValid()) {\r\n            const formatted = momentDate.format('MMM D');\r\n            debugLog('MBA5677: Parsed with moment', { momentDate, formatted });\r\n            return formatted;\r\n        }\r\n        \r\n        debugLog('MBA5677: Failed to parse date', dateString);\r\n        return dateString; // Return original if all parsing fails\r\n    } catch (error) {\r\n        debugLog('MBA5677: Error formatting date', { dateString, error });\r\n        return dateString; // Return original on error\r\n    }\r\n};\r\n\r\n/**\r\n * Converts 12-hour time format to 24-hour format\r\n */\r\nexport const convertTo24Hour = (time12h) => {\r\n    if (!time12h.includes(' ')) {\r\n        return time12h;\r\n    }\r\n\r\n    const [time, modifier] = time12h.split(' ');\r\n    let [hours, minutes] = time.split(':');\r\n    hours = parseInt(hours, 10);\r\n    \r\n    if (modifier === 'PM' && hours < 12) {\r\n        hours += 12;\r\n    } else if (modifier === 'AM' && hours === 12) {\r\n        hours = 0;\r\n    }\r\n    \r\n    return `${hours.toString().padStart(2, '0')}:${minutes}`;\r\n};\r\n\r\n/**\r\n * Converts 24-hour time format to 12-hour format\r\n */\r\nexport const convertTo12Hour = (time24h) => {\r\n    if (time24h.includes(' ')) {\r\n        return time24h;\r\n    }\r\n\r\n    const [hours24, minutes] = time24h.split(':');\r\n    const hours = parseInt(hours24, 10);\r\n    \r\n    let period = hours >= 12 ? 'PM' : 'AM';\r\n    let hours12 = hours % 12;\r\n    hours12 = hours12 === 0 ? 12 : hours12;\r\n    \r\n    return `${hours12}:${minutes} ${period}`;\r\n};\r\n\r\n/**\r\n * Converts a time from a specific timezone to UTC\r\n * @param {string} date - The date in YYYY-MM-DD format\r\n * @param {string} time - The time in HH:mm format (24-hour)\r\n * @param {string} fromTimezone - The source timezone (e.g., 'US/Mountain')\r\n * @returns {Object} Object containing the UTC date and time\r\n */\r\nexport const convertToUTC = (date, time, fromTimezone) => {\r\n  try {\r\n    debugLog('MBA12345: Converting to UTC - Input:', { date, time, fromTimezone });\r\n\r\n    // Create a moment object in the source timezone\r\n    const localMoment = moment.tz(`${date} ${time}`, fromTimezone);\r\n    \r\n    // Convert to UTC\r\n    const utcMoment = localMoment.utc();\r\n    \r\n    // Format the date and time\r\n    const utcDate = utcMoment.format('YYYY-MM-DD');\r\n    const utcTime = utcMoment.format('HH:mm');\r\n\r\n    debugLog('MBA12345: UTC conversion result:', {\r\n      input: {\r\n        date,\r\n        time,\r\n        fromTimezone\r\n      },\r\n      output: {\r\n        utcDate,\r\n        utcTime,\r\n        originalMoment: localMoment.format(),\r\n        utcMoment: utcMoment.format()\r\n      }\r\n    });\r\n    \r\n    return {\r\n      date: utcDate,\r\n      time: utcTime\r\n    };\r\n  } catch (error) {\r\n    debugLog('MBA12345: Error converting to UTC:', error);\r\n    return { date, time }; // Return original values as fallback\r\n  }\r\n};\r\n\r\n/**\r\n * Converts UTC date and time to local date and time\r\n */\r\nexport const convertDateTimeFromUTC = (date, time, timezone, useMilitaryTime = false) => {\r\n    try {\r\n        debugLog('MBA5677: Converting UTC to local:', { date, time, timezone, useMilitaryTime });\r\n        \r\n        // Ensure we have valid inputs\r\n        if (!date || !time) {\r\n            debugLog('MBA5677: Invalid input for conversion', { date, time });\r\n            return { date, time };\r\n        }\r\n        \r\n        // Multiple parsing strategies for more robust date handling\r\n        let utcDate = null;\r\n        \r\n        // Strategy 1: Try standard ISO format parsing\r\n        try {\r\n            // Handle different time formats\r\n            let formattedTime = time;\r\n            if (time.includes('.')) {\r\n                formattedTime = time.split('.')[0]; // Remove milliseconds if present\r\n            }\r\n            \r\n            // Create a proper ISO string\r\n            const isoString = `${date}T${formattedTime}${formattedTime.includes('Z') ? '' : 'Z'}`;\r\n            debugLog('MBA5677: Trying ISO string format', isoString);\r\n            \r\n            // Create Date object\r\n            utcDate = new Date(isoString);\r\n            \r\n            // Check if valid\r\n            if (isNaN(utcDate.getTime())) {\r\n                debugLog('MBA5677: ISO format parsing failed');\r\n                utcDate = null;\r\n            } else {\r\n                debugLog('MBA5677: ISO format parsing succeeded');\r\n            }\r\n        } catch (parseError) {\r\n            debugLog('MBA5677: Error in ISO format parsing', parseError);\r\n        }\r\n        \r\n        // Strategy 2: Try direct date-fns parsing\r\n        if (!utcDate) {\r\n            try {\r\n                debugLog('MBA5677: Trying date-fns parsing');\r\n                const dateStr = `${date} ${time}`;\r\n                utcDate = moment.utc(dateStr).toDate();\r\n                \r\n                // Check if valid\r\n                if (isNaN(utcDate.getTime())) {\r\n                    debugLog('MBA5677: date-fns parsing failed');\r\n                    utcDate = null;\r\n                } else {\r\n                    debugLog('MBA5677: date-fns parsing succeeded');\r\n                }\r\n            } catch (parseError) {\r\n                debugLog('MBA5677: Error in date-fns parsing', parseError);\r\n            }\r\n        }\r\n        \r\n        // Strategy 3: Try manual parsing\r\n        if (!utcDate) {\r\n            try {\r\n                debugLog('MBA5677: Trying manual parsing');\r\n                // Split the date and time parts\r\n                const [year, month, day] = date.split('-').map(Number);\r\n                let hours = 0, minutes = 0;\r\n                \r\n                // Parse time\r\n                if (time.includes(':')) {\r\n                    const timeParts = time.split(':');\r\n                    hours = parseInt(timeParts[0], 10);\r\n                    minutes = parseInt(timeParts[1], 10);\r\n                }\r\n                \r\n                // Create UTC date\r\n                utcDate = new Date(Date.UTC(year, month - 1, day, hours, minutes));\r\n                \r\n                // Check if valid\r\n                if (isNaN(utcDate.getTime())) {\r\n                    debugLog('MBA5677: Manual parsing failed');\r\n                    utcDate = null;\r\n                } else {\r\n                    debugLog('MBA5677: Manual parsing succeeded');\r\n                }\r\n            } catch (parseError) {\r\n                debugLog('MBA5677: Error in manual parsing', parseError);\r\n            }\r\n        }\r\n        \r\n        // If all parsing strategies failed, return original values\r\n        if (!utcDate) {\r\n            debugLog('MBA5677: All parsing strategies failed, returning original');\r\n            return { date, time };\r\n        }\r\n        \r\n        debugLog('MBA5677: Valid UTC Date created:', utcDate.toISOString());\r\n        \r\n        // Convert to user's timezone using moment for reliability\r\n        const utcMoment = moment.utc(utcDate);\r\n        const localMoment = utcMoment.tz(timezone || 'UTC');\r\n        \r\n        // Format the local date and time\r\n        const localDateStr = localMoment.format('YYYY-MM-DD');\r\n        const localTimeStr = localMoment.format(useMilitaryTime ? 'HH:mm' : 'h:mm A');\r\n        \r\n        debugLog('MBA5677: Date conversion result:', {\r\n            input: { date, time, timezone },\r\n            utc: utcDate.toISOString(),\r\n            utcMoment: utcMoment.format(),\r\n            localMoment: localMoment.format(),\r\n            output: { date: localDateStr, time: localTimeStr }\r\n        });\r\n        \r\n        return {\r\n            date: localDateStr,\r\n            time: localTimeStr\r\n        };\r\n    } catch (error) {\r\n        debugLog('MBA5677: Error in convertDateTimeFromUTC:', error, { date, time, timezone });\r\n        return { date, time }; // Return original on error\r\n    }\r\n};\r\n\r\n/**\r\n * Gets formatted times matching backend format\r\n */\r\nexport const getFormattedTimes = (startDate, startTime, endDate, endTime, timezone) => {\r\n    try {\r\n        console.log('MBA134njo0vh032 getFormattedTimes input:', {\r\n            startDate,\r\n            startTime,\r\n            endDate,\r\n            endTime,\r\n            timezone\r\n        });\r\n\r\n        // Parse the date and time strings\r\n        const [startYear, startMonth, startDay] = startDate.split('-').map(Number);\r\n        const [startHours, startMinutes] = startTime.split(':').map(Number);\r\n        const [endYear, endMonth, endDay] = endDate.split('-').map(Number);\r\n        const [endHours, endMinutes] = endTime.split(':').map(Number);\r\n\r\n        console.log('MBA134njo0vh032 Parsed components:', {\r\n            start: {\r\n                year: startYear,\r\n                month: startMonth,\r\n                day: startDay,\r\n                hours: startHours,\r\n                minutes: startMinutes\r\n            },\r\n            end: {\r\n                year: endYear,\r\n                month: endMonth,\r\n                day: endDay,\r\n                hours: endHours,\r\n                minutes: endMinutes\r\n            }\r\n        });\r\n\r\n        // Create ISO date strings for the local times in the specified timezone\r\n        const startDateStr = `${startYear}-${String(startMonth).padStart(2, '0')}-${String(startDay).padStart(2, '0')}T${String(startHours).padStart(2, '0')}:${String(startMinutes).padStart(2, '0')}:00`;\r\n        const endDateStr = `${endYear}-${String(endMonth).padStart(2, '0')}-${String(endDay).padStart(2, '0')}T${String(endHours).padStart(2, '0')}:${String(endMinutes).padStart(2, '0')}:00`;\r\n\r\n        console.log('MBA134njo0vh032 Created date strings:', {\r\n            startDateStr,\r\n            endDateStr,\r\n            timezone\r\n        });\r\n\r\n        // Format the dates directly using formatInTimeZone with the input timezone\r\n        const formatted_start = formatInTimeZone(startDateStr, timezone, \"MMM dd, yyyy (h:mm a)\");\r\n        const formatted_end = formatInTimeZone(endDateStr, timezone, \"MMM dd, yyyy (h:mm a)\");\r\n\r\n        console.log('MBA134njo0vh032 Formatted dates:', {\r\n            formatted_start,\r\n            formatted_end\r\n        });\r\n\r\n        // Create Date objects for duration calculation\r\n        const startDateTime = new Date(startDateStr);\r\n        const endDateTime = new Date(endDateStr);\r\n\r\n        // Calculate duration in milliseconds\r\n        const durationMs = endDateTime - startDateTime;\r\n        \r\n        // Calculate days and remaining hours\r\n        const days = Math.floor(durationMs / (24 * 60 * 60 * 1000));\r\n        const remainingMs = durationMs % (24 * 60 * 60 * 1000);\r\n        const hours = Math.floor(remainingMs / (60 * 60 * 1000));\r\n\r\n        // Format duration string\r\n        let durationStr = '';\r\n        if (days > 0) {\r\n            durationStr += `${days} day${days > 1 ? 's' : ''}`;\r\n            if (hours > 0) {\r\n                durationStr += `, ${hours} hour${hours > 1 ? 's' : ''}`;\r\n            }\r\n        } else if (hours > 0) {\r\n            durationStr += `${hours} hour${hours > 1 ? 's' : ''}`;\r\n        }\r\n\r\n        console.log('MBA134njo0vh032 Final formatted output:', {\r\n            formatted_start,\r\n            formatted_end,\r\n            duration: durationStr,\r\n            timezone: timezone.split('/')[1] || timezone\r\n        });\r\n\r\n        return {\r\n            formatted_start,\r\n            formatted_end,\r\n            duration: durationStr || '0 hours',\r\n            timezone: timezone.split('/')[1] || timezone\r\n        };\r\n    } catch (error) {\r\n        console.error('Error in getFormattedTimes:', error);\r\n        throw error;\r\n    }\r\n};\r\n\r\n/**\r\n * Check if times cross DST boundary\r\n */\r\nexport const checkDSTChange = (startDate, startTime, endDate, endTime, timezone) => {\r\n    try {\r\n        // Parse dates and times\r\n        const [startYear, startMonth, startDay] = startDate.split('-').map(Number);\r\n        const [startHours, startMinutes] = convertTo24Hour(startTime).split(':').map(Number);\r\n        const [endYear, endMonth, endDay] = endDate.split('-').map(Number);\r\n        const [endHours, endMinutes] = convertTo24Hour(endTime).split(':').map(Number);\r\n\r\n        // Create local dates and convert to zoned time\r\n        const startLocalDate = new Date(startYear, startMonth - 1, startDay, startHours, startMinutes);\r\n        const endLocalDate = new Date(endYear, endMonth - 1, endDay, endHours, endMinutes);\r\n        \r\n        const startZonedDate = fromZonedTime(toZonedTime(startLocalDate, timezone));\r\n        const endZonedDate = fromZonedTime(toZonedTime(endLocalDate, timezone));\r\n\r\n        // Convert back to local and check if offsets are different\r\n        const startLocal = toZonedTime(startZonedDate, timezone);\r\n        const endLocal = toZonedTime(endZonedDate, timezone);\r\n        \r\n        return startLocal.getTimezoneOffset() !== endLocal.getTimezoneOffset();\r\n    } catch (error) {\r\n        console.error('Error in checkDSTChange:', error);\r\n        throw error;\r\n    }\r\n};\r\n\r\n/**\r\n * Formats an occurrence from UTC times to local times with proper formatting\r\n */\r\nexport const formatOccurrenceFromUTC = (occurrence, userTimezone) => {\r\n  try {\r\n    // Always use full timezone name for conversions\r\n    const fullTimezone = userTimezone.includes('/') ? userTimezone : 'US/Mountain';\r\n    \r\n    console.log('MBA134njo0vh03 Formatting occurrence from UTC:', {\r\n      occurrence,\r\n      userTimezone,\r\n      fullTimezone\r\n    });\r\n\r\n    // Convert UTC times to local\r\n    const localStart = convertDateTimeFromUTC(\r\n      occurrence.start_date,\r\n      occurrence.start_time,\r\n      fullTimezone\r\n    );\r\n\r\n    const localEnd = convertDateTimeFromUTC(\r\n      occurrence.end_date,\r\n      occurrence.end_time,\r\n      fullTimezone\r\n    );\r\n\r\n    console.log('MBA134njo0vh03 Local start:', localStart);\r\n    console.log('MBA134njo0vh03 Local end:', localEnd);\r\n    console.log('MBA134njo0vh03 Full timezone:', fullTimezone);\r\n\r\n    // Get formatted times\r\n    const formattedTimes = getFormattedTimes(\r\n      localStart.date,\r\n      localStart.time,\r\n      localEnd.date,\r\n      localEnd.time,\r\n      fullTimezone\r\n    );\r\n\r\n    console.log('MBA134njo0vh03 Formatted times from getFormattedTimes:', formattedTimes);\r\n\r\n    // Check for DST change\r\n    const hasDSTChange = checkDSTChange(\r\n      localStart.date,\r\n      localStart.time,\r\n      localEnd.date,\r\n      localEnd.time,\r\n      fullTimezone\r\n    );\r\n\r\n    // Use the provided timezone abbreviation directly\r\n    const tzAbbrev = userTimezone.includes('/') ? userTimezone.split('/')[1] : userTimezone;\r\n\r\n    return {\r\n      ...occurrence,\r\n      formatted_start: formattedTimes.formatted_start,\r\n      formatted_end: formattedTimes.formatted_end,\r\n      duration: formattedTimes.duration,\r\n      timezone: tzAbbrev,\r\n      dst_message: hasDSTChange ? \r\n        \"Elapsed time may be different than expected due to Daylight Savings Time.\" : \r\n        \"\"\r\n    };\r\n  } catch (error) {\r\n    console.error('Error in formatOccurrenceFromUTC:', error);\r\n    return {\r\n      ...occurrence,\r\n      formatted_start: occurrence.start_date,\r\n      formatted_end: occurrence.end_date,\r\n      duration: 'Unknown',\r\n      timezone: userTimezone.includes('/') ? userTimezone.split('/')[1] : userTimezone,\r\n      dst_message: ''\r\n    };\r\n  }\r\n};\r\n\r\n/**\r\n * Formats a date for API calls (YYYY-MM-DD)\r\n * @param {Date|string} date - The date to format\r\n * @returns {string} Formatted date string\r\n */\r\nexport const formatDateForAPI = (date) => {\r\n  if (!date) return null;\r\n  \r\n  debugLog('MBA12345 formatDateForAPI input:', date, typeof date);\r\n  \r\n  let dateObj;\r\n  \r\n  try {\r\n    // If date is already a string in YYYY-MM-DD format, return as is\r\n    if (typeof date === 'string' && /^\\d{4}-\\d{2}-\\d{2}$/.test(date)) {\r\n      debugLog('MBA12345 formatDateForAPI: already in YYYY-MM-DD format:', date);\r\n      return date;\r\n    }\r\n    \r\n    // If date is an object with date, startTime, and endTime properties, it's a date item\r\n    if (typeof date === 'object' && date.date && date.startTime && date.endTime) {\r\n      debugLog('MBA12345 formatDateForAPI: extracting date from date item:', date.date);\r\n      return date.date;\r\n    }\r\n    \r\n    // If date is a Date object\r\n    if (date instanceof Date) {\r\n      dateObj = date;\r\n      debugLog('MBA12345 formatDateForAPI: using Date object');\r\n    } else {\r\n      // Otherwise, try to create a Date from whatever was passed in\r\n      dateObj = new Date(date);\r\n      debugLog('MBA12345 formatDateForAPI: created Date from input:', dateObj);\r\n    }\r\n    \r\n    // Check if the date is valid\r\n    if (isNaN(dateObj.getTime())) {\r\n      debugLog('MBA12345 formatDateForAPI: invalid date:', date);\r\n      throw new Error('Invalid date format');\r\n    }\r\n    \r\n    // Format as YYYY-MM-DD\r\n    const year = dateObj.getFullYear();\r\n    const month = String(dateObj.getMonth() + 1).padStart(2, '0');\r\n    const day = String(dateObj.getDate()).padStart(2, '0');\r\n    \r\n    const formattedDate = `${year}-${month}-${day}`;\r\n    debugLog('MBA12345 formatDateForAPI result:', formattedDate);\r\n    return formattedDate;\r\n  } catch (error) {\r\n    debugLog('MBA12345 formatDateForAPI error:', error, 'for input:', date);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Formats a time for API calls (HH:mm)\r\n * @param {Object|string} time - The time to format (object with hours/minutes or string)\r\n * @returns {string} Formatted time string in 24-hour format\r\n */\r\nexport const formatTimeForAPI = (time) => {\r\n  if (!time) {\r\n    debugLog('MBA12345 formatTimeForAPI received null/undefined time:', time);\r\n    return null;\r\n  }\r\n  \r\n  debugLog('MBA12345 formatTimeForAPI input:', time);\r\n  \r\n  let hours, minutes;\r\n  \r\n  if (typeof time === 'object' && time.hours !== undefined) {\r\n    // Handle time object format\r\n    hours = time.hours;\r\n    minutes = time.minutes;\r\n    debugLog('MBA12345 formatTimeForAPI processing time object:', { hours, minutes });\r\n  } else if (typeof time === 'string') {\r\n    // Handle string format (assuming HH:mm format)\r\n    [hours, minutes] = time.split(':').map(Number);\r\n    debugLog('MBA12345 formatTimeForAPI processing time string:', { hours, minutes });\r\n  } else {\r\n    debugLog('MBA12345 formatTimeForAPI invalid time format:', typeof time);\r\n    throw new Error('Invalid time format');\r\n  }\r\n  \r\n  // Ensure hours and minutes are valid\r\n  hours = parseInt(hours);\r\n  minutes = parseInt(minutes);\r\n  \r\n  if (isNaN(hours) || isNaN(minutes)) {\r\n    debugLog('MBA12345 formatTimeForAPI invalid time values:', { hours, minutes });\r\n    throw new Error('Invalid time values');\r\n  }\r\n  \r\n  // Format as HH:mm\r\n  const result = `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}`;\r\n  debugLog('MBA12345 formatTimeForAPI result:', result);\r\n  return result;\r\n};\r\n\r\n// Format types for consistent date/time formatting across the app\r\nexport const FORMAT_TYPES = {\r\n  SHORT_DATE: 'SHORT_DATE',           // Mar 4\r\n  MEDIUM_DATE: 'MEDIUM_DATE',         // Mar 4, 2025\r\n  LONG_DATE: 'LONG_DATE',            // March 4, 2025\r\n  TIME_ONLY: 'TIME_ONLY',            // 4:42 PM\r\n  TIME_ONLY_24H: 'TIME_ONLY_24H',    // 16:42\r\n  DATE_TIME: 'DATE_TIME',            // Mar 4, 2025 at 4:42 PM\r\n  DATE_TIME_WITH_TZ: 'DATE_TIME_WITH_TZ', // Mar 4, 2025 at 4:42 PM MDT\r\n  DATE_RANGE: 'DATE_RANGE',          // Mar 4 - Mar 5\r\n  DATE_TIME_RANGE: 'DATE_TIME_RANGE' // Mar 4, 2025 at 4:42 PM - Mar 5, 2025 at 5:00 PM MDT\r\n};\r\n\r\n/**\r\n * Converts UTC date and time strings to user's timezone and formats according to specified type\r\n * @param {string} dateStr - Date in YYYY-MM-DD format\r\n * @param {string} timeStr - Time in HH:mm format (24-hour)\r\n * @param {string} userTimezone - User's timezone (e.g., 'America/Denver')\r\n * @param {string} formatType - One of FORMAT_TYPES\r\n * @returns {string} Formatted date/time string\r\n */\r\nexport const formatFromUTC = (dateStr, timeStr = null, userTimezone, formatType = FORMAT_TYPES.MEDIUM_DATE) => {\r\n  try {\r\n    console.log('MBA134njo0vh02c23 formatFromUTC input:', { dateStr, timeStr, userTimezone, formatType });\r\n    \r\n    // Create a moment object in UTC with proper format\r\n    const utcMoment = moment.utc(`${dateStr}T${timeStr || '00:00'}:00Z`);\r\n    console.log('MBA134njo0vh02c23 UTC moment:', utcMoment.format());\r\n\r\n    // Convert to user's timezone\r\n    const localMoment = utcMoment.tz(userTimezone);\r\n    console.log('MBA134njo0vh02c23 Local moment:', localMoment.format());\r\n\r\n    // Get timezone abbreviation\r\n    const tzAbbrev = localMoment.zoneAbbr();\r\n    console.log('MBA134njo0vh02c23 Timezone abbreviation:', tzAbbrev);\r\n\r\n    // Format based on type\r\n    switch (formatType) {\r\n      case FORMAT_TYPES.SHORT_DATE:\r\n        return localMoment.format('MMM D');\r\n      case FORMAT_TYPES.MEDIUM_DATE:\r\n        return localMoment.format('MMM D, YYYY');\r\n      case FORMAT_TYPES.LONG_DATE:\r\n        return localMoment.format('MMMM D, YYYY');\r\n      case FORMAT_TYPES.TIME_ONLY:\r\n        return localMoment.format('h:mm A');\r\n      case FORMAT_TYPES.TIME_ONLY_24H:\r\n        return localMoment.format('HH:mm');\r\n      case FORMAT_TYPES.DATE_TIME:\r\n        return localMoment.format(\"MMM D, YYYY 'at' h:mm A\");\r\n      case FORMAT_TYPES.DATE_TIME_WITH_TZ:\r\n        return `${localMoment.format(\"MMM D, YYYY 'at' h:mm A\")} ${tzAbbrev}`;\r\n      default:\r\n        return localMoment.format('MMM D, YYYY');\r\n    }\r\n  } catch (error) {\r\n    console.error('MBA134njo0vh02c23 Error in formatFromUTC:', error);\r\n    return '';\r\n  }\r\n};\r\n\r\n/**\r\n * Formats a date/time range from UTC to user's timezone\r\n * @param {Object} params - Range parameters\r\n * @param {string} params.startDate - Start date in YYYY-MM-DD format\r\n * @param {string} params.startTime - Start time in HH:mm format\r\n * @param {string} params.endDate - End date in YYYY-MM-DD format\r\n * @param {string} params.endTime - End time in HH:mm format\r\n * @param {string} params.userTimezone - User's timezone\r\n * @param {boolean} params.includeTimes - Whether to include times in the output\r\n * @param {boolean} params.includeTimezone - Whether to include timezone in the output\r\n * @returns {string} Formatted date/time range\r\n */\r\nexport const formatDateTimeRangeFromUTC = ({\r\n  startDate,\r\n  startTime,\r\n  endDate,\r\n  endTime,\r\n  userTimezone,\r\n  includeTimes = true,\r\n  includeTimezone = true\r\n}) => {\r\n  try {\r\n    debugLog('MBA134njo: formatDateTimeRangeFromUTC input:', {\r\n      startDate,\r\n      startTime,\r\n      endDate,\r\n      endTime,\r\n      userTimezone,\r\n      includeTimes,\r\n      includeTimezone\r\n    });\r\n\r\n    if (includeTimes) {\r\n      // Create UTC moments with proper format\r\n      const startUtcMoment = moment.utc(`${startDate}T${startTime}:00Z`);\r\n      const endUtcMoment = moment.utc(`${endDate}T${endTime}:00Z`);\r\n\r\n      debugLog('MBA134njo: UTC moments:', {\r\n        start: startUtcMoment.format(),\r\n        end: endUtcMoment.format()\r\n      });\r\n\r\n      // Convert to local timezone\r\n      const startLocalMoment = startUtcMoment.tz(userTimezone);\r\n      const endLocalMoment = endUtcMoment.tz(userTimezone);\r\n\r\n      debugLog('MBA134njo: Local moments:', {\r\n        start: startLocalMoment.format(),\r\n        end: endLocalMoment.format()\r\n      });\r\n\r\n      // Get timezone abbreviation\r\n      const tzAbbrev = startLocalMoment.zoneAbbr();\r\n      debugLog('MBA134njo: Timezone abbreviation:', tzAbbrev);\r\n\r\n      // Format the dates without timezone in the format string\r\n      const startFormatted = startLocalMoment.format(\"MMM D, YYYY h:mm A\");\r\n      const endFormatted = endLocalMoment.format(\"MMM D, YYYY h:mm A\");\r\n\r\n      // Add timezone abbreviation if needed\r\n      const finalStart = includeTimezone ? `${startFormatted} ${tzAbbrev}` : startFormatted;\r\n      const finalEnd = includeTimezone ? `${endFormatted} ${tzAbbrev}` : endFormatted;\r\n\r\n      debugLog('MBA134njo: Formatted dates:', {\r\n        startFormatted: finalStart,\r\n        endFormatted: finalEnd,\r\n        tzAbbrev\r\n      });\r\n      \r\n      return `${finalStart} - ${finalEnd}`;\r\n    } else {\r\n      const startLocalMoment = moment.utc(`${startDate}T00:00:00Z`).tz(userTimezone);\r\n      const endLocalMoment = moment.utc(`${endDate}T00:00:00Z`).tz(userTimezone);\r\n      \r\n      return `${startLocalMoment.format('MMM D, YYYY')} - ${endLocalMoment.format('MMM D, YYYY')}`;\r\n    }\r\n  } catch (error) {\r\n    debugLog('MBA134njo: Error in formatDateTimeRangeFromUTC:', error);\r\n    return '';\r\n  }\r\n};\r\n\r\n/**\r\n * Converts a time string from UTC to local timezone, handling date boundary changes\r\n * @param {string} dateStr - Date in \"YYYY-MM-DD\" format \r\n * @param {string} timeStr - Time in \"HH:MM\" format (24-hour)\r\n * @param {string} timezone - User's timezone\r\n * @returns {Object} Object with time (hours/minutes) and adjusted date if it changed\r\n */\r\nfunction convertTimeFromUTC(dateStr, timeStr, timezone = 'US/Mountain') {\r\n  try {\r\n    // Create a full UTC datetime string\r\n    const utcDate = `${dateStr}T${timeStr}:00Z`;\r\n    \r\n    // Convert to local timezone using moment-timezone\r\n    const utcMoment = moment.utc(utcDate);\r\n    const localMoment = utcMoment.tz(timezone);\r\n    \r\n    // Extract hours and minutes\r\n    const hours = localMoment.hours();\r\n    const minutes = localMoment.minutes();\r\n    \r\n    // Check if the date changed during conversion\r\n    const localDateStr = localMoment.format('YYYY-MM-DD');\r\n    const dateChanged = localDateStr !== dateStr;\r\n    \r\n    debugLog('MBA2j3kbr9hve4: Time conversion details:', {\r\n      utc: {\r\n        date: dateStr,\r\n        time: timeStr,\r\n        fullDateTime: utcDate\r\n      },\r\n      local: {\r\n        date: localDateStr,\r\n        time: `${hours}:${minutes}`,\r\n        fullDateTime: localMoment.format(),\r\n        dateChanged\r\n      }\r\n    });\r\n    \r\n    return {\r\n      hours,\r\n      minutes,\r\n      adjustedDate: dateChanged ? localDateStr : null\r\n    };\r\n  } catch (error) {\r\n    debugLog('MBA2j3kbr9hve4: Error converting time from UTC:', error);\r\n    \r\n    // Return the UTC time parsed directly as fallback\r\n    const [hours, minutes] = timeStr.split(':').map(Number);\r\n    return {\r\n      hours: hours || 0,\r\n      minutes: minutes || 0,\r\n      adjustedDate: null\r\n    };\r\n  }\r\n}\r\n\r\n/**\r\n * Parses occurrences from the backend API into the format expected by DateSelectionCard and TimeSelectionCard\r\n * @param {Array} occurrences - Array of occurrence objects from the API\r\n * @returns {Object} Object containing formatted dates and times\r\n */\r\nexport const parseOccurrencesForBookingSteps = (occurrences) => {\r\n  debugLog('MBA2j3kbr9hve4: Parsing occurrences for booking steps:', occurrences);\r\n  \r\n  if (!occurrences || !Array.isArray(occurrences) || occurrences.length === 0) {\r\n    debugLog('MBA2j3kbr9hve4: No occurrences to parse');\r\n    return {\r\n      dates: [],\r\n      dateRange: null,\r\n      individualTimes: {},\r\n      defaultTimes: { startTime: { hours: 9, minutes: 0 }, endTime: { hours: 17, minutes: 0 } }\r\n    };\r\n  }\r\n  \r\n  // 1. Extract all unique dates and create Date objects\r\n  const uniqueDates = new Set();\r\n  const individualTimes = {};\r\n  \r\n  // Sort occurrences by date to ensure we get the correct start/end for date range\r\n  const sortedOccurrences = [...occurrences].sort((a, b) => {\r\n    return new Date(a.start_date) - new Date(b.start_date);\r\n  });\r\n  \r\n  debugLog('MBA2j3kbr9hve4: Sorted occurrences:', sortedOccurrences);\r\n  \r\n  // User's timezone - use Mountain Time as default\r\n  const userTimezone = 'US/Mountain';\r\n  \r\n  // Process each occurrence\r\n  sortedOccurrences.forEach(occurrence => {\r\n    const { start_date, end_date, start_time, end_time } = occurrence;\r\n    \r\n    if (!start_date || !start_time || !end_time) {\r\n      debugLog('MBA2j3kbr9hve4: Invalid occurrence data, missing required fields:', occurrence);\r\n      return;\r\n    }\r\n    \r\n    // Convert UTC times to local timezone, accounting for date boundary changes\r\n    const localStartTime = convertTimeFromUTC(start_date, start_time, userTimezone);\r\n    const localEndTime = convertTimeFromUTC(end_date || start_date, end_time, userTimezone);\r\n    \r\n    // Determine the actual local date to use, accounting for timezone adjustments\r\n    const actualStartDate = localStartTime.adjustedDate || start_date;\r\n    const actualEndDate = localEndTime.adjustedDate || (end_date || start_date);\r\n    \r\n    debugLog('MBA2j3kbr9hve4: Converted times with date adjustments:', {\r\n      utc: { \r\n        startDate: start_date, \r\n        startTime: start_time,\r\n        endDate: end_date || start_date,\r\n        endTime: end_time\r\n      },\r\n      local: { \r\n        startDate: actualStartDate,\r\n        startTime: localStartTime,\r\n        endDate: actualEndDate,\r\n        endTime: localEndTime\r\n      }\r\n    });\r\n    \r\n    // Add the adjusted dates to uniqueDates set\r\n    uniqueDates.add(actualStartDate);\r\n    \r\n    // If end date is different and not the same as start date, add it too\r\n    if (actualEndDate !== actualStartDate) {\r\n      uniqueDates.add(actualEndDate);\r\n    }\r\n    \r\n    // Create time objects for the TimeSelectionCard using the actual local date as key\r\n    individualTimes[actualStartDate] = {\r\n      startTime: {\r\n        hours: localStartTime.hours,\r\n        minutes: localStartTime.minutes\r\n      },\r\n      endTime: {\r\n        hours: localEndTime.hours,\r\n        minutes: localEndTime.minutes\r\n      },\r\n      isOvernightForced: actualStartDate !== actualEndDate\r\n    };\r\n  });\r\n  \r\n  // 2. Create the dates array from the set of unique dates\r\n  const dates = Array.from(uniqueDates).map(dateStr => {\r\n    const [year, month, day] = dateStr.split('-').map(Number);\r\n    return new Date(year, month - 1, day);\r\n  });\r\n  \r\n  // Log the parsed dates to ensure they're correct\r\n  debugLog('MBA2j3kbr9hve4: Parsed dates after timezone adjustment:', dates.map(d => d.toISOString().split('T')[0]));\r\n  \r\n  // 3. Create the date range\r\n  let dateRange = null;\r\n  if (dates.length > 0) {\r\n    // Sort dates to ensure correct order\r\n    const sortedDates = [...dates].sort((a, b) => a - b);\r\n    \r\n    // Create a proper date range with JavaScript Date objects\r\n    dateRange = {\r\n      startDate: sortedDates[0],\r\n      endDate: sortedDates[sortedDates.length - 1]\r\n    };\r\n    \r\n    debugLog('MBA2j3kbr9hve4: Created date range after timezone adjustment:', {\r\n      startDate: dateRange.startDate.toISOString().split('T')[0],\r\n      endDate: dateRange.endDate.toISOString().split('T')[0]\r\n    });\r\n  }\r\n  \r\n  // 4. Get default times from the first occurrence if available\r\n  let defaultTimes = {\r\n    startTime: { hours: 9, minutes: 0 }, // Default fallback\r\n    endTime: { hours: 17, minutes: 0 }    // Default fallback\r\n  };\r\n  \r\n  if (Object.keys(individualTimes).length > 0) {\r\n    // Use the first converted time as the default\r\n    const firstDateKey = Object.keys(individualTimes)[0];\r\n    defaultTimes = {\r\n      startTime: individualTimes[firstDateKey].startTime,\r\n      endTime: individualTimes[firstDateKey].endTime\r\n    };\r\n  }\r\n  \r\n  const result = {\r\n    dates,\r\n    dateRange,\r\n    individualTimes,\r\n    defaultTimes,\r\n    allTimesAreTheSame: Object.keys(individualTimes).length <= 1 || \r\n      Object.values(individualTimes).every(timeObj => \r\n        timeObj.startTime.hours === defaultTimes.startTime.hours &&\r\n        timeObj.startTime.minutes === defaultTimes.startTime.minutes &&\r\n        timeObj.endTime.hours === defaultTimes.endTime.hours &&\r\n        timeObj.endTime.minutes === defaultTimes.endTime.minutes\r\n      )\r\n  };\r\n  \r\n  debugLog('MBA2j3kbr9hve4: Parsed result with timezone adjustments:', result);\r\n  return result;\r\n}; ","import { API_BASE_URL } from '../config/config';\r\nimport { debugLog } from '../context/AuthContext';\r\nimport { Platform } from 'react-native';\r\n\r\n/**\r\n * WebSocket manager for real-time messaging\r\n */\r\nclass WebSocketManager {\r\n  constructor() {\r\n    this.socket = null;\r\n    this.isConnected = false;\r\n    this.token = null;\r\n    this.connectionAttempts = 0;\r\n    this.maxConnectionAttempts = 5;\r\n    this.heartbeatInterval = null;\r\n    this.disconnectTimeout = null;\r\n    this.messageHandlers = new Map();\r\n    this.connectionId = null;\r\n    this.wsUrl = API_BASE_URL.replace('http://', 'ws://').replace('https://', 'wss://');\r\n    this._reconnectTimeout = null;\r\n    this.forceDisconnect = false;\r\n    this._hasVisibilityListener = false;\r\n    debugLog('MBA4321: WebSocketManager initialized, wsUrl is ' + this.wsUrl);\r\n  }\r\n\r\n  /**\r\n   * Initialize the WebSocket connection with authentication token\r\n   * @param {string} token - JWT token for authentication\r\n   */\r\n  init(token) {\r\n    if (!token) {\r\n      debugLog('MBA4321: Cannot initialize WebSocket without a valid token');\r\n      return;\r\n    }\r\n    \r\n    // If we already have this token and connection, no need to reconnect\r\n    if (this.token === token && this.isConnected && this.socket && this.socket.readyState === WebSocket.OPEN) {\r\n      debugLog('MBA4321: WebSocket already connected with this token');\r\n      return;\r\n    }\r\n    \r\n    // If we already had a token and it's different, this is a re-login, so force disconnect\r\n    if (this.token && this.token !== token) {\r\n      debugLog('MBA4321: Token changed, force disconnecting before reconnecting');\r\n      this.disconnect(true); // Force disconnect on token change\r\n    }\r\n    \r\n    this.token = token;\r\n    this.forceDisconnect = false; // Reset force disconnect flag\r\n    \r\n    // If we already have a socket but it's not working, close it first\r\n    if (this.socket && (this.socket.readyState === WebSocket.CLOSING || this.socket.readyState === WebSocket.CLOSED)) {\r\n      debugLog('MBA4321: Closing existing non-functional socket');\r\n      this.disconnect(false); // Non-forced disconnect\r\n    }\r\n    \r\n    // Connect with the token\r\n    this.connect();\r\n    \r\n    // Set up disconnect timeout (10 minutes of inactivity)\r\n    this.resetDisconnectTimeout();\r\n    \r\n    // Set up visibility change listener if in browser environment\r\n    this.setupVisibilityListener();\r\n  }\r\n\r\n  /**\r\n   * Set up visibility change listener to reconnect when tab becomes visible again\r\n   */\r\n  setupVisibilityListener() {\r\n    // Only run in browser environment\r\n    if (typeof document === 'undefined' || typeof window === 'undefined') {\r\n      return;\r\n    }\r\n    \r\n    // Skip if we've already set up the listener\r\n    if (this._hasVisibilityListener) {\r\n      return;\r\n    }\r\n    \r\n    debugLog('MBA4321: Setting up visibility change listener');\r\n    \r\n    // Create the handler function\r\n    const handleVisibilityChange = () => {\r\n      if (Platform.OS === 'web' && document.visibilityState === 'visible') {\r\n        debugLog('MBA4321: Document became visible, checking WebSocket connection');\r\n        \r\n        // Only reconnect if we have a token and weren't explicitly disconnected\r\n        if (this.token && !this.forceDisconnect) {\r\n          this.reconnectIfNeeded();\r\n        }\r\n      }\r\n    };\r\n    \r\n    // Add the listener only for web\r\n    if (Platform.OS === 'web') {\r\n      document.addEventListener('visibilitychange', handleVisibilityChange);\r\n      this._hasVisibilityListener = true;\r\n      \r\n      // Set up cleanup on page unload if needed\r\n      window.addEventListener('beforeunload', () => {\r\n        // Note: we deliberately don't disconnect here, as this would prevent\r\n        // browser session restoration from working properly\r\n        debugLog('MBA4321: Page unloading, connection may persist for session restore');\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Connect to the WebSocket server\r\n   */\r\n  connect() {\r\n    // Skip connection if token is null or empty\r\n    if (!this.token) {\r\n      debugLog('MBA4321: Cannot connect WebSocket without a valid token');\r\n      return false;\r\n    }\r\n    \r\n    // If already connected, no need to reconnect\r\n    if (this.isConnected && this.socket && this.socket.readyState === WebSocket.OPEN) {\r\n      debugLog('MBA4321: WebSocket already connected and open');\r\n      return true;\r\n    }\r\n    \r\n    // If socket exists but is in CONNECTING state, don't start another connection\r\n    if (this.socket && this.socket.readyState === WebSocket.CONNECTING) {\r\n      debugLog('MBA4321: WebSocket already connecting, skipping duplicate connect');\r\n      return true;\r\n    }\r\n    \r\n    // Clear any existing heartbeat\r\n    if (this.heartbeatInterval) {\r\n      clearInterval(this.heartbeatInterval);\r\n      this.heartbeatInterval = null;\r\n    }\r\n    \r\n    // If too many connection attempts, back off\r\n    if (this.connectionAttempts >= this.maxConnectionAttempts) {\r\n      debugLog(`MBA4321: Too many connection attempts (${this.connectionAttempts}), backing off`);\r\n      setTimeout(() => {\r\n        this.connectionAttempts = 0;\r\n        this.connect();\r\n      }, 60000);\r\n      return false;\r\n    }\r\n    \r\n    try {\r\n      this.connectionAttempts++;\r\n      \r\n      const wsEndpoint = `${this.wsUrl}/ws/messages/?token=${this.token}`;\r\n      debugLog(`MBA4321: [MY CONNECTION] Connecting WebSocket at ${wsEndpoint} (attempt ${this.connectionAttempts})`);\r\n      \r\n      this.socket = new WebSocket(wsEndpoint);\r\n      debugLog('MBA4321: [MY CONNECTION] WebSocket instance created');\r\n      \r\n      // Setup event handlers\r\n      this.socket.onopen = this.handleOpen.bind(this);\r\n      this.socket.onclose = this.handleClose.bind(this);\r\n      this.socket.onmessage = this.handleMessage.bind(this);\r\n      this.socket.onerror = this.handleError.bind(this);\r\n      \r\n      return true;\r\n    } catch (error) {\r\n      debugLog(`MBA4321: [MY CONNECTION] WebSocket connection error: ${error.message}`);\r\n      this.scheduleReconnect();\r\n      return false;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handle WebSocket connection open\r\n   */\r\n  handleOpen(event) {\r\n    debugLog('MBA4321: [MY CONNECTION] WebSocket connection established');\r\n    this.isConnected = true;\r\n    this.connectionAttempts = 0; // Reset connection attempts on successful connection\r\n    \r\n    // Start sending heartbeats\r\n    this.startHeartbeat();\r\n    \r\n    // Log connection status for debugging\r\n    debugLog(`MBA4321: [MY CONNECTION] isConnected set to ${this.isConnected}, socket state: ${this.socket?.readyState}`);\r\n    \r\n    // Notify all handlers of connection\r\n    this.notifyHandlers('connection', { \r\n      status: 'connected',\r\n      timestamp: new Date().toISOString()\r\n    });\r\n    \r\n    // Send immediate heartbeat to verify connection on both sides\r\n    setTimeout(() => {\r\n      if (this.isConnected) {\r\n        debugLog('MBA4321: [MY CONNECTION] Sending initial heartbeat after connection');\r\n        this.send('heartbeat');\r\n      }\r\n    }, 500);\r\n  }\r\n\r\n  /**\r\n   * Handle WebSocket connection close\r\n   */\r\n  handleClose(event) {\r\n    // Skip redundant close events\r\n    if (!this.isConnected && !this.socket) {\r\n      return;\r\n    }\r\n\r\n    const wasConnected = this.isConnected;\r\n    this.isConnected = false;\r\n    this.socket = null;\r\n    \r\n    debugLog(`MBA4321: [MY CONNECTION] WebSocket connection closed: code=${event.code}, reason=${event.reason}`);\r\n    \r\n    // Clear heartbeat\r\n    if (this.heartbeatInterval) {\r\n      clearInterval(this.heartbeatInterval);\r\n      this.heartbeatInterval = null;\r\n    }\r\n    \r\n    // Notify handlers of the disconnection, but only if we were previously connected\r\n    if (wasConnected) {\r\n      this.notifyHandlers('disconnection', {\r\n        code: event.code,\r\n        reason: event.reason,\r\n        timestamp: new Date().toISOString()\r\n      });\r\n    }\r\n    \r\n    // Attempt to reconnect\r\n    this.scheduleReconnect();\r\n  }\r\n\r\n  /**\r\n   * Handle WebSocket messages\r\n   */\r\n  handleMessage(event) {\r\n    try {\r\n      const message = JSON.parse(event.data);\r\n      debugLog(`MBA4321: [MY CONNECTION] WebSocket message received: ${message.type}`);\r\n      \r\n      // For detailed message logging, use debugLog instead of is_DEBUG check\r\n      debugLog(`MBA4321: [MY CONNECTION] WebSocket message content: ${event.data}`);\r\n      \r\n      // For heartbeat responses, just log and return\r\n      if (message.type === 'heartbeat_ack') {\r\n        return;\r\n      }\r\n      \r\n      // Notify handlers based on message type\r\n      this.notifyHandlers(message.type, message.data || {});\r\n      \r\n      // Also notify global handlers\r\n      this.notifyHandlers('all', { type: message.type, data: message.data || {} });\r\n      \r\n    } catch (error) {\r\n      debugLog(`MBA4321: [MY CONNECTION] Error handling WebSocket message: ${error.message}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handle WebSocket errors\r\n   */\r\n  handleError(error) {\r\n    debugLog(`MBA4321: [MY CONNECTION] WebSocket error: ${error.message || 'Unknown error'}`);\r\n    \r\n    // Notify handlers of the error\r\n    this.notifyHandlers('error', { \r\n      error: error.message || 'Unknown error',\r\n      timestamp: new Date().toISOString()\r\n    });\r\n    \r\n    // Try to reconnect on error\r\n    this.scheduleReconnect();\r\n  }\r\n\r\n  /**\r\n   * Send a message through the WebSocket\r\n   */\r\n  send(type, data = {}) {\r\n    if (!this.isConnected || !this.socket) {\r\n      debugLog('MBA4321: [MY CONNECTION] Cannot send message, WebSocket not connected');\r\n      return false;\r\n    }\r\n\r\n    try {\r\n      const message = JSON.stringify({\r\n        type,\r\n        data,\r\n        timestamp: Date.now()\r\n      });\r\n      \r\n      this.socket.send(message);\r\n      debugLog(`MBA4321: [MY CONNECTION] Sent ${type} message through connection`);\r\n      return true;\r\n    } catch (error) {\r\n      debugLog(`MBA4321: [MY CONNECTION] Error sending message through connection: ${error.message}`);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Schedule a reconnection attempt\r\n   */\r\n  scheduleReconnect() {\r\n    // Skip if a reconnection is already scheduled\r\n    if (this._reconnectTimeout) {\r\n      debugLog('MBA4321: Reconnect already scheduled, skipping duplicate');\r\n      return;\r\n    }\r\n    \r\n    const delay = Math.min(1000 * Math.pow(2, this.connectionAttempts - 1), 30000);\r\n    debugLog(`MBA4321: Scheduling reconnect in ${delay}ms (attempt ${this.connectionAttempts})`);\r\n    \r\n    this._reconnectTimeout = setTimeout(() => {\r\n      this._reconnectTimeout = null;\r\n      if (!this.isConnected) {\r\n        this.connect();\r\n      }\r\n    }, delay);\r\n  }\r\n\r\n  /**\r\n   * Start sending heartbeat messages\r\n   */\r\n  startHeartbeat() {\r\n    // Clear any existing interval\r\n    if (this.heartbeatInterval) {\r\n      clearInterval(this.heartbeatInterval);\r\n    }\r\n\r\n    // Start a new interval\r\n    this.heartbeatInterval = setInterval(() => {\r\n      if (this.isConnected) {\r\n        this.send('heartbeat', { timestamp: Date.now() });\r\n        debugLog('MBA4321: Heartbeat sent');\r\n      } else {\r\n        debugLog('MBA4321: Skipping heartbeat, not connected');\r\n        clearInterval(this.heartbeatInterval);\r\n        this.heartbeatInterval = null;\r\n      }\r\n    }, 30000); // 30 seconds\r\n\r\n    debugLog('MBA4321: Heartbeat mechanism started');\r\n  }\r\n\r\n  /**\r\n   * Disconnect the WebSocket\r\n   * @param {boolean} force - Whether to force disconnect (true) or allow reconnect on visibility change (false)\r\n   */\r\n  disconnect(force = false) {\r\n    debugLog(`MBA4321: [MY CONNECTION] Disconnecting WebSocket connection (force=${force})`);\r\n    \r\n    // Set the force disconnect flag if requested\r\n    this.forceDisconnect = force;\r\n    \r\n    // If this is just a tab change and not a forced disconnect,\r\n    // we'll preserve the token to allow reconnection\r\n    const preserveToken = !force;\r\n    const savedToken = preserveToken ? this.token : null;\r\n    \r\n    // Clear heartbeat interval\r\n    if (this.heartbeatInterval) {\r\n      clearInterval(this.heartbeatInterval);\r\n      this.heartbeatInterval = null;\r\n    }\r\n    \r\n    // Clear disconnect timeout\r\n    if (this.disconnectTimeout) {\r\n      clearTimeout(this.disconnectTimeout);\r\n      this.disconnectTimeout = null;\r\n    }\r\n    \r\n    // Close the socket if it exists\r\n    if (this.socket) {\r\n      try {\r\n        // Remove all event handlers to prevent reconnection attempts from them\r\n        this.socket.onopen = null;\r\n        this.socket.onclose = null;\r\n        this.socket.onmessage = null;\r\n        this.socket.onerror = null;\r\n        \r\n        // Close the connection\r\n        this.socket.close();\r\n        this.socket = null;\r\n        \r\n        debugLog('MBA4321: [MY CONNECTION] WebSocket connection closed successfully');\r\n      } catch (error) {\r\n        debugLog(`MBA4321: [MY CONNECTION] Error closing WebSocket: ${error.message}`);\r\n      }\r\n    }\r\n    \r\n    // Reset connection state\r\n    this.isConnected = false;\r\n    \r\n    // Restore token if this wasn't a forced disconnect (just a tab change)\r\n    if (preserveToken && savedToken) {\r\n      this.token = savedToken;\r\n      debugLog('MBA4321: [MY CONNECTION] Preserved token for reconnection on tab visibility change');\r\n    }\r\n    \r\n    // Notify handlers of the disconnection\r\n    this.notifyHandlers('connection', { \r\n      status: 'disconnected',\r\n      forced: force,\r\n      timestamp: new Date().toISOString()\r\n    });\r\n    \r\n    return true;\r\n  }\r\n\r\n  /**\r\n   * Reset the disconnect timeout\r\n   * This timeout will disconnect the WebSocket after 10 minutes of inactivity\r\n   */\r\n  resetDisconnectTimeout() {\r\n    // Clear any existing timeout\r\n    if (this.disconnectTimeout) {\r\n      clearTimeout(this.disconnectTimeout);\r\n    }\r\n    \r\n    // Set a new timeout\r\n    this.disconnectTimeout = setTimeout(() => {\r\n      debugLog('MBA4321: Disconnecting due to inactivity');\r\n      this.disconnect();\r\n    }, 600000); // 10 minutes\r\n  }\r\n\r\n  /**\r\n   * Check if WebSocket is connected\r\n   * @returns {boolean} Connection status\r\n   */\r\n  isWebSocketConnected() {\r\n    return this.isConnected && this.socket && this.socket.readyState === WebSocket.OPEN;\r\n  }\r\n\r\n  /**\r\n   * Register a handler for specific message types\r\n   * @param {string} messageType - Type of message to handle\r\n   * @param {function} handler - Handler function\r\n   * @param {string} handlerId - Unique identifier for this handler\r\n   */\r\n  registerHandler(messageType, handler, handlerId) {\r\n    if (!this.messageHandlers.has(messageType)) {\r\n      this.messageHandlers.set(messageType, new Map());\r\n    }\r\n    \r\n    this.messageHandlers.get(messageType).set(handlerId, handler);\r\n    debugLog(`MBA4321: Registered handler ${handlerId} for ${messageType} messages`);\r\n    \r\n    return () => this.unregisterHandler(messageType, handlerId);\r\n  }\r\n\r\n  /**\r\n   * Unregister a handler\r\n   * @param {string} messageType - Type of message\r\n   * @param {string} handlerId - Handler ID to remove\r\n   */\r\n  unregisterHandler(messageType, handlerId) {\r\n    if (this.messageHandlers.has(messageType)) {\r\n      this.messageHandlers.get(messageType).delete(handlerId);\r\n      debugLog(`MBA4321: Unregistered handler ${handlerId} for ${messageType} messages`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Notify all registered handlers for a specific message type\r\n   * @param {string} messageType - Type of message\r\n   * @param {object} data - Message data\r\n   */\r\n  notifyHandlers(messageType, data) {\r\n    if (this.messageHandlers.has(messageType)) {\r\n      const handlers = this.messageHandlers.get(messageType);\r\n      \r\n      handlers.forEach((handler, id) => {\r\n        try {\r\n          handler(data);\r\n        } catch (error) {\r\n          debugLog(`MBA4321: Error in ${messageType} handler ${id}: ${error.message}`);\r\n        }\r\n      });\r\n    }\r\n    \r\n    // Also notify global handlers (if any)\r\n    if (messageType !== 'all' && this.messageHandlers.has('all')) {\r\n      const globalHandlers = this.messageHandlers.get('all');\r\n      \r\n      globalHandlers.forEach((handler, id) => {\r\n        try {\r\n          handler({ type: messageType, data });\r\n        } catch (error) {\r\n          debugLog(`MBA4321: Error in global handler ${id}: ${error.message}`);\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Mark messages as read\r\n   * @param {number} conversationId - Conversation ID\r\n   * @param {Array} messageIds - Array of message IDs to mark as read\r\n   */\r\n  markMessagesAsRead(conversationId, messageIds) {\r\n    if (!Array.isArray(messageIds) || messageIds.length === 0) {\r\n      return false;\r\n    }\r\n    \r\n    return this.send('mark_read', {\r\n      conversation_id: conversationId,\r\n      message_ids: messageIds\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Check if WebSocket is connected and reconnect if needed\r\n   * @returns {boolean} Whether a reconnection was attempted\r\n   */\r\n  reconnectIfNeeded() {\r\n    debugLog('MBA4321: [MY CONNECTION] Checking if WebSocket reconnection needed');\r\n    \r\n    // If we don't have a token or were force disconnected, don't try to reconnect\r\n    if (!this.token || this.forceDisconnect) {\r\n      debugLog(`MBA4321: [MY CONNECTION] Cannot reconnect - ${!this.token ? 'no token' : 'force disconnected'}`);\r\n      return false;\r\n    }\r\n    \r\n    // Check if we need to reconnect\r\n    const needsReconnect = (\r\n      !this.isConnected || \r\n      !this.socket || \r\n      (this.socket && (\r\n        this.socket.readyState === WebSocket.CLOSED || \r\n        this.socket.readyState === WebSocket.CLOSING\r\n      ))\r\n    );\r\n    \r\n    if (needsReconnect) {\r\n      debugLog('MBA4321: [MY CONNECTION] WebSocket needs reconnection, attempting now');\r\n      \r\n      // Reset the force disconnect flag\r\n      this.forceDisconnect = false;\r\n      \r\n      // Ensure old connection is properly closed\r\n      if (this.socket) {\r\n        try {\r\n          this.socket.onclose = null; // Prevent recursive reconnection\r\n          this.socket.close();\r\n          this.socket = null;\r\n        } catch (e) {\r\n          debugLog(`MBA4321: [MY CONNECTION] Error closing existing socket: ${e.message}`);\r\n        }\r\n      }\r\n      \r\n      this.isConnected = false;\r\n      \r\n      // Reconnect\r\n      setTimeout(() => {\r\n        this.connect();\r\n      }, 100);\r\n      \r\n      return true;\r\n    }\r\n    \r\n    // If we're connected, send a heartbeat to verify connection\r\n    if (this.isConnected && this.socket && this.socket.readyState === WebSocket.OPEN) {\r\n      debugLog('MBA4321: [MY CONNECTION] WebSocket appears connected, sending heartbeat to verify');\r\n      this.send('heartbeat');\r\n      \r\n      // Reset the disconnect timeout to prevent inactivity disconnection\r\n      this.resetDisconnectTimeout();\r\n    }\r\n    \r\n    return false;\r\n  }\r\n}\r\n\r\n// Create a singleton instance\r\nconst websocketManager = new WebSocketManager();\r\n\r\n// Export the singleton\r\nexport default websocketManager; ","var map = {\n\t\"./af\": 17582,\n\t\"./af.js\": 17582,\n\t\"./ar\": 93042,\n\t\"./ar-dz\": 54265,\n\t\"./ar-dz.js\": 54265,\n\t\"./ar-kw\": 92553,\n\t\"./ar-kw.js\": 92553,\n\t\"./ar-ly\": 85352,\n\t\"./ar-ly.js\": 85352,\n\t\"./ar-ma\": 67097,\n\t\"./ar-ma.js\": 67097,\n\t\"./ar-ps\": 76150,\n\t\"./ar-ps.js\": 76150,\n\t\"./ar-sa\": 84427,\n\t\"./ar-sa.js\": 84427,\n\t\"./ar-tn\": 7221,\n\t\"./ar-tn.js\": 7221,\n\t\"./ar.js\": 93042,\n\t\"./az\": 60458,\n\t\"./az.js\": 60458,\n\t\"./be\": 17596,\n\t\"./be.js\": 17596,\n\t\"./bg\": 93830,\n\t\"./bg.js\": 93830,\n\t\"./bm\": 27044,\n\t\"./bm.js\": 27044,\n\t\"./bn\": 58573,\n\t\"./bn-bd\": 13296,\n\t\"./bn-bd.js\": 13296,\n\t\"./bn.js\": 58573,\n\t\"./bo\": 25614,\n\t\"./bo.js\": 25614,\n\t\"./br\": 62041,\n\t\"./br.js\": 62041,\n\t\"./bs\": 91786,\n\t\"./bs.js\": 91786,\n\t\"./ca\": 75833,\n\t\"./ca.js\": 75833,\n\t\"./cs\": 52711,\n\t\"./cs.js\": 52711,\n\t\"./cv\": 71036,\n\t\"./cv.js\": 71036,\n\t\"./cy\": 84977,\n\t\"./cy.js\": 84977,\n\t\"./da\": 8770,\n\t\"./da.js\": 8770,\n\t\"./de\": 67342,\n\t\"./de-at\": 81566,\n\t\"./de-at.js\": 81566,\n\t\"./de-ch\": 87544,\n\t\"./de-ch.js\": 87544,\n\t\"./de.js\": 67342,\n\t\"./dv\": 82875,\n\t\"./dv.js\": 82875,\n\t\"./el\": 78536,\n\t\"./el.js\": 78536,\n\t\"./en-au\": 38617,\n\t\"./en-au.js\": 38617,\n\t\"./en-ca\": 79227,\n\t\"./en-ca.js\": 79227,\n\t\"./en-gb\": 59754,\n\t\"./en-gb.js\": 59754,\n\t\"./en-ie\": 37217,\n\t\"./en-ie.js\": 37217,\n\t\"./en-il\": 85418,\n\t\"./en-il.js\": 85418,\n\t\"./en-in\": 80800,\n\t\"./en-in.js\": 80800,\n\t\"./en-nz\": 67299,\n\t\"./en-nz.js\": 67299,\n\t\"./en-sg\": 76305,\n\t\"./en-sg.js\": 76305,\n\t\"./eo\": 8673,\n\t\"./eo.js\": 8673,\n\t\"./es\": 71301,\n\t\"./es-do\": 3187,\n\t\"./es-do.js\": 3187,\n\t\"./es-mx\": 48223,\n\t\"./es-mx.js\": 48223,\n\t\"./es-us\": 37634,\n\t\"./es-us.js\": 37634,\n\t\"./es.js\": 71301,\n\t\"./et\": 4976,\n\t\"./et.js\": 4976,\n\t\"./eu\": 11847,\n\t\"./eu.js\": 11847,\n\t\"./fa\": 74372,\n\t\"./fa.js\": 74372,\n\t\"./fi\": 41628,\n\t\"./fi.js\": 41628,\n\t\"./fil\": 56802,\n\t\"./fil.js\": 56802,\n\t\"./fo\": 42874,\n\t\"./fo.js\": 42874,\n\t\"./fr\": 9853,\n\t\"./fr-ca\": 87170,\n\t\"./fr-ca.js\": 87170,\n\t\"./fr-ch\": 22825,\n\t\"./fr-ch.js\": 22825,\n\t\"./fr.js\": 9853,\n\t\"./fy\": 68876,\n\t\"./fy.js\": 68876,\n\t\"./ga\": 93533,\n\t\"./ga.js\": 93533,\n\t\"./gd\": 82770,\n\t\"./gd.js\": 82770,\n\t\"./gl\": 98602,\n\t\"./gl.js\": 98602,\n\t\"./gom-deva\": 63059,\n\t\"./gom-deva.js\": 63059,\n\t\"./gom-latn\": 48212,\n\t\"./gom-latn.js\": 48212,\n\t\"./gu\": 23409,\n\t\"./gu.js\": 23409,\n\t\"./he\": 17210,\n\t\"./he.js\": 17210,\n\t\"./hi\": 4750,\n\t\"./hi.js\": 4750,\n\t\"./hr\": 51315,\n\t\"./hr.js\": 51315,\n\t\"./hu\": 47626,\n\t\"./hu.js\": 47626,\n\t\"./hy-am\": 91317,\n\t\"./hy-am.js\": 91317,\n\t\"./id\": 26892,\n\t\"./id.js\": 26892,\n\t\"./is\": 97577,\n\t\"./is.js\": 97577,\n\t\"./it\": 57628,\n\t\"./it-ch\": 3046,\n\t\"./it-ch.js\": 3046,\n\t\"./it.js\": 57628,\n\t\"./ja\": 92504,\n\t\"./ja.js\": 92504,\n\t\"./jv\": 25917,\n\t\"./jv.js\": 25917,\n\t\"./ka\": 64513,\n\t\"./ka.js\": 64513,\n\t\"./kk\": 94935,\n\t\"./kk.js\": 94935,\n\t\"./km\": 96661,\n\t\"./km.js\": 96661,\n\t\"./kn\": 89964,\n\t\"./kn.js\": 89964,\n\t\"./ko\": 98067,\n\t\"./ko.js\": 98067,\n\t\"./ku\": 61165,\n\t\"./ku-kmr\": 85158,\n\t\"./ku-kmr.js\": 85158,\n\t\"./ku.js\": 61165,\n\t\"./ky\": 11177,\n\t\"./ky.js\": 11177,\n\t\"./lb\": 2967,\n\t\"./lb.js\": 2967,\n\t\"./lo\": 81972,\n\t\"./lo.js\": 81972,\n\t\"./lt\": 58469,\n\t\"./lt.js\": 58469,\n\t\"./lv\": 33155,\n\t\"./lv.js\": 33155,\n\t\"./me\": 87935,\n\t\"./me.js\": 87935,\n\t\"./mi\": 74483,\n\t\"./mi.js\": 74483,\n\t\"./mk\": 32501,\n\t\"./mk.js\": 32501,\n\t\"./ml\": 73120,\n\t\"./ml.js\": 73120,\n\t\"./mn\": 20266,\n\t\"./mn.js\": 20266,\n\t\"./mr\": 19406,\n\t\"./mr.js\": 19406,\n\t\"./ms\": 80109,\n\t\"./ms-my\": 90864,\n\t\"./ms-my.js\": 90864,\n\t\"./ms.js\": 80109,\n\t\"./mt\": 22904,\n\t\"./mt.js\": 22904,\n\t\"./my\": 44067,\n\t\"./my.js\": 44067,\n\t\"./nb\": 21301,\n\t\"./nb.js\": 21301,\n\t\"./ne\": 81152,\n\t\"./ne.js\": 81152,\n\t\"./nl\": 76735,\n\t\"./nl-be\": 97761,\n\t\"./nl-be.js\": 97761,\n\t\"./nl.js\": 76735,\n\t\"./nn\": 37569,\n\t\"./nn.js\": 37569,\n\t\"./oc-lnc\": 20833,\n\t\"./oc-lnc.js\": 20833,\n\t\"./pa-in\": 3044,\n\t\"./pa-in.js\": 3044,\n\t\"./pl\": 34249,\n\t\"./pl.js\": 34249,\n\t\"./pt\": 87585,\n\t\"./pt-br\": 26826,\n\t\"./pt-br.js\": 26826,\n\t\"./pt.js\": 87585,\n\t\"./ro\": 62526,\n\t\"./ro.js\": 62526,\n\t\"./ru\": 62204,\n\t\"./ru.js\": 62204,\n\t\"./sd\": 43270,\n\t\"./sd.js\": 43270,\n\t\"./se\": 61541,\n\t\"./se.js\": 61541,\n\t\"./si\": 71921,\n\t\"./si.js\": 71921,\n\t\"./sk\": 49935,\n\t\"./sk.js\": 49935,\n\t\"./sl\": 46254,\n\t\"./sl.js\": 46254,\n\t\"./sq\": 59897,\n\t\"./sq.js\": 59897,\n\t\"./sr\": 42496,\n\t\"./sr-cyrl\": 11135,\n\t\"./sr-cyrl.js\": 11135,\n\t\"./sr.js\": 42496,\n\t\"./ss\": 32215,\n\t\"./ss.js\": 32215,\n\t\"./sv\": 84716,\n\t\"./sv.js\": 84716,\n\t\"./sw\": 50803,\n\t\"./sw.js\": 50803,\n\t\"./ta\": 31538,\n\t\"./ta.js\": 31538,\n\t\"./te\": 2302,\n\t\"./te.js\": 2302,\n\t\"./tet\": 25280,\n\t\"./tet.js\": 25280,\n\t\"./tg\": 14100,\n\t\"./tg.js\": 14100,\n\t\"./th\": 95385,\n\t\"./th.js\": 95385,\n\t\"./tk\": 736,\n\t\"./tk.js\": 736,\n\t\"./tl-ph\": 79726,\n\t\"./tl-ph.js\": 79726,\n\t\"./tlh\": 41873,\n\t\"./tlh.js\": 41873,\n\t\"./tr\": 36463,\n\t\"./tr.js\": 36463,\n\t\"./tzl\": 27491,\n\t\"./tzl.js\": 27491,\n\t\"./tzm\": 29500,\n\t\"./tzm-latn\": 80196,\n\t\"./tzm-latn.js\": 80196,\n\t\"./tzm.js\": 29500,\n\t\"./ug-cn\": 91287,\n\t\"./ug-cn.js\": 91287,\n\t\"./uk\": 35341,\n\t\"./uk.js\": 35341,\n\t\"./ur\": 36246,\n\t\"./ur.js\": 36246,\n\t\"./uz\": 55550,\n\t\"./uz-latn\": 77254,\n\t\"./uz-latn.js\": 77254,\n\t\"./uz.js\": 55550,\n\t\"./vi\": 78796,\n\t\"./vi.js\": 78796,\n\t\"./x-pseudo\": 22736,\n\t\"./x-pseudo.js\": 22736,\n\t\"./yo\": 28621,\n\t\"./yo.js\": 28621,\n\t\"./zh-cn\": 67601,\n\t\"./zh-cn.js\": 67601,\n\t\"./zh-hk\": 39053,\n\t\"./zh-hk.js\": 39053,\n\t\"./zh-mo\": 71248,\n\t\"./zh-mo.js\": 71248,\n\t\"./zh-tw\": 74725,\n\t\"./zh-tw.js\": 74725\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 35358;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","var deferred = [];\n__webpack_require__.O = (result, chunkIds, fn, priority) => {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar [chunkIds, fn, priority] = deferred[i];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every((key) => (__webpack_require__.O[key](chunkIds[j])))) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.nmd = (module) => {\n\tmodule.paths = [];\n\tif (!module.children) module.children = [];\n\treturn module;\n};","__webpack_require__.p = \"/\";","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t792: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = (chunkId) => (installedChunks[chunkId] === 0);\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some((id) => (installedChunks[id] !== 0))) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkweb\"] = self[\"webpackChunkweb\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [9], () => (__webpack_require__(55819)))\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["styles","StyleSheet","create","overlay","position","Platform","OS","top","left","right","bottom","backgroundColor","zIndex","container","theme","colors","surface","borderRadius","padding","width","shadowColor","shadowOffset","height","shadowOpacity","shadowRadius","elevation","borderWidth","borderColor","primary","pulseBorder","opacity","closeButton","content","marginTop","title","fontSize","fontWeight","color","marginBottom","fontFamily","fonts","header","description","text","lineHeight","regular","footer","flexDirection","justifyContent","alignItems","leftButtons","flex","skipButton","paddingVertical","paddingHorizontal","skipText","secondary","navigationButton","navigationText","finishButton","finishText","stepIndicator","stepText","TutorialModal","step","totalSteps","onNext","onPrevious","onSkip","onClose","onFinish","userRole","is_DEBUG","isFirstStep","isLastStep","isVisible","setIsVisible","useState","currentScreen","setCurrentScreen","navigation","useNavigation","fadeAnim","useRef","Animated","Value","current","slideAnim","overlayAnim","Dimensions","get","useEffect","debugLog","currentStep","screen","timer","setTimeout","clearTimeout","addListener","timing","toValue","duration","useNativeDriver","start","initialPosition","finalPosition","getPositionStyles","slideStyle","transform","translateX","interpolate","inputRange","outputRange","translateY","_jsxs","_Fragment","children","_jsx","View","style","pointerEvents","TouchableOpacity","onPress","handleClose","MaterialCommunityIcons","name","size","Text","handleSkip","handlePrevious","handleFinish","handleNext","modalOverlay","modalContent","maxWidth","modalText","fontSizes","medium","textAlign","buttonContainer","gap","button","cancelButton","border","confirmButton","cancelButtonText","confirmButtonText","disabledButton","disabledText","ConfirmationModal","visible","onConfirm","actionText","isLoading","Modal","transparent","animationType","onRequestClose","disabled","ActivityIndicator","TutorialContext","createContext","defaultTutorialStatus","done_client_tutorial","done_pro_tutorial","tutorialSteps","client","tab","onStepEnter","navigate","professional","default","TutorialProvider","isSignedIn","useContext","AuthContext","tutorialStatus","setTutorialStatus","setCurrentStep","hasError","setHasError","errorMessage","setErrorMessage","setIsLoading","skipConfirmationVisible","setSkipConfirmationVisible","closeConfirmationVisible","setCloseConfirmationVisible","fetchTutorialStatus","async","response","axios","concat","API_BASE_URL","data","navigateToFrom","error","console","getCurrentStepData","roleKey","steps","safeCurrentStep","Math","min","max","length","stepData","Object","assign","nextStep","currentStepData","prevStep","from","to","fromTab","toTab","previousStep","completeTutorial","updates","patch","message","Provider","value","handleSkipCancel","handleSkipConfirm","handleCloseCancel","handleCloseConfirm","toast","minWidth","icon","marginRight","undefined","Toast","type","onDismiss","animation","timeoutRef","parallel","handleDismiss","callback","getBackgroundColor","warning","info","getIcon","numberOfLines","ellipsizeMode","hitSlop","ToastContext","useToast","context","Error","ToastProvider","setToast","showToast","useCallback","hideToast","prev","marginLeft","mobileContainer","mobileItemContainer","mobileMarker","mobileMilestoneTitle","mobileDashedLine","borderStyle","webContainer","dashedLine","webMarker","webMilestoneTitle","markerContainer","modalIconContainer","modalNumber","modalTitle","modalDescription","closeButtonText","RoadmapSection","selectedMilestone","setSelectedMilestone","modalVisible","setModalVisible","screenWidth","isMobile","roadmapData","id","mainColors","senary","quinary","quaternary","main","handleMilestonePress","milestone","map","index","FontAwesome5","number","BOOKING_STATES","ALL_SERVICES","SERVICE_TYPES","TIME_OPTIONS","TIME_UNIT_MAPPING","BACKEND_TO_FRONTEND_TIME_UNIT","entries","reduce","acc","key","mockAdditionalRates","amount","mockServicesForCards","startingPrice","animalTypes","additionalRates","mockPets","animal_type","breed","age","months","years","weight","sex","friendlyWithChildren","friendlyWithCats","friendlyWithDogs","spayedNeutered","houseTrained","microchipped","adoptionDate","energyLevel","feedingSchedule","leftAlone","medication","additionalInstructions","vetName","vetAddress","vetPhone","insuranceProvider","vetDocuments","galleryImages","mockOwners","require","pet_types","last_booking","pets","email","phone","address","sharedBookingDetails","booking_id","status","owner_name","professional_name","service_details","service_type","pet_id","species","occurrences","occurrence_id","start_date","end_date","start_time","end_time","calculated_cost","base_total","rates","base_rate","additional_animal_rate","additional_animal_rate_applies","applies_after","unit_of_time","holiday_rate","holiday_days","additional_rates","cost_summary","subtotal","platform_fee","taxes","total_owner_cost","total_sitter_payout","is_prorated","mockBookingDetails","ownerName","startDate","startTime","CURRENT_USER_ID","values","booking","date","time","serviceType","numberOfPets","totalCost","costs","totalOwnerCost","professionalPayout","mockConversations","participant1_id","participant2_id","role_map","participant1_role","participant2_role","lastMessage","timestamp","unread","mockMessages","message_id","sender","is_booking_request","metadata","endDate","endTime","BLOG_POSTS","author","profilePicture","bio","publishDate","readTime","tags","references","authors","publication","url","year","doi","likes","comments","shares","windowWidth","windowHeight","reviews","image","ReviewImage","source","src","alt","Image","contentContainer","flexGrow","heroSection","overflow","heroImage","heroContent","heroText","textShadowColor","textShadowOffset","textShadowRadius","heroSignupButton","heroSignupButtonText","section","sectionTitle","largeLarge","card","appButtons","appButton","reviewsSection","reviewsBackground","reviewsOverlay","reviewsSubtitle","mediumLarge","reviewsTitle","reviewsContainer","overflowX","WebkitOverflowScrolling","msOverflowStyle","scrollbarWidth","scrollbarColor","reviewsContent","paddingBottom","reviewCard","reviewCardMobile","reviewQuote","reviewText","reviewAuthorContainer","reviewerImage","objectFit","reviewAuthorName","reviewAuthorTitle","paginationDots","paginationDot","margin","paginationDotActive","featuresSection","toggleContainer","toggleButton","toggleButtonActive","toggleButtonText","toggleButtonTextActive","whiteText","featuresContainer","featureColumn","SCREEN_WIDTH","columnTitle","featuresList","featureItem","featureIconCircle","featureIcon","featureTitle","featureText","actionButton","display","buttonText","blogSection","blogCard","authorContainer","authorImage","blogContent","authorInfo","authorName","dot","marginHorizontal","preview","flexWrap","tag","tagText","stats","stat","statText","roadmapSection","roadmapImage","roadmapOverlayText","faqSection","faqItem","faqButton","faqQuestion","faqToggle","faqAnswer","contactSection","contactContainer","input","socialIconsRow","socialIcon","footerLinksRow","footerLink","textDecorationLine","successMessage","messageInput","textAlignVertical","paddingTop","validationError","starsContainer","starIcon","waitlistSection","marginVertical","waitlistDescription","waitlistButton","scrollIndicators","scrollIndicatorButton","scrollIndicator","scrollIndicatorActive","scrollHint","scrollHintText","scrollContainer","scrollContent","serviceHighlightsSection","mainServiceTitle","servicesGrid","floatingButtonContainer","webButton","mobileButton","floatingButton","buttonLabel","wrapper","background","stepCircle","modernBorder","activeStepCircle","completedStepCircle","stepNumber","activeStepNumber","completedStepNumber","stepName","whiteSpace","activeStepName","line","completedLine","progressLine","progressFilled","progressEmpty","props","onStepPress","isDesktop","log","renderStep","isActive","isCompleted","React","stepIndex","GENERAL_CATEGORIES","ANIMAL_ICONS","ANIMAL_CATEGORIES","getAllAnimalTypes","allTypes","forEach","category","includes","push","COMMON_PETS","getAnimalIcon","animalName","categoryId","find","cat","CategorySelectionStep","serviceData","setServiceData","customAnimalInput","setCustomAnimalInput","customAnimalCategory","setCustomAnimalCategory","showCustomAnimalInput","setShowCustomAnimalInput","selectedCategoryFilter","setSelectedCategoryFilter","setScreenWidth","updateLayout","addEventListener","removeEventListener","isAnimalTypeSelected","some","animal","handleAnimalTypeSelect","prevAnimalTypes","existingAnimalIndex","findIndex","updatedTypes","splice","hardcodedCategory","categoryToUse","foundCategory","newAnimal","categoryName","isCustom","filteredAnimalTypes","getFilteredAnimalTypes","animalTypesToShow","categoriesUsed","Set","categoryData","filter","add","a","sort","b","aCommonIndex","indexOf","bCommonIndex","localeCompare","categories","Array","subtitle","instructions","textSecondary","categoryFiltersContainer","paddingLeft","paddingRight","categoryFiltersScrollView","maxHeight","categoryFilterButton","minHeight","mainLight","categoryFilterText","selectedCategoryFilterText","actionsContainer","actionButtonText","animalTypesGrid","animalTypeItem","animalTypeCard","selectedAnimalCard","animalTypeRow","animalIconAndName","animalTypeName","customInputContainer","backgroundContrast","customInputTitle","inputRow","textInput","pickerContainer","picker","addButton","addButtonText","selectedAnimalsSection","selectedAnimalsTitle","selectedAnimalsList","animalBubble","animalBubbleText","removeAnimalButton","ScrollView","horizontal","showsHorizontalScrollIndicator","contentContainerStyle","handleCategoryFilterSelect","handleSelectAll","allAnimalTypes","handleClearAll","TextInput","placeholder","onChangeText","placeholderTextColor","placeHolderText","Picker","selectedValue","onValueChange","itemValue","Item","label","onChange","e","target","handleAddCustomAnimal","trim","categoryInfo","generalCategories","categoryToAdd","animalType","inputGroup","textArea","switchContainer","switchGroup","switchLabel","switchSubLabel","errorText","characterCount","ServiceDetailsStep","nameError","setNameError","descriptionError","setDescriptionError","validateInput","isName","test","serviceName","truncatedText","slice","maxLength","serviceDescription","multiline","Switch","isOvernight","trackColor","false","true","thumbColor","ios_backgroundColor","TIME_UNITS","keys","ANIMAL_THRESHOLDS","rateContainer","rateInputGroup","currencyInputContainer","currencySymbol","currencyInput","outlineStyle","unitSelector","unitText","dropdownContainer","dropdownScroll","dropdownScrollContent","dropdownItem","borderBottomWidth","borderBottomColor","selectedDropdownItem","dropdownText","selectedDropdownText","holidayRateContainer","holidayRateHeader","rateTypeToggleContainer","activeToggleButton","inactiveToggleButton","activeToggleText","inactiveToggleText","holidayRateInputWrapper","percentageInputContainer","percentageInput","percentageSymbol","calculatedHolidayRate","customRatesContainer","customRateItem","customRateContent","customRateActions","customRateTitleContainer","customRateTitle","customRateDescription","customRateAmount","newCustomRateContainer","customRateInput","addRateButton","addRateText","customRateButtonContainer","cancelRateButton","cancelRateText","saveRateButton","disabledSaveButton","saveRateText","customRateFormHeading","noCustomRatesText","fontStyle","customRateAction","modalIcon","modalButton","modalButtonText","disabledUnitSelector","RatesAndReviewStep","isUpdatingService","setIsUpdatingService","onProceedWithUpdate","showTimeUnitDropdown","setShowTimeUnitDropdown","showThresholdDropdown","setShowThresholdDropdown","customChargeVisible","setCustomChargeVisible","isHolidayRatePercent","setIsHolidayRatePercent","isEditingExistingRate","setIsEditingExistingRate","showUnsavedRateWarning","setShowUnsavedRateWarning","newCustomRate","setNewCustomRate","rate","availableTimeUnits","isPercent","base_rate_unit","holidayRate","holidayRateString","toString","replace","hasUnsavedCustomRate","result","hasUnsaved","formatNumericInput","numericValue","parts","split","join","toggleHolidayRateType","prevData","handleCustomRateChange","field","handleAddCustomRate","rateValue","parseFloat","isNaN","renderDropdown","options","onSelect","containerStyle","option","TouchableWithoutFeedback","handlePressOutside","keyboardType","unit","selectedUnit","additionalAnimalRate","additionalAnimalThreshold","threshold","borderTopLeftRadius","borderBottomLeftRadius","borderTopRightRadius","borderBottomRightRadius","calculateHolidayRateDollarValue","baseRate","holidayRatePercent","dollarValue","toFixed","rateToEdit","_","i","handleEditCustomRate","activeOpacity","handleDeleteCustomRate","STEPS","CATEGORY_SELECTION","SERVICE_DETAILS","RATES_AND_REVIEW","stepIndicatorContainer","scrollContentContainer","borderTopWidth","borderTopColor","nextButton","nextButtonText","disabledButtonText","ServiceCreationModal","onSave","initialService","setHasUnsavedChanges","hasHolidayRate","setError","isSubmitting","setIsSubmitting","isEditMode","setIsEditMode","isAddingCustomRate","setIsAddingCustomRate","animalTypesArray","animal_types","isArray","holiday_rate_is_percent","service_id","service_name","is_overnight","canProceedToNextStep","hasValidBaseRate","hasValidAdditionalRate","hasValidHolidayRate","callServiceApi","animalTypesDict","holidayRateValue","formattedData","parseInt","updateService","createService","serviceManagerData","lengthOfService","is_active","toLowerCase","handleBack","SafeAreaView","StepProgressIndicator","renderCurrentStep","serviceCard","surfaceContrast","cardHeader","large","activeToggleContainer","activeText","smallMedium","inactiveText","switch","scaleX","scaleY","ratesContainer","rateRow","rateLabel","editButton","deleteButton","deleteButtonText","ProfessionalServiceCard","item","onEdit","onDelete","setIsActive","handleToggleActive","getPricingBackgroundColor","unitOfTime","idx","supportsHover","hasTouchScreen","window","navigator","maxTouchPoints","msMaxTouchPoints","matchMedia","matches","serviceListContainer","serviceCardWrapper","headerContainer","headerActions","collapseButton","addServiceButton","addServiceText","emptyContainer","emptyText","portalTooltip","tooltipText","small","ServiceManager","services","setServices","isProfessionalTab","showModal","setShowModal","editingService","setEditingService","collapsedServices","setCollapsedServices","allCollapsed","setAllCollapsed","showDeleteModal","setShowDeleteModal","serviceToDelete","setServiceToDelete","hoveredButton","setHoveredButton","tooltipPosition","setTooltipPosition","collapseTooltipPosition","setCollapseTooltipPosition","buttonRef","deviceSupportsHover","handleEditService","serviceToEdit","formattedAnimalTypes","formattedService","handleDeleteService","toggleCollapse","renderService","warn","isCollapsed","onToggleCollapse","is_custom","ref","onMouseEnter","showTooltip","setPosition","element","getBoundingOwnerRect","rect","x","y","onMouseLeave","updatedService","serviceIndex","s","newServices","transformedService","existingIndex","serviceToRemove","deleteService","prevServices","Portal","petItem","petItemContent","petPhoto","petName","petInfo","petDetails","sectionHeader","fieldText","centeredContent","alignSelf","profileHeader","profilePhoto","profilePhotoPlaceholder","portfolioGrid","portfolioCard","portfolioImageContainer","aspectRatio","portfolioPhoto","portfolioCaption","facilitiesContainer","facilityTag","facilityTagSelected","facilityTagText","facilityTagTextSelected","modalHeader","modalScroll","modalFacilityTag","modalFacilityText","modalFooter","saveButton","modalButtonText2","webDatePicker","androidButton","dateText","disabledInput","backButton","headerText","rightButton","BackHeader","onBackPress","rightIcon","onRightPress","rightComponent","customStyles","StatusBar","currentHeight","CrossPlatformView","useSafeArea","fullWidthHeader","contentWidth","setWindowWidth","updateDimensions","headerContent","mainContent","COLORADO_BOUNDS","geocodingQueue","constructor","this","queue","processing","lastRequest","minInterval","geocode","Promise","resolve","reject","processQueue","shift","timeSinceLastRequest","Date","now","waitTime","performGeocode","street","apartment","city","state","zip","addressString","params","URLSearchParams","q","format","limit","countrycodes","addressdetails","fetch","headers","ok","json","lat","lng","lon","isInColorado","latitude","longitude","formatted_address","display_name","geocodeAddressGraceful","maxRetries","attempt","pow","geocodeAddress","searchQueue","search","query","performSearch","bounded","viewbox","place_id","components","house_number","road","town","village","postcode","coordinates","inputContainer","inputValid","success","inputDisabled","loadingIndicator","validIcon","suggestionsContainer","suggestionsList","suggestionItem","lastSuggestionItem","suggestionIcon","suggestionContent","suggestionText","noResultsContainer","noResultsText","AddressAutocomplete","onAddressSelect","inputValue","setInputValue","suggestions","setSuggestions","showSuggestions","setShowSuggestions","selectedAddress","setSelectedAddress","searchTimeoutRef","results","searchAddresses","onBlur","handleBlur","editable","FlatList","renderItem","renderSuggestion","handleAddressSelect","keyExtractor","keyboardShouldPersistTaps","showsVerticalScrollIndicator","INSURANCE_OPTIONS","EditOverlay","isLocation","isMultiline","isProfessional","isInsurance","selectedInsurance","onInsuranceChange","localValue","setLocalValue","localInsurance","setLocalInsurance","isLoadingLocation","setIsLoadingLocation","currentAddressValue","setCurrentAddressValue","insuranceStep","setInsuranceStep","insuranceType","setInsuranceType","insuranceModalContent","backButtonText","modalTitleCentered","insuranceStepContent","insuranceStepTitle","insuranceTypeButton","insuranceTypeContent","insuranceTypeTitle","insuranceTypeDescription","uploadButton","ImagePicker","launchImageLibraryAsync","mediaTypes","Images","allowsEditing","aspect","quality","canceled","newInsurance","assets","uri","handleInsuranceChange","uploadText","customInsuranceCard","insuranceCardImage","insuranceCardText","opt","insuranceOption","selectedInsuranceOption","insuranceOptionContent","insuranceOptionTitle","insuranceOptionDescription","locationContent","addressInstructions","addressAutocomplete","selectedAddressInfo","selectedAddressText","modalInput","multilineInput","autoFocus","modalButtons","modalCancelButton","modalCancelText","modalSaveButton","modalSaveButtonDisabled","handleSave","Alert","alert","modalSaveText","contentWrapper","desktopLayout","profileSection","profileSectionDesktop","profileCard","profilePhotoContainer","cameraButton","profileInfo","nameContainer","emailContainer","locationContainer","locationIconWrapper","location","locationEditIcon","roleContainer","role","editIcon","ratingContainer","rating","sectionsContainer","sectionsContainerDesktop","editButtonText","bioInput","facilitiesGrid","facilityItem","facilityContent","facilityTitle","facilityValue","addPhotoButton","addPhotoText","photoGrid","noReviews","bioText","locationButtons","locationButton","locationButtonText","orText","noPhotosText","facilitiesModalContent","facilitiesScrollView","facilityPresetItem","selectedFacilityPreset","facilityPresetContent","facilityPresetTitle","facilityPresetDescription","selectedFacilityText","checkIcon","locationModalContent","addressForm","addressInput","addressRow","maxFacilitiesText","insuranceContent","editButtonContent","modalCloseButton","modalCloseText","ProfileInfoTab","country","about_me","emergencyContact","authorizedHouseholdMembers","editMode","toggleEditMode","pickImage","onSaveComplete","insurance","onNavigateToTab","authName","hasEdits","setHasEdits","editingField","setEditingField","editValue","setEditValue","portfolioPhotos","setPortfolioPhotos","setSelectedInsurance","isSaving","setIsSaving","displayValues","setDisplayValues","originalValues","setOriginalValues","propName","locationDisplay","handleEdit","currentValue","handleSaveField","hasFieldChanged","JSON","stringify","newAddress","newApartment","newCity","newState","newZip","originalAddress","originalApartment","originalCity","originalState","originalZip","hasChanges","profileData","locationComponents","addressComponents","locationData","part","extractAddressComponents","updatedProfile","updateProfileInfo","prevValues","newLocation","charAt","toUpperCase","newPhotoUri","formData","FormData","photoFile","append","newDisplayValues","DAYS_OF_WEEK","ServiceIcon","service","sectionBox","servicesSection","servicesList","serviceWrapper","serviceItem","selectedServiceItem","serviceItemContent","serviceInfo","servicePrice","availabilityContainer","controlsScrollContainer","availabilityControls","controlsDivider","daysScrollContainer","daysContainer","availabilityDivider","availabilitySection","availabilityHeader","availabilityTitle","editHoursButton","editHoursText","dayItem","petsittingDayItem","warningLight","dayText","availabilityTime","serviceDivider","availabilityList","controlButton","blockButtonContent","blockButtonText","partialBlockButtonContent","partialBlockText","dateRangeButtonContent","dateRangeText","unavailableDayItem","unavailableSlash","rotate","unavailableDayText","nextUnavailableContainer","nextUnavailableText","ServicesAvailabilityTab","price","unavailableDays","onToggleService","onEditHours","onBlockService","onPartialDayBlock","selectedService","setSelectedService","isStacked","renderServiceItem","proDashboard","tertiary","renderDayAvailability","day","isUnavailable","renderAvailabilitySection","calculateOccurrenceCost","occurrenceData","numPets","numberOfUnits","calculateProratedMultiplier","timeUnit","startYear","startMonth","startDay","Number","startHour","startMinute","endYear","endMonth","endDay","endHour","endMinute","month","hour","minute","end","startDateOnly","UTC","endDateOnly","daysDiff","floor","daysDiffHours","toISOString","startTimeMinutes","endTimeMinutes","timeDiffHours","totalHours","divisor","baseTotal","additionalAnimalRateTotal","additionalPets","additionalRatesTotal","sum","holidayRateTotal","multiplier","additional_animal_rate_total","holiday_rate_total","additional_rates_total","total_cost","sectionDescription","petsList","petCard","petHeader","petBasicInfo","petDetailsContainer","expandedDetails","detailRow","detailColumn","detailTitle","detailText","preferencesGrid","preferenceButton","selectedPreference","preferenceText","selectedPreferenceText","checkmark","petActions","fixButton","addContactForm","submitButton","submitButtonText","contactsList","contactCard","contactInfo","contactName","contactPhone","contactActions","emptyListText","compatibilityContainer","compatibilityItem","compatibilityLabel","careInfoContainer","medicationsContainer","medicationsText","vetInfoContainer","vetInfoItem","vetInfoLabel","vetInfoText","documentButton","documentButtonText","dropdownContainerEdit","optionButton","selectedOption","optionText","selectedOptionText","editInput","editInputMedications","editInputShort","editInputWeight","uploadButtonText","documentActionContainer","documentsList","documentItem","documentName","viewDocButton","viewDocText","noDocumentsText","detailSection","editContainer","inputsWrapper","inputWrapper","flexBasis","inputLabel","profilePhotoButton","plusIconContainer","sectionRow","editMainContainer","editHeaderRow","editProfileContainer","editDetailsContainer","editActions","editActionsSmallScreen","buttonRowTop","buttonRowBottom","dateInfoContainer","dateInfoItem","dateInfoLabel","dateInfoText","customDatePickerContainer","dateInputBox","dateInputText","placeholderText","calendarButton","borderLeftWidth","borderLeftColor","datePickerContainer","calendarModalContent","calendarModalHeader","calendarModalTitle","calendarHeader","calendarNavButton","calendarMonthYear","weekdayLabels","weekdayLabel","calendarGrid","calendarRow","calendarDay","calendarDayText","calendarDayOtherMonth","calendarDayTextOtherMonth","calendarDaySelected","calendarDayTextSelected","stackedFields","fullWidth","saveButtonText","errorModalContent","successModalContent","errorModalHeader","successModalHeader","errorModalTitle","successModalTitle","errorModalMessage","successModalMessage","errorModalButton","successModalButton","errorModalButtonText","successModalButtonText","editButtonTopRight","chevronButtonBottomRight","petInfoWithButtonPadding","dropdownButton","dropdownButtonText","dropdownList","dropdownScrollView","dropdownItemSelected","dropdownItemText","dropdownItemTextSelected","PetsPreferencesTab","preferences","homeEnvironment","emergencyContacts","onAddPet","onEditPet","onDeletePet","onReplacePet","onUpdatePreferences","expandedPetIds","setExpandedPetIds","newEmergencyContact","setNewEmergencyContact","newHouseholdMember","setNewHouseholdMember","isAddingEmergencyContact","setIsAddingEmergencyContact","isAddingHouseholdMember","setIsAddingHouseholdMember","editingPetIds","setEditingPetIds","editedPetsData","setEditedPetsData","expandedSections","setExpandedSections","datePickerConfig","setDatePickerConfig","currentField","currentPetId","selectedDate","displayMonth","setDisplayMonth","getMonth","displayYear","setDisplayYear","getFullYear","savingPet","setSavingPet","showSuccessModals","setShowSuccessModals","deleteConfirmation","setDeleteConfirmation","petId","isDeleting","showMonthPicker","setShowMonthPicker","showYearPicker","setShowYearPicker","updateWidth","yesNoOptions","energyLevelOptions","sexOptions","returnYesNoContainer","pet","attributeName","displayValue","returnEnergyLevelContainer","togglePetDetails","newSet","has","delete","handleEditPet","petToEdit","handleDeletePet","petToDelete","formatDateForBackend","dateString","formatDateFromBackend","handleSavePetEdit","p","editedData","petData","age_years","ageYears","age_months","ageMonths","birthday","adoption_date","pet_description","friendly_with_children","childrenFriendly","friendly_with_cats","catFriendly","friendly_with_dogs","dogFriendly","spayed_neutered","house_trained","feeding_schedule","feedingInstructions","potty_break_schedule","pottyBreakSchedule","energy_level","can_be_left_alone","canBeLeftAlone","medication_notes","medicalNotes","special_care_instructions","specialCareInstructions","vet_name","vet_address","vet_phone","insurance_provider","vet_documents","isNewPet","String","startsWith","addPet","newPetId","updatedPetData","replaceTempPetWithReal","newData","apiError","showErrorMessage","updatePet","handleCancelPetEdit","handleEditChange","isSectionExpanded","sectionName","petIdStr","err","renderSectionHeader","safeTitle","isExpanded","event","toggleSection","stopPropagation","sectionNameStr","formatDateString","padStart","getDate","showDatePicker","currentDate","parseDate","handleDatePickerSelect","formattedDate","calendarData","useMemo","firstDayOfMonth","daysInMonth","startingDayOfWeek","getDay","totalDays","ceil","calendarDays","dayCounter","dayDate","isCurrentMonth","isSelectedDate","weeks","details","tempPetId","realPetData","currentPetsArray","tempPetIndex","updatedPets","callbackError","fallbackError","addError","renderDatePickerModal","DateTimePicker","mode","monthNames","currentYear","handleOutsideClick","week","weekIndex","dayObj","dayIndex","cancelDeletePet","deletePet","handleAddNewPet","existingTempPets","tempPet","tempId","newPet","medications","_addToTop","isEditing","editedPetData","isSmallScreen","petBreed","petType","petAgeString","today","birthDate","calculateAge","mockDocument","getTime","handleUploadDocument","desktopContainer","leftColumn","rightColumn","plansScroll","plansScrollContent","planCardContainer","planCard","currentPlanBorder","popularPlan","popularTag","popularTagText","planTitle","planPrice","planDescription","planButton","currentPlanButton","planButtonText","currentPlanButtonText","settingItem","settingContent","settingTextContainer","settingTitle","settingDescription","currentPlanInfo","currentPlanTitle","currentPlanBilling","usageStats","usageText","usageBar","usageProgress","paymentItem","paymentContent","paymentTextContainer","paymentTitleRow","paymentTitle","paymentDescription","setDefaultButton","setDefaultText","viewAllButton","viewAllText","timezoneItem","selectedTimezoneItem","primaryLight","timezoneText","selectedTimezoneText","timezoneButton","timezoneButtonText","noPaymentMethodsContainer","noPaymentMethodsText","SettingsPaymentsTab","push_notifications","email_updates","marketing_communications","profile_visibility","timezone","propTimezone","use_military_time","onUpdateSetting","paymentMethods","onAddPaymentMethod","onRemovePaymentMethod","onSetDefaultPayment","currentPlan","nextBilling","connections","used","total","onSwitchPlan","isApprovedProfessional","setTimezone","timezoneModalVisible","setTimezoneModalVisible","timezones","setTimezones","loading","setLoading","timeSettings","getTimeSettings","fetchTimeSettings","openTimezoneModal","renderNotificationSettings","handleUpdateSetting","renderPrivacySettings","settingName","then","catch","updateTimeSettings","newTimezone","handleTimezoneChange","initialNumToRender","maxToRenderPerBatch","windowSize","mobileTab","activeTab","tabText","mobileTabText","activeTabText","createStyles","mainContainer","transition","headerSection","tabScrollContainer","tabContainer","tabContent","MyProfile","useWindowDimensions","user","logout","setIsMobile","isWideScreen","setIsWideScreen","setActiveTab","hasUnsavedChanges","setProfileData","setEditMode","setCurrentPlan","isTutorialVisible","loadActiveTab","urlParams","tabFromUrl","setStorage","getState","routes","route","initialTab","storedTab","getStorage","URL","href","searchParams","set","history","replaceState","storeActiveTab","loadProfileData","token","userProfile","checkAndFixPetOwners","petsWithMissingOwners","lastUpdateFailed","ownerMissing","fixPetOwner","tabs","handlePickImage","handleSaveComplete","newProfileData","handleUpdateField","handleSwitchPlan","planId","goBack","tabId","renderActiveTab","profileName","payment_methods","emergency_contact","authorized_household_members","updatedServices","shouldAddToTop","petToAdd","_objectWithoutPropertiesLoose","_excluded","newPetsArray","updatedPreferences","selected","updateData","CustomButton","spacing","validateEmail","isValid","validateName","validatePassword","password","hasUpperCase","hasLowerCase","hasNumbers","hasSpecialChar","IsProduction","extraLarge","createAccountContainer","createAccountText","createAccountLink","inputLabelContainer","passwordLabelContainer","showHideText","errorInput","rememberMeContainer","checkbox","checkboxInner","rememberMeText","loginButton","loginButtonText","forgotPasswordContainer","link","prototypeWarning","SignUp","useRoute","signIn","firstName","setFirstName","lastName","setLastName","setEmail","setPassword","confirmPassword","setConfirmPassword","setSuccessMessage","inviterName","setInviterName","inviteToken","setInviteToken","inviteVerified","setInviteVerified","verifyingInvite","setVerifyingInvite","setLocation","showLocationDropdown","setShowLocationDropdown","locationError","setLocationError","locations","setLocations","loadingLocations","setLoadingLocations","fallbackLocations","supported","firstNameError","setFirstNameError","lastNameError","setLastNameError","emailError","setEmailError","passwordError","setPasswordError","confirmPasswordError","setConfirmPasswordError","pathname","hash","pathParts","inviteIndex","signupIndex","searchToken","inviteInfo","verifyInvitation","valid","inviter_name","checkInvitation","fetchLocations","userData","password2","phone_number","invitation_token","KeyboardAvoidingView","behavior","keyboardVerticalOffset","formContainer","inviteContainer","inviteText","dropdown","loadingContainer","dropdownWrapper","inputText","dropdownMenu","loc","selectLocation","selectedLocation","autoCapitalize","secureTextEntry","validateForm","firstNameValidation","lastNameValidation","emailValidation","passwordValidation","passwordMatchValidation","validatePasswordMatch","userTimezone","Intl","DateTimeFormat","resolvedOptions","timeZone","useMilitaryTime","registrationData","registerResponse","post","loginResponse","access","refresh","Authorization","errorData","firstError","messages","signupButton","waitlistContainer","waitlistMessage","waitlistSubMessage","navigateToWaitlist","loader","signInContainer","signInText","navigateToSignIn","signInLink","safeArea","backText","inputError","cursor","cardHovered","scale","cardContent","mobileCardContent","topContent","mobileTopContent","profileImage","mobileProfileImage","mobileContentContainer","mobileHeaderContainer","nameAndPets","statusBadge","statusContent","statusText","clientContainer","mybookings","petContainer","mobileDivider","metaInfo","mobileMetaInfo","mobileMetaRow","metaItemContainer","metaText","viewDetailsButton","viewDetailsText","mobileClientContainer","mobileName","mobilePetContainer","mobilePetInfo","mobileStatusBadge","mobileStatusText","BookingCard","onViewDetails","client_name","professionalName","statusInfo","bgColor","textColor","confirmedBg","confirmedText","completedBg","completedText","getStatusInfo","isHovered","setIsHovered","convertedDateTime","convertDateTimeFromUTC","dateObj","monthName","toLocaleString","convertedTime","originalDate","originalTime","getMetaText","timeText","serviceText","ownername","badge","sectionHeaderContainer","breakdownSection","dateHeader","dateTextContainer","breakdownItem","breakdownLabelContainer","breakdownLabel","breakdownCalculation","breakdownAmount","totalItem","subtotalRow","subtotalLabel","subtotalAmount","feeRow","feeLabel","feeAmount","totalAmountContainer","totalLabel","totalAmount","divider","payoutContainer","payoutLabel","payoutAmount","payoutBreakdown","addRateContainer","rateNameAmountRow","rateEditContainer","amountInputContainer","rateInput","nameInput","descriptionInput","formDivider","editableAdditionalRateRow","rateNameAmountRowWithDelete","buttonsContainer","multipleDatesContainer","occurrenceCost","ratesToggleButton","ratesToggleText","ratesBreakdown","rateItem","rateAmount","rateDescription","occurrenceDivider","ReviewAndRatesCard","bookingData","onRatesUpdate","bookingId","showEditControls","isAddingRate","setIsAddingRate","editedRates","setEditedRates","newRate","setNewRate","expandedRates","setExpandedRates","editingOccurrenceId","setEditingOccurrenceId","occurrenceEdits","setOccurrenceEdits","isAddingRateForOccurrence","setIsAddingRateForOccurrence","newOccurrenceRate","setNewOccurrenceRate","defaultRates","safeRates","occurrencesCount","formatCurrency","toggleAddRate","sanitizeAmountInput","sanitized","substring","handleNewRateAmountChange","handleNewOccurrenceRateAmountChange","saveRateChanges","cleanEditedRates","occurrencesForApi","occ","updateBookingDraftRates","draft_data","saveNewRate","updatedRates","updateBaseRate","sanitizedValue","updateAdditionalAnimalRate","updateHolidayRate","updateAdditionalRate","updatedAdditionalRates","deleteAdditionalRate","occIndex","handleEditOccurrence","occurrence","r","handleCancelEdit","handleOccurrenceInputChange","handleAdditionalRateChange","currentOccurrenceEdits","currentAdditionalRates","updated","updatedRate","allRates","deleteRateForOccurrence","rateIndex","updatedOccurrenceEdits","getAdditionalRateValue","renderBookingBreakdown","isMultipleDates","count","firstOccurrence","multiple","formatDateTimeRangeFromUTC","includeTimes","includeTimezone","newExpandedRates","v","occurrenceId","rateName","occurrenceEditsRate","valueToShow","saveNewRateForOccurrence","toggleAddRateForOccurrence","cleanOccurrenceEdits","handleSaveOccurrenceRates","formattedDateRange","renderTotalAmount","costSummary","client_platform_fee","pro_platform_fee","tax_state","total_client_cost","pro_subscription_plan","footerContainer","approveButton","approveText","loadingText","errorContainer","retryButton","retryButtonText","serviceContainer","serviceLabel","serviceValue","petsContainer","petsLabel","noPets","changeRequestContainer","changeRequestInput","buttonWrapper","changeRequestButtons","cancelRequestButton","cancelRequestButtonText","submitRequestButton","olive","submitRequestButtonText","changeButton","shortenedContainer","BookingApprovalModal","onApproveSuccess","onApproveError","onRequestChangesSuccess","onRequestChangesError","initialData","hideButtons","isReadOnly","defaultInitialData","setBookingData","setLoadingText","changeRequestMessage","setChangeRequestMessage","showChangeRequestInput","setShowChangeRequestInput","bookingDataRef","dataLoadedRef","fetchBookingDetails","dataProtectionInterval","setInterval","hasNoData","hasRefData","clearInterval","getBookingDetails","safeResponse","handleApprove","approveBooking","handleShowChangeRequest","handleCancelChangeRequest","handleSubmitChangeRequest","requestBookingChanges","str","word","updatedData","renderFooter","isBookingUpdate","screenHeight","scrollView","scrollViewContent","headerRight","notificationButton","notificationBadge","notificationCount","profileButton","welcomeSection","welcomeContent","welcomeCard","backgroundImage","welcomeHeader","welcomeTextContainer","statsContainer","statsGrid","gridTemplateColumns","statCard","select","ios","android","android_ripple","statHeader","statIconContainer","bookingsContainer","bookingItem","bookingContent","bookingInfo","bookingDetails","bookingTitle","bookingTime","bookingStatus","progressBar","progress","timeLeft","emptyStateContainer","emptyStateTitle","emptyStateText","createServiceButton","createServiceButtonText","filterContainer","filterButtons","filterButton","activeFilterButton","filterText","activeFilterText","servicesContainer","serviceContent","serviceHeader","serviceTitle","serviceCategory","serviceFooter","bookingsCount","bookingsText","serviceRate","viewButton","viewButtonText","Dashboard","useTheme","signOut","is_prototype","bookings","setBookings","activeFilter","setActiveFilter","onboardingProgress","setOnboardingProgress","profile_complete","has_bank_account","has_services","subscription_plan","bookingModalVisible","setBookingModalVisible","selectedBookingId","setSelectedBookingId","isLargeScreen","filteredBookings","bookingDate","parsedDate","completed","dynamicStyles","welcomeTitle","bookingCount","statValue","statLabel","statChange","prototypeBookings","owner","prototypeServices","fetchDashboardData","sessionStorage","getItem","AsyncStorage","endpoint","upcoming_bookings","firstBooking","client_name_exists","processedBookings","normalizedDate","onboarding_progress","servicesData","getProfessionalServices","newToken","refreshToken","setItem","retryError","hasActiveBookings","currentActiveFilter","List","Avatar","round","has_pets","handleViewBookingDetails","serviceId","renderServiceCard","handleCloseBookingModal","BecomeProfessional","selectedPets","setSelectedPets","dog","exotics","about","setAbout","certifications","setCertifications","insuranceProof","setInsuranceProof","currentRoute","initializeNavigation","checkboxContainer","petButton","selectedPetButton","petButtonText","selectedPetButtonText","inputBackground","uploadedFileContainer","surfaceVariant","uploadedFilePreview","certificationText","removeFileButton","submitButtonDisabled","handleBackPress","togglePetSelection","base64","newCertification","pop","cert","removeCertification","newProof","proof","removeInsuranceProof","confirm","webContent","listSection","webListItem","listItemTitle","switchRoleButton","logoutButton","MoreScreen","switchRole","initialRoute","initializeRoutes","handleNavigation","menuItems","renderMenuItems","items","titleStyle","Divider","Button","removeItem","multiRemove","labelStyle","lightGrey","removeButton","reason","seeMoreButton","seeMoreText","modalTime","UnavailableTimeSlot","onRemove","showAllServices","setShowAllServices","isAllDay","formatTime","parse","formatServicesDisplay","timeContainer","AvailabilityBookingCard","handlePress","timeButton","compactTimeButton","webInputContainer","webInput","outline","webIcon","errorBorder","TimePicker","showPicker","setShowPicker","showClockIcon","isChrome","userAgent","vendor","toTimeString","document","querySelector","showTimepicker","toLocaleTimeString","is24Hour","handleChange","SCREEN_HEIGHT","modalContainer","availabilityButton","availableButton","unavailableButton","danger","availabilityButtonText","timePickerContainer","webTimePicker","unavailableTimesContainer","customDropdown","dropdownItemContent","activeToggle","toggleText","bookingsList","emptyState","contentScrollView","unavailableTimesWrapper","bookingsWrapper","selectedDatesText","AddAvailabilityModal","propIsVisible","selectedDates","currentAvailability","onRemoveTimeSlot","setIsAllDay","setStartTime","setEndTime","showStartTimePicker","setShowStartTimePicker","showEndTimePicker","setShowEndTimePicker","selectedServices","setSelectedServices","showServiceDropdown","setShowServiceDropdown","modalWidth","setModalWidth","getModalWidth","activeView","setActiveView","editingBooking","setEditingBooking","dimensionsHandler","remove","isTimeSlotUnavailable","unavailableTimes","existingStartHour","existingStartMin","existingEndHour","existingEndMin","newStartStr","newEndStr","newStartHour","newStartMin","newEndHour","newEndMin","formatSelectedDates","nestedScrollEnabled","renderUnavailableTimes","handleRemoveTimeSlot","timeSlot","updatedAvailability","filteredTimes","renderBookings","dateBookings","handleBookingPress","withoutAll","handleMarkAvailable","handleMarkUnavailable","dates","serviceTypes","DatetimePicker","isInModal","selectedValues","setSelectedValues","days","hours","minutes","ampm","convertToDate","renderSelect","selectStyle","errorSelect","monthSelect","yearSelect","daySelect","handleSelectChange","newValues","row","rowIndex","selectContainer","appearance","WebkitAppearance","MozAppearance","ALL_DAYS","settingContainer","dayContainer","selectedTab","selectedTabText","daySettingsContainer","settingRow","enabledText","datePickerWrapper","validationErrorText","DefaultSettingsModal","defaultSettings","selectedDays","setSelectedDays","settings","setSettings","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday","showTimePicker","setShowTimePicker","setShowDatePicker","isCurrentlyUnavailable","setIsCurrentlyUnavailable","showDayDropdown","setShowDayDropdown","setValidationError","spring","tension","friction","handleClickOutside","getElementById","contains","handleAvailabilityChange","makeAvailable","daysToUpdate","newSettings","renderTimePicker","selectedTime","timeString","renderEndDatePicker","onClick","onMouseDown","daySettings","updateDaySettings","prevSettings","checkCurrentAvailability","d","handleDaySelection","renderDaySettings","newTime","handleContainer","handle","headerMinimized","headerCenter","timeToggleContainer","customToggle","toggleButtonInactive","timeSection","serviceSection","serviceSelector","serviceSelectorText","serviceSelectorError","AvailabilityBottomSheet","onViewUnavailableTimes","onMinimize","isMinimized","setIsMinimized","animatedHeight","animatedOpacity","slideAnimation","getAvailabilityStatus","dateAvailability","isAvailable","validateAndSave","toggleMinimized","newMinimizedState","containerHeight","getStatusColor","timesList","timeSlotContainer","timeSlotContent","timeAndReason","reasonText","bookingButton","UnavailableTimesModal","setHours","getUnavailableTimes","allTimes","processedTimes","timeKey","isBooking","ownerId","renderActionButton","renderTimeSlot","formattedStartTime","formattedEndTime","bottomSheetOverlay","centeredContainer","defaultSettingsButton","defaultSettingsText","colorKeyContainer","colorKeyTitle","colorKeyItem","colorBox","colorKeyText","bottomSheetContainer","calendar","AvailabilitySettings","markedDates","setMarkedDates","setSelectedDates","isAddModalVisible","setIsAddModalVisible","isSettingsModalVisible","setIsSettingsModalVisible","defaultAvailability","setDefaultAvailability","setCurrentAvailability","setDefaultSettings","showBottomSheet","setShowBottomSheet","showUnavailableTimesModal","setShowUnavailableTimesModal","isClosing","setIsClosing","isBottomSheetMinimized","setIsBottomSheetMinimized","availableDates","unavailableDates","updateMarkedDates","combinedAvailability","loadAvailabilityData","newMarkedDates","isFullDay","allServicesSelected","calendarColor","bookingList","marked","dotColor","calendarColorYellowBrown","toggleBottomSheet","show","handleAddAvailability","availabilityData","newCurrentAvailability","IconComponent","Icon","Calendar","onDayPress","setDate","firstDate","range","calendarBackground","textSectionTitleColor","selectedDayBackgroundColor","selectedDayTextColor","todayTextColor","dayTextColor","textDisabledColor","monthTextColor","arrowColor","indicatorColor","oneYearFromNow","daysMapping","targetDayNumber","currentDayNumber","getUTCDay","setUTCDate","getUTCDate","applyDefaultSettingsToCalendar","onViewBookings","handleViewBookings","minimized","currentDateAvailability","androidContainer","messageButtonContainer","messageButton","OwnerHistory","ownerData","contracts","invoices","upcomingBookings","Content","Card","Title","Paragraph","contract","Actions","invoice","dateTimeContainer","dateInputGroup","timeInputGroup","numberInput","yearInput","separator","periodButton","periodText","calendarHeaderText","calendarWeekDays","calendarWeekDay","calendarWeek","selectedDay","selectedDayText","timeSelector","timeSelectorColumn","timeSelectorLabel","timeSelectorScroll","timeSelectorItem","timeSelectorText","selectedTimeText","periodContainer","disabledDay","isMilitary","onPickerStateChange","inputs","setInputs","period","showCalendar","setShowCalendar","showTimeSelector","setShowTimeSelector","containerRef","hours24","getHours","hours12","getMinutes","isPickerActive","formatTwoDigitInput","numbers","firstDigit","secondDigit","handleInputChange","formattedValue","currentInputs","formatYearInput","newInputs","createNewDate","newDate","Pressable","__","dayNumber","isSelected","validateDateTimeRange","startDateTime","endDateTime","ANIMAL_COUNT_OPTIONS","dollarSign","rateSection","baseRateInput","timeUnitInput","totalSection","rateAmountContainer","rateAmountInput","addRateButtonText","rateLabelContainer","rateTitleLabel","rateAmountLabel","AddOccurrenceModal","onAdd","hideRates","initialOccurrence","isFromRequestBooking","showDeleteConfirmation","setShowDeleteConfirmation","isAnyPickerActive","setIsAnyPickerActive","heightAnim","initialValues","isCalculatingCost","setIsCalculatingCost","parseInitialDates","oneHourLater","initialDates","setOccurrence","initialState","appliesAfterAnimals","calculatedCost","setUnitOfTime","handlePickerStateChange","currentModalHeight","currentRates","newRates","debouncedCalculateCosts","debounce","initial","timeDiffs","abs","rateChanges","additionalRatesLength","hasInitialValues","hasBookingId","cancel","showAddRate","setShowAddRate","newUnitOfTime","occurrenceRatesUnitOfTime","resetForm","currentInitialValues","currentOccurrence","pickerItem","handleDeleteRate","handleAddRate","handleDeleteClick","handleSubmit","validation","handleAdd","handleDeleteConfirm","serviceOptions","serviceButton","petOptions","dateContainer","timePickerWrapper","dropdownInput","addPetButton","addPetText","occurrenceCard","occurrenceDetails","addOccurrenceButton","addOccurrenceText","occurrenceActions","bookingRequestCard","bookingRequestHeader","bookingRequestTitle","bookingRequestDetails","detailLabel","acceptButton","acceptButtonText","occurrenceCardError","RequestBookingModal","onSubmit","conversationId","showPetDropdown","setShowPetDropdown","showAddOccurrenceModal","setShowAddOccurrenceModal","setOccurrences","selectedOccurrence","setSelectedOccurrence","confirmationModal","setConfirmationModal","occurrenceErrors","setOccurrenceErrors","setPets","fetchPreRequestData","confirmDeleteOccurrence","occurrenceToDelete","handleDeleteOccurrence","handleOpenOccurrenceModal","pet_type","petDropdown","dropdownPetName","dropdownPetDetails","renderOccurrenceCard","occs","errors","validateOccurrences","selectedServiceObj","conversation_id","finally","newOccurrence","selectedServiceCard","selectedServiceText","selectedPetCard","petImageContainer","petImage","defaultPetImage","selectedItemsContainer","selectedItemsTitle","selectedItemsContent","selectedTag","selectedTagText","serviceCheckIcon","ServiceAndPetsCard","onServiceSelect","onPetSelect","currentBookingId","availableServices","setAvailableServices","availablePets","setAvailablePets","isLoadingServices","setIsLoadingServices","isLoadingPets","setIsLoadingPets","serviceError","setServiceError","petsError","setPetsError","fetchAvailableServices","fetchAvailablePets","getBookingAvailableServices","selected_service_id","serviceToSelect","isOvernightForced","getBookingAvailablePets","selected_pet_ids","getServiceIcon","noServicesContainer","selectedPet","image_url","defaultSource","renderPetCard","maxCalendarHeight","isDesktopView","bookingTypeContainer","bookingTypeButton","selectedBookingTypeButton","bookingTypeText","selectedBookingTypeText","dateRangeTypeContainer","dateRangeTypeButton","selectedDateRangeTypeButton","dateRangeTypeText","selectedDateRangeTypeText","calendarContainer","calendarTitle","calendarNavButtonText","weekdaysContainer","weekdayText","weekRow","dateCell","otherMonthDate","otherMonthDateText","dateInRange","selectedDateText","selectedDatesContainer","selectedDatesTitle","selectedDatesList","selectedDateChip","selectedDateChipText","removeButtonText","recurringOptionsContainer","daysOfWeekContainer","dayOfWeekButton","selectedDayOfWeekButton","dayOfWeekText","selectedDayOfWeekText","dateRangeSection","dateRangeRow","dateRangeColumn","dateRangeLabel","dateRangeValue","frequencyContainer","frequencyButton","selectedFrequencyButton","frequencyText","selectedFrequencyText","recurrencePatternContainer","recurrencePatternTitle","recurrencePatternText","modalCloseButtonText","previewButton","previewButtonText","previewModalContent","previewCalendarContainer","recurringDate","recurringDateText","previewDateCell","dateRangeChip","removeRangeButton","oneTimeOptionsContainer","dateSelectionTitle","DateSelectionCard","onDateSelect","bookingType","dateRangeType","initialDateRange","currentMonth","setCurrentMonth","setSelectedDatesList","selectedBookingType","setSelectedBookingType","selectedDateRangeType","setSelectedDateRangeType","rangeStartDate","setRangeStartDate","selectedDaysOfWeek","setSelectedDaysOfWeek","selectedFrequency","setSelectedFrequency","dateRangeEnd","setDateRangeEnd","showRecurringCalendar","setShowRecurringCalendar","recurringStartDate","setRecurringStartDate","recurringEndDate","setRecurringEndDate","setMonth","isSelectingStartDate","setIsSelectingStartDate","showRecurringPreview","setShowRecurringPreview","showRecurringDropdownCalendar","setShowRecurringDropdownCalendar","tempRangeStart","setTempRangeStart","tempRangeEnd","setTempRangeEnd","datesFromRange","setDatesFromRange","lastRangeSelection","setLastRangeSelection","datesArray","dateItem","areConsecutiveDates","checkIfConsecutiveDates","sortedDates","dateData","rangeType","prevDate","currDate","dateRange","handleFrequencySelect","frequency","goToPreviousMonth","prevMonth","goToNextMonth","nextMonth","isDateSelected","handleDateRangeSelection","toggleDateSelection","newSelectedDates","getSelectedDaysText","dayNames","daysText","lastDay","weekNum","getWeekOfMonth","renderCalendar","monthStart","monthEnd","dateIndex","isSelectable","isDateSelectable","isInRange","isDateInRange","isInTempRange","isDateInTempRange","daysOfWeek","handleRecurringDateSelect","handleDateSelection","formatSelectedDate","clearDateRange","renderSelectedDates","handleDayOfWeekSelect","dropdownCalendar","dropdownCalendarContent","dropdownCloseButton","dropdownCloseButtonText","RecurringCalendarPreview","previewMonth","setPreviewMonth","renderPreviewCalendar","recurringDates","getRecurringDates","isRecurring","HOURS","MINUTES","m","PERIODS","timeDisplay","inlineContainer","dropdownContent","column","buttonRow","TimePickerDropdown","initialTime","onTimeSelect","isOpen","uniqueId","showInlinePicker","hourScrollRef","minuteScrollRef","periodScrollRef","initTime","init12Hour","setSelectedTime","lastConfirmedTime","setLastConfirmedTime","timeError","setTimeError","scrollToSelections","handleConfirm","time12h","time24h","triggerTimeChange","handleCancel","hourOffset","scrollTo","animated","minuteOffset","periodOffset","renderDropdownContent","handleHourSelect","handleMinuteSelect","handlePeriodSelect","MaterialIcons","formatTimeDisplay","timeSelectionContainer","dateLabel","timeLabel","timeButtonContent","durationContainer","bgColorModern","durationText","startModalContent","endModalContent","NewTimeRangeSelector","initialTimes","isIndividualDaySelector","times","setTimes","defaultTimes","activeTimePicker","setActiveTimePicker","updatedTimes","formatDate","toLocaleDateString","getStartDate","getEndDate","calculateDuration","diffDays","normalizedStartDate","normalizedEndDate","nights","startMinutes","endMinutes","durationMinutes","durationStr","isEndTimeMidnight","startTotalMinutes","endTotalMinutes","attemptedStart","currentEnd","newTimes","isNewEndTimeMidnight","currentStart","attemptedEnd","DayTimeSelector","onTimeChange","generateUniqueId","match","dateKey","generateDateKey","weekday","timesData","parseTimeValue","timeValue","customizeButtonContainer","customizeButton","customizeButtonText","individualDaysContainer","TimeSelectionCard","showIndividualDays","setShowIndividualDays","shouldShowIndividual","hasIndividualTimes","individualTimeRanges","setIndividualTimeRanges","isInitialRender","hasIndividualTimesFlag","startTimeValue","formattedTimes","hasDatesInDraft","hasDateRange","hasDates","newTimeRanges","dayTime","parsedStartTime","parsedEndTime","handleIndividualDayTimeSelect","updatedRanges","formattedRanges","timeData","handleToggleIndividualDays","getDates","SERVICES_AND_PETS","DATE_SELECTION","TIME_SELECTION","REVIEW_AND_RATES","spacer","smallMargin","smallScreenButton","cancelButtonSmall","nextButtonSmall","stepContent","confirmButtonColumn","BookingStepModal","onComplete","dateSelectionData","hasFetchedDates","getBookingDraftDatesAndTimes","parsedData","parseOccurrencesForBookingSteps","knownOvernightTerms","isOvernightService","term","firstOcc","lastOcc","daysDifference","occ1Date","occ2Date","daysBetween","date1","date2","date_range_type","initialCheck","afterOccurrenceChecks","finalIsOvernightForced","individualTimes","allTimesAreTheSame","booking_type","fetchDraftDatesAndTimes","handleServiceSelect","matchesOvernightTerms","handlePetSelect","handleDateSelect","currentDateRangeType","isServiceOvernight","isTimesOvernightForced","newDateRange","handleTimeSelect","hasValidDates","hasValidDateRange","hasValidDateSelectionData","updateBookingDraftPetsAndServices","isServiceOvernightFlag","isTimeOvernightFlag","isAnyOvernightFlag","formatDateForAPI","formatTimeForAPI","userTz","utcStartDate","utcStartTime","convertToUTC","utcEndDate","utcEndTime","updateBookingDraftTimeAndDate","isTimeOvernight","isMultiDayRange","serviceIsOvernight","timesIsOvernightForced","endTimeIsMidnight","isMidnightEndTimeButNotForced","updatedBookingData","isNonOvernightDateRange","willUseEndpoint","formattedDates","dayTimes","needsNextDayDate","endDateObj","formattedEndDate","calculatedEndDate","isDifferentDates","updateBookingDraftMultipleDays","updateBookingDraftRecurring","stack","createBookingFromDraft","bookingMessageData","bookingMessage","type_of_message","sent_by_other_user","resetModal","dateSelectionIsOvernightMode","combinedMode","isOvernightMode","dateCount","combinedOvernight","sentCard","receivedCard","approvalCard","confirmedCard","colorBar","colorBarLeft","colorBarRight","requestHeader","approvalHeader","confirmedHeader","requestTitle","approvalTitle","changeRequestTitle","infoSection","datesSection","datesSectionHeader","datesCount","occurrenceContainer","occurrenceItem","dateTimeText","dstMessage","detailsButton","detailsButtonText","approveButtonText","statusOverlay","changeMessageContainer","changeMessageLabel","changeMessageText","showMoreButton","showMoreText","confirmationContainerClickable","confirmationContainer","confirmationText","confirmedTitle","confirmationBorder","BookingMessageCard","displayType","isFromMe","onEditDraft","hasChangeRequest","isNewestMessage","messageCreatedAt","hasNewerApprovalRequests","isAfterConfirmation","approvalModalVisible","setApprovalModalVisible","safeInitialData","setSafeInitialData","showAllDates","setShowAllDates","preparedData","isConfirmed","isChangeRequest","isBookingConfirmed","shouldShowAsApproval","shouldShowOverlay","overlayText","overlayLogicChecks","isConfirmedButNotConfirmationMessage","isChangeRequestAndNewestMessage","isApprovalWithChangeRequest","isBookingConfirmedWithNewerApprovals","handleOpenApprovalModal","tempData","formatOccurrenceDateRange","formattedRange","checkDSTChange","startMoment","moment","tz","endMoment","utcOffset","dst_message","formatted_start","formatted_end","getOccurrenceDuration","hoursDiff","diff","hasMoreDates","visibleOccurrences","hiddenDatesCount","getCardStyle","baseStyle","getTitle","getCostValue","isLastVisibleItem","showBottomBorder","toggleDatesExpansion","DraftConfirmationModal","onContinueExisting","onCreateNew","useWebSocket","messageType","handlerId","random","substr","isConnected","setIsConnected","connectionStatus","setConnectionStatus","statusUpdateTimeRef","handlerRegisteredRef","failedAttemptsRef","unregisterHandlers","websocketManager","init","unregister","registerHandler","unregisterConn","prevStatus","prevConnected","unregisterUserStatus","user_id","is_online","initialize","initialConnectionCheck","initialCheckTimeout","checkStatus","secondsSinceUpdate","actuallyConnected","send","sendMessage","payload","reconnect","markMessagesAsRead","messageIds","message_ids","disconnect","connect","bind","simulateConnection","isUsingFallback","MessageHistory","headerTitle","mainSection","conversationListContainer","conversationItem","selectedConversation","conversationName","messageSection","messageHeader","messageHeaderName","messagesContainer","messageList","inputSection","attachButtonContainer","attachButton","inputInnerContainer","sendButton","messageCard","messageContent","sentMessage","receivedMessage","messageText","sentMessageContainer","receivedMessageContainer","senderAbove","sentSenderName","receivedSenderName","timestampBelow","sentTimestamp","receivedTimestamp","sentMessageText","receivedMessageText","touchAction","WebkitTapHighlightColor","WebkitUserSelect","userSelect","resize","overflowY","conversationContent","conversationHeader","conversationNameContainer","conversationTime","conversationLastMessageContainer","conversationLastMessage","conversationUnreadBadge","unreadMessage","bookingStatusContainer","requestBookingButton","requestBookingLabel","messageListContainer","activeConversationText","mobileMessageView","mobileHeader","mobileContent","sendButtonMobile","mobileHeaderContent","mobileHeaderName","mobileHeaderNameContainer","backArrow","sentBookingRequest","receivedBookingRequest","inlineDetailRow","dateSection","viewBookingButton","viewBookingText","statusContainer","deletedOverlay","deletedText","occurrenceNumber","loadingMore","searchContainer","searchInputContainer","searchIcon","clearButton","searchInput","messageHeaderContent","editDraftButton","editDraftText","createBookingContainer","createBookingHangingButton","createBookingHangingText","conversationUnreadText","unreadBadge","unreadBadgeText","conversationNameRow","mobileEditDraftButton","isLoadingConversations","setIsLoadingConversations","isLoadingMessages","setIsLoadingMessages","isSearchFocused","setIsSearchFocused","setSelectedConversation","selectedConversationData","setSelectedConversationData","setMessages","isSending","setIsSending","showRequestModal","setShowRequestModal","showDropdown","setShowDropdown","conversations","setConversations","filteredConversations","setFilteredConversations","hasMore","setHasMore","currentPage","setCurrentPage","isLoadingMore","setIsLoadingMore","prevScreenWidthRef","isInitialLoad","setIsInitialLoad","initialLoadRef","showBookingStepModal","setShowBookingStepModal","setCurrentBookingId","searchQuery","setSearchQuery","hasDraft","setHasDraft","draftData","setDraftData","showDraftConfirmModal","setShowDraftConfirmModal","wsConnectionStatus","setWsConnectionStatus","forceRerender","setForceRerender","resetNotifications","updateRoute","markConversationAsRead","getConversationUnreadCount","MessageNotificationContext","isHandlingRouteParamsRef","hasLoadedMessagesRef","shouldOpenBookingCreationRef","markMessagesAsReadRef","lastViewedConversationRef","isLoadingMoreRef","processedPagesRef","messageIdsRef","handleWebSocketMessage","statusUserId","isOnline","prevConversations","updatedConversations","conv","participant1Id","participant2Id","other_participant_online","updatedCount","selectedParticipant1Id","selectedParticipant2Id","prevMessages","msg","_isOptimistic","_wasOptimistic","last_message","last_message_time","WebSocket","currentUrl","urlConversationId","fetchConversations","setParams","messageId","otherUserName","clientId","conversationsData","initializeData","selectedConversationId","is_professional","handleCreateBooking","isHandlingRouteParams","conversation","other_user_name","newUrl","hasSelectedConversationChanged","hasLoaded","hasChanged","shouldOpenBookingCreation","isCurrentOperation","fetchMessages","prevWidth","hasWidthCrossedThreshold","crossedThreshold","lowercaseQuery","filtered","requestUrl","conversationsWithOnlineStatus","page","pageKey","clear","newMessages","uniqueMessages","has_draft","existingIds","Boolean","messagesToAdd","has_more","config","method","SendNormalMessage","updatedConversation","createNewDraft","draft_id","loadMoreMessages","renderMessage","bookingMessages","created_at","groupMessagesByBookingId","confirmedBookingIds","bookingsWithUpdates","messagesForBooking","confirmationMessage","confirmationTime","newerApprovalRequests","bookingIsConfirmed","bookingMessagesList","hasAssociatedChangeRequest","isApprovalMessage","booking_status","isUpdateToConfirmedBooking","hasNewerRequestChanges","showEditDraft","handleEditDraft","isNewestChangeRequest","hasNewerApprovalMessages","originalIsNewest","hasNewerApprovals","effectivelyNewest","isRelatedToUpdate","hasOlderBookingConfirmedMessage","hasOlderApprovalMessage","payout","WebInput","setMessage","inputRef","isProcessingRef","handleSend","messageToSend","scrollTop","optimisticMessage","is_clickable","filteredMessages","adjustHeight","newHeight","scrollHeight","onKeyPress","shiftKey","preventDefault","rows","MobileInput","blurOnSubmit","handleSearch","renderConversationList","onFocus","otherParticipantName","participant2_name","participant1_name","convId","convIdType","selectedId","selectedIdType","unreadCount","bookingPendingStatus","MessageFlatList","senderHash","contentHash","typeHash","onEndReached","onEndReachedThreshold","inverted","maintainVisibleContentPosition","minIndexForVisible","autoscrollToTopThreshold","ListFooterComponent","removeClippedSubviews","extraData","getItemLayout","offset","renderMessageSection","profile_photo","handleOpenExistingDraft","createDraftFromBooking","draftId","handleBeforeUnload","initialConversationId","bookingRequestResponse","modalData","messageResponse","isUpdate","lastMessageText","handleContinueExisting","warningContainer","warningText","Settings","settingsItems","appName","paragraph","listItem","PrivacyPolicy","ProfessionalSettings","testSection","TermsOfService","HelpFAQ","ContactUs","handleFormspreeSubmit","useForm","setName","maxContentWidth","succeeded","ValidationError","prefix","submitting","SearchBar","forwardRef","initialValue","setValue","IconButton","focus","returnKeyType","memo","androidSafeArea","searchAndFilterContainer","searchBar","ownerList","ownerCard","petTypes","petChip","noOwnersContainer","filtersContainer","filterChip","applyButton","closeIcon","Owners","selectedFilters","setSelectedFilters","tempFilters","setTempFilters","isFilterModalVisible","setIsFilterModalVisible","owners","setOwners","fetchOwners","filters","toggleFilter","prevFilters","f","applyFilters","filteredOwners","matchesSearch","matchesFilters","every","lastBookingDate","weekAgo","monthAgo","yearAgo","setFullYear","renderOwner","Chip","handleSearchChange","CostCalculationModal","onContactPress","setStartDate","setEndDate","additionalAnimals","setAdditionalAnimals","isHolidayRate","setIsHolidayRate","selectedRates","setSelectedRates","setTotalCost","platformFees","setPlatformFees","ratesObj","calculateTotalCost","persistentScrollbar","counterContainer","counterButton","counterText","finalTotal","finalTotalText","contactButton","contactButtonText","dateColumn","heartButton","flexShrink","animalTypeContainer","calculateButton","calculateButtonText","ServiceCard","onHeartPress","isFavorite","professionalId","isModalVisible","setIsModalVisible","handleContactPress","existingConversation","newConversation","createNewConversation","isCurrentUserOwner","unshift","WebMap","mockReviews","photo","createElement","textContent","head","appendChild","topSection","gallerySection","bottomSection","aboutSection","hostingSection","hostTitle","weightRanges","weightRange","galleryPhoto","centered","reviewCount","statItem","skillsGrid","skillBadge","skillText","photoGallery","calculatorText","additionalRatesButton","additionalRatesText","calendarSection","readMoreButton","readMoreText","reviewItem","mapContainer","petsSection","aboutSubsections","communicationSection","skillsSection","homeDetails","twoColumnLayout","singleColumnLayout","homeFeaturesGrid","featureBubble","reviewHeader","reviewerPhoto","reviewerInfo","reviewerName","modalCloseIcon","modalScrollContent","reviewsGrid","specialistSection","specialistText","modalReviewItem","leftColumnMobile","seeAllButton","seeAllButtonText","modalServicesGrid","reviewMeta","starContainer","ProfessionalProfile","professionalData","setProfessionalData","canGoBack","setCanGoBack","bioModalVisible","setBioModalVisible","reviewsModalVisible","setReviewsModalVisible","specialistModalVisible","setSpecialistModalVisible","favoriteServices","setFavoriteServices","servicesModalVisible","setServicesModalVisible","useResponsiveLayout","hasHistory","hasRouteParams","platform","storedProfessional","parsedProfessional","loadProfessionalData","toggleFavorite","renderProfilePhoto","renderRatingStars","TruncatedText","maxLines","renderMap","MapContainer","TileLayer","Marker","center","zoom","attribution","styles2","HomeFeature","renderReview","review","renderAvailability","dynamicServicesBox","servicesScroll","dynamicProfileSection","dynamicProfileSectionMobile","getContentWidth","availableWidth","profileSectionMobile","servicesWrapper","className","servicesScrollContent","homeSection","noContractsText","contractTitle","ContractList","setContracts","fetchContracts","modalPicker","pickerModalContainer","pickerCloseButton","pickerCloseButtonText","OwnerPicker","selectedOwner","onSelectOwner","showOwnerPicker","setShowOwnerPicker","templateGrid","templateBox","templateTitle","noTemplatesText","ownerPickerContainer","ContractTemplate","templates","isTemplateModalVisible","setTemplateModalVisible","isEditModalVisible","setEditModalVisible","selectedTemplate","setSelectedTemplate","contractContent","setContractContent","setSelectedOwner","template","handleTemplateSelect","handleAddSignableField","prevContent","chronicleTitle","summary","ChronicleSummary","chronicles","chronicle","outerContainer","web","boxShadow","QuestionInput","dropdownPosition","setDropdownPosition","layout","setLayout","useLayoutEffect","measure","fx","fy","px","py","body","toggleDropdown","onLayout","nativeEvent","createButton","createButtonText","webModalContent","petOption","petOptionText","photoPreview","photoThumbnail","questionContainer","modalButtonContainer","addQuestionButton","addQuestionButtonText","answerInputContainer","answerInput","summaryInput","photoContainer","ChronicleForm","onCreateChronicle","questions","setQuestions","question","answer","isPreset","setSummary","photos","setPhotos","isUploading","setIsUploading","isCreating","setIsCreating","updateQuestion","newQuestions","PhotoPreview","c","addNewQuestion","allowsMultipleSelection","uploadingText","uploadingSpinner","handleCreateChronicle","newChronicle","useTemplateButton","useTemplateButtonText","MyContracts","setChronicles","setTemplates","fetchChronicles","fetchTemplates","prevChronicles","eyeIcon","successText","forgotPasswordButton","forgotPasswordText","ChangePassword","currentPassword","setCurrentPassword","newPassword","setNewPassword","setSuccess","showCurrentPassword","setShowCurrentPassword","showNewPassword","setShowNewPassword","showConfirmPassword","setShowConfirmPassword","contextScreenWidth","setToken","storedToken","getToken","current_password","new_password","handleForgotPassword","itemText","selectedText","chipsContainer","chip","chipText","chipRemove","tooltipContainer","tooltipHeader","suggestionsWrapper","ServiceTypeSelect","filteredServices","setFilteredServices","handleSelectService","ALL_ANIMAL_TYPES","SUPPORTED_LOCATIONS","zips","ALL_SEARCHABLE_LOCATIONS","getAllSearchableLocations","searchableItems","searchText","LocationInput","onSuggestionSelect","locationInputRef","debouncedSearch","filteredLocations","locationInputWrapper","locationInput","suggestion","suggestionItemNotSupported","suggestionTextNotSupported","suggestionType","OtherAnimalInput","onAnimalSelect","animalInputRef","filteredAnimals","otherAnimalInputWrapper","otherAnimalHeader","otherAnimalTitle","animalInput","animalSuggestionsWrapper","animalSuggestionsContainer","animalSuggestionItem","animalSuggestionText","AnimalTypeButton","animalTypeButton","animalTypeButtonSelected","animalTypeLabel","animalTypeLabelSelected","xlarge","datePickersContainer","dateInput","priceRangeContainer","slider","priceText","personButton","showProfessionalsButton","showProfessionalsText","useLocationButton","useLocationText","animalTypesContainer","priceContainer","priceLabel","checkboxRow","checkboxLabel","headerButtons","iconButton","checkboxLabelContainer","searchButton","searchButtonText","searchButtonDisabled","animalSelectionWrapper","selectedAnimalsContainer","selectedAnimalsLabel","selectedAnimalTag","selectedAnimalText","SearchRefiner","onFiltersChange","onShowProfessionals","onSearchResults","initialFilters","locationSuggestions","setLocationSuggestions","setService","service_query","selectedAnimals","setSelectedAnimals","overnightService","setOvernightService","overnight_service","priceRange","setPriceRange","price_max","verifiedOnly","setVerifiedOnly","insuredOnly","setInsuredOnly","showOtherAnimalInput","setShowOtherAnimalInput","otherAnimalSearch","setOtherAnimalSearch","otherAnimalSuggestions","setOtherAnimalSuggestions","isSearching","setIsSearching","handleAnimalSelect","handleOtherAnimalClose","Slider","minimumValue","maximumValue","minimumTrackTintColor","maximumTrackTintColor","thumbTintColor","price_min","radius_miles","page_size","searchProfessionals","ProfessionalCard","primary_service","backend_value","frontend_value","leftSection","profile_picture_url","nameSection","distance","priceSection","fromText","price_per_visit","perNight","listContent","reviewSection","ratingText","repeatOwners","bestReviewContainer","bestReviewTextContainer","bestReview","readMore","mobileHeaderRight","filterChips","filterChipText","emptyStateMessage","adjustSearchButton","adjustSearchButtonText","ProfessionalList","professionals","onLoadMore","onProfessionalSelect","onFilterPress","renderEmptyState","getEmptyStateMessage","isColoradoSprings","criteria","animalText","criteriaText","renderHeader","professional_id","L","Default","prototype","_getIconUrl","mergeOptions","iconRetinaUrl","iconUrl","shadowUrl","HoverMarker","onShowServicesModal","markerRef","popupRef","MarkerIcon","html","iconSize","iconAnchor","popupAnchor","marker","leafletMarker","getElement","_leaflet_marker","on","openOn","_map","Popup","autoClose","closeOnClick","closeOnEscapeKey","popupContent","handleViewDetails","WebMapComponent","onMarkerPress","region","mapBounds","calculateMapBounds","validProfessionals","prof","lats","lngs","minLat","maxLat","minLng","maxLng","centerLat","centerLng","latDiff","lngDiff","maxDiff","NativeMapComponent","markerText","calloutContainer","calloutText","MapView","modalContainerSmallMobile","headerLeft","professionalLocation","retryText","contentMobile","mobileServicesView","mobileServiceItem","mobileServiceContent","mobileServiceName","mobileServicePrice","mobileDetailsView","mobileDetailsHeader","mobileDetailsTitle","mobileDetailsScrollView","borderRightWidth","borderRightColor","servicesScrollView","serviceItemSelected","serviceNameSelected","servicePriceSelected","serviceDetails","detailsScrollView","detailsTitle","overnightBadge","additionalRateItem","additionalRateRow","additionalRateTitleContainer","additionalRateTitle","infoIcon","additionalRatePrice","tooltipModalOverlay","tooltipModalContent","tooltipTitle","tooltipCloseButton","noSelectionContainer","noSelectionText","contactButtonDisabled","contactButtonContent","ProfessionalServicesModal","primaryService","setShowTooltip","mobileView","setMobileView","isCreatingConversation","setIsCreatingConversation","isSmallMobile","fetchServices","primaryServiceData","getProfessionalServicesDetailed","formatAnimalTypes","types","renderServiceDetails","rate_id","handleBackToServices","createConversation","SearchProfessionalsListing","isSingleView","setIsSingleView","setProfessionals","setFilters","isMapMinimized","setIsMapMinimized","isLeftColumnExpanded","setIsLeftColumnExpanded","showingSearch","setShowingSearch","searchResults","setSearchResults","currentSearchParams","setCurrentSearchParams","setRegion","latitudeDelta","longitudeDelta","activeFilters","setActiveFilters","selectedProfessional","setSelectedProfessional","loadInitialProfessionals","handleSearchResults","handleFiltersChange","newFilters","handleLoadMore","handleProfessionalSelect","handleShowServicesModal","toggleMapSize","handleShowProfessionals","view","toggleLeftColumn","leftColumnToggle","mapColumn","containerMobile","mobileHeaderText","headerIcon","mapToggleButton","renderContent","leftColumnWidth","mapColumnWidth","handleCloseServicesModal","bookingsContent","stickyHeader","stickyHeaderContent","filterScrollContent","filtersWrapper","filterButtonHovered","filterContent","allButton","allButtonText","pendingButton","pendingButtonText","confirmedButton","confirmedButtonText","completedButton","completedButtonText","listHeaderSpacing","listContainer","loadingMoreContainer","emptyStateSubtitle","outlineWidth","MyBookings","setPage","hoveredFilter","setHoveredFilter","subscription","fetchBookings","pageNum","isLoadMore","newBookings","professional_bookings","owner_bookings","searchLower","renderBookingCard","onCancel","handleCancelBooking","ListHeaderComponent","EmptyStateMessage","ServiceManagerScreen","useFocusEffect","previousRoute","setRouteHistory","searchBarContainer","webSearchInput","BlogScreen","filteredPosts","setFilteredPosts","Searchbar","clearIcon","truncatedContent","authorBio","postInfo","referencesTitle","reference","referenceText","errorButton","errorButtonText","BlogPost","setPost","isValidPost","postData","storedPost","parsedPost","postId","foundPost","loadPost","Linking","openURL","handleReferencePress","CrossPlatformContent","ValidationModal","CityDropdown","selectedCity","onSelectCity","setIsOpen","filteredCities","displayCities","requiredField","renderCityItem","cityItem","otherCityItem","cityItemText","otherCityText","cityList","formSection","nameField","checkboxGroup","checkboxIcon","radioGroup","radioContainer","radio","radioSelected","radioLabel","otherInputContainer","otherInput","addressSection","cityStateContainer","cityInput","stateInput","zipInput","addressNote","optional","referralSection","buttonSelected","buttonTextSelected","requiredFieldNote","requiredAsterisk","linkContainer","copyButton","Waitlist","setPhone","setPetInfo","userType","setUserType","hesitations","setHesitations","desiredFeatures","setDesiredFeatures","newsletter","setNewsletter","agreeToTerms","setAgreeToTerms","otherService","setOtherService","showOtherInput","setShowOtherInput","streetAddress","setStreetAddress","aptUnit","setAptUnit","setCity","stateRegion","setStateRegion","zipCode","setZipCode","referralSource","setReferralSource","otherReferralSource","setOtherReferralSource","validationModal","setValidationModal","phoneError","setPhoneError","setSelectedCity","otherCity","setOtherCity","cityError","setCityError","handleBackToSignup","handleCopyLink","Clipboard","setString","formatted","cleaned","area","formatPhoneNumber","toggleService","TestToast","showSuccessToast","showErrorToast","showInfoToast","showWarningToast","showLongToast","topRow","profileInfoWrap","avatar","nameContainerWide","petsText","petsTextWide","textOverflow","servicesLabel","servicesText","servicesTextWide","statusSection","lastBookingContainer","lastBookingText","noBookingsContainer","noBookingsText","pastBookingsContainer","pastBookingsText","upcomingContainer","upcomingText","buttonSection","buttonSectionWrap","mobileBtnSection","viewProfileButton","viewProfileText","createBookingButton","createBookingText","buttonHovered","activeBookingsContainer","activeBookingsText","ConnectionCard","connection","onViewProfile","onCreateBooking","isClient","isExtraWideScreen","isViewMessagesHovered","setIsViewMessagesHovered","isCreateBookingHovered","setIsCreateBookingHovered","active_bookings_count","iconColor","textStyle","has_past_booking","connectionId","connectionName","connectionType","hasActivePastBooking","activeBookingsCount","upcoming_booking","connectionsContent","searchAndInviteContainer","searchContainerFocused","caretColor","inviteButtonSmall","inviteButtonSmallText","activeBookingsButton","activeBookingsButtonText","noBookingsButton","noBookingsButtonText","pastBookingsButton","pastBookingsButtonText","inviteButton","inviteButtonText","footerText","inviteTypeToggle","inviteTypeButton","inviteTypeButtonActive","inviteTypeText","inviteTypeTextActive","emailInput","generatedLinkContainer","generatedLink","sendInviteButton","sendInviteButtonText","columnWrapper","cardWrapper","mobileCardWrapper","wideScreenCardWrapper","Connections","setConnections","showInviteModal","setShowInviteModal","inviteEmail","setInviteEmail","isInviting","setIsInviting","searchFocused","setSearchFocused","searchInputRef","allConnections","setAllConnections","invitationType","setInvitationType","setGeneratedLink","inviteError","setInviteError","inviteSuccess","setInviteSuccess","isInviteButtonHovered","setIsInviteButtonHovered","isCreateServiceButtonHovered","setIsCreateServiceButtonHovered","handleRoleNavigation","fetchConnections","getUserConnections","connectionsList","newConnections","filterConnectionsLocally","handleInviteClient","baseConnections","handleViewMessages","clientName","client_id","numColumns","columnWrapperStyle","clients","all","active","pending","past","clipboard","writeText","inviteClient","invitation_link","Stack","createStackNavigator","Tab","createBottomTabNavigator","screens","component","isMobileView","isUserScrolling","setIsUserScrolling","AutoScrollSection","cardWidth","scrollViewRef","currentIndex","setCurrentIndex","userScrolling","setUserScrolling","autoScrollTimerRef","nextIndex","scrollToIndex","handleScrollEnd","onScroll","contentOffset","scrollEventThrottle","pagingEnabled","onScrollBeginDrag","handleScrollBegin","onScrollEndDrag","onMomentumScrollEnd","handleDotPress","cardStyles","iconContainer","bounces","overScrollMode","resizeMode","Features","roadmapColors","featureItemStyle","featureContentStyle","FontAwesome6","FontAwesome","ReviewsSection","BlogSection","renderBlogPost","tagIndex","ContactSection","showPassword","setShowPassword","rememberMe","setRememberMe","handleLogin","Keyboard","dismiss","timezoneError","tutorialResponse","needsTutorial","first_time_logging_in","first_time_logging_in_after_signup","tutorialError","handleDocumentKeyPress","handleKeyPress","togglePasswordVisibility","uid","linking","enabled","prefixes","Home","About","SignIn","path","Invite","exact","ResetPassword","ResetPasswordConfirm","senderName","More","Blog","navigationRef","createNavigationContainerRef","isReady","TabNavigator","Navigator","tabBar","Navigation","Screen","headerShown","AppContent","authContext","checkAuthStatus","setInitialRoute","authStatus","isAuthenticated","initializeApp","initialRouteName","screenOptions","TransitionPresets","SlideFromRightIOS","presentation","warningBanner","warningContent","waitlistButtonText","App","NavigationContainer","onStateChange","AuthProvider","MessageNotificationProvider","PaperProvider","utcDates","dateStr","startTimeStr","endTimeStr","endDateStr","isMidnightEnd","isTimeBeforeStart","recurringData","getUserName","isFormData","formattedAdditionalRates","getConnectionProfile","userId","is_professional_invite","sendReferral","referralType","referral_type","getInvitations","getInvitationDetails","acceptInvitation","deleteInvitation","resendInvitation","getUnreadMessageCount","newCurrentRoute","newPreviousRoute","toLocation","fromLocation","_worklet_1130445313934_init_data","code","_worklet_238094918771_init_data","_worklet_7555450561358_init_data","descriptors","setVisible","isMenuOpen","setIsMenuOpen","setIsCollapsed","hasUnreadMessages","setCurrentRoute","setNotificationCount","line1Rotation","useSharedValue","line2Opacity","line3Rotation","line1TranslateY","line3TranslateY","AnimatedHamburgerMenu","line1Style","useAnimatedStyle","anonymous","__closure","__workletHash","__initData","line2Style","line3Style","toX","withTiming","animateHamburgerMenu","toggleMenu","updateCurrentRoute","handlePopState","navState","routeName","screenName","tabName","initializeRouteTracking","handleRoleSwitch","newRole","currentTab","newTab","connectionsTab","handleLogout","navContainer","renderDesktopSidebar","sidebarWidth","isProfessionalRole","isOwnerRole","sidebarContainer","sidebarLogoContainer","logoButton","sidebarLogo","tintColor","roleToggleContainer","roleToggleTitle","roleButtonsContainer","roleButton","roleButtonActive","currentRole","roleButtonText","roleButtonTextActive","roleButtonDisabled","roleButtonTextDisabled","showNotification","sidebarItem","activeItem","messageNotificationBadge","messageNotificationText","sidebarItemText","logoutText","renderMobileHeader","logoSize","mobileLogo","mobileRightContent","profileContainer","hamburgerMenuContainer","mobileMenu","mobileRoleToggleContainer","mobileRoleToggleTitle","mobileRoleButtonsContainer","mobileRoleButton","mobileRoleButtonActive","mobileRoleButtonText","mobileRoleButtonTextActive","mobileRoleButtonDisabled","mobileRoleButtonTextDisabled","mobileMenuItem","mobileMessageNotificationBadge","mobileMessageNotificationText","mobileMenuItemText","mobileLogoutItem","mobileLogoutText","renderMobileNavBar","itemWidth","customNavBar","navButton","navText","titleContainer","titleContainer2","desktopNav","navItem","webNavItem","webNavText","navLinkContainer","menuContent","notificationText","messageNotificationDot","mobileMessageNotificationDot","NODE_ENV","process_env_NODE_ENV","STAGING_API_BASE_URL_ANDROID","STAGING_API_BASE_URL_IOS","STAGING_API_BASE_URL_WEB","PRODUCTION_API_BASE_URL_ANDROID","PRODUCTION_API_BASE_URL_IOS","PRODUCTION_API_BASE_URL_WEB","DEV_API_BASE_URL_ANDROID","DEV_API_BASE_URL_IOS","DEV_API_BASE_URL_WEB","isDevelopment","isStaging","isProduction","debugEnabled","setDebugEnabled","AuthService","accessToken","isRefreshing","refreshSubscribers","tokenExpiryTime","lastValidation","authStateCallbacks","isSigningOut","lastTokenCheck","TOKEN_REFRESH_THRESHOLD","TOKEN_PREEMPTIVE_REFRESH","VALIDATION_CACHE_TIME","onAuthStateChange","notifyAuthStateChange","parseJwt","jsonPayload","atob","decodeURIComponent","charCodeAt","Buffer","getTimeUntilExpiry","parsedToken","exp","expiryTime","shouldRefreshToken","timeUntilExpiry","shouldRefresh","refreshTokens","sub","refreshStartTime","refreshDuration","clearTokens","getAccessToken","validateToken","setTokens","multiSet","hasAccessToken","hasRefreshToken","forceSignOut","is_PRODUCTION","authService","isInitializedRef","signOutTimeoutRef","setIsSignedIn","setUserRole","setIsApprovedProfessional","setTimeSettings","timezone_abbrev","setIsPrototype","setIsDebug","consecutiveAuth401Errors","requestInterceptor","interceptors","request","use","responseInterceptor","originalRequest","_retry","isAuthLoggingCall","refreshPromise","timeoutPromise","race","refreshError","eject","focusCheckTimeout","handleWindowFocus","visibilityState","fetchUserName","getProfessionalStatus","storedRole","finalRole","suggestedRole","first_name","is_approved","handleDimensionsChange","checkStateConsistency","hasStoredTokens","hasMemoryTokens","consistencyInterval","monitorInterval","refreshTokenValue","timeSettingsData","initialRole","getCurrentRoute","debugTokenStatus","isExpired","hasToken","timeUntilExpirySeconds","setHasUnreadMessages","setUnreadCount","conversationCounts","setConversationCounts","websocketInitialized","setWebsocketInitialized","lastApiCheck","setLastApiCheck","initialCheckDoneRef","pendingCheckRef","reconnectIntervalRef","debounceTimerRef","websocketDataReceivedRef","lastCheckTimeRef","websocketTimeoutRef","websocketRetryAttemptsRef","lastHeartbeatReceivedRef","lastHeartbeatSentRef","heartbeatTimeoutRef","connectionHealthyRef","initialApiCallMadeRef","lastApiResponse","setLastApiResponse","lastApiCheckRef","checkUnreadMessages","force","stackTrace","makeApiCall","websocketConnected","isWebSocketConnected","waitForWebSocketWithFallback","checkWebSocketAndWait","connected","unread_count","conversationUnreadCounts","conversation_counts","debouncedCheckUnreadMessages","onNewMessage","messageData","sender_name","handleNewMessageNotification","prevCount","newCount","prevCounts","prevConvCount","newConvCount","updatedCounts","previousCount","newCounts","stillHasUnread","remainingConvs","initializeWebSocket","messageHandler","unreadUpdateHandler","heartbeatHandler","connectionHandler","forced","handleVisibilityChange","isWSConnected","reconnectIfNeeded","startProgressiveRetry","contextValue","DefaultTheme","typography","accent","parseISO","momentDate","convertTo24Hour","modifier","convertTo12Hour","fromTimezone","localMoment","utcMoment","utc","utcDate","utcTime","output","originalMoment","formattedTime","isoString","parseError","toDate","timeParts","localDateStr","localTimeStr","getFormattedTimes","startHours","endHours","startDateStr","formatInTimeZone","durationMs","remainingMs","startLocalDate","endLocalDate","startZonedDate","fromZonedTime","toZonedTime","endZonedDate","startLocal","endLocal","getTimezoneOffset","formatOccurrenceFromUTC","fullTimezone","localStart","localEnd","hasDSTChange","tzAbbrev","FORMAT_TYPES","SHORT_DATE","MEDIUM_DATE","LONG_DATE","TIME_ONLY","TIME_ONLY_24H","DATE_TIME","DATE_TIME_WITH_TZ","DATE_RANGE","DATE_TIME_RANGE","formatFromUTC","timeStr","formatType","zoneAbbr","startUtcMoment","endUtcMoment","startLocalMoment","endLocalMoment","startFormatted","endFormatted","finalStart","finalEnd","convertTimeFromUTC","dateChanged","fullDateTime","local","adjustedDate","uniqueDates","sortedOccurrences","localStartTime","localEndTime","actualStartDate","actualEndDate","firstDateKey","timeObj","socket","connectionAttempts","maxConnectionAttempts","heartbeatInterval","disconnectTimeout","messageHandlers","Map","wsUrl","_reconnectTimeout","forceDisconnect","_hasVisibilityListener","readyState","OPEN","CLOSING","CLOSED","resetDisconnectTimeout","setupVisibilityListener","CONNECTING","wsEndpoint","onopen","handleOpen","onclose","onmessage","handleMessage","onerror","handleError","scheduleReconnect","startHeartbeat","notifyHandlers","wasConnected","delay","preserveToken","savedToken","close","handler","unregisterHandler","webpackContext","req","webpackContextResolve","__webpack_require__","o","module","exports","__webpack_module_cache__","moduleId","cachedModule","loaded","__webpack_modules__","call","deferred","O","chunkIds","fn","priority","notFulfilled","Infinity","fulfilled","j","n","getter","__esModule","definition","defineProperty","enumerable","g","globalThis","Function","obj","prop","hasOwnProperty","Symbol","toStringTag","nmd","paths","installedChunks","chunkId","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","chunkLoadingGlobal","self","__webpack_exports__"],"sourceRoot":""}