(()=>{var e={52532:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>Kr,navigate:()=>Jr,navigationRef:()=>Gr});var n=o(36665),a=o(95991),r=o(73944),i=o(8218),s=o(66986),l=o(48658),d=o(26166),c=o(43150),u=o(45010),m=o(6541),g=o(38432),h=o(59742),f=o(19620),p=o(91087),y=o(34470),b=o(77109),x=o(73929),C=o(6283),v=o(15648),w=o(24534),j=o(26725),S=o(7869),T=o(60397);const B=r.default.create({overlay:{position:"web"===a.default.OS?"fixed":"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:999},container:{position:"web"===a.default.OS?"fixed":"absolute",backgroundColor:m.theme.colors.surface,borderRadius:12,padding:20,width:320,shadowColor:"#000",shadowOffset:{width:0,height:4},shadowOpacity:.3,shadowRadius:5,elevation:8,zIndex:1e3,borderWidth:2,borderColor:m.theme.colors.primary},pulseBorder:{position:"absolute",top:-4,left:-4,right:-4,bottom:-4,borderRadius:14,opacity:.7},closeButton:{position:"absolute",top:12,right:12,padding:8,zIndex:1},content:{marginTop:12},title:{fontSize:20,fontWeight:"700",color:m.theme.colors.primary,marginBottom:8,fontFamily:m.theme.fonts.header.fontFamily},description:{fontSize:16,color:m.theme.colors.text,marginBottom:20,lineHeight:22,fontFamily:m.theme.fonts.regular.fontFamily},footer:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginTop:16},leftButtons:{flex:1},skipButton:{paddingVertical:8,paddingHorizontal:12},skipText:{color:m.theme.colors.secondary,fontSize:14,fontFamily:m.theme.fonts.regular.fontFamily},navigationButton:{flexDirection:"row",alignItems:"center",paddingVertical:8,paddingHorizontal:12},navigationText:{color:m.theme.colors.primary,fontSize:14,fontWeight:"500",fontFamily:m.theme.fonts.regular.fontFamily},finishButton:{backgroundColor:m.theme.colors.primary,paddingVertical:8,paddingHorizontal:16,borderRadius:4},finishText:{color:m.theme.colors.surface,fontSize:14,fontWeight:"500",fontFamily:m.theme.fonts.regular.fontFamily},stepIndicator:{paddingHorizontal:12},stepText:{color:m.theme.colors.secondary,fontSize:14,fontFamily:m.theme.fonts.regular.fontFamily}}),k=({step:e,totalSteps:t,title:o,description:a,onNext:r,onPrevious:i,onSkip:s,onClose:l,onFinish:d,position:c="bottomRight",userRole:u,is_DEBUG:h=!1})=>{const f=1===e,p=e===t,[b,k]=(0,n.useState)(!0),[A,_]=(0,n.useState)(null),I=(0,y.useNavigation)(),M=(0,n.useRef)(new w.default.Value(0)).current,D=(0,n.useRef)(new w.default.Value(0)).current,R=(0,n.useRef)(new w.default.Value(1)).current,{width:L,height:z}=j.default.get("window");(0,n.useEffect)((()=>{h&&(0,g.debugLog)("MBA54321 TutorialModal mounted/updated",{isVisible:b,currentStep:e,userRole:u,screen:A})}),[b,e,u,A]),(0,n.useEffect)((()=>{if(b){(0,g.debugLog)("MBA54321 Tutorial is visible, ensuring it stays visible on screen change");const e=setTimeout((()=>{k(!0)}),100);return()=>clearTimeout(e)}}),[b]),(0,n.useEffect)((()=>I.addListener("focus",(()=>{b&&((0,g.debugLog)("MBA54321 Screen focused, ensuring tutorial stays visible"),k(!0))}))),[I,b]),(0,n.useEffect)((()=>{w.default.timing(M,{toValue:1,duration:500,useNativeDriver:!0}).start(),w.default.timing(D,{toValue:1,duration:800,useNativeDriver:!0}).start(),w.default.timing(R,{toValue:0,duration:800,useNativeDriver:!0}).start()}),[]);const P={top:(z+60)/2-150,left:(L-15)/2-160},F=(()=>{switch(c){case"bottomRight":default:return{bottom:20,right:20};case"bottomLeft":return{bottom:20,left:20};case"topRight":return{top:20,right:20};case"topLeft":return{top:20,left:20}}})(),O={transform:[{translateX:D.interpolate({inputRange:[0,1],outputRange:[0,F.right?L/2-160:-L/2+160]})},{translateY:D.interpolate({inputRange:[0,1],outputRange:[0,F.bottom?z/2-150:-z/2+150]})}]};return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(w.default.View,{style:[B.overlay,{opacity:R}],pointerEvents:"none"}),(0,T.jsxs)(w.default.View,{style:[B.container,P,{opacity:M},O],children:[(0,T.jsx)(x.default,{style:B.pulseBorder}),(0,T.jsx)(v.default,{style:B.closeButton,onPress:()=>{h&&(0,g.debugLog)("MBA54321 TutorialModal handleClose called"),l()},children:(0,T.jsx)(S.default,{name:"close",size:20,color:m.theme.colors.text})}),(0,T.jsxs)(x.default,{style:B.content,children:[(0,T.jsx)(C.default,{style:B.title,children:o}),(0,T.jsx)(C.default,{style:B.description,children:a}),(0,T.jsxs)(x.default,{style:B.footer,children:[(0,T.jsx)(x.default,{style:B.leftButtons,children:f?(0,T.jsx)(v.default,{style:B.skipButton,onPress:()=>{h&&(0,g.debugLog)("MBA54321 TutorialModal handleSkip called"),s()},children:(0,T.jsx)(C.default,{style:B.skipText,children:"Skip Tutorial"})}):(0,T.jsxs)(v.default,{style:B.navigationButton,onPress:()=>{h&&(0,g.debugLog)("MBA54321 TutorialModal handlePrevious called",{step:e,totalSteps:t}),i()},children:[(0,T.jsx)(S.default,{name:"chevron-left",size:20,color:m.theme.colors.primary}),(0,T.jsx)(C.default,{style:B.navigationText,children:"Previous"})]})}),(0,T.jsx)(x.default,{style:B.stepIndicator,children:(0,T.jsxs)(C.default,{style:B.stepText,children:[e,"/",t]})}),p?(0,T.jsx)(v.default,{style:B.finishButton,onPress:()=>{h&&(0,g.debugLog)("MBA54321 TutorialModal handleFinish called"),d()},children:(0,T.jsx)(C.default,{style:B.finishText,children:"Finish Tutorial"})}):(0,T.jsxs)(v.default,{style:B.navigationButton,onPress:()=>{h&&(0,g.debugLog)("MBA54321 TutorialModal handleNext called",{step:e,totalSteps:t}),r()},children:[(0,T.jsx)(C.default,{style:B.navigationText,children:"Next"}),(0,T.jsx)(S.default,{name:"chevron-right",size:20,color:m.theme.colors.primary})]})]})]})]})]})};var A=o(78264),_=o(20530);const I=r.default.create({modalOverlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center"},modalContent:{backgroundColor:m.theme.colors.surface,borderRadius:8,padding:20,width:"90%",maxWidth:400},modalText:{fontSize:m.theme.fontSizes.medium,marginBottom:20,textAlign:"center",color:m.theme.colors.text},buttonContainer:{flexDirection:"row",justifyContent:"space-between",gap:10},button:{flex:1,paddingVertical:12,borderRadius:8,alignItems:"center"},cancelButton:{backgroundColor:m.theme.colors.surface,borderWidth:1,borderColor:m.theme.colors.border},confirmButton:{backgroundColor:m.theme.colors.primary},cancelButtonText:{color:m.theme.colors.text,fontWeight:"500"},confirmButtonText:{color:m.theme.colors.surface,fontWeight:"500"},disabledButton:{opacity:.7},disabledText:{opacity:.5}}),M=({visible:e,onClose:t,onConfirm:o,actionText:n,isLoading:a=!1})=>(0,T.jsx)(A.default,{visible:e,transparent:!0,animationType:"fade",onRequestClose:t,children:(0,T.jsx)(x.default,{style:I.modalOverlay,children:(0,T.jsxs)(x.default,{style:I.modalContent,children:[(0,T.jsxs)(C.default,{style:I.modalText,children:["Are you sure you want to ",n,"?"]}),(0,T.jsxs)(x.default,{style:I.buttonContainer,children:[(0,T.jsx)(v.default,{style:[I.button,I.cancelButton],onPress:t,disabled:a,children:(0,T.jsx)(C.default,{style:[I.cancelButtonText,a&&I.disabledText],children:"Cancel"})}),(0,T.jsx)(v.default,{style:[I.button,I.confirmButton,a&&I.disabledButton],onPress:o,disabled:a,children:a?(0,T.jsx)(_.default,{size:"small",color:m.theme.colors.surface}):(0,T.jsx)(C.default,{style:I.confirmButtonText,children:"Confirm"})})]})]})})}),D=(0,n.createContext)(),R={done_client_tutorial:!1,done_pro_tutorial:!1},L={client:[{screen:"MyProfile",tab:"profile_info",title:"Welcome to Your Profile",description:"This is where you can manage your personal information. Start by completing your profile to help professionals understand your needs better.",position:"bottomRight"},{screen:"MyProfile",tab:"pets_preferences",title:"Add Pets & Home Info",description:"Add information about your pets and their care preferences along with your home information. This helps professionals provide the best care possible.",position:"bottomRight"},{screen:"MyProfile",tab:"settings_payments",title:"Payment & Settings",description:"Set up your settings, payment methods, and subscription preferences to easily book services.",position:"bottomRight"},{screen:"Dashboard",title:"Your Dashboard",description:"Here you can view your upcoming bookings, track ongoing services, and manage your account.",position:"bottomRight",onStepEnter:e=>{e&&e.navigate("Dashboard")}},{screen:"SearchProfessionalsListing",title:"Find Professionals",description:"Search for qualified professionals in your area. Filter by service type, availability, and more.",position:"bottomRight"},{screen:"BecomeProfessional",title:"Become a Professional",description:"Want to offer your services? You can apply to become a professional anytime.",position:"bottomRight"}],professional:[{screen:"MyProfile",tab:"profile_info",title:"Welcome to Your Professional Profile",description:"This is where you can manage your professional information. Start by completing your profile to help clients find you.",position:"bottomRight"},{screen:"MyProfile",tab:"services",title:"Your Services",description:"Add and manage the services you offer. Set your rates, availability, and service areas.",position:"bottomRight"},{screen:"MyProfile",tab:"settings_payments",title:"Payment Settings",description:"Set up your payment methods and subscription preferences to receive payments from clients.",position:"bottomRight"},{screen:"Dashboard",title:"Your Dashboard",description:"Here you can view your upcoming bookings, track ongoing services, and manage your account.",position:"bottomRight",onStepEnter:e=>{e&&e.navigate("Dashboard")}},{screen:"SearchClients",title:"Find Clients",description:"Search for potential clients in your area. Filter by service type, pet type, and more.",position:"bottomRight"}],default:[{screen:"Home",title:"Welcome",description:"Welcome to CrittrCove! Let's get started with a quick tour.",position:"bottomRight"}]},z=({children:e})=>{const{isSignedIn:t,userRole:o,is_DEBUG:a}=(0,n.useContext)(g.AuthContext),r=(0,y.useNavigation)(),[i,s]=(0,n.useState)(R),[l,d]=(0,n.useState)(1),[c,m]=(0,n.useState)(!1),[h,p]=(0,n.useState)(!1),[x,C]=(0,n.useState)(""),[v,w]=(0,n.useState)(!0),[j,S]=(0,n.useState)(!1),[B,A]=(0,n.useState)(!1);(0,n.useEffect)((()=>{t&&o?((0,g.debugLog)("MBA54321 Both isSignedIn and userRole are available, fetching tutorial status",{isSignedIn:t,userRole:o}),_()):((0,g.debugLog)("MBA54321 Waiting for auth data",{isSignedIn:t,userRole:o}),w(!1))}),[t,o]);const _=async()=>{try{w(!0);const e=await b.default.get("".concat(f.API_BASE_URL,"/api/users/v1/tutorial-status/current/"));a&&(0,g.debugLog)("MBA54321 Tutorial status:",e.data),s(e.data),p(!1),C(""),"professional"===o&&!e.data.done_pro_tutorial||"petOwner"===o&&!e.data.done_client_tutorial?(m(!0),a&&(0,g.debugLog)("MBA54321 Redirecting new user to MyProfile screen"),(0,u.navigateToFrom)(r,"MyProfile","Dashboard",{screen:"profile_info"}),a&&(0,g.debugLog)("MBA54321 Tutorial should be visible:",{userRole:o,done_client_tutorial:e.data.done_client_tutorial,done_pro_tutorial:e.data.done_pro_tutorial})):(a&&(0,g.debugLog)("MBA54321 Tutorial should NOT be visible"),m(!1))}catch(e){console.error("Error fetching tutorial status:",e),p(!0),C("We had trouble loading your tutorial settings, but you can still proceed with the tutorial."),s(R),m(!0)}finally{w(!1)}},I=()=>{let e="default";"professional"===o?e="professional":"petOwner"!==o&&"client"!==o||(e="client");const t=L[e]||L.default,n=Math.min(Math.max(1,l),t.length),a=t[n-1];return h&&1===n?Object.assign({},a,{description:"".concat(x,"\n\n").concat(a.description)}):a},z=async()=>{(0,g.debugLog)("MBA54321 handleNext called",{currentStep:l,userRole:o});const e=L["professional"===o?"professional":"client"];if(l>=e.length)return void(0,g.debugLog)("MBA54321 At last step, completing tutorial",{currentStep:l,totalSteps:e.length});const t=e[l],n=e[l-1];(0,g.debugLog)("MBA54321 Current step data",n),(0,g.debugLog)("MBA54321 Next step data",t),d((e=>e+1)),(t.screen!==n.screen||t.tab&&t.tab!==n.tab)&&((0,g.debugLog)("MBA54321 Navigating to different screen/tab",{from:n.screen,to:t.screen,fromTab:n.tab,toTab:t.tab}),t.tab?(0,u.navigateToFrom)(r,t.screen,n.screen,{screen:t.tab}):(0,u.navigateToFrom)(r,t.screen,n.screen),setTimeout((()=>{m(!0)}),700))},P=()=>{if((0,g.debugLog)("MBA54321 handlePrevious called",{currentStep:l,userRole:o}),l>1){const e=L["professional"===o?"professional":"client"],t=e[l-2],n=e[l-1];(0,g.debugLog)("MBA54321 Previous step data",t),(0,g.debugLog)("MBA54321 Current step data",n),d((e=>e-1)),(t.screen!==n.screen||t.tab&&t.tab!==n.tab)&&((0,g.debugLog)("MBA54321 Navigating back to different screen/tab",{from:n.screen,to:t.screen,fromTab:n.tab,toTab:t.tab}),t.tab?(0,u.navigateToFrom)(r,t.screen,n.screen,{screen:t.tab}):(0,u.navigateToFrom)(r,t.screen,n.screen),setTimeout((()=>{m(!0)}),700))}},F=()=>{(0,g.debugLog)("MBA54321 handleSkip called through the later"),S(!0)},O=async()=>{(0,g.debugLog)("MBA54321 Completing tutorial",{userRole:o});try{const e={};"professional"===o?e.done_pro_tutorial=!0:"petOwner"!==o&&"client"!==o||(e.done_client_tutorial=!0),await b.default.patch("".concat(f.API_BASE_URL,"/api/users/v1/tutorial-status/update_status/"),e),(0,g.debugLog)("MBA54321 Tutorial status updated in backend"),m(!1),(0,g.debugLog)("MBA54321 Navigating to Dashboard"),(0,u.navigateToFrom)(r,"Dashboard",I().screen)}catch(e){(0,g.debugLog)("MBA54321 Error completing tutorial",{error:e.message}),console.error("Error completing tutorial:",e),(0,u.navigateToFrom)(r,"Dashboard",I().screen)}};return v?(0,T.jsx)(D.Provider,{value:{isVisible:!1,currentStep:1,totalSteps:1,stepData:L.default[0],tutorialStatus:R,hasError:!1,errorMessage:"",handleNext:()=>{},handlePrevious:()=>{},handleSkip:()=>{},completeTutorial:()=>{},setIsVisible:()=>{},isLoading:!0},children:e}):(0,T.jsxs)(D.Provider,{value:{isVisible:c,setIsVisible:m,currentStep:l,setCurrentStep:d,handleNext:z,handlePrevious:P,handleSkip:F,completeTutorial:O,isLoading:v},children:[e,c&&I()&&(0,T.jsx)(k,{step:l,totalSteps:L["professional"===o?"professional":"petOwner"===o||"client"===o?"client":"default"].length,title:I().title,description:I().description,onNext:z,onPrevious:P,onSkip:F,onClose:()=>{(0,g.debugLog)("MBA54321 handleClose called"),A(!0)},onFinish:O,position:I().position,userRole:o,is_DEBUG:a}),(0,T.jsx)(M,{visible:j,onClose:()=>{(0,g.debugLog)("MBA54321 handleSkipCancel called"),S(!1)},onConfirm:()=>{(0,g.debugLog)("MBA54321 handleSkipConfirm called"),S(!1),O()},actionText:"skip the tutorial",isLoading:!1}),(0,T.jsx)(M,{visible:B,onClose:()=>{(0,g.debugLog)("MBA54321 handleCloseCancel called"),A(!1)},onConfirm:()=>{(0,g.debugLog)("MBA54321 handleCloseConfirm called"),A(!1),O()},actionText:"close the tutorial",isLoading:!1})]})},P=r.default.create({container:{position:"web"===a.default.OS?"fixed":"absolute",bottom:20,right:0,zIndex:9999,paddingHorizontal:16,width:"100%",alignItems:"flex-end"},toast:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingVertical:12,paddingHorizontal:12,borderRadius:8,minWidth:200,maxWidth:300,elevation:6,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:3.84},content:{flex:1,flexDirection:"row",alignItems:"center"},icon:{marginRight:8},message:{color:"#fff",fontSize:14,fontFamily:"web"===a.default.OS?void 0:m.theme.fonts?.regular?.fontFamily,flex:1},closeButton:{padding:4}}),F=({visible:e,message:t,type:o="success",onDismiss:a,duration:r=3e3})=>{const i=(0,n.useRef)(new w.default.Value(j.default.get("window").width)).current,s=(0,n.useRef)(new w.default.Value(0)).current,l=(0,n.useRef)(null);(0,n.useEffect)((()=>(e&&(l.current&&clearTimeout(l.current),w.default.parallel([w.default.timing(i,{toValue:0,duration:300,useNativeDriver:!0}),w.default.timing(s,{toValue:1,duration:300,useNativeDriver:!0})]).start(),l.current=setTimeout((()=>{d()}),r)),()=>{l.current&&clearTimeout(l.current)})),[e,r]);const d=()=>{var e;l.current&&clearTimeout(l.current),e=()=>{a&&a()},w.default.parallel([w.default.timing(i,{toValue:j.default.get("window").width,duration:300,useNativeDriver:!0}),w.default.timing(s,{toValue:0,duration:300,useNativeDriver:!0})]).start(e)};return e?(0,T.jsx)(x.default,{style:P.container,pointerEvents:"box-none",children:(0,T.jsxs)(w.default.View,{style:[P.toast,{backgroundColor:(()=>{switch(o){case"error":return m.theme.colors.error;case"warning":return m.theme.colors.warning||"#FFA726";case"info":return m.theme.colors.info||"#29B6F6";default:return m.theme.colors.primary}})(),transform:[{translateX:i}],opacity:s}],children:[(0,T.jsxs)(x.default,{style:P.content,children:[(0,T.jsx)(S.default,{name:(()=>{switch(o){case"error":return"alert-circle";case"warning":return"alert";case"info":return"information";default:return"check-circle"}})(),size:24,color:"white",style:P.icon}),(0,T.jsx)(C.default,{style:P.message,numberOfLines:3,ellipsizeMode:"tail",children:t})]}),(0,T.jsx)(v.default,{onPress:d,style:P.closeButton,hitSlop:{top:10,bottom:10,left:10,right:10},children:(0,T.jsx)(S.default,{name:"close",size:18,color:"white"})})]})}):null},O=(0,n.createContext)(),E=()=>{const e=(0,n.useContext)(O);if(!e)throw new Error("useToast must be used within a ToastProvider");return e},W=({children:e})=>{const[t,o]=(0,n.useState)({visible:!1,message:"",type:"success",duration:3e3}),a=(0,n.useCallback)((({message:e,type:t="success",duration:n=3e3})=>{o({visible:!0,message:e,type:t,duration:n})}),[]),r=(0,n.useCallback)((()=>{o((e=>Object.assign({},e,{visible:!1})))}),[]);return(0,T.jsx)(O.Provider,{value:a,children:(0,T.jsxs)(x.default,{style:N.container,children:[e,(0,T.jsx)(F,{visible:t.visible,message:t.message,type:t.type,duration:t.duration,onDismiss:r})]})})},N=r.default.create({container:{flex:1,position:"relative"}});var H=o(2772),U=o(40484),V=o(79632),q=o(16773),Y=o(95056),G=o(16204),J=o(17438),$=o(92288);const Z=r.default.create({container:{padding:20,width:"100%",maxWidth:1200,marginLeft:"auto",marginRight:"auto"},title:{fontSize:24,fontWeight:"bold",textAlign:"center",marginBottom:40,color:"black",fontFamily:m.theme.fonts.header.fontFamily},mobileContainer:{width:"100%",alignItems:"center",paddingVertical:20},mobileItemContainer:{width:"100%",alignItems:"center",marginBottom:80,position:"relative"},mobileMarker:{alignItems:"center",marginBottom:20},mobileMilestoneTitle:{fontSize:16,fontWeight:"bold",color:"black",marginTop:15,textAlign:"center",marginBottom:30},mobileDashedLine:{position:"absolute",width:2,height:60,bottom:-50,borderStyle:"dashed",borderWidth:1,borderColor:"#333"},webContainer:{position:"relative",marginTop:20,marginBottom:120,width:"100%"},dashedLine:{position:"absolute",height:2,top:30,borderStyle:"dashed",borderWidth:1,borderColor:"#333"},webMarker:{position:"absolute",alignItems:"center",width:120,transform:[{translateX:-60}]},webMilestoneTitle:{marginTop:10,fontSize:16,fontWeight:"bold",color:"black",textAlign:"center"},markerContainer:{width:60,height:60,borderRadius:30,justifyContent:"center",alignItems:"center",shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:4,elevation:5},modalOverlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center",padding:20},modalContent:{backgroundColor:"white",padding:20,borderRadius:15,width:"90%",maxWidth:400,alignItems:"center"},modalIconContainer:{width:80,height:80,borderRadius:40,justifyContent:"center",alignItems:"center",marginBottom:20},modalNumber:{color:"white",fontSize:20,fontWeight:"bold",position:"absolute",top:10},modalTitle:{fontSize:24,fontWeight:"bold",marginBottom:15,color:"black",textAlign:"center",fontFamily:m.theme.fonts.header.fontFamily},modalDescription:{fontSize:18,textAlign:"center",marginBottom:20,color:"black",lineHeight:24,fontFamily:m.theme.fonts.regular.fontFamily},closeButton:{padding:12,borderRadius:8,width:"100%",alignItems:"center"},closeButtonText:{color:"white",fontSize:16,fontWeight:"bold"}}),K=()=>{const[e,t]=(0,n.useState)(null),[o,a]=(0,n.useState)(!1),{screenWidth:r}=(0,n.useContext)(g.AuthContext),i=r<768,s=[{id:1,title:"Prototype Launch",description:"Initial release of CrittrCove webpage and landing page with no signup or app functionality.",icon:"dog",color:m.theme.colors.mainColors.senary},{id:2,title:"Launch of MVP",description:"This is when users will be able to sign up and use the app fully for the first time on the website! For a full feature list, please check our blog or discord.",icon:"dragon",color:m.theme.colors.mainColors.quinary},{id:3,title:"Launch of App",description:"Mobile app release with real-time messaging, notifications, and payment integration. For a full feature list, please check our blog or discord.",icon:"cat",color:m.theme.colors.mainColors.quaternary},{id:4,title:"Community Features",description:"Adding social features, pet communities, and expert advice forums.",icon:"fish",color:m.theme.colors.mainColors.main}],l=e=>{t(e),a(!0)};return(0,T.jsxs)(x.default,{style:Z.container,children:[(0,T.jsx)(C.default,{style:Z.title,children:"Roadmap"}),i?(0,T.jsx)(x.default,{style:Z.mobileContainer,children:s.map(((e,t)=>(0,T.jsxs)(x.default,{style:[Z.mobileItemContainer,t===s.length-1?{marginBottom:0}:null],children:[(0,T.jsx)(v.default,{style:Z.mobileMarker,onPress:()=>l(e),children:(0,T.jsx)(x.default,{style:[Z.markerContainer,{backgroundColor:e.color}],children:(0,T.jsx)($.default,{name:e.icon,size:24,color:"white"})})}),(0,T.jsx)(C.default,{style:Z.mobileMilestoneTitle,children:e.title}),t<s.length-1&&(0,T.jsx)(x.default,{style:Z.mobileDashedLine})]},e.id)))}):(0,T.jsxs)(x.default,{style:Z.webContainer,children:[(0,T.jsx)(x.default,{style:[Z.dashedLine,{width:"80%",left:"10%"}]}),s.map(((e,t)=>(0,T.jsxs)(v.default,{style:[Z.webMarker,{left:"".concat(10+t*(80/(s.length-1)),"%")}],onPress:()=>l(e),children:[(0,T.jsx)(x.default,{style:[Z.markerContainer,{backgroundColor:e.color}],children:(0,T.jsx)($.default,{name:e.icon,size:24,color:"white"})}),(0,T.jsx)(C.default,{style:Z.webMilestoneTitle,children:e.title})]},e.id)))]}),(0,T.jsx)(A.default,{visible:o,transparent:!0,animationType:"fade",onRequestClose:()=>a(!1),children:(0,T.jsx)(x.default,{style:Z.modalOverlay,children:(0,T.jsx)(x.default,{style:Z.modalContent,children:e&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)(x.default,{style:[Z.modalIconContainer,{backgroundColor:e.color}],children:[(0,T.jsx)(C.default,{style:Z.modalNumber,children:e.number}),(0,T.jsx)($.default,{name:e.icon,size:40,color:"white"})]}),(0,T.jsx)(C.default,{style:Z.modalTitle,children:e.title}),(0,T.jsx)(C.default,{style:Z.modalDescription,children:e.description}),(0,T.jsx)(v.default,{style:[Z.closeButton,{backgroundColor:e.color}],onPress:()=>a(!1),children:(0,T.jsx)(C.default,{style:Z.closeButtonText,children:"Close"})})]})})})})]})};var Q=o(52622),X=o(97584),ee=o(19149);const te="Pending Initial Professional Changes",oe="Pending Professional Changes",ne="Pending Owner Approval",ae="Confirmed",re="Confirmed Pending Professional Changes",ie="Denied",se="Cancelled",le="All Services",de=[le,"Overnight Cat Sitting (Owner's Home)","Cat Boarding","Drop-In Visits (30 min)","Drop-In Visits (60 min)","Dog Walking","Doggy Day Care","Pet Boarding","Exotic Pet Care","Daytime Pet Sitting","Ferrier"],ce=["15 Min","30 Min","45 Min","1 Hour","2 Hour","3 Hour","4 Hour","5 Hour","6 Hour","7 Hour","8 Hour","24 Hour","Per Day","Per Visit","Week"],ue={"Per Visit":"Per Visit","Per Day (24 Hours)":"Per Day","Per Night":"Per Night","Every 15 Minutes":"15 Min","Every 30 Minutes":"30 Min","Every 45 Minutes":"45 Min","Per Hour":"1 Hour","Every 2 Hours":"2 Hour","Every 3 Hours":"3 Hour","Every 4 Hours":"4 Hour","Every 5 Hours":"5 Hour","Every 6 Hours":"6 Hour","Every 7 Hours":"7 Hour","Every 8 Hours":"8 Hour","Per Week":"Week"},me=Object.entries(ue).reduce(((e,[t,o])=>(e[o]=t,e)),{}),ge={"Fish Tank Cleaning":[{title:"Extended Stay (7+ days)",amount:15},{title:"Pickup/Dropoff Service",amount:25},{title:"Special Diet Handling",amount:10},{title:"Medication Administration",amount:15}],Ferrier:[{title:"Extended Hours",amount:20},{title:"Training Session",amount:30},{title:"Grooming",amount:25}],"Dog Walking":[{title:"Extra 15 Minutes",amount:10},{title:"Plant Watering",amount:5},{title:"Photo Updates",amount:5}],"Reptile Boarding & Habitat Maintenance":[{title:"Plant Watering",amount:10},{title:"Mail Collection",amount:5},{title:"Extended Visit (4+ hrs)",amount:30}],"Bird Feeding":[{title:"Extra 15 Minutes",amount:10},{title:"Multiple Route Options",amount:5},{title:"Training During Walk",amount:20}]},he=[{id:1,name:"Fish Tank Cleaning",startingPrice:25,animalTypes:["Fish"],icon:"fish",additionalRates:ge["Fish Tank Cleaning"]},{id:2,name:"Ferrier",startingPrice:30,animalTypes:["Dogs"],icon:"horse",additionalRates:ge.Ferrier},{id:3,name:"Dog Walking",startingPrice:40,animalTypes:["Dogs"],icon:"dog",additionalRates:ge["Dog Walking"]},{id:4,name:"Reptile Boarding & Habitat Maintenance",startingPrice:35,animalTypes:["Reptiles"],icon:"snake",additionalRates:ge["Reptile Boarding & Habitat Maintenance"]},{id:5,name:"Bird Feeding",startingPrice:45,animalTypes:["Birds"],icon:"bird",additionalRates:ge["Bird Feeding"]}],fe=[{id:"1",name:"Max",animal_type:"Dog",breed:"border collie",age:{months:0,years:5},weight:32,sex:"Male",friendlyWithChildren:!0,friendlyWithCats:!1,friendlyWithDogs:!0,spayedNeutered:!0,houseTrained:!0,microchipped:!0,adoptionDate:"2020-01-15",description:"Loves to play fetch and go for walks.",energyLevel:"High",feedingSchedule:"Morning",leftAlone:"1-4 hours",medication:null,additionalInstructions:"Needs daily exercise.",vetName:"Dr. Smith",vetAddress:"123 Vet St.",vetPhone:"555-1234",insuranceProvider:"Pet Insurance Co.",vetDocuments:[],galleryImages:[]},{id:"2",name:"Whiskers",animal_type:"Cat",breed:"tammy ammy",age:{months:3,years:4},weight:16,sex:"Female",friendlyWithChildren:!0,friendlyWithCats:!0,friendlyWithDogs:!1,spayedNeutered:!0,houseTrained:!0,microchipped:!1,adoptionDate:"2019-05-20",description:"Enjoys lounging in the sun.",energyLevel:"Low",feedingSchedule:"Twice a day",leftAlone:"4-8 hours",medication:null,additionalInstructions:"Prefers quiet environments.",vetName:"Dr. Jones",vetAddress:"456 Vet Ave.",vetPhone:"555-5678",insuranceProvider:"Pet Health Insurance",vetDocuments:[],galleryImages:[]},{id:"3",name:"Buddy",animal_type:"snake",breed:"leopard gecko",age:{months:0,years:2},weight:1,sex:"Male",friendlyWithChildren:!1,friendlyWithCats:!1,friendlyWithDogs:!1,spayedNeutered:!1,houseTrained:!1,microchipped:!1,adoptionDate:"2021-08-10",description:"A calm and quiet pet.",energyLevel:"Low",feedingSchedule:["Custom","3 times a day with liquid food."],leftAlone:"Can be left alone indefinitely",medication:null,additionalInstructions:"Keep in a warm environment.",vetName:"Dr. Green",vetAddress:"789 Vet Blvd.",vetPhone:"555-9012",insuranceProvider:"Reptile Insurance Co.",vetDocuments:[],galleryImages:[]}],pe=(o(81029),o(53198),o(52695),o(30552),o(51681),o(10602),o(26163),o(244),o(21373),o(24289),[{id:"1",name:"Alice Johnson",pet_types:["Dog","Cat"],last_booking:"2024-01-15",pets:["1","2"],email:"alice@example.com",phone:"555-0101",address:"123 Pine St, Colorado Springs, CO"},{id:"2",name:"Bob Wilson",pet_types:["Dog"],last_booking:"2024-02-01",pets:["3"],email:"bob@example.com",phone:"555-0102",address:"456 Oak Ave, Colorado Springs, CO"},{id:"3",name:"Carol Martinez",pet_types:["Cat","Exotic"],last_booking:"2024-01-28",pets:["4","5"],email:"carol@example.com",phone:"555-0103",address:"789 Maple Dr, Colorado Springs, CO"},{id:"4",name:"David Brown",pet_types:["Dog"],last_booking:"2024-02-05",pets:["6"],email:"david@example.com",phone:"555-0104",address:"321 Elm St, Colorado Springs, CO"},{id:"5",name:"Eva Garcia",pet_types:["Exotic"],last_booking:"2024-01-20",pets:["7"],email:"eva@example.com",phone:"555-0105",address:"654 Birch Ln, Colorado Springs, CO"}]),ye={booking_id:"bk1",status:"Confirmed",owner_name:"matt aertker",professional_name:"matt2 aertker2",service_details:{service_type:"Ferrier"},pets:[{pet_id:3,name:"Jack",species:"DOG",breed:"Golden"}],occurrences:[{occurrence_id:10,start_date:"2025-02-01",end_date:"2025-02-02",start_time:"15:06",end_time:"16:06",calculated_cost:"61.04",base_total:"$26.04",rates:{base_rate:"25.00",additional_animal_rate:"5.00",additional_animal_rate_applies:!1,applies_after:2,unit_of_time:"PER_DAY",holiday_rate:"35.00",holiday_days:0,additional_rates:[{title:"Extra Travel Time Rate",description:"Far Drive rate for service",amount:"$25.00"},{title:"Dog Poops Inside Rate",description:"Dog Poops Inside rate for service",amount:"$5.00"},{title:"Dog Separation rate",description:"When we need to separate the dog from other animals in the house",amount:"$5.00"}]}},{occurrence_id:9,start_date:"2025-03-13",end_date:"2025-03-14",start_time:"09:00",end_time:"14:00",calculated_cost:"120.08",base_total:"$35.04",rates:{base_rate:"29.00",additional_animal_rate:"8.00",additional_animal_rate_applies:!1,applies_after:1,unit_of_time:"PER_DAY",holiday_rate:"40.00",holiday_days:0,additional_rates:[{title:"Extra Travel Time Rate",description:"Far Drive rate for service",amount:"$25.00"},{title:"Dog Poops Inside Rate",description:"Dog Poops Inside rate for service",amount:"$25.00"},{title:"Dog Separation rate",description:"When we need to separate the dog from other animals in the house",amount:"$35.04"}]}}],cost_summary:{subtotal:181.12,platform_fee:18.11,taxes:15.94,total_owner_cost:215.17,total_sitter_payout:163.01,is_prorated:!0}},be={1234:Object.assign({},ye,{id:"1234",ownerName:"John Doe",status:ae,startDate:"2024-02-20",startTime:"14:00"}),5678:Object.assign({},ye,{id:"5678",ownerName:"Margarett Laporte",status:se,startDate:"2024-02-21",startTime:"15:30"}),56782:Object.assign({},ye,{id:"56782",ownerName:"Zoe Aerial",status:ie,startDate:"2024-02-21",startTime:"15:30"}),5673:Object.assign({},ye,{id:"5673",ownerName:"Matt Clark",status:te,startDate:"2024-02-21",startTime:"15:30"}),5674:Object.assign({},ye,{id:"5674",ownerName:"Mark Smith",status:ne,startDate:"2024-02-21",startTime:"15:30"}),5675:Object.assign({},ye,{id:"5675",ownerName:"Lauren Smith",status:oe,startDate:"2024-02-21",startTime:"15:30"}),5675:Object.assign({},ye,{id:"56712",ownerName:"Matt Smith",status:re,startDate:"2024-02-21",startTime:"15:30"}),56713:Object.assign({},ye,{id:"567123",ownerName:"Albert Einstein",status:te,startDate:"2025-02-21",startTime:"15:30"}),3749:Object.assign({},ye,{id:"567132",ownerName:"Dr. Mike Johnson",status:te,startDate:"2025-02-21",startTime:"15:30"}),91011:Object.assign({},ye,{id:"91011",ownerName:"Dr. Bla Johnson",status:te,startDate:"2025-02-21",startTime:"15:30"}),91012:Object.assign({},ye,{id:"91012",ownerName:"Dr. Blabla Johnson",status:te,startDate:"2025-02-21",startTime:"15:30"})},xe=(Object.values(be).map((e=>({id:e.id,ownerName:e.ownerName,status:e.status,date:e.startDate,time:e.startTime,serviceType:e.serviceType,numberOfPets:e.numberOfPets||1,totalCost:e.costs?.totalOwnerCost||0,professionalPayout:e.costs?.professionalPayout||0}))),101),Ce=[{id:"conv_1",participant1_id:xe,participant2_id:202,name:"Dr. Sarah Smith",role_map:{participant1_role:"owner",participant2_role:"professional"},lastMessage:"I'd be happy to help! What kind of pet do you have?",timestamp:"2024-02-21T07:05:00Z",unread:!1},{id:"conv_2",participant1_id:303,participant2_id:xe,name:"Dr. Mike Johnson",role_map:{participant1_role:"owner",participant2_role:"professional"},lastMessage:"I'm available! Let's set up a booking",timestamp:"2024-02-21T15:35:00Z",unread:!1},{id:"conv_3",participant1_id:xe,participant2_id:204,name:"Dr. Emily Wilson",role_map:{participant1_role:"owner",participant2_role:"professional"},lastMessage:"Your cat's checkup is scheduled",timestamp:"2024-02-20T10:15:00Z",unread:!0},{id:"conv_4",participant1_id:xe,participant2_id:205,name:"Dr. James Anderson",role_map:{participant1_role:"owner",participant2_role:"professional"},lastMessage:"See you tomorrow at 2 PM",timestamp:"2024-02-19T16:45:00Z",unread:!1},{id:"conv_5",participant1_id:xe,participant2_id:206,name:"Dr. Lisa Brown",role_map:{participant1_role:"owner",participant2_role:"professional"},lastMessage:"How is Max doing today?",timestamp:"2024-02-18T09:30:00Z",unread:!1},{id:"conv_6",participant1_id:xe,participant2_id:207,name:"Dr. Robert Taylor",role_map:{participant1_role:"owner",participant2_role:"professional"},lastMessage:"The medication has been prescribed",timestamp:"2024-02-17T14:20:00Z",unread:!1},{id:"conv_7",participant1_id:xe,participant2_id:208,name:"Dr. Maria Garcia",role_map:{participant1_role:"owner",participant2_role:"professional"},lastMessage:"Your appointment is confirmed",timestamp:"2024-02-16T11:25:00Z",unread:!0},{id:"conv_8",participant1_id:xe,participant2_id:209,name:"Dr. David Lee",role_map:{participant1_role:"owner",participant2_role:"professional"},lastMessage:"Let's schedule a follow-up",timestamp:"2024-02-15T13:40:00Z",unread:!1},{id:"conv_9",participant1_id:xe,participant2_id:210,name:"Dr. Sarah Martinez",role_map:{participant1_role:"owner",participant2_role:"professional"},lastMessage:"The test results are ready",timestamp:"2024-02-14T15:55:00Z",unread:!1},{id:"conv_10",participant1_id:xe,participant2_id:211,name:"Dr. John White",role_map:{participant1_role:"owner",participant2_role:"professional"},lastMessage:"How's the new diet working?",timestamp:"2024-02-13T08:15:00Z",unread:!1},{id:"conv_11",participant1_id:xe,participant2_id:212,name:"Dr. Anna Clark",role_map:{participant1_role:"owner",participant2_role:"professional"},lastMessage:"Vaccination reminder",timestamp:"2024-02-12T10:30:00Z",unread:!0},{id:"conv_12",participant1_id:xe,participant2_id:213,name:"Dr. Thomas Wright",role_map:{participant1_role:"owner",participant2_role:"professional"},lastMessage:"Surgery scheduled for next week",timestamp:"2024-02-11T12:45:00Z",unread:!1},{id:"conv_13",participant1_id:xe,participant2_id:214,name:"Dr. Patricia Moore",role_map:{participant1_role:"owner",participant2_role:"professional"},lastMessage:"Emergency consultation available",timestamp:"2024-02-10T17:20:00Z",unread:!1},{id:"conv_14",participant1_id:xe,participant2_id:215,name:"Dr. Kevin Hall",role_map:{participant1_role:"owner",participant2_role:"professional"},lastMessage:"Treatment plan updated",timestamp:"2024-02-09T14:10:00Z",unread:!1},{id:"conv_15",participant1_id:xe,participant2_id:216,name:"Dr. Rachel Green",role_map:{participant1_role:"owner",participant2_role:"professional"},lastMessage:"Prescription ready for pickup",timestamp:"2024-02-08T16:35:00Z",unread:!0}],ve={conv_1:[{message_id:1,participant1_id:xe,participant2_id:202,sender:xe,role_map:{participant1_role:"owner",participant2_role:"professional"},content:"Hi, I'm interested in your pet sitting services",timestamp:"2024-02-21T14:00:00Z",booking_id:null,status:"read",is_booking_request:!1,metadata:{}},{message_id:2,participant1_id:xe,participant2_id:202,sender:202,role_map:{participant1_role:"owner",participant2_role:"professional"},content:"I'd be happy to help! What kind of pet do you have?",timestamp:"2024-02-21T14:05:00Z",booking_id:null,status:"sent",is_booking_request:!1,metadata:{}}],conv_2:[{message_id:3,participant1_id:303,participant2_id:xe,sender:303,role_map:{participant1_role:"owner",participant2_role:"professional"},content:"Looking for a dog walker next week",timestamp:"2024-02-21T15:30:00Z",booking_id:null,status:"read",is_booking_request:!1,metadata:{}},{message_id:4,participant1_id:303,participant2_id:xe,sender:303,role_map:{participant1_role:"owner",participant2_role:"professional"},type:"booking_request",data:{serviceType:"Dog Walking",pets:[{id:"1",name:"Max",type:"Dog",breed:"Golden Retriever"}],occurrences:[{startDate:"2024-02-28",endDate:"2024-02-28",startTime:"14:00",endTime:"15:00"}]},timestamp:"2024-02-21T15:35:00Z",status:"sent",is_booking_request:!0,metadata:{}},{message_id:5,participant1_id:303,participant2_id:xe,sender:xe,role_map:{participant1_role:"owner",participant2_role:"professional"},content:"I'll take a look!",timestamp:"2024-02-21T15:30:00Z",booking_id:null,status:"read",is_booking_request:!1,metadata:{}}]},we=[{id:"blog_1",title:"What Your Dog is Really Saying",author:{id:"author_1",name:"Zoe Neale",profilePicture:o(58162),bio:"Professional dog trainer and animal behavior specialist with over 10 years of experience."},publishDate:"2024-02-22",readTime:"8 min",tags:["Dogs","Behavior","Training","Pet Care"],content:"You know that moment when your dog tilts their head at you like you just asked them to solve a calculus problem? Turns out, they're not the only ones trying to understand you\u2014they've been communicating with you this whole time, and you probably didn't even realize it.\n\nDogs may not speak English (yet\u2014give them time), but they have an entire language built on tail wags, ear positions, and those big, soulful eyes they use to manipulate you into giving them extra treats. Learning to read their body language isn't just a party trick\u2014it can help prevent stress, deepen your bond, and maybe even stop your dog from embarrassing you at the dog park. So, let's finally crack the code on what your dog has been trying to tell you.\n\nTail Wagging: Not Always a Sign of Happiness\nOne of the biggest myths out there is that a wagging tail means a happy dog. Nope. Not always. A dog's tail is basically their mood ring, and the way they wag tells a whole different story.\nLoose, full-body wag (with bonus butt wiggles): This is the classic \"OMG YOU'RE HOME!!\" happy dance. A+ vibes.\nSlow wag, tail held high: The \"I'm analyzing this situation\" wag. Suspicious, calculating, possibly deciding if you're worth their energy.\nStiff, fast wag with a raised tail: Yikes. This is \"I'm on edge, don't mess with me\" energy. Proceed with caution.\nLow, fast wag: \"I'm nervous, and I don't know what's happening, so I'm just gonna keep wiggling and hope for the best.\"\nTucked tail: Fear. If the tail is all the way tucked under, your dog is basically saying, \"I regret everything, please don't yell at me.\"\nEven the direction of the wag matters\u2014researchers found that dogs wag more to the right when they're happy and to the left when they're unsure or stressed (Quaranta et al., 2007). Yes, your dog's tail literally has anxiety tells.\n\nEars and Eyes: The Silent Storytellers\nDogs don't just talk with their tails\u2014they also use their ears and eyes like tiny, furry actors in a silent film.\nSoft eyes, relaxed ears: Your dog is living their best life. No stress, just vibes.\nWide eyes, whites showing (a.k.a. \"whale eye\"): \"I am uncomfortable with the energy we have created in this room.\" This is a warning sign\u2014your dog feels uneasy or trapped.\nPerked-up ears: \"I heard something, and I will investigate.\" Could be excitement, curiosity, or them preparing to bark at absolutely nothing.\nEars pinned back: \"I'm nervous\" or \"I did something bad, and I hope you don't notice.\" Classic guilty dog move.\nEver notice how some dogs do a little squint when they're happy? It's their version of a smile. On the flip side, prolonged direct eye contact\u2014especially with an unfamiliar dog\u2014can be a challenge. So, if you're having a staring contest with a dog you just met\u2026maybe don't.\n\nThe Freeze: When Your Dog Hits Pause (And You Should Pay Attention)\nIf a dog suddenly stops moving and stiffens, pay attention. Freezing is often their last warning before things escalate to growling, snapping, or biting. A lot of people miss this and then wonder why their dog \"suddenly\" lashed out.\nYou might see this when:\nA child is hugging a dog (which, fun fact, most dogs hate).\nSomeone is petting a dog too aggressively.\nThe dog feels cornered and has no escape route.\nResearch by Rooney Clark and Casey (2016) helped show that when a dog freezes, in some way or another they are stressed, its best to give them space in that moment and take a mental note of your newest training goal! Sometimes, they just need a minute to de-escalate, like when you have to breathe through a customer service call that's not going well.\n\nMouth Matters: Smiles vs. Stress\nDogs can technically smile, but it's not always what you think.\nLoose, open mouth, tongue hanging out: Happy, relaxed, living their best life.\nClosed mouth, tight lips: Alert or unsure. They're analyzing the situation.\nLips pulled back, slight teeth showing: Some dogs do a \"submissive grin,\" which isn't aggression\u2014it's their way of saying, \"Hey, I'm friendly!\"\nWrinkled nose, full teeth bared: This is aggression. Back off.\nExcessive yawning in a new situation: Dogs don't just yawn when they're tired\u2014they also yawn when they're stressed. To put it simply, they are overstimulated. (Glenk, 2020) Don't be fooled by the parrot dog, sometimes they yawn because they saw you yawn first! (D'Aniello, 2019)\n\nConclusion: Your Dog Has Been Sending You Texts\u2014Now You Can Finally Read Them\nDogs may not be able to talk (yet), but they've been communicating loud and clear this whole time. That tail wag? Could be excitement, could be stress. That little squint? Doggy love. The full-body freeze? That's a big ol' \"DO NOT DISTURB\" sign.\nThe more you pay attention, the better you'll understand your dog\u2014and the fewer awkward misunderstandings you'll have (like mistaking a stress yawn for a nap cue). As we said in the beginning, your dog already knows exactly how to read you. They know your routine, when you're about to leave the house, and how to guilt-trip you into sharing your snacks. The least you can do is return the favor.\nSo next time your dog gives you the side-eye, perks their ears, or flops over dramatically after a single walk, you'll finally know what they're saying. And let's be honest\u2014it's probably, \"I love you\u2026 now give me a treat.\"",references:[{title:"7 tips for canine body language",authors:"American Society for the Prevention of Cruelty to Animals (ASPCA)",publication:"ASPCApro",url:"https://www.aspcapro.org/resource/7-tips-canine-body-language"},{title:"Therapy dogs' salivary cortisol levels vary during animal-assisted interventions",authors:"Glenk, L. M., Kothgassner, O. D., Stetina, B. U., Palme, R., & Kepplinger, B.",publication:"Frontiers in Veterinary Science",year:2020,doi:"10.3389/fvets.2020.564201"},{title:"The importance of associative learning in cross-species social bonding: Dogs and humans",authors:"D'Aniello, B., Scandurra, A., Alterisio, A., Aria, M., & Siniscalchi, M.",publication:"Frontiers in Psychology",year:2019,doi:"10.3389/fpsyg.2019.01678"},{title:"Oxytocin-gaze positive loop and the coevolution of human-dog bonds",authors:"Nagasawa, M., Mitsui, S., En, S., Ohtani, N., Ohta, M., Sakuma, Y., Onaka, T., Mogi, K., & Kikusui, T.",publication:"Science",year:2015,doi:"10.1126/science.1261022"},{title:"Asymmetric tail-wagging responses by dogs to different emotive stimuli",authors:"Quaranta, A., Siniscalchi, M., & Vallortigara, G.",publication:"Current Biology",year:2007,doi:"10.1016/j.cub.2007.02.008"},{title:"Minimizing fear and anxiety in working dogs: A review",authors:"Rooney, N. J., Clark, C. C. A., & Casey, R. A.",publication:"Journal of Veterinary Behavior",year:2016,doi:"10.1016/j.jveb.2016.11.001"}],likes:245,comments:56,shares:89},{id:"blog_2",title:"What Your Cat is Really Saying",author:{id:"author_2",name:"Zoe Neale",profilePicture:o(58162),bio:"Feline behavior specialist and veterinarian with a focus on cat-human relationships."},publishDate:"2024-02-23",readTime:"7 min",tags:["Cats","Behavior","Pet Care","Communication"],content:"Ever wonder why your cat stares at you before slowly blinking or why they randomly sprint across the house at 2 AM? While cats may seem mysterious, they actually have a complex system of communication\u2014if you know what to look for. Unlike dogs, who wear their emotions on their tails (literally), cats are more subtle. But once you learn their signals, you'll start to see what your cat has been trying to tell you all along.\n\nThe Myth of the Aloof Cat: Do They Actually Care About You?\nMany people think cats are independent and don't bond with their owners the way dogs do. But research suggests otherwise. A study by Vitale et al. (2019) found that cats form secure attachments to their owners, much like infants do with their caregivers. In an experiment where cats were briefly separated from their owners, many showed signs of distress when left alone and relief upon their owner's return. So yes, your cat does care about you\u2014they just have their own way of showing it.\n\nThe Slow Blink: A Feline \"I Love You\"\nOne of the best-kept secrets of cat communication is the slow blink. If your cat locks eyes with you and then slowly closes and opens their eyes, congratulations! You've just received a cat's version of a smile. Research completed in 2020 (Humphrey) found that when humans slowly blink at their cats, the cats are more likely to return the gesture and approach them in a friendly manner. So, next time you want to say \"I love you\" to your cat, skip the baby talk and try a slow blink instead.\n\nTail Talk: Not Just for Dogs\nA cat's tail is like a built-in mood ring. Learning to read tail signals can help you avoid scratches and strengthen your bond.\nTail up, tip curved: A friendly, confident cat greeting. If your cat walks toward you with their tail high, they're happy to see you.\nPuffed-up tail: This is a defensive reaction. Your cat is startled or feels threatened.\nLow, slow-wagging tail: Unlike dogs, a slow-wagging cat tail isn't a good sign\u2014it often signals irritation or mild aggression.\nTail wrapped around you or another cat: This is a sign of affection, almost like holding hands.\n\nPurring: More Than Just Happiness\nEveryone loves the soothing sound of a purring cat, but did you know cats don't just purr when they're happy? While contentment is a common reason, studies suggest cats also purr when they're stressed, in pain, or even trying to heal themselves. The frequency of cat purrs (between 25 and 150 Hz) has been linked to tissue regeneration and bone healing in studies on vibrational therapy (Muggenthaler, 2001). So, if your cat is purring at the vet's office, they may not be enjoying themselves\u2014they might just be self-soothing.\n\nHeadbutting and Kneading: Strange but Sweet Gestures\nHeadbutting (bunting): When your cat gently bumps their head against you, they're not just being cute\u2014they're marking you with their scent glands, claiming you as their own (Rodan, 2015).\nKneading: The rhythmic pressing of paws against a soft surface (or your lap) is a behavior kittens use to stimulate milk flow. In adult cats, it's a sign of comfort and contentment (Brown & Bradshaw, 2016).\n\nDo Cats Really Ignore Their Names?\nIf you've ever called your cat and been met with a flick of the ear but no movement, you might think they don't recognize their name. But research says otherwise. A study by Saito & Shinozuka (2013) found that cats can distinguish their names from other words, even in a household with multiple cats. They just don't always feel the need to respond. Unlike dogs, who evolved to seek human approval, cats evolved as solitary hunters. They hear you\u2014they're just deciding whether you're worth getting up for.\n\nThe Zoomies: Science Behind the 2 AM Sprints\nThose sudden, chaotic bursts of energy\u2014also known as \"zoomies\"\u2014are actually a by normal part of feline behavior. Cats are natural hunters, and their instincts tell them to be most active at dawn and dusk. If your cat has zoomies at odd hours, they might just be burning off excess energy. Providing interactive play during the day can help prevent nighttime sprints (Turner, 2021).\n\nConclusion: The More You Watch, the More You Understand\nCats may seem mysterious, but once you learn their language, they're basically tiny, furry drama queens with very specific ways of expressing love (and judgment). That slow blink? A kiss. That tail flick? A warning. The 2 AM zoomies? Either pent-up energy or an exorcism\u2014we may never know.\n\nThe more you pay attention to their signals, the better you'll understand them. And honestly your cat already understands you. They know exactly how to guilt-trip you into giving extra treats, how to wake you up precisely one minute before your alarm, and how to act like they don't care\u2014right before curling up in your lap.\n\nAt the end of the day, cats aren't ignoring us. They're just selectively participating. And now that you can read their signals, you're officially part of their very exclusive club.",references:[{title:"Communication in the domestic cat: within- and between-species",authors:"Brown, S. L., & Bradshaw, J. W. S.",publication:"Animal Behaviour",year:2016,doi:"10.1016/j.anbehav.2016.05.015"},{title:"Feline Behavioral Health and Welfare",authors:"Rodan, I., & Heath, S.",publication:"Elsevier Health Sciences",year:2015},{title:"The felid purr: A healing mechanism?",authors:"Muggenthaler, E. von.",publication:"Proceedings of the 12th International Conference on Low Frequency Noise and Vibration",year:2001,url:"https://www.researchgate.net/publication/272259095_The_felid_purr_A_healing_mechanism"},{title:"Vocal recognition of owners by domestic cats (Felis catus)",authors:"Saito, A., & Shinozuka, K.",publication:"Animal Cognition",year:2013,doi:"10.1007/s10071-013-0620-4"},{title:"The mechanics of social interactions between cats and their owners",authors:"Turner, D. C.",publication:"Frontiers in Veterinary Science",year:2021,doi:"10.3389/fvets.2021.650143"},{title:"Attachment bonds between domestic cats and humans",authors:"Vitale, K. R., Behnke, A. C., & Udell, M. A. R.",publication:"Current Biology",year:2019,doi:"10.1016/j.cub.2019.08.036"},{title:"The role of cat eye narrowing movements in cat\u2013human communication",authors:"Humphrey, T., Proops, L., & McComb, K.",publication:"Scientific Reports",year:2020,doi:"10.1038/s41598-020-73426-0"}],likes:312,comments:78,shares:102},{id:"blog_3",title:"What Your Bird is Really Saying",author:{id:"author_3",name:"Zoe Neale",profilePicture:o(58162),bio:"Avian specialist and researcher focusing on bird behavior and communication."},publishDate:"2024-02-24",readTime:"6 min",tags:["Birds","Behavior","Pet Care","Avian Communication"],content:"Ever look at your bird and think, What's going on in that tiny dinosaur brain of yours? Well, good news\u2014birds may not text, but they do have an entire language made up of wing flutters, tail flicks, and the occasional judgmental stare. And if you learn to read these signals, you'll finally understand what your feathered friend has been trying to tell you all along.\n\nLet's break down the mysterious world of bird body language so you can stop guessing and start actually communicating with your avian BFF.\n\nThe Head Tilt: Curious or Plotting Something?\nThat adorable head tilt your bird does isn't just to make you go aww\u2014it's actually their way of getting a better look at something. Birds process images differently than we do, so when they tilt their head, they're adjusting their angle to see more clearly (Massen et al., 2014).\n\nSlow, curious head tilt: They're interested in what's happening and trying to analyze the situation. Basically, they're bird detectives.\nFrequent or extreme tilting: Could indicate a vision issue or neurological problem\u2014if it looks excessive, a vet visit is a good idea (Massen et al., 2014).\nOne-eye stare, body stiffened: A sign they're feeling cautious or potentially threatened. If they were a human, this would be the equivalent of side-eye.\n\nFeather Fluffing: Cozy or Cranky?\nFeather movements say a lot about how a bird is feeling. Think of them as mood indicators, kind of like how we use facial expressions\u2014except, you know, with more feathers.\n\nFluffed-up feathers for a few seconds: Just getting comfortable. If your bird puffs up and then smooths back down, they're basically stretching.\nConstantly fluffed-up feathers: Not good. This can be a sign of illness, stress, or even feeling cold (Massen et al., 2014).\nFeathers sleeked back tight to the body: Your bird is nervous or possibly feeling aggressive. Approach with caution (Pika & Bugnyar, 2011).\n\nThe Wing Flutter: Excitement or Back Off?\nBirds use their wings for way more than just flying\u2014they also use them to communicate. Unfortunately, no sign language because birds dont have thumbs\n\nExcited, quick flutters: Happiness! Your bird is basically doing a little happy dance (Osaka University, 2023).\nSlow, controlled wing movements: This can be a \"stay away\" signal, kind of like putting up a hand to say \"not now.\"\nOne wing slightly drooped: Could be a sign of injury\u2014time to check in with your vet.\n\nBunting: Love, Not a Headbutt Attack\nIf your bird presses or rubs their beak against you, congratulations\u2014they're bunting, which is a sign of affection (Pika & Bugnyar, 2011).\n\nGentle beak rubbing: They're marking you as part of their flock. You're officially theirs now.\nAggressive, sudden beak nudging: Might mean \"Hey, stop that\" or \"Give me attention NOW.\"\n\nThe Stare-Down: Challenge or Trust?\nUnlike with dogs, where prolonged eye contact can be a dominance move, birds love staring at their favorite humans. It's actually a good thing\u2014eye contact helps strengthen bonds (Osaka University, 2023).\n\nSoft, relaxed eyes: A sign of trust and comfort. They're chilling.\nWide eyes with pinning pupils: Intense excitement\u2014or potential aggression. If they suddenly go from relaxed to laser-focused, read the room.\n\nTail Wagging: A Whole Different Story Than Dogs\nIf you thought tail wagging only meant happiness (like with dogs), think again\u2014birds have their own unique tail signals.\n\nFast, side-to-side tail wagging: Happy and excited! Your bird is feeling good.\nSlow, deliberate tail flick: Annoyed or getting ready to give you a warning. Think of this as their way of saying \"I'm this close to losing it.\"\nTail fanned out: Displaying dominance or excitement\u2014this is common in birds like parrots when they're trying to show off.\n\nThe Playful Side: Hanging Upside Down & Wing Spreading\nSome birds (especially parrots) love hanging upside down like little acrobats. This is usually a sign of happiness and playfulness. If your bird does this often, they're feeling safe and confident.\n\nUpside-down hanging: Your bird is comfortable with you and their surroundings. They trust you.\nOne wing slightly lifted while playing: This can be an invitation to interact\u2014kind of like a bird's version of waving at you.\n\nConclusion: Your Bird Has Been Speaking\u2014Now You're Fluent\nBirds may not use words the way we do (unless you have a talkative parrot), but their body language speaks volumes. From fluffed feathers to head tilts and beak bunts, every little movement is a clue to how they're feeling.\n\nThe more you watch and learn, the better you'll understand their unique way of communicating. And let's be real\u2014your bird already knows exactly how to get your attention. Whether it's staring at you until you feel guilty enough to offer a treat or flapping their wings dramatically for no reason, they've got you trained.\n\nNow that you can finally read their signals, you're one step closer to becoming the ultimate bird whisperer. Just don't be surprised if they start giving you even more attitude now that you know what's up.",references:[{title:"Facial display and blushing: Means of visual communication in blue-and-yellow macaws",authors:"Massen, J. J. M., Vermunt, D. A., & Sterck, E. H. M.",publication:"PLoS ONE",year:2014,doi:"10.1371/journal.pone.0108794"},{title:"The use of referential gestures in ravens (Corvus corax) in the wild",authors:"Pika, S., & Bugnyar, T.",publication:"Nature Communications",year:2011,doi:"10.1038/ncomms1567"},{title:'Wild birds gesture "after you" to insist their mate go first',authors:"Osaka University",publication:"Scientific American",year:2023,url:"https://www.scientificamerican.com/article/wild-birds-gesture-after-you-to-insist-their-mate-go-first/"}],likes:198,comments:45,shares:67}],{width:je,height:Se}=j.default.get("window"),Te=[{image:o(81029),text:'"CrittrCove has been amazing for finding reliable pet professionals!',author:"John Smith"},{image:o(53198),text:'"Great experience with pet sitting services!',author:"Jane Doe"},{image:o(52695),text:'"Found the perfect sitter for my exotic pets!',author:"Sudhakar Vuluvala"},{image:o(30552),text:"\"I've had a fantastic experience with CrittrCove's pet grooming services!",author:"Alice Brown"}],Be=({source:e,style:t})=>"web"===a.default.OS?(0,T.jsx)("img",{src:e,style:t,alt:""}):(0,T.jsx)(U.default,{source:e,style:t});const ke=r.default.create({container:{flex:1},contentContainer:{flexGrow:1},heroSection:{height:"web"===a.default.OS?"70vh":.5*Se,justifyContent:"center",alignItems:"center",overflow:"hidden",position:"relative"},heroImage:{width:"100%",height:"100%",position:"absolute"},heroContent:{position:"absolute",justifyContent:"center",alignItems:"center",width:"100%",height:"100%",paddingHorizontal:20},heroText:{fontSize:32,fontWeight:"bold",fontFamily:m.theme.fonts.header.fontFamily,textAlign:"center",color:"white",textShadowColor:"rgba(0, 0, 0, 0.75)",textShadowOffset:{width:-1,height:1},textShadowRadius:10,marginBottom:20},heroSignupButton:{backgroundColor:"white",paddingHorizontal:30,paddingVertical:15,borderRadius:25,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:4,elevation:5},heroSignupButtonText:{fontSize:18,fontWeight:"bold",color:m.theme.colors.primary,fontFamily:m.theme.fonts.regular.fontFamily},section:{padding:20,width:"100%",maxWidth:1200,marginLeft:"auto",marginRight:"auto",alignItems:"center"},sectionTitle:{fontSize:m.theme.fontSizes.largeLarge,fontWeight:"bold",fontFamily:m.theme.fonts.header.fontFamily,marginBottom:10,textAlign:"center",color:"black"},card:{marginBottom:10},appButtons:{flexDirection:"row",justifyContent:"space-around",marginTop:10},appButton:{width:"45%"},reviewsSection:{marginBottom:20},reviewsBackground:{flex:1,justifyContent:"center",alignItems:"center"},reviewsOverlay:{flex:1,justifyContent:"center",alignItems:"center",padding:20},reviewsSubtitle:{fontSize:m.theme.fontSizes.mediumLarge,fontWeight:"bold",color:"black",marginBottom:10,textAlign:"center",width:"100%"},reviewsTitle:{fontSize:m.theme.fontSizes.largeLarge,fontFamily:m.theme.fonts.header.fontFamily,fontWeight:"bold",color:"black",marginBottom:20,textAlign:"center",width:"100%"},reviewsContainer:{width:"100%",maxWidth:1200,marginLeft:"auto",marginRight:"auto",overflowX:"auto",WebkitOverflowScrolling:"touch",msOverflowStyle:"auto",scrollbarWidth:"auto",scrollbarColor:"".concat(m.theme.colors.primary," transparent")},reviewsContent:{flexDirection:"row",minWidth:"min-content",gap:10,padding:20,paddingBottom:40,justifyContent:"center",alignItems:"center"},reviewCard:{width:300,height:200,padding:20,backgroundColor:"white",borderRadius:10,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3,marginRight:10},reviewCardMobile:{width:"100%",height:"100%"},reviewQuote:{fontSize:24,fontWeight:"bold",color:"black",marginBottom:10},reviewText:{fontSize:18,color:"black",fontFamily:m.theme.fonts.regular.fontFamily,marginBottom:15,flex:1},reviewAuthorContainer:{flexDirection:"row",alignItems:"center"},reviewerImage:{width:45,height:60,borderRadius:8,marginRight:10,objectFit:"cover"},reviewAuthorName:{fontSize:16,fontWeight:"bold",color:"black",fontFamily:m.theme.fonts.regular.fontFamily},reviewAuthorTitle:{fontSize:14,color:"#666",fontFamily:m.theme.fonts.regular.fontFamily,marginTop:2},paginationDots:{flexDirection:"row",justifyContent:"center",marginTop:10},paginationDot:{width:10,height:10,borderRadius:5,backgroundColor:"white",margin:5},paginationDotActive:{backgroundColor:"black"},featuresSection:{marginBottom:80,marginTop:20},toggleContainer:{flexDirection:"row",justifyContent:"center",marginBottom:10},toggleButton:{padding:10,backgroundColor:"white",borderWidth:2,borderColor:m.theme.colors.primary},toggleButtonActive:{backgroundColor:m.theme.colors.primary},toggleButtonText:{fontSize:18,fontWeight:"bold",fontFamily:m.theme.fonts.regular.fontFamily},toggleButtonTextActive:{color:m.theme.colors.whiteText,fontFamily:m.theme.fonts.regular.fontFamily},featuresContainer:{flexDirection:"row",justifyContent:"center",alignItems:"center"},featureColumn:{width:g.SCREEN_WIDTH<768?"90%":"100%",maxWidth:600,padding:20,backgroundColor:"white",borderRadius:10,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3},columnTitle:{fontSize:24,fontWeight:"bold",marginBottom:20,color:"black",textAlign:"center",fontFamily:m.theme.fonts.header.fontFamily},featuresList:{width:"100%",fontFamily:m.theme.fonts.header.fontFamily,marginBottom:20},featureItem:{flexDirection:"row",marginBottom:20,alignItems:"flex-start",width:"100%"},featureIconCircle:{width:50,height:50,borderRadius:25,justifyContent:"center",alignItems:"center",marginTop:5},featureIcon:{fontSize:40},featureTitle:{fontSize:m.theme.fontSizes.mediumLarge,fontWeight:"bold",marginBottom:5,color:"black",fontFamily:m.theme.fonts.header.fontFamily},featureText:{fontSize:m.theme.fontSizes.mediumLarge+2,color:"black",lineHeight:22,fontFamily:m.theme.fonts.regular.fontFamily},actionButton:{backgroundColor:"#6A6C51",width:"50%",padding:5,borderRadius:5,alignItems:"center"},buttonContainer:{display:"flex",justifyContent:"center",alignItems:"center"},buttonText:{fontSize:18,fontWeight:"bold",color:"white",fontFamily:m.theme.fonts.regular.fontFamily},blogSection:{marginBottom:20,alignItems:"center"},blogCard:{width:300,backgroundColor:"white",borderRadius:10,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3,padding:15,marginRight:10},authorContainer:{flexDirection:"column"},authorImage:{width:40,height:40,borderRadius:20,marginBottom:10},blogContent:{flex:1},title:{fontSize:18,fontWeight:"bold",marginBottom:8,fontFamily:m.theme.fonts.header.fontFamily},authorInfo:{flexDirection:"row",alignItems:"center",marginBottom:8},authorName:{fontSize:16,fontWeight:"500",fontFamily:m.theme.fonts.regular.fontFamily},dot:{marginHorizontal:4,color:"#666"},readTime:{fontSize:16,color:"#666",fontFamily:m.theme.fonts.regular.fontFamily},preview:{fontSize:16,lineHeight:20,marginBottom:12,color:"#444",fontFamily:m.theme.fonts.regular.fontFamily},tags:{flexDirection:"row",flexWrap:"wrap",marginBottom:12},tag:{paddingHorizontal:8,paddingVertical:4,borderRadius:16,marginRight:8,marginBottom:8},tagText:{fontSize:14,fontWeight:"500",fontFamily:m.theme.fonts.regular.fontFamily},stats:{flexDirection:"row",justifyContent:"flex-start",marginTop:8},stat:{flexDirection:"row",alignItems:"center",marginRight:16},statText:{marginLeft:4,fontSize:14,color:"#666",fontFamily:m.theme.fonts.regular.fontFamily},roadmapSection:{marginBottom:20},roadmapImage:{flex:1,justifyContent:"center",alignItems:"center"},roadmapOverlayText:{fontSize:24,fontWeight:"bold",color:"black"},faqSection:{marginBottom:20},faqItem:{marginBottom:10},faqButton:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"},faqQuestion:{fontSize:16,fontWeight:"bold"},faqToggle:{fontSize:14,color:"gray"},faqAnswer:{fontSize:16},contactSection:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",padding:20},contactContainer:{width:"100%",maxWidth:600},input:{padding:10,marginBottom:10,borderWidth:1,borderColor:"gray",borderRadius:5},footer:{padding:20,backgroundColor:m.theme.colors.primary,alignItems:"center"},socialIconsRow:{flexDirection:"row",justifyContent:"center",marginBottom:15},socialIcon:{marginHorizontal:15,padding:5},footerLinksRow:{flexDirection:"row",justifyContent:"center",flexWrap:"wrap"},footerLink:{color:"white",fontFamily:m.theme.fonts.regular.fontFamily,marginHorizontal:15,textDecorationLine:"underline"},successMessage:{fontSize:18,textAlign:"center",marginTop:10,color:"black",fontFamily:m.theme.fonts.regular.fontFamily},messageInput:{height:100,textAlignVertical:"top",paddingTop:10},disabledButton:{opacity:.7},validationError:{color:"red",fontSize:16,marginTop:-5,marginBottom:10,fontFamily:m.theme.fonts.regular.fontFamily},starsContainer:{flexDirection:"row",alignItems:"center",marginTop:4},starIcon:{marginRight:2},waitlistSection:{marginVertical:20,borderRadius:10},waitlistDescription:{fontSize:18,textAlign:"center",marginBottom:20,color:"black",fontFamily:m.theme.fonts.regular.fontFamily,paddingHorizontal:20,lineHeight:24},waitlistButton:{marginTop:10,width:"80%",maxWidth:300,padding:15},scrollIndicators:{flexDirection:"row",justifyContent:"center",alignItems:"center",marginTop:10,marginBottom:20},scrollIndicatorButton:{padding:10,marginHorizontal:-6},scrollIndicator:{width:8,height:8,borderRadius:4,backgroundColor:m.theme.colors.border,marginHorizontal:4},scrollIndicatorActive:{backgroundColor:m.theme.colors.primary,width:24},scrollHint:{flexDirection:"row",alignItems:"center",justifyContent:"center",paddingVertical:10},scrollHintText:{color:m.theme.colors.primary,marginRight:5,fontSize:m.theme.fontSizes.medium,fontFamily:m.theme.fonts.regular.fontFamily},scrollContainer:{width:"100%",maxWidth:1200,marginLeft:"auto",marginRight:"auto",overflowX:"auto",WebkitOverflowScrolling:"touch",msOverflowStyle:"auto",scrollbarWidth:"auto",scrollbarColor:"".concat(m.theme.colors.primary," transparent")},scrollContent:{flexDirection:"row",minWidth:"min-content",gap:10,padding:20,paddingBottom:40,justifyContent:"center",alignItems:"center"},serviceHighlightsSection:{padding:20,width:"100%",maxWidth:1200,marginLeft:"auto",marginRight:"auto",alignItems:"center"},mainServiceTitle:{fontSize:32,fontWeight:"bold",textAlign:"center",marginBottom:40,color:m.theme.colors.text,fontFamily:m.theme.fonts.header.fontFamily},servicesGrid:{flexWrap:"wrap",justifyContent:"center",gap:20,width:"100%"}});var Ae=o(98587),_e=o(40558),Ie=o(4701),Me=o(63303),De=o(49050),Re=o(47514);r.default.create({floatingButtonContainer:{position:"fixed",bottom:20,left:0,right:0,alignItems:"center",justifyContent:"center",zIndex:9999,backgroundColor:"transparent"},webButton:{position:"fixed",bottom:20,backgroundColor:"transparent"},mobileButton:{position:"fixed",bottom:20,backgroundColor:"transparent",width:"100%"},floatingButton:{backgroundColor:m.theme.colors.primary,borderRadius:25,paddingHorizontal:24,paddingVertical:8,elevation:5,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:3.84,maxWidth:600,minWidth:200},buttonLabel:{fontSize:16,fontWeight:"bold",color:"#fff"}});const Le=r.default.create({wrapper:{backgroundColor:m.theme.colors.background,paddingVertical:12,width:"100%",zIndex:1},container:{flexDirection:"row",alignItems:"center",width:"100%",paddingHorizontal:16,justifyContent:"space-between"},step:{flexDirection:"row",alignItems:"center",zIndex:2},stepCircle:{width:32,height:32,borderRadius:16,backgroundColor:m.theme.colors.surface,alignItems:"center",justifyContent:"center",borderWidth:1,borderColor:m.theme.colors.modernBorder,zIndex:3},activeStepCircle:{backgroundColor:m.theme.colors.mainColors.main,borderColor:m.theme.colors.mainColors.main},completedStepCircle:{backgroundColor:m.theme.colors.mainColors.main,borderColor:m.theme.colors.mainColors.main,opacity:.8},stepNumber:{fontSize:14,color:m.theme.colors.text,opacity:.5},activeStepNumber:{color:m.theme.colors.surface,opacity:1},completedStepNumber:{color:m.theme.colors.surface},stepName:{fontSize:14,color:m.theme.colors.text,opacity:.7,marginLeft:8,whiteSpace:"nowrap"},activeStepName:{color:m.theme.colors.mainColors.main,opacity:1},line:{height:2,backgroundColor:m.theme.colors.border,opacity:.2,flex:1,marginHorizontal:4,zIndex:1},completedLine:{backgroundColor:m.theme.colors.mainColors.main,opacity:1},progressLine:{flex:1,flexDirection:"row",height:2,marginHorizontal:4,zIndex:1},progressFilled:{flex:1,backgroundColor:m.theme.colors.mainColors.main,height:2},progressEmpty:{flex:1,backgroundColor:m.theme.colors.border,opacity:.2,height:2}}),ze=e=>{const{steps:t,currentStep:o,onStepPress:a,style:r}=e,{screenWidth:i,is_DEBUG:s}=(0,n.useContext)(g.AuthContext),l=i>768;s&&(console.log("MBA1234 - Screen width:",i),console.log("MBA1234 - Is desktop:",l),console.log("MBA1234 - Steps:",t),console.log("MBA1234 - Current step:",o));const d=(e,t)=>{const n=t===o,a=t<o;return(0,T.jsxs)(x.default,{style:Le.step,children:[(0,T.jsx)(x.default,{style:[Le.stepCircle,n&&Le.activeStepCircle,a&&Le.completedStepCircle],children:(0,T.jsx)(C.default,{style:[Le.stepNumber,n&&Le.activeStepNumber,a&&Le.completedStepNumber],children:t+1})}),(n||l)&&(0,T.jsx)(C.default,{style:[Le.stepName,n&&Le.activeStepName],children:e})]},"step-".concat(t))};return(0,T.jsx)(x.default,{style:[Le.wrapper,r],children:(0,T.jsx)(x.default,{style:Le.container,children:t.map(((e,a)=>{return(0,T.jsxs)(n.Fragment,{children:[d(e,a),a<t.length-1&&(r=a,r<o?(0,T.jsx)(x.default,{style:[Le.line,Le.completedLine]}):r===o?(0,T.jsxs)(x.default,{style:Le.progressLine,children:[(0,T.jsx)(x.default,{style:Le.progressFilled}),(0,T.jsx)(x.default,{style:Le.progressEmpty})]}):(0,T.jsx)(x.default,{style:Le.line}))]},"step-fragment-".concat(a));var r}))})})};var Pe=o(69574);const Fe=[{id:"all",name:"All",icon:"paw-outline",animalTypes:[]},{id:"farm_animals",name:"Farm Animals",icon:"horse",animalTypes:["Horse","Cow","Sheep","Goat","Pig","Other"]},{id:"domestic",name:"Domestic",icon:"paw",animalTypes:["Dogs","Cats","Birds","Rabbits","Hamsters","Other"]},{id:"reptiles",name:"Reptiles",icon:"snake",animalTypes:["Snake","Lizard","Turtle","Gecko","Chameleon","Other"]},{id:"aquatic",name:"Aquatic",icon:"fish",animalTypes:["Fish","Frog","Newt","Axolotl","Other"]},{id:"invertebrates",name:"Invertebrates",icon:"spider",animalTypes:["Spider","Scorpion","Crab","Snail","Millipede","Other"]}],Oe={Horse:"horse",Cow:"cow",Sheep:"sheep",Goat:"cow",Pig:"pig",Dogs:"dog",Cats:"cat",Birds:"bird",Rabbits:"rabbit",Hamsters:"rodent",Snake:"snake",Lizard:"snake",Turtle:"turtle",Gecko:"snake",Chameleon:"snake",Fish:"fish",Frog:"snake",Newt:"fish",Axolotl:"fish",Spider:"spider",Scorpion:"spider",Crab:"fish",Snail:"snail",Millipede:"bug",Other:"help-circle-outline"},Ee={Horse:"Farm Animals",Cow:"Farm Animals",Sheep:"Farm Animals",Goat:"Farm Animals",Pig:"Farm Animals",Dogs:"Domestic",Cats:"Domestic",Birds:"Domestic",Rabbits:"Domestic",Hamsters:"Domestic",Snake:"Reptiles",Lizard:"Reptiles",Turtle:"Reptiles",Gecko:"Reptiles",Chameleon:"Reptiles",Fish:"Aquatic",Frog:"Aquatic",Newt:"Aquatic",Axolotl:"Aquatic",Spider:"Invertebrates",Scorpion:"Invertebrates",Crab:"Invertebrates",Snail:"Invertebrates",Millipede:"Invertebrates"};Fe[0].animalTypes=(()=>{const e=[];return Fe.forEach((t=>{"all"!==t.id&&t.animalTypes.forEach((t=>{"Other"===t||e.includes(t)||e.push(t)}))})),e})();const We=(e,t=null)=>{if(Oe[e])return Oe[e];if(t){const e=Fe.find((e=>e.id===t));if(e)return e.icon}return"paw"},Ne=({serviceData:e,setServiceData:t})=>{const[o,i]=(0,n.useState)(""),[s,l]=(0,n.useState)(""),[d,c]=(0,n.useState)(j.default.get("window").width);a.default.OS;(0,n.useEffect)((()=>{const e=()=>{c(j.default.get("window").width)};return j.default.addEventListener("change",e),()=>{j.default.removeEventListener&&j.default.removeEventListener("change",e)}}),[]),(0,n.useEffect)((()=>{!s&&Fe.length>1&&l(Fe[1].id),(0,g.debugLog)("MBA456789","CategorySelectionStep received serviceData:",e),e.animalTypes&&e.animalTypes.length>0&&(0,g.debugLog)("MBA456789","Initial animal types in CategorySelectionStep:",e.animalTypes)}),[]);const u=t=>!(!e.animalTypes||!e.animalTypes.length)&&e.animalTypes.some((e=>"string"===typeof e?e===t:"object"===typeof e&&null!==e&&e.name===t)),h=(e,o=null)=>{(0,g.debugLog)("MBA456789","Selecting animal: ".concat(e,", categoryId: ").concat(o)),"Other"!==e?t((t=>{const n=t.animalTypes||[];(0,g.debugLog)("MBA456789","Current animal types before update:",n);const a=n.findIndex((t=>"string"===typeof t?t===e:"object"===typeof t&&null!==t&&t.name===e));if((0,g.debugLog)("MBA456789","Animal ".concat(e," is ").concat(-1!==a?"already selected":"not selected")),-1!==a){const e=[...n];return e.splice(a,1),(0,g.debugLog)("MBA456789","Animal types after removal:",e),Object.assign({},t,{animalTypes:e})}{const a=Ee[e]||"Other";let r=o;if(!r){const e=Fe.find((e=>e.name===a));r=e?e.id:"other"}const i={name:e,categoryId:r,categoryName:a,isCustom:!1};return(0,g.debugLog)("MBA456789","Adding new animal:",i),(0,g.debugLog)("MBA456789","Animal types after addition:",[...n,i]),Object.assign({},t,{animalTypes:[...n,i]})}})):l(o||Fe[1]&&Fe[1].id)},{animalTypes:f}=(()=>{(0,g.debugLog)("MBA456789","Current serviceData.animalTypes:",e.animalTypes);let t=[{name:"Dogs",categoryId:"domestic",categoryName:"Domestic",icon:We("Dogs","domestic")},{name:"Cats",categoryId:"domestic",categoryName:"Domestic",icon:We("Cats","domestic")}];return e.animalTypes&&e.animalTypes.length>0&&e.animalTypes.forEach((e=>{if("object"!==typeof e||!e||!e.name)return;if(e.isCustom||"Dogs"!==e.name&&"Cats"!==e.name){let o=e.categoryId,n=e.categoryName||"Other";if(!o&&n){const e=Fe.find((e=>e.name===n));e&&(o=e.id)}if(!n&&o){const e=Fe.find((e=>e.id===o));e&&(n=e.name)}t.find((t=>t.name===e.name))||((0,g.debugLog)("MBA456789","Adding custom animal to filtered list: ".concat(e.name,", category: ").concat(n)),t.push({name:e.name,categoryId:o,categoryName:n,icon:We(e.name,o),isCustom:!0}))}})),(0,g.debugLog)("MBA456789","Filtered animal types to show:",t),{animalTypes:t,categories:[]}})(),p=r.default.create({container:{flex:1,padding:16},title:{fontSize:24,fontWeight:"600",color:m.theme.colors.text,marginBottom:16,fontFamily:m.theme.fonts.header.fontFamily},subtitle:{fontSize:20,fontWeight:"600",color:m.theme.colors.text,marginTop:24,marginBottom:16,fontFamily:m.theme.fonts.header.fontFamily},instructions:{fontSize:16,color:m.theme.colors.textSecondary,marginBottom:16,fontFamily:m.theme.fonts.regular.fontFamily},animalTypesGrid:{flexDirection:"row",flexWrap:"wrap",gap:16},animalTypeItem:{flex:1,minWidth:"web"===a.default.OS?d<=420?"45%":"30%":"45%",marginBottom:12},animalTypeCard:{borderRadius:12,borderWidth:1,borderColor:m.theme.colors.border,backgroundColor:m.theme.colors.surface,padding:16,height:70,justifyContent:"center"},selectedAnimalCard:{borderColor:m.theme.colors.mainColors.main,backgroundColor:m.theme.colors.mainColors.mainLight},animalTypeRow:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"},animalIconAndName:{flexDirection:"row",alignItems:"center",gap:12},animalTypeName:{fontSize:16,fontWeight:"500",color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},customInputContainer:{marginTop:6,padding:16,borderRadius:12,borderWidth:1,borderColor:m.theme.colors.border,backgroundColor:m.theme.colors.backgroundContrast},customInputTitle:{fontSize:16,fontWeight:"600",color:m.theme.colors.text,marginBottom:12,fontFamily:m.theme.fonts.regular.fontFamily},inputRow:{flexDirection:"row",gap:8,marginBottom:12},textInput:{flex:1,height:48,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:8,paddingHorizontal:12,backgroundColor:m.theme.colors.surface,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},pickerContainer:{flex:1,height:48,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:8,backgroundColor:m.theme.colors.surface,justifyContent:"center"},picker:{height:48,color:m.theme.colors.text},addButton:{backgroundColor:m.theme.colors.mainColors.main,borderRadius:8,paddingVertical:12,paddingHorizontal:16,alignItems:"center"},addButtonText:{color:m.theme.colors.surface,fontSize:16,fontWeight:"600",fontFamily:m.theme.fonts.regular.fontFamily},selectedAnimalsSection:{marginTop:24,marginBottom:16,padding:16,backgroundColor:m.theme.colors.backgroundContrast,borderRadius:12,borderWidth:1,borderColor:m.theme.colors.border},selectedAnimalsTitle:{fontSize:16,fontWeight:"600",color:m.theme.colors.text,marginBottom:12,fontFamily:m.theme.fonts.regular.fontFamily},selectedAnimalsList:{flexDirection:"row",flexWrap:"wrap",gap:8},animalBubble:{flexDirection:"row",alignItems:"center",backgroundColor:m.theme.colors.surface,borderRadius:20,paddingVertical:6,paddingHorizontal:12,borderWidth:1,borderColor:m.theme.colors.border,marginBottom:8,marginRight:8,gap:8},animalBubbleText:{fontSize:14,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},removeAnimalButton:{padding:2}});return(0,T.jsxs)(H.default,{style:p.container,children:[(0,T.jsx)(C.default,{style:p.title,children:"Select Animal Types for Your Service"}),(0,T.jsx)(C.default,{style:p.instructions,children:"Choose the animal types your service will cover. You can select Dogs, Cats, or add custom animals."}),e.animalTypes.length>0&&(0,T.jsxs)(x.default,{style:p.selectedAnimalsSection,children:[(0,T.jsxs)(C.default,{style:p.selectedAnimalsTitle,children:["Selected Animals (",e.animalTypes.length,")"]}),(0,T.jsx)(x.default,{style:p.selectedAnimalsList,children:e.animalTypes.map(((e,t)=>{const o=e.name,n=We(o,e.categoryId);return(0,T.jsxs)(x.default,{style:p.animalBubble,children:[(0,T.jsx)(S.default,{name:n,size:18,color:m.theme.colors.text}),(0,T.jsx)(C.default,{style:p.animalBubbleText,children:o}),(0,T.jsx)(v.default,{onPress:()=>h(o),style:p.removeAnimalButton,children:(0,T.jsx)(S.default,{name:"close-circle",size:16,color:m.theme.colors.text})})]},t)}))})]}),f.length>0?(0,T.jsx)(x.default,{style:p.animalTypesGrid,children:f.filter((e=>"Dogs"===e.name||"Cats"===e.name)).map((e=>(0,T.jsx)(x.default,{style:p.animalTypeItem,children:(0,T.jsx)(v.default,{style:[p.animalTypeCard,u(e.name)&&p.selectedAnimalCard],onPress:()=>h(e.name,e.categoryId),children:(0,T.jsxs)(x.default,{style:p.animalTypeRow,children:[(0,T.jsxs)(x.default,{style:p.animalIconAndName,children:[(0,T.jsx)(S.default,{name:e.icon,size:24,color:m.theme.colors.text}),(0,T.jsx)(C.default,{style:p.animalTypeName,children:e.name})]}),u(e.name)&&(0,T.jsx)(S.default,{name:"check-circle",size:24,color:m.theme.colors.mainColors.main})]})})},"".concat(e.categoryId,"-").concat(e.name))))}):null,(0,T.jsxs)(x.default,{style:p.customInputContainer,children:[(0,T.jsx)(C.default,{style:p.customInputTitle,children:"Add a Custom Animal Type"}),(0,T.jsxs)(x.default,{style:p.inputRow,children:[(0,T.jsx)(q.default,{style:p.textInput,placeholder:"Animal Type (e.g. Hamster)",value:o,onChangeText:i,placeholderTextColor:m.theme.colors.placeHolderText}),(0,T.jsx)(x.default,{style:p.pickerContainer,children:"ios"===a.default.OS||"android"===a.default.OS?(0,T.jsx)(Pe.default,{selectedValue:s,style:p.picker,onValueChange:e=>l(e),children:Fe.filter((e=>"all"!==e.id)).map((e=>(0,T.jsx)(Pe.default.Item,{label:e.name,value:e.id},e.id)))}):(0,T.jsx)("select",{value:s,onChange:e=>l(e.target.value),style:p.picker,children:Fe.filter((e=>"all"!==e.id)).map((e=>(0,T.jsx)("option",{value:e.id,children:e.name},e.id)))})})]}),(0,T.jsx)(v.default,{style:p.addButton,onPress:()=>{if(!o.trim())return;let n="Other";if(s){const e=Fe.find((e=>e.id===s));e&&(n=e.name)}if(t((e=>Object.assign({},e,{animalTypes:[...e.animalTypes,{name:o.trim(),categoryId:s||"other",categoryName:n,isCustom:!0}]}))),s){if(!e.generalCategories.some((e=>e.id===s))){const e=Fe.find((e=>e.id===s));e&&t((t=>Object.assign({},t,{generalCategories:[...t.generalCategories,{id:e.id,name:e.name,icon:e.icon}]})))}}i("")},disabled:!o.trim(),children:(0,T.jsx)(C.default,{style:p.addButtonText,children:"Add Animal"})})]})]})};var He=o(74037);const Ue=r.default.create({container:{flex:1,padding:16},title:{fontSize:24,fontWeight:"600",color:m.theme.colors.text,marginBottom:24,fontFamily:m.theme.fonts.regular.fontFamily},inputGroup:{marginBottom:24},label:{fontSize:16,color:m.theme.colors.text,marginBottom:8,fontFamily:m.theme.fonts.regular.fontFamily},input:{borderWidth:1,borderColor:m.theme.colors.border,borderRadius:12,padding:16,fontSize:16,color:m.theme.colors.text,backgroundColor:m.theme.colors.surface,fontFamily:m.theme.fonts.regular.fontFamily},textArea:{height:120,textAlignVertical:"top"},switchContainer:{backgroundColor:m.theme.colors.surface,borderRadius:12,padding:16,flexDirection:"row",alignItems:"center",justifyContent:"space-between",borderWidth:1,borderColor:m.theme.colors.border},switchGroup:{flex:1,marginRight:16},switchLabel:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,marginBottom:4},switchSubLabel:{fontSize:14,color:m.theme.colors.placeHolderText,fontFamily:m.theme.fonts.regular.fontFamily},errorText:{color:m.theme.colors.error,fontSize:14,marginTop:4,fontFamily:m.theme.fonts.regular.fontFamily},characterCount:{color:m.theme.colors.textSecondary,fontSize:12,marginTop:4,textAlign:"right",fontFamily:m.theme.fonts.regular.fontFamily}}),Ve=({serviceData:e,setServiceData:t})=>{const[o,a]=(0,n.useState)(""),[r,i]=(0,n.useState)(""),s=(e,t=!0)=>/^[a-zA-Z0-9\s&\.\-\,!]*$/.test(e)?(t?a(""):i(""),!0):(t?a("Service name can only contain letters, numbers, spaces, &, and !"):i("Description can only contain letters, numbers, spaces, periods, commas, dashes, &, and !"),!1);return(0,T.jsxs)(x.default,{style:Ue.container,children:[(0,T.jsx)(C.default,{style:Ue.title,children:"Service Details"}),(0,T.jsxs)(x.default,{style:Ue.inputGroup,children:[(0,T.jsx)(C.default,{style:Ue.label,children:"Service Name"}),(0,T.jsx)(q.default,{style:Ue.input,value:e.serviceName,onChangeText:e=>{const o=e.slice(0,30);s(o,!0)&&t((e=>Object.assign({},e,{serviceName:o})))},placeholder:"e.g. Premium Pet Grooming",placeholderTextColor:m.theme.colors.placeHolderText,maxLength:30}),(0,T.jsxs)(C.default,{style:Ue.characterCount,children:[e.serviceName.length,"/",30]}),o?(0,T.jsx)(C.default,{style:Ue.errorText,children:o}):null]}),(0,T.jsxs)(x.default,{style:Ue.inputGroup,children:[(0,T.jsx)(C.default,{style:Ue.label,children:"Service Description"}),(0,T.jsx)(q.default,{style:[Ue.input,Ue.textArea],value:e.serviceDescription,onChangeText:e=>{const o=e.slice(0,300);s(o,!1)&&t((e=>Object.assign({},e,{serviceDescription:o})))},placeholder:"Describe your service in detail...",placeholderTextColor:m.theme.colors.placeHolderText,multiline:!0,numberOfLines:6,textAlignVertical:"top",maxLength:300}),(0,T.jsxs)(C.default,{style:Ue.characterCount,children:[e.serviceDescription.length,"/",300]}),r?(0,T.jsx)(C.default,{style:Ue.errorText,children:r}):null]}),(0,T.jsxs)(x.default,{style:Ue.switchContainer,children:[(0,T.jsxs)(x.default,{style:Ue.switchGroup,children:[(0,T.jsx)(C.default,{style:Ue.switchLabel,children:"Overnight Service"}),(0,T.jsx)(C.default,{style:Ue.switchSubLabel,children:"Does this service require overnight stay?"})]}),(0,T.jsx)(He.default,{value:e.isOvernight,onValueChange:e=>{t((t=>Object.assign({},t,{isOvernight:e})))},trackColor:{false:m.theme.colors.border,true:m.theme.colors.mainColors.main},thumbColor:m.theme.colors.surface,ios_backgroundColor:m.theme.colors.border})]})]})};var qe=o(51950);const Ye=Object.keys(ue),Ge=["1","2","3","4","5"],Je=r.default.create({container:{flex:1,padding:16},title:{fontSize:24,fontWeight:"600",color:m.theme.colors.text,marginBottom:24,fontFamily:m.theme.fonts.regular.fontFamily},rateContainer:{marginBottom:24},label:{fontSize:16,color:m.theme.colors.text,marginBottom:8,fontFamily:m.theme.fonts.regular.fontFamily},rateInputGroup:{flexDirection:"row",gap:12},currencyInputContainer:{flex:1,flexDirection:"row",alignItems:"center",borderWidth:1,borderColor:m.theme.colors.border,borderRadius:8,paddingHorizontal:12,backgroundColor:m.theme.colors.surface},currencySymbol:{fontSize:16,color:m.theme.colors.text,marginRight:4,fontFamily:m.theme.fonts.regular.fontFamily},currencyInput:{flex:1,fontSize:16,color:m.theme.colors.text,padding:12,fontFamily:m.theme.fonts.regular.fontFamily,outlineStyle:"none"},unitSelector:{flex:1,flexDirection:"row",alignItems:"center",justifyContent:"space-between",borderWidth:1,borderColor:m.theme.colors.border,borderRadius:8,paddingHorizontal:12,paddingVertical:12,backgroundColor:m.theme.colors.surface},unitText:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},dropdownContainer:{position:"absolute",top:"100%",backgroundColor:m.theme.colors.surface,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:8,marginTop:4,zIndex:1e3,elevation:5,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:3.84,maxHeight:200},dropdownScroll:{width:"100%"},dropdownScrollContent:{flexGrow:1},dropdownItem:{padding:12,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},selectedDropdownItem:{backgroundColor:m.theme.colors.mainColors.mainLight},dropdownText:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},selectedDropdownText:{color:m.theme.colors.mainColors.main,fontWeight:"600"},holidayRateContainer:{marginBottom:24},holidayRateHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:8},rateTypeToggleContainer:{flexDirection:"row",alignItems:"center",overflow:"hidden",borderRadius:8},toggleButton:{paddingVertical:8,paddingHorizontal:14,alignItems:"center",justifyContent:"center",minWidth:40,width:44,height:36},activeToggleButton:{backgroundColor:m.theme.colors.mainColors.main,borderWidth:1,borderColor:m.theme.colors.mainColors.main},inactiveToggleButton:{backgroundColor:m.theme.colors.surface,borderWidth:1,borderColor:m.theme.colors.border},toggleButtonText:{fontSize:16,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"500"},activeToggleText:{color:m.theme.colors.surface,fontWeight:"600"},inactiveToggleText:{color:m.theme.colors.text},holidayRateInputWrapper:{position:"relative"},percentageInputContainer:{flexDirection:"row",alignItems:"center",borderWidth:1,borderColor:m.theme.colors.border,borderRadius:8,paddingHorizontal:12,backgroundColor:m.theme.colors.surface},percentageInput:{flex:1,fontSize:16,color:m.theme.colors.text,padding:12,fontFamily:m.theme.fonts.regular.fontFamily,outlineStyle:"none"},percentageSymbol:{fontSize:16,color:m.theme.colors.text,marginRight:8,fontFamily:m.theme.fonts.regular.fontFamily},calculatedHolidayRate:{position:"absolute",bottom:-24,right:4,fontSize:14,color:m.theme.colors.placeHolderText,fontFamily:m.theme.fonts.regular.fontFamily,paddingTop:4},customRatesContainer:{},customRateItem:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",padding:12,backgroundColor:m.theme.colors.surface,borderRadius:8,marginBottom:8,borderWidth:1,borderColor:m.theme.colors.border},customRateContent:{flex:1,flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginRight:12},customRateActions:{flexDirection:"row",gap:8},customRateTitleContainer:{flex:1,marginRight:16},customRateTitle:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},customRateDescription:{fontSize:14,color:m.theme.colors.placeHolderText,marginTop:2,fontFamily:m.theme.fonts.regular.fontFamily},customRateAmount:{fontSize:16,color:m.theme.colors.text,fontWeight:"600",fontFamily:m.theme.fonts.regular.fontFamily},newCustomRateContainer:{gap:12,marginBottom:16},customRateInput:{borderWidth:1,borderColor:m.theme.colors.border,borderRadius:8,padding:12,fontSize:16,color:m.theme.colors.text,backgroundColor:m.theme.colors.surface,fontFamily:m.theme.fonts.regular.fontFamily,outlineStyle:"none"},textArea:{height:80,textAlignVertical:"top"},addRateButton:{flexDirection:"row",alignItems:"center",gap:8,padding:12,borderWidth:1,borderColor:m.theme.colors.mainColors.main,borderRadius:8,justifyContent:"center"},addRateText:{color:m.theme.colors.mainColors.main,fontSize:16,fontWeight:"600",fontFamily:m.theme.fonts.regular.fontFamily},customRateButtonContainer:{flexDirection:"row",gap:12,marginTop:12},cancelRateButton:{flex:1,flexDirection:"row",alignItems:"center",gap:8,padding:12,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:8,justifyContent:"center",backgroundColor:m.theme.colors.surface},cancelRateText:{color:m.theme.colors.text,fontSize:16,fontWeight:"500",fontFamily:m.theme.fonts.regular.fontFamily},saveRateButton:{flex:2,backgroundColor:m.theme.colors.mainColors.main,borderColor:m.theme.colors.mainColors.main},disabledSaveButton:{backgroundColor:m.theme.colors.placeHolderText,borderColor:m.theme.colors.placeHolderText},saveRateText:{color:m.theme.colors.surface,fontSize:16,fontWeight:"600",fontFamily:m.theme.fonts.regular.fontFamily},customRateFormHeading:{fontSize:16,fontWeight:"600",color:m.theme.colors.text,marginBottom:12,fontFamily:m.theme.fonts.regular.fontFamily},noCustomRatesText:{fontSize:14,color:m.theme.colors.placeHolderText,fontFamily:m.theme.fonts.regular.fontFamily,marginBottom:16,fontStyle:"italic"},customRateAction:{padding:8,borderRadius:4},modalOverlay:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0, 0, 0, 0.5)"},modalContent:{backgroundColor:m.theme.colors.surface,padding:24,borderRadius:12,maxWidth:"85%",minWidth:280,alignItems:"center",shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:3.84,elevation:5},modalIcon:{marginBottom:16},modalTitle:{fontSize:20,fontWeight:"600",color:m.theme.colors.text,marginBottom:12,textAlign:"center",fontFamily:m.theme.fonts.regular.fontFamily},modalText:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,marginBottom:24,textAlign:"center",lineHeight:22},modalButton:{backgroundColor:m.theme.colors.mainColors.main,paddingVertical:12,paddingHorizontal:24,borderRadius:8},modalButtonText:{color:m.theme.colors.surface,fontSize:16,fontWeight:"600",fontFamily:m.theme.fonts.regular.fontFamily,textAlign:"center"},disabledUnitSelector:{backgroundColor:m.theme.colors.surface,opacity:.8,borderColor:m.theme.colors.modernBorder}}),$e=({serviceData:e,setServiceData:t,isUpdatingService:o,setIsUpdatingService:a,onProceedWithUpdate:r})=>{(0,g.debugLog)("MBA5931","RatesAndReviewStep render - isOvernight status:",e.isOvernight);const[i,s]=(0,n.useState)(!1),[l,d]=(0,n.useState)(!1),[c,u]=(0,n.useState)(!1),[h,f]=(0,n.useState)(!0),[p,y]=(0,n.useState)(!1),[b,w]=(0,n.useState)(!1),[j,B]=(0,n.useState)({title:"",rate:"",description:""}),k=e.isOvernight?["Per Night"]:Ye;(0,n.useEffect)((()=>{if(t((e=>Object.assign({},e,{rates:Object.assign({},e.rates,{isPercent:h})}))),e.isOvernight)(0,g.debugLog)("MBA5931","Service is overnight, setting rate unit to Per Night"),t((e=>Object.assign({},e,{rates:Object.assign({},e.rates,{base_rate_unit:"Per Night"})})));else if(e.rates?.base_rate_unit&&!me[e.rates.base_rate_unit]){(0,g.debugLog)("MBA5931","Converting initial base_rate_unit to mapped value");!Object.keys(ue).find((t=>ue[t]===e.rates.base_rate_unit))&&e.rates.base_rate_unit&&(0,g.debugLog)("MBA5931","No mapping found for:",e.rates.base_rate_unit)}if(e.rates?.holidayRate){const o=e.rates.holidayRate.toString();o.includes("%")?(f(!0),t((e=>Object.assign({},e,{rates:Object.assign({},e.rates,{holidayRate:o.replace("%",""),isPercent:!0})})))):o.includes("$")&&(f(!1),t((e=>Object.assign({},e,{rates:Object.assign({},e.rates,{holidayRate:o.replace("$",""),isPercent:!1})}))))}}),[]),(0,n.useEffect)((()=>{(0,g.debugLog)("MBA5931","Available TIME_UNITS:",Ye),(0,g.debugLog)("MBA5931","TIME_UNIT_MAPPING:",ue),(0,g.debugLog)("MBA5931","Current base_rate_unit:",e.rates?.base_rate_unit),(0,g.debugLog)("MBA5931","Displayed unit text:",e.rates?.base_rate_unit?me[e.rates.base_rate_unit]||e.rates.base_rate_unit:Ye[0])}),[e.rates?.base_rate_unit]),(0,n.useEffect)((()=>{e.isOvernight&&((0,g.debugLog)("MBA5931","Overnight service detected, forcing Per Night rate unit"),t((e=>Object.assign({},e,{rates:Object.assign({},e.rates,{base_rate_unit:"Per Night"})}))))}),[e.isOvernight]);const _=()=>{const e=c;return(0,g.debugLog)("MBAno34othg0v","hasUnsavedCustomRate check:",{customChargeVisible:c,title:j.title,rate:j.rate,description:j.description,result:e}),e};(0,n.useEffect)((()=>{if((0,g.debugLog)("MBAno34othg0v","isUpdatingService changed:",{isUpdatingService:o,hasUnsaved:_()}),!o)return;_()?((0,g.debugLog)("MBAno34othg0v","Showing unsaved rate warning modal"),w(!0),a&&((0,g.debugLog)("MBAno34othg0v","Setting isUpdatingService to FALSE to prevent API call"),a(!1))):((0,g.debugLog)("MBAno34othg0v","No unsaved custom rate, allowing update to proceed"),a&&((0,g.debugLog)("MBAno34othg0v","Setting isUpdatingService to TRUE to allow parent to call API"),a(!0),"function"===typeof r&&((0,g.debugLog)("MBAno34othg0v","Calling onProceedWithUpdate directly"),r())))}),[o]);const I=e=>{let t=e.replace(/[^0-9.]/g,"");const o=t.split(".");return o.length>2&&(t=o[0]+"."+o.slice(1).join("")),o[0]&&o[0].length>7&&(t=o[0].slice(0,7)+(o[1]?"."+o[1]:"")),o[1]?.length>2&&(t=o[0]+"."+o[1].slice(0,2)),t},M=(e,t)=>{"rate"===e&&(t=I(t)),B((o=>Object.assign({},o,{[e]:t})))},D=()=>{if(!c)return(0,g.debugLog)("MBAno34othg0v","Opening custom rate form"),u(!0),void y(!1);if(!j.title.trim())return void(0,g.debugLog)("MBAno34othg0v","Missing custom rate title");if(!j.rate)return void(0,g.debugLog)("MBAno34othg0v","Missing custom rate value");const e=parseFloat(j.rate);isNaN(e)||e<=0?(0,g.debugLog)("MBAno34othg0v","Invalid rate value:",j.rate):((0,g.debugLog)("MBAno34othg0v","Saving custom rate successfully:",j),t((e=>Object.assign({},e,{additionalRates:[...e.additionalRates||[],j]}))),B({title:"",rate:"",description:""}),u(!1),y(!1))},R=(e,t,o,n,a)=>n?(0,T.jsx)(x.default,{style:[Je.dropdownContainer,a],children:(0,T.jsx)(H.default,{style:Je.dropdownScroll,contentContainerStyle:Je.dropdownScrollContent,children:e.map((e=>(0,T.jsx)(v.default,{style:[Je.dropdownItem,t===e&&Je.selectedDropdownItem],onPress:()=>o(e),children:(0,T.jsx)(C.default,{style:[Je.dropdownText,t===e&&Je.selectedDropdownText],children:e})},e)))})}):null;return(0,T.jsx)(qe.default,{onPress:()=>{i&&s(!1),l&&d(!1)},children:(0,T.jsxs)(H.default,{style:Je.container,children:[(0,T.jsx)(C.default,{style:Je.title,children:"Set Your Rates"}),(0,T.jsx)(A.default,{visible:b,transparent:!0,animationType:"fade",onRequestClose:()=>w(!1),children:(0,T.jsx)(x.default,{style:Je.modalOverlay,children:(0,T.jsxs)(x.default,{style:Je.modalContent,children:[(0,T.jsx)(S.default,{name:"alert-circle",size:48,color:m.theme.colors.error,style:Je.modalIcon}),(0,T.jsx)(C.default,{style:Je.modalTitle,children:"Unsaved Custom Rate"}),(0,T.jsx)(C.default,{style:Je.modalText,children:"Please save or cancel your custom rate before updating the service."}),(0,T.jsx)(v.default,{style:Je.modalButton,onPress:()=>{(0,g.debugLog)("MBAno34othg0v","Modal OK button clicked"),w(!1)},children:(0,T.jsx)(C.default,{style:Je.modalButtonText,children:"OK"})})]})})}),(0,T.jsxs)(x.default,{style:[Je.rateContainer,{zIndex:3}],children:[(0,T.jsxs)(C.default,{style:Je.label,children:["Base Rate ",(0,T.jsx)(C.default,{style:{color:m.theme.colors.placeHolderText},children:"(Required)"})]}),(0,T.jsxs)(x.default,{style:Je.rateInputGroup,children:[(0,T.jsxs)(x.default,{style:[Je.currencyInputContainer,{flex:1}],children:[(0,T.jsx)(C.default,{style:Je.currencySymbol,children:"$"}),(0,T.jsx)(q.default,{style:Je.currencyInput,placeholder:"0.00",keyboardType:"decimal-pad",value:e.rates?.base_rate||"",onChangeText:e=>{const o=I(e);t((e=>Object.assign({},e,{rates:Object.assign({},e.rates,{base_rate:o})})))},placeholderTextColor:m.theme.colors.placeHolderText})]}),(0,T.jsxs)(x.default,{style:{flex:1,zIndex:1},children:[(0,T.jsxs)(v.default,{style:[Je.unitSelector,e.isOvernight&&Je.disabledUnitSelector],onPress:()=>{e.isOvernight||(d(!1),s(!i))},disabled:e.isOvernight,children:[(0,T.jsx)(C.default,{style:Je.unitText,children:e.isOvernight?"Per Night":e.rates?.base_rate_unit?me[e.rates.base_rate_unit]||e.rates.base_rate_unit:Ye[0]}),!e.isOvernight&&(0,T.jsx)(S.default,{name:i?"chevron-up":"chevron-down",size:24,color:m.theme.colors.text})]}),R(k,e.rates?.base_rate_unit,(o=>{const n=e.isOvernight?"Per Night":ue[o];t((e=>Object.assign({},e,{rates:Object.assign({},e.rates,{base_rate_unit:n})}))),s(!1)}),i&&!e.isOvernight,{width:"100%"})]})]})]}),(0,T.jsxs)(x.default,{style:[Je.rateContainer,{zIndex:2}],children:[(0,T.jsxs)(C.default,{style:Je.label,children:["Additional Animal Rate ",(0,T.jsx)(C.default,{style:{color:m.theme.colors.placeHolderText},children:"(Optional)"})]}),(0,T.jsxs)(x.default,{style:Je.rateInputGroup,children:[(0,T.jsxs)(x.default,{style:[Je.currencyInputContainer,{flex:1}],children:[(0,T.jsx)(C.default,{style:Je.currencySymbol,children:"$"}),(0,T.jsx)(q.default,{style:Je.currencyInput,placeholder:"0.00",keyboardType:"decimal-pad",value:e.rates?.additionalAnimalRate||"",onChangeText:e=>{const o=I(e);t((e=>Object.assign({},e,{rates:Object.assign({},e.rates,{additionalAnimalRate:o})})))},placeholderTextColor:m.theme.colors.placeHolderText})]}),(0,T.jsxs)(x.default,{style:{flex:1,zIndex:1},children:[(0,T.jsxs)(v.default,{style:Je.unitSelector,onPress:()=>{s(!1),d(!l)},children:[(0,T.jsxs)(C.default,{style:Je.unitText,children:["After ",e.rates?.additionalAnimalThreshold||"1"," animals"]}),(0,T.jsx)(S.default,{name:l?"chevron-up":"chevron-down",size:24,color:m.theme.colors.text})]}),R(Ge,e.rates?.additionalAnimalThreshold,(e=>{t((t=>Object.assign({},t,{rates:Object.assign({},t.rates,{additionalAnimalThreshold:e})}))),d(!1)}),l,{width:"100%"})]})]})]}),(0,T.jsxs)(x.default,{style:Je.customRatesContainer,children:[(0,T.jsxs)(C.default,{style:Je.label,children:["Custom Charges ",(0,T.jsx)(C.default,{style:{color:m.theme.colors.placeHolderText},children:"(Optional)"})]}),e.additionalRates?.length>0?e.additionalRates.map(((o,n)=>(0,T.jsxs)(x.default,{style:Je.customRateItem,children:[(0,T.jsxs)(x.default,{style:Je.customRateContent,children:[(0,T.jsxs)(x.default,{style:Je.customRateTitleContainer,children:[(0,T.jsx)(C.default,{style:Je.customRateTitle,children:o.title}),o.description?(0,T.jsx)(C.default,{style:Je.customRateDescription,numberOfLines:1,children:o.description}):null]}),(0,T.jsxs)(C.default,{style:Je.customRateAmount,children:["$",o.rate]})]}),(0,T.jsxs)(x.default,{style:Je.customRateActions,children:[(0,T.jsx)(v.default,{onPress:()=>(o=>{const n=e.additionalRates[o];B({title:n.title,rate:n.rate,description:n.description||""}),u(!0),y(!0),t((e=>Object.assign({},e,{additionalRates:e.additionalRates.filter(((e,t)=>t!==o))})))})(n),style:Je.customRateAction,activeOpacity:.7,children:(0,T.jsx)(S.default,{name:"pencil",size:20,color:m.theme.colors.mainColors.main})}),(0,T.jsx)(v.default,{onPress:()=>(e=>{t((t=>Object.assign({},t,{additionalRates:t.additionalRates.filter(((t,o)=>o!==e))})))})(n),style:Je.customRateAction,activeOpacity:.7,children:(0,T.jsx)(S.default,{name:"delete",size:20,color:"#F26969"})})]})]},n))):c?null:(0,T.jsx)(C.default,{style:Je.noCustomRatesText,children:"No custom charges added yet. Use the button below to add one."}),c?(0,T.jsxs)(x.default,{style:Je.newCustomRateContainer,children:[(0,T.jsx)(C.default,{style:Je.customRateFormHeading,children:p?"Edit Custom Rate":"New Custom Rate"}),(0,T.jsx)(q.default,{style:Je.customRateInput,placeholder:"Charge Title",value:j.title,onChangeText:e=>M("title",e),placeholderTextColor:m.theme.colors.placeHolderText}),(0,T.jsxs)(x.default,{style:Je.currencyInputContainer,children:[(0,T.jsx)(C.default,{style:Je.currencySymbol,children:"$"}),(0,T.jsx)(q.default,{style:Je.currencyInput,placeholder:"0.00",keyboardType:"decimal-pad",value:j.rate,onChangeText:e=>M("rate",e),placeholderTextColor:m.theme.colors.placeHolderText})]}),(0,T.jsx)(q.default,{style:[Je.customRateInput,Je.textArea],placeholder:"Description",value:j.description,onChangeText:e=>M("description",e),placeholderTextColor:m.theme.colors.placeHolderText,multiline:!0,numberOfLines:3}),(0,T.jsxs)(x.default,{style:Je.customRateButtonContainer,children:[(0,T.jsxs)(v.default,{style:Je.cancelRateButton,onPress:()=>{(0,g.debugLog)("MBAno34othg0v","Cancel button pressed for custom rate form"),u(!1),B({title:"",rate:"",description:""}),y(!1),w(!1)},children:[(0,T.jsx)(S.default,{name:"close",size:20,color:m.theme.colors.text}),(0,T.jsx)(C.default,{style:Je.cancelRateText,children:"Cancel"})]}),(0,T.jsxs)(v.default,{style:[Je.addRateButton,Je.saveRateButton,!j.title.trim()||!j.rate||isNaN(parseFloat(j.rate))||parseFloat(j.rate)<=0?Je.disabledSaveButton:{}],onPress:D,disabled:!j.title.trim()||!j.rate||isNaN(parseFloat(j.rate))||parseFloat(j.rate)<=0,children:[(0,T.jsx)(S.default,{name:"content-save",size:20,color:m.theme.colors.surface}),(0,T.jsx)(C.default,{style:Je.saveRateText,children:p?"Update Custom Rate":"Save Custom Rate"})]})]})]}):(0,T.jsxs)(v.default,{style:Je.addRateButton,onPress:D,children:[(0,T.jsx)(S.default,{name:"plus",size:20,color:m.theme.colors.mainColors.main}),(0,T.jsx)(C.default,{style:Je.addRateText,children:"Add Rate"})]})]})]})})};var Ze=o(50294);const Ke={CATEGORY_SELECTION:{id:0,name:"Categories & Types"},SERVICE_DETAILS:{id:1,name:"Service Details"},RATES_AND_REVIEW:{id:2,name:"Rates & Review"}},Qe={Horse:"Farm Animals",Cow:"Farm Animals",Sheep:"Farm Animals",Goat:"Farm Animals",Pig:"Farm Animals",Dogs:"Domestic",Cats:"Domestic",Birds:"Domestic",Rabbits:"Domestic",Hamsters:"Domestic",Snake:"Reptiles",Lizard:"Reptiles",Turtle:"Reptiles",Gecko:"Reptiles",Chameleon:"Reptiles",Fish:"Aquatic",Frog:"Aquatic",Newt:"Aquatic",Axolotl:"Aquatic",Spider:"Invertebrates",Scorpion:"Invertebrates",Crab:"Invertebrates",Snail:"Invertebrates",Millipede:"Invertebrates"},Xe=[{id:"all",name:"All",icon:"paw-outline"},{id:"farm_animals",name:"Farm Animals",icon:"horse"},{id:"domestic",name:"Domestic",icon:"paw"},{id:"reptiles",name:"Reptiles",icon:"snake"},{id:"aquatic",name:"Aquatic",icon:"fish"},{id:"invertebrates",name:"Invertebrates",icon:"spider"}],et=r.default.create({modalOverlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center",width:"100%"},modalContent:{width:"95%",maxWidth:"web"===a.default.OS?550:"100%",maxHeight:"90%",backgroundColor:m.theme.colors.background,borderRadius:12,overflow:"hidden",display:"flex",flexDirection:"column"},stepIndicatorContainer:{width:"100%",paddingVertical:12,backgroundColor:m.theme.colors.background,borderBottomWidth:1,borderBottomColor:m.theme.colors.modernBorder},scrollContent:{flex:1},scrollContentContainer:{flexGrow:1},content:{flex:1,backgroundColor:m.theme.colors.background},footer:{flexDirection:"row",padding:16,justifyContent:"space-between",gap:12,backgroundColor:m.theme.colors.background,borderTopWidth:1,borderTopColor:m.theme.colors.modernBorder},cancelButton:{flex:1,backgroundColor:m.theme.colors.surface,paddingVertical:16,borderRadius:8,alignItems:"center",borderWidth:1,borderColor:m.theme.colors.border},cancelButtonText:{color:m.theme.colors.text,fontSize:16,fontFamily:m.theme.fonts.regular.fontFamily},nextButton:{flex:1,backgroundColor:m.theme.colors.mainColors.main,paddingVertical:16,borderRadius:8,alignItems:"center"},disabledButton:{backgroundColor:m.theme.colors.placeHolderText},nextButtonText:{color:m.theme.colors.surface,fontSize:16,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"600"},disabledButtonText:{color:m.theme.colors.surface},errorText:{color:m.theme.colors.error,textAlign:"center",marginBottom:16,fontFamily:m.theme.fonts.regular.fontFamily}}),tt=({visible:e,onClose:t,onSave:o,initialService:a=null,setHasUnsavedChanges:r})=>{const{is_DEBUG:i}=(0,n.useContext)(g.AuthContext),[s,l]=(0,n.useState)(Ke.CATEGORY_SELECTION.id),[d,c]=(0,n.useState)({generalCategories:[],animalTypes:[],serviceName:"",serviceDescription:"",isOvernight:!1,rates:{base_rate:"",base_rate_unit:"Per Visit",additionalAnimalRate:"",additionalAnimalThreshold:"1",hasHolidayRate:!1,holidayRate:"0",isPercent:!0},additionalRates:[]}),[u,h]=(0,n.useState)(null),[f,p]=(0,n.useState)(!1),[y,b]=(0,n.useState)(!1),[w,j]=(0,n.useState)(!1),S=E();(0,n.useEffect)((()=>{if(e)if(l(Ke.CATEGORY_SELECTION.id),h(null),a){(0,g.debugLog)("MBA123456","Initializing with service data:",a),b(!0);let e=[];a.animalTypes&&a.animalTypes.length>0?((0,g.debugLog)("MBA123456","Using pre-formatted animalTypes array:",a.animalTypes),e=a.animalTypes):a.animal_types?((0,g.debugLog)("MBA123456","Using animal_types from backend:",a.animal_types),"object"!==typeof a.animal_types||Array.isArray(a.animal_types)||((0,g.debugLog)("MBA123456","Processing animal_types as dictionary"),Object.entries(a.animal_types).forEach((([t,o])=>{const n=Xe.find((e=>e.name===o));(0,g.debugLog)("MBA123456","Adding animal: ".concat(t,", category: ").concat(o,", categoryId: ").concat(n?.id||"not found")),e.push({name:t,categoryName:o,categoryId:n?n.id:null,isCustom:!1})})))):(0,g.debugLog)("MBA123456","No animal types found in data"),(0,g.debugLog)("MBA123456","Final converted animal types:",e);let t="0",o=!0;a.holiday_rate&&("string"===typeof a.holiday_rate?a.holiday_rate.includes("%")?(t=a.holiday_rate.replace("%",""),o=!0):a.holiday_rate.includes("$")?(t=a.holiday_rate.replace("$",""),o=!1):(t=a.holiday_rate,o=void 0===a.holiday_rate_is_percent||a.holiday_rate_is_percent):(t=a.holiday_rate.toString(),o=void 0===a.holiday_rate_is_percent||a.holiday_rate_is_percent));let n=[];a.additional_rates&&Array.isArray(a.additional_rates)&&(n=a.additional_rates.map((e=>({title:e.title,rate:e.rate,description:e.description||""})))),c({service_id:a.service_id,generalCategories:[],animalTypes:e,serviceName:a.service_name||"",serviceDescription:a.description||"",isOvernight:a.is_overnight||!1,rates:{base_rate:a.base_rate||"",base_rate_unit:a.unit_of_time||"Per Visit",additionalAnimalRate:a.additional_animal_rate||"",additionalAnimalThreshold:a.applies_after?.toString()||"1",hasHolidayRate:"0"!==t,holidayRate:t,isPercent:o},additionalRates:n})}else b(!1),c({generalCategories:[],animalTypes:[],serviceName:"",serviceDescription:"",isOvernight:!1,rates:{base_rate:"",base_rate_unit:"Per Visit",additionalAnimalRate:"",additionalAnimalThreshold:"1",hasHolidayRate:!1,holidayRate:"0",isPercent:!0},additionalRates:[]})}),[e,a]);const B=()=>{switch(s){case Ke.CATEGORY_SELECTION.id:return d.animalTypes?.length>0;case Ke.SERVICE_DETAILS.id:return d.serviceName?.trim()&&d.serviceDescription?.trim();case Ke.RATES_AND_REVIEW.id:const e=d.rates?.base_rate&&parseFloat(d.rates.base_rate)>0,t=!d.rates?.additionalAnimalRate||parseFloat(d.rates.additionalAnimalRate)>=0;return e&&t;default:return!1}},k=async()=>{(0,g.debugLog)("MBAno34othg0v","Directly calling API without state dependencies"),(0,g.debugLog)("MBA54321","Original serviceData:",d),p(!0);try{const e={};d.animalTypes.forEach((t=>{const o="string"===typeof t?t:t.name;Qe[o]?e[o]=Qe[o]:"object"===typeof t&&t.categoryName?e[o]=t.categoryName:e[o]="Other"})),(0,g.debugLog)("MBA54321","Animal types dictionary created:",e);d.generalCategories.map((e=>"string"===typeof e?e:e.name||"Uncategorized"));const n=d.rates.holidayRate||"0",a=n&&"0"!==n?d.rates.isPercent?"".concat(n,"%"):"$".concat(n):"0",i={service_name:d.serviceName,description:d.serviceDescription,animal_types:e,base_rate:d.rates.base_rate,additional_animal_rate:d.rates.additionalAnimalRate||"0",holiday_rate:a,applies_after:parseInt(d.rates.additionalAnimalThreshold)||1,unit_of_time:d.rates.base_rate_unit,is_overnight:d.isOvernight||!1,additional_rates:d.additionalRates.map((e=>({title:e.title,description:e.description||"",rate:e.rate})))};let s;y&&d.service_id&&(i.service_id=d.service_id),(0,g.debugLog)("MBA54321","Formatted data for backend:",i),y&&d.service_id?(s=await(0,Ze.updateService)(i),(0,g.debugLog)("MBA54321","Service updated successfully, response:",s)):(s=await(0,Ze.createService)(i),(0,g.debugLog)("MBA54321","Service created successfully, response:",s)),S({message:y?"Service updated successfully!":"Service created successfully!",type:"success",duration:3e3});const u={service_id:s.service_id,serviceName:s.service_name||d.serviceName,serviceDescription:d.serviceDescription,lengthOfService:s.unit_of_time||d.rates.base_rate_unit,isOvernight:d.isOvernight||!1,is_active:void 0===s.is_active||s.is_active,rates:{base_rate:d.rates.base_rate,additionalAnimalRate:d.rates.additionalAnimalRate||"0",holidayRate:a},generalCategories:d.generalCategories.map((e=>"string"===typeof e?{id:e.toLowerCase().replace(/\s+/g,"_"),name:e,isCustom:!1}:{id:e.id||e.name.toLowerCase().replace(/\s+/g,"_"),name:e.name,isCustom:e.isCustom||!1})),animalTypes:d.animalTypes.map((e=>"string"===typeof e?{name:e,categoryId:null,isCustom:!1}:{name:e.name,categoryId:e.categoryId,categoryName:e.categoryName||"Other",isCustom:e.isCustom||!1})),additionalRates:d.additionalRates.map((e=>({label:e.title,value:e.rate,description:e.description||""})))};s.additional_rates&&Array.isArray(s.additional_rates)&&(u.additionalRates=s.additional_rates.map((e=>({label:e.title,value:e.rate,description:e.description||""})))),(0,g.debugLog)("MBA54321","Formatted data for ServiceManager:",u),o&&o(u),c({generalCategories:[],animalTypes:[],serviceName:"",serviceDescription:"",isOvernight:!1,rates:{base_rate:"",base_rate_unit:"Per Visit",additionalAnimalRate:"",additionalAnimalThreshold:"1",hasHolidayRate:!1,holidayRate:"0",isPercent:!0},additionalRates:[]}),l(Ke.CATEGORY_SELECTION.id),r(!0),t()}catch(u){(0,g.debugLog)("MBA54321","Error saving service:",u),(0,g.debugLog)("MBA54321","Error response:",u.response?.data),S({message:"Failed to ".concat(y?"update":"create"," service: ").concat(u.response?.data?.error||u.message),type:"error",duration:4e3}),h("Failed to ".concat(y?"update":"create"," service. Please try again."))}finally{p(!1)}},I=()=>{s>Ke.CATEGORY_SELECTION.id?l((e=>e-1)):t()};return(0,T.jsx)(A.default,{visible:e,animationType:"fade",onRequestClose:I,transparent:!0,children:(0,T.jsx)(x.default,{style:et.modalOverlay,children:(0,T.jsxs)(Ie.default,{style:et.modalContent,children:[(0,T.jsx)(x.default,{style:et.stepIndicatorContainer,children:(0,T.jsx)(ze,{steps:Object.values(Ke).map((e=>e.name)),currentStep:s})}),(0,T.jsxs)(H.default,{style:et.scrollContent,contentContainerStyle:et.scrollContentContainer,children:[(0,T.jsx)(x.default,{style:et.content,children:(()=>{switch((0,g.debugLog)("MBA54321 Rendering step:",s,"with serviceData:",d),s){case Ke.CATEGORY_SELECTION.id:return(0,T.jsx)(Ne,{serviceData:d,setServiceData:c});case Ke.SERVICE_DETAILS.id:return(0,T.jsx)(Ve,{serviceData:d,setServiceData:c});case Ke.RATES_AND_REVIEW.id:return(0,T.jsx)($e,{serviceData:d,setServiceData:c,isUpdatingService:w,setIsUpdatingService:j,onProceedWithUpdate:k});default:return null}})()}),u&&(0,T.jsx)(C.default,{style:et.errorText,children:u})]}),(0,T.jsxs)(x.default,{style:et.footer,children:[(0,T.jsx)(v.default,{style:et.cancelButton,onPress:I,disabled:f,children:(0,T.jsx)(C.default,{style:et.cancelButtonText,children:s>Ke.CATEGORY_SELECTION.id?"Back":"Cancel"})}),(0,T.jsx)(v.default,{style:[et.nextButton,(!B()||f)&&et.disabledButton],onPress:()=>{(0,g.debugLog)("MBAno34othg0v","handleNext called, currentStep:",s),B()?(h(null),s<Ke.RATES_AND_REVIEW.id?l((e=>e+1)):((0,g.debugLog)("MBAno34othg0v","Final step, checking for unsaved custom rates"),j(!0))):h("Please complete all required fields before proceeding")},disabled:!B()||f,children:f&&s===Ke.RATES_AND_REVIEW.id?(0,T.jsx)(_.default,{color:m.theme.colors.surface,size:"small"}):(0,T.jsx)(C.default,{style:[et.nextButtonText,!B()&&et.disabledButtonText],children:s===Ke.RATES_AND_REVIEW.id?y?"Update Service":"Create Service":"Next"})})]})]})})})},ot=r.default.create({serviceCard:{backgroundColor:m.theme.colors.surfaceContrast,borderRadius:12,padding:16,marginBottom:16,shadowColor:"#000",display:"flex",justifyContent:"center",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:3,elevation:3},cardHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"flex-start",marginBottom:16},serviceName:{fontSize:m.theme.fontSizes.large,fontWeight:"600",color:m.theme.colors.text,fontFamily:m.theme.fonts.header.fontFamily,flex:1,flexWrap:"wrap",marginRight:8},activeToggleContainer:{flexDirection:"row",alignItems:"center",gap:8},activeText:{fontSize:m.theme.fontSizes.smallMedium,color:m.theme.colors.primary,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"600"},inactiveText:{fontSize:m.theme.fontSizes.smallMedium,color:m.theme.colors.textSecondary,fontFamily:m.theme.fonts.regular.fontFamily},switch:{transform:[{scaleX:.8},{scaleY:.8}]},ratesContainer:{gap:12,padding:16,borderRadius:8,marginBottom:16},rateRow:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingVertical:4},rateLabel:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"500"},rateValue:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,fontWeight:"500",fontFamily:m.theme.fonts.regular.fontFamily},buttonContainer:{flexDirection:"row",justifyContent:"space-between",gap:8},editButton:{flex:1,flexDirection:"row",alignItems:"center",justifyContent:"center",backgroundColor:m.theme.colors.primary,paddingVertical:10,borderRadius:8,gap:8},deleteButton:{flex:1,flexDirection:"row",alignItems:"center",justifyContent:"center",borderColor:"#F26969",borderWidth:1,paddingVertical:10,borderRadius:8,gap:8},buttonText:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.surfaceContrast,fontFamily:m.theme.fonts.regular.fontFamily},deleteButtonText:{fontSize:m.theme.fontSizes.medium,fontWeight:"600",color:"#F26969",fontFamily:m.theme.fonts.regular.fontFamily}}),nt=({item:e,index:t,onEdit:o,onDelete:a})=>{const{screenWidth:r}=(0,n.useContext)(g.AuthContext),[i,s]=(0,n.useState)(!1!==e.is_active);(0,n.useEffect)((()=>{(0,g.debugLog)("MBA3377","ProfessionalServiceCard Item Data:",e)}),[e]);return(0,T.jsxs)(x.default,{style:ot.serviceCard,children:[(0,T.jsxs)(x.default,{style:ot.cardHeader,children:[(0,T.jsx)(C.default,{style:ot.serviceName,numberOfLines:2,ellipsizeMode:"tail",children:e.serviceName}),(0,T.jsxs)(x.default,{style:ot.activeToggleContainer,children:[(0,T.jsx)(C.default,{style:i?ot.activeText:ot.inactiveText,children:i?"Active":"Inactive"}),(0,T.jsx)(He.default,{value:i,onValueChange:()=>{s(!i)},trackColor:{false:m.theme.colors.quaternary,true:m.theme.colors.primary},thumbColor:m.theme.colors.surfaceContrast,style:ot.switch})]})]}),(0,T.jsxs)(x.default,{style:[ot.ratesContainer,{backgroundColor:(()=>{const e=[];return e[t%e.length]})()}],children:[(0,T.jsxs)(x.default,{style:ot.rateRow,children:[(0,T.jsx)(C.default,{style:ot.rateLabel,children:"Base Rate"}),(0,T.jsxs)(C.default,{style:ot.rateValue,children:["$",e.rates.base_rate||"N/A","/",(l=e.lengthOfService,l||"visit")]})]}),e.rates.additionalAnimalRate&&(0,T.jsxs)(x.default,{style:ot.rateRow,children:[(0,T.jsx)(C.default,{style:ot.rateLabel,children:"Additional Animal"}),(0,T.jsxs)(C.default,{style:ot.rateValue,children:["$",e.rates.additionalAnimalRate]})]}),e.rates.holidayRate&&(0,T.jsxs)(x.default,{style:ot.rateRow,children:[(0,T.jsx)(C.default,{style:ot.rateLabel,children:"Holiday Rate"}),(0,T.jsx)(C.default,{style:ot.rateValue,children:e.rates.holidayRate})]}),e.additionalRates&&e.additionalRates.map(((e,t)=>(0,T.jsxs)(x.default,{style:ot.rateRow,children:[(0,T.jsx)(C.default,{style:ot.rateLabel,children:e.label}),(0,T.jsxs)(C.default,{style:ot.rateValue,children:["$",e.value]})]},t)))]}),(0,T.jsxs)(x.default,{style:ot.buttonContainer,children:[(0,T.jsxs)(v.default,{onPress:()=>a(t),style:ot.deleteButton,children:[(0,T.jsx)(S.default,{name:"trash-can",size:20,color:"#F26969"}),(0,T.jsx)(C.default,{style:ot.deleteButtonText,children:"Delete"})]}),(0,T.jsxs)(v.default,{onPress:()=>o(t),style:ot.editButton,children:[(0,T.jsx)(S.default,{name:"pencil",size:20,color:m.theme.colors.surfaceContrast}),(0,T.jsx)(C.default,{style:ot.buttonText,children:"Edit"})]})]})]});var l};var at=o(42490);const rt=()=>{if("web"!==a.default.OS)return!1;{const e="ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0;return window.matchMedia("(hover: hover)").matches&&!e}},it=[{id:"all",name:"All",icon:"paw-outline"},{id:"farm_animals",name:"Farm Animals",icon:"horse"},{id:"domestic",name:"Domestic",icon:"paw"},{id:"reptiles",name:"Reptiles",icon:"snake"},{id:"aquatic",name:"Aquatic",icon:"fish"},{id:"invertebrates",name:"Invertebrates",icon:"spider"}],st=r.default.create({container:{flex:1,position:"relative",zIndex:9998,elevation:9998,backgroundColor:m.theme.colors.surface},serviceListContainer:{flex:1,paddingVertical:0},servicesGrid:{display:"flex",flexDirection:"row",flexWrap:"wrap",gap:16,paddingBottom:24},serviceCardWrapper:{flex:1,minWidth:300,maxWidth:375},headerContainer:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:24,position:"relative",zIndex:9999,elevation:9999},headerActions:{flexDirection:"row",alignItems:"center",gap:12},collapseButton:{padding:8,borderRadius:8,backgroundColor:m.theme.colors.surface},sectionTitle:{fontSize:m.theme.fontSizes.large,fontWeight:"bold",color:m.theme.colors.text,fontFamily:m.theme.fonts.header.fontFamily},addServiceButton:{flexDirection:"row",alignItems:"center",gap:8,backgroundColor:m.theme.colors.primary,paddingHorizontal:16,paddingVertical:10,borderRadius:50},addServiceText:{color:m.theme.colors.surface,fontSize:m.theme.fontSizes.medium,fontWeight:"500",fontFamily:m.theme.fonts.regular.fontFamily},emptyContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:20,backgroundColor:m.theme.colors.surface,borderRadius:8,marginBottom:24},emptyText:{fontSize:m.theme.fontSizes.mediumLarge,color:m.theme.colors.text,marginBottom:20,fontFamily:m.theme.fonts.regular.fontFamily},addButton:{backgroundColor:m.theme.colors.primary,paddingHorizontal:20,paddingVertical:10,borderRadius:50},addButtonText:{color:m.theme.colors.surface,fontSize:m.theme.fontSizes.medium,fontWeight:"500",fontFamily:m.theme.fonts.regular.fontFamily},portalTooltip:{backgroundColor:m.theme.colors.surface,padding:8,borderRadius:4,width:70,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:3.84,elevation:5},tooltipText:{fontSize:m.theme.fontSizes.small,color:m.theme.colors.text,textAlign:"center",fontFamily:m.theme.fonts.regular.fontFamily}}),lt=({services:e,setServices:t,setHasUnsavedChanges:o,isProfessionalTab:a=!1,isMobile:r=!1})=>{const[i,s]=(0,n.useState)(!1),[l,d]=(0,n.useState)(null),[c,u]=(0,n.useState)([]),[h,f]=(0,n.useState)(!1),[p,y]=(0,n.useState)(!1),[b,w]=(0,n.useState)(null),[j,B]=(0,n.useState)(null),[k,A]=(0,n.useState)(null),{screenWidth:_,is_DEBUG:I}=(0,n.useContext)(g.AuthContext),[D,R]=(0,n.useState)(null),L=(0,n.useRef)(null),z=((0,n.useRef)(null),E()),P=rt();(0,n.useEffect)((()=>{u([]),f(!1),d(null),s(!1),y(!1),w(null)}),[e]);const F=t=>{const o=e[t];(0,g.debugLog)("MBA87654","Original service for editing:",o);let n=[];o.animal_types&&"object"===typeof o.animal_types&&!Array.isArray(o.animal_types)?(n=Object.entries(o.animal_types).map((([e,t])=>{const o=it.find((e=>e.name===t)),n=o?o.id:null;return{name:e,categoryName:t,categoryId:n,isCustom:!1}})),(0,g.debugLog)("MBA87654","Converted animal_types to array format:",n)):o.animalTypes&&(n=o.animalTypes,(0,g.debugLog)("MBA87654","Using existing animalTypes array:",n));const a={service_id:o.service_id,service_name:o.service_name||o.serviceName,description:o.description||o.serviceDescription,animal_types:o.animal_types,animalTypes:n,base_rate:o.base_rate||(o.rates?o.rates.base_rate:""),additional_animal_rate:o.additional_animal_rate||(o.rates?o.rates.additionalAnimalRate:"0"),holiday_rate:o.holiday_rate||(o.rates?o.rates.holidayRate:"0"),applies_after:o.applies_after||1,unit_of_time:o.unit_of_time||o.lengthOfService||"Per Visit",is_overnight:o.is_overnight||o.isOvernight||!1,is_active:void 0===o.is_active||o.is_active,holiday_rate_is_percent:o.holiday_rate_is_percent,additional_rates:o.additional_rates||(o.additionalRates?o.additionalRates.map((e=>({title:e.label||e.title,rate:e.value||e.rate,description:e.description||""}))):[])};(0,g.debugLog)("MBA87654","Formatted service for editing modal:",a),d(a),s(!0)},O=e=>{w(e),y(!0)},W=e=>{u((t=>t.includes(e)?t.filter((t=>t!==e)):[...t,e]))},N=({item:e,index:t})=>{if(!e||"object"!==typeof e)return console.warn("Invalid item detected:",e),null;if((0,g.debugLog)("MBA8765","Rendering service item:",e),e.service_id&&((0,g.debugLog)("MBA8765","This is a backend-created service with ID:",e.service_id),e.serviceName&&e.rates))return(0,T.jsx)(nt,{item:e,index:t,onEdit:()=>F(t),onDelete:()=>O(t),isCollapsed:c.includes(t),onToggleCollapse:()=>W(t),isProfessionalTab:a},"service-".concat(t));let o=[];e.animal_types&&"object"===typeof e.animal_types&&!Array.isArray(e.animal_types)?o=Object.entries(e.animal_types).map((([e,t])=>({name:e,categoryId:void 0,category:t,isCustom:!1}))):Array.isArray(e.animal_types)&&(o=e.animal_types);const n={service_id:e.service_id,serviceName:e.service_name,description:e.description,lengthOfService:e.unit_of_time,is_active:e.is_active,generalCategories:e.categories?.map((e=>({id:e.id,name:e.name,isCustom:e.is_custom})))||[],animalTypes:o,rates:{base_rate:e.base_rate,additionalAnimalRate:e.additional_animal_rate,holidayRate:e.holiday_rate},additionalRates:e.additional_rates?.map((e=>({label:e.title,value:e.rate,description:e.description})))||[]};return(0,T.jsx)(nt,{item:n,index:t,onEdit:()=>F(t),onDelete:()=>O(t),isCollapsed:c.includes(t),onToggleCollapse:()=>W(t),isProfessionalTab:a},"service-".concat(t))};return(0,T.jsxs)(x.default,{style:st.container,children:[(0,T.jsxs)(x.default,{style:[st.serviceListContainer,{maxWidth:1200,marginHorizontal:"auto",width:"100%",paddingHorizontal:r?20:24,paddingTop:r?0:44}],children:[(0,T.jsxs)(x.default,{style:st.headerContainer,children:[(0,T.jsx)(C.default,{style:st.sectionTitle,children:"Service Manager"}),(0,T.jsx)(x.default,{style:st.headerActions,children:(0,T.jsxs)(v.default,{ref:L,style:st.addServiceButton,onMouseEnter:()=>{try{P&&((e,t,o)=>{if(e&&e.current)try{setTimeout((()=>{const n=e.current;if(n.getBoundingOwnerRect){const e=n.getBoundingOwnerRect();o({x:e.left+e.width/2,y:e.top,text:t}),B(t)}else console.error("Error: getBoundingOwnerRect method not found on element")}),0)}catch(n){console.error("Error showing tooltip:",n)}})(L,"Add Service",A)}catch(e){console.error("Error showing add tooltip:",e)}},onMouseLeave:()=>{P&&(B(null),A(null))},onPress:()=>{d(null),s(!0)},children:[(0,T.jsx)(S.default,{name:"plus",size:20,color:m.theme.colors.surface}),(0,T.jsx)(C.default,{style:st.addServiceText,children:"Add New Service"})]})})]}),Array.isArray(e)&&e.length>0?(0,T.jsx)(x.default,{style:[st.servicesGrid,{justifyContent:_>600?"":"center"}],children:e.map(((e,t)=>(0,T.jsx)(x.default,{style:st.serviceCardWrapper,children:N({item:e,index:t})},"service-wrapper-".concat(t))))}):(0,T.jsxs)(x.default,{style:st.emptyContainer,children:[(0,T.jsx)(C.default,{style:st.emptyText,children:"No services yet"}),(0,T.jsx)(v.default,{style:st.addButton,onPress:()=>s(!0),children:(0,T.jsx)(C.default,{style:st.addButtonText,children:"Add Services"})})]})]}),(0,T.jsx)(tt,{visible:i,onClose:()=>{s(!1),d(null)},onSave:n=>{(0,g.debugLog)("MBA8765","Service data received from modal:",n);if(l&&n.service_id){(0,g.debugLog)("MBA8765","Updating existing service with ID:",n.service_id);const a=e.findIndex((e=>e.service_id===n.service_id));return-1!==a?(t((e=>{const t=[...e];return t[a]=n,t})),(0,g.debugLog)("MBA8765","Service updated at index:",a)):((0,g.debugLog)("MBA8765","Service ID not found in existing list, adding as new"),t((e=>[...e,n]))),o(!0),void d(null)}if(n.service_id)return(0,g.debugLog)("MBA8765","New service created on backend with ID:",n.service_id),t((e=>[...e,n])),o(!0),void d(null);(0,g.debugLog)("MBA8765","Warning: Falling back to legacy service format handling");const a={};n.animalTypes&&Array.isArray(n.animalTypes)&&n.animalTypes.forEach((e=>{e&&e.name&&(e.categoryName?a[e.name]=e.categoryName:a[e.name]=e.category||"Other")}));const r={service_name:n.serviceName,description:n.serviceDescription,unit_of_time:n.lengthOfService,is_overnight:n.isOvernight||!1,base_rate:n.rates.base_rate,additional_animal_rate:n.rates.additionalAnimalRate,holiday_rate:n.rates.holidayRate,animal_types:a,additional_rates:n.additionalRates.map((e=>({title:e.label,rate:e.value,description:e.description})))};if(l){const o=e.findIndex((e=>e.service_id===l.service_id));t(-1!==o?e=>{const t=[...e];return t[o]=r,t}:e=>[...e,r])}else t((e=>[...e,r]));o(!0),d(null)},initialService:l,setHasUnsavedChanges:o}),(0,T.jsx)(M,{visible:p,onClose:()=>y(!1),onConfirm:async()=>{try{const n=e[b];if(!n||!n.service_id)return z({message:"Unable to identify service for deletion",type:"error",duration:3e3}),void y(!1);await(0,Ze.deleteService)(n.service_id),t((e=>e.filter(((e,t)=>t!==b)))),o(!0),y(!1),z({message:"Service deleted successfully",type:"success",duration:3e3})}catch(n){const e=n.response?.data?.error||"Failed to delete service";z({message:e,type:"error",duration:3e3}),y(!1)}},actionText:"delete this service"}),k&&(0,T.jsx)(at.default,{children:(0,T.jsx)(x.default,{style:[st.portalTooltip,{position:"fixed",top:k.y-40,left:k.x-35}],children:(0,T.jsx)(C.default,{style:st.tooltipText,children:k.text})})}),D&&(0,T.jsx)(at.default,{children:(0,T.jsx)(x.default,{style:[st.portalTooltip,{position:"fixed",top:D.y-40,left:D.x-35}],children:(0,T.jsx)(C.default,{style:st.tooltipText,children:D.text})})})]})};o(31385);r.default.create({section:{width:"100%",maxWidth:600,marginBottom:20,paddingVertical:20,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},sectionTitle:{fontSize:m.theme.fontSizes.large,fontWeight:"bold",color:m.theme.colors.primary,marginBottom:10},petItem:{marginBottom:10,padding:10,backgroundColor:m.theme.colors.surface,borderColor:m.theme.colors.border,borderWidth:1,borderRadius:5,width:"100%",maxWidth:600},petItemContent:{flexDirection:"row",alignItems:"center"},petPhoto:{width:50,height:50,borderRadius:25,marginRight:10},petName:{fontSize:m.theme.fontSizes.medium,fontWeight:"bold"},petInfo:{flex:1},petDetails:{fontSize:m.theme.fontSizes.smallMedium,color:m.theme.colors.placeholder,flexWrap:"wrap"}}),r.default.create({section:{width:"100%",maxWidth:600,paddingVertical:20,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},sectionHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:"100%",marginBottom:10},sectionTitle:{fontSize:m.theme.fontSizes.large,marginBottom:10,fontWeight:"bold",color:m.theme.colors.primary},input:{width:"100%",maxWidth:600,marginBottom:10,backgroundColor:m.theme.colors.surface,padding:10,borderRadius:5,borderWidth:1,borderColor:m.theme.colors.border},fieldText:{width:"100%",maxWidth:600,fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,marginBottom:10}}),r.default.create({centeredContent:{width:"100%",maxWidth:600,alignItems:"center",alignSelf:"center"},section:{width:"100%",maxWidth:600,marginBottom:20,paddingVertical:20,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},sectionHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:"100%",marginBottom:10},sectionTitle:{fontSize:m.theme.fontSizes.large,marginBottom:10,fontWeight:"bold",color:m.theme.colors.primary},profileHeader:{alignItems:"center",marginBottom:20,width:"100%",maxWidth:600},profilePhoto:{width:120,height:120,borderRadius:60},profilePhotoPlaceholder:{backgroundColor:m.theme.colors.surface,justifyContent:"center",alignItems:"center",borderWidth:1,borderColor:m.theme.colors.border},input:{width:"100%",maxWidth:600,marginBottom:10,backgroundColor:m.theme.colors.surface,padding:10,borderRadius:5},fieldText:{width:"100%",maxWidth:600,fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,marginBottom:10},portfolioGrid:{width:"100%",flexDirection:"row",flexWrap:"wrap",justifyContent:"space-between",gap:16},portfolioCard:{width:"48%",marginBottom:16,backgroundColor:m.theme.colors.surface,borderRadius:8,overflow:"hidden",elevation:2,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.23,shadowRadius:2.62},portfolioImageContainer:{aspectRatio:4/3,width:"100%"},portfolioPhoto:{width:"100%",height:"100%",borderTopLeftRadius:8,borderTopRightRadius:8},portfolioCaption:{fontSize:m.theme.fontSizes.small,color:m.theme.colors.text,padding:8},emptyText:{textAlign:"center",color:m.theme.colors.placeholder,marginTop:16},facilitiesContainer:{flexDirection:"row",flexWrap:"wrap",gap:8,paddingHorizontal:4},facilityTag:{paddingHorizontal:16,paddingVertical:8,borderRadius:20,backgroundColor:m.theme.colors.surface,borderWidth:1,borderColor:m.theme.colors.primary,marginBottom:8},facilityTagSelected:{backgroundColor:m.theme.colors.primary},facilityTagText:{color:m.theme.colors.primary,fontSize:m.theme.fontSizes.small},facilityTagTextSelected:{color:m.theme.colors.surface},modalOverlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center"},modalContent:{width:"90%",maxWidth:500,backgroundColor:m.theme.colors.background,borderRadius:10,padding:20,maxHeight:"80%"},modalHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:20},modalTitle:{fontSize:m.theme.fontSizes.large,fontWeight:"bold"},modalScroll:{maxHeight:"70%"},modalFacilityTag:{padding:16,borderRadius:8,backgroundColor:m.theme.colors.surface,borderWidth:1,borderColor:m.theme.colors.primary,marginBottom:8},modalFacilityText:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.primary},modalFooter:{flexDirection:"row",justifyContent:"space-between",marginTop:20},modalButton:{padding:12,borderRadius:8,width:"48%",alignItems:"center"},saveButton:{backgroundColor:m.theme.colors.primary},cancelButton:{backgroundColor:m.theme.colors.surface,borderWidth:1,borderColor:m.theme.colors.primary},modalButtonText:{color:m.theme.colors.primary,fontSize:m.theme.fontSizes.medium,fontWeight:"bold"},modalButtonText2:{color:m.theme.colors.whiteText,fontSize:m.theme.fontSizes.medium,fontWeight:"bold"}});var dt=o(49162);r.default.create({webDatePicker:{padding:8,borderRadius:8,borderWidth:1,borderColor:m.theme.colors.border,fontSize:m.theme.fontSizes.medium,width:"100%",backgroundColor:m.theme.colors.background},androidButton:{padding:8,borderRadius:4,borderWidth:1,borderColor:m.theme.colors.border,backgroundColor:m.theme.colors.background},dateText:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text},disabledInput:{backgroundColor:m.theme.colors.disabled,opacity:.7},disabledText:{color:m.theme.colors.placeholder}});const ct=r.default.create({header:{flexDirection:"row",alignItems:"center",padding:16,borderBottomWidth:1,borderBottomColor:m.theme.colors.border,backgroundColor:m.theme.colors.background,zIndex:100,elevation:100},backButton:{marginRight:16},headerText:{fontSize:m.theme.fontSizes.large,fontWeight:"bold",color:m.theme.colors.primary,flex:1,fontFamily:m.theme.fonts.header.fontFamily},rightButton:{marginLeft:16}}),ut=({title:e,onBackPress:t,rightIcon:o=null,onRightPress:n=null,rightComponent:a=null,customStyles:r={}})=>{(0,y.useNavigation)();return(0,T.jsxs)(x.default,{style:[ct.header,r],children:[(0,T.jsx)(v.default,{onPress:t,style:ct.backButton,children:(0,T.jsx)(S.default,{name:"arrow-left",size:24,color:m.theme.colors.primary})}),(0,T.jsx)(C.default,{style:ct.headerText,children:e}),a||o&&(0,T.jsx)(v.default,{onPress:n,style:ct.rightButton,children:(0,T.jsx)(S.default,{name:o,size:24,color:m.theme.colors.primary})})]})};var mt=o(21815);const gt=r.default.create({container:{flex:1,backgroundColor:m.theme.colors.background,paddingTop:"android"===a.default.OS?mt.default.currentHeight:0,width:"100%",maxWidth:"100%",overflow:"hidden"},webContainer:{display:"flex",flexDirection:"column",minHeight:"85vh",width:"100%",maxWidth:"100%",overflow:"hidden"}}),ht=({children:e,style:t,useSafeArea:o=!0,backgroundColor:r=m.theme.colors.background,fullWidthHeader:i=!1,contentWidth:s="800px"})=>{const[l,d]=(0,n.useState)(j.default.get("window").width);if((0,n.useEffect)((()=>{if("web"===a.default.OS){const e=()=>{d(j.default.get("window").width)};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}}),[]),"web"===a.default.OS){const o=n.Children.toArray(e),a=i&&o.length>0?o[0]:null,l=i&&o.length>1?o.slice(1):e;return(0,T.jsxs)("div",{style:Object.assign({backgroundColor:r,width:"100%",maxWidth:"100%",minHeight:"100vh",display:"flex",flexDirection:"column"},t),children:[i&&a&&(0,T.jsx)("div",{style:{width:"100%",backgroundColor:r},children:a}),(0,T.jsx)("div",{style:Object.assign({},gt.webContainer,{maxWidth:s,width:"100%",flex:1,overflow:"hidden"}),children:l})]})}return"ios"===a.default.OS&&o?(0,T.jsx)(Ie.default,{style:[gt.container,{backgroundColor:r},t],children:e}):(0,T.jsx)(x.default,{style:[gt.container,{paddingTop:o?mt.default.currentHeight:0,backgroundColor:r},t],children:e})};var ft=o(51690);o(82459);const pt=41,yt=37,bt=-102,xt=-109;const Ct=new class{constructor(){this.queue=[],this.processing=!1,this.lastRequest=0,this.minInterval=1100}async geocode(e){return new Promise(((t,o)=>{this.queue.push({address:e,resolve:t,reject:o}),this.processQueue()}))}async processQueue(){if(!this.processing&&0!==this.queue.length){for(this.processing=!0;this.queue.length>0;){const{address:t,resolve:o,reject:n}=this.queue.shift();try{const e=Date.now()-this.lastRequest;if(e<this.minInterval){const t=this.minInterval-e;(0,g.debugLog)("MBA7890","Rate limiting: waiting ".concat(t,"ms before next geocoding request")),await new Promise((e=>setTimeout(e,t)))}this.lastRequest=Date.now();o(await this.performGeocode(t))}catch(e){n(e)}}this.processing=!1}}async performGeocode(e){const{street:t,apartment:o,city:n,state:a,zip:r}=e;let i=t;o&&(i+=" ".concat(o)),i+=", ".concat(n,", ").concat(a),r&&(i+=" ".concat(r)),i+=", USA",(0,g.debugLog)("MBA7890","Geocoding address:",i);const s=new URLSearchParams({q:i,format:"json",limit:"1",countrycodes:"us",addressdetails:"1"}),l=await fetch("".concat("https://nominatim.openstreetmap.org/search","?").concat(s),{headers:{"User-Agent":"CrittrCove/1.0 (contact@crittrcove.com)"}});if(429===l.status)throw new Error("RATE_LIMITED");if(!l.ok)throw new Error("Geocoding failed: ".concat(l.status));const d=await l.json();if(!d||0===d.length)throw new Error("No results found");const c=d[0],u=parseFloat(c.lat),m=parseFloat(c.lon);if(!this.isInColorado(u,m))throw(0,g.debugLog)("MBA7890","Address is outside Colorado bounds:",{lat:u,lng:m,address:i}),new Error("Address must be within Colorado");return(0,g.debugLog)("MBA7890","Geocoding successful:",{lat:u,lng:m,address:i}),{latitude:u,longitude:m,formatted_address:c.display_name}}isInColorado(e,t){return e>=yt&&e<=pt&&t>=xt&&t<=bt}},vt=async e=>{try{return await(async(e,t=3)=>{for(let n=1;n<=t;n++)try{return await Ct.geocode(e)}catch(o){if((0,g.debugLog)("MBA7890","Geocoding attempt ".concat(n," failed:"),o.message),"RATE_LIMITED"===o.message&&n<t){const e=1e3*Math.pow(2,n);(0,g.debugLog)("MBA7890","Rate limited, waiting ".concat(e,"ms before retry")),await new Promise((t=>setTimeout(t,e)));continue}if(n===t)throw o}})(e)}catch(t){return(0,g.debugLog)("MBA7890","Geocoding failed gracefully:",t.message),null}};var wt=o(90932);const jt=41,St=37,Tt=-102,Bt=-109;const kt=new class{constructor(){this.queue=[],this.processing=!1,this.lastRequest=0,this.minInterval=1100}async search(e){return new Promise(((t,o)=>{this.queue.push({query:e,resolve:t,reject:o}),this.processQueue()}))}async processQueue(){if(!this.processing&&0!==this.queue.length){for(this.processing=!0;this.queue.length>0;){const{query:t,resolve:o,reject:n}=this.queue.shift();try{const e=Date.now()-this.lastRequest;if(e<this.minInterval){const t=this.minInterval-e;await new Promise((e=>setTimeout(e,t)))}this.lastRequest=Date.now();o(await this.performSearch(t))}catch(e){n(e)}}this.processing=!1}}async performSearch(e){(0,g.debugLog)("MBA8901","Searching addresses for:",e);const t=new URLSearchParams({q:"".concat(e,", Colorado, USA"),format:"json",limit:"5",countrycodes:"us",addressdetails:"1",bounded:"1",viewbox:"".concat(Bt,",").concat(St,",").concat(Tt,",").concat(jt)}),o=await fetch("".concat("https://nominatim.openstreetmap.org/search","?").concat(t),{headers:{"User-Agent":"CrittrCove/1.0 (contact@crittrcove.com)"}});if(429===o.status)throw new Error("RATE_LIMITED");if(!o.ok)throw new Error("Search failed: ".concat(o.status));const n=await o.json();return n&&0!==n.length?n.filter((e=>{const t=parseFloat(e.lat),o=parseFloat(e.lon);return this.isInColorado(t,o)})).map((e=>({id:e.place_id,formatted_address:e.display_name,components:{street:e.address?.house_number&&e.address?.road?"".concat(e.address.house_number," ").concat(e.address.road):e.address?.road||"",apartment:"",city:e.address?.city||e.address?.town||e.address?.village||"",state:e.address?.state||"Colorado",zip:e.address?.postcode||""},coordinates:{latitude:parseFloat(e.lat),longitude:parseFloat(e.lon),formatted_address:e.display_name}}))):[]}isInColorado(e,t){return e>=St&&e<=jt&&t>=Bt&&t<=Tt}},At=r.default.create({container:{position:"relative",zIndex:1e3},inputContainer:{position:"relative",flexDirection:"row",alignItems:"center"},input:{flex:1,backgroundColor:m.theme.colors.background,borderRadius:8,padding:12,fontSize:16,color:m.theme.colors.text,borderWidth:1,borderColor:m.theme.colors.border,minHeight:44},inputValid:{borderColor:m.theme.colors.success,backgroundColor:m.theme.colors.success+"10"},inputDisabled:{backgroundColor:m.theme.colors.surface,color:m.theme.colors.placeholder},loadingIndicator:{position:"absolute",right:12},validIcon:{position:"absolute",right:12},suggestionsContainer:{position:"absolute",top:"100%",left:0,right:0,backgroundColor:m.theme.colors.background,borderRadius:8,borderWidth:1,borderColor:m.theme.colors.border,borderTopWidth:0,borderTopLeftRadius:0,borderTopRightRadius:0,maxHeight:200,zIndex:1001,elevation:10,shadowColor:"#000",shadowOffset:{width:0,height:4},shadowOpacity:.3,shadowRadius:6},suggestionsList:{maxHeight:200},suggestionItem:{flexDirection:"row",alignItems:"center",padding:16,borderBottomWidth:1,borderBottomColor:m.theme.colors.border,minHeight:56},lastSuggestionItem:{borderBottomWidth:0},suggestionIcon:{marginRight:12},suggestionContent:{flex:1},suggestionText:{fontSize:14,color:m.theme.colors.text,lineHeight:20},noResultsContainer:{position:"absolute",top:"100%",left:0,right:0,backgroundColor:m.theme.colors.background,borderRadius:8,borderWidth:1,borderColor:m.theme.colors.border,borderTopWidth:0,borderTopLeftRadius:0,borderTopRightRadius:0,padding:16,zIndex:1001},noResultsText:{fontSize:14,color:m.theme.colors.secondary,textAlign:"center",fontStyle:"italic"}}),_t=({value:e="",onAddressSelect:t,placeholder:o="Enter your address...",style:a={},disabled:r=!1})=>{const[i,s]=(0,n.useState)(e),[l,d]=(0,n.useState)([]),[c,u]=(0,n.useState)(!1),[h,f]=(0,n.useState)(!1),[p,y]=(0,n.useState)(null),b=(0,n.useRef)(null);(0,n.useEffect)((()=>{s(e)}),[e]);return(0,T.jsxs)(x.default,{style:[At.container,a],children:[(0,T.jsxs)(x.default,{style:At.inputContainer,children:[(0,T.jsx)(q.default,{style:[At.input,p&&At.inputValid,r&&At.inputDisabled],value:i,onChangeText:e=>{s(e),y(null),b.current&&clearTimeout(b.current),b.current=setTimeout((()=>{(async e=>{if(e.length<3)return d([]),void f(!1);u(!0);try{const t=await kt.search(e);d(t),f(t.length>0),(0,g.debugLog)("MBA8901","Found ".concat(t.length," address suggestions"))}catch(t){(0,g.debugLog)("MBA8901","Address search failed:",t.message),d([]),f(!1)}finally{u(!1)}})(e)}),500)},onBlur:()=>{setTimeout((()=>{f(!1)}),200)},placeholder:o,placeholderTextColor:m.theme.colors.placeholder,editable:!r}),c&&(0,T.jsx)(_.default,{size:"small",color:m.theme.colors.primary,style:At.loadingIndicator}),p&&(0,T.jsx)(S.default,{name:"check-circle",size:20,color:m.theme.colors.success,style:At.validIcon})]}),h&&l.length>0&&(0,T.jsx)(x.default,{style:At.suggestionsContainer,children:(0,T.jsx)(wt.default,{data:l,renderItem:({item:e,index:o})=>(0,T.jsxs)(v.default,{style:[At.suggestionItem,o===l.length-1&&At.lastSuggestionItem],onPress:()=>{return s((o=e).formatted_address),y(o),f(!1),d([]),t&&t(o),void(0,g.debugLog)("MBA8901","Address selected:",o);var o},activeOpacity:.7,children:[(0,T.jsx)(S.default,{name:"map-marker",size:20,color:m.theme.colors.primary,style:At.suggestionIcon}),(0,T.jsx)(x.default,{style:At.suggestionContent,children:(0,T.jsx)(C.default,{style:At.suggestionText,numberOfLines:2,children:e.formatted_address})})]}),keyExtractor:e=>e.id.toString(),style:At.suggestionsList,keyboardShouldPersistTaps:"handled",showsVerticalScrollIndicator:!1})}),i.length>=3&&!c&&0===l.length&&h&&(0,T.jsx)(x.default,{style:At.noResultsContainer,children:(0,T.jsx)(C.default,{style:At.noResultsText,children:"No addresses found. Please check your spelling or try a different address."})})]})},It=[{id:"none",label:"No Insurance",description:"I do not have insurance"},{id:"petplan",label:"PetPlan Insurance",description:"Comprehensive pet insurance coverage"},{id:"trupanion",label:"Trupanion",description:"Lifetime coverage for your pets"},{id:"custom",label:"Custom Insurance",description:"Upload my own insurance card"}],Mt=({visible:e,onClose:t,title:o,value:a,onSave:r,isLocation:i,isMultiline:s,isProfessional:l,isInsurance:d,selectedInsurance:c={type:"none",card:null},onInsuranceChange:u})=>{const[h,f]=(0,n.useState)(""),[p,y]=(0,n.useState)(c),[b,w]=(0,n.useState)(!1),[j,B]=(0,n.useState)(null),[k,_]=(0,n.useState)(""),[I,M]=(0,n.useState)(1),[D,R]=(0,n.useState)(null);(0,n.useEffect)((()=>{e&&(d?(y(c),M(1),R(null)):i?(_(a||""),B(null)):f(a||""))}),[e]);return(0,T.jsx)(A.default,{visible:e,transparent:!0,animationType:"fade",onRequestClose:t,children:(0,T.jsx)(x.default,{style:Dt.modalOverlay,children:(0,T.jsxs)(x.default,{style:[Dt.modalContent,d&&Dt.insuranceModalContent],children:[(0,T.jsxs)(x.default,{style:Dt.modalHeader,children:[d&&2===I&&(0,T.jsxs)(v.default,{style:Dt.backButton,onPress:()=>M(1),children:[(0,T.jsx)(S.default,{name:"arrow-left",size:24,color:m.theme.colors.primary}),(0,T.jsx)(C.default,{style:Dt.backButtonText,children:"Back"})]}),(0,T.jsx)(C.default,{style:[Dt.modalTitle,d&&2===I&&Dt.modalTitleCentered],children:o})]}),d?1===I?(0,T.jsxs)(x.default,{style:Dt.insuranceStepContent,children:[(0,T.jsx)(C.default,{style:Dt.insuranceStepTitle,children:"Choose Insurance Type"}),(0,T.jsxs)(v.default,{style:Dt.insuranceTypeButton,onPress:()=>(R("own"),void M(2)),children:[(0,T.jsx)(S.default,{name:"file-document",size:24,color:m.theme.colors.primary}),(0,T.jsxs)(x.default,{style:Dt.insuranceTypeContent,children:[(0,T.jsx)(C.default,{style:Dt.insuranceTypeTitle,children:"Use My Own Insurance"}),(0,T.jsx)(C.default,{style:Dt.insuranceTypeDescription,children:"Upload your existing insurance card"})]})]})]}):2===I?"own"===D?(0,T.jsxs)(x.default,{style:Dt.insuranceStepContent,children:[(0,T.jsx)(C.default,{style:Dt.insuranceStepTitle,children:"Upload Insurance Card"}),(0,T.jsxs)(v.default,{style:Dt.uploadButton,onPress:()=>(async e=>{if("custom"===e){const t=await Me.launchImageLibraryAsync({mediaTypes:De.MediaTypeOptions.Images,allowsEditing:!0,aspect:[16,9],quality:1});if(!t.canceled){const o={type:"custom",card:t.assets[0].uri};y(o),u(e)}}else y({type:e,card:null}),u(e)})("custom"),children:[(0,T.jsx)(S.default,{name:"file-upload",size:24,color:m.theme.colors.primary}),(0,T.jsx)(C.default,{style:Dt.uploadText,children:"Upload Insurance Card"})]}),"custom"===p.type&&p.card&&(0,T.jsxs)(x.default,{style:Dt.customInsuranceCard,children:[(0,T.jsx)(U.default,{source:{uri:p.card},style:Dt.insuranceCardImage}),(0,T.jsx)(C.default,{style:Dt.insuranceCardText,children:"Custom Insurance Card"})]})]}):(0,T.jsxs)(x.default,{style:Dt.insuranceStepContent,children:[(0,T.jsx)(C.default,{style:Dt.insuranceStepTitle,children:"Select Insurance Provider"}),It.filter((e=>"custom"!==e.id)).map((e=>(0,T.jsxs)(v.default,{style:[Dt.insuranceOption,p.type===e.id&&Dt.selectedInsuranceOption],onPress:()=>{const t={type:e.id,card:null};y(t),u(e.id)},children:[(0,T.jsx)(S.default,{name:"none"===e.id?"shield-off":"shield-check",size:24,color:m.theme.colors.primary}),(0,T.jsxs)(x.default,{style:Dt.insuranceOptionContent,children:[(0,T.jsx)(C.default,{style:Dt.insuranceOptionTitle,children:e.label}),(0,T.jsx)(C.default,{style:Dt.insuranceOptionDescription,children:e.description})]})]},e.id)))]}):null:i?(0,T.jsxs)(x.default,{style:Dt.locationContent,children:[(0,T.jsx)(C.default,{style:Dt.addressInstructions,children:'Enter your complete street address (e.g., "123 Main Street"). Only valid street addresses will appear in suggestions.'}),(0,T.jsx)(_t,{value:k,onAddressSelect:e=>{B(e),_(e.formatted_address),(0,g.debugLog)("MBA8901","Address selected in modal:",e)},placeholder:"Enter address in Colorado Springs...",style:Dt.addressAutocomplete}),j&&(0,T.jsxs)(x.default,{style:Dt.selectedAddressInfo,children:[(0,T.jsx)(S.default,{name:"check-circle",size:16,color:m.theme.colors.success}),(0,T.jsx)(C.default,{style:Dt.selectedAddressText,children:"Address validated and ready to save"})]})]}):(0,T.jsx)(q.default,{style:[Dt.modalInput,s&&Dt.multilineInput],value:h,onChangeText:f,multiline:s,numberOfLines:s?4:1,autoFocus:!0}),(0,T.jsxs)(x.default,{style:[Dt.modalButtons,{zIndex:-1}],children:[(0,T.jsx)(v.default,{style:Dt.modalCancelButton,onPress:t,children:(0,T.jsx)(C.default,{style:Dt.modalCancelText,children:"Cancel"})}),(0,T.jsx)(v.default,{style:[Dt.modalSaveButton,i&&!j&&Dt.modalSaveButtonDisabled],onPress:()=>{if(d)r(p);else if(i){if(!j)return void ft.default.alert("Invalid Address","Please select a valid address from the suggestions.");(0,g.debugLog)("MBA8901","Saving location with selected address:",j),r(j)}else r(h);t()},disabled:i&&!j,children:(0,T.jsx)(C.default,{style:Dt.modalSaveText,children:"Save"})})]})]})})})},Dt=r.default.create({container:{flex:1,backgroundColor:m.theme.colors.surface},contentWrapper:{maxWidth:1200,alignSelf:"center",width:"100%",padding:16},mainContent:{width:"100%"},desktopLayout:{flexDirection:"row",gap:24},profileSection:{marginBottom:24},profileSectionDesktop:{width:300,marginBottom:0},profileCard:{backgroundColor:m.theme.colors.surfaceContrast,borderRadius:8,padding:16},profilePhotoContainer:{position:"relative",alignItems:"center",marginBottom:16},profilePhoto:{width:200,height:200,borderRadius:8,backgroundColor:m.theme.colors.surface},profilePhotoPlaceholder:{justifyContent:"center",alignItems:"center",borderWidth:2,borderStyle:"dashed",borderColor:m.theme.colors.border},cameraButton:{position:"absolute",right:8,bottom:8,backgroundColor:m.theme.colors.primary,padding:8,borderRadius:20},profileInfo:{alignItems:"center"},nameContainer:{flexDirection:"row",alignItems:"center",gap:8,marginBottom:4},name:{fontSize:24,fontWeight:"600",color:m.theme.colors.text,fontFamily:m.theme.fonts?.regular?.fontFamily},emailContainer:{flexDirection:"row",alignItems:"center",gap:4,marginBottom:4},email:{fontSize:14,color:m.theme.colors.secondary,fontFamily:m.theme.fonts?.regular?.fontFamily},locationContainer:{flexDirection:"row",marginBottom:12,width:"100%",position:"relative",paddingHorizontal:20},locationIconWrapper:{position:"absolute",left:0,top:0},location:{fontSize:14,color:m.theme.colors.secondary,fontFamily:m.theme.fonts?.regular?.fontFamily,textAlign:"center",flex:1},locationEditIcon:{position:"absolute",right:0,top:0,padding:4},roleContainer:{flexDirection:"row",alignItems:"center",gap:4,marginBottom:4},role:{fontSize:14,color:m.theme.colors.secondary},editIcon:{padding:4},ratingContainer:{flexDirection:"row",alignItems:"center",gap:4},rating:{fontSize:16,fontWeight:"500",color:m.theme.colors.text},reviews:{fontSize:14,color:m.theme.colors.secondary},sectionsContainer:{flex:1},sectionsContainerDesktop:{paddingLeft:24},section:{backgroundColor:m.theme.colors.surfaceContrast,borderRadius:8,padding:16,marginBottom:24},sectionHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16},sectionTitle:{fontSize:18,fontWeight:"600",color:m.theme.colors.text,fontFamily:m.theme.fonts?.header?.fontFamily},editButton:{backgroundColor:"transparent"},editButtonText:{color:m.theme.colors.primary,fontSize:14,fontWeight:"500"},bioInput:{backgroundColor:m.theme.colors.surface,borderRadius:8,padding:12,minHeight:100,textAlignVertical:"top",fontSize:16,color:m.theme.colors.text},facilitiesGrid:{gap:16},facilityItem:{flexDirection:"row",alignItems:"center",backgroundColor:m.theme.colors.surface,padding:12,borderRadius:8},facilityContent:{marginLeft:12},facilityTitle:{fontSize:14,color:m.theme.colors.secondary},facilityValue:{fontSize:16,fontWeight:"500",color:m.theme.colors.text,marginTop:2},addPhotoButton:{flexDirection:"row",alignItems:"center",backgroundColor:m.theme.colors.primary,paddingHorizontal:12,paddingVertical:8,borderRadius:6,gap:6},addPhotoText:{color:m.theme.colors.background,fontSize:14,fontWeight:"500"},photoGrid:{flexDirection:"row",flexWrap:"wrap",gap:16,marginTop:16},reviewsContainer:{marginBottom:12},noReviews:{fontSize:14,color:m.theme.colors.secondary,fontStyle:"italic"},bioText:{fontSize:16,color:m.theme.colors.text,lineHeight:24,fontFamily:m.theme.fonts?.regular?.fontFamily},locationButtons:{gap:16},locationButton:{flexDirection:"row",alignItems:"center",backgroundColor:m.theme.colors.primary,padding:12,borderRadius:8,justifyContent:"center",gap:8},locationButtonText:{color:m.theme.colors.background,fontSize:16,fontWeight:"500"},orText:{textAlign:"center",color:m.theme.colors.secondary,fontSize:14},multilineInput:{minHeight:100,textAlignVertical:"top"},portfolioPhoto:{width:"30%",aspectRatio:4/3,borderRadius:8},noPhotosText:{fontSize:14,color:m.theme.colors.secondary,fontStyle:"italic",textAlign:"center",padding:20},facilitiesModalContent:{height:"80%",width:"90%",maxWidth:500},facilitiesScrollView:{flex:1,marginBottom:16},facilityPresetItem:{flexDirection:"row",alignItems:"center",padding:16,borderRadius:8,marginBottom:8,backgroundColor:m.theme.colors.background},selectedFacilityPreset:{backgroundColor:m.theme.colors.primary},facilityPresetContent:{flex:1,marginLeft:12},facilityPresetTitle:{fontSize:16,fontWeight:"500",color:m.theme.colors.text,marginBottom:4},facilityPresetDescription:{fontSize:14,color:m.theme.colors.secondary},selectedFacilityText:{color:m.theme.colors.background},checkIcon:{marginLeft:8},modalButtons:{flexDirection:"row",justifyContent:"flex-end",gap:12},modalCancelButton:{paddingHorizontal:16,paddingVertical:8,borderRadius:6,backgroundColor:m.theme.colors.surface},modalCancelText:{color:m.theme.colors.text,fontSize:14,fontWeight:"500"},modalSaveButton:{paddingHorizontal:16,paddingVertical:8,borderRadius:6,backgroundColor:m.theme.colors.primary},modalSaveText:{color:m.theme.colors.background,fontSize:14,fontWeight:"500"},locationModalContent:{width:"90%",maxWidth:500,maxHeight:"90%"},locationContent:{gap:16,paddingBottom:16},addressInstructions:{fontSize:14,color:m.theme.colors.secondary,marginBottom:8,textAlign:"center"},addressAutocomplete:{marginBottom:12},selectedAddressInfo:{flexDirection:"row",alignItems:"center",gap:8,padding:12,backgroundColor:m.theme.colors.success+"10",borderRadius:8,borderWidth:1,borderColor:m.theme.colors.success+"30"},selectedAddressText:{fontSize:14,color:m.theme.colors.success,fontWeight:"500"},addressForm:{gap:12},addressInput:{backgroundColor:m.theme.colors.background,borderRadius:8,padding:12,fontSize:16,color:m.theme.colors.text,minHeight:44},addressRow:{flexDirection:"row",gap:12,flexWrap:"wrap"},maxFacilitiesText:{fontSize:14,color:m.theme.colors.secondary,fontStyle:"italic",textAlign:"center",marginTop:8},modalSaveButtonDisabled:{opacity:.5},insuranceContent:{gap:16},customInsuranceCard:{alignItems:"center",gap:8},insuranceCardImage:{width:"100%",height:200,borderRadius:8,backgroundColor:m.theme.colors.background},insuranceCardText:{fontSize:14,color:m.theme.colors.secondary},insuranceOption:{flexDirection:"row",alignItems:"center",backgroundColor:m.theme.colors.background,padding:16,borderRadius:8,gap:16},insuranceOptionContent:{flex:1},insuranceOptionTitle:{fontSize:16,fontWeight:"500",color:m.theme.colors.text,marginBottom:4},insuranceOptionDescription:{fontSize:14,color:m.theme.colors.secondary},editButtonContent:{flexDirection:"row",alignItems:"center",gap:4},insuranceStepContent:{gap:16},insuranceStepTitle:{fontSize:18,fontWeight:"500",color:m.theme.colors.text,marginBottom:16},insuranceTypeButton:{flexDirection:"row",alignItems:"center",backgroundColor:m.theme.colors.background,padding:16,borderRadius:8,gap:16},insuranceTypeContent:{flex:1},insuranceTypeTitle:{fontSize:16,fontWeight:"500",color:m.theme.colors.text,marginBottom:4},insuranceTypeDescription:{fontSize:14,color:m.theme.colors.secondary},uploadButton:{flexDirection:"row",alignItems:"center",justifyContent:"center",backgroundColor:m.theme.colors.background,padding:16,borderRadius:8,gap:8},uploadText:{fontSize:16,color:m.theme.colors.primary,fontWeight:"500"},selectedInsuranceOption:{backgroundColor:m.theme.colors.primary+"20"},modalOverlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center"},modalContent:{backgroundColor:m.theme.colors.surface,borderRadius:8,padding:16,width:"90%",maxWidth:400,maxHeight:"90%"},modalHeader:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",marginBottom:16,position:"relative"},modalTitle:{fontSize:18,fontWeight:"600",color:m.theme.colors.text,flex:1,fontFamily:m.theme.fonts?.header?.fontFamily},modalTitleCentered:{textAlign:"center"},backButton:{flexDirection:"row",alignItems:"center",gap:4,position:"absolute",left:0,padding:8,zIndex:1},backButtonText:{color:m.theme.colors.primary,fontSize:14,fontWeight:"500"},modalInput:{backgroundColor:m.theme.colors.background,borderRadius:8,padding:12,fontSize:16,color:m.theme.colors.text,marginBottom:16},modalCloseButton:{alignSelf:"flex-end",backgroundColor:m.theme.colors.primary,paddingHorizontal:16,paddingVertical:8,borderRadius:6},modalCloseText:{color:m.theme.colors.background,fontSize:14,fontWeight:"500"}}),Rt=({profilePhoto:e,email:t,phone:o,age:a,address:r,city:i,state:s,zip:l,country:d,coordinates:c,bio:u,about_me:h,emergencyContact:f,authorizedHouseholdMembers:p,editMode:y,toggleEditMode:b,onChangeText:w,pickImage:j,setHasUnsavedChanges:B,onSaveComplete:k,isMobile:A,rating:_,reviews:I,role:M,isProfessional:D,insurance:R={type:"none",card:null},onNavigateToTab:L,name:z})=>{const{name:P}=(0,n.useContext)(g.AuthContext),[F,O]=(0,n.useState)(!1),[W,N]=(0,n.useState)(null),[H,V]=(0,n.useState)(""),[q,Y]=(0,n.useState)([]),[G,J]=(0,n.useState)(R),[$,Z]=(0,n.useState)(!1),[K,Q]=(0,n.useState)({name:z||P||"Your Name",email:t||"",bio:D?u:h,location:"".concat(r||"").concat(i?", ".concat(i):"").concat(s?", ".concat(s):"")}),X=E(),[ee,te]=(0,n.useState)({name:"",email:"",bio:"",location:"",address:"",apartment:"",city:"",state:"",zip:"",country:"USA",insurance:{type:"none",card:null}});(0,n.useEffect)((()=>{B&&((0,g.debugLog)("MBA230uvj0834h9","Updating parent component with hasUnsavedChanges:",F),B(F))}),[F,B]),(0,n.useEffect)((()=>{(0,g.debugLog)("MBA230uvj0834h9","ProfileInfoTab mounted with props:",{propName:z,authName:P,email:t,address:r,bio:u,about_me:h,profilePhoto:e,isProfessional:D});const o=c?.formatted_address||"".concat(r||"").concat(i?", ".concat(i):"").concat(s?", ".concat(s):"");Q({name:z||P||"Your Name",email:t||"",bio:D?u:h,location:o})}),[]),(0,n.useEffect)((()=>{Q((e=>Object.assign({},e,{bio:D?u:h}))),(0,g.debugLog)("MBA230uvj0834h9","Role changed - updating bio/about_me:",{isProfessional:D,bio:u,about_me:h})}),[D,u,h]);const oe=(e,t)=>{(0,g.debugLog)("MBA230uvj0834h9","Edit ".concat(e,":"),t),V("location"===e?t||"":t),N(e),O(!0),B&&B(!0)};(0,n.useEffect)((()=>{const e="".concat(i||"").concat(s?", ".concat(s):"");te({name:z||P||"Your Name",email:t||"",bio:D?u:h,location:e,address:r||"",apartment:"",city:i||"",state:s||"Colorado",zip:l||"",insurance:R})}),[]);const ne=async(e,t)=>{if(!((e,t)=>{if("insurance"===e)return JSON.stringify(t)!==JSON.stringify(ee.insurance);if("location"===e&&"object"===typeof t){const e=t.components?.street||t.street||t.address||"",o=t.components?.apartment||t.apartment||"",n=t.components?.city||t.city||"",a=t.components?.state||t.state||"Colorado",r=t.components?.zip||t.zip||"";(0,g.debugLog)("MBA12345","Checking location changes:",{originalAddress:ee.address,newAddress:e,originalApartment:ee.apartment,newApartment:o,originalCity:ee.city,newCity:n,originalState:ee.state,newState:a,originalZip:ee.zip,newZip:r});const i=e!==ee.address||o!==ee.apartment||n!==ee.city||a!==ee.state||r!==ee.zip;return(0,g.debugLog)("MBA12345","Location has changes: ".concat(i)),i}return t!==ee[e]})(e,t))return(0,g.debugLog)("MBA230uvj0834h9","No changes detected for ".concat(e,", skipping save.")),N(null),O(!1),void(B&&B(!1));(0,g.debugLog)("MBA12345","Changes detected for ".concat(e,", proceeding with save."),{value:t}),Z(!0);try{let o={};switch(e){case"name":o={name:t};break;case"email":o={email:t};break;case"bio":D?(o={bio:t},(0,g.debugLog)("MBA4928","Saving professional bio:",t)):(o={about_me:t},(0,g.debugLog)("MBA4928","Saving client about_me:",t));break;case"location":(0,g.debugLog)("MBA12345","Extracting address components from:",t);const e=await(async e=>{let t={};if(e&&"object"===typeof e&&"components"in e)(0,g.debugLog)("MBA8901","Processing validated address from autocomplete:",e),t={address:e.components.street||"",apartment:e.components.apartment||"",city:e.components.city||"",state:e.components.state||"Colorado",zip:e.components.zip||""},e.coordinates&&(t.coordinates=e.coordinates,(0,g.debugLog)("MBA8901","Using coordinates from validated address:",e.coordinates));else if(e&&"object"===typeof e){if("street"in e?t={address:e.street||"",apartment:e.apartment||"",city:e.city||"",state:e.state||"Colorado",zip:e.zip||""}:"address"in e&&(t={address:e.address||"",apartment:e.apartment||"",city:e.city||"",state:e.state||"Colorado",zip:e.zip||""}),!t.coordinates&&t.address&&t.city&&t.state){(0,g.debugLog)("MBA7890","Attempting to geocode legacy address:",t);const e=await vt({street:t.address,apartment:t.apartment,city:t.city,state:t.state,zip:t.zip});e?((0,g.debugLog)("MBA7890","Geocoding successful, adding coordinates:",e),t.coordinates=e):(0,g.debugLog)("MBA7890","Geocoding failed, saving address without coordinates")}}else if("string"===typeof e){const o=e.split(",").map((e=>e.trim()));if(t={address:o[0]||"",apartment:"",city:o[1]||"",state:o[2]||"Colorado",zip:o[3]||""},t.address&&t.city&&t.state){const e=await vt({street:t.address,apartment:t.apartment,city:t.city,state:t.state,zip:t.zip});e&&(t.coordinates=e)}}else t={address:"",apartment:"",city:"",state:"Colorado",zip:""};return t})(t);(0,g.debugLog)("MBA12345","Extracted components:",e),o={address:e.address,apartment:e.apartment,city:e.city,state:e.state,zip:e.zip},e.coordinates&&(o.coordinates=e.coordinates,(0,g.debugLog)("MBA7890","Including coordinates in profile update:",e.coordinates));break;case"insurance":o={insurance:t}}(0,g.debugLog)("MBA4928","Saving ".concat(e," to backend:"),o);const n=await(0,Ze.updateProfileInfo)(o);if((0,g.debugLog)("MBA4928","Backend response for ".concat(e,":"),n),"name"===e)Q(Object.assign({},K,{name:n.name||K.name})),te((e=>Object.assign({},e,{name:n.name||e.name})));else if("email"===e)Q(Object.assign({},K,{email:n.email||K.email})),te((e=>Object.assign({},e,{email:n.email||e.email})));else if("bio"===e)D?(Q(Object.assign({},K,{bio:n.bio||K.bio})),te((e=>Object.assign({},e,{bio:n.bio||e.bio})))):(Q(Object.assign({},K,{bio:n.about_me||K.bio})),te((e=>Object.assign({},e,{bio:n.about_me||e.bio}))));else if("location"===e){const e=n.coordinates?.formatted_address||"".concat(n.address||"").concat(n.city?", ".concat(n.city):"").concat(n.state?", ".concat(n.state):"");Q(Object.assign({},K,{location:e})),te((t=>Object.assign({},t,{location:e,address:n.address||t.address,apartment:n.apartment||t.apartment,city:n.city||t.city,state:n.state||t.state,zip:n.zip||t.zip})))}else"insurance"===e&&(J(t),te((e=>Object.assign({},e,{insurance:t}))));(0,g.debugLog)("MBA4928","Original values updated after save for ".concat(e),{originalValues:Object.assign({},ee,{[e]:"location"===e?"".concat(n.address||"").concat(n.city?", ".concat(n.city):"").concat(n.state?", ".concat(n.state):""):n[e]})}),X({message:"".concat(e.charAt(0).toUpperCase()+e.slice(1)," updated successfully"),type:"success",duration:3e3}),O(!1),B&&B(!1),k&&k(n)}catch(o){(0,g.debugLog)("MBA4928","Error saving ".concat(e,":"),o),X({message:"Failed to update ".concat(e,". Please try again."),type:"error",duration:4e3}),B&&B(!0)}finally{Z(!1),N(null)}};"".concat(i).concat(s?", ".concat(s):""),K.name;return(0,T.jsxs)(x.default,{style:Dt.container,children:[(0,T.jsx)(x.default,{style:Dt.contentWrapper,children:(0,T.jsxs)(x.default,{style:[Dt.mainContent,!A&&Dt.desktopLayout],children:[(0,T.jsx)(x.default,{style:[Dt.profileSection,!A&&Dt.profileSectionDesktop],children:(0,T.jsxs)(x.default,{style:Dt.profileCard,children:[(0,T.jsxs)(v.default,{onPress:async()=>{try{const e=await j();if(e){Z(!0);const t=new FormData,o={uri:e,type:"image/jpeg",name:"profile_photo.jpg"};t.append("profile_picture",o),(0,g.debugLog)("MBA4928","Uploading profile photo"),await(0,Ze.updateProfileInfo)(t),X({message:"Profile photo updated successfully",type:"success",duration:3e3})}}catch(e){(0,g.debugLog)("MBA4928","Error uploading profile photo:",e),X({message:"Failed to update profile photo. Please try again.",type:"error",duration:4e3})}finally{Z(!1)}},style:Dt.profilePhotoContainer,children:[e?(0,T.jsx)(U.default,{source:{uri:e},style:Dt.profilePhoto}):(0,T.jsx)(x.default,{style:[Dt.profilePhoto,Dt.profilePhotoPlaceholder],children:(0,T.jsx)(S.default,{name:"camera-plus",size:40,color:m.theme.colors.placeholder})}),(0,T.jsx)(x.default,{style:Dt.cameraButton,children:(0,T.jsx)(S.default,{name:"camera",size:20,color:m.theme.colors.background})})]}),(0,T.jsxs)(x.default,{style:Dt.profileInfo,children:[(0,T.jsxs)(x.default,{style:Dt.nameContainer,children:[(0,T.jsx)(C.default,{style:Dt.name,children:K.name}),(0,T.jsx)(v.default,{style:Dt.editIcon,onPress:()=>oe("name",K.name),children:(0,T.jsx)(S.default,{name:"pencil",size:20,color:m.theme.colors.text})})]}),(0,T.jsxs)(x.default,{style:Dt.emailContainer,children:[(0,T.jsx)(S.default,{name:"email",size:16,color:m.theme.colors.secondary}),(0,T.jsx)(C.default,{style:Dt.email,children:K.email||"No email provided"}),(0,T.jsx)(v.default,{style:Dt.editIcon,onPress:()=>oe("email",K.email),children:(0,T.jsx)(S.default,{name:"pencil",size:16,color:m.theme.colors.text})})]}),(0,T.jsxs)(x.default,{style:Dt.locationContainer,children:[(0,T.jsx)(x.default,{style:Dt.locationIconWrapper,children:(0,T.jsx)(S.default,{name:"map-marker",size:16,color:m.theme.colors.secondary})}),(0,T.jsx)(C.default,{style:Dt.location,children:K.location||"Set Location"}),(0,T.jsx)(v.default,{style:Dt.locationEditIcon,onPress:()=>oe("location",K.location),children:(0,T.jsx)(S.default,{name:"pencil",size:16,color:m.theme.colors.text})})]}),(0,T.jsx)(x.default,{style:Dt.reviewsContainer,children:_?(0,T.jsxs)(x.default,{style:Dt.ratingContainer,children:[(0,T.jsx)(S.default,{name:"star",size:20,color:m.theme.colors.warning}),(0,T.jsx)(C.default,{style:Dt.rating,children:_}),(0,T.jsxs)(C.default,{style:Dt.reviews,children:["(",I," reviews)"]})]}):(0,T.jsx)(C.default,{style:Dt.noReviews,children:"No reviews yet"})})]})]})}),(0,T.jsx)(x.default,{style:[Dt.sectionsContainer,!A&&Dt.sectionsContainerDesktop],children:(0,T.jsxs)(x.default,{style:Dt.section,children:[(0,T.jsxs)(x.default,{style:Dt.sectionHeader,children:[(0,T.jsx)(C.default,{style:Dt.sectionTitle,children:D?"Professional Bio":"About Me"}),(0,T.jsx)(v.default,{style:Dt.editButton,onPress:()=>oe("bio",K.bio),children:(0,T.jsxs)(C.default,{style:Dt.editButtonText,children:["Edit ",D?"Bio":"About Me"]})})]}),(0,T.jsx)(C.default,{style:Dt.bioText,children:K.bio||"Tell us about yourself..."})]})})]})}),(0,T.jsx)(Mt,{visible:!!W,onClose:()=>N(null),title:"Edit ".concat(W?.charAt(0).toUpperCase()).concat(W?.slice(1)),value:H,onSave:e=>{if((0,g.debugLog)("MBA4928","Save ".concat(W," to value:"),e),"insurance"===W)ne("insurance",e);else if("location"===W)ne("location",e);else{const t=Object.assign({},K);t[W]=e,Q(t),ne(W,e)}},isLocation:"location"===W,isMultiline:"bio"===W||"about_me"===W,isProfessional:D,isInsurance:"insurance"===W,selectedInsurance:G,onInsuranceChange:J})]})},Lt=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],zt=({service:e})=>(0,T.jsx)(S.default,{name:{"Dog Walking":"walk","Pet Sitting":"home","Overnight Care":"bed"}[e]||"paw",size:24,color:m.theme.colors.text}),Pt=r.default.create({container:{flex:1,backgroundColor:m.theme.colors.surface},content:{padding:24,gap:24},sectionBox:{backgroundColor:m.theme.colors.surfaceContrast,borderRadius:8,padding:16,alignSelf:"flex-start"},servicesSection:{width:"100%"},servicesList:{width:"100%"},serviceWrapper:{width:"100%"},serviceItem:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",padding:16,borderRadius:8,marginBottom:8},selectedServiceItem:{borderWidth:1,borderColor:m.theme.colors.primary},serviceItemContent:{flexDirection:"row",alignItems:"center",flex:1},serviceInfo:{marginLeft:12,flex:1},serviceName:{fontSize:16,fontWeight:"500",color:m.theme.colors.text},servicePrice:{fontSize:14,color:m.theme.colors.secondary,marginTop:2},availabilityContainer:{flex:1,width:"100%"},controlsScrollContainer:{marginBottom:16},availabilityControls:{flexDirection:"row",gap:8},controlsDivider:{height:1,backgroundColor:m.theme.colors.surface,marginBottom:16},daysScrollContainer:{marginBottom:12},daysContainer:{flexDirection:"row",gap:8},availabilityDivider:{height:4,backgroundColor:m.theme.colors.surface,marginTop:16},availabilitySection:{backgroundColor:m.theme.colors.surfaceContrast,borderRadius:8,padding:16,marginBottom:16},availabilityHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16},availabilityTitle:{fontSize:16,fontWeight:"600",color:m.theme.colors.text},editHoursButton:{backgroundColor:"transparent"},editHoursText:{color:m.theme.colors.primary,fontSize:14,fontWeight:"500"},dayItem:{borderWidth:1,borderColor:m.theme.colors.primary,backgroundColor:"transparent",paddingHorizontal:12,paddingVertical:8,borderRadius:6,position:"relative",overflow:"hidden"},petsittingDayItem:{backgroundColor:m.theme.colors.warningLight},dayText:{color:m.theme.colors.primary,fontSize:14,fontWeight:"500",zIndex:1},availabilityTime:{fontSize:14,color:m.theme.colors.secondary},serviceDivider:{backgroundColor:m.theme.colors.surface,marginVertical:8,marginHorizontal:16},availabilityList:{width:"100%"},sectionHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16},sectionTitle:{fontSize:18,fontWeight:"600",color:m.theme.colors.text},editButton:{backgroundColor:"transparent"},editButtonText:{color:m.theme.colors.primary,fontSize:14,fontWeight:"500"},controlButton:{borderRadius:20,overflow:"hidden"},blockButtonContent:{flexDirection:"row",alignItems:"center",paddingVertical:8,paddingHorizontal:12,backgroundColor:"#FEE2E2",gap:6},blockButtonText:{color:m.theme.colors.error,fontSize:14,fontWeight:"500"},partialBlockButtonContent:{flexDirection:"row",alignItems:"center",paddingVertical:8,paddingHorizontal:12,backgroundColor:"#FFEDD5",gap:6},partialBlockText:{color:"#F97316",fontSize:14,fontWeight:"500"},dateRangeButtonContent:{flexDirection:"row",alignItems:"center",paddingVertical:8,paddingHorizontal:12,backgroundColor:"#EFF6FF",gap:6},dateRangeText:{color:"#3B82F6",fontSize:14,fontWeight:"500"},unavailableDayItem:{borderColor:m.theme.colors.error},unavailableSlash:{position:"absolute",top:"50%",left:-5,right:-5,height:1,backgroundColor:m.theme.colors.error,transform:[{rotate:"45deg"}]},unavailableDayText:{color:m.theme.colors.error},nextUnavailableContainer:{paddingVertical:8,paddingHorizontal:12},nextUnavailableText:{fontSize:14,color:m.theme.colors.secondary}}),Ft=({services:e=[{id:1,name:"Dog Walking",price:25,unit:"walk",isActive:!0,unavailableDays:["Sun"]},{id:2,name:"Pet Sitting",price:35,unit:"visit",isActive:!0,unavailableDays:["Sat","Sun"]},{id:3,name:"Overnight Care",price:85,unit:"night",isActive:!0,isOvernight:!0}],onToggleService:t,onEditHours:o,onBlockService:a,onPartialDayBlock:r})=>{const{screenWidth:i}=(0,n.useContext)(g.AuthContext),s=(0,y.useNavigation)(),[l,d]=(0,n.useState)(null),c=i<=1250,u=(e,o)=>(0,T.jsxs)(v.default,{style:[Pt.serviceItem,{backgroundColor:o%2===0?m.theme.colors.proDashboard.secondary:m.theme.colors.proDashboard.tertiary},l?.id===e.id&&Pt.selectedServiceItem],onPress:()=>d(e),children:[(0,T.jsxs)(x.default,{style:Pt.serviceItemContent,children:[(0,T.jsx)(zt,{service:e.name}),(0,T.jsxs)(x.default,{style:Pt.serviceInfo,children:[(0,T.jsx)(C.default,{style:Pt.serviceName,children:e.name}),(0,T.jsxs)(C.default,{style:Pt.servicePrice,children:["$",e.price,"/",e.unit]})]})]}),(0,T.jsx)(He.default,{value:e.isActive,onValueChange:()=>t(e.id),trackColor:{false:m.theme.colors.border,true:m.theme.colors.primary},thumbColor:m.theme.colors.background})]},e.id),h=e=>e.isOvernight?(0,T.jsx)(x.default,{style:Pt.nextUnavailableContainer,children:(0,T.jsx)(C.default,{style:Pt.nextUnavailableText,children:"Next Unavailable: Dec 24-25"})}):(0,T.jsx)(H.default,{horizontal:!0,showsHorizontalScrollIndicator:!1,style:Pt.daysScrollContainer,contentContainerStyle:Pt.daysContainer,children:Lt.map((t=>{const o=e.unavailableDays?.includes(t);return(0,T.jsxs)(x.default,{style:[Pt.dayItem,o&&Pt.unavailableDayItem],children:[o&&(0,T.jsx)(x.default,{style:Pt.unavailableSlash}),(0,T.jsx)(C.default,{style:[Pt.dayText,o&&Pt.unavailableDayText],children:t})]},t)}))});return(0,T.jsx)(x.default,{style:Pt.container,children:(0,T.jsxs)(x.default,{style:[Pt.content,{flexDirection:c?"column":"row"}],children:[(0,T.jsxs)(x.default,{style:[Pt.servicesSection,!c&&{maxWidth:400},Pt.sectionBox],children:[(0,T.jsxs)(x.default,{style:Pt.sectionHeader,children:[(0,T.jsx)(C.default,{style:Pt.sectionTitle,children:"Your Services"}),(0,T.jsx)(v.default,{style:Pt.editButton,onPress:()=>s.navigate("ServiceManager"),children:(0,T.jsx)(C.default,{style:Pt.editButtonText,children:"Edit Services"})})]}),(0,T.jsx)(x.default,{style:Pt.servicesList,children:e.map(((t,o)=>(0,T.jsxs)(x.default,{style:Pt.serviceWrapper,children:[u(t,o),o!==e.length-1&&(0,T.jsx)(x.default,{style:Pt.serviceDivider})]},t.id)))})]}),(0,T.jsxs)(x.default,{style:[Pt.availabilityContainer,c&&{marginTop:24},Pt.sectionBox],children:[(0,T.jsx)(x.default,{style:Pt.sectionHeader,children:(0,T.jsx)(C.default,{style:Pt.sectionTitle,children:"Availability"})}),(0,T.jsxs)(H.default,{horizontal:!0,showsHorizontalScrollIndicator:!1,style:Pt.controlsScrollContainer,contentContainerStyle:Pt.availabilityControls,children:[(0,T.jsx)(v.default,{style:Pt.controlButton,onPress:a,children:(0,T.jsxs)(x.default,{style:Pt.blockButtonContent,children:[(0,T.jsx)(S.default,{name:"block-helper",size:20,color:m.theme.colors.error}),(0,T.jsx)(C.default,{style:Pt.blockButtonText,children:"Block All Services"})]})}),(0,T.jsx)(v.default,{style:Pt.controlButton,onPress:r,children:(0,T.jsxs)(x.default,{style:Pt.partialBlockButtonContent,children:[(0,T.jsx)(S.default,{name:"clock-outline",size:20,color:"#F97316"}),(0,T.jsx)(C.default,{style:Pt.partialBlockText,children:"Partial Day Block"})]})}),(0,T.jsx)(v.default,{style:Pt.controlButton,children:(0,T.jsxs)(x.default,{style:Pt.dateRangeButtonContent,children:[(0,T.jsx)(S.default,{name:"calendar-range",size:20,color:"#3B82F6"}),(0,T.jsx)(C.default,{style:Pt.dateRangeText,children:"Date Range"})]})})]}),(0,T.jsx)(x.default,{style:Pt.controlsDivider}),(0,T.jsx)(x.default,{style:Pt.availabilityList,children:e.map(((t,n)=>((t,n)=>(0,T.jsxs)(x.default,{style:Pt.availabilitySection,children:[(0,T.jsxs)(x.default,{style:Pt.availabilityHeader,children:[(0,T.jsx)(C.default,{style:Pt.availabilityTitle,children:t.name}),(0,T.jsx)(v.default,{style:Pt.editHoursButton,onPress:()=>o(t.id),children:(0,T.jsx)(C.default,{style:Pt.editHoursText,children:"Edit Hours"})})]}),h(t),(0,T.jsx)(C.default,{style:Pt.availabilityTime,children:t.isOvernight?"Check-in: 3 PM, Check-out: 11 AM":"Available 9 AM - 5 PM"}),n!==e.length-1&&(0,T.jsx)(x.default,{style:Pt.availabilityDivider})]}))(t,n)))})]})]})})},Ot=(e,t=0)=>{console.log("MBA93652 Starting cost calculation with data:",{occurrenceData:e,numPets:t});const{start_date:o,end_date:n,start_time:a,end_time:r,rates:{base_rate:i,additional_animal_rate:s,applies_after:l,holiday_rate:d,unit_of_time:c,additional_rates:u=[]}}=e,m=((e,t,o,n,a)=>{const[r,i,s]=e.split("-").map(Number),[l,d]=o.split(":").map(Number),[c,u,m]=t.split("-").map(Number),[g,h]=n.split(":").map(Number);console.log("MBA12348785 ========= Starting calculateProratedMultiplier ========="),console.log("MBA12348785 Input parameters:",{startDate:e,endDate:t,startTime:o,endTime:n,timeUnit:a}),console.log("MBA12348785 Parsed components:",{start:{year:r,month:i,day:s,hour:l,minute:d},end:{year:c,month:u,day:m,hour:g,minute:h}});const f=new Date(Date.UTC(r,i-1,s)),p=new Date(Date.UTC(c,u-1,m)),y=Math.floor((p-f)/864e5),b=24*y;console.log("MBA12348785 Date difference calculation:",{startDateOnly:f.toISOString(),endDateOnly:p.toISOString(),daysDiff:y,daysDiffHours:b});const x=60*l+d,C=60*g+h,v=(C-x)/60;console.log("MBA12348785 Time difference calculation:",{startTimeMinutes:x,endTimeMinutes:C,timeDiffHours:v});const w=b+v;let j;switch(console.log("MBA12348785 Total duration:",{daysDiffHours:b,timeDiffHours:v,totalHours:w}),a){case"15 Min":j=w/.25;break;case"30 Min":j=w/.5;break;case"45 Min":j=w/.75;break;case"1 Hour":j=w/1;break;case"2 Hour":j=w/2;break;case"3 Hour":j=w/3;break;case"4 Hour":j=w/4;break;case"5 Hour":j=w/5;break;case"6 Hour":j=w/6;break;case"7 Hour":j=w/7;break;case"8 Hour":j=w/8;break;case"24 Hour":case"Per Day":j=w/24;break;case"Week":j=w/168;break;default:j=1}return console.log("MBA12348785 Final calculation:",{timeUnit:a,totalHours:w,divisor:"Per Visit"===a?1:"Week"===a?168:parseInt(a)||24,result:j}),console.log("MBA12348785 ========= End calculateProratedMultiplier ========="),j})(o,n,a,r,c);console.log("MBA93652 calculateProratedMultiplier returned:",{numberOfUnits:m,unit_of_time:c,start:"".concat(o," ").concat(a),end:"".concat(n," ").concat(r)});const g=parseFloat(i)*m;console.log("MBA93652 Base cost calculation:",{numberOfUnits:m,baseTotal:g,base_rate:i});let h=0;if(t>parseInt(l)){const e=t-parseInt(l);h=parseFloat(s)*e}console.log("MBA93652 Additional animal cost:",{additionalAnimalRateTotal:h,numPets:t,applies_after:l,additional_animal_rate:s});const f=u.reduce(((e,t)=>e+parseFloat(t.amount||0)),0);console.log("MBA93652 Additional rates:",{additionalRatesTotal:f,additional_rates:u});const p=g+h+0+f;return console.log("MBA93652 Final calculation:",{baseTotal:g,additionalAnimalRateTotal:h,holidayRateTotal:0,additionalRatesTotal:f,totalCost:p}),{base_total:g,multiplier:m,additional_animal_rate_total:h,holiday_rate_total:0,additional_rates_total:f,total_cost:p}},Et=r.default.create({container:{flex:1,gap:24},section:{borderRadius:12,padding:24,marginBottom:24},sectionHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingVertical:10,borderBottomWidth:1,borderBottomColor:m.theme.colors.border,marginBottom:12},sectionTitle:{fontSize:18,fontWeight:"600",color:m.theme.colors.text},sectionDescription:{fontSize:14,color:m.theme.colors.secondary,marginBottom:16},addButton:{flexDirection:"row",alignItems:"center",backgroundColor:m.theme.colors.primary,paddingHorizontal:8,paddingVertical:4,borderRadius:6,gap:8},addButtonText:{color:m.theme.colors.background,fontSize:14,fontWeight:"500"},petsList:{gap:16},petCard:{borderRadius:12,overflow:"hidden",borderWidth:1,borderColor:m.theme.colors.border},petHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:16},petBasicInfo:{flexDirection:"row",alignItems:"center",gap:16,flex:1},petPhoto:{width:68,height:68,borderRadius:50},petInfo:{flex:1,marginLeft:12,justifyContent:"center"},petName:{fontSize:16,fontWeight:"600",color:m.theme.colors.text,marginBottom:4},petDetailsContainer:{flexDirection:"column"},petDetails:{fontSize:14,color:m.theme.colors.secondary,marginBottom:2},expandedDetails:{borderTopWidth:1,borderTopColor:m.theme.colors.border,padding:16},detailRow:{flexDirection:"row",gap:24,marginBottom:16},detailColumn:{flex:1},detailTitle:{fontSize:14,fontWeight:"600",color:m.theme.colors.text,marginBottom:8},detailText:{fontSize:14,color:m.theme.colors.secondary},preferencesGrid:{flexDirection:"row",flexWrap:"wrap",gap:12,marginTop:16},preferenceButton:{flexDirection:"row",alignItems:"center",gap:8,paddingVertical:8,paddingHorizontal:12,borderRadius:6,borderWidth:1,borderColor:m.theme.colors.primary,backgroundColor:m.theme.colors.surface},selectedPreference:{borderColor:m.theme.colors.primary,backgroundColor:"".concat(m.theme.colors.primary,"15")},preferenceText:{fontSize:14,color:m.theme.colors.primary,flex:1},selectedPreferenceText:{color:m.theme.colors.primary},checkmark:{marginLeft:"auto"},petActions:{flexDirection:"row",alignItems:"center",gap:12},editButton:{padding:4},fixButton:{padding:4,backgroundColor:"".concat(m.theme.colors.warning,"15"),borderRadius:4,marginHorizontal:4},addContactForm:{marginBottom:16,gap:12},input:{borderWidth:1,borderColor:m.theme.colors.border,borderRadius:6,padding:12,fontSize:14,color:m.theme.colors.text},submitButton:{backgroundColor:m.theme.colors.primary,padding:12,borderRadius:6,alignItems:"center"},submitButtonText:{color:m.theme.colors.background,fontSize:14,fontWeight:"500"},contactsList:{gap:12},contactCard:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:12,borderRadius:8,borderWidth:1,borderColor:m.theme.colors.border,backgroundColor:m.theme.colors.surface},contactInfo:{flex:1},contactName:{fontSize:16,fontWeight:"500",color:m.theme.colors.text},contactPhone:{fontSize:14,color:m.theme.colors.secondary},contactActions:{flexDirection:"row",gap:8},actionButton:{padding:8},emptyListText:{fontSize:14,color:m.theme.colors.secondary,fontStyle:"italic",textAlign:"center",padding:12},compatibilityContainer:{flexDirection:"column",gap:12},compatibilityItem:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingVertical:6,borderBottomWidth:1,borderBottomColor:m.theme.colors.border,flexWrap:"wrap"},compatibilityLabel:{fontSize:14,color:m.theme.colors.text,flex:.4,marginRight:10},dropdownContainer:{flexDirection:"row",alignItems:"center",gap:8,minWidth:60,justifyContent:"flex-end"},dropdownText:{fontSize:14,color:m.theme.colors.secondary},careInfoContainer:{flexDirection:"column",gap:12},medicationsContainer:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingVertical:6,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},medicationsText:{fontSize:14,color:m.theme.colors.secondary},vetInfoContainer:{flexDirection:"column",gap:12},vetInfoItem:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingVertical:6,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},vetInfoLabel:{fontSize:14,color:m.theme.colors.text},vetInfoText:{fontSize:14,color:m.theme.colors.secondary},documentButton:{flexDirection:"row",alignItems:"center",gap:8},documentButtonText:{fontSize:14,color:m.theme.colors.primary},dropdownContainerEdit:{flexDirection:"row",alignItems:"center",gap:8,minWidth:60,justifyContent:"flex-end",flexWrap:"wrap"},optionButton:{padding:8,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:6,marginLeft:10,marginBottom:5},selectedOption:{borderColor:m.theme.colors.primary,backgroundColor:"".concat(m.theme.colors.primary,"15")},optionText:{fontSize:14,color:m.theme.colors.text},selectedOptionText:{color:m.theme.colors.primary},editInput:{borderWidth:1,borderColor:m.theme.colors.border,borderRadius:6,padding:12,fontSize:14,color:m.theme.colors.text},editInputMedications:{borderWidth:1,borderColor:m.theme.colors.border,borderRadius:6,padding:12,fontSize:14,color:m.theme.colors.text,flex:1,marginLeft:10},editInputShort:{borderWidth:1,borderColor:m.theme.colors.border,borderRadius:6,padding:12,fontSize:14,color:m.theme.colors.text,width:"55%",marginLeft:"auto"},editInputWeight:{borderWidth:1,borderColor:m.theme.colors.border,borderRadius:6,padding:12,fontSize:14,color:m.theme.colors.text,width:"40%",marginLeft:"auto"},uploadButton:{flexDirection:"row",alignItems:"center",gap:8,backgroundColor:m.theme.colors.primary,paddingHorizontal:12,paddingVertical:8,borderRadius:6},uploadButtonText:{color:m.theme.colors.background,fontSize:14,fontWeight:"500"},documentActionContainer:{flexDirection:"column",gap:8},documentsList:{marginTop:8},documentItem:{flexDirection:"row",alignItems:"center",gap:8,paddingVertical:6},documentName:{fontSize:14,color:m.theme.colors.text,flex:1},viewDocButton:{paddingHorizontal:8,paddingVertical:4,borderRadius:4,backgroundColor:"".concat(m.theme.colors.primary,"15")},viewDocText:{fontSize:12,color:m.theme.colors.primary},noDocumentsText:{fontSize:14,color:m.theme.colors.secondary,fontStyle:"italic",marginTop:8},detailSection:{marginTop:16},editContainer:{flexWrap:"wrap",gap:16,alignItems:"flex-start"},inputsWrapper:{flexDirection:"row",flexWrap:"wrap",gap:16,flex:1},inputWrapper:{minWidth:150,flexBasis:"46%",flexGrow:1,marginBottom:8},inputLabel:{fontSize:12,color:m.theme.colors.secondary,marginBottom:4},profilePhotoButton:{position:"relative"},plusIconContainer:{position:"absolute",bottom:0,right:0,backgroundColor:m.theme.colors.background,borderRadius:10},sectionRow:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16},editMainContainer:{width:"100%",marginBottom:16},editHeaderRow:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:"100%",marginBottom:16},editProfileContainer:{marginBottom:16,alignItems:"center"},editDetailsContainer:{width:"100%"},editActions:{flexDirection:"row",gap:12,alignItems:"center",flexWrap:"wrap"},editActionsSmallScreen:{flexDirection:"column",alignItems:"stretch",gap:8},buttonRowTop:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:8},buttonRowBottom:{flexDirection:"row",justifyContent:"flex-end",alignItems:"center",marginTop:8,gap:4},dateInfoContainer:{flexDirection:"column",gap:12},dateInfoItem:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingVertical:6,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},dateInfoLabel:{fontSize:14,color:m.theme.colors.text,flex:1},dateInfoText:{fontSize:14,color:m.theme.colors.secondary},customDatePickerContainer:{flexDirection:"row",alignItems:"center",borderWidth:1,borderColor:m.theme.colors.border,borderRadius:6,overflow:"hidden",height:46},dateInputBox:{flex:1,height:"100%",justifyContent:"center",paddingHorizontal:12},dateInputText:{fontSize:14,color:m.theme.colors.text},placeholderText:{color:m.theme.colors.placeholder},calendarButton:{width:46,height:"100%",backgroundColor:m.theme.colors.surface,borderLeftWidth:1,borderLeftColor:m.theme.colors.border,justifyContent:"center",alignItems:"center"},datePickerContainer:{flex:1,maxWidth:"60%",marginLeft:"auto",marginRight:10},"@media (min-width: 900px)":{petDetailsContainer:{flexDirection:"row",flexWrap:"wrap",gap:8},petDetails:{marginRight:8}},modalOverlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center"},calendarModalContent:{backgroundColor:m.theme.colors.background,borderRadius:12,padding:20,width:"90%",maxWidth:420},calendarModalHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:20},calendarModalTitle:{fontSize:20,fontWeight:"600",color:m.theme.colors.text},closeButton:{padding:4},calendarHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16},calendarNavButton:{padding:8},calendarMonthYear:{fontSize:18,fontWeight:"600",color:m.theme.colors.text},weekdayLabels:{flexDirection:"row",justifyContent:"space-around",marginBottom:8},weekdayLabel:{flex:1,textAlign:"center",fontSize:14,fontWeight:"500",color:m.theme.colors.secondary,paddingVertical:8},calendarGrid:{marginBottom:16},calendarRow:{flexDirection:"row",justifyContent:"space-around",marginBottom:8},calendarDay:{flex:1,aspectRatio:1,alignItems:"center",justifyContent:"center",borderRadius:8,margin:2},calendarDayText:{fontSize:16,color:m.theme.colors.text},calendarDayOtherMonth:{opacity:.3},calendarDayTextOtherMonth:{color:m.theme.colors.placeholder},calendarDaySelected:{backgroundColor:m.theme.colors.primary},calendarDayTextSelected:{color:m.theme.colors.background,fontWeight:"600"},confirmButton:{backgroundColor:m.theme.colors.primary,borderRadius:8,padding:14,alignItems:"center",marginTop:8},confirmButtonText:{color:m.theme.colors.background,fontSize:16,fontWeight:"600"},stackedFields:{flexDirection:"column",gap:16,marginBottom:16},fullWidth:{width:"100%"},saveButton:{borderWidth:1,borderColor:m.theme.colors.primary,borderRadius:6,paddingHorizontal:12,paddingVertical:8,backgroundColor:m.theme.colors.primary,marginRight:8,alignItems:"center",justifyContent:"center"},saveButtonText:{color:"white",fontSize:14,fontWeight:"500"},deleteButton:{padding:8,marginRight:4,borderRadius:6,alignItems:"center",justifyContent:"center"},errorModalContent:{backgroundColor:m.theme.colors.surface,borderRadius:12,padding:24,width:"90%",maxWidth:500},successModalContent:{borderLeftWidth:4,borderLeftColor:m.theme.colors.success},errorModalHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16},successModalHeader:{},errorModalTitle:{fontSize:18,fontWeight:"bold",color:m.theme.colors.error},successModalTitle:{color:m.theme.colors.success},errorModalMessage:{marginBottom:24,fontSize:16,lineHeight:24},successModalMessage:{},errorModalButton:{backgroundColor:m.theme.colors.primary,padding:12,borderRadius:8,alignItems:"center"},successModalButton:{backgroundColor:m.theme.colors.success},errorModalButtonText:{color:m.theme.colors.surface,fontWeight:"bold"},successModalButtonText:{},editButtonTopRight:{position:"absolute",top:12,right:12,zIndex:2},chevronButtonBottomRight:{position:"absolute",bottom:12,right:12,zIndex:2},petInfoWithButtonPadding:{paddingRight:20},dropdownContainer:{flexDirection:"row",justifyContent:"center",alignItems:"center",gap:12,marginBottom:16},dropdownButton:{flexDirection:"row",alignItems:"center",backgroundColor:m.theme.colors.surface,paddingHorizontal:12,paddingVertical:8,borderRadius:6,borderWidth:1,borderColor:m.theme.colors.border,minWidth:120},dropdownButtonText:{fontSize:16,color:m.theme.colors.text,marginRight:8},dropdownList:{position:"absolute",top:100,left:20,right:20,backgroundColor:m.theme.colors.surface,borderRadius:8,borderWidth:1,borderColor:m.theme.colors.border,zIndex:1e3,maxHeight:200,elevation:5,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:3.84},dropdownScrollView:{maxHeight:200},dropdownItem:{paddingVertical:12,paddingHorizontal:16,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},dropdownItemSelected:{backgroundColor:m.theme.colors.primary+"20"},dropdownItemText:{fontSize:16,color:m.theme.colors.text},dropdownItemTextSelected:{color:m.theme.colors.primary,fontWeight:"600"}}),Wt=({pets:e=[],preferences:t={homeEnvironment:[],emergencyContacts:[],authorizedHouseholdMembers:[]},onAddPet:r,onEditPet:i,onDeletePet:s,onReplacePet:l,onUpdatePreferences:d,userRole:c,isMobile:u})=>{const[h,f]=(0,n.useState)(new Set),[p,y]=(0,n.useState)({name:"",phone:""}),[b,w]=(0,n.useState)({name:"",phone:""}),[B,k]=(0,n.useState)(!1),[_,I]=(0,n.useState)(!1),[D,R]=(0,n.useState)(new Set),[L,z]=(0,n.useState)({}),[P,F]=(0,n.useState)({}),[O,W]=(0,n.useState)({isVisible:!1,currentField:null,currentPetId:null,selectedDate:new Date}),[N,V]=(0,n.useState)((new Date).getMonth()),[Y,G]=(0,n.useState)((new Date).getFullYear()),[J,$]=(0,n.useState)(j.default.get("window").width),Z=E(),[K,Q]=(0,n.useState)(!1),[X,ee]=(0,n.useState)(!0),[te,oe]=(0,n.useState)({visible:!1,petId:null,petName:"",isDeleting:!1}),[ne,ae]=(0,n.useState)(!1),[re,ie]=(0,n.useState)(!1);(0,n.useEffect)((()=>{const e=()=>{$(j.default.get("window").width)};return j.default.addEventListener("change",e),()=>{j.default.removeEventListener&&j.default.removeEventListener("change",e)}}),[]);const se=["Yes","No","N/A"],le=["Low","Medium","High","N/A"],de=["Male","Female"],ce=(e,t)=>{let o="No Option Selected";return e&&t&&(null===e[t]?o="N/A":!0===e[t]?o="Yes":!1===e[t]?o="No":"string"===typeof e[t]&&(o=e[t])),(0,T.jsx)(x.default,{style:Et.dropdownContainer,children:(0,T.jsx)(C.default,{style:Et.dropdownText,children:o})})},ue=e=>{let t="No Option Selected";return e&&void 0!==e.energyLevel&&(null===e.energyLevel?t="N/A":"LOW"===e.energyLevel?t="Low":"MODERATE"===e.energyLevel?t="Medium":"HIGH"===e.energyLevel?t="High":"string"===typeof e.energyLevel?t=e.energyLevel:e.energyLevel&&"object"===typeof e.energyLevel&&(t="No Option Selected")),(0,T.jsx)(x.default,{style:Et.dropdownContainer,children:(0,T.jsx)(C.default,{style:Et.dropdownText,children:t})})},me=e=>{f((t=>{const o=new Set(t);return o.has(e)?o.delete(e):o.add(e),o}))},ge=t=>{const o=e.find((e=>e.id===t));z((e=>Object.assign({},e,{[t]:Object.assign({},o)}))),R((e=>{const o=new Set(e);return o.add(t),o}))},he=async t=>{const o=e.find((e=>e.id===t)),n=o?o.name:"this pet";oe({visible:!0,petId:t,petName:n,isDeleting:!1})},fe=e=>{if(!e)return null;const[t,o,n]=e.split("-");return"".concat(n,"-").concat(t,"-").concat(o)},pe=e=>{if(!e)return null;const[t,o,n]=e.split("-");return"".concat(o,"-").concat(n,"-").concat(t)},ye=async t=>{if(K)(0,g.debugLog)("MBA5555","SAVE PET - Already saving, ignoring duplicate click");else try{Q(!0),(0,g.debugLog)("MBA5555","SAVE PET - Starting save with pets:",e.map((e=>({id:e.id,name:e.name||"unnamed"})))),(0,g.debugLog)("MBA5555","SAVE PET - Saving petId:",t);const n=L[t]||{},a={name:n.name||"",species:n.type||"",breed:n.breed||"",age_years:n.ageYears,age_months:n.ageMonths,weight:n.weight,birthday:n.birthday?fe(n.birthday):null,sex:n.sex,adoption_date:n.adoptionDate?fe(n.adoptionDate):null,pet_description:n.description||"",friendly_with_children:n.childrenFriendly,friendly_with_cats:n.catFriendly,friendly_with_dogs:n.dogFriendly,spayed_neutered:n.spayedNeutered,house_trained:n.houseTrained,microchipped:n.microchipped,feeding_schedule:n.feedingInstructions||"",potty_break_schedule:n.pottyBreakSchedule||"",energy_level:n.energyLevel||"",can_be_left_alone:n.canBeLeftAlone,medication_notes:n.medicalNotes||"",special_care_instructions:n.specialCareInstructions||"",vet_name:n.vetName||"",vet_address:n.vetAddress||"",vet_phone:n.vetPhone||"",insurance_provider:n.insuranceProvider||"",vet_documents:n.vetDocuments||[]};(0,g.debugLog)("MBA5555","SAVE PET - Pet data being sent:",a);const r=String(t).startsWith("temp_");(0,g.debugLog)("MBA5555","SAVE PET - Is this a new pet?",r);let s="";if(r){(0,g.debugLog)("MBA5555","SAVE PET - Creating a new pet with backend API call");try{const e=await(0,Ze.addPet)(a);if((0,g.debugLog)("MBA5555","SAVE PET - API response from addPet:",e),e&&e.pet&&e.pet.pet_id){const o=e.pet.pet_id,a=Object.assign({},n,e.pet,{id:o,type:e.pet.species||n.type,feedingInstructions:e.pet.feeding_schedule||n.feedingInstructions,medicalNotes:e.pet.medication_notes||n.medicalNotes,pottyBreakSchedule:e.pet.potty_break_schedule||n.pottyBreakSchedule,specialCareInstructions:e.pet.special_care_instructions||n.specialCareInstructions,birthday:e.pet.birthday?pe(e.pet.birthday):n.birthday,adoptionDate:e.pet.adoption_date?pe(e.pet.adoption_date):n.adoptionDate});(0,g.debugLog)("MBA5555","SAVE PET - Successfully created pet. Old ID:",t,"New ID:",o),ke(t,a),s='Pet "'.concat(a.name,'" was successfully created!'),Z({message:s,type:"success",duration:3e3}),R((e=>{const o=new Set(e);return o.delete(t),o})),z((e=>{const o=Object.assign({},e);return delete o[t],o})),f((e=>{const n=new Set(e);return n.delete(t),n.add(o),n}))}}catch(o){return(0,g.debugLog)("MBA5555","SAVE PET - API error adding pet:",o),Q(!1),void Be("Failed to Create Pet",o)}}else{(0,g.debugLog)("MBA5555","SAVE PET - Updating existing pet:",t);try{const e=await(0,Ze.updatePet)(t,a);if((0,g.debugLog)("MBA5555","SAVE PET - API response from updatePet:",e),e){const o=Object.assign({},n,e,{id:t,type:e.species||n.type,feedingInstructions:e.feeding_schedule||n.feedingInstructions,medicalNotes:e.medication_notes||n.medicalNotes,pottyBreakSchedule:e.potty_break_schedule||n.pottyBreakSchedule,specialCareInstructions:e.special_care_instructions||n.specialCareInstructions,birthday:e.birthday?pe(e.birthday):n.birthday,adoptionDate:e.adoption_date?pe(e.adoption_date):n.adoptionDate});i(t,o),s='Pet "'.concat(o.name,'" was successfully updated!'),Z({message:s,type:"success",duration:3e3}),R((e=>{const o=new Set(e);return o.delete(t),o})),z((e=>{const o=Object.assign({},e);return delete o[t],o})),(0,g.debugLog)("MBA5555","SAVE PET - Successfully updated pet:",t)}}catch(o){return(0,g.debugLog)("MBA5555","SAVE PET - API error updating pet:",o),Be("Failed to Update Pet",o),void Q(!1)}}setTimeout((()=>{Q(!1),(0,g.debugLog)("MBA5555","SAVE PET - Final state after all operations:",e.map((e=>({id:e.id,name:e.name||"unnamed"}))))}),100)}catch(n){(0,g.debugLog)("MBA5555","SAVE PET - Unexpected error saving pet:",n),Q(!1),Be("Failed to Save Pet",n)}},be=e=>{e&&e.toString().startsWith("temp_")&&((0,g.debugLog)("MBA456","Discarding newly added pet:",e),s(e)),R((t=>{const o=new Set(t);return o.delete(e),o})),z((t=>{const o=Object.assign({},t);return delete o[e],o}))},xe=(e,t,o)=>{z((n=>Object.assign({},n,{[e]:Object.assign({},n[e]||{},{[t]:o})}))),(0,g.debugLog)("MBA456","Editing pet field",{petId:e,field:t,value:o})},Ce=(e,t)=>{try{if(!e||!t)return!1;const o=String(e),n="".concat(o,"-").concat(t);return!0===P[n]}catch(o){return console.error("Error checking if section is expanded:",o.message||"Unknown error"),!1}},ve=(e,t,o)=>{try{if(!e||!o)return console.warn("Missing required parameters in renderSectionHeader"),null;const n="string"===typeof t?t:"Section",a=Ce(e,o);return(0,T.jsxs)(v.default,{style:Et.sectionHeader,onPress:t=>((e,t,o)=>{try{if(o&&"function"===typeof o.stopPropagation&&o.stopPropagation(),!e)return void console.warn("Missing petId in toggleSection");if(!t)return void console.warn("Missing sectionName in toggleSection");const n=String(e),a=String(t),r="".concat(n,"-").concat(a);F((e=>{if(!e||"object"!==typeof e){const e={};return e[r]=!0,e}const t=Object.assign({},e),o=!0===t[r];return t[r]=!o,t}))}catch(n){console.error("Error toggling section:",n.message||"Unknown error")}})(e,o,t),children:[(0,T.jsx)(C.default,{style:Et.detailTitle,children:n}),(0,T.jsx)(S.default,{name:a?"chevron-up":"chevron-down",size:20,color:m.theme.colors.text})]})}catch(n){return console.error("Error rendering section header:",n.message||"Unknown error"),null}},we=e=>{if(!e)return"";const t=(e.getMonth()+1).toString().padStart(2,"0"),o=e.getDate().toString().padStart(2,"0"),n=e.getFullYear();return"".concat(t,"-").concat(o,"-").concat(n)},je=(e,t)=>{const o=(e=>{if(!e)return new Date;const[t,o,n]=e.split("-").map((e=>parseInt(e,10)));return!t||!o||!n||isNaN(t)||isNaN(o)||isNaN(n)?new Date:new Date(n,t-1,o)})(L[e]?.[t]);V(o.getMonth()),G(o.getFullYear()),W({isVisible:!0,currentField:t,currentPetId:e,selectedDate:o})},Se=(e,t)=>{if("android"!==a.default.OS){if(t){const e=we(t);xe(O.currentPetId,O.currentField,e)}W({isVisible:!1,currentField:null,currentPetId:null,selectedDate:null})}else{if("dismissed"===e?.type)return void W((e=>Object.assign({},e,{isVisible:!1})));if(t){const e=we(t);xe(O.currentPetId,O.currentField,e)}W((e=>Object.assign({},e,{isVisible:!1})))}},Te=(0,n.useMemo)((()=>{if(!O.isVisible)return[];const e=O.selectedDate||new Date,t=new Date(Y,N,1),o=new Date(Y,N+1,0).getDate(),n=t.getDay(),a=7*Math.ceil((o+n)/7),r=[];let i=1-n;for(let l=0;l<a;l++){const t=new Date(Y,N,i),o=t.getMonth()===N,n=o&&t.getDate()===e.getDate()&&t.getMonth()===e.getMonth()&&t.getFullYear()===e.getFullYear();r.push({date:t,day:t.getDate(),isCurrentMonth:o,isSelectedDate:n}),i++}const s=[];for(let l=0;l<r.length;l+=7)s.push(r.slice(l,l+7));return s}),[N,Y,O.selectedDate,O.isVisible]),Be=(e,t)=>{let o="There was a problem with this operation. Please try again.";if(t.response&&t.response.data){const e=t.response.data.details;e?(o="Error details: ",Object.keys(e).forEach((t=>{o+="".concat(t,": ").concat(e[t].join(", "))}))):t.response.data.error&&(o=t.response.data.error)}else t.message&&(o=t.message);Z({message:"".concat(e,": ").concat(o),type:"error",duration:5e3})},ke=(t,o)=>{try{(0,g.debugLog)("MBA5555","REPLACE PET - Replacing temp pet with real pet in parent state");const d=[...e],c=d.findIndex((e=>e.id===t));if(-1!==c){const e=[...d.slice(0,c),o,...d.slice(c+1)];(0,g.debugLog)("MBA5555","REPLACE PET - Before replace:",d.map((e=>({id:e.id,name:e.name||"unnamed"})))),(0,g.debugLog)("MBA5555","REPLACE PET - After replace:",e.map((e=>({id:e.id,name:e.name||"unnamed"}))));try{(0,g.debugLog)("MBA5555","REPLACE PET - Calling onReplacePet with new array"),l(e),(0,g.debugLog)("MBA5555","REPLACE PET - Atomic replacement completed")}catch(n){(0,g.debugLog)("MBA5555","REPLACE PET - Error in onReplacePet callback:",n);try{(0,g.debugLog)("MBA5555","REPLACE PET - Trying fallback: delete + add"),s(t),setTimeout((()=>{r(o)}),50)}catch(a){throw(0,g.debugLog)("MBA5555","REPLACE PET - Even fallback failed:",a),a}}}else{(0,g.debugLog)("MBA5555","REPLACE PET - Temp pet not found in array of length "+d.length),(0,g.debugLog)("MBA5555","REPLACE PET - Current pet IDs: "+d.map((e=>e.id)).join(", ")),(0,g.debugLog)("MBA5555","REPLACE PET - Temp pet ID we're looking for: "+t),(0,g.debugLog)("MBA5555","REPLACE PET - Falling back to add");try{r(o)}catch(i){throw(0,g.debugLog)("MBA5555","REPLACE PET - Error in onAddPet fallback:",i),i}}}catch(d){throw(0,g.debugLog)("MBA5555","REPLACE PET - Unexpected error during pet replacement:",d),d}};return(0,T.jsxs)(H.default,{style:Et.container,children:[(()=>{if(!O.isVisible)return null;if("android"===a.default.OS)return(0,T.jsx)(dt.default,{value:O.selectedDate,mode:"date",display:"default",onChange:Se});const e=["January","February","March","April","May","June","July","August","September","October","November","December"],t=(new Date).getFullYear(),o=Array.from({length:101},((e,o)=>t-o));return(0,T.jsx)(A.default,{visible:O.isVisible,transparent:!0,animationType:"fade",onRequestClose:()=>{W((e=>Object.assign({},e,{isVisible:!1}))),ae(!1),ie(!1)},children:(0,T.jsx)(v.default,{style:Et.modalOverlay,activeOpacity:1,onPress:()=>{ae(!1),ie(!1)},children:(0,T.jsxs)(x.default,{style:Et.calendarModalContent,children:[(0,T.jsxs)(x.default,{style:Et.calendarModalHeader,children:[(0,T.jsxs)(C.default,{style:Et.calendarModalTitle,children:["Select ","birthday"===O.currentField?"Birthday":"Adoption Date"]}),(0,T.jsx)(v.default,{onPress:()=>{W((e=>Object.assign({},e,{isVisible:!1}))),ae(!1),ie(!1)},style:Et.closeButton,children:(0,T.jsx)(S.default,{name:"close",size:24,color:m.theme.colors.text})})]}),(0,T.jsx)(x.default,{style:Et.calendarHeader,children:(0,T.jsxs)(x.default,{style:Et.dropdownContainer,children:[(0,T.jsxs)(v.default,{style:Et.dropdownButton,onPress:e=>{e.stopPropagation(),ae(!ne),ie(!1)},children:[(0,T.jsx)(C.default,{style:Et.dropdownButtonText,children:e[N]}),(0,T.jsx)(S.default,{name:ne?"chevron-up":"chevron-down",size:20,color:m.theme.colors.text})]}),(0,T.jsxs)(v.default,{style:Et.dropdownButton,onPress:e=>{e.stopPropagation(),ie(!re),ae(!1)},children:[(0,T.jsx)(C.default,{style:Et.dropdownButtonText,children:Y}),(0,T.jsx)(S.default,{name:re?"chevron-up":"chevron-down",size:20,color:m.theme.colors.text})]})]})}),ne&&(0,T.jsx)(v.default,{style:Et.dropdownList,activeOpacity:1,onPress:e=>e.stopPropagation(),children:(0,T.jsx)(H.default,{style:Et.dropdownScrollView,children:e.map(((e,t)=>(0,T.jsx)(v.default,{style:[Et.dropdownItem,N===t&&Et.dropdownItemSelected],onPress:e=>{e.stopPropagation(),V(t),ae(!1)},children:(0,T.jsx)(C.default,{style:[Et.dropdownItemText,N===t&&Et.dropdownItemTextSelected],children:e})},e)))})}),re&&(0,T.jsx)(v.default,{style:Et.dropdownList,activeOpacity:1,onPress:e=>e.stopPropagation(),children:(0,T.jsx)(H.default,{style:Et.dropdownScrollView,children:o.map((e=>(0,T.jsx)(v.default,{style:[Et.dropdownItem,Y===e&&Et.dropdownItemSelected],onPress:t=>{t.stopPropagation(),G(e),ie(!1)},children:(0,T.jsx)(C.default,{style:[Et.dropdownItemText,Y===e&&Et.dropdownItemTextSelected],children:e})},e)))})}),(0,T.jsx)(v.default,{activeOpacity:1,onPress:e=>e.stopPropagation(),children:(0,T.jsx)(x.default,{style:Et.weekdayLabels,children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(((e,t)=>(0,T.jsx)(C.default,{style:Et.weekdayLabel,children:e},t)))})}),(0,T.jsx)(v.default,{activeOpacity:1,onPress:e=>e.stopPropagation(),children:(0,T.jsx)(x.default,{style:Et.calendarGrid,children:Te.map(((e,t)=>(0,T.jsx)(x.default,{style:Et.calendarRow,children:e.map(((e,t)=>(0,T.jsx)(v.default,{style:[Et.calendarDay,!e.isCurrentMonth&&Et.calendarDayOtherMonth,e.isSelectedDate&&Et.calendarDaySelected],onPress:t=>{var o;t.stopPropagation(),e.isCurrentMonth&&(o=e.date,ae(!1),ie(!1),W((e=>Object.assign({},e,{selectedDate:o}))))},disabled:!e.isCurrentMonth,children:(0,T.jsx)(C.default,{style:[Et.calendarDayText,!e.isCurrentMonth&&Et.calendarDayTextOtherMonth,e.isSelectedDate&&Et.calendarDayTextSelected],children:e.day})},t)))},t)))})}),(0,T.jsx)(v.default,{style:Et.confirmButton,onPress:e=>{e.stopPropagation(),Se(null,O.selectedDate)},children:(0,T.jsx)(C.default,{style:Et.confirmButtonText,children:"Confirm"})})]})})})})(),(0,T.jsx)(M,{visible:te.visible,onClose:()=>{oe({visible:!1,petId:null,petName:"",isDeleting:!1})},onConfirm:async()=>{try{const{petId:e,petName:t}=te;oe((e=>Object.assign({},e,{isDeleting:!0}))),(0,g.debugLog)("MBA456","Attempting to delete pet with ID:",e),Z({message:"Deleting ".concat(t,"..."),type:"info",duration:3e3}),await(0,Ze.deletePet)(e),(0,g.debugLog)("MBA456","Successfully deleted pet:",e),s(e),oe({visible:!1,petId:null,petName:"",isDeleting:!1}),Z({message:"".concat(t," has been successfully deleted."),type:"success",duration:3e3})}catch(e){(0,g.debugLog)("MBA456","Error deleting pet:",e),oe((e=>Object.assign({},e,{isDeleting:!1})));let t="There was a problem deleting the pet. Please try again or contact support.";e.response&&e.response.data&&e.response.data.error&&(t=e.response.data.error),Z({message:t,type:"error",duration:5e3})}},actionText:"delete ".concat(te.petName),isLoading:te.isDeleting}),(0,T.jsxs)(x.default,{style:[Et.section,{backgroundColor:m.theme.colors.surfaceContrast}],children:[(0,T.jsxs)(x.default,{style:Et.sectionHeader,children:[(0,T.jsx)(C.default,{style:Et.sectionTitle,children:"My Pets"}),(0,T.jsxs)(v.default,{style:Et.addButton,onPress:()=>{const t=e.filter((e=>String(e.id).startsWith("temp_")));if((0,g.debugLog)("MBA5555","ADD PET - Existing temp pets:",t.map((e=>e.id))),t.length>0){(0,g.debugLog)("MBA5555","ADD PET - Found existing temp pet, not creating a new one");const e=t[0];return R((t=>{const o=new Set(t);return o.add(e.id),o})),void f((t=>{const o=new Set(t);return o.add(e.id),o}))}const o="temp_".concat(Date.now());(0,g.debugLog)("MBA5555","ADD PET - Creating new pet with temp ID:",o);const n={id:o,name:"",breed:"",birthday:"",type:"",feedingInstructions:"",medicalNotes:"",pottyBreakSchedule:"",specialCareInstructions:"",childrenFriendly:void 0,dogFriendly:void 0,catFriendly:void 0,spayedNeutered:void 0,houseTrained:void 0,microchipped:void 0,energyLevel:void 0,canBeLeftAlone:void 0,medications:"",vetName:"",vetAddress:"",vetPhone:"",insuranceProvider:"",vetDocuments:[],sex:void 0,weight:"",adoptionDate:""};R((e=>{const t=new Set(e);return t.add(o),t})),z((e=>Object.assign({},e,{[o]:Object.assign({},n)}))),f((e=>{const t=new Set(e);return t.add(o),t})),(0,g.debugLog)("MBA5555","ADD PET - Calling onAddPet with new pet (adding to top of list)"),r(Object.assign({},n,{_addToTop:!0})),setTimeout((()=>{(0,g.debugLog)("MBA5555","ADD PET - Final state:",e.map((e=>({id:e.id,name:e.name||"unnamed"}))))}),100)},children:[(0,T.jsx)(S.default,{name:"plus",size:20,color:m.theme.colors.background}),(0,T.jsx)(C.default,{style:Et.addButtonText,children:"Add Pet"})]})]}),(0,T.jsx)(x.default,{style:Et.petsList,children:e.map((e=>{try{if(!e||"object"!==typeof e||!e.id)return console.warn("Invalid pet in renderPetCard"),null;const t=h.has(e.id),n=D.has(e.id),a=L[e.id]||e,r=J<500,i=e.id&&String(e.id).startsWith("temp_"),s="string"===typeof e.name?e.name:"",l="string"===typeof e.breed?e.breed:"",d="string"===typeof e.type?e.type:"",c=e.birthday?(e=>{if(!e)return"";const t=new Date,o=new Date(e);let n=t.getFullYear()-o.getFullYear(),a=t.getMonth()-o.getMonth();a<0&&(n--,a+=12);let r="";return n>0&&(r+="".concat(n," year").concat(n>1?"s":"")),a>0&&(r&&(r+=" "),r+="".concat(a," month").concat(a>1?"s":"")),r||(r="< 1 month"),r})(e.birthday):"No age set";return(0,T.jsxs)(x.default,{style:Et.petCard,children:[(0,T.jsxs)(v.default,{style:[Et.petHeader,{backgroundColor:m.theme.colors.surface}],onPress:t=>{n?((0,g.debugLog)("MBA5555","PET HEADER - Ignoring click while in edit mode for pet:",e.id),t.stopPropagation()):((0,g.debugLog)("MBA5555","PET HEADER - Toggle clicked for pet:",e.id),me(e.id))},activeOpacity:.2,children:[(0,T.jsx)(x.default,{style:Et.petBasicInfo,children:n?(0,T.jsxs)(x.default,{style:Et.editMainContainer,children:[(0,T.jsxs)(x.default,{style:Et.editHeaderRow,children:[(0,T.jsx)(x.default,{style:Et.editProfileContainer,children:(0,T.jsxs)(v.default,{style:Et.profilePhotoButton,onPress:()=>(async e=>{try{(0,g.debugLog)("MBA456","Document upload simulated");const t={name:"Document_".concat((new Date).getTime(),".pdf"),size:2097152,type:"application/pdf"};z((o=>Object.assign({},o,{[e]:Object.assign({},o[e]||{},{vetDocuments:[...o[e]?.vetDocuments||[],t]})}))),Z({message:"Document added successfully. Full document upload feature coming soon.",type:"info",duration:3e3})}catch(t){(0,g.debugLog)("MBA456","Error with document upload",t),Z({message:"Failed to add document",type:"error",duration:3e3})}})(e.id),children:[(0,T.jsx)(U.default,{source:o(65460),style:Et.petPhoto}),(0,T.jsx)(x.default,{style:Et.plusIconContainer,children:(0,T.jsx)(S.default,{name:"plus-circle",size:20,color:m.theme.colors.primary})})]})}),(0,T.jsx)(x.default,{style:[Et.editActions,J<600&&Et.editActionsSmallScreen],children:J<600?(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)(x.default,{style:Et.buttonRowTop,children:[!i&&(0,T.jsx)(v.default,{style:Et.deleteButton,onPress:t=>{t.stopPropagation(),he(e.id)},children:(0,T.jsx)(S.default,{name:"delete",size:20,color:m.theme.colors.error})}),(0,T.jsx)(v.default,{style:Et.saveButton,onPress:t=>{t.stopPropagation(),K?(0,g.debugLog)("MBA5555","Save button already clicked, ignoring"):((0,g.debugLog)("MBA5555","SAVE BUTTON - Clicked for pet:",e.id),ye(e.id))},disabled:K,children:(0,T.jsx)(C.default,{style:Et.saveButtonText,children:i?"Create Pet":"Save Pet"})})]}),(0,T.jsxs)(x.default,{style:Et.buttonRowBottom,children:[(0,T.jsx)(v.default,{style:Et.editButton,onPress:t=>{t.stopPropagation(),be(e.id)},children:(0,T.jsx)(S.default,{name:"close",size:20,color:m.theme.colors.error})}),(0,T.jsx)(v.default,{style:Et.editButton,onPress:t=>{t.stopPropagation(),me(e.id)},children:(0,T.jsx)(S.default,{name:t?"chevron-up":"chevron-down",size:24,color:m.theme.colors.text})})]})]}):(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(v.default,{style:Et.saveButton,onPress:t=>{t.stopPropagation(),K?(0,g.debugLog)("MBA5555","Save button already clicked, ignoring"):((0,g.debugLog)("MBA5555","SAVE BUTTON - Clicked for pet:",e.id),ye(e.id))},disabled:K,children:(0,T.jsx)(C.default,{style:Et.saveButtonText,children:i?"Create Pet":"Save Pet"})}),!i&&(0,T.jsx)(v.default,{style:Et.deleteButton,onPress:t=>{t.stopPropagation(),he(e.id)},children:(0,T.jsx)(S.default,{name:"delete",size:20,color:m.theme.colors.error})}),(0,T.jsx)(v.default,{style:Et.editButton,onPress:t=>{t.stopPropagation(),be(e.id)},children:(0,T.jsx)(S.default,{name:"close",size:20,color:m.theme.colors.error})}),(0,T.jsx)(v.default,{style:Et.editButton,onPress:t=>{t.stopPropagation(),me(e.id)},children:(0,T.jsx)(S.default,{name:t?"chevron-up":"chevron-down",size:24,color:m.theme.colors.text})})]})})]}),(0,T.jsxs)(x.default,{style:Et.editDetailsContainer,children:[(0,T.jsxs)(x.default,{style:Et.detailRow,children:[(0,T.jsxs)(x.default,{style:Et.detailColumn,children:[(0,T.jsx)(C.default,{style:Et.inputLabel,children:"Name"}),(0,T.jsx)(q.default,{style:Et.editInput,value:a.name||"",onChangeText:t=>xe(e.id,"name",t),placeholder:"Enter pet name",placeholderTextColor:m.theme.colors.placeholder})]}),(0,T.jsxs)(x.default,{style:Et.detailColumn,children:[(0,T.jsx)(C.default,{style:Et.inputLabel,children:"Breed"}),(0,T.jsx)(q.default,{style:Et.editInput,value:a.breed||"",onChangeText:t=>xe(e.id,"breed",t),placeholder:"Enter breed",placeholderTextColor:m.theme.colors.placeholder})]})]}),r?(0,T.jsxs)(x.default,{style:Et.stackedFields,children:[(0,T.jsxs)(x.default,{style:[Et.detailColumn,Et.fullWidth],children:[(0,T.jsx)(C.default,{style:Et.inputLabel,children:"Animal Type"}),(0,T.jsx)(q.default,{style:Et.editInput,value:a.type||"",onChangeText:t=>xe(e.id,"type",t),placeholder:"Enter type",placeholderTextColor:m.theme.colors.placeholder})]}),(0,T.jsxs)(x.default,{style:[Et.detailColumn,Et.fullWidth],children:[(0,T.jsx)(C.default,{style:Et.inputLabel,children:"Birthday"}),(0,T.jsxs)(x.default,{style:Et.customDatePickerContainer,children:[(0,T.jsx)(v.default,{activeOpacity:.8,style:Et.dateInputBox,onPress:()=>je(e.id,"birthday"),children:(0,T.jsx)(C.default,{style:[Et.dateInputText,!a.birthday&&Et.placeholderText],children:a.birthday||"MM-DD-YYYY"})}),(0,T.jsx)(v.default,{style:Et.calendarButton,onPress:()=>je(e.id,"birthday"),activeOpacity:.7,children:(0,T.jsx)(S.default,{name:"calendar",size:20,color:m.theme.colors.primary})})]})]})]}):(0,T.jsxs)(x.default,{style:Et.detailRow,children:[(0,T.jsxs)(x.default,{style:Et.detailColumn,children:[(0,T.jsx)(C.default,{style:Et.inputLabel,children:"Birthday"}),(0,T.jsxs)(x.default,{style:Et.customDatePickerContainer,children:[(0,T.jsx)(v.default,{activeOpacity:.8,style:Et.dateInputBox,onPress:()=>je(e.id,"birthday"),children:(0,T.jsx)(C.default,{style:[Et.dateInputText,!a.birthday&&Et.placeholderText],children:a.birthday||"MM-DD-YYYY"})}),(0,T.jsx)(v.default,{style:Et.calendarButton,onPress:()=>je(e.id,"birthday"),activeOpacity:.7,children:(0,T.jsx)(S.default,{name:"calendar",size:20,color:m.theme.colors.primary})})]})]}),(0,T.jsxs)(x.default,{style:Et.detailColumn,children:[(0,T.jsx)(C.default,{style:Et.inputLabel,children:"Animal Type"}),(0,T.jsx)(q.default,{style:Et.editInput,value:a.type||"",onChangeText:t=>xe(e.id,"type",t),placeholder:"Enter type",placeholderTextColor:m.theme.colors.placeholder})]})]})]})]}):(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(U.default,{source:o(65460),style:Et.petPhoto}),(0,T.jsxs)(x.default,{style:[Et.petInfo,J<600&&Et.petInfoWithButtonPadding],children:[(0,T.jsx)(C.default,{style:Et.petName,children:s}),(0,T.jsx)(x.default,{style:Et.petDetailsContainer,children:(0,T.jsxs)(C.default,{style:Et.petDetails,children:[l||"No breed"," \u2022 ",c," \u2022 ",d||"No type"]})})]})]})}),!n&&J<600?(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(v.default,{style:[Et.editButton,Et.editButtonTopRight],onPress:()=>ge(e.id),children:(0,T.jsx)(S.default,{name:"pencil",size:20,color:m.theme.colors.primary})}),(0,T.jsx)(v.default,{style:[Et.editButton,Et.chevronButtonBottomRight],onPress:()=>me(e.id),children:(0,T.jsx)(S.default,{name:t?"chevron-up":"chevron-down",size:24,color:m.theme.colors.text})})]}):n?null:(0,T.jsxs)(x.default,{style:Et.petActions,children:[(0,T.jsx)(v.default,{style:Et.editButton,onPress:()=>ge(e.id),children:(0,T.jsx)(S.default,{name:"pencil",size:20,color:m.theme.colors.primary})}),(0,T.jsx)(v.default,{style:Et.editButton,onPress:()=>me(e.id),children:(0,T.jsx)(S.default,{name:t?"chevron-up":"chevron-down",size:24,color:m.theme.colors.text})})]})]}),t&&(0,T.jsxs)(x.default,{style:[Et.expandedDetails,{backgroundColor:m.theme.colors.surfaceContrast}],children:[(0,T.jsxs)(x.default,{style:Et.detailRow,children:[(0,T.jsxs)(x.default,{style:Et.detailColumn,children:[(0,T.jsx)(C.default,{style:Et.detailTitle,children:"Feeding Instructions"}),n?(0,T.jsx)(q.default,{style:Et.editInput,value:a.feedingInstructions||"",onChangeText:t=>xe(e.id,"feedingInstructions",t),placeholder:"Enter feeding instructions",placeholderTextColor:m.theme.colors.placeholder,multiline:!0}):(0,T.jsx)(C.default,{style:Et.detailText,children:e.feedingInstructions||"2 cups of dry food twice daily (morning/evening)"})]}),(0,T.jsxs)(x.default,{style:Et.detailColumn,children:[(0,T.jsx)(C.default,{style:Et.detailTitle,children:"Medical Notes"}),n?(0,T.jsx)(q.default,{style:Et.editInput,value:a.medicalNotes||"",onChangeText:t=>xe(e.id,"medicalNotes",t),placeholder:"Enter medical notes",placeholderTextColor:m.theme.colors.placeholder,multiline:!0}):(0,T.jsx)(C.default,{style:Et.detailText,children:e.medicalNotes||"Hip dysplasia, daily joint supplement in AM meal"})]})]}),(0,T.jsxs)(x.default,{style:Et.detailRow,children:[(0,T.jsxs)(x.default,{style:Et.detailColumn,children:[(0,T.jsx)(C.default,{style:Et.detailTitle,children:"Potty Break Schedule"}),n?(0,T.jsx)(q.default,{style:Et.editInput,value:a.pottyBreakSchedule||"",onChangeText:t=>xe(e.id,"pottyBreakSchedule",t),placeholder:"Potty break schedule",placeholderTextColor:m.theme.colors.placeholder,multiline:!0}):(0,T.jsx)(C.default,{style:Et.detailText,children:e.pottyBreakSchedule||"15 minutes after each meal"})]}),(0,T.jsxs)(x.default,{style:Et.detailColumn,children:[(0,T.jsx)(C.default,{style:Et.detailTitle,children:"Special Care Instructions"}),n?(0,T.jsx)(q.default,{style:Et.editInput,value:a.specialCareInstructions||"",onChangeText:t=>xe(e.id,"specialCareInstructions",t),placeholder:"Special care instructions",placeholderTextColor:m.theme.colors.placeholder,multiline:!0}):(0,T.jsx)(C.default,{style:Et.detailText,children:e.specialCareInstructions||"Don't touch his butt, he will eat your ass"})]})]}),(0,T.jsxs)(x.default,{style:Et.detailSection,children:[ve(e.id,"Care Information","careInfo"),Ce(e.id,"careInfo")&&(0,T.jsx)(x.default,{style:Et.detailColumn,children:(0,T.jsxs)(x.default,{style:Et.careInfoContainer,children:[(0,T.jsxs)(x.default,{style:Et.compatibilityItem,children:[(0,T.jsx)(C.default,{style:Et.compatibilityLabel,children:"Energy level:"}),n?(0,T.jsx)(x.default,{style:Et.dropdownContainerEdit,children:le.map((t=>(0,T.jsx)(v.default,{style:[Et.optionButton,null===a.energyLevel&&"N/A"===t||a.energyLevel===t?Et.selectedOption:null],onPress:()=>xe(e.id,"energyLevel","N/A"===t?null:t),children:(0,T.jsx)(C.default,{style:[Et.optionText,null===a.energyLevel&&"N/A"===t||a.energyLevel===t?Et.selectedOptionText:null],children:t})},t)))}):ue(e)]}),(0,T.jsxs)(x.default,{style:Et.compatibilityItem,children:[(0,T.jsx)(C.default,{style:Et.compatibilityLabel,children:"Weight (lbs):"}),n?(0,T.jsx)(q.default,{style:Et.editInputWeight,value:a.weight||"",onChangeText:t=>{(/^(\d*\.?\d*)$/.test(t)||""===t)&&xe(e.id,"weight",t)},placeholder:"Enter weight",placeholderTextColor:m.theme.colors.placeholder,keyboardType:"numeric"}):(0,T.jsx)(C.default,{style:Et.vetInfoText,children:e.weight||"Not specified"})]}),(0,T.jsxs)(x.default,{style:Et.medicationsContainer,children:[(0,T.jsx)(C.default,{style:Et.compatibilityLabel,children:"Medications:"}),n?(0,T.jsx)(q.default,{style:Et.editInputMedications,value:"string"===typeof a.medications?a.medications:"",onChangeText:t=>xe(e.id,"medications",t),placeholder:"Enter medications",placeholderTextColor:m.theme.colors.placeholder,multiline:!0}):(0,T.jsx)(C.default,{style:Et.medicationsText,children:"string"===typeof e.medications?e.medications:null===e.medications||"object"===typeof e.medications?"None":String(e.medications)})]})]})})]}),(0,T.jsxs)(x.default,{style:Et.detailSection,children:[ve(e.id,"Compatibility & Training","compatibility"),Ce(e.id,"compatibility")&&(0,T.jsx)(x.default,{style:Et.detailColumn,children:(0,T.jsxs)(x.default,{style:Et.compatibilityContainer,children:[(0,T.jsxs)(x.default,{style:Et.compatibilityItem,children:[(0,T.jsx)(C.default,{style:Et.compatibilityLabel,children:"Friendly with children:"}),n?(0,T.jsx)(x.default,{style:Et.dropdownContainerEdit,children:se.map((t=>(0,T.jsx)(v.default,{style:[Et.optionButton,null===a.childrenFriendly&&"N/A"===t||!0===a.childrenFriendly&&"Yes"===t||!1===a.childrenFriendly&&"No"===t||a.childrenFriendly===t?Et.selectedOption:null],onPress:()=>xe(e.id,"childrenFriendly","N/A"===t?null:t),children:(0,T.jsx)(C.default,{style:[Et.optionText,null===a.childrenFriendly&&"N/A"===t||!0===a.childrenFriendly&&"Yes"===t||!1===a.childrenFriendly&&"No"===t||a.childrenFriendly===t?Et.selectedOptionText:null],children:t})},t)))}):ce(e,"childrenFriendly")]}),(0,T.jsxs)(x.default,{style:Et.compatibilityItem,children:[(0,T.jsx)(C.default,{style:Et.compatibilityLabel,children:"Friendly with cats:"}),n?(0,T.jsx)(x.default,{style:Et.dropdownContainerEdit,children:se.map((t=>(0,T.jsx)(v.default,{style:[Et.optionButton,null===a.catFriendly&&"N/A"===t||!0===a.catFriendly&&"Yes"===t||!1===a.catFriendly&&"No"===t||a.catFriendly===t?Et.selectedOption:null],onPress:()=>xe(e.id,"catFriendly","N/A"===t?null:t),children:(0,T.jsx)(C.default,{style:[Et.optionText,null===a.catFriendly&&"N/A"===t||!0===a.catFriendly&&"Yes"===t||!1===a.catFriendly&&"No"===t||a.catFriendly===t?Et.selectedOptionText:null],children:t})},t)))}):ce(e,"catFriendly")]}),(0,T.jsxs)(x.default,{style:Et.compatibilityItem,children:[(0,T.jsx)(C.default,{style:Et.compatibilityLabel,children:"Friendly with dogs:"}),n?(0,T.jsx)(x.default,{style:Et.dropdownContainerEdit,children:se.map((t=>(0,T.jsx)(v.default,{style:[Et.optionButton,null===a.dogFriendly&&"N/A"===t||!0===a.dogFriendly&&"Yes"===t||!1===a.dogFriendly&&"No"===t||a.dogFriendly===t?Et.selectedOption:null],onPress:()=>xe(e.id,"dogFriendly","N/A"===t?null:t),children:(0,T.jsx)(C.default,{style:[Et.optionText,null===a.dogFriendly&&"N/A"===t||!0===a.dogFriendly&&"Yes"===t||!1===a.dogFriendly&&"No"===t||a.dogFriendly===t?Et.selectedOptionText:null],children:t})},t)))}):ce(e,"dogFriendly")]}),(0,T.jsxs)(x.default,{style:Et.compatibilityItem,children:[(0,T.jsx)(C.default,{style:Et.compatibilityLabel,children:"Spayed/neutered:"}),n?(0,T.jsx)(x.default,{style:Et.dropdownContainerEdit,children:se.map((t=>(0,T.jsx)(v.default,{style:[Et.optionButton,null===a.spayedNeutered&&"N/A"===t||!0===a.spayedNeutered&&"Yes"===t||!1===a.spayedNeutered&&"No"===t||a.spayedNeutered===t?Et.selectedOption:null],onPress:()=>xe(e.id,"spayedNeutered","N/A"===t?null:t),children:(0,T.jsx)(C.default,{style:[Et.optionText,null===a.spayedNeutered&&"N/A"===t||!0===a.spayedNeutered&&"Yes"===t||!1===a.spayedNeutered&&"No"===t||a.spayedNeutered===t?Et.selectedOptionText:null],children:t})},t)))}):ce(e,"spayedNeutered")]}),(0,T.jsxs)(x.default,{style:Et.compatibilityItem,children:[(0,T.jsx)(C.default,{style:Et.compatibilityLabel,children:"House trained:"}),n?(0,T.jsx)(x.default,{style:Et.dropdownContainerEdit,children:se.map((t=>(0,T.jsx)(v.default,{style:[Et.optionButton,null===a.houseTrained&&"N/A"===t||!0===a.houseTrained&&"Yes"===t||!1===a.houseTrained&&"No"===t||a.houseTrained===t?Et.selectedOption:null],onPress:()=>xe(e.id,"houseTrained","N/A"===t?null:t),children:(0,T.jsx)(C.default,{style:[Et.optionText,null===a.houseTrained&&"N/A"===t||!0===a.houseTrained&&"Yes"===t||!1===a.houseTrained&&"No"===t||a.houseTrained===t?Et.selectedOptionText:null],children:t})},t)))}):ce(e,"houseTrained")]}),(0,T.jsxs)(x.default,{style:Et.compatibilityItem,children:[(0,T.jsx)(C.default,{style:Et.compatibilityLabel,children:"Microchipped:"}),n?(0,T.jsx)(x.default,{style:Et.dropdownContainerEdit,children:se.map((t=>(0,T.jsx)(v.default,{style:[Et.optionButton,null===a.microchipped&&"N/A"===t||!0===a.microchipped&&"Yes"===t||!1===a.microchipped&&"No"===t||a.microchipped===t?Et.selectedOption:null],onPress:()=>xe(e.id,"microchipped","N/A"===t?null:t),children:(0,T.jsx)(C.default,{style:[Et.optionText,null===a.microchipped&&"N/A"===t||!0===a.microchipped&&"Yes"===t||!1===a.microchipped&&"No"===t||a.microchipped===t?Et.selectedOptionText:null],children:t})},t)))}):ce(e,"microchipped")]}),(0,T.jsxs)(x.default,{style:Et.compatibilityItem,children:[(0,T.jsx)(C.default,{style:Et.compatibilityLabel,children:"Can be left alone:"}),n?(0,T.jsx)(x.default,{style:Et.dropdownContainerEdit,children:se.map((t=>(0,T.jsx)(v.default,{style:[Et.optionButton,null===a.canBeLeftAlone&&"N/A"===t||!0===a.canBeLeftAlone&&"Yes"===t||!1===a.canBeLeftAlone&&"No"===t||a.canBeLeftAlone===t?Et.selectedOption:null],onPress:()=>xe(e.id,"canBeLeftAlone","N/A"===t?null:t),children:(0,T.jsx)(C.default,{style:[Et.optionText,null===a.canBeLeftAlone&&"N/A"===t||!0===a.canBeLeftAlone&&"Yes"===t||!1===a.canBeLeftAlone&&"No"===t||a.canBeLeftAlone===t?Et.selectedOptionText:null],children:t})},t)))}):ce(e,"canBeLeftAlone")]})]})})]}),(0,T.jsxs)(x.default,{style:Et.detailSection,children:[ve(e.id,"Vet Information","vetInfo"),Ce(e.id,"vetInfo")&&(0,T.jsx)(x.default,{style:Et.detailColumn,children:(0,T.jsxs)(x.default,{style:Et.vetInfoContainer,children:[(0,T.jsxs)(x.default,{style:Et.vetInfoItem,children:[(0,T.jsx)(C.default,{style:Et.vetInfoLabel,children:"Vet name:"}),n?(0,T.jsx)(q.default,{style:Et.editInputShort,value:a.vetName||"",onChangeText:t=>xe(e.id,"vetName",t),placeholder:"Enter vet name",placeholderTextColor:m.theme.colors.placeholder}):(0,T.jsx)(C.default,{style:Et.vetInfoText,children:e.vetName||"None"})]}),(0,T.jsxs)(x.default,{style:Et.vetInfoItem,children:[(0,T.jsx)(C.default,{style:Et.vetInfoLabel,children:"Vet address:"}),n?(0,T.jsx)(q.default,{style:Et.editInputShort,value:a.vetAddress||"",onChangeText:t=>xe(e.id,"vetAddress",t),placeholder:"Enter vet address",placeholderTextColor:m.theme.colors.placeholder}):(0,T.jsx)(C.default,{style:Et.vetInfoText,children:e.vetAddress||"None"})]}),(0,T.jsxs)(x.default,{style:Et.vetInfoItem,children:[(0,T.jsx)(C.default,{style:Et.vetInfoLabel,children:"Vet phone:"}),n?(0,T.jsx)(q.default,{style:Et.editInputShort,value:a.vetPhone||"",onChangeText:t=>xe(e.id,"vetPhone",t),placeholder:"Enter vet phone",placeholderTextColor:m.theme.colors.placeholder,keyboardType:"phone-pad"}):(0,T.jsx)(C.default,{style:Et.vetInfoText,children:e.vetPhone||"None"})]}),(0,T.jsxs)(x.default,{style:Et.vetInfoItem,children:[(0,T.jsx)(C.default,{style:Et.vetInfoLabel,children:"Insurance provider:"}),n?(0,T.jsx)(q.default,{style:Et.editInputShort,value:a.insuranceProvider||"",onChangeText:t=>xe(e.id,"insuranceProvider",t),placeholder:"Enter insurance provider",placeholderTextColor:m.theme.colors.placeholder}):(0,T.jsx)(C.default,{style:Et.vetInfoText,children:e.insuranceProvider||"Not specified"})]}),(0,T.jsxs)(x.default,{style:Et.vetInfoItem,children:[(0,T.jsx)(C.default,{style:Et.vetInfoLabel,children:"Sex:"}),n?(0,T.jsx)(x.default,{style:Et.dropdownContainerEdit,children:de.map((t=>(0,T.jsx)(v.default,{style:[Et.optionButton,a.sex===t?Et.selectedOption:null],onPress:()=>xe(e.id,"sex",t),children:(0,T.jsx)(C.default,{style:[Et.optionText,a.sex===t?Et.selectedOptionText:null],children:t})},t)))}):(0,T.jsx)(C.default,{style:Et.vetInfoText,children:e.sex||"None Selected"})]}),(0,T.jsxs)(x.default,{style:Et.vetInfoItem,children:[(0,T.jsx)(C.default,{style:Et.vetInfoLabel,children:"Adoption Date:"}),n?(0,T.jsxs)(x.default,{style:Et.customDatePickerContainer,children:[(0,T.jsx)(v.default,{activeOpacity:.8,style:Et.dateInputBox,onPress:()=>je(e.id,"adoptionDate"),children:(0,T.jsx)(C.default,{style:[Et.dateInputText,!a.adoptionDate&&Et.placeholderText],children:a.adoptionDate||"MM-DD-YYYY"})}),(0,T.jsx)(v.default,{style:Et.calendarButton,onPress:()=>je(e.id,"adoptionDate"),activeOpacity:.7,children:(0,T.jsx)(S.default,{name:"calendar",size:20,color:m.theme.colors.primary})})]}):(0,T.jsx)(C.default,{style:Et.vetInfoText,children:e.adoptionDate||"Not specified"})]})]})})]})]})]},e.id)}catch(t){return console.error("Error rendering pet card: "+(t.message||"Unknown error")),null}}))})]})]})},Nt=r.default.create({desktopContainer:{flexDirection:"row",gap:24},leftColumn:{flex:1,gap:24},rightColumn:{width:"35%",minWidth:300,gap:24},mobileContainer:{flex:1},section:{backgroundColor:m.theme.colors.surfaceContrast,borderRadius:10,padding:20,marginBottom:15},sectionHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:15},sectionTitle:{fontSize:18,fontWeight:"bold",color:m.theme.colors.text,marginBottom:15},plansScroll:{marginHorizontal:-20},plansScrollContent:{paddingHorizontal:20,paddingBottom:16},planCardContainer:{width:280,marginRight:16,paddingBottom:4},planCard:{backgroundColor:m.theme.colors.surface,borderRadius:10,padding:20,position:"relative",marginTop:12,height:"100%",borderWidth:0},currentPlanBorder:{borderWidth:2,borderColor:m.theme.colors.primary},popularPlan:{},popularTag:{position:"absolute",top:-12,right:20,backgroundColor:m.theme.colors.primary,paddingHorizontal:12,paddingVertical:4,borderRadius:12,zIndex:2},popularTagText:{color:m.theme.colors.surfaceContrast,fontWeight:"600",fontSize:12},planTitle:{fontSize:20,fontWeight:"bold",marginBottom:10},planPrice:{fontSize:24,fontWeight:"600",color:m.theme.colors.primary,marginBottom:5},planDescription:{color:m.theme.colors.secondary,marginBottom:15},featuresList:{gap:10,marginBottom:20},featureItem:{flexDirection:"row",alignItems:"center",gap:10},featureText:{color:m.theme.colors.text},planButton:{backgroundColor:m.theme.colors.primary,padding:12,borderRadius:8,alignItems:"center",marginTop:"auto",marginBottom:0},currentPlanButton:{backgroundColor:m.theme.colors.surface,borderWidth:1,borderColor:m.theme.colors.primary},planButtonText:{color:m.theme.colors.surfaceContrast,fontWeight:"600"},currentPlanButtonText:{color:m.theme.colors.primary},settingItem:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingVertical:12,borderBottomWidth:1,borderBottomColor:m.theme.colors.placeHolderText},settingContent:{flexDirection:"row",alignItems:"center",flex:1},settingTextContainer:{marginLeft:15,flex:1},settingTitle:{fontSize:16,fontWeight:"500"},settingDescription:{fontSize:14,color:m.theme.colors.secondary,marginTop:2},actionButton:{backgroundColor:m.theme.colors.surface,paddingHorizontal:12,paddingVertical:6,borderRadius:6},actionButtonText:{color:m.theme.colors.primary,fontWeight:"500"},currentPlanInfo:{backgroundColor:m.theme.colors.surface,padding:15,borderRadius:8},currentPlanTitle:{fontSize:20,fontWeight:"600",marginBottom:5},currentPlanBilling:{color:m.theme.colors.secondary,marginBottom:15},usageStats:{gap:8},usageText:{fontSize:14,color:m.theme.colors.text},usageBar:{height:8,backgroundColor:m.theme.colors.background,borderRadius:4},usageProgress:{height:"100%",backgroundColor:m.theme.colors.primary,borderRadius:4},paymentItem:{flexDirection:"row",alignItems:"flex-start",justifyContent:"space-between",padding:12,backgroundColor:m.theme.colors.surface,borderRadius:8,marginBottom:10},paymentContent:{flexDirection:"row",alignItems:"flex-start",flex:1,marginRight:12},paymentTextContainer:{marginLeft:15,flex:1},paymentTitleRow:{flexDirection:"row",alignItems:"center",flexWrap:"wrap",gap:8},paymentTitle:{fontSize:16,fontWeight:"500"},paymentDescription:{fontSize:14,color:m.theme.colors.secondary,marginTop:2},setDefaultButton:{paddingHorizontal:8,paddingVertical:2,borderRadius:4},setDefaultText:{color:m.theme.colors.primary,fontSize:14,fontWeight:"500"},deleteButton:{padding:4},addButton:{flexDirection:"row",alignItems:"center",backgroundColor:m.theme.colors.primary,padding:8,borderRadius:5},addButtonText:{color:m.theme.colors.surfaceContrast,marginLeft:5,fontWeight:"500"},viewAllButton:{padding:12,borderRadius:8,backgroundColor:m.theme.colors.surface,alignItems:"center"},viewAllText:{color:m.theme.colors.primary,fontWeight:"500"},modalOverlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center"},modalContent:{backgroundColor:m.theme.colors.background,borderRadius:10,width:"90%",maxWidth:500,maxHeight:"80%",padding:20},modalHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:15,paddingBottom:10,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},modalTitle:{fontSize:18,fontWeight:"bold",color:m.theme.colors.text},timezoneItem:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingVertical:12,paddingHorizontal:15,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},selectedTimezoneItem:{backgroundColor:m.theme.colors.primaryLight},timezoneText:{fontSize:16,color:m.theme.colors.text},selectedTimezoneText:{fontWeight:"bold",color:m.theme.colors.primary},timezoneButton:{flexDirection:"row",alignItems:"center",backgroundColor:m.theme.colors.surface,paddingHorizontal:12,paddingVertical:6,borderRadius:6},timezoneButtonText:{color:m.theme.colors.primary,fontWeight:"500",marginRight:5},noPaymentMethodsContainer:{padding:20,alignItems:"center",backgroundColor:m.theme.colors.surface,borderRadius:8},noPaymentMethodsText:{color:m.theme.colors.secondary,fontSize:16}}),Ht=({push_notifications:e,email_updates:t,marketing_communications:o,profile_visibility:a,timezone:r,use_military_time:i,onUpdateSetting:s,paymentMethods:l,onAddPaymentMethod:d,onRemovePaymentMethod:c,onSetDefaultPayment:u,isMobile:h,currentPlan:f={id:"waitlist",title:"Waitlist Signup",nextBilling:"N/A",connections:{used:0,total:"Unlimited"}},onSwitchPlan:p,userRole:y,isApprovedProfessional:b,navigation:w})=>{const[j,B]=(0,n.useState)(r||"UTC"),[k,_]=(0,n.useState)(!1),[I,M]=(0,n.useState)([]),[D,R]=(0,n.useState)(!1),L=E();(0,n.useEffect)((()=>{r?B(r):(async()=>{try{R(!0);const e=await(0,Ze.getTimeSettings)();B(e.timezone),(0,g.debugLog)("MBA12345 Fetched time settings:",e)}catch(e){(0,g.debugLog)("MBA12345 Error fetching time settings:",e)}finally{R(!1)}})()}),[r]),(0,n.useEffect)((()=>{(0,g.debugLog)("MBA54321 SettingsPaymentsTab received paymentMethods:",l)}),[l]);const z=()=>{M(["America/New_York","America/Chicago","America/Denver","America/Los_Angeles","America/Anchorage","America/Adak","Pacific/Honolulu","America/Phoenix","America/Boise","America/Detroit","America/Indiana/Indianapolis","America/Indiana/Knox","America/Indiana/Marengo","America/Indiana/Petersburg","America/Indiana/Tell_City","America/Indiana/Vevay","America/Indiana/Vincennes","America/Indiana/Winamac","America/Kentucky/Louisville","America/Kentucky/Monticello","America/Menominee","America/North_Dakota/Beulah","America/North_Dakota/Center","America/North_Dakota/New_Salem","America/Sitka","America/Yakutat","Europe/London","Europe/Paris","Europe/Berlin","Europe/Moscow","Asia/Tokyo","Asia/Shanghai","Asia/Dubai","Australia/Sydney","Pacific/Auckland","UTC"]),_(!0)},P=()=>(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)(x.default,{style:Nt.settingItem,children:[(0,T.jsxs)(x.default,{style:Nt.settingContent,children:[(0,T.jsx)(S.default,{name:"bell",size:24,color:m.theme.colors.primary}),(0,T.jsxs)(x.default,{style:Nt.settingTextContainer,children:[(0,T.jsx)(C.default,{style:Nt.settingTitle,children:"Push Notifications"}),(0,T.jsx)(C.default,{style:Nt.settingDescription,children:"Receive push notifications for updates"})]})]}),(0,T.jsx)(He.default,{value:e,onValueChange:e=>O("push_notifications",e),trackColor:{false:m.theme.colors.disabled,true:m.theme.colors.primary}})]}),(0,T.jsxs)(x.default,{style:Nt.settingItem,children:[(0,T.jsxs)(x.default,{style:Nt.settingContent,children:[(0,T.jsx)(S.default,{name:"email",size:24,color:m.theme.colors.primary}),(0,T.jsxs)(x.default,{style:Nt.settingTextContainer,children:[(0,T.jsx)(C.default,{style:Nt.settingTitle,children:"Email Updates"}),(0,T.jsx)(C.default,{style:Nt.settingDescription,children:"Receive important updates via email"})]})]}),(0,T.jsx)(He.default,{value:t,onValueChange:e=>O("email_updates",e),trackColor:{false:m.theme.colors.disabled,true:m.theme.colors.primary}})]}),(0,T.jsxs)(x.default,{style:Nt.settingItem,children:[(0,T.jsxs)(x.default,{style:Nt.settingContent,children:[(0,T.jsx)(S.default,{name:"bell-outline",size:24,color:m.theme.colors.primary}),(0,T.jsxs)(x.default,{style:Nt.settingTextContainer,children:[(0,T.jsx)(C.default,{style:Nt.settingTitle,children:"Marketing Communications"}),(0,T.jsx)(C.default,{style:Nt.settingDescription,children:"Receive promotions and marketing emails"})]})]}),(0,T.jsx)(He.default,{value:o,onValueChange:e=>O("marketing_communications",e),trackColor:{false:m.theme.colors.disabled,true:m.theme.colors.primary}})]})]}),F=()=>(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)(x.default,{style:Nt.settingItem,children:[(0,T.jsxs)(x.default,{style:Nt.settingContent,children:[(0,T.jsx)(S.default,{name:"account-eye",size:24,color:m.theme.colors.primary}),(0,T.jsxs)(x.default,{style:Nt.settingTextContainer,children:[(0,T.jsx)(C.default,{style:Nt.settingTitle,children:"Profile Visibility"}),(0,T.jsx)(C.default,{style:Nt.settingDescription,children:"Make your profile visible to others"})]})]}),(0,T.jsx)(He.default,{value:a,onValueChange:e=>O("profile_visibility",e),trackColor:{false:m.theme.colors.disabled,true:m.theme.colors.primary}})]}),(0,T.jsxs)(x.default,{style:Nt.settingItem,children:[(0,T.jsxs)(x.default,{style:Nt.settingContent,children:[(0,T.jsx)(S.default,{name:"lock-reset",size:24,color:m.theme.colors.primary}),(0,T.jsxs)(x.default,{style:Nt.settingTextContainer,children:[(0,T.jsx)(C.default,{style:Nt.settingTitle,children:"Change Password"}),(0,T.jsx)(C.default,{style:Nt.settingDescription,children:"Update your account password"})]})]}),(0,T.jsx)(v.default,{style:Nt.actionButton,onPress:()=>w.navigate("ChangePassword"),children:(0,T.jsx)(C.default,{style:Nt.actionButtonText,children:"Change"})})]})]}),O=(e,t)=>{(0,g.debugLog)("MBA54321 Updating setting:",{id:e,value:t});const o={push_notifications:"Push Notifications",email_updates:"Email Updates",marketing_communications:"Marketing Communications",profile_visibility:"Profile Visibility",use_military_time:"Military Time"}[e]||e;s(e,t).then((()=>{L({message:"".concat(o," ").concat(t?"enabled":"disabled"," successfully"),type:"success",duration:3e3})})).catch((e=>{(0,g.debugLog)("MBA54321 Error updating setting:",e),L({message:"Failed to update ".concat(o.toLowerCase(),". Please try again."),type:"error",duration:4e3})}))};return(0,T.jsxs)(x.default,{style:Nt.container,children:[h?(0,T.jsxs)(H.default,{style:Nt.mobileContainer,children:[(0,T.jsxs)(x.default,{style:Nt.section,children:[(0,T.jsx)(C.default,{style:Nt.sectionTitle,children:"Notification Settings"}),P()]}),(0,T.jsxs)(x.default,{style:Nt.section,children:[(0,T.jsx)(C.default,{style:Nt.sectionTitle,children:"Privacy & Security Settings"}),F()]}),(0,T.jsxs)(x.default,{style:Nt.section,children:[(0,T.jsx)(C.default,{style:Nt.sectionTitle,children:"Time Settings"}),(0,T.jsxs)(x.default,{style:Nt.settingItem,children:[(0,T.jsxs)(x.default,{style:Nt.settingContent,children:[(0,T.jsx)(S.default,{name:"clock-outline",size:24,color:m.theme.colors.primary}),(0,T.jsxs)(x.default,{style:Nt.settingTextContainer,children:[(0,T.jsx)(C.default,{style:Nt.settingTitle,children:"Timezone"}),(0,T.jsx)(C.default,{style:Nt.settingDescription,children:"Set your local timezone for accurate time display"})]})]}),(0,T.jsxs)(v.default,{style:Nt.timezoneButton,onPress:z,children:[(0,T.jsx)(C.default,{style:Nt.timezoneButtonText,children:j}),(0,T.jsx)(S.default,{name:"chevron-down",size:20,color:m.theme.colors.primary})]})]})]})]}):(0,T.jsx)(x.default,{style:Nt.desktopContainer,children:(0,T.jsxs)(x.default,{style:Nt.leftColumn,children:[(0,T.jsxs)(x.default,{style:Nt.section,children:[(0,T.jsx)(C.default,{style:Nt.sectionTitle,children:"Notification Preferences"}),P()]}),(0,T.jsxs)(x.default,{style:Nt.section,children:[(0,T.jsx)(C.default,{style:Nt.sectionTitle,children:"Privacy & Security Settings"}),F()]}),(0,T.jsxs)(x.default,{style:Nt.section,children:[(0,T.jsx)(C.default,{style:Nt.sectionTitle,children:"Time Settings"}),(0,T.jsxs)(x.default,{style:Nt.settingItem,children:[(0,T.jsxs)(x.default,{style:Nt.settingContent,children:[(0,T.jsx)(S.default,{name:"clock-outline",size:24,color:m.theme.colors.primary}),(0,T.jsxs)(x.default,{style:Nt.settingTextContainer,children:[(0,T.jsx)(C.default,{style:Nt.settingTitle,children:"Timezone"}),(0,T.jsx)(C.default,{style:Nt.settingDescription,children:"Set your local timezone for accurate time display"})]})]}),(0,T.jsxs)(v.default,{style:Nt.timezoneButton,onPress:z,children:[(0,T.jsx)(C.default,{style:Nt.timezoneButtonText,children:j}),(0,T.jsx)(S.default,{name:"chevron-down",size:20,color:m.theme.colors.primary})]})]})]})]})}),(0,T.jsx)(A.default,{animationType:"slide",transparent:!0,visible:k,onRequestClose:()=>_(!1),children:(0,T.jsx)(x.default,{style:Nt.modalOverlay,children:(0,T.jsxs)(x.default,{style:Nt.modalContent,children:[(0,T.jsxs)(x.default,{style:Nt.modalHeader,children:[(0,T.jsx)(C.default,{style:Nt.modalTitle,children:"Select Timezone"}),(0,T.jsx)(v.default,{onPress:()=>_(!1),children:(0,T.jsx)(S.default,{name:"close",size:24,color:m.theme.colors.text})})]}),(0,T.jsx)(wt.default,{data:I,keyExtractor:e=>e,renderItem:({item:e})=>(0,T.jsxs)(v.default,{style:[Nt.timezoneItem,e===j&&Nt.selectedTimezoneItem],onPress:()=>(async e=>{try{R(!0),await(0,Ze.updateTimeSettings)(e),B(e),_(!1),(0,g.debugLog)("MBA12345 Updated timezone to:",e),L({message:"Timezone updated successfully",type:"success",duration:3e3})}catch(t){(0,g.debugLog)("MBA12345 Error updating timezone:",t),L({message:"Failed to update timezone. Please try again.",type:"error",duration:4e3})}finally{R(!1)}})(e),children:[(0,T.jsx)(C.default,{style:[Nt.timezoneText,e===j&&Nt.selectedTimezoneText],children:e}),e===j&&(0,T.jsx)(S.default,{name:"check",size:20,color:m.theme.colors.primary})]}),initialNumToRender:20,maxToRenderPerBatch:20,windowSize:10})]})})})]})},Ut=(r.default.create({container:{flexDirection:"row",backgroundColor:m.theme.colors.surface,borderRadius:8,padding:8,marginBottom:16},mobileContainer:{padding:4,marginBottom:10},tab:{flex:1,paddingVertical:12,paddingHorizontal:20,alignItems:"center",justifyContent:"center",borderRadius:6,marginHorizontal:4},mobileTab:{flex:0,minWidth:150,paddingVertical:8,paddingHorizontal:16},activeTab:{backgroundColor:m.theme.colors.primary},tabText:{fontSize:16,fontWeight:"500",color:m.theme.colors.text,fontFamily:m.theme.fonts?.regular?.fontFamily},mobileTabText:{fontSize:14},activeTabText:{color:m.theme.colors.whiteText||m.theme.colors.background}}),["_addToTop"]),Vt=(e,t)=>r.default.create({mainContainer:{flex:1,backgroundColor:m.theme.colors.surface,height:"100vh",overflow:"hidden",position:"fixed",top:0,left:0,right:0,bottom:0,marginLeft:e>900?t?70:250:0,transition:"margin-left 0.3s ease"},container:{flex:1,backgroundColor:m.theme.colors.surface},content:{flex:1,height:"100%",overflow:"auto",backgroundColor:m.theme.colors.surface},mainContent:{flex:1,width:"100%",alignSelf:"center",backgroundColor:m.theme.colors.surface},headerSection:{width:"100%",backgroundColor:m.theme.colors.surfaceContrast,paddingHorizontal:24,paddingTop:24,zIndex:2},title:{fontSize:32,fontWeight:"600",color:m.theme.colors.text,marginBottom:24,fontFamily:m.theme.fonts.header.fontFamily},tabScrollContainer:{flexGrow:0},tabContainer:{flexDirection:"row",gap:e<=900?22:32,paddingRight:e<=900?16:0},tab:{paddingBottom:8,borderBottomWidth:2,borderBottomColor:"transparent"},activeTab:{borderBottomColor:m.theme.colors.primary},tabText:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},activeTabText:{color:m.theme.colors.primary,fontWeight:"500"},tabContent:{flex:1,padding:e<=900?10:24,backgroundColor:m.theme.colors.surface},errorText:{color:"red",textAlign:"center",marginTop:20}}),qt=()=>{(0,g.debugLog)("MBA5678: MyProfile component rendering/mounting");const e=(0,y.useNavigation)(),{width:t}=(0,_e.default)(),{screenWidth:r,isCollapsed:i,is_DEBUG:s,userRole:l,isApprovedProfessional:d,user:c,logout:u}=(0,n.useContext)(g.AuthContext),[m,h]=(0,n.useState)(r<=900),[f,p]=(0,n.useState)(r>=1200),b=Vt(r,i),[w,j]=(0,n.useState)("profile_info"),[S,B]=(0,n.useState)(!1),[A,I]=(0,n.useState)(null),[M,R]=(0,n.useState)(!0),[L,z]=(0,n.useState)(null),[P,F]=(0,n.useState)({}),[O,E]=(0,n.useState)({id:"waitlist",title:"Waitlist Signup",nextBilling:"N/A",connections:{used:0,total:"Unlimited"}}),{isVisible:W,currentStep:N,totalSteps:U,stepData:V,handleNext:q,handlePrevious:Y,handleSkip:G,completeTutorial:J}=(0,n.useContext)(D),$=async()=>{try{if("web"===a.default.OS){const e=new URLSearchParams(window.location.search),t=e.get("initialTab")||e.get("screen");if(t&&["profile_info","pets_preferences","settings_payments","services_availability"].includes(t))return(0,g.debugLog)("MBAuieo2o34nf MyProfile retrieved tab from URL params",{tabFromUrl:t}),j(t),void await(0,g.setStorage)("MyProfileActiveTab",t)}const t=e.getState().routes.find((e=>"MyProfile"===e.name))?.params;if((0,g.debugLog)("MBAuieo2o34nf MyProfile navigation params",t),t?.initialTab)return(0,g.debugLog)("MBAuieo2o34nf MyProfile received initialTab param",{initialTab:t.initialTab}),j(t.initialTab),void await(0,g.setStorage)("MyProfileActiveTab",t.initialTab);if(t?.screen)return(0,g.debugLog)("MBAuieo2o34nf MyProfile received screen param",{screen:t.screen}),j(t.screen),void await(0,g.setStorage)("MyProfileActiveTab",t.screen);if(V?.tab)return(0,g.debugLog)("MBAuieo2o34nf MyProfile received tab from stepData",{tab:V.tab}),j(V.tab),void await(0,g.setStorage)("MyProfileActiveTab",V.tab);const o=await(0,g.getStorage)("MyProfileActiveTab");o&&((0,g.debugLog)("MBAuieo2o34nf MyProfile loaded tab from storage",{storedTab:o}),j(o))}catch(L){(0,g.debugLog)("MBAuieo2o34nf Error loading active tab",L)}};(0,n.useEffect)((()=>{$()}),[e,V]),(0,n.useEffect)((()=>{w&&(async()=>{try{if(await(0,g.setStorage)("MyProfileActiveTab",w),"web"===a.default.OS){const e=new URL(window.location.href);e.searchParams.set("initialTab",w),window.history.replaceState({},"",e.toString())}(0,g.debugLog)("MBAuieo2o34nf Stored active tab",{activeTab:w})}catch(L){(0,g.debugLog)("MBAuieo2o34nf Error storing active tab",L)}})()}),[w]),(0,n.useEffect)((()=>e.addListener("focus",(()=>{const t=e.getState().routes.find((e=>"MyProfile"===e.name))?.params;t?.screen?((0,g.debugLog)("MBA54321 MyProfile focus event - setting active tab",{screen:t.screen}),j(t.screen)):t?.initialTab&&((0,g.debugLog)("MBA54321 MyProfile focus event - setting active tab",{initialTab:t.initialTab}),j(t.initialTab))}))),[e]),(0,n.useEffect)((()=>e.addListener("state",(()=>{const t=e.getState().routes.find((e=>"MyProfile"===e.name))?.params;t?.screen?((0,g.debugLog)("MBA54321 MyProfile state change - setting active tab",{screen:t.screen}),j(t.screen)):t?.initialTab&&((0,g.debugLog)("MBA54321 MyProfile state change - setting active tab",{initialTab:t.initialTab}),j(t.initialTab))}))),[e]),(0,n.useEffect)((()=>{h(r<=900),p(r>=1200)}),[r]),(0,n.useEffect)((()=>{(0,g.debugLog)("MBA5678: MyProfile useEffect running - about to call loadProfileData"),Z()}),[]);const Z=async()=>{try{R(!0);const e=await(0,g.getStorage)("userToken");(0,g.debugLog)("MBA5678: userToken before userProfile call:",e);const t=await(0,Ze.userProfile)();I(t),await K(),R(!1),setTimeout((()=>{$()}),100)}catch(L){z("Failed to load profile data"),R(!1),(0,g.debugLog)("Failed to load profile data:",L)}},K=async()=>{try{if(A?.pets&&A.pets.length>0){const t=A.pets.filter((e=>!(!e.lastUpdateFailed&&!e.ownerMissing)));if(t.length>0){(0,g.debugLog)("MBA5432","Found pets with potential missing owners:",t);for(const a of t)try{const{fixPetOwner:e}=o(50294),t=await e(a.id);(0,g.debugLog)("MBA5432","Fixed pet owner successfully:",t)}catch(e){(0,g.debugLog)("MBA5432","Failed to fix pet owner:",e)}const n=await(0,Ze.userProfile)();I(n)}}}catch(L){(0,g.debugLog)("MBA5432","Error checking/fixing pet owners:",L)}},Q=[{id:"profile_info",label:"professional"===l?"Professional Profile Info":"Owner Profile Info"},{id:"pets_preferences",label:"My Pets"},{id:"settings_payments",label:"Settings"}],X=async()=>{const e=await Me.launchImageLibraryAsync({mediaTypes:De.MediaTypeOptions.Images,allowsEditing:!0,aspect:[1,1],quality:1});e.canceled||(I((t=>Object.assign({},t,{profilePhoto:e.assets[0].uri}))),B(!0))},ee=e=>{(0,g.debugLog)("MBA9876","Save completed with updated profile:",e),I((t=>{const o=Object.assign({},t,e);return(0,g.debugLog)("MBA9876","Updated profile data after save:",{name:o.name,email:o.email,address:o.address,city:o.city,state:o.state,zip:o.zip,country:o.country}),o})),B(!1),F({}),(0,g.debugLog)("MBA5678","Changes saved successfully")},te=(e,t)=>{(0,g.debugLog)("MBA9876","Updating field ".concat(e," locally, will be saved later:"),t),I((o=>Object.assign({},o,{[e]:t}))),B(!0)},oe=e=>{F((t=>Object.assign({},t,{[e]:!t[e]})))},ne=e=>{(0,g.debugLog)("Switching to plan:",e)};return M?(0,T.jsx)(x.default,{style:b.container,children:(0,T.jsx)(_.default,{size:"large",color:"#0000ff"})}):L?(0,T.jsx)(x.default,{style:b.container,children:(0,T.jsx)(C.default,{style:b.errorText,children:L})}):(0,T.jsx)(x.default,{style:b.mainContainer,children:(0,T.jsxs)(Ie.default,{style:b.container,children:[m&&(0,T.jsx)(ut,{title:"Profile Settings",onBackPress:()=>e.goBack()}),(0,T.jsx)(x.default,{style:b.content,children:(0,T.jsxs)(x.default,{style:b.mainContent,children:[(0,T.jsxs)(x.default,{style:b.headerSection,children:[(0,T.jsx)(C.default,{style:b.title,children:"Profile Settings"}),(0,T.jsx)(H.default,{horizontal:!0,showsHorizontalScrollIndicator:!1,contentContainerStyle:b.tabScrollContainer,children:(0,T.jsx)(x.default,{style:b.tabContainer,children:Q.map((e=>(0,T.jsx)(v.default,{style:[b.tab,w===e.id&&b.activeTab],onPress:async()=>{if(j(e.id),"web"===a.default.OS){const t=new URL(window.location.href);t.searchParams.set("initialTab",e.id),window.history.replaceState({},"",t.toString())}await(0,g.setStorage)("MyProfileActiveTab",e.id),(0,g.debugLog)("MBAuieo2o34nf Tab clicked - updated storage",{tabId:e.id})},children:(0,T.jsx)(C.default,{style:[b.tabText,w===e.id&&b.activeTabText],children:e.label})},e.id)))})})]}),(0,T.jsx)(x.default,{style:b.tabContent,children:(()=>{switch((0,g.debugLog)("MBA54321","Rendering active tab with profile data:",{activeTab:w,profileName:A?.name,paymentMethods:A?.payment_methods}),w){case"profile_info":return(0,T.jsx)(Rt,{profilePhoto:A?.profilePhoto,email:A?.email,phone:A?.phone,age:A?.age,address:A?.address,city:A?.city,state:A?.state,zip:A?.zip,country:A?.country,coordinates:A?.coordinates,bio:A?.bio,about_me:A?.about_me,name:A?.name,emergencyContact:A?.emergency_contact,authorizedHouseholdMembers:A?.authorized_household_members,editMode:P,toggleEditMode:oe,onChangeText:te,pickImage:X,setHasUnsavedChanges:e=>{(0,g.debugLog)("MBA9876","ProfileInfoTab setting hasUnsavedChanges:",e),B(e)},onSaveComplete:ee,isMobile:m,rating:A?.rating,reviews:A?.reviews,role:l,isProfessional:"professional"===l,insurance:A?.insurance,onNavigateToTab:j});case"services_availability":return(0,T.jsx)(Ft,{services:A?.services,onToggleService:e=>{const t=A?.services.map((t=>t.id===e?Object.assign({},t,{isActive:!t.isActive}):t));te("services",t)},onEditHours:()=>{},onBlockService:()=>{},onPartialDayBlock:()=>{},isMobile:m});case"pets_preferences":return(0,T.jsx)(Wt,{pets:A?.pets,onAddPet:e=>{const t=e._addToTop,o=(0,Ae.default)(e,Ut),n=t?[o,...A?.pets||[]]:[...A?.pets||[],o];te("pets",n),(0,g.debugLog)("MBA5432","Added new pet locally:",o,t?"(at top of list)":"(at bottom of list)")},onEditPet:(e,t)=>{const o=(A?.pets||[]).map((o=>o.id===e?Object.assign({},o,t):o));te("pets",o),(0,g.debugLog)("MBA5432","Updated pet locally:",{petId:e,updatedPetData:t})},onDeletePet:e=>{const t=(A?.pets||[]).filter((t=>t.id!==e));te("pets",t),(0,g.debugLog)("MBA5432","Deleted pet locally:",e)},onReplacePet:e=>{te("pets",e),(0,g.debugLog)("MBA5432","Replaced entire pets array:",e)},preferences:A?.preferences,onUpdatePreferences:(e,t)=>{const o=Object.assign({},A?.preferences);"homeEnvironment"===e?o[e].includes(t)?o[e]=o[e].filter((e=>e!==t)):o[e]=[...o[e],t]:o[e]=o[e].map((e=>e.id===t?Object.assign({},e,{selected:!e.selected}):e)),te("preferences",o)},userRole:l,isMobile:m});case"settings_payments":return(0,g.debugLog)("MBA54321 Rendering settings_payments tab with payment methods:",{paymentMethods:A?.payment_methods}),(0,T.jsx)(Ht,Object.assign({},A,{navigation:e,onUpdateSetting:(e,t)=>{(0,g.debugLog)("Updating setting:",{id:e,value:t});const o={[e]:t};return(0,Ze.updateProfileInfo)(o).then((e=>(I((t=>Object.assign({},t,e))),(0,g.debugLog)("MBA54321 Setting updated successfully:",o),e)))},paymentMethods:A?.payment_methods||[],onAddPaymentMethod:()=>e.navigate("AddPaymentMethod"),onRemovePaymentMethod:e=>{(0,g.debugLog)("Removing payment method:",e)},onSetDefaultPayment:e=>{(0,g.debugLog)("Setting default payment method:",e)},currentPlan:A?.currentPlan||O,onSwitchPlan:ne,isMobile:m,userRole:l,isApprovedProfessional:d}));default:return null}})()})]})}),W&&"MyProfile"===V?.screen&&(0,T.jsx)(k,{step:N,totalSteps:U,title:V.title,description:V.description,position:V.position,onNext:q,onPrevious:Y,onSkip:G,onClose:J})]})})};var Yt=o(92365);function Gt({title:e,onPress:t}){return(0,T.jsx)(v.default,{style:Jt.button,onPress:t,children:(0,T.jsx)(C.default,{style:Jt.buttonText,children:e})})}const Jt=r.default.create({button:{backgroundColor:m.theme.colors.primary,paddingVertical:m.theme.spacing.small,paddingHorizontal:m.theme.spacing.medium,borderRadius:5,alignItems:"center",marginVertical:m.theme.spacing.small},buttonText:{color:m.theme.colors.whiteText,fontSize:m.theme.fontSizes.medium}}),$t=e=>{if(!e||""===e.trim())return{isValid:!1,message:"Email is required"};if(!/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(e))return{isValid:!1,message:"Please enter a valid email address"};return e.replace(/[<>]/g,"")!==e?{isValid:!1,message:"Email contains invalid characters"}:{isValid:!0,message:""}},Zt=e=>{if(!e||""===e.trim())return{isValid:!1,message:"Name is required"};if(!/^[a-zA-Z\s\-']+$/.test(e))return{isValid:!1,message:"Name can only contain letters, spaces, hyphens, and apostrophes"};return e.replace(/[<>]/g,"")!==e?{isValid:!1,message:"Name contains invalid characters"}:{isValid:!0,message:""}},Kt=e=>{if(!e||""===e.trim())return{isValid:!1,message:"Password is required"};const t=/[A-Z]/.test(e),o=/[a-z]/.test(e),n=/\d/.test(e),a=/[!@#$%^&*(),.?":{}|<>]/.test(e);if((0,g.IsProduction)()){if(e.replace(/[<>]/g,"")!==e)return{isValid:!1,message:"Password contains invalid characters: <, >"}}return(0,g.IsProduction)()&&e.length<8?{isValid:!1,message:"Password must be at least ".concat(8," characters long")}:!(0,g.IsProduction)()||t&&o&&n&&a?{isValid:!0,message:""}:{isValid:!1,message:"Password must contain uppercase, lowercase, numbers, and special characters"}},{width:Qt}=j.default.get("window");const Xt=r.default.create({container:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:m.theme.colors.background,padding:m.theme.spacing.medium},card:{backgroundColor:m.theme.colors.surfaceContrast,borderRadius:8,padding:1.5*m.theme.spacing.large,width:"100%",maxWidth:480,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3},title:{fontSize:1.4*m.theme.fontSizes.extraLarge,fontWeight:"bold",color:m.theme.colors.text,marginBottom:m.theme.spacing.medium,textAlign:"left"},createAccountContainer:{flexDirection:"row",marginBottom:m.theme.spacing.large},createAccountText:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,marginRight:5},createAccountLink:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.primary,textDecorationLine:"underline"},inputLabelContainer:{marginBottom:m.theme.spacing.medium},inputLabel:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,marginBottom:m.theme.spacing.small,fontWeight:"500"},passwordLabelContainer:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:m.theme.spacing.small},showHideText:{color:m.theme.colors.primary,fontSize:m.theme.fontSizes.smallMedium},input:{height:48,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:4,paddingHorizontal:1.5*m.theme.spacing.small,fontSize:m.theme.fontSizes.medium,backgroundColor:m.theme.colors.surfaceContrast},errorInput:{borderColor:m.theme.colors.error},errorText:{color:m.theme.colors.error,fontSize:m.theme.fontSizes.smallMedium,marginTop:4},rememberMeContainer:{flexDirection:"row",alignItems:"center",marginBottom:m.theme.spacing.large},checkbox:{width:20,height:20,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:2,marginRight:10,justifyContent:"center",alignItems:"center"},checkboxInner:{width:20,height:20,backgroundColor:m.theme.colors.primary,borderRadius:2,justifyContent:"center",alignItems:"center"},rememberMeText:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text},loginButton:{backgroundColor:m.theme.colors.primary,paddingVertical:1.75*m.theme.spacing.small,borderRadius:4,alignItems:"center",marginBottom:m.theme.spacing.medium},loginButtonText:{color:m.theme.colors.whiteText,fontSize:m.theme.fontSizes.medium,fontWeight:"500"},forgotPasswordContainer:{alignItems:"center",marginTop:m.theme.spacing.small},link:{color:m.theme.colors.primary,fontSize:m.theme.fontSizes.smallMedium},message:{marginTop:m.theme.spacing.small,color:m.theme.colors.error,fontSize:m.theme.fontSizes.smallMedium,textAlign:"center"},prototypeWarning:{backgroundColor:"#FFF3CD",color:"#856404",padding:1.5*m.theme.spacing.small,marginBottom:m.theme.spacing.medium,borderRadius:4,textAlign:"center"}});var eo=o(44767);const{width:to}=j.default.get("window");function oo(){const e=(0,y.useNavigation)(),t=(0,y.useRoute)(),{signIn:o,is_DEBUG:r}=(0,n.useContext)(g.AuthContext),[i,s]=(0,n.useState)(""),[l,d]=(0,n.useState)(""),[c,u]=(0,n.useState)(""),[h,p]=(0,n.useState)(""),[w,j]=(0,n.useState)(""),[B,k]=(0,n.useState)(!1),[A,I]=(0,n.useState)(""),[M,D]=(0,n.useState)(""),[R,L]=(0,n.useState)(null),[z,P]=(0,n.useState)(!1),[F,O]=(0,n.useState)(!1),[E,W]=(0,n.useState)(""),[N,U]=(0,n.useState)(!1),[V,Y]=(0,n.useState)(""),[G,J]=(0,n.useState)([]),[$,Z]=(0,n.useState)(!0),K=[{name:"Colorado Springs",supported:!0},{name:"Denver",supported:!1},{name:"Other",supported:!1}],[Q,X]=(0,n.useState)(""),[ee,te]=(0,n.useState)(""),[oe,ne]=(0,n.useState)(""),[ae,re]=(0,n.useState)(""),[ie,se]=(0,n.useState)("");(0,n.useEffect)((()=>{(async()=>{try{t.name;(0,g.debugLog)("MBA4321 Current route name:",t.name);let o=t.params?.token;if((0,g.debugLog)("MBA4321 Token from route params:",o),!o&&"web"===a.default.OS){const e=window.location.pathname;if((0,g.debugLog)("MBA4321 Current URL path:",e),(0,g.debugLog)("MBA4321 Full location object:",{pathname:window.location.pathname,href:window.location.href,search:window.location.search,hash:window.location.hash}),e.includes("/invite/")){const t=e.split("/"),n=t.findIndex((e=>"invite"===e));-1!==n&&t.length>n+1&&(o=t[n+1],(0,g.debugLog)("MBA4321 Found invitation token from invite URL path:",o))}else if(e.includes("/signup/")){const t=e.split("/"),n=t.findIndex((e=>"signup"===e));-1!==n&&t.length>n+1&&(o=t[n+1],(0,g.debugLog)("MBA4321 Found invitation token from signup URL path:",o))}}if(!o&&"web"===a.default.OS){const e=new URLSearchParams(window.location.search).get("token");e&&(o=e,(0,g.debugLog)("MBA4321 Found invitation token from URL search params:",o))}if(o){(0,g.debugLog)("MBA4321 Processing invitation token:",o),L(o),O(!0);try{const e=await(0,Ze.verifyInvitation)(o);(0,g.debugLog)("MBA4321 Invitation verification result:",e),e.valid?(P(!0),D(e.inviter_name),e.email&&u(e.email),I("You've been invited by ".concat(e.inviter_name,"!"))):I("This invitation is no longer valid: ".concat(e.error))}catch(e){(0,g.debugLog)("MBA4321 Error verifying invitation:",e),I("This invitation link is invalid or has expired.")}finally{O(!1)}}}catch(e){(0,g.debugLog)("MBA4321 Error processing invitation:",e),O(!1)}})()}),[t.params,t.name]),(0,n.useEffect)((()=>{(async()=>{Z(!0);try{const e=await b.default.get("".concat(f.API_BASE_URL,"/api/locations/v1/supported/"));(0,g.debugLog)("MBA6789: Locations fetched from backend",e.data),e.data&&Array.isArray(e.data.locations)?J(e.data.locations):((0,g.debugLog)("MBA6789: Using fallback locations due to unexpected response format",e.data),J(K))}catch(e){(0,g.debugLog)("MBA6789: Error fetching locations",e),J(K)}finally{Z(!1)}})()}),[]);const le=Object.assign({name:"".concat(i.trim().charAt(0).toUpperCase()+i.trim().slice(1).toLowerCase()," ").concat(l.trim().charAt(0).toUpperCase()+l.trim().slice(1).toLowerCase()),email:c.trim().toLowerCase(),password:h,password2:w,phone_number:"",location:z?"Colorado Springs":E},R&&{invitation_token:R});return(0,T.jsx)(eo.default,{style:no.container,behavior:"ios"===a.default.OS?"padding":"height",keyboardVerticalOffset:"ios"===a.default.OS?64:0,children:(0,T.jsxs)(H.default,{contentContainerStyle:no.scrollContainer,children:[(0,T.jsxs)(x.default,{style:no.formContainer,children:[(0,T.jsx)(C.default,{style:no.title,children:"Sign Up"}),(0,T.jsx)(C.default,{style:no.subtitle,children:"Sign up to continue"}),F&&(0,T.jsxs)(x.default,{style:no.inviteContainer,children:[(0,T.jsx)(_.default,{size:"small",color:m.theme.colors.primary}),(0,T.jsx)(C.default,{style:no.inviteText,children:"Verifying invitation..."})]}),z&&(0,T.jsx)(x.default,{style:no.inviteContainer,children:(0,T.jsxs)(C.default,{style:no.inviteText,children:["You've been invited by ",M,"!"]})}),!z&&(0,T.jsxs)(x.default,{style:no.locationContainer,children:[(0,T.jsx)(C.default,{style:no.label,children:"Where are you located?"}),$?(0,T.jsxs)(x.default,{style:[no.input,no.dropdown,no.loadingContainer],children:[(0,T.jsx)(_.default,{size:"small",color:m.theme.colors.primary}),(0,T.jsx)(C.default,{style:no.placeholderText,children:"Loading locations..."})]}):(0,T.jsxs)(x.default,{style:no.dropdownWrapper,children:[(0,T.jsxs)(v.default,{style:[no.input,no.dropdown,V?no.errorInput:null],onPress:()=>U(!N),children:[(0,T.jsx)(C.default,{style:E?no.inputText:no.placeholderText,children:E||"Select your location"}),(0,T.jsx)(S.default,{name:N?"chevron-up":"chevron-down",size:24,color:m.theme.colors.text})]}),N&&(0,T.jsx)(x.default,{style:no.dropdownMenu,children:G.map((e=>(0,T.jsx)(v.default,{style:no.dropdownItem,onPress:()=>{return t=e.name,console.log("Location selected:",t),(0,g.debugLog)("MBA6789: Location selected",t),W(t),U(!1),void Y("");var t},children:(0,T.jsxs)(C.default,{style:no.dropdownItemText,children:[e.name," ",!e.supported&&"(Coming Soon)"]})},e.name)))})]}),V?(0,T.jsx)(C.default,{style:no.errorText,children:V}):null]}),z||!E||G.find((e=>e.name===E&&e.supported))?(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)(x.default,{style:no.inputContainer,children:[(0,T.jsx)(q.default,{style:[no.input,Q?no.errorInput:null],placeholder:"First Name",value:i,onChangeText:e=>{s(e),X("")}}),Q?(0,T.jsx)(C.default,{style:no.errorText,children:Q}):null]}),(0,T.jsxs)(x.default,{style:no.inputContainer,children:[(0,T.jsx)(q.default,{style:[no.input,ee?no.errorInput:null],placeholder:"Last Name",value:l,onChangeText:e=>{d(e),te("")}}),ee?(0,T.jsx)(C.default,{style:no.errorText,children:ee}):null]}),(0,T.jsxs)(x.default,{style:no.inputContainer,children:[(0,T.jsx)(q.default,{style:[no.input,oe?no.errorInput:null],placeholder:"Email",value:c,onChangeText:e=>{u(e),ne("")},keyboardType:"email-address",autoCapitalize:"none",editable:!0}),oe?(0,T.jsx)(C.default,{style:no.errorText,children:oe}):null]}),(0,T.jsxs)(x.default,{style:no.inputContainer,children:[(0,T.jsx)(q.default,{style:[no.input,ae?no.errorInput:null],placeholder:"Password",value:h,onChangeText:e=>{p(e),re("")},secureTextEntry:!0}),ae?(0,T.jsx)(C.default,{style:no.errorText,children:ae}):null]}),(0,T.jsxs)(x.default,{style:no.inputContainer,children:[(0,T.jsx)(q.default,{style:[no.input,ie?no.errorInput:null],placeholder:"Confirm Password",value:w,onChangeText:e=>{j(e),se("")},secureTextEntry:!0}),ie?(0,T.jsx)(C.default,{style:no.errorText,children:ie}):null]}),(0,T.jsx)(Gt,{title:"Sign Up",onPress:async()=>{if((()=>{let e=!0;z||E||(Y("Please select your location"),e=!1);const t=Zt(i);X(t.message),t.isValid||(e=!1);const o=Zt(l);te(o.message),o.isValid||(e=!1);const n=$t(c);ne(n.message),n.isValid||(e=!1);const a=Kt(h);re(a.message),a.isValid||(e=!1);const r=((e,t)=>e!==t?{isValid:!1,message:"Passwords do not match"}:{isValid:!0,message:""})(h,w);return se(r.message),r.isValid||(e=!1),e})()){k(!0);try{(0,g.debugLog)("MBA12345 Starting user registration process");let n="UTC";try{n=Intl.DateTimeFormat().resolvedOptions().timeZone,(0,g.debugLog)("MBA12345 User timezone detected using Intl API",{userTimezone:n})}catch(t){(0,g.debugLog)("MBA12345 Error detecting timezone using Intl API",t),n="UTC"}const r=!1;(0,g.debugLog)("MBA12345 User timezone and preferences",{userTimezone:n,useMilitaryTime:r});const i=Object.assign({},le,{timezone:n,use_military_time:r,invitation_token:R}),s=await b.default.post("".concat(f.API_BASE_URL,"/api/users/v1/register/"),i);(0,g.debugLog)("MBA12345 User registration successful",s.data),(0,g.debugLog)("MBA12345 Attempting to log in with new credentials");const l=await b.default.post("".concat(f.API_BASE_URL,"/api/token/"),{email:c.toLowerCase(),password:h});(0,g.debugLog)("MBA12345 Login successful, received tokens");const{access:d,refresh:u}=l.data;if((0,g.debugLog)("MBA12345 Calling signIn function from AuthContext"),await o(d,u),(0,g.debugLog)("MBA12345 Authentication setup complete"),R&&z)try{await b.default.post("".concat(f.API_BASE_URL,"/api/users/v1/invitations/").concat(R,"/accept/"),{},{headers:{Authorization:"Bearer ".concat(d),"Content-Type":"application/json"}}),(0,g.debugLog)("MBA12345 Invitation accepted successfully")}catch(t){(0,g.debugLog)("MBA12345 Error accepting invitation:",t)}"ios"===a.default.OS||"android"===a.default.OS?ft.default.alert("Success","Account created successfully!",[{text:"OK",onPress:()=>e.navigate("MyProfile")}]):e.navigate("MyProfile")}catch(t){(0,g.debugLog)("MBA12345 Error during signup process",t.response?.data||t.message);let e="Signup Failed: An error occurred during signup.";if(t.response){const o=t.response.data;if(o){const t=Object.entries(o)[0];if(t){const[o,n]=t;e="".concat(o,": ").concat(Array.isArray(n)?n[0]:n)}}}"ios"===a.default.OS||"android"===a.default.OS?ft.default.alert("Error",e):I(e)}finally{k(!1)}}},style:no.signupButton})]}):(0,T.jsxs)(x.default,{style:no.waitlistContainer,children:[(0,T.jsxs)(C.default,{style:no.waitlistMessage,children:["CrittrCove isn't available in ",E," yet, but we're expanding soon!"]}),(0,T.jsx)(C.default,{style:no.waitlistSubMessage,children:"Join our waitlist to be notified when we launch in your area."}),(0,T.jsx)(Gt,{title:"Join Waitlist",onPress:()=>{e.navigate("Waitlist")},style:no.waitlistButton})]}),B&&(0,T.jsx)(_.default,{size:"large",color:m.theme.colors.primary,style:no.loader}),A?(0,T.jsx)(C.default,{style:no.message,children:A}):null]}),(0,T.jsxs)(x.default,{style:no.signInContainer,children:[(0,T.jsx)(C.default,{style:no.signInText,children:"Already have an account? "}),(0,T.jsx)(v.default,{onPress:()=>{e.navigate("SignIn")},children:(0,T.jsx)(C.default,{style:no.signInLink,children:"Sign in"})})]})]})})}const no=r.default.create({container:{flex:1,backgroundColor:m.theme.colors.background},scrollContainer:{padding:20,alignItems:"center",justifyContent:"center",minHeight:"100%"},formContainer:{backgroundColor:m.theme.colors.surfaceContrast,padding:30,borderRadius:10,width:"100%",maxWidth:500,alignItems:"center",shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3,borderWidth:1,borderColor:m.theme.colors.border},title:{fontSize:32,color:m.theme.colors.text,marginBottom:8,fontWeight:"bold",textAlign:"center"},subtitle:{color:m.theme.colors.text,fontSize:16,marginBottom:24,textAlign:"center"},inputContainer:{width:"100%",marginBottom:16},input:{width:"100%",height:50,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:5,paddingHorizontal:10,backgroundColor:m.theme.colors.surface,fontSize:16},errorInput:{borderColor:m.theme.colors.error},errorText:{color:m.theme.colors.error,fontSize:12,marginTop:5},message:{marginTop:20,color:m.theme.colors.text,textAlign:"center",fontSize:16},inviteContainer:{marginBottom:20,padding:16,borderWidth:1,borderColor:m.theme.colors.primary,borderRadius:8,alignItems:"center",backgroundColor:"#f0f9ff",width:"100%",flexDirection:"row",justifyContent:"center"},inviteText:{color:m.theme.colors.primary,fontSize:16,marginLeft:8,fontWeight:"500",textAlign:"center"},signupButton:{marginTop:24,width:"100%"},loader:{marginTop:20},signInContainer:{flexDirection:"row",marginTop:24,justifyContent:"center",alignItems:"center"},signInText:{color:m.theme.colors.text,fontSize:16},signInLink:{color:m.theme.colors.primary,fontSize:16,fontWeight:"600"},dropdown:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",height:50,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:5,paddingHorizontal:10,backgroundColor:m.theme.colors.surface},placeholderText:{color:m.theme.colors.placeHolderText,fontSize:16},inputText:{color:m.theme.colors.text,fontSize:16},dropdownMenu:{position:"absolute",top:"100%",left:0,right:0,zIndex:1002,marginTop:4,maxHeight:200,backgroundColor:m.theme.colors.surface,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:5,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3},dropdownItem:{padding:12,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},dropdownItemText:{color:m.theme.colors.text,fontSize:16},label:{color:m.theme.colors.text,fontSize:16,marginBottom:8},locationContainer:{width:"100%",marginBottom:16,position:"relative",zIndex:1e3},dropdownWrapper:{position:"relative",zIndex:1001},loadingContainer:{justifyContent:"center"},waitlistContainer:{marginTop:20,padding:20,borderRadius:8,alignItems:"center",width:"100%",backgroundColor:"#f0f9ff",borderWidth:1,borderColor:"#e0e7ff",shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.05,shadowRadius:2,elevation:2},waitlistMessage:{color:m.theme.colors.text,fontSize:18,fontWeight:"600",marginBottom:16,textAlign:"center"},waitlistSubMessage:{color:m.theme.colors.text,fontSize:16,textAlign:"center",marginBottom:8},waitlistButton:{marginTop:24,width:"100%",backgroundColor:"#6B7280"}}),{width:ao}=j.default.get("window");const ro=(e,t,o)=>r.default.create({container:{flex:1,backgroundColor:m.theme.colors.background,marginLeft:e>900&&o?t?70:250:0,transition:"margin-left 0.3s ease"},safeArea:{flex:1,paddingTop:"android"===a.default.OS?20:0},content:{flex:1,justifyContent:"center",alignItems:"center",padding:20},backButton:{position:"absolute",top:20,left:20,flexDirection:"row",alignItems:"center",zIndex:1},backText:{marginLeft:8,fontSize:18,fontWeight:"600",color:m.theme.colors.text},card:{backgroundColor:m.theme.colors.surfaceContrast,borderRadius:12,padding:40,width:"100%",maxWidth:400,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:8,elevation:5},title:{fontSize:28,fontWeight:"600",color:m.theme.colors.text,textAlign:"center",marginBottom:30},input:{backgroundColor:m.theme.colors.surface,borderRadius:8,padding:15,fontSize:16,color:m.theme.colors.text,borderWidth:1,borderColor:m.theme.colors.border,marginBottom:20},inputError:{borderColor:m.theme.colors.error},button:{marginBottom:20},loader:{marginTop:10},message:{textAlign:"center",color:m.theme.colors.primary,fontSize:14,marginTop:10},errorMessage:{color:m.theme.colors.error}}),{width:io}=j.default.get("window");const so=r.default.create({container:{padding:m.theme.spacing.medium,backgroundColor:m.theme.colors.background,flex:1,justifyContent:"center",alignItems:"center"},title:{fontSize:m.theme.fontSizes.large,color:m.theme.colors.primary,marginBottom:m.theme.spacing.medium},input:{width:io>600?600:"100%",maxWidth:600,height:40,borderColor:"gray",borderWidth:1,marginBottom:m.theme.spacing.small,paddingHorizontal:m.theme.spacing.small},message:{marginTop:m.theme.spacing.small,color:m.theme.colors.primary,fontSize:m.theme.fontSizes.medium}});var lo=o(91808),co=o(12686),uo=o(15558),mo=o(32160);const go=r.default.create({card:Object.assign({backgroundColor:m.theme.colors.surfaceContrast,borderRadius:12,padding:16,marginBottom:16},"web"===a.default.OS&&{transition:"all 0.2s ease-in-out",cursor:"pointer"}),cardHovered:{transform:[{scale:1.02}],shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:5},cardContent:{flexDirection:"column"},mobileCardContent:{gap:12},topContent:{flexDirection:"row",alignItems:"flex-start",gap:16},mobileTopContent:{marginBottom:0},profileImage:{width:88,height:88,borderRadius:44},mobileProfileImage:{width:48,height:48,borderRadius:24},contentContainer:{flex:1},mobileContentContainer:{flex:1},headerContainer:{flexDirection:"row",justifyContent:"space-between",alignItems:"flex-start",marginBottom:8},mobileHeaderContainer:{marginBottom:0},nameAndPets:{flex:1},statusBadge:{alignSelf:"flex-start",paddingHorizontal:12,paddingVertical:4,borderRadius:16},statusContent:{flexDirection:"row",alignItems:"center",gap:6},statusText:{fontSize:12,fontWeight:"500",fontFamily:m.theme.fonts.regular.fontFamily},clientContainer:{flexDirection:"row",alignItems:"center",gap:6,marginBottom:6},name:{fontSize:16,fontWeight:"600",color:m.theme.colors.mybookings.ownerName,fontFamily:m.theme.fonts.regular.fontFamily},petContainer:{flexDirection:"row",alignItems:"center",gap:4},petInfo:{fontSize:14,color:"#888975",fontFamily:m.theme.fonts.regular.fontFamily},mobileDivider:{height:1,backgroundColor:m.theme.colors.surface,width:"100%"},metaInfo:{flexDirection:"row",alignItems:"center",flexWrap:"wrap",gap:8},mobileMetaInfo:{width:"100%"},mobileMetaRow:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"},metaItemContainer:{flexDirection:"row",alignItems:"center",gap:4},metaText:{fontSize:14,color:m.theme.colors.mybookings.metaText,fontFamily:m.theme.fonts.regular.fontFamily},viewDetailsButton:{backgroundColor:m.theme.colors.primary,paddingHorizontal:16,paddingVertical:8,borderRadius:8},viewDetailsText:{color:m.theme.colors.surfaceContrast,fontSize:14,fontWeight:"500",fontFamily:m.theme.fonts.regular.fontFamily},mobileClientContainer:{marginBottom:4},mobileName:{fontSize:15,color:m.theme.colors.mybookings.ownerName},mobilePetContainer:{marginBottom:2},mobilePetInfo:{fontSize:13,color:m.theme.colors.mybookings.metaText},mobileStatusBadge:{paddingHorizontal:8,paddingVertical:2,borderRadius:12},mobileStatusText:{fontSize:10}}),ho=({booking:e,type:t,onViewDetails:r})=>{const{id:i,status:s,date:l,time:d,serviceName:c}=e;let u="";"professional"===t?(u=e.client_name||e.ownerName||"Client",(0,g.debugLog)("MBA5677: Using client name for professional view",{client_name:e.client_name,ownerName:e.ownerName})):(u=e.professional_name||e.professionalName||"Professional",(0,g.debugLog)("MBA5677: Using professional name for client view",{professional_name:e.professional_name,professionalName:e.professionalName}));const h=(e=>{switch((0,g.debugLog)("MBA5677: Processing status",{status:e}),e){case"Pending Initial Professional Changes":case"Pending Professional Changes":return{text:"Pending Pro",bgColor:m.theme.colors.mybookings.main,textColor:m.theme.colors.mybookings.secondary,icon:"clock-outline"};case"Pending Owner Approval":return{text:"Pending Owner",bgColor:m.theme.colors.mybookings.main,textColor:m.theme.colors.mybookings.secondary,icon:"clock-outline"};case"Confirmed":return{text:"Confirmed",bgColor:m.theme.colors.mybookings.confirmedBg,textColor:m.theme.colors.mybookings.confirmedText,icon:"check-circle-outline"};case"Completed":return{text:"Completed",bgColor:m.theme.colors.mybookings.completedBg,textColor:m.theme.colors.mybookings.completedText,icon:"flag-checkered"};case"Confirmed Pending Professional Changes":return{text:"Confirmed \u2022 Pending Pro",bgColor:m.theme.colors.mybookings.confirmedBg,textColor:m.theme.colors.mybookings.confirmedText,icon:"check-circle-outline"};case"Confirmed Pending Owner Approval":return{text:"Confirmed \u2022 Pending Owner",bgColor:m.theme.colors.mybookings.confirmedBg,textColor:m.theme.colors.mybookings.confirmedText,icon:"check-circle-outline"};default:return{text:e||"Unknown",bgColor:m.theme.colors.mybookings.main,textColor:m.theme.colors.mybookings.secondary,icon:"clock-outline"}}})(s),f=e.pets||[],{screenWidth:p,timeSettings:y}=(0,n.useContext)(g.AuthContext),b=p<600,[w,j]=(0,n.useState)(!1),B=rt();(0,g.debugLog)("MBA5677: Original booking date/time",{date:l,time:d});const k="UTC"!==y?.timezone&&l&&d?(0,mo.convertDateTimeFromUTC)(l,d,y?.timezone||"America/Denver",y?.use_military_time||!1):l&&d?{date:l,time:d}:null,A=k?.date?(()=>{(0,g.debugLog)("MBA5677: Formatting with direct date",k.date);const e=k.date.split("-");if(3===e.length){const[t,o,n]=e,a=new Date(parseInt(t),parseInt(o)-1,parseInt(n));if(!isNaN(a.getTime())){const e=a.toLocaleString("default",{month:"short"});return(0,g.debugLog)("MBA5677: Formatted date parts",{year:t,month:o,day:n,monthName:e,day:a.getDate()}),"".concat(e," ").concat(a.getDate())}}return k.date})():"No date selected",_=k?.time;(0,g.debugLog)("MBA5677: Converted date/time",{formattedDate:A,convertedTime:_,convertedDateTime:k,timezone:y?.timezone,originalDate:l,originalTime:d});const I=()=>{const e=_||"No time selected",t=c||"No service selected";return b?(0,T.jsx)(x.default,{style:go.mobileMetaInfo,children:(0,T.jsxs)(x.default,{style:go.mobileMetaRow,children:[(0,T.jsxs)(x.default,{style:go.metaItemContainer,children:[(0,T.jsx)(S.default,{name:"calendar",size:14,color:m.theme.colors.mybookings.metaText}),(0,T.jsx)(C.default,{style:go.metaText,children:A})]}),(0,T.jsxs)(x.default,{style:go.metaItemContainer,children:[(0,T.jsx)(S.default,{name:"clock-outline",size:14,color:m.theme.colors.mybookings.metaText}),(0,T.jsx)(C.default,{style:go.metaText,children:e})]}),(0,T.jsxs)(x.default,{style:go.metaItemContainer,children:[(0,T.jsx)(S.default,{name:"briefcase-outline",size:14,color:m.theme.colors.mybookings.metaText}),(0,T.jsx)(C.default,{style:go.metaText,children:t})]})]})}):(0,T.jsxs)(x.default,{style:go.metaInfo,children:[(0,T.jsxs)(x.default,{style:go.metaItemContainer,children:[(0,T.jsx)(S.default,{name:"calendar",size:16,color:m.theme.colors.mybookings.metaText}),(0,T.jsx)(C.default,{style:go.metaText,children:A})]}),(0,T.jsx)(C.default,{style:go.metaText,children:" \u2022 "}),(0,T.jsxs)(x.default,{style:go.metaItemContainer,children:[(0,T.jsx)(S.default,{name:"clock-outline",size:16,color:m.theme.colors.mybookings.metaText}),(0,T.jsx)(C.default,{style:go.metaText,children:e})]}),(0,T.jsx)(C.default,{style:go.metaText,children:" \u2022 "}),(0,T.jsxs)(x.default,{style:go.metaItemContainer,children:[(0,T.jsx)(S.default,{name:"briefcase-outline",size:16,color:m.theme.colors.mybookings.metaText}),(0,T.jsx)(C.default,{style:go.metaText,children:t})]})]})};return(0,g.debugLog)("MBA5677: Rendering BookingCard",{booking:e,type:t,name:u,status:s}),(0,T.jsx)(v.default,{style:[go.card,"web"===a.default.OS&&w&&go.cardHovered],onPress:r,onMouseEnter:()=>B&&j(!0),onMouseLeave:()=>B&&j(!1),children:(0,T.jsxs)(x.default,{style:[go.cardContent,b&&go.mobileCardContent],children:[(0,T.jsxs)(x.default,{style:[go.topContent,b&&go.mobileTopContent],children:[(0,T.jsx)(U.default,{source:o(4456),style:[go.profileImage,b&&go.mobileProfileImage]}),(0,T.jsxs)(x.default,{style:[go.contentContainer,b&&go.mobileContentContainer],children:[(0,T.jsxs)(x.default,{style:[go.headerContainer,b&&go.mobileHeaderContainer],children:[(0,T.jsxs)(x.default,{style:go.nameAndPets,children:[(0,T.jsxs)(x.default,{style:[go.clientContainer,b&&go.mobileClientContainer],children:[(0,T.jsx)(S.default,{name:"account",size:b?16:18,color:m.theme.colors.mybookings.ownername}),(0,T.jsx)(C.default,{style:[go.name,b&&go.mobileName],children:u})]}),(0,T.jsxs)(x.default,{style:[go.petContainer,b&&go.mobilePetContainer],children:[(0,T.jsx)(S.default,{name:"paw",size:14,color:m.theme.colors.mybookings.metaText}),(0,T.jsx)(C.default,{style:[go.petInfo,b&&go.mobilePetInfo],children:f.length>0?f.map((e=>e.name)).join(", "):"No pets selected"})]})]}),(0,T.jsx)(x.default,{style:[go.statusBadge,{backgroundColor:h.bgColor},b&&go.mobileStatusBadge],children:(0,T.jsxs)(x.default,{style:go.statusContent,children:[(0,T.jsx)(S.default,{name:h.icon,size:b?12:16,color:h.textColor}),(0,T.jsx)(C.default,{style:[go.statusText,{color:h.textColor},b&&go.mobileStatusText],children:h.text})]})})]}),!b&&I()]}),!b&&(0,T.jsx)(v.default,{style:go.viewDetailsButton,onPress:r,children:(0,T.jsx)(C.default,{style:go.viewDetailsText,children:"View Details"})})]}),b&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(x.default,{style:go.mobileDivider}),I()]})]})})},fo=r.default.create({container:{flex:1,backgroundColor:m.theme.colors.background},contentContainer:{padding:16},section:{marginTop:24},badge:{fontSize:12,color:m.theme.colors.whiteText,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"bold",backgroundColor:m.theme.colors.mainColors.main,paddingHorizontal:8,paddingVertical:4,borderRadius:4,marginTop:4},sectionHeaderContainer:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:8},sectionHeader:{fontSize:20,fontFamily:m.theme.fonts.header.fontFamily,color:m.theme.colors.text,marginBottom:8},addRateText:{color:m.theme.colors.mainColors.main,fontSize:14,fontWeight:"600",fontFamily:m.theme.fonts.regular.fontFamily},card:{backgroundColor:m.theme.colors.surfaceContrast,borderRadius:8,paddingHorizontal:16,paddingBottom:16,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3},breakdownSection:{width:"100%"},dateHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16},dateTextContainer:{flex:1,marginRight:8},dateText:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},breakdownItem:{flexDirection:"row",justifyContent:"space-between",paddingVertical:12,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},breakdownLabelContainer:{flex:1,marginRight:16},breakdownLabel:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},breakdownCalculation:{fontSize:14,color:m.theme.colors.placeHolderText,marginTop:4,fontFamily:m.theme.fonts.regular.fontFamily},breakdownAmount:{fontSize:16,color:m.theme.colors.text,fontWeight:"600",fontFamily:m.theme.fonts.regular.fontFamily},totalItem:{marginTop:8,paddingTop:16},subtotalRow:{flexDirection:"row",justifyContent:"space-between",marginBottom:12,paddingBottom:12,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},subtotalLabel:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},subtotalAmount:{fontSize:16,color:m.theme.colors.text,fontWeight:"600",fontFamily:m.theme.fonts.regular.fontFamily},feeRow:{flexDirection:"row",justifyContent:"space-between",marginBottom:12,paddingBottom:12,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},feeLabel:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},feeAmount:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},totalAmountContainer:{flexDirection:"row",justifyContent:"space-between",marginBottom:16,paddingBottom:16},totalLabel:{fontSize:16,fontWeight:"600",color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},totalAmount:{fontSize:18,fontWeight:"700",color:m.theme.colors.mainColors.main,fontFamily:m.theme.fonts.regular.fontFamily},divider:{height:1,backgroundColor:m.theme.colors.border,marginBottom:16},payoutContainer:{alignItems:"flex-end"},payoutLabel:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},payoutAmount:{fontSize:18,fontWeight:"700",color:m.theme.colors.success,fontFamily:m.theme.fonts.regular.fontFamily,marginTop:4},payoutBreakdown:{fontSize:12,color:m.theme.colors.placeHolderText,fontFamily:m.theme.fonts.regular.fontFamily,marginTop:4},inputContainer:{flexDirection:"row",alignItems:"center",marginTop:4},addRateContainer:{padding:16,width:"100%"},rateNameAmountRow:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:"100%",marginBottom:12},rateEditContainer:{flexDirection:"row",alignItems:"center",marginTop:8},amountInputContainer:{flexDirection:"row",alignItems:"center",minWidth:120,maxWidth:150},rateInput:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:4,paddingVertical:8,paddingHorizontal:12,minWidth:100,flex:1},currencySymbol:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,marginRight:4,marginLeft:2},inputLabel:{fontSize:14,color:m.theme.colors.placeHolderText,fontFamily:m.theme.fonts.regular.fontFamily,marginLeft:4},nameInput:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:4,paddingVertical:8,paddingHorizontal:12,flex:1,marginRight:16},descriptionInput:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:4,paddingVertical:8,paddingHorizontal:12,width:"100%"},saveButton:{backgroundColor:m.theme.colors.mainColors.main,borderRadius:4,paddingVertical:12,paddingHorizontal:20,marginTop:0,marginBottom:0,marginRight:0},saveButtonText:{color:"white",fontSize:16,fontWeight:"600",fontFamily:m.theme.fonts.regular.fontFamily},formDivider:{height:1,backgroundColor:m.theme.colors.border,marginVertical:12,width:"100%"},editableAdditionalRateRow:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",width:"100%"},rateNameAmountRowWithDelete:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",flex:1,marginRight:8},deleteButton:{padding:8,backgroundColor:m.theme.colors.surface,borderRadius:4,marginLeft:8},buttonsContainer:{flexDirection:"row",justifyContent:"flex-end",alignItems:"center",marginTop:16,marginBottom:8,marginRight:16},cancelButton:{backgroundColor:m.theme.colors.surface,borderRadius:4,paddingVertical:12,paddingHorizontal:20,marginRight:12},cancelButtonText:{color:m.theme.colors.text,fontSize:16,fontWeight:"600",fontFamily:m.theme.fonts.regular.fontFamily},multipleDatesContainer:{marginBottom:16},occurrenceCost:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"600"},ratesToggleButton:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",padding:8,backgroundColor:m.theme.colors.surface,borderRadius:4},ratesToggleText:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},ratesBreakdown:{padding:16},rateItem:{flexDirection:"row",justifyContent:"space-between",marginBottom:8},rateLabel:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},rateAmount:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"600"},rateDescription:{fontSize:14,color:m.theme.colors.placeHolderText,fontFamily:m.theme.fonts.regular.fontFamily},occurrenceDivider:{height:1,backgroundColor:m.theme.colors.border,marginBottom:16}}),po=({bookingData:e,onRatesUpdate:t,bookingId:o,showEditControls:a=!0,isProfessional:r=!0})=>{const{timeSettings:i}=(0,n.useContext)(g.AuthContext),[s,l]=(0,n.useState)(!1),[d,c]=(0,n.useState)(!1),[u,h]=(0,n.useState)(null),[f,p]=(0,n.useState)({name:"",amount:"",description:""}),[y,b]=(0,n.useState)(!1),[w,j]=(0,n.useState)(null),[B,k]=(0,n.useState)(new Set),[A,_]=(0,n.useState)(null),[I,M]=(0,n.useState)({}),[D,R]=(0,n.useState)(null),[L,z]=(0,n.useState)({name:"",amount:"",description:""}),{width:P}=(0,_e.default)();(0,n.useEffect)((()=>{if((0,g.debugLog)("MBA54321 ReviewAndRatesCard received bookingData:",e),(0,g.debugLog)("MBA54321 ReviewAndRatesCard received bookingId:",o),e?.occurrences?.[0]){const t={base_rate:0,additional_animal_rate:0,applies_after:1,holiday_rate:0,holiday_days:0,additional_rates:[]},o=e.occurrences[0].rates||t;h(Object.assign({},o))}}),[e,o]),(0,n.useEffect)((()=>{(0,g.debugLog)("MBA66777 Edit state changed:",{isEditMode:s,editingOccurrenceId:A,occurrencesCount:e?.occurrences?.length||0})}),[s,A,e?.occurrences?.length]);const F=e=>e?"$".concat(parseFloat(e).toFixed(2)):"$0.00",O=()=>{c(!d),p({name:"",amount:"",description:""})},E=e=>{let t=e.replace(/[^\d.]/g,"").replace(/(\..*)\./g,"$1");const o=t.split(".");return o.length>1&&o[1].length>2&&(t="".concat(o[0],".").concat(o[1].substring(0,2))),t},W=e=>{p((t=>Object.assign({},t,{amount:E(e)})))},N=e=>{z((t=>Object.assign({},t,{amount:E(e)})))},U=async()=>{if(u)try{b(!0),j(null),(0,g.debugLog)("MBA66777 Saving rate changes:",u),(0,g.debugLog)("MBA66777 Using bookingId:",o);const n=Object.assign({},u,{additional_rates:u.additional_rates&&u.additional_rates.length>0?u.additional_rates.map((e=>({title:e.name||e.title,amount:""===e.amount?0:"string"===typeof e.amount?parseFloat(e.amount):e.amount,description:e.description||"Additional rate"}))):[]}),a=e.occurrences.map(((e,t)=>0===t?{occurrence_id:e.occurrence_id,rates:{base_rate:""===u.base_rate?0:"string"===typeof u.base_rate?parseFloat(u.base_rate):u.base_rate,additional_animal_rate:""===u.additional_animal_rate?0:"string"===typeof u.additional_animal_rate?parseFloat(u.additional_animal_rate):u.additional_animal_rate||0,applies_after:parseInt(u.applies_after||1),holiday_rate:""===u.holiday_rate?0:"string"===typeof u.holiday_rate?parseFloat(u.holiday_rate):u.holiday_rate||0,additional_rates:n.additional_rates}}:{occurrence_id:e.occurrence_id,rates:{base_rate:parseFloat(e.rates.base_rate),additional_animal_rate:parseFloat(e.rates.additional_animal_rate||0),applies_after:parseInt(e.rates.applies_after||1),holiday_rate:parseFloat(e.rates.holiday_rate||0),additional_rates:(e.rates.additional_rates||[]).map((e=>({title:e.name||e.title,amount:parseFloat(e.amount),description:e.description||""})))}}));(0,g.debugLog)("MBA66777 Sending all occurrences to API:",a);const r=await(0,Ze.updateBookingDraftRates)(o,a);(0,g.debugLog)("MBA66777 Rate update API response:",r),r.draft_data&&t&&t(r.draft_data),l(!1),_(null),M({}),k(new Set),c(!1),R(null)}catch(n){(0,g.debugLog)("MBA66777 Error saving rate changes:",n),j("Failed to update rates. Please try again.")}finally{b(!1)}},V=async()=>{if(f.name&&(f.amount||""===f.amount))try{b(!0),j(null);f.name,""===f.amount||("string"===typeof f.amount?parseFloat(f.amount):f.amount),f.description;const n=Object.assign({},u);n.additional_rates||(n.additional_rates=[]),n.additional_rates.push({name:f.name,title:f.name,amount:""===f.amount?0:"string"===typeof f.amount?parseFloat(f.amount):f.amount,description:f.description||"Additional rate"});const a=e.occurrences.map(((e,t)=>0===t?{occurrence_id:e.occurrence_id,rates:{base_rate:parseFloat(n.base_rate),additional_animal_rate:parseFloat(n.additional_animal_rate||0),applies_after:parseInt(n.applies_after||1),holiday_rate:parseFloat(n.holiday_rate||0),additional_rates:n.additional_rates.map((e=>({title:e.name||e.title,amount:parseFloat(e.amount),description:e.description||"Additional rate"})))}}:{occurrence_id:e.occurrence_id,rates:{base_rate:parseFloat(e.rates.base_rate),additional_animal_rate:parseFloat(e.rates.additional_animal_rate||0),applies_after:parseInt(e.rates.applies_after||1),holiday_rate:parseFloat(e.rates.holiday_rate||0),additional_rates:(e.rates.additional_rates||[]).map((e=>({title:e.name||e.title,amount:parseFloat(e.amount),description:e.description||""})))}}));(0,g.debugLog)("MBA66777 Sending all occurrences with new rate to API:",a);const r=await(0,Ze.updateBookingDraftRates)(o,a);(0,g.debugLog)("MBA66777 New rate added API response:",r),r.draft_data&&(r.draft_data.occurrences&&r.draft_data.occurrences[0]&&h(r.draft_data.occurrences[0].rates),t&&t(r.draft_data)),c(!1),p({name:"",amount:"",description:""})}catch(n){(0,g.debugLog)("MBA66777 Error adding new rate:",n),j("Failed to add new rate. Please try again.")}finally{b(!1)}},Y=e=>{const t=E(e);h((e=>Object.assign({},e,{base_rate:t})))},G=e=>{const t=E(e);h((e=>Object.assign({},e,{additional_animal_rate:t})))},J=e=>{const t=E(e);h((e=>Object.assign({},e,{holiday_rate:t})))},$=(e,t,o)=>{if(!u?.additional_rates)return;const n=[...u.additional_rates];if("amount"===t){const t=E(o);n[e]=Object.assign({},n[e],{amount:""===t?"":t})}else"name"===t&&(n[e]=Object.assign({},n[e],{name:o}));h((e=>Object.assign({},e,{additional_rates:n})))},Z=async n=>{if(u?.additional_rates)try{b(!0),j(null);const a=Object.assign({},u),r=[...a.additional_rates];r.splice(n,1),a.additional_rates=r;const i=e.occurrences.map(((e,t)=>0===t?{occurrence_id:e.occurrence_id,rates:{base_rate:parseFloat(a.base_rate),additional_animal_rate:parseFloat(a.additional_animal_rate||0),applies_after:parseInt(a.applies_after||1),holiday_rate:parseFloat(a.holiday_rate||0),additional_rates:a.additional_rates.map((e=>({title:e.name||e.title,amount:parseFloat(e.amount),description:e.description||"Additional rate"})))}}:{occurrence_id:e.occurrence_id,rates:{base_rate:parseFloat(e.rates.base_rate),additional_animal_rate:parseFloat(e.rates.additional_animal_rate||0),applies_after:parseInt(e.rates.applies_after||1),holiday_rate:parseFloat(e.rates.holiday_rate||0),additional_rates:(e.rates.additional_rates||[]).map((e=>({title:e.name||e.title,amount:parseFloat(e.amount),description:e.description||""})))}}));(0,g.debugLog)("MBA66777 Sending all occurrences with updated rates to API:",i);const s=await(0,Ze.updateBookingDraftRates)(o,i);(0,g.debugLog)("MBA66777 Rate deleted API response:",s),s.draft_data&&(s.draft_data.occurrences&&s.draft_data.occurrences[0]&&h(s.draft_data.occurrences[0].rates),t&&t(s.draft_data))}catch(a){(0,g.debugLog)("MBA66777 Error deleting rate:",a),j("Failed to delete rate. Please try again.")}finally{b(!1)}},K=t=>{(0,g.debugLog)("MBA66777 Editing occurrence:",t),_(t.occurrence_id),1===e.occurrences.length?((0,g.debugLog)("MBA66777 Setting isEditMode for single occurrence booking"),l(!0),h({base_rate:t.rates.base_rate,additional_animal_rate:t.rates.additional_animal_rate||0,applies_after:t.rates.applies_after||1,holiday_rate:t.rates.holiday_rate||0,additional_rates:t.rates.additional_rates?.map((e=>({name:e.name||e.title,amount:e.amount,description:e.description||""})))||[]})):k(new Set([t.occurrence_id])),M({base_rate:t.rates.base_rate,additional_animal_rate:t.rates.additional_animal_rate||0,applies_after:t.rates.applies_after||1,holiday_rate:t.rates.holiday_rate||0,additional_rates:t.rates.additional_rates?.map((e=>({name:e.name||e.title,amount:e.amount,description:e.description||""})))||[]})},Q=()=>{_(null),M({}),1===e.occurrences.length&&l(!1),c(!1),R(null)},X=(e,t)=>{if("base_rate"===e||"additional_animal_rate"===e||"holiday_rate"===e){const o=E(t);M((t=>Object.assign({},t,{[e]:o})))}else M((o=>Object.assign({},o,{[e]:t})))},ee=(e,t,o)=>{(0,g.debugLog)("MBA66778 Changing additional rate at index ".concat(e,", field ").concat(t," to value: ").concat(o),{currentOccurrenceEdits:I,currentAdditionalRates:I.additional_rates}),M((n=>{const a=[...n.additional_rates||[]];if("amount"===t){const t=E(o);a[e]=Object.assign({},a[e],{amount:""===t?"":t})}else"name"===t&&(a[e]=Object.assign({},a[e],{name:o}));return(0,g.debugLog)("MBA66778 Updated additional rate:",{updatedRate:a[e],allRates:a}),Object.assign({},n,{additional_rates:a})}))},te=async(n,a)=>{try{b(!0),j(null);const r=Object.assign({},I);if(r.additional_rates&&r.additional_rates.length>a){r.additional_rates.splice(a,1),M(r);const i=e.occurrences.map((e=>e.occurrence_id===n.occurrence_id?{occurrence_id:n.occurrence_id,rates:{base_rate:parseFloat(r.base_rate),additional_animal_rate:parseFloat(r.additional_animal_rate||0),applies_after:parseInt(r.applies_after||1),holiday_rate:parseFloat(r.holiday_rate||0),additional_rates:r.additional_rates.map((e=>({title:e.name,amount:parseFloat(e.amount),description:e.description||""})))}}:{occurrence_id:e.occurrence_id,rates:{base_rate:parseFloat(e.rates.base_rate),additional_animal_rate:parseFloat(e.rates.additional_animal_rate||0),applies_after:parseInt(e.rates.applies_after||1),holiday_rate:parseFloat(e.rates.holiday_rate||0),additional_rates:(e.rates.additional_rates||[]).map((e=>({title:e.name||e.title,amount:parseFloat(e.amount),description:e.description||""})))}}));(0,g.debugLog)("MBA54321 - Sending all occurrences with rate deleted to API:",i);const s=await(0,Ze.updateBookingDraftRates)(o,i);(0,g.debugLog)("MBA54321 - Rate deleted from occurrence API response:",s),s.draft_data&&t&&t(s.draft_data)}}catch(r){(0,g.debugLog)("MBA66777 Error deleting rate for occurrence:",r),j("Failed to delete rate. Please try again.")}finally{b(!1)}},oe=(e,t,o)=>{if(A===e.occurrence_id&&I.additional_rates){const e=I.additional_rates[t]?.[o];return"amount"===o&&0===e?"":e||""}if(s&&u?.additional_rates){const e=u.additional_rates[t]?.[o];return"amount"===o&&0===e?"":e||""}const n=(e.rates?.additional_rates||[])[t]||{},a="name"===o?n.name||n.title:n[o];return"amount"===o&&0===a?"":a||""};return(0,T.jsxs)(H.default,{style:fo.container,contentContainerStyle:fo.contentContainer,children:[(()=>{(0,g.debugLog)("MBAio3htg5uohg: Rendering booking breakdown with data:",e?.occurrences?.[0]);const r=e?.occurrences;if(!r||0===r.length)return null;const{timeSettings:i}=(0,n.useContext)(g.AuthContext),h=i?.timezone||"US/Mountain";(0,g.debugLog)("MBAio3htg5uohg: userTimezone: ",h);const y=r.length>1||1===r.length&&(r[0].end_date!==r[0].start_date&&"00:00"===r[0].end_time||r[0].start_date===r[0].end_date);if((0,g.debugLog)("MBAio3htg5uohg: isMultipleDates detection:",{isMultipleDates:y,count:r.length,firstOccurrence:r[0]?{start_date:r[0].start_date,end_date:r[0].end_date,end_time:r[0].end_time}:null}),y)return(0,T.jsxs)(x.default,{style:[fo.section,{marginTop:a?24:0}],children:[(0,T.jsx)(x.default,{style:fo.sectionHeaderContainer,children:(0,T.jsx)(C.default,{style:fo.sectionHeader,children:"Booking Breakdown"})}),(0,T.jsx)(x.default,{style:[fo.card,{paddingTop:16}],children:r.map(((n,r)=>{const i=n.unit_of_time||n.rates&&n.rates.unit_of_time||"Per Visit",d=parseFloat(n.multiple)||1;return(0,g.debugLog)("MBAio3htg5uohg: Processing occurrence in UI:",{id:n.occurrence_id,unit_of_time:i,multiple:d,calculated_cost:n.calculated_cost}),(0,T.jsxs)(x.default,{style:fo.multipleDatesContainer,children:[(0,T.jsxs)(x.default,{style:fo.dateHeader,children:[(0,T.jsx)(x.default,{style:fo.dateTextContainer,children:(0,T.jsx)(C.default,{style:fo.dateText,children:(0,mo.formatDateTimeRangeFromUTC)({startDate:n.start_date,startTime:n.start_time,endDate:n.end_date,endTime:n.end_time,userTimezone:h,includeTimes:!0,includeTimezone:!0})})}),(0,T.jsx)(C.default,{style:fo.occurrenceCost,children:F(n.calculated_cost)}),A===n.occurrence_id?(0,T.jsx)(v.default,{onPress:Q,children:(0,T.jsx)(S.default,{name:"close",size:20,color:m.theme.colors.error})}):a&&(0,T.jsx)(v.default,{onPress:()=>K(n),children:(0,T.jsx)(S.default,{name:"pencil",size:20,color:m.theme.colors.mainColors.main})})]}),(0,T.jsxs)(v.default,{style:fo.ratesToggleButton,onPress:()=>{const e=new Set(B);e.has(n.occurrence_id)?e.delete(n.occurrence_id):e.add(n.occurrence_id),k(e)},children:[(0,T.jsx)(C.default,{style:fo.ratesToggleText,children:B.has(n.occurrence_id)?"Hide Rates":"Show Rates"}),(0,T.jsx)(S.default,{name:B.has(n.occurrence_id)?"chevron-up":"chevron-down",size:20,color:m.theme.colors.mainColors.main})]}),B.has(n.occurrence_id)&&(0,T.jsxs)(x.default,{style:fo.ratesBreakdown,children:[(0,T.jsxs)(x.default,{style:fo.rateItem,children:[A===n.occurrence_id?(0,T.jsxs)(x.default,{style:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",width:"100%"},children:[(0,T.jsxs)(C.default,{style:fo.rateLabel,children:["Base Rate (",i,")"]}),(0,T.jsx)(q.default,{style:{width:80,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:4,padding:8},keyboardType:"decimal-pad",value:I.base_rate?.toString()||"",onChangeText:e=>X("base_rate",e)})]}):(0,T.jsxs)(x.default,{children:[(0,T.jsx)(C.default,{style:fo.rateLabel,children:"Base Rate"}),(0,T.jsxs)(C.default,{style:fo.breakdownCalculation,children:[F(n.rates.base_rate)," (",i,") \xd7 ",d," = ",F(n.base_total)]})]}),A===n.occurrence_id?null:(0,T.jsx)(C.default,{style:fo.rateAmount,children:F(n.base_total)})]}),n.rates?.additional_animal_rate&&parseFloat(n.rates.additional_animal_rate)>0&&n.rates?.applies_after&&n.rates.applies_after<(e.pets?.length||0)&&(0,T.jsxs)(x.default,{style:fo.rateItem,children:[A===n.occurrence_id?(0,T.jsxs)(x.default,{style:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",width:"100%"},children:[(0,T.jsxs)(C.default,{style:fo.rateLabel,children:["Additional Pet Rate (after ",n.rates.applies_after," ",1!==n.rates.applies_after?"pets":"pet",")"]}),(0,T.jsx)(q.default,{style:{width:80,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:4,padding:8},keyboardType:"decimal-pad",value:I.additional_animal_rate?.toString()||"",onChangeText:e=>X("additional_animal_rate",e)})]}):(0,T.jsxs)(C.default,{style:fo.rateLabel,children:["Additional Pet Rate (after ",n.rates.applies_after," ",1!==n.rates.applies_after?"pets":"pet",")"]}),A===n.occurrence_id?null:(0,T.jsx)(C.default,{style:fo.rateAmount,children:F(n.rates.additional_animal_rate)})]}),n.rates?.holiday_rate&&parseFloat(n.rates.holiday_rate)>0&&(n.rates?.holiday_days>0||!("holiday_days"in n.rates))&&(0,T.jsxs)(x.default,{style:fo.rateItem,children:[A===n.occurrence_id?(0,T.jsxs)(x.default,{style:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",width:"100%"},children:[(0,T.jsx)(C.default,{style:fo.rateLabel,children:"Holiday Rate"}),(0,T.jsx)(q.default,{style:{width:80,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:4,padding:8},keyboardType:"decimal-pad",value:I.holiday_rate?.toString()||"",onChangeText:e=>X("holiday_rate",e)})]}):(0,T.jsx)(C.default,{style:fo.rateLabel,children:"Holiday Rate"}),A===n.occurrence_id?null:(0,T.jsx)(C.default,{style:fo.rateAmount,children:F(n.rates.holiday_rate)})]}),((s?u?.additional_rates:n.rates?.additional_rates)||[]).length>0?((s?u?.additional_rates:n.rates?.additional_rates)||[]).map(((e,t)=>(0,T.jsxs)(x.default,{style:fo.breakdownItem,children:[(0,T.jsx)(x.default,{style:fo.breakdownLabelContainer,children:s||A===n.occurrence_id?P<600?(0,T.jsxs)(x.default,{style:{width:"100%"},children:[(0,T.jsxs)(x.default,{style:{flexDirection:"row",alignItems:"center",justifyContent:"space-between"},children:[(0,g.debugLog)("MBA66778 Rendering rate at index ".concat(t,":"),{isEditMode:s,editingOccurrenceId:A,occurrenceId:n.occurrence_id,rateName:e.name||e.title,rateAmount:e.amount,occurrenceEditsRate:I.additional_rates?.[t],valueToShow:A===n.occurrence_id?I.additional_rates&&I.additional_rates[t]?.amount?.toString()||"0":e.amount?.toString()||"0"}),(0,T.jsx)(q.default,{style:[fo.nameInput,{flex:1,marginRight:8}],value:oe(n,t,"name"),onChangeText:e=>A===n.occurrence_id?ee(t,"name",e):$(t,"name",e),placeholder:"Rate Name"}),(0,T.jsx)(v.default,{style:fo.deleteButton,onPress:()=>A===n.occurrence_id?te(n,t):Z(t),children:(0,T.jsx)(S.default,{name:"trash-can-outline",size:22,color:m.theme.colors.error})})]}),(0,T.jsx)(x.default,{style:{marginTop:8},children:(0,T.jsxs)(x.default,{style:{flexDirection:"row",alignItems:"center"},children:[(0,T.jsx)(C.default,{style:{marginRight:8},children:"Amount: $"}),(0,T.jsx)(q.default,{style:{width:80,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:4,padding:8},keyboardType:"decimal-pad",value:""===oe(n,t,"amount")?"":oe(n,t,"amount").toString(),onChangeText:e=>A===n.occurrence_id?ee(t,"amount",e):$(t,"amount",e)})]})})]}):(0,T.jsxs)(x.default,{style:fo.editableAdditionalRateRow,children:[(0,T.jsxs)(x.default,{style:fo.rateNameAmountRowWithDelete,children:[(0,T.jsx)(q.default,{style:fo.nameInput,value:oe(n,t,"name"),onChangeText:e=>A===n.occurrence_id?ee(t,"name",e):$(t,"name",e),placeholder:"Rate Name"}),(0,T.jsxs)(x.default,{style:fo.amountInputContainer,children:[(0,T.jsx)(C.default,{style:fo.currencySymbol,children:"$"}),(0,T.jsx)(q.default,{style:fo.rateInput,keyboardType:"decimal-pad",value:""===oe(n,t,"amount")?"":oe(n,t,"amount").toString(),onChangeText:e=>A===n.occurrence_id?ee(t,"amount",e):$(t,"amount",e)})]})]}),(0,T.jsx)(v.default,{style:fo.deleteButton,onPress:()=>A===n.occurrence_id?te(n,t):Z(t),children:(0,T.jsx)(S.default,{name:"trash-can-outline",size:22,color:m.theme.colors.error})})]}):(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(C.default,{style:fo.breakdownLabel,children:e.name||e.title}),(0,T.jsx)(C.default,{style:fo.breakdownCalculation,children:e.description||"Additional Rate"})]})}),!s&&A!==n.occurrence_id&&(0,T.jsxs)(C.default,{style:fo.breakdownAmount,children:["+",F(e.amount)]})]},t))):null]}),D===n.occurrence_id&&(0,T.jsxs)(x.default,{children:[(0,T.jsxs)(x.default,{style:fo.addRateContainer,children:[(0,T.jsx)(x.default,{style:fo.formDivider}),P<600?(0,T.jsxs)(x.default,{children:[(0,T.jsx)(q.default,{style:[fo.nameInput,{marginRight:0,marginBottom:12}],value:L.name,onChangeText:e=>z((t=>Object.assign({},t,{name:e}))),placeholder:"Rate Name",placeholderTextColor:m.theme.colors.placeHolderText}),(0,T.jsxs)(x.default,{style:[fo.amountInputContainer,{marginBottom:12}],children:[(0,T.jsx)(C.default,{style:fo.currencySymbol,children:"$"}),(0,T.jsx)(q.default,{style:fo.rateInput,keyboardType:"decimal-pad",value:L.amount,onChangeText:N,placeholder:"0.00",placeholderTextColor:m.theme.colors.placeHolderText})]}),(0,T.jsx)(q.default,{style:fo.descriptionInput,value:L.description,onChangeText:e=>z((t=>Object.assign({},t,{description:e}))),placeholder:"Description (optional)",placeholderTextColor:m.theme.colors.placeHolderText})]}):(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)(x.default,{style:fo.rateNameAmountRow,children:[(0,T.jsx)(q.default,{style:fo.nameInput,value:L.name,onChangeText:e=>z((t=>Object.assign({},t,{name:e}))),placeholder:"Rate Name",placeholderTextColor:m.theme.colors.placeHolderText}),(0,T.jsxs)(x.default,{style:fo.amountInputContainer,children:[(0,T.jsx)(C.default,{style:fo.currencySymbol,children:"$"}),(0,T.jsx)(q.default,{style:fo.rateInput,keyboardType:"decimal-pad",value:L.amount,onChangeText:N,placeholder:"0.00",placeholderTextColor:m.theme.colors.placeHolderText})]})]}),(0,T.jsx)(q.default,{style:fo.descriptionInput,value:L.description,onChangeText:e=>z((t=>Object.assign({},t,{description:e}))),placeholder:"Description (optional)",placeholderTextColor:m.theme.colors.placeHolderText})]}),(0,T.jsx)(x.default,{style:fo.formDivider})]}),(0,T.jsxs)(x.default,{style:fo.buttonsContainer,children:[(0,T.jsx)(v.default,{style:fo.cancelButton,onPress:()=>R(null),children:(0,T.jsx)(C.default,{style:fo.cancelButtonText,children:"Cancel"})}),(0,T.jsx)(v.default,{style:fo.saveButton,onPress:()=>(async n=>{if(L.name&&(L.amount||""===L.amount))try{b(!0),j(null);const a=Object.assign({},I);a.additional_rates||(a.additional_rates=[]),a.additional_rates.push({name:L.name,title:L.name,amount:""===L.amount?0:"string"===typeof L.amount?parseFloat(L.amount):L.amount,description:L.description||"Additional rate"}),M(a);const r=e.occurrences.map((e=>e.occurrence_id===n.occurrence_id?{occurrence_id:n.occurrence_id,rates:{base_rate:parseFloat(a.base_rate),additional_animal_rate:parseFloat(a.additional_animal_rate||0),applies_after:parseInt(a.applies_after||1),holiday_rate:parseFloat(a.holiday_rate||0),additional_rates:a.additional_rates.map((e=>({title:e.name,amount:parseFloat(e.amount),description:e.description||""})))}}:{occurrence_id:e.occurrence_id,rates:{base_rate:parseFloat(e.rates.base_rate),additional_animal_rate:parseFloat(e.rates.additional_animal_rate||0),applies_after:parseInt(e.rates.applies_after||1),holiday_rate:parseFloat(e.rates.holiday_rate||0),additional_rates:(e.rates.additional_rates||[]).map((e=>({title:e.name||e.title,amount:parseFloat(e.amount),description:e.description||""})))}}));(0,g.debugLog)("MBA54321 - Sending all occurrences with new rate to API:",r);const i=await(0,Ze.updateBookingDraftRates)(o,r);(0,g.debugLog)("MBA54321 - New rate added to occurrence API response:",i),i.draft_data&&t&&t(i.draft_data),R(null),z({name:"",amount:"",description:""})}catch(a){(0,g.debugLog)("MBA66777 Error adding new rate for occurrence:",a),j("Failed to add new rate. Please try again.")}finally{b(!1)}})(n),children:(0,T.jsx)(C.default,{style:fo.saveButtonText,children:"Save New Rate"})})]})]}),A===n.occurrence_id&&!D&&(0,T.jsxs)(x.default,{style:fo.buttonsContainer,children:[(0,T.jsx)(v.default,{style:fo.cancelButton,onPress:()=>{return e=n.occurrence_id,R(D===e?null:e),void z({name:"",amount:"",description:""});var e},children:(0,T.jsx)(C.default,{style:fo.cancelButtonText,children:"+ Add Rate"})}),(0,T.jsx)(v.default,{style:fo.saveButton,onPress:()=>(async n=>{try{b(!0),j(null);const a=Object.assign({},I,{additional_rates:(I.additional_rates||[]).map((e=>({title:e.name||e.title,amount:""===e.amount?0:"string"===typeof e.amount?parseFloat(e.amount):e.amount,description:e.description||""})))}),r=e.occurrences.map((e=>e.occurrence_id===n.occurrence_id?{occurrence_id:n.occurrence_id,rates:{base_rate:""===I.base_rate?0:"string"===typeof I.base_rate?parseFloat(I.base_rate):I.base_rate,additional_animal_rate:""===I.additional_animal_rate?0:"string"===typeof I.additional_animal_rate?parseFloat(I.additional_animal_rate):I.additional_animal_rate||0,applies_after:parseInt(I.applies_after||1),holiday_rate:""===I.holiday_rate?0:"string"===typeof I.holiday_rate?parseFloat(I.holiday_rate):I.holiday_rate||0,additional_rates:a.additional_rates}}:{occurrence_id:e.occurrence_id,rates:{base_rate:parseFloat(e.rates.base_rate),additional_animal_rate:parseFloat(e.rates.additional_animal_rate||0),applies_after:parseInt(e.rates.applies_after||1),holiday_rate:parseFloat(e.rates.holiday_rate||0),additional_rates:(e.rates.additional_rates||[]).map((e=>({title:e.name||e.title,amount:parseFloat(e.amount),description:e.description||""})))}}));(0,g.debugLog)("MBA54321 - Sending all occurrences to API:",r);const i=await(0,Ze.updateBookingDraftRates)(o,r);i.draft_data&&(t&&t(i.draft_data),_(null),M({}),1===e.occurrences.length&&l(!1),k(new Set),c(!1),R(null))}catch(a){(0,g.debugLog)("MBA54321 - Error saving occurrence rates:",a),j("Failed to update rates. Please try again.")}finally{b(!1)}})(n),children:(0,T.jsx)(C.default,{style:fo.saveButtonText,children:"Save Changes"})})]})]},n.occurrence_id)}))})]});const w=r[0];if(!w)return null;const E=(0,mo.formatDateTimeRangeFromUTC)({startDate:w.start_date,startTime:w.start_time,endDate:w.end_date,endTime:w.end_time,userTimezone:h,includeTimes:!0,includeTimezone:!0});return(0,g.debugLog)("MBA54321 Formatted date range:",E),w.rates||((0,g.debugLog)("MBA54321 occurrence.rates is undefined, initializing with defaults"),w.rates={base_rate:0,additional_animal_rate:0,applies_after:1,holiday_rate:0,holiday_days:0,additional_rates:[]}),(0,T.jsxs)(x.default,{style:[fo.section,{marginTop:a?24:0}],children:[(0,T.jsx)(x.default,{style:fo.sectionHeaderContainer,children:(0,T.jsx)(C.default,{style:fo.sectionHeader,children:"Booking Breakdown"})}),(0,T.jsx)(x.default,{style:[fo.card,{paddingTop:16}],children:(0,T.jsxs)(x.default,{style:fo.breakdownSection,children:[(0,T.jsxs)(x.default,{style:fo.dateHeader,children:[(0,T.jsx)(x.default,{style:fo.dateTextContainer,children:(0,T.jsx)(C.default,{style:fo.dateText,children:(0,mo.formatDateTimeRangeFromUTC)({startDate:w.start_date,startTime:w.start_time,endDate:w.end_date,endTime:w.end_time,userTimezone:h,includeTimes:!0,includeTimezone:!0})})}),(0,T.jsx)(C.default,{style:fo.occurrenceCost,children:F(w.calculated_cost)}),A===w.occurrence_id?(0,T.jsx)(v.default,{onPress:Q,children:(0,T.jsx)(S.default,{name:"close",size:20,color:m.theme.colors.error})}):a&&(0,T.jsx)(v.default,{onPress:()=>K(w),children:(0,T.jsx)(S.default,{name:"pencil",size:20,color:m.theme.colors.mainColors.main})})]}),(0,T.jsxs)(x.default,{style:fo.breakdownItem,children:[(0,T.jsxs)(x.default,{style:fo.breakdownLabelContainer,children:[(0,T.jsxs)(x.default,{style:fo.rateNameAmountRow,children:[(0,T.jsxs)(C.default,{style:fo.breakdownLabel,children:["Base Rate (",w.unit_of_time||w.rates&&w.rates.unit_of_time||"Per Visit",")"]}),s||A===w.occurrence_id?(0,T.jsxs)(x.default,{style:fo.amountInputContainer,children:[(0,T.jsx)(C.default,{style:fo.currencySymbol,children:"$"}),(0,T.jsx)(q.default,{style:fo.rateInput,keyboardType:"decimal-pad",value:A===w.occurrence_id?I.base_rate?.toString()||"0":u?.base_rate?.toString()||"0",onChangeText:A===w.occurrence_id?e=>X("base_rate",e):Y})]}):null]}),!s&&A!==w.occurrence_id&&(0,T.jsxs)(C.default,{style:fo.breakdownCalculation,children:[w.multiple||1," \xd7 ",F(w.rates?.base_rate||0)," = ",F(w.base_total||w.rates?.base_rate||0)]})]}),!s&&A!==w.occurrence_id&&(0,T.jsx)(C.default,{style:fo.breakdownAmount,children:F(w.base_total||w.rates?.base_rate||0)})]}),w.rates?.additional_animal_rate&&w.rates?.applies_after&&w.rates.applies_after<(e.pets?.length||0)?(0,T.jsxs)(x.default,{style:fo.breakdownItem,children:[(0,T.jsxs)(x.default,{style:fo.breakdownLabelContainer,children:[(0,T.jsxs)(x.default,{style:fo.rateNameAmountRow,children:[(0,T.jsxs)(C.default,{style:fo.breakdownLabel,children:["Additional Pet Rate (after ",w.rates?.applies_after||1," ",1!==w.rates?.applies_after?"pets":"pet",")"]}),s||A===w.occurrence_id?(0,T.jsxs)(x.default,{style:fo.amountInputContainer,children:[(0,T.jsx)(C.default,{style:fo.currencySymbol,children:"$"}),(0,T.jsx)(q.default,{style:fo.rateInput,keyboardType:"decimal-pad",value:A===w.occurrence_id?I.additional_animal_rate?.toString()||"0":u?.additional_animal_rate?.toString()||"0",onChangeText:A===w.occurrence_id?e=>X("additional_animal_rate",e):G}),(0,T.jsxs)(C.default,{style:fo.inputLabel,children:[" / pet / ",w.unit_of_time||w.rates&&w.rates.unit_of_time||"Per Visit"]})]}):null]}),!s&&A!==w.occurrence_id&&(0,T.jsxs)(C.default,{style:fo.breakdownCalculation,children:["$",w.rates?.additional_animal_rate||0," / pet / ",w.unit_of_time||w.rates&&w.rates.unit_of_time||"Per Visit"]})]}),!s&&A!==w.occurrence_id&&(0,T.jsxs)(C.default,{style:fo.breakdownAmount,children:[w.rates?.applies_after&&w.rates.applies_after<(e.pets?.length||0)?"+":"",w.rates?.applies_after&&w.rates.applies_after<(e.pets?.length||0)?F(w.rates?.additional_animal_rate_total||w.rates?.additional_animal_rate||0):"NA"]})]}):null,w.rates?.holiday_rate&&w.rates?.holiday_days&&w.rates.holiday_days>0?(0,T.jsxs)(x.default,{style:[fo.breakdownItem,{borderBottomWidth:w.rates?.additional_rates?.length>0||d?1:0}],children:[(0,T.jsxs)(x.default,{style:fo.breakdownLabelContainer,children:[(0,T.jsxs)(x.default,{style:fo.rateNameAmountRow,children:[(0,T.jsx)(C.default,{style:fo.breakdownLabel,children:"Holiday Rate"}),s||A===w.occurrence_id?(0,T.jsxs)(x.default,{style:fo.amountInputContainer,children:[(0,T.jsx)(C.default,{style:fo.currencySymbol,children:"$"}),(0,T.jsx)(q.default,{style:fo.rateInput,keyboardType:"decimal-pad",value:A===w.occurrence_id?I.holiday_rate?.toString()||"0":u?.holiday_rate?.toString()||"0",onChangeText:A===w.occurrence_id?e=>X("holiday_rate",e):J}),(0,T.jsxs)(C.default,{style:fo.inputLabel,children:[" \xd7 ",w.rates?.holiday_days||0," ",1!==w.rates?.holiday_days?"holidays":"holiday"]})]}):null]}),!s&&A!==w.occurrence_id&&(0,T.jsxs)(C.default,{style:fo.breakdownCalculation,children:[F(w.rates?.holiday_rate||0)," \xd7 ",w.rates?.holiday_days||0," ",1!==w.rates?.holiday_days?"holidays":"holiday"]})]}),!s&&A!==w.occurrence_id&&(0,T.jsxs)(C.default,{style:fo.breakdownAmount,children:[w.rates?.holiday_days?"+":"",w.rates?.holiday_days?F(w.rates?.holiday_rate_total||w.rates?.holiday_rate||0):"NA"]})]}):null,((s?u?.additional_rates:w.rates?.additional_rates)||[]).length>0?((s?u?.additional_rates:w.rates?.additional_rates)||[]).map(((e,t)=>(0,T.jsxs)(x.default,{style:fo.breakdownItem,children:[(0,T.jsx)(x.default,{style:fo.breakdownLabelContainer,children:s||A===w.occurrence_id?P<600?(0,T.jsxs)(x.default,{style:{width:"100%"},children:[(0,T.jsxs)(x.default,{style:{flexDirection:"row",alignItems:"center",justifyContent:"space-between"},children:[(0,g.debugLog)("MBA66778 Rendering rate at index ".concat(t,":"),{isEditMode:s,editingOccurrenceId:A,occurrenceId:w.occurrence_id,rateName:e.name||e.title,rateAmount:e.amount,occurrenceEditsRate:I.additional_rates?.[t],valueToShow:A===w.occurrence_id?I.additional_rates&&I.additional_rates[t]?.amount?.toString()||"0":e.amount?.toString()||"0"}),(0,T.jsx)(q.default,{style:[fo.nameInput,{flex:1,marginRight:8}],value:oe(w,t,"name"),onChangeText:e=>A===w.occurrence_id?ee(t,"name",e):$(t,"name",e),placeholder:"Rate Name"}),(0,T.jsx)(v.default,{style:fo.deleteButton,onPress:()=>A===w.occurrence_id?te(w,t):Z(t),children:(0,T.jsx)(S.default,{name:"trash-can-outline",size:22,color:m.theme.colors.error})})]}),(0,T.jsx)(x.default,{style:{marginTop:8},children:(0,T.jsxs)(x.default,{style:{flexDirection:"row",alignItems:"center"},children:[(0,T.jsx)(C.default,{style:{marginRight:8},children:"Amount: $"}),(0,T.jsx)(q.default,{style:{width:80,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:4,padding:8},keyboardType:"decimal-pad",value:""===oe(w,t,"amount")?"":oe(w,t,"amount").toString(),onChangeText:e=>A===w.occurrence_id?ee(t,"amount",e):$(t,"amount",e)})]})})]}):(0,T.jsxs)(x.default,{style:fo.editableAdditionalRateRow,children:[(0,T.jsxs)(x.default,{style:fo.rateNameAmountRowWithDelete,children:[(0,T.jsx)(q.default,{style:fo.nameInput,value:oe(w,t,"name"),onChangeText:e=>A===w.occurrence_id?ee(t,"name",e):$(t,"name",e),placeholder:"Rate Name"}),(0,T.jsxs)(x.default,{style:fo.amountInputContainer,children:[(0,T.jsx)(C.default,{style:fo.currencySymbol,children:"$"}),(0,T.jsx)(q.default,{style:fo.rateInput,keyboardType:"decimal-pad",value:""===oe(w,t,"amount")?"":oe(w,t,"amount").toString(),onChangeText:e=>A===w.occurrence_id?ee(t,"amount",e):$(t,"amount",e)})]})]}),(0,T.jsx)(v.default,{style:fo.deleteButton,onPress:()=>A===w.occurrence_id?te(w,t):Z(t),children:(0,T.jsx)(S.default,{name:"trash-can-outline",size:22,color:m.theme.colors.error})})]}):(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(C.default,{style:fo.breakdownLabel,children:e.name||e.title}),(0,T.jsx)(C.default,{style:fo.breakdownCalculation,children:e.description||"Additional Rate"})]})}),!s&&A!==w.occurrence_id&&(0,T.jsxs)(C.default,{style:fo.breakdownAmount,children:["+",F(e.amount)]})]},t))):null,d?(0,T.jsxs)(x.default,{children:[(0,T.jsxs)(x.default,{style:fo.addRateContainer,children:[(0,T.jsx)(x.default,{style:fo.formDivider}),P<600?(0,T.jsxs)(x.default,{children:[(0,T.jsx)(q.default,{style:[fo.nameInput,{marginRight:0,marginBottom:12}],value:f.name,onChangeText:e=>p((t=>Object.assign({},t,{name:e}))),placeholder:"Rate Name",placeholderTextColor:m.theme.colors.placeHolderText}),(0,T.jsxs)(x.default,{style:[fo.amountInputContainer,{marginBottom:12}],children:[(0,T.jsx)(C.default,{style:fo.currencySymbol,children:"$"}),(0,T.jsx)(q.default,{style:fo.rateInput,keyboardType:"decimal-pad",value:f.amount,onChangeText:W,placeholder:"0.00",placeholderTextColor:m.theme.colors.placeHolderText})]}),(0,T.jsx)(q.default,{style:fo.descriptionInput,value:f.description,onChangeText:e=>p((t=>Object.assign({},t,{description:e}))),placeholder:"Description (optional)",placeholderTextColor:m.theme.colors.placeHolderText})]}):(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)(x.default,{style:fo.rateNameAmountRow,children:[(0,T.jsx)(q.default,{style:fo.nameInput,value:f.name,onChangeText:e=>p((t=>Object.assign({},t,{name:e}))),placeholder:"Rate Name",placeholderTextColor:m.theme.colors.placeHolderText}),(0,T.jsxs)(x.default,{style:fo.amountInputContainer,children:[(0,T.jsx)(C.default,{style:fo.currencySymbol,children:"$"}),(0,T.jsx)(q.default,{style:fo.rateInput,keyboardType:"decimal-pad",value:f.amount,onChangeText:W,placeholder:"0.00",placeholderTextColor:m.theme.colors.placeHolderText})]})]}),(0,T.jsx)(q.default,{style:fo.descriptionInput,value:f.description,onChangeText:e=>p((t=>Object.assign({},t,{description:e}))),placeholder:"Description (optional)",placeholderTextColor:m.theme.colors.placeHolderText})]}),(0,T.jsx)(x.default,{style:fo.formDivider})]}),(0,T.jsxs)(x.default,{style:fo.buttonsContainer,children:[(0,T.jsx)(v.default,{style:fo.cancelButton,onPress:O,children:(0,T.jsx)(C.default,{style:fo.cancelButtonText,children:"Cancel"})}),(0,T.jsx)(v.default,{style:fo.saveButton,onPress:V,children:(0,T.jsx)(C.default,{style:fo.saveButtonText,children:"Save New Rate"})})]})]}):null,s&&!d&&(0,T.jsxs)(x.default,{style:fo.buttonsContainer,children:[(0,T.jsx)(v.default,{style:fo.cancelButton,onPress:O,children:(0,T.jsx)(C.default,{style:fo.cancelButtonText,children:"+ Add Rate"})}),(0,T.jsx)(v.default,{style:fo.saveButton,onPress:U,children:(0,T.jsx)(C.default,{style:fo.saveButtonText,children:"Save Changes"})})]})]})})]})})(),(()=>{(0,g.debugLog)("MBA54321 Rendering total amount with data:",e?.cost_summary);const t=e?.cost_summary||{subtotal:0,client_platform_fee:0,pro_platform_fee:0,taxes:0,tax_state:"",total_client_cost:0,total_sitter_payout:0,pro_subscription_plan:0};return(0,T.jsxs)(x.default,{style:fo.section,children:[(0,T.jsx)(C.default,{style:fo.sectionHeader,children:"Cost Summary"}),(0,T.jsxs)(x.default,{style:[fo.card,{paddingTop:16}],children:[(0,T.jsxs)(x.default,{style:fo.subtotalRow,children:[(0,T.jsx)(C.default,{style:fo.subtotalLabel,children:"Subtotal"}),(0,T.jsx)(C.default,{style:fo.subtotalAmount,children:F(t.subtotal)})]}),(0,T.jsxs)(x.default,{style:fo.feeRow,children:[(0,T.jsx)(C.default,{style:fo.feeLabel,children:"Service Fee"}),(0,T.jsx)(C.default,{style:fo.feeAmount,children:F(t.client_platform_fee)})]}),(0,T.jsxs)(x.default,{style:fo.feeRow,children:[(0,T.jsxs)(C.default,{style:fo.feeLabel,children:[t.tax_state,t.tax_state?" - ":"","Taxes"]}),(0,T.jsx)(C.default,{style:fo.feeAmount,children:F(t.taxes)})]}),(0,T.jsxs)(x.default,{style:[fo.totalAmountContainer,{paddingBottom:r?16:0,marginBottom:r?16:0}],children:[(0,T.jsx)(C.default,{style:fo.totalLabel,children:"Total Owner Cost"}),(0,T.jsx)(C.default,{style:fo.totalAmount,children:F(t.total_client_cost)})]}),r?(0,T.jsx)(x.default,{style:fo.divider}):null,r?(0,T.jsxs)(x.default,{style:fo.payoutContainer,children:[(0,T.jsx)(C.default,{style:fo.payoutLabel,children:"Professional Payout"}),(0,T.jsx)(C.default,{style:fo.payoutAmount,children:F(t.total_sitter_payout)}),(0,T.jsxs)(C.default,{style:fo.payoutBreakdown,children:["(Subtotal ",F(t.subtotal)," - Service Fee ",F(t.pro_platform_fee),")"]}),0===t.pro_platform_fee?(0,T.jsxs)(C.default,{style:fo.badge,children:[0===t.pro_subscription_plan?"Free Tier - ":1===t.pro_subscription_plan?"Waitlist Tier - ":2===t.pro_subscription_plan?"Commission Tier - ":3===t.pro_subscription_plan||4===t.pro_subscription_plan?"Pro Subscription - ":5===t.pro_subscription_plan?"Client Subscription - ":""," Saved ",F(.15*t.subtotal)]}):null]}):null]})]})})()]})},yo=r.default.create({safeArea:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center"},container:{flex:1,backgroundColor:m.theme.colors.background,margin:"web"===a.default.OS?0:24,borderRadius:12,overflow:"hidden"},desktopContainer:{maxWidth:800,maxHeight:"90%",alignSelf:"center",marginTop:"5%"},header:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:16,borderBottomWidth:1,borderBottomColor:m.theme.colors.border,backgroundColor:m.theme.colors.surface},title:{fontSize:20,fontWeight:"bold",color:m.theme.colors.text,fontFamily:m.theme.fonts.header.fontFamily},closeButton:{padding:8},scrollContainer:{flex:1},scrollContent:{padding:16,paddingBottom:32},footerContainer:{flexDirection:"row",justifyContent:"space-between",padding:16,borderTopWidth:1,borderTopColor:m.theme.colors.border,backgroundColor:m.theme.colors.surface},button:{paddingVertical:12,paddingHorizontal:16,borderRadius:8,borderWidth:1,borderColor:m.theme.colors.primary,alignItems:"center",justifyContent:"center",flex:1,marginRight:8},buttonText:{color:m.theme.colors.primary,fontSize:16,fontWeight:"600",fontFamily:m.theme.fonts.regular.fontFamily},approveButton:{paddingVertical:12,paddingHorizontal:16,borderRadius:8,backgroundColor:m.theme.colors.primary,alignItems:"center",justifyContent:"center",flex:1,marginLeft:8},approveText:{color:"white",fontSize:16,fontWeight:"600",fontFamily:m.theme.fonts.regular.fontFamily},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:24},loadingText:{marginTop:16,fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},errorContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:24},errorText:{marginTop:16,fontSize:16,color:m.theme.colors.error,textAlign:"center",fontFamily:m.theme.fonts.regular.fontFamily},retryButton:{marginTop:16,paddingVertical:8,paddingHorizontal:16,backgroundColor:m.theme.colors.primary,borderRadius:8},retryButtonText:{color:"white",fontSize:16,fontFamily:m.theme.fonts.regular.fontFamily},emptyContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:24},emptyText:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},section:{marginTop:24,marginHorizontal:16},sectionHeader:{fontSize:20,marginBottom:8,color:m.theme.colors.text,fontFamily:m.theme.fonts.header.fontFamily},card:{backgroundColor:m.theme.colors.surfaceContrast,borderRadius:8,padding:16,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3},serviceContainer:{flexDirection:"row",marginBottom:16,alignItems:"center",paddingBottom:16},serviceDivider:{height:1,backgroundColor:m.theme.colors.border,marginBottom:16,width:"100%"},serviceLabel:{fontSize:16,fontWeight:"600",color:m.theme.colors.text,width:80,fontFamily:m.theme.fonts.regular.fontFamily},serviceValue:{fontSize:16,color:m.theme.colors.text,flex:1,fontFamily:m.theme.fonts.regular.fontFamily},petsContainer:{flexDirection:"row",alignItems:"flex-start"},petsLabel:{fontSize:16,fontWeight:"600",color:m.theme.colors.text,width:80,fontFamily:m.theme.fonts.regular.fontFamily},petsList:{flex:1},petItem:{marginBottom:8},petName:{fontSize:16,fontWeight:"500",color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},petType:{fontSize:14,color:m.theme.colors.placeHolderText,fontFamily:m.theme.fonts.regular.fontFamily},noPets:{fontSize:16,color:m.theme.colors.placeHolderText,fontStyle:"italic",fontFamily:m.theme.fonts.regular.fontFamily},changeRequestContainer:{padding:16},changeRequestInput:{backgroundColor:m.theme.colors.background,borderColor:m.theme.colors.border,borderWidth:1,borderRadius:8,padding:12,fontSize:16,color:m.theme.colors.text,minHeight:120,textAlignVertical:"top",fontFamily:m.theme.fonts.regular.fontFamily,marginBottom:16},buttonWrapper:{alignItems:"center",width:"100%"},changeRequestButtons:{flexDirection:"row",width:300,justifyContent:"space-between",alignItems:"center",marginTop:16},cancelRequestButton:{width:140,height:45,alignItems:"center",justifyContent:"center",borderWidth:1,borderColor:m.theme.colors.border||"#E0E0E0",borderRadius:8,backgroundColor:"white"},cancelRequestButtonText:{color:m.theme.colors.text||"#333333",fontSize:16,fontFamily:m.theme.fonts.regular.fontFamily},submitRequestButton:{width:140,height:45,alignItems:"center",justifyContent:"center",backgroundColor:m.theme.colors.olive||"#707855",borderRadius:8},submitRequestButtonText:{color:"white",fontSize:16,fontWeight:"bold",fontFamily:m.theme.fonts.regular.fontFamily},changeButton:{paddingVertical:12,paddingHorizontal:16,borderRadius:8,borderWidth:1,borderColor:m.theme.colors.primary,alignItems:"center",justifyContent:"center",flex:1,marginLeft:8},shortenedContainer:{flex:0,backgroundColor:m.theme.colors.background,margin:"web"===a.default.OS?0:24,borderRadius:12,overflow:"hidden",alignSelf:"center",width:"90%",maxWidth:500,minHeight:320}}),bo=({visible:e,onClose:t,bookingId:o,onApproveSuccess:a,onApproveError:r,onRequestChangesSuccess:i,onRequestChangesError:s,initialData:l=null,isProfessional:d=!0,modalTitle:c="Booking Approval Request",hideButtons:u=!1,isReadOnly:h=!1})=>{const{screenWidth:f}=(0,n.useContext)(g.AuthContext),p=f>768,y=l||{booking_id:o,service_type:"Loading...",pets:[],occurrences:[],cost_summary:{subtotal:0,client_platform_fee:0,pro_platform_fee:0,taxes:0,tax_state:"",total_client_cost:0,total_sitter_payout:0,pro_subscription_plan:0}},[b,w]=(0,n.useState)(y),[j,B]=(0,n.useState)(!1),[k,I]=(0,n.useState)("Loading booking details..."),[M,D]=(0,n.useState)(null),[R,L]=(0,n.useState)(""),[z,P]=(0,n.useState)(!1),F=(0,n.useRef)(y),O=(0,n.useRef)(!1);(0,n.useEffect)((()=>{e&&o&&E()}),[e,o]);(0,n.useEffect)((()=>{l&&!O.current&&((0,g.debugLog)("MBAio3htg5uohg: Updating bookingData from initialData"),w(l),F.current=l)}),[l]),(0,n.useEffect)((()=>{const t=setInterval((()=>{if(e&&O.current){const e=!b||!b.occurrences||0===b.occurrences.length,t=F.current&&F.current.occurrences&&F.current.occurrences.length>0;e&&t&&((0,g.debugLog)("MBAio3htg5uohg: Detected that bookingData was cleared unexpectedly, restoring from cache"),w(Object.assign({},F.current)))}}),1e3);return()=>{clearInterval(t)}}),[e,b]);const E=async()=>{if(o)try{B(!0),D(null),I("Loading booking details..."),(0,g.debugLog)("MBAio3htg5uohg: Fetching booking details for ID:",o);const e=await(0,Ze.getBookingDetails)(o);(0,g.debugLog)("MBAio3htg5uohg: Booking details fetched:",e);const t=Object.assign({},e,{occurrences:e.occurrences||[],pets:e.pets||[],cost_summary:e.cost_summary||{subtotal:0,client_platform_fee:0,pro_platform_fee:0,taxes:0,tax_state:"",total_client_cost:0,total_sitter_payout:0,pro_subscription_plan:0},service_type:e.service_type||"N/A"});0===t.occurrences.length?t.occurrences=[{occurrence_id:"0",start_date:(new Date).toISOString().split("T")[0],end_date:(new Date).toISOString().split("T")[0],start_time:"09:00",end_time:"17:00",unit_of_time:"visit",multiple:1,base_total:0,rates:{base_rate:0,additional_animal_rate:0,applies_after:1,holiday_rate:0,holiday_days:0,additional_rates:[]}}]:t.occurrences=t.occurrences.map((e=>((0,g.debugLog)("MBAio3htg5uohg: Processing occurrence:",{id:e.occurrence_id,unit_of_time:e.unit_of_time,multiple:e.multiple}),Object.assign({},e,{unit_of_time:e.unit_of_time||"visit",multiple:parseFloat(e.multiple)||1,base_total:e.base_total||0,rates:e.rates||{base_rate:0,additional_animal_rate:0,applies_after:1,holiday_rate:0,holiday_days:0,additional_rates:[]}})))),w(t),F.current=t,O.current=!0,(0,g.debugLog)("MBAio3htg5uohg: Booking data processed and stored")}catch(e){(0,g.debugLog)("MBAio3htg5uohg: Error fetching booking details:",e),D("Failed to load booking details. Please try again.")}finally{B(!1)}};(0,n.useEffect)((()=>{if(O.current){const e=!b||!b.occurrences||0===b.occurrences.length,t=F.current&&F.current.occurrences&&F.current.occurrences.length>0;e&&t&&((0,g.debugLog)("MBAio3htg5uohg: Booking data was cleared unexpectedly, restoring from cache"),w(F.current))}}),[b]);const W=async()=>{try{B(!0),I("Approving booking..."),D(null);const e=await(0,Ze.approveBooking)(o);a&&a(e),t()}catch(e){(0,g.debugLog)("MBA77788 Error approving booking:",e),D("Failed to approve booking. Please try again."),r&&r(e.response?.data?.error||"Failed to approve booking")}finally{B(!1)}},N=()=>{P(!0)},U=()=>{P(!1),L("")},V=async()=>{if(R.trim())try{B(!0),I("Submitting change request..."),D(null);const e=await(0,Ze.requestBookingChanges)(o,R);i&&((0,g.debugLog)("MBA77788 Notifying parent of successful change request submission"),i(e)),t()}catch(e){(0,g.debugLog)("MBA77788 Error requesting booking changes:",e),D("Failed to submit change request. Please try again."),s&&s(e.response?.data?.error||"Failed to submit change request")}finally{B(!1)}else D("Please provide details about your requested changes.")},Y=()=>{P(!1),L(""),t()};return(0,T.jsx)(A.default,{visible:e,transparent:!0,animationType:"slide",onRequestClose:Y,children:(0,T.jsx)(Ie.default,{style:yo.safeArea,children:(0,T.jsxs)(x.default,{style:[yo.container,p?yo.desktopContainer:{},z?yo.shortenedContainer:{}],children:[(0,T.jsxs)(x.default,{style:yo.header,children:[(0,T.jsx)(C.default,{style:yo.title,children:((0,g.debugLog)("MBA4321: Modal title decision factors:",{isReadOnly:h,modalTitle:c,bookingId:o}),h?"Booking Details":c)}),(0,T.jsx)(v.default,{style:yo.closeButton,onPress:Y,children:(0,T.jsx)(S.default,{name:"close",size:24,color:m.theme.colors.text})})]}),z?(0,T.jsxs)(x.default,{style:yo.changeRequestContainer,children:[(0,T.jsx)(q.default,{style:yo.changeRequestInput,placeholder:"Enter details about your requested changes...",value:R,onChangeText:L,multiline:!0,numberOfLines:3,placeholderTextColor:m.theme.colors.placeHolderText}),(0,T.jsx)(x.default,{style:yo.buttonWrapper,children:(0,T.jsxs)(x.default,{style:yo.changeRequestButtons,children:[(0,T.jsx)(v.default,{style:yo.cancelRequestButton,onPress:U,children:(0,T.jsx)(C.default,{style:yo.cancelRequestButtonText,children:"Cancel"})}),(0,T.jsx)(v.default,{style:yo.submitRequestButton,onPress:V,disabled:!R.trim(),children:(0,T.jsx)(C.default,{style:yo.submitRequestButtonText,children:"Request Changes"})})]})})]}):(0,T.jsx)(H.default,{style:yo.scrollContainer,contentContainerStyle:yo.scrollContent,children:j?(0,T.jsxs)(x.default,{style:yo.loadingContainer,children:[(0,T.jsx)(_.default,{size:"large",color:m.theme.colors.primary}),(0,T.jsx)(C.default,{style:yo.loadingText,children:k})]}):M?(0,T.jsxs)(x.default,{style:yo.errorContainer,children:[(0,T.jsx)(S.default,{name:"alert-circle",size:48,color:m.theme.colors.error}),(0,T.jsx)(C.default,{style:yo.errorText,children:M}),(0,T.jsx)(v.default,{style:yo.retryButton,onPress:E,children:(0,T.jsx)(C.default,{style:yo.retryButtonText,children:"Retry"})})]}):b?(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)(x.default,{style:[yo.section,{marginTop:0}],children:[(0,T.jsx)(C.default,{style:yo.sectionHeader,children:"Service & Pets"}),(0,T.jsxs)(x.default,{style:yo.card,children:[(0,T.jsxs)(x.default,{style:yo.serviceContainer,children:[(0,T.jsx)(C.default,{style:yo.serviceLabel,children:"Service:"}),(0,T.jsx)(C.default,{style:yo.serviceValue,children:b.service_details?.service_type||"N/A"})]}),(0,T.jsx)(x.default,{style:yo.serviceDivider}),(0,T.jsxs)(x.default,{style:yo.petsContainer,children:[(0,T.jsx)(C.default,{style:yo.petsLabel,children:"Pets:"}),(0,T.jsx)(x.default,{style:yo.petsList,children:b.pets&&b.pets.length>0?b.pets.map(((e,t)=>{return(0,T.jsxs)(x.default,{style:yo.petItem,children:[(0,T.jsx)(C.default,{style:yo.petName,children:e.name}),(0,T.jsxs)(C.default,{style:yo.petType,children:[(o=e.species,o?o.split(" ").map((e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase())).join(" "):o)," | ",e.breed]})]},t);var o})):(0,T.jsx)(C.default,{style:yo.noPets,children:"No pets selected"})})]})]})]}),b&&(0,T.jsx)(po,{bookingData:b,bookingId:o,onRatesUpdate:e=>w(e),showEditControls:!1,isProfessional:d})]}):(0,T.jsx)(x.default,{style:yo.emptyContainer,children:(0,T.jsx)(C.default,{style:yo.emptyText,children:"No booking data available"})})}),!z&&(()=>{if((0,g.debugLog)("MBA4321: Footer render state:",{hideButtons:u,isReadOnly:h,showChangeRequestInput:z,isProfessional:d,modalTitle:c}),u)return null;if(h)return(0,T.jsx)(x.default,{style:yo.footerContainer,children:(0,T.jsx)(v.default,{style:[yo.button,yo.closeButton],onPress:Y,children:(0,T.jsx)(C.default,{style:yo.buttonText,children:"Close"})})});if(z)return null;if(d)return(0,T.jsx)(x.default,{style:yo.footerContainer,children:(0,T.jsx)(v.default,{style:[yo.button,yo.closeButton],onPress:Y,children:(0,T.jsx)(C.default,{style:yo.buttonText,children:"Close"})})});{const e="Booking Update"===c;return(0,T.jsxs)(x.default,{style:yo.footerContainer,children:[(0,T.jsx)(v.default,{style:[yo.button,yo.closeButton],onPress:Y,children:(0,T.jsx)(C.default,{style:yo.buttonText,children:"Close"})}),(0,T.jsx)(v.default,{style:[yo.button,yo.changeButton],onPress:N,children:(0,T.jsx)(C.default,{style:yo.buttonText,children:"Request Changes"})}),(0,T.jsx)(v.default,{style:[yo.button,yo.approveButton],onPress:W,children:(0,T.jsx)(C.default,{style:yo.approveText,children:e?"Approve Update":"Approve"})})]})}})()]})})})},{width:xo,height:Co}=j.default.get("window"),vo=r.default.create({mainContainer:{flex:1,height:"100vh",backgroundColor:"#f5f5f5",position:"fixed",top:0,right:0,bottom:0,left:0,overflow:"hidden"},scrollView:{flex:1,height:"100%",overflow:"auto"},scrollViewContent:{width:"100%",paddingBottom:40},headerContainer:{padding:24,paddingTop:"android"===a.default.OS?mt.default.currentHeight+24:24,flexDirection:"row",justifyContent:"flex-end",alignItems:"center"},headerRight:{flexDirection:"row",alignItems:"center",gap:16},notificationButton:{position:"relative",padding:8},notificationBadge:{position:"absolute",top:4,right:4,backgroundColor:m.theme.colors.error,borderRadius:10,minWidth:20,height:20,justifyContent:"center",alignItems:"center"},notificationCount:{color:m.theme.colors.whiteText,fontSize:12,fontWeight:"bold"},profileButton:{borderRadius:20,overflow:"hidden"},welcomeSection:{padding:24,paddingTop:0},welcomeContent:{maxWidth:1200,marginHorizontal:"auto",width:"100%"},welcomeCard:{backgroundColor:"transparent",backgroundImage:"linear-gradient(to right, #6B6C53, #86C5D9)",borderRadius:12,padding:24,marginBottom:24},welcomeHeader:{flexDirection:"row",flexWrap:"wrap"},welcomeTextContainer:{flex:1,minWidth:280},statsContainer:{padding:24,paddingTop:0,backgroundColor:"#f5f5f5"},statsGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(140px, 1fr))",gap:24,maxWidth:1200,marginHorizontal:"auto",width:"100%"},statCard:Object.assign({backgroundColor:m.theme.colors.surface,padding:16,borderRadius:12,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3},a.default.select({ios:{activeOpacity:.7},android:{android_ripple:{color:"rgba(0, 0, 0, 0.1)"}}})),statHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:12},statIconContainer:{width:48,height:48,borderRadius:12,justifyContent:"center",alignItems:"center"},bookingsContainer:{padding:24,paddingTop:0,backgroundColor:"#f5f5f5",maxWidth:1200,marginHorizontal:"auto",width:"100%"},bookingItem:{marginBottom:16,backgroundColor:m.theme.colors.surface,borderRadius:8,padding:16,shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.1,shadowRadius:2,elevation:2},bookingContent:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"},bookingInfo:{flexDirection:"row",alignItems:"center",flex:1},bookingDetails:{marginLeft:12},bookingTitle:{fontSize:16,fontWeight:"600",color:m.theme.colors.text,marginBottom:4},bookingTime:{fontSize:14,color:m.theme.colors.textSecondary},bookingStatus:{alignItems:"flex-end"},statusText:{fontSize:14,fontWeight:"500",marginBottom:8},progressBar:{width:100,height:4,backgroundColor:m.theme.colors.border,borderRadius:2,overflow:"hidden"},progress:{height:"100%",backgroundColor:m.theme.colors.primary},timeLeft:{fontSize:12,color:m.theme.colors.textSecondary,marginTop:4},emptyStateContainer:{padding:40,alignItems:"center",backgroundColor:m.theme.colors.surface,borderRadius:8,marginBottom:24},emptyStateTitle:{fontSize:m.theme.fontSizes.large,color:m.theme.colors.text,fontWeight:"600",marginTop:16,marginBottom:8,fontFamily:m.theme.fonts.header.fontFamily},emptyStateText:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.textSecondary,textAlign:"center",fontFamily:m.theme.fonts.regular.fontFamily,marginBottom:24},createServiceButton:{flexDirection:"row",alignItems:"center",backgroundColor:"#6B6C53",paddingVertical:12,paddingHorizontal:20,borderRadius:8,gap:8},createServiceButtonText:{color:m.theme.colors.surface,fontSize:16,fontWeight:"600",fontFamily:m.theme.fonts.regular.fontFamily},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center"},filterContainer:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16,paddingHorizontal:24,paddingVertical:8,borderRadius:30},filterButtons:{flexDirection:"row",backgroundColor:"rgb(238, 241, 245)",padding:4,borderRadius:5},filterButton:{paddingHorizontal:20,paddingVertical:10,borderRadius:5},activeFilterButton:{backgroundColor:m.theme.colors.surface,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.05,shadowRadius:3,elevation:2},filterText:{color:"#6B7280",fontSize:16,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"500"},activeFilterText:{color:"#111827",fontWeight:"600"},viewAllButton:{flexDirection:"row",alignItems:"center",gap:4,paddingRight:12},viewAllText:{color:m.theme.colors.primary,fontSize:16,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"500"},servicesContainer:{padding:24,paddingTop:0},sectionHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16},servicesGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:16},serviceCard:{backgroundColor:m.theme.colors.surface,borderRadius:12,padding:20,marginBottom:16,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.05,shadowRadius:3,elevation:2,justifyContent:"space-between"},serviceContent:{marginBottom:20},serviceHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"flex-start",marginBottom:4},serviceTitle:{fontSize:16,fontWeight:"600",color:m.theme.colors.text,fontFamily:m.theme.fonts.header.fontFamily,maxWidth:"50%"},serviceCategory:{fontSize:14,color:m.theme.colors.textSecondary,fontFamily:m.theme.fonts.regular.fontFamily},serviceFooter:{flexDirection:"row",alignItems:"center",justifyContent:"space-between"},bookingsCount:{flexDirection:"row",alignItems:"center",gap:6},bookingsText:{fontSize:14,color:m.theme.colors.textSecondary,fontFamily:m.theme.fonts.regular.fontFamily},serviceRate:{fontSize:16,color:"#6B6C53",fontWeight:"600",fontFamily:m.theme.fonts.regular.fontFamily},viewButton:{paddingVertical:8,paddingHorizontal:16,borderRadius:6,backgroundColor:m.theme.colors.surface,shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.05,shadowRadius:2,elevation:1},viewButtonText:{color:m.theme.colors.text,fontSize:14,fontWeight:"500",fontFamily:m.theme.fonts.regular.fontFamily}}),wo=({navigation:e})=>{const{colors:t}=(0,G.useTheme)(),{signOut:r,firstName:i,is_prototype:s,screenWidth:l,is_DEBUG:d,isSignedIn:c,isCollapsed:h,userRole:y}=(0,n.useContext)(g.AuthContext),{isVisible:w,currentStep:j,totalSteps:B,stepData:A,handleNext:_,handlePrevious:I,handleSkip:M,completeTutorial:R}=(0,n.useContext)(D),[L,z]=(0,n.useState)([]),[P,F]=(0,n.useState)([]),[O,E]=(0,n.useState)(!0),[W,N]=(0,n.useState)("upcoming"),[U,V]=(0,n.useState)({profile_complete:0,has_bank_account:!1,has_services:!1,subscription_plan:0}),[q,Y]=(0,n.useState)(!1),[J,$]=(0,n.useState)(null),Z=l>900,K=l<=900,Q="professional"===y,X=L.filter((e=>{const t=new Date;let o=null;if(e.start_date)try{if(o=new Date(e.start_date),isNaN(o.getTime()))return(0,g.debugLog)("MBA5677: Invalid booking date",e.start_date),!1}catch(n){return(0,g.debugLog)("MBA5677: Error parsing booking date",{date:e.start_date,error:n}),!1}switch((0,g.debugLog)("MBA5677: Filtering booking",{id:e.booking_id||e.id,date:e.start_date||e.date,parsedDate:o?o.toISOString():null,now:t.toISOString(),filter:W}),W){case"upcoming":return o&&o>t;case"active":return o&&o<=t&&!e.completed;case"past":return o&&o<t&&e.completed;default:return!0}})),ee=(Q||X.slice(0,3),{welcomeTitle:{fontSize:Z?32:24,fontWeight:"600",color:m.theme.colors.whiteText,fontFamily:m.theme.fonts.header.fontFamily},bookingCount:{fontSize:Z?16:14,color:m.theme.colors.whiteText,fontFamily:m.theme.fonts.regular.fontFamily,opacity:.8,marginTop:12},statValue:{fontSize:Z?20:16,fontWeight:"600",color:m.theme.colors.text,fontFamily:m.theme.fonts.header.fontFamily},statLabel:{fontSize:Z?16:14,color:m.theme.colors.textSecondary,fontFamily:m.theme.fonts.regular.fontFamily,marginTop:4},statChange:{fontSize:Z?14:12,fontFamily:m.theme.fonts.regular.fontFamily,marginTop:4},sectionTitle:{fontSize:Z?20:18,fontWeight:"600",color:m.theme.colors.text,fontFamily:m.theme.fonts.header.fontFamily,marginBottom:16,marginTop:24}}),te=[{id:"56782",owner:"John Doe",pet:"Max (Dog)",date:"2023-05-15",time:"14:00",status:"upcoming"},{id:"5678",owner:"Jane Smith",pet:"Whiskers (Cat)",date:"2023-05-17",time:"10:00",status:"active"}],oe=[{service_name:"Dog Walking",description:"Professional dog walking service",unit_of_time:"30 minutes",base_rate:25,additional_animal_rate:10,holiday_rate:35,additional_rates:[]}],ne=async()=>{if(s)return z(te),F(oe),V({profile_complete:.5,has_bank_account:!1,has_services:!0,subscription_plan:0}),void E(!1);try{E(!0);let e="web"===a.default.OS?sessionStorage.getItem("userToken"):await p.default.getItem("userToken");const o=Q?"professionals":"clients",n=await b.default.get("".concat(f.API_BASE_URL,"/api/").concat(o,"/v1/dashboard/"),{headers:{Authorization:"Bearer ".concat(e)}});if((0,g.debugLog)("MBA5677: Dashboard response data",n.data),n.data&&n.data.upcoming_bookings&&n.data.upcoming_bookings.length>0){const e=n.data.upcoming_bookings[0];(0,g.debugLog)("MBA5677: First booking complete structure",e),(0,g.debugLog)("MBA5677: First booking keys",Object.keys(e)),(0,g.debugLog)("MBA5677: First booking client_name field",{client_name:e.client_name,owner_name:e.owner_name,client_name_exists:"client_name"in e})}const r=(n.data.upcoming_bookings||[]).map((e=>{if((0,g.debugLog)("MBA5677: Processing booking",e),!e)return(0,g.debugLog)("MBA5677: Null booking received"),null;let t=e.start_date;return t&&t.includes(" ")&&(t=t.split(" ")[0]),Object.assign({},e,{start_date:t,client_name:e.client_name||e.owner_name})})).filter((e=>null!==e));if((0,g.debugLog)("MBA5677: Processed bookings",r),z(r),V(n.data.onboarding_progress||{profile_complete:0,has_bank_account:!1,has_services:!1,subscription_plan:0}),Q)try{const e=await(0,Ze.getProfessionalServices)();F(e||[])}catch(t){console.error("Error fetching professional services:",t)}}catch(t){if(401===t.response?.status){const n=await(async()=>{try{const e=await p.default.getItem("refreshToken"),t=await b.default.post("".concat(f.API_BASE_URL,"/api/token/refresh/"),{refresh:e}),{access:o}=t.data;return await p.default.setItem("userToken",o),o}catch(t){console.error("Error refreshing token:",t),await r(),e.navigate("SignIn")}})();if(n)try{const e=await b.default.get("".concat(f.API_BASE_URL,"/api/").concat(Q?"professionals":"owners","/v1/dashboard/"),{headers:{Authorization:"Bearer ".concat(n)}});z(e.data.upcoming_bookings||[]),V(e.data.onboarding_progress||{profile_complete:0,has_bank_account:!1,has_services:!1,subscription_plan:0})}catch(o){console.error("Error fetching dashboard data after token refresh:",o)}}else console.error("Error fetching dashboard data:",t)}finally{E(!1)}};(0,n.useEffect)((()=>{ne()}),[y,s]),(0,n.useEffect)((()=>{if(!O&&L.length>0){const e=new Date,t=L.some((t=>{try{const o=t.start_date?new Date(t.start_date):null;return o&&o<=e&&!t.completed}catch(o){return!1}}));(0,g.debugLog)("MBA5677: Checking for active bookings",{hasActiveBookings:t,bookingsCount:L.length,currentActiveFilter:W}),t&&"active"!==W&&((0,g.debugLog)("MBA5677: Setting active filter to 'active' due to active bookings"),N("active"))}}),[L,O]);"web"===a.default.OS||lo.default;return(0,T.jsxs)(x.default,{style:vo.mainContainer,children:[(0,T.jsxs)(H.default,{style:[vo.scrollView,{marginLeft:!K&&c?h?70:250:0,marginTop:K?60:0}],contentContainerStyle:[vo.scrollViewContent,{maxWidth:1200,marginHorizontal:"auto",paddingTop:K?24:0}],children:[K?null:(0,T.jsx)(x.default,{style:vo.headerContainer,children:(0,T.jsx)(x.default,{style:vo.headerRight,children:(0,T.jsx)(v.default,{style:vo.profileButton,onPress:()=>(0,u.navigateToFrom)(e,"MyProfile","Dashboard"),children:(0,T.jsx)(uo.default,{size:40,source:o(4456)})})})}),(0,T.jsx)(x.default,{style:vo.welcomeSection,children:(0,T.jsx)(x.default,{style:vo.welcomeContent,children:(0,T.jsx)(x.default,{style:vo.welcomeCard,children:(0,T.jsx)(x.default,{style:vo.welcomeHeader,children:(0,T.jsxs)(x.default,{style:vo.welcomeTextContainer,children:[(0,T.jsxs)(C.default,{style:ee.welcomeTitle,children:["Welcome back",i?", "+i:"","! \ud83d\udc4b"]}),(0,T.jsxs)(C.default,{style:ee.bookingCount,children:["You have ",L.filter((e=>!e.completed)).length," active bookings today and ",L.filter((e=>new Date(e.start_date)>new Date)).length," upcoming appointments."]})]})})})})}),(0,T.jsx)(x.default,{style:vo.statsContainer,children:(0,T.jsx)(x.default,{style:vo.statsGrid,children:Q?(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)(v.default,{style:vo.statCard,onPress:()=>(0,u.navigateToFrom)(e,"MyProfile","Dashboard",{initialTab:"profile_info"}),children:[(0,T.jsxs)(x.default,{style:vo.statHeader,children:[(0,T.jsx)(x.default,{style:[vo.statIconContainer,{backgroundColor:"#F0F9E5"}],children:(0,T.jsx)(S.default,{name:"account-check",size:24,color:m.theme.colors.primary})}),(0,T.jsxs)(C.default,{style:[ee.statChange,{color:1===U.profile_complete?m.theme.colors.success:m.theme.colors.warning}],children:[Math.round(100*U.profile_complete),"% Complete"]})]}),(0,T.jsx)(C.default,{style:ee.statValue,children:"Profile"}),(0,T.jsx)(C.default,{style:ee.statLabel,children:"Complete your profile to get started"})]}),(0,T.jsxs)(v.default,{style:vo.statCard,onPress:()=>(0,u.navigateToFrom)(e,"ServiceManager","Dashboard"),children:[(0,T.jsxs)(x.default,{style:vo.statHeader,children:[(0,T.jsx)(x.default,{style:[vo.statIconContainer,{backgroundColor:"#FEF0DA"}],children:(0,T.jsx)(S.default,{name:"briefcase",size:24,color:m.theme.colors.primary})}),(0,T.jsx)(C.default,{style:[ee.statChange,{color:U.has_services?m.theme.colors.success:m.theme.colors.warning}],children:U.has_services?"Active":"No Services"})]}),(0,T.jsx)(C.default,{style:ee.statValue,children:"Services"}),(0,T.jsx)(C.default,{style:ee.statLabel,children:"Add services to start accepting bookings"})]})]}):(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)(v.default,{style:vo.statCard,onPress:()=>(0,u.navigateToFrom)(e,"MyProfile","Dashboard",{initialTab:"profile_info"}),children:[(0,T.jsxs)(x.default,{style:vo.statHeader,children:[(0,T.jsx)(x.default,{style:[vo.statIconContainer,{backgroundColor:"#F0F9E5"}],children:(0,T.jsx)(S.default,{name:"account-check",size:24,color:m.theme.colors.primary})}),(0,T.jsxs)(C.default,{style:[ee.statChange,{color:1===U.profile_complete?m.theme.colors.success:m.theme.colors.warning}],children:[Math.round(100*U.profile_complete),"% Complete"]})]}),(0,T.jsx)(C.default,{style:ee.statValue,children:"Profile"}),(0,T.jsx)(C.default,{style:ee.statLabel,children:"Complete your profile to get started"})]}),(0,T.jsxs)(v.default,{style:vo.statCard,onPress:()=>(0,u.navigateToFrom)(e,"MyProfile","Dashboard",{initialTab:"pets_preferences"}),children:[(0,T.jsxs)(x.default,{style:vo.statHeader,children:[(0,T.jsx)(x.default,{style:[vo.statIconContainer,{backgroundColor:"#FEF0DA"}],children:(0,T.jsx)(S.default,{name:"paw",size:24,color:m.theme.colors.primary})}),(0,T.jsx)(C.default,{style:[ee.statChange,{color:U.has_pets?m.theme.colors.success:m.theme.colors.warning}],children:U.has_pets?"Added":"No Pets"})]}),(0,T.jsx)(C.default,{style:ee.statValue,children:"Pets"}),(0,T.jsx)(C.default,{style:ee.statLabel,children:"Add your pets to book services"})]})]})})}),(0,T.jsx)(x.default,{style:vo.filterContainer,children:(0,T.jsx)(x.default,{style:vo.filterButtons,children:["upcoming","active"].map((e=>(0,T.jsx)(v.default,{style:[vo.filterButton,W===e&&vo.activeFilterButton],onPress:()=>N(e),children:(0,T.jsx)(C.default,{style:[vo.filterText,W===e&&vo.activeFilterText],children:e.charAt(0).toUpperCase()+e.slice(1)})},e)))})}),(0,T.jsx)(x.default,{style:vo.bookingsContainer,children:O?(0,T.jsx)(x.default,{style:vo.loadingContainer,children:(0,T.jsx)(co.default,{size:"small",color:t.primary})}):X.length>0?X.map((e=>{(0,g.debugLog)("MBA5677: Rendering booking",{id:s?e.id:e.booking_id,date:s?e.date:e.start_date,time:s?e.time:e.start_time,client_name:s?e.owner:e.client_name,professional_name:s?e.professional:e.professional_name,status:e.status});const t=s?e.id:e.booking_id;let o;return Q?(o=s?e.owner:e.client_name||e.owner_name||"Client",(0,g.debugLog)("MBA5677: Using client name",o)):(o=s?e.professional:e.professional_name||"Professional",(0,g.debugLog)("MBA5677: Using professional name",o)),(0,T.jsx)(ho,{booking:{id:t,client_name:Q?o:null,professional_name:Q?null:o,serviceName:s?e.service:e.service_type,date:s?e.date:e.start_date,time:s?e.time:e.start_time,status:e.status,pets:s?[{name:e.pet}]:e.pets},type:Q?"professional":"client",onViewDetails:()=>(e=>{$(e),Y(!0),(0,g.debugLog)("MBA5677: Opening booking modal for ID:",e)})(t)},t)})):(0,T.jsxs)(x.default,{style:vo.emptyStateContainer,children:[(0,T.jsx)(S.default,{name:"calendar",size:48,color:m.theme.colors.textSecondary}),(0,T.jsxs)(C.default,{style:vo.emptyStateTitle,children:["No ",W," bookings"]}),(0,T.jsx)(C.default,{style:vo.emptyStateText,children:Q?"Create services to start receiving bookings from owners.":"Find professional services to book your first appointment."}),(0,T.jsxs)(v.default,{style:vo.createServiceButton,onPress:()=>(0,u.navigateToFrom)(e,Q?"ServiceManager":"SearchProfessionalsListing","Dashboard"),children:[(0,T.jsx)(S.default,{name:Q?"plus":"magnify",size:20,color:m.theme.colors.surface}),(0,T.jsx)(C.default,{style:vo.createServiceButtonText,children:Q?"Create Service":"Find Professionals"})]})]})}),Q?(0,T.jsxs)(x.default,{style:vo.servicesContainer,children:[(0,T.jsxs)(x.default,{style:vo.sectionHeader,children:[(0,T.jsx)(C.default,{style:ee.sectionTitle,children:"My Services"}),(0,T.jsxs)(v.default,{style:vo.viewAllButton,onPress:()=>(0,u.navigateToFrom)(e,"ServiceManager","Dashboard"),children:[(0,T.jsx)(C.default,{style:vo.viewAllText,children:"View All"}),(0,T.jsx)(S.default,{name:"chevron-right",size:20,color:m.theme.colors.primary})]})]}),(0,T.jsx)(x.default,{style:vo.servicesGrid,children:P.map((t=>(t=>(0,T.jsxs)(x.default,{style:vo.serviceCard,children:[(0,T.jsxs)(x.default,{style:vo.serviceContent,children:[(0,T.jsxs)(x.default,{style:vo.serviceHeader,children:[(0,T.jsx)(C.default,{style:vo.serviceTitle,numberOfLines:1,ellipsizeMode:"tail",children:t.service_name}),(0,T.jsxs)(C.default,{style:vo.serviceRate,children:["$",t.base_rate," ",t.unit_of_time||"Per Visit"]})]}),(0,T.jsx)(C.default,{style:vo.serviceCategory,children:t.category||"Exotic"})]}),(0,T.jsx)(x.default,{style:vo.serviceFooter,children:(0,T.jsx)(v.default,{style:vo.viewButton,onPress:()=>(0,u.navigateToFrom)(e,"ServiceManager","Dashboard",{serviceId:t.id}),children:(0,T.jsx)(C.default,{style:vo.viewButtonText,children:"View"})})})]},t.id))(t)))})]}):null]}),(0,T.jsx)(bo,{visible:q,onClose:()=>{Y(!1),$(null)},bookingId:J,isProfessional:Q,modalTitle:"Review Details",hideButtons:!0}),w&&"Dashboard"===A?.screen&&(0,T.jsx)(k,{step:j,totalSteps:B,title:A.title,description:A.description,position:A.position,onNext:()=>_(e),onPrevious:I,onSkip:M,onClose:R})]})},jo=({navigation:e})=>{const{width:t}=(0,_e.default)(),{screenWidth:o,isCollapsed:i,is_DEBUG:s}=(0,n.useContext)(g.AuthContext),[l,d]=(0,n.useState)(o<=900),[c,h]=(0,n.useState)({dog:!1,cat:!1,exotics:!1}),[f,y]=(0,n.useState)(""),[b,w]=(0,n.useState)([]),[j,B]=(0,n.useState)([]),[k,A]=(0,n.useState)(!1);(0,n.useEffect)((()=>{d(o<=900)}),[o]),(0,n.useEffect)((()=>{(async()=>{const t="web"===a.default.OS?sessionStorage.getItem("currentRoute"):await p.default.getItem("currentRoute");"BecomeProfessional"!==t?await(0,u.navigateToFrom)(e,"BecomeProfessional",t):s&&console.log("Error, currentRoute is BecomeProfessional")})()}),[]);const I=(e,t)=>r.default.create({mainContainer:{flex:1,backgroundColor:m.theme.colors.background,height:"100vh",overflow:"hidden",position:"fixed",top:0,left:0,right:0,bottom:0,marginLeft:e>900?t?70:250:0,transition:"margin-left 0.3s ease"},container:{flex:1,backgroundColor:m.theme.colors.background,paddingTop:"android"===a.default.OS?mt.default.currentHeight:0},scrollContent:{flexGrow:1,padding:e<=900?16:20,width:e>900?"60%":"90%",maxWidth:800,alignSelf:"center"},header:{flexDirection:"row",alignItems:"center",padding:16,borderBottomWidth:1,borderBottomColor:m.theme.colors.border,display:e<=900?"flex":"none"},backButton:{marginRight:16},headerText:{fontSize:20,fontWeight:"bold",color:m.theme.colors.primary},title:{fontSize:e<=900?24:32,color:m.theme.colors.text,textAlign:"center",marginBottom:e<=900?16:24,fontFamily:m.theme.fonts.header.fontFamily},label:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,marginBottom:e<=900?8:12,fontFamily:m.theme.fonts.regular.fontFamily},checkboxContainer:{flexDirection:"row",flexWrap:"wrap",justifyContent:e<=900?"space-between":"flex-start",gap:e<=900?8:16,marginBottom:e<=900?16:24},petButton:{flexDirection:"row",alignItems:"center",padding:e<=900?8:12,borderWidth:1,borderColor:m.theme.colors.primary,borderRadius:8,backgroundColor:m.theme.colors.surface,minWidth:e<=900?"45%":150},selectedPetButton:{backgroundColor:m.theme.colors.primary},petButtonText:{marginLeft:8,color:m.theme.colors.primary,fontSize:m.theme.fontSizes.medium,fontFamily:m.theme.fonts.regular.fontFamily},selectedPetButtonText:{color:m.theme.colors.surface},textInput:{borderColor:m.theme.colors.border,borderWidth:1,borderRadius:8,padding:e<=900?12:16,marginBottom:e<=900?16:24,backgroundColor:m.theme.colors.inputBackground,minHeight:120,fontSize:m.theme.fontSizes.medium,fontFamily:m.theme.fonts.regular.fontFamily},uploadButton:{flexDirection:"row",alignItems:"center",justifyContent:"center",padding:e<=900?12:16,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:8,borderStyle:"dashed",marginBottom:e<=900?12:16},uploadText:{marginLeft:8,color:m.theme.colors.text,fontSize:m.theme.fontSizes.medium,fontFamily:m.theme.fonts.regular.fontFamily},uploadedFileContainer:{flexDirection:"row",alignItems:"center",backgroundColor:m.theme.colors.surfaceVariant,padding:e<=900?8:12,borderRadius:8,marginBottom:8},uploadedFilePreview:{width:40,height:40,borderRadius:4,marginRight:8},certificationText:{flex:1,fontSize:m.theme.fontSizes.small,color:m.theme.colors.text,marginRight:8,fontFamily:m.theme.fonts.regular.fontFamily},removeFileButton:{padding:4},submitButton:{backgroundColor:m.theme.colors.primary,padding:e<=900?12:16,borderRadius:8,alignItems:"center",marginTop:e<=900?20:32},submitButtonDisabled:{opacity:.6},submitButtonText:{color:m.theme.colors.surface,fontSize:m.theme.fontSizes.medium,fontWeight:"bold",fontFamily:m.theme.fonts.regular.fontFamily},loadingIndicator:{marginTop:16},formContainer:{width:"100%"}});return(0,T.jsx)(x.default,{style:I(o,i).mainContainer,children:(0,T.jsxs)(Ie.default,{style:I(o,i).container,children:[l&&(0,T.jsxs)(x.default,{style:I(o,i).header,children:[(0,T.jsx)(v.default,{onPress:()=>{(0,u.handleBack)(e)},style:I(o,i).backButton,children:(0,T.jsx)(S.default,{name:"arrow-left",size:24,color:m.theme.colors.primary})}),(0,T.jsx)(C.default,{style:I(o,i).headerText,children:"Become a Professional"})]}),(0,T.jsx)(H.default,{contentContainerStyle:I(o,i).scrollContent,children:(0,T.jsxs)(x.default,{style:I(o,i).formContainer,children:[(0,T.jsx)(C.default,{style:I(o,i).title,children:"Become a Professional"}),(0,T.jsx)(C.default,{style:I(o,i).label,children:"Select Pets You Can Sit:"}),(0,T.jsx)(x.default,{style:I(o,i).checkboxContainer,children:["dog","cat","exotics"].map((e=>(0,T.jsxs)(v.default,{style:[I(o,i).petButton,c[e]&&I(o,i).selectedPetButton],onPress:()=>(e=>{h(Object.assign({},c,{[e]:!c[e]}))})(e),children:[(0,T.jsx)(S.default,{name:"exotics"===e?"turtle":e,size:24,color:c[e]?m.theme.colors.surface:m.theme.colors.primary}),(0,T.jsx)(C.default,{style:[I(o,i).petButtonText,c[e]&&I(o,i).selectedPetButtonText],children:e.charAt(0).toUpperCase()+e.slice(1)})]},e)))}),(0,T.jsx)(C.default,{style:I(o,i).label,children:"About You:"}),(0,T.jsx)(q.default,{style:I(o,i).textInput,multiline:!0,numberOfLines:4,placeholder:"Write a little about yourself...",value:f,onChangeText:y}),(0,T.jsx)(C.default,{style:I(o,i).label,children:"Upload Certifications/Resume:"}),(0,T.jsxs)(v.default,{style:I(o,i).uploadButton,onPress:async()=>{let e=await Me.launchImageLibraryAsync({mediaTypes:De.MediaTypeOptions.Images,allowsEditing:!0,aspect:[4,3],quality:1,base64:!0});if(!e.canceled){const t={uri:e.assets[0].uri,base64:e.assets[0].base64,name:e.assets[0].uri.split("/").pop()};w([...b,t])}},children:[(0,T.jsx)(S.default,{name:"file-upload",size:24,color:m.theme.colors.text}),(0,T.jsx)(C.default,{style:I(o,i).uploadText,children:"Upload Documents"})]}),b.map(((e,t)=>(0,T.jsxs)(x.default,{style:I(o,i).uploadedFileContainer,children:[(0,T.jsx)(U.default,{source:{uri:e.uri},style:I(o,i).uploadedFilePreview}),(0,T.jsx)(C.default,{style:I(o,i).certificationText,numberOfLines:1,children:e.name}),(0,T.jsx)(v.default,{style:I(o,i).removeFileButton,onPress:()=>(e=>{w(b.filter(((t,o)=>o!==e)))})(t),children:(0,T.jsx)(S.default,{name:"close",size:20,color:m.theme.colors.error})})]},t))),(0,T.jsx)(C.default,{style:I(o,i).label,children:"Upload Insurance Proof:"}),(0,T.jsxs)(v.default,{style:I(o,i).uploadButton,onPress:async()=>{let e=await Me.launchImageLibraryAsync({mediaTypes:De.MediaTypeOptions.Images,allowsEditing:!0,aspect:[4,3],quality:1,base64:!0});if(!e.canceled){const t={uri:e.assets[0].uri,base64:e.assets[0].base64,name:e.assets[0].uri.split("/").pop()};B([...j,t])}},children:[(0,T.jsx)(S.default,{name:"file-upload",size:24,color:m.theme.colors.text}),(0,T.jsx)(C.default,{style:I(o,i).uploadText,children:"Upload Insurance"})]}),j.map(((e,t)=>(0,T.jsxs)(x.default,{style:I(o,i).uploadedFileContainer,children:[(0,T.jsx)(U.default,{source:{uri:e.uri},style:I(o,i).uploadedFilePreview}),(0,T.jsx)(C.default,{style:I(o,i).certificationText,numberOfLines:1,children:e.name}),(0,T.jsx)(v.default,{style:I(o,i).removeFileButton,onPress:()=>(e=>{B(j.filter(((t,o)=>o!==e)))})(t),children:(0,T.jsx)(S.default,{name:"close",size:20,color:m.theme.colors.error})})]},t))),(0,T.jsx)(v.default,{style:[I(o,i).submitButton,k&&I(o,i).submitButtonDisabled],onPress:async()=>{A(!0),setTimeout((()=>{A(!1),h({dog:!1,cat:!1,exotics:!1}),y(""),w([]),B([]),"web"===a.default.OS?window.confirm("Success: Your application has been submitted successfully!")&&e.navigate("More"):ft.default.alert("Success","Your application has been submitted successfully!",[{text:"OK",onPress:()=>e.navigate("More",{screen:"More",transition:"slide"})}])}),2e3)},disabled:k,children:(0,T.jsx)(C.default,{style:I(o,i).submitButtonText,children:k?"Submitting...":"Submit Application"})}),k&&(0,T.jsx)(_.default,{style:I(o,i).loadingIndicator,size:"small",color:m.theme.colors.primary})]})})]})})};var So=o(30336),To=o(84268),Bo=o(59793);const ko=(e,t)=>r.default.create({mainContainer:{flex:1,backgroundColor:m.theme.colors.background,height:"100vh",overflow:"hidden",position:"fixed",top:0,left:0,right:0,bottom:0,marginLeft:e>900?t?70:250:0,transition:"margin-left 0.3s ease"},container:{flex:1},content:{flex:1,backgroundColor:m.theme.colors.background,paddingTop:"android"===a.default.OS?mt.default.currentHeight:0},webContent:{width:"100%",maxWidth:e>900?800:600,alignSelf:"center",padding:e<=900?10:16,paddingTop:e<=900?80:16},listSection:{backgroundColor:m.theme.colors.surface,borderRadius:8,marginBottom:16},webListItem:{borderBottomWidth:1,borderBottomColor:m.theme.colors.border,paddingVertical:e<=900?8:12},listItemTitle:{fontSize:e<=900?m.theme.fontSizes.medium:m.theme.fontSizes.large,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"600"},buttonContainer:{marginBottom:16},switchRoleButton:{borderColor:m.theme.colors.primary},logoutButton:{backgroundColor:m.theme.colors.error},buttonText:{fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"600"}}),Ao=({navigation:e})=>{const{isSignedIn:t,isApprovedProfessional:o,userRole:r,switchRole:i,signOut:s,screenWidth:l,isCollapsed:d,is_DEBUG:c}=(0,n.useContext)(g.AuthContext),[h,f]=(0,n.useState)(l<=900),y=ko(l,d);(0,n.useEffect)((()=>{f(l<=900)}),[l]),(0,n.useEffect)((()=>{(async()=>{try{const e=t?"Dashboard":"Home";"web"===a.default.OS?(sessionStorage.setItem("currentRoute",e),sessionStorage.setItem("previousRoute","More")):(await p.default.setItem("currentRoute",e),await p.default.setItem("previousRoute","More"))}catch(e){console.error("Error initializing routes:",e)}})()}),[t,r]);const b=async(t,o)=>{try{await(0,u.navigateToFrom)(e,t,"More",o)}catch(n){console.error("Error handling navigation:",n),e.navigate(t)}},C=[{title:"Privacy Policy",icon:"shield-account",route:"PrivacyPolicy"},{title:"Terms of Service",icon:"file-document",route:"TermsOfService"}],v=[{title:"Profile",icon:"account",route:"MyProfile"},{title:"My Bookings",icon:"calendar-clock",route:"MyBookings"},{title:"Payment Methods",icon:"credit-card",route:"PaymentMethods"},{title:"Become a Professional",icon:"account-tie",route:"BecomeProfessional"},{title:"Settings",icon:"cog",route:"Settings"},{title:"Blog",icon:"post",route:"Blog"},{title:"Privacy Policy",icon:"shield-account",route:"PrivacyPolicy"},{title:"Terms of Service",icon:"file-document",route:"TermsOfService"},{title:"Contact Us",icon:"email",route:"ContactUs"}],w=[{title:"Profile",icon:"account",route:"MyProfile"},{title:"My Services",icon:"briefcase-outline",route:"ServiceManager"},{title:"My Bookings",icon:"calendar-clock",route:"MyBookings"},{title:"Payment Methods",icon:"credit-card",route:"PaymentMethods"},{title:"Settings",icon:"cog",route:"Settings"},{title:"Blog",icon:"post",route:"Blog"},{title:"Privacy Policy",icon:"shield-account",route:"PrivacyPolicy"},{title:"Terms of Service",icon:"file-document",route:"TermsOfService"},{title:"Contact Us",icon:"email",route:"ContactUs"}];return(0,T.jsx)(x.default,{style:y.mainContainer,children:(0,T.jsx)(Ie.default,{style:y.container,children:(0,T.jsx)(x.default,{style:y.content,children:(0,T.jsxs)(x.default,{style:y.webContent,children:[(0,T.jsx)(To.default,{style:y.listSection,children:(()=>{let e;return e=t?"professional"===r?w:v:C,e.map(((t,o)=>(0,T.jsxs)(n.Fragment,{children:[(0,T.jsx)(So.default,{title:t.title,titleStyle:y.listItemTitle,left:e=>"web"===a.default.OS?(0,T.jsx)(S.default,{name:t.icon,size:l<=900?20:24,color:m.theme.colors.primary}):(0,T.jsx)(lo.default,Object.assign({},e,{icon:t.icon})),onPress:()=>b(t.route,t.tab||"Overview"),style:[y.webListItem,{paddingHorizontal:l<=900?8:16}]}),o<e.length-1&&(0,T.jsx)(Bo.default,{})]},o)))})()}),t&&(0,T.jsx)(x.default,{style:y.buttonContainer,children:(0,T.jsx)(Re.default,{mode:"contained",onPress:async()=>{try{await s(),"web"===a.default.OS?(sessionStorage.removeItem("currentRoute"),sessionStorage.removeItem("previousRoute")):await p.default.multiRemove(["currentRoute","previousRoute"]),ft.default.alert("Logged Out","You have been successfully logged out."),e.navigate("Home")}catch(t){console.error("Logout failed",t),ft.default.alert("Logout Failed","An error occurred while logging out.")}},style:[y.logoutButton],labelStyle:y.buttonText,children:"Log Out"})})]})})})})};var _o=o(61171),Io=o(56662),Mo=(o(99164),o(59814)),Do=o(32724),Ro=o(54564);const Lo=r.default.create({container:{flexDirection:"row",alignItems:"center",paddingVertical:8,paddingHorizontal:10,backgroundColor:m.theme.colors.lightGrey,borderRadius:5,marginBottom:5},removeButton:{padding:5,marginRight:5},contentContainer:{flex:1,flexDirection:"row",justifyContent:"space-between",alignItems:"center"},time:{fontSize:m.theme.fontSizes.small,fontWeight:"bold",flex:1},serviceContainer:{flex:2,flexDirection:"row",justifyContent:"flex-end",alignItems:"center"},reason:{fontSize:m.theme.fontSizes.small,color:m.theme.colors.textSecondary,marginRight:8},seeMoreButton:{padding:4,borderRadius:4,backgroundColor:m.theme.colors.primary},seeMoreText:{color:m.theme.colors.whiteText,fontSize:m.theme.fontSizes.small},modalOverlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center"},modalContent:{backgroundColor:m.theme.colors.background,borderRadius:8,padding:16,width:"80%",maxHeight:"80%"},modalHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16},modalTitle:{fontSize:m.theme.fontSizes.large,fontWeight:"bold",color:m.theme.colors.text},modalTime:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,marginBottom:12},serviceItem:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,paddingVertical:4}}),zo=({startTime:e,endTime:t,reason:o,onPress:a,onRemove:r})=>{const[i,s]=(0,n.useState)(!1),l="00:00"===e&&"24:00"===t,d=e=>{if(l)return"All Day";if("string"!==typeof e)return e instanceof Date?(0,Ro.format)(e,"h:mm a"):(console.warn("Invalid time format: ".concat(e)),"Invalid Time");try{const t=(0,Do.parse)(e,"HH:mm",new Date);return(0,Ro.format)(t,"h:mm a")}catch(t){return console.warn("Invalid time format: ".concat(e)),"Invalid Time"}};return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)(x.default,{style:Lo.container,children:[(0,T.jsx)(v.default,{style:Lo.removeButton,onPress:r,children:(0,T.jsx)(S.default,{name:"close",size:20,color:m.theme.colors.error})}),(0,T.jsxs)(x.default,{style:Lo.contentContainer,children:[(0,T.jsx)(C.default,{style:Lo.time,children:l?"All Day":"".concat(d(e)," - ").concat(d(t))}),(0,T.jsxs)(x.default,{style:Lo.serviceContainer,children:[(0,T.jsx)(C.default,{style:Lo.reason,children:(()=>{const e=o?.replace("Unavailable for: ","").split(", ")||[];return 0===e.length?"No services specified":10===e.length?"All Services":"".concat(e.length," ").concat(1===e.length?"Service":"Services")})()}),o&&(0,T.jsx)(v.default,{onPress:()=>s(!0),style:Lo.seeMoreButton,children:(0,T.jsx)(C.default,{style:Lo.seeMoreText,children:"See All"})})]})]})]}),(0,T.jsx)(A.default,{visible:i,transparent:!0,animationType:"fade",onRequestClose:()=>s(!1),children:(0,T.jsx)(v.default,{style:Lo.modalOverlay,activeOpacity:1,onPress:()=>s(!1),children:(0,T.jsxs)(x.default,{style:Lo.modalContent,children:[(0,T.jsxs)(x.default,{style:Lo.modalHeader,children:[(0,T.jsx)(C.default,{style:Lo.modalTitle,children:"Unavailable Services"}),(0,T.jsx)(v.default,{onPress:()=>s(!1),children:(0,T.jsx)(S.default,{name:"close",size:24,color:m.theme.colors.text})})]}),(0,T.jsxs)(C.default,{style:Lo.modalTime,children:[d(e)," - ",d(t)]}),o?.replace("Unavailable for: ","").split(", ").map(((e,t)=>(0,T.jsxs)(C.default,{style:Lo.serviceItem,children:["\u2022 ",e]},t)))]})})})]})},Po=r.default.create({card:{backgroundColor:m.theme.colors.surface,borderRadius:8,padding:12,marginBottom:8,flexDirection:"row",justifyContent:"space-between",alignItems:"center",elevation:2,shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.2,shadowRadius:2},cardContent:{flex:1},timeContainer:{flexDirection:"row",alignItems:"center",marginBottom:4},timeText:{marginLeft:8,fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,fontWeight:"500"},ownerName:{fontSize:m.theme.fontSizes.small,color:m.theme.colors.textSecondary},editButton:{padding:8}}),Fo=({booking:e,onPress:t,onEdit:o})=>{(0,y.useNavigation)();const n=e=>{try{const t=(0,Do.parse)(e,"HH:mm",new Date);return(0,Ro.format)(t,"h:mm a")}catch(t){return console.warn("Invalid time format: ".concat(e)),"Invalid Time"}},a=()=>{t&&t(e)};return(0,T.jsxs)(v.default,{style:Po.card,onPress:a,children:[(0,T.jsxs)(x.default,{style:Po.cardContent,children:[(0,T.jsxs)(x.default,{style:Po.timeContainer,children:[(0,T.jsx)(S.default,{name:"clock-outline",size:20,color:m.theme.colors.primary}),(0,T.jsxs)(C.default,{style:Po.timeText,children:[n(e.startTime)," - ",n(e.endTime)]})]}),(0,T.jsxs)(C.default,{style:Po.ownerName,children:["Booked with ",e.owner_name]})]}),(0,T.jsx)(v.default,{style:Po.editButton,onPress:a,children:(0,T.jsx)(S.default,{name:"pencil",size:20,color:m.theme.colors.primary})})]})},Oo=r.default.create({container:{},fullWidth:{width:"100%"},label:{fontSize:m.theme.fontSizes.smallMedium,color:m.theme.colors.placeholder,fontWeight:"500"},timeButton:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",borderWidth:1,borderColor:m.theme.colors.border,borderRadius:8,padding:8,backgroundColor:m.theme.colors.background,minHeight:20},compactTimeButton:{width:150},timeText:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text},webInputContainer:{position:"relative",borderWidth:1,borderColor:m.theme.colors.border,borderRadius:8,backgroundColor:m.theme.colors.background,overflow:"hidden",height:40,display:"flex",flexDirection:"row",alignItems:"center"},webInput:{fontSize:m.theme.fontSizes.medium,marginLeft:12,width:"90%",height:"100%",border:"none",outline:"none",backgroundColor:"transparent",color:m.theme.colors.text},webIcon:{position:"absolute",right:12,cursor:"pointer",pointerEvents:"auto"},errorBorder:{borderColor:m.theme.colors.error},errorText:{color:m.theme.colors.error},errorMessage:{color:m.theme.colors.error,fontSize:m.theme.fontSizes.small,marginTop:4},disabled:{backgroundColor:m.theme.colors.disabled,opacity:.7},disabledText:{color:m.theme.colors.placeholder}}),Eo=({label:e,value:t,onChange:o,fullWidth:r=!1,containerStyle:i,error:s,disabled:l=!1})=>{const[d,c]=n.useState(!1),{screenWidth:u}=(0,n.useContext)(g.AuthContext),h=u>400;if("web"===a.default.OS){const n="undefined"!==typeof navigator&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor);return(0,T.jsxs)(x.default,{style:[Oo.container,r&&Oo.fullWidth,i],children:[e&&(0,T.jsx)(C.default,{style:[Oo.label,s&&Oo.errorText],children:e}),(0,T.jsxs)(x.default,{style:[Oo.webInputContainer,!r&&Oo.compactTimeButton,s&&Oo.errorBorder,l&&Oo.disabled],children:[(0,T.jsx)("style",{children:'\n              input[type="time"]::-webkit-calendar-picker-indicator {\n                display: '.concat(h&&n?"block":"none",';\n              }\n              input[type="time"]::-webkit-inner-spin-button,\n              input[type="time"]::-webkit-clear-button {\n                display: none;\n              }\n            ')}),(0,T.jsx)("input",{type:"time",value:t.toTimeString().slice(0,5),onChange:e=>o(new Date("2000-01-01T".concat(e.target.value))),style:Object.assign({},Oo.webInput,{paddingRight:"12px"}),disabled:l}),h&&!n&&(0,T.jsx)(S.default,{name:"clock-outline",size:24,color:l?m.theme.colors.placeholder:m.theme.colors.text,style:Oo.webIcon,onPress:l?null:()=>{const e=document.querySelector('input[type="time"]');e&&e.showPicker()}})]}),s&&(0,T.jsx)(C.default,{style:Oo.errorMessage,children:s})]})}return(0,T.jsxs)(x.default,{style:[Oo.container,r&&Oo.fullWidth,i],children:[e&&(0,T.jsx)(C.default,{style:[Oo.label,s&&Oo.errorText],children:e}),(0,T.jsxs)(v.default,{onPress:()=>{c(!0)},style:[Oo.timeButton,!r&&Oo.compactTimeButton,s&&Oo.errorBorder,l&&Oo.disabled],disabled:l,children:[(0,T.jsx)(C.default,{style:[Oo.timeText,l&&Oo.disabledText],children:t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),h&&(0,T.jsx)(S.default,{name:"clock-outline",size:24,color:l?m.theme.colors.placeholder:m.theme.colors.text})]}),s&&(0,T.jsx)(C.default,{style:Oo.errorMessage,children:s}),d&&(0,T.jsx)(dt.default,{value:t,mode:"time",is24Hour:!0,display:"default",onChange:(e,t)=>{c("ios"===a.default.OS),t&&o(t)},disabled:l})]})},{width:Wo,height:No}=j.default.get("window"),Ho=(a.default.OS,r.default.create({modalContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0, 0, 0, 0.5)"},modalContent:{backgroundColor:m.theme.colors.background,padding:22,justifyContent:"center",alignItems:"center",borderRadius:17,maxHeight:.7*No,zIndex:1},modalHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:"100%",marginBottom:15},modalTitle:{fontSize:m.theme.fontSizes.large,fontWeight:"bold"},closeButton:{padding:5},switchContainer:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:"100%",marginVertical:10,zIndex:1},buttonContainer:{flexDirection:"row",justifyContent:"space-between",width:"100%",marginTop:20,gap:10},availabilityButton:{padding:10,borderRadius:5,flex:1,alignItems:"center"},availableButton:{backgroundColor:m.theme.colors.primary},unavailableButton:{backgroundColor:m.theme.colors.danger},disabledButton:{opacity:.5},availabilityButtonText:{color:m.theme.colors.whiteText,fontWeight:"bold"},timePickerContainer:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:"100%",marginVertical:10,zIndex:1},webTimePicker:{padding:5,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:5},unavailableTimesContainer:{marginTop:20,maxHeight:200},sectionTitle:{fontSize:m.theme.fontSizes.medium,fontWeight:"bold",marginBottom:10},inputWrapper:{position:"relative",width:"100%",marginBottom:15,zIndex:2},inputLabel:{fontSize:m.theme.fontSizes.small,color:m.theme.colors.text,marginBottom:5,fontWeight:"500"},input:{borderColor:m.theme.colors.border,borderWidth:1,borderRadius:5,padding:10,backgroundColor:m.theme.colors.inputBackground},customDropdown:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",height:40},dropdownContainer:{position:"absolute",top:"95%",left:0,right:0,backgroundColor:m.theme.colors.surface,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:5,marginTop:2,maxHeight:160,zIndex:1e3,elevation:5,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:3.84},dropdownScroll:{maxHeight:160},dropdownItem:{padding:10,borderBottomWidth:1,borderBottomColor:m.theme.colors.border,height:40},dropdownText:{color:m.theme.colors.text,fontSize:m.theme.fontSizes.medium},selectedOption:{color:m.theme.colors.primary,fontWeight:"bold"},inputError:{borderColor:m.theme.colors.danger},dropdownItemContent:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingRight:10},toggleContainer:{flexDirection:"row",marginBottom:16,borderRadius:8,backgroundColor:m.theme.colors.surface,padding:4},toggleButton:{flex:1,paddingVertical:8,paddingHorizontal:16,borderRadius:6,borderColor:m.theme.colors.border,borderWidth:1,margin:2},activeToggle:{backgroundColor:m.theme.colors.primary},toggleText:{textAlign:"center",color:m.theme.colors.text,fontSize:m.theme.fontSizes.small},activeToggleText:{color:m.theme.colors.whiteText,fontWeight:"500"},bookingsList:{maxHeight:300},emptyState:{alignItems:"center",justifyContent:"center",padding:32},emptyStateText:{marginTop:16,color:m.theme.colors.textSecondary,fontSize:m.theme.fontSizes.medium,textAlign:"center"},contentScrollView:{flex:1,width:"100%"},availabilityControls:{marginTop:20,paddingTop:20,borderTopWidth:1,borderTopColor:m.theme.colors.border,width:"100%"},bookingsContainer:{maxHeight:200,marginBottom:16},unavailableTimesWrapper:{maxHeight:200,marginBottom:16},bookingsWrapper:{marginBottom:16},selectedDatesText:{marginVertical:8,fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text}})),Uo=({isVisible:e,onClose:t,onSave:o,selectedDates:a,currentAvailability:r,bookings:i,onRemoveTimeSlot:s})=>{const[l,d]=(0,n.useState)(e),[c,u]=(0,n.useState)(!1),[g,h]=(0,n.useState)(new Date),[f,p]=(0,n.useState)(new Date),[b,w]=(0,n.useState)(!1),[B,k]=(0,n.useState)(!1),[_,I]=(0,n.useState)([]),[M,D]=(0,n.useState)(!1),[R,L]=(0,n.useState)(W()),[z,P]=(0,n.useState)("bookings"),[F,O]=(0,n.useState)(null),E=(0,y.useNavigation)();function W(){const{width:e}=j.default.get("window");return e<600?.9*e:.4*e}(0,n.useEffect)((()=>{d(e)}),[e]),(0,n.useEffect)((()=>{const e=j.default.addEventListener("change",(()=>{L(W())}));return()=>{e.remove()}}),[]);const N=()=>!(!g||!f||c)&&a.some((e=>(r[e]?.unavailableTimes||[]).some((e=>{const[t,o]=e.startTime.split(":").map(Number),[n,a]=e.endTime.split(":").map(Number),r=(0,Ro.format)(g,"HH:mm"),i=(0,Ro.format)(f,"HH:mm"),[s,l]=r.split(":").map(Number),[d,c]=i.split(":").map(Number);return s===t&&l===o&&d===n&&c===a}))));return(0,T.jsx)(A.default,{visible:l,animationType:"slide",transparent:!0,onRequestClose:t,children:(0,T.jsx)(x.default,{style:Ho.modalContainer,children:(0,T.jsxs)(x.default,{style:[Ho.modalContent,{width:R}],children:[(0,T.jsxs)(x.default,{style:Ho.modalHeader,children:[(0,T.jsx)(C.default,{style:Ho.modalTitle,children:a.length>1?"Edit Multiple Days":"Edit Availability"}),(0,T.jsx)(v.default,{style:Ho.closeButton,onPress:t,children:(0,T.jsx)(S.default,{name:"close",size:24,color:m.theme.colors.text})})]}),(0,T.jsxs)(C.default,{style:Ho.selectedDatesText,children:["Selected Dates: ",(()=>{if(!a||0===a.length)return"";const e=a[0],t=a[a.length-1];return e===t?e:"".concat(e," - ").concat(t)})()]}),(0,T.jsxs)(x.default,{style:Ho.toggleContainer,children:[(0,T.jsx)(v.default,{style:[Ho.toggleButton,"unavailable"===z&&Ho.activeToggle],onPress:()=>P("unavailable"),children:(0,T.jsx)(C.default,{style:[Ho.toggleText,"unavailable"===z&&Ho.activeToggleText],children:"Unavailable Times"})}),(0,T.jsx)(v.default,{style:[Ho.toggleButton,"bookings"===z&&Ho.activeToggle],onPress:()=>P("bookings"),children:(0,T.jsx)(C.default,{style:[Ho.toggleText,"bookings"===z&&Ho.activeToggleText],children:"Bookings"})})]}),(0,T.jsxs)(H.default,{style:Ho.contentScrollView,nestedScrollEnabled:!0,children:["unavailable"===z?(0,T.jsx)(x.default,{style:Ho.unavailableTimesWrapper,children:(()=>{if(0===a.length)return null;const e=a[0],t=r[e]?.unavailableTimes||[];return 0===t.length?null:(0,T.jsxs)(x.default,{style:Ho.unavailableTimesContainer,children:[(0,T.jsx)(C.default,{style:Ho.sectionTitle,children:"Unavailable Times:"}),(0,T.jsx)(H.default,{children:t.map(((t,o)=>(0,T.jsx)(zo,{startTime:t.startTime,endTime:t.endTime,reason:t.reason,onRemove:()=>((e,t)=>{if(1===a.length)return void s(e,t);const o={};a.forEach((e=>{if(r[e]?.unavailableTimes){const n=r[e].unavailableTimes.filter((e=>e.startTime!==t.startTime||e.endTime!==t.endTime));o[e]=Object.assign({},r[e],{unavailableTimes:n})}})),s(e,t,o,a)})(e,t)},o)))})]})})()}):(0,T.jsx)(x.default,{style:Ho.bookingsWrapper,children:(()=>{const e=a.reduce(((e,t)=>(i[t]&&e.push(...i[t].map((e=>Object.assign({},e,{date:t})))),e)),[]);if(0===e.length)return(0,T.jsxs)(x.default,{style:Ho.emptyState,children:[(0,T.jsx)(S.default,{name:"calendar-blank",size:48,color:m.theme.colors.textSecondary}),(0,T.jsx)(C.default,{style:Ho.emptyStateText,children:"No bookings for selected dates"})]});const o=e=>{t(),setTimeout((()=>{E.navigate("BookingDetails",{bookingId:e.id})}),300)};return(0,T.jsx)(x.default,{style:Ho.bookingsContainer,children:(0,T.jsx)(H.default,{style:Ho.bookingsList,nestedScrollEnabled:!0,children:e.map(((e,t)=>(0,T.jsx)(Fo,{booking:e,onPress:()=>o(e),onEdit:()=>o(e)},t)))})})})()}),(0,T.jsxs)(x.default,{style:Ho.availabilityControls,children:[(0,T.jsxs)(x.default,{style:Ho.inputWrapper,children:[(0,T.jsx)(C.default,{style:Ho.inputLabel,children:"Service Type(s) *"}),(0,T.jsxs)(v.default,{style:[Ho.input,Ho.customDropdown,0===_.length&&Ho.inputError],onPress:()=>D(!M),children:[(0,T.jsx)(C.default,{style:{color:_.length>0?m.theme.colors.text:m.theme.colors.placeHolderText},children:_.length>0?_.includes(le)?"All Services":_.length>1?"".concat(_.length," services selected"):_[0]:"Select service type(s)"}),(0,T.jsx)(S.default,{name:M?"chevron-up":"chevron-down",size:24,color:m.theme.colors.primary})]}),M&&(0,T.jsx)(x.default,{style:Ho.dropdownContainer,children:(0,T.jsx)(H.default,{style:Ho.dropdownScroll,children:de.map((e=>(0,T.jsx)(v.default,{style:Ho.dropdownItem,onPress:()=>{I(e===le?_.includes(le)?[]:[le]:t=>{const o=t.filter((e=>e!==le));return t.includes(e)?o.filter((t=>t!==e)):[...o,e]})},children:(0,T.jsxs)(x.default,{style:Ho.dropdownItemContent,children:[(0,T.jsx)(C.default,{style:[Ho.dropdownText,_.includes(e)&&Ho.selectedOption],children:e}),_.includes(e)&&(0,T.jsx)(S.default,{name:"check",size:20,color:m.theme.colors.primary})]})},e)))})})]}),(0,T.jsxs)(x.default,{style:Ho.switchContainer,children:[(0,T.jsx)(C.default,{children:"All Day"}),(0,T.jsx)(He.default,{value:c,onValueChange:u})]}),!c&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)(x.default,{style:Ho.timePickerContainer,children:[(0,T.jsx)(C.default,{children:"Start Time:"}),(0,T.jsx)(Eo,{value:g,onChange:h,showPicker:b,setShowPicker:w,fullWidth:!0})]}),(0,T.jsxs)(x.default,{style:Ho.timePickerContainer,children:[(0,T.jsx)(C.default,{children:"End Time:"}),(0,T.jsx)(Eo,{value:f,onChange:p,showPicker:B,setShowPicker:k,fullWidth:!0})]})]}),(0,T.jsxs)(x.default,{style:Ho.buttonContainer,children:[(0,T.jsx)(v.default,{style:[Ho.availabilityButton,Ho.availableButton,(0===_.length||!N())&&Ho.disabledButton],onPress:()=>{if(0===_.length||!N())return;const e=(0,Ro.format)(g,"HH:mm"),t=(0,Ro.format)(f,"HH:mm"),o={};a.forEach((n=>{if(r[n]?.unavailableTimes){const a=r[n].unavailableTimes.filter((o=>o.startTime!==e||o.endTime!==t));o[n]=Object.assign({},r[n],{unavailableTimes:a})}})),s(a[0],{startTime:e,endTime:t},o,a)},disabled:0===_.length||!N(),children:(0,T.jsx)(C.default,{style:Ho.availabilityButtonText,children:"Mark Available"})}),(0,T.jsx)(v.default,{style:[Ho.availabilityButton,Ho.unavailableButton,(0===_.length||N())&&Ho.disabledButton],onPress:()=>{if(0===_.length||N())return;const e=_.includes(le)?de.filter((e=>e!==le)):_;o({dates:a,isAllDay:c,startTime:c?null:(0,Ro.format)(g,"HH:mm"),endTime:c?null:(0,Ro.format)(f,"HH:mm"),isUnavailable:!0,serviceTypes:e,reason:"Unavailable for: ".concat(e.join(", "))})},disabled:0===_.length||N(),children:(0,T.jsx)(C.default,{style:Ho.availabilityButtonText,children:"Mark Unavailable"})})]})]})]})]})})})},Vo=({format:e=[["months","days","years"],["hours","minutes","am/pm"]],value:t,onChange:o,disabled:r=!1,isInModal:i=!1,error:s=!1})=>{const[l,d]=(0,n.useState)({months:"",days:"",years:"",hours:"",minutes:"",ampm:"AM"}),c=e=>{const{months:t,days:o,years:n,hours:a,minutes:r,ampm:i}=e;if(!t||!o||!n)return null;let s=parseInt(a||"12");return"PM"===i&&12!==s&&(s+=12),"AM"===i&&12===s&&(s=0),new Date(parseInt(n),parseInt(t)-1,parseInt(o),s,parseInt(r||"0"))},u=e=>{let t=[];switch(e){case"months":t=Array.from({length:12},((e,t)=>({value:(t+1).toString(),label:new Date(2e3,t).toLocaleString("default",{month:"long"})})));break;case"days":t=Array.from({length:31},((e,t)=>({value:(t+1).toString(),label:(t+1).toString()})));break;case"years":const e=(new Date).getFullYear();t=Array.from({length:100},((t,o)=>({value:(e-50+o).toString(),label:(e-50+o).toString()})));break;case"hours":t=Array.from({length:12},((e,t)=>({value:(t+1).toString(),label:(t+1).toString()})));break;case"minutes":t=Array.from({length:60},((e,t)=>({value:t.toString().padStart(2,"0"),label:t.toString().padStart(2,"0")})));break;case"am/pm":t=[{value:"AM",label:"AM"},{value:"PM",label:"PM"}]}const n=Object.assign({},qo.select,s?qo.errorSelect:{},"months"===e?qo.monthSelect:{},"years"===e?qo.yearSelect:{},"days"===e?qo.daySelect:{});return(0,T.jsxs)("select",{value:l["am/pm"===e?"ampm":e],onChange:t=>{i&&"web"===a.default.OS&&t.stopPropagation(),((e,t)=>{if(r)return;const n=Object.assign({},l,{[e]:t});if(d(n),o){const e=c(n);o(e)}})("am/pm"===e?"ampm":e,t.target.value)},style:n,disabled:r,children:[(0,T.jsx)("option",{value:"",children:e.charAt(0).toUpperCase()+e.slice(1)}),t.map((e=>(0,T.jsx)("option",{value:e.value,children:e.label},e.value)))]})};return(0,T.jsx)(x.default,{style:qo.container,children:e.map(((e,t)=>(0,T.jsx)(x.default,{style:qo.row,children:e.map(((e,t)=>(0,T.jsx)(x.default,{style:qo.selectContainer,children:u(e)},e)))},t)))})},qo=r.default.create({container:{width:"100%"},row:{flexDirection:"row",marginBottom:8,gap:8},selectContainer:{flex:1},select:{width:"100%",padding:8,borderRadius:4,borderWidth:1,borderColor:m.theme.colors.border,backgroundColor:m.theme.colors.background,fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,appearance:"none",WebkitAppearance:"none",MozAppearance:"none",paddingRight:8,cursor:"pointer"},monthSelect:{flex:1.5},daySelect:{flex:.8},yearSelect:{flex:1.2},errorSelect:{borderColor:m.theme.colors.danger}}),{width:Yo}=j.default.get("window"),Go=(a.default.OS,"All Days"),Jo=[Go,"Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],$o=r.default.create({modalContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0, 0, 0, 0.5)"},modalContent:{backgroundColor:m.theme.colors.background,padding:22,borderRadius:17,maxHeight:"80%"},modalHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:20},closeButton:{padding:8},modalTitle:{fontSize:m.theme.fontSizes.large,fontWeight:"bold",marginBottom:15,fontFamily:m.theme.fonts.header.fontFamily},settingContainer:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:"100%",marginVertical:10},sectionTitle:{fontSize:m.theme.fontSizes.medium,fontWeight:"bold",marginTop:20,marginBottom:10,fontFamily:m.theme.fonts.header.fontFamily},dayContainer:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:"100%",marginVertical:5},buttonContainer:{flexDirection:"row",justifyContent:"space-between",gap:12,marginTop:20},button:{flex:1,padding:12,borderRadius:8,alignItems:"center"},availableButton:{backgroundColor:m.theme.colors.primary},unavailableButton:{backgroundColor:m.theme.colors.error},buttonText:{color:m.theme.colors.whiteText,fontWeight:"bold",fontFamily:m.theme.fonts.regular.fontFamily},tabContainer:{flexDirection:"row",marginBottom:15},tab:{paddingHorizontal:15,paddingVertical:10,borderBottomWidth:2,borderBottomColor:"transparent"},selectedTab:{borderBottomColor:m.theme.colors.primary},tabText:{color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},selectedTabText:{color:m.theme.colors.primary,fontFamily:m.theme.fonts.regular.fontFamily},daySettingsContainer:{marginBottom:15},settingRow:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:15,gap:12},webTimePicker:{padding:5,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:5},webDatePicker:{padding:5,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:5},inputWrapper:{position:"relative",width:"100%",marginBottom:15,zIndex:2},inputLabel:{marginBottom:5,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},input:{borderWidth:1,borderColor:m.theme.colors.border,borderRadius:5,padding:10,backgroundColor:m.theme.colors.surface},customDropdown:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"},dropdownContainer:{position:"absolute",top:"100%",left:0,right:0,backgroundColor:m.theme.colors.surface,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:5,maxHeight:200,zIndex:1e3},dropdownScroll:{maxHeight:200},dropdownItem:{padding:10,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},dropdownItemContent:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"},dropdownText:{color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},selectedOption:{color:m.theme.colors.primary,fontWeight:"bold",fontFamily:m.theme.fonts.regular.fontFamily},inputError:{borderColor:m.theme.colors.danger},disabledButton:{opacity:.5},disabledText:{color:m.theme.colors.placeHolderText,fontFamily:m.theme.fonts.regular.fontFamily},enabledText:{color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},timePickerContainer:{flex:1,maxWidth:150},datePickerContainer:{flex:1,maxWidth:200},datePickerWrapper:{width:"100%"},validationErrorText:{color:m.theme.colors.danger,fontSize:m.theme.fontSizes.small,marginTop:4,fontFamily:m.theme.fonts.regular.fontFamily}}),Zo=({isVisible:e,onClose:t,onSave:o,defaultSettings:r})=>{const{screenWidth:i}=(0,n.useContext)(g.AuthContext),[s,l]=(0,n.useState)([]),[d,c]=(0,n.useState)(r||{Monday:{isAllDay:!1,startTime:"09:00",endTime:"17:00",endDate:null},Tuesday:{isAllDay:!1,startTime:"09:00",endTime:"17:00",endDate:null},Wednesday:{isAllDay:!1,startTime:"09:00",endTime:"17:00",endDate:null},Thursday:{isAllDay:!1,startTime:"09:00",endTime:"17:00",endDate:null},Friday:{isAllDay:!1,startTime:"09:00",endTime:"17:00",endDate:null},Saturday:{isAllDay:!1,startTime:"09:00",endTime:"17:00",endDate:null},Sunday:{isAllDay:!1,startTime:"09:00",endTime:"17:00",endDate:null}}),[u,h]=(0,n.useState)({visible:!1,type:"",value:""}),[f,p]=(0,n.useState)(!1),[y,b]=(0,n.useState)(!1),[j,B]=(0,n.useState)(!1),[k,_]=(0,n.useState)("Please select day(s) first"),I=(0,n.useRef)(new w.default.Value(0)).current,M=(0,n.useRef)(new w.default.Value(600)).current,D=()=>{w.default.parallel([w.default.timing(I,{toValue:0,duration:300,useNativeDriver:!0}),w.default.timing(M,{toValue:600,duration:300,useNativeDriver:!0})]).start((()=>{t()}))};(0,n.useEffect)((()=>{e&&(w.default.timing(I,{toValue:1,duration:300,useNativeDriver:!0}).start(),w.default.spring(M,{toValue:0,tension:50,friction:8,useNativeDriver:!0}).start())}),[e]),(0,n.useEffect)((()=>{const e=e=>{const t=document.getElementById("dropdown-button"),o=document.getElementById("dropdown-container");j&&o&&!o.contains(e.target)&&!t.contains(e.target)&&B(!1)};if("web"===a.default.OS)return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[j]);const R=e=>{if(console.log("Selected days:",s),0===s.length)return;const t=s.includes(Go)?Jo.filter((e=>e!==Go)):s;console.log("Days to update:",t),console.log("Current settings:",d),console.log("Making available:",e);const n=Object.assign({},d);t.forEach((t=>{console.log("Updating ".concat(t)),n[t]=Object.assign({},d[t],{isUnavailable:!e,startTime:d[s[0]].startTime,endTime:d[s[0]].endTime,isAllDay:d[s[0]].isAllDay,endDate:d[s[0]].endDate})})),console.log("New settings:",n),c(n),o(n),b(!e)};(0,n.useEffect)((()=>{0===s.length?_("Please select day(s) first"):_("")}),[s]);const L=(e,t,o)=>(0,T.jsx)(Eo,{value:new Date("2000-01-01T".concat(t)),onChange:e=>{const t=e.toTimeString().slice(0,5);o(t)},fullWidth:!1,disabled:0===s.length,error:k}),z=()=>{if(!s||0===s.length)return(0,T.jsxs)(x.default,{style:$o.datePickerWrapper,children:[(0,T.jsx)(x.default,{style:[$o.datePickerContainer],onClick:e=>e.stopPropagation(),onMouseDown:e=>e.stopPropagation(),children:(0,T.jsx)(Vo,{format:[["months","days","years"]],disabled:!0,isInModal:!0,error:!0})}),(0,T.jsx)(C.default,{style:$o.validationErrorText,children:k})]});const e=d[s[0]];return(0,T.jsx)(x.default,{style:$o.datePickerWrapper,children:(0,T.jsx)(x.default,{style:$o.datePickerContainer,onClick:e=>e.stopPropagation(),onMouseDown:e=>e.stopPropagation(),children:(0,T.jsx)(Vo,{format:[["months","days","years"]],value:e.endDate?new Date(e.endDate):null,onChange:e=>{return t=s[0],o={endDate:e.toISOString().split("T")[0]},void c((e=>Object.assign({},e,{[t]:Object.assign({},e[t],o)})));var t,o},disabled:!1,isInModal:!0,error:!1})})})};(0,n.useEffect)((()=>{if(s.length>0){const e=((e,t)=>!(!e||0===e.length)&&e.some((e=>t[e]?.isUnavailable)))(s,d);b(e)}else b(!1)}),[s,d]);return(0,T.jsx)(A.default,{visible:e,transparent:!0,onRequestClose:D,children:(0,T.jsx)(w.default.View,{style:[$o.modalContainer,{opacity:I}],children:(0,T.jsxs)(w.default.View,{style:[$o.modalContent,{width:i<600?"90%":600,transform:[{translateY:M}]}],children:[(0,T.jsxs)(x.default,{style:$o.modalHeader,children:[(0,T.jsx)(C.default,{style:$o.modalTitle,children:"Default Settings"}),(0,T.jsx)(v.default,{onPress:D,style:$o.closeButton,children:(0,T.jsx)(S.default,{name:"close",size:24,color:m.theme.colors.text})})]}),(0,T.jsxs)(x.default,{style:$o.inputWrapper,children:[(0,T.jsx)(C.default,{style:$o.inputLabel,children:"Day(s) *"}),(0,T.jsxs)(v.default,{id:"dropdown-button",style:[$o.input,$o.customDropdown,0===s.length&&$o.inputError],onPress:()=>B(!j),children:[(0,T.jsx)(C.default,{style:{color:s.length>0?m.theme.colors.text:m.theme.colors.placeHolderText},children:0===s.length?"Select Days":s.includes(Go)?"All Days":s.length>2?"".concat(s.length," Days Selected"):s.join(", ")}),(0,T.jsx)(S.default,{name:j?"chevron-up":"chevron-down",size:24,color:m.theme.colors.text})]}),j&&(0,T.jsx)(x.default,{id:"dropdown-container",style:$o.dropdownContainer,children:(0,T.jsx)(H.default,{style:$o.dropdownScroll,children:Jo.map((e=>(0,T.jsx)(v.default,{style:$o.dropdownItem,onPress:()=>(e=>{l((t=>{if(e===Go)return t.includes(Go)?[]:Jo.filter((e=>e!==Go));const o=t.filter((e=>e!==Go));return o.includes(e)?o.filter((t=>t!==e)):o.length+1===Jo.length-1?Jo.filter((e=>e!==Go)):[...o,e]}))})(e),children:(0,T.jsxs)(x.default,{style:$o.dropdownItemContent,children:[(0,T.jsx)(C.default,{style:[$o.dropdownText,s.includes(e)&&$o.selectedOption],children:e}),s.includes(e)&&(0,T.jsx)(S.default,{name:"check",size:20,color:m.theme.colors.primary})]})},e)))})})]}),(()=>{const e=d[s[0]]||{isAllDay:!1,startTime:"09:00",endTime:"17:00",endDate:null};return(0,T.jsxs)(x.default,{style:$o.daySettingsContainer,children:[(0,T.jsxs)(x.default,{style:$o.settingRow,children:[(0,T.jsx)(C.default,{style:0===s.length?$o.disabledText:$o.enabledText,children:"All Day:"}),(0,T.jsx)(He.default,{value:e.isAllDay,onValueChange:e=>{if(0===s.length)return;const t=Object.assign({},d);s.forEach((o=>{t[o]=Object.assign({},t[o],{isAllDay:e})})),c(t)},disabled:0===s.length})]}),!e.isAllDay&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)(x.default,{style:$o.settingRow,children:[(0,T.jsx)(C.default,{style:0===s.length?$o.disabledText:$o.enabledText,children:"Start Time:"}),(0,T.jsx)(x.default,{style:$o.timePickerContainer,children:L(0,e.startTime,(e=>{if(0===s.length)return;const t=Object.assign({},d);s.forEach((o=>{t[o]=Object.assign({},t[o],{startTime:e})})),c(t)}))})]}),(0,T.jsxs)(x.default,{style:$o.settingRow,children:[(0,T.jsx)(C.default,{style:0===s.length?$o.disabledText:$o.enabledText,children:"End Time:"}),(0,T.jsx)(x.default,{style:$o.timePickerContainer,children:L(0,e.endTime,(e=>{if(0===s.length)return;const t=Object.assign({},d);s.forEach((o=>{t[o]=Object.assign({},t[o],{endTime:e})})),c(t)}))})]})]}),(0,T.jsxs)(x.default,{style:$o.settingRow,children:[(0,T.jsx)(C.default,{style:0===s.length?$o.disabledText:$o.enabledText,children:"End Date:"}),(0,T.jsx)(x.default,{pointerEvents:0===s.length?"none":"auto",children:z()})]})]})})(),(0,T.jsxs)(x.default,{style:$o.buttonContainer,children:[(0,T.jsx)(v.default,{style:[$o.button,$o.availableButton],onPress:()=>R(!0),disabled:0===s.length,children:(0,T.jsx)(C.default,{style:$o.buttonText,children:"Mark Available"})}),(0,T.jsx)(v.default,{style:[$o.button,$o.unavailableButton],onPress:()=>R(!1),disabled:0===s.length,children:(0,T.jsx)(C.default,{style:$o.buttonText,children:"Mark Unavailable"})})]})]})})})},Ko=r.default.create({overlay:{width:"100%",pointerEvents:"box-none"},container:{backgroundColor:m.theme.colors.surface,borderTopLeftRadius:20,borderTopRightRadius:20,padding:16,paddingBottom:"ios"===a.default.OS?40:16,maxWidth:600,width:"100%",alignSelf:"center",shadowColor:"#000",shadowOffset:{width:0,height:-2},shadowOpacity:.25,shadowRadius:3.84,elevation:5},handleContainer:{width:"100%",height:24,alignItems:"center",justifyContent:"center",marginBottom:4},handle:{width:40,height:4,backgroundColor:m.theme.colors.border,borderRadius:2},header:{flexDirection:"row",alignItems:"center",marginBottom:12,paddingRight:8,marginTop:4},headerMinimized:{marginBottom:8,paddingBottom:12,justifyContent:"space-between"},headerCenter:{flex:1,alignItems:"center"},closeButton:{width:60,height:40,justifyContent:"center",alignItems:"center"},dateText:{fontSize:m.theme.fontSizes.medium,fontWeight:"bold",color:m.theme.colors.text,fontFamily:m.theme.fonts.header.fontFamily},statusText:{fontSize:m.theme.fontSizes.medium,marginTop:4,fontFamily:m.theme.fonts.regular.fontFamily},actionButton:{width:60,alignItems:"center"},actionButtonText:{fontSize:m.theme.fontSizes.small,color:m.theme.colors.primary,marginTop:4,textAlign:"center",lineHeight:16,fontFamily:m.theme.fonts.regular.fontFamily},content:{gap:12},timeToggleContainer:{},customToggle:{flexDirection:"row",backgroundColor:m.theme.colors.background,borderRadius:8,padding:4,gap:8},toggleButton:{flex:1,paddingVertical:12,paddingHorizontal:16,borderRadius:6,alignItems:"center",borderWidth:1,borderColor:m.theme.colors.border},toggleButtonActive:{backgroundColor:m.theme.colors.primary,borderColor:m.theme.colors.primary},toggleButtonInactive:{backgroundColor:"transparent"},toggleButtonText:{color:m.theme.colors.text,fontSize:m.theme.fontSizes.medium,fontFamily:m.theme.fonts.regular.fontFamily},toggleButtonTextActive:{color:m.theme.colors.whiteText,fontWeight:"bold",fontFamily:m.theme.fonts.regular.fontFamily},timeSection:{flexDirection:"row",gap:16},timeContainer:{flex:1},label:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,marginBottom:4,fontFamily:m.theme.fonts.regular.fontFamily},serviceSection:{position:"relative",zIndex:1},serviceSelector:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",borderWidth:1,borderColor:m.theme.colors.border,borderRadius:8,padding:12,backgroundColor:m.theme.colors.background},serviceSelectorText:{color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},dropdownContainer:{position:"absolute",top:"100%",left:0,right:0,backgroundColor:m.theme.colors.surface,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:8,maxHeight:200,zIndex:1e3},dropdownScroll:{maxHeight:200},dropdownItem:{padding:12,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},dropdownItemContent:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"},dropdownText:{color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},selectedOption:{color:m.theme.colors.primary,fontWeight:"bold",fontFamily:m.theme.fonts.regular.fontFamily},buttonContainer:{flexDirection:"row",gap:12},button:{flex:1,padding:12,borderRadius:8,alignItems:"center"},availableButton:{backgroundColor:m.theme.colors.primary},unavailableButton:{backgroundColor:m.theme.colors.error},buttonText:{color:m.theme.colors.whiteText,fontSize:m.theme.fontSizes.medium,fontWeight:"bold",fontFamily:m.theme.fonts.regular.fontFamily},serviceSelectorError:{borderColor:m.theme.colors.error,borderWidth:1},errorText:{color:m.theme.colors.error,fontSize:m.theme.fontSizes.small,marginTop:4,fontFamily:m.theme.fonts.regular.fontFamily}}),Qo=({selectedDates:e,currentAvailability:t,onClose:o,onViewUnavailableTimes:r,onSave:i,onMinimize:s})=>{const{screenWidth:l}=(0,n.useContext)(g.AuthContext),[d,c]=(0,n.useState)(new Date),[u,h]=(0,n.useState)(new Date),[f,p]=(0,n.useState)([]),[y,b]=(0,n.useState)(!1),[j,B]=(0,n.useState)(!1),[k,A]=(0,n.useState)(null),[_,I]=(0,n.useState)(!1),M=(0,n.useRef)(new w.default.Value(1)).current,D=(0,n.useRef)(new w.default.Value(1)).current,R=(0,n.useRef)(new w.default.Value(0)).current;(0,n.useEffect)((()=>{w.default.spring(R,{toValue:1,useNativeDriver:!0,tension:50,friction:8}).start()}),[]);const L=()=>{if(!e||0===e.length)return"Unknown";const o=e[0],n=t[o];return n?n.isAvailable?n.unavailableTimes?.length>0?"Partially Available":"Available":"Unavailable":"Available"},z=e=>{0!==f.length?(A(null),i({startTime:j?"00:00":(0,Ro.format)(d,"HH:mm"),endTime:j?"24:00":(0,Ro.format)(u,"HH:mm"),services:f,isAvailable:e,isAllDay:j})):A("Please select at least one service type")},P=()=>{const e=_?1:0,t=!_;s?.(t),w.default.parallel([w.default.timing(M,{toValue:e,duration:300,useNativeDriver:!1}),w.default.timing(D,{toValue:e,duration:300,useNativeDriver:!1})]).start((()=>{I(t)}))},F=j?364:445,O=M.interpolate({inputRange:[0,1],outputRange:[96,F]});return(0,T.jsx)(x.default,{style:[Ko.overlay,{pointerEvents:_?"box-none":"auto"}],children:(0,T.jsxs)(w.default.View,{style:[Ko.container,{height:O,transform:[{translateY:R.interpolate({inputRange:[0,1],outputRange:[600,0]})}]}],children:["web"===a.default.OS?(0,T.jsx)(v.default,{onPress:P,style:Ko.handleContainer,children:(0,T.jsx)(S.default,{name:_?"chevron-up":"chevron-down",size:24,color:m.theme.colors.text})}):(0,T.jsx)(v.default,{onPress:P,style:Ko.handleContainer,children:(0,T.jsx)(x.default,{style:Ko.handle})}),(0,T.jsxs)(x.default,{style:[Ko.header,_&&Ko.headerMinimized],children:[!_&&(0,T.jsx)(v.default,{onPress:()=>{w.default.timing(R,{toValue:0,duration:300,useNativeDriver:!0}).start((()=>{o()}))},style:Ko.closeButton,children:(0,T.jsx)(S.default,{name:"close",size:24,color:m.theme.colors.text})}),(0,T.jsxs)(x.default,{style:Ko.headerCenter,children:[(0,T.jsx)(C.default,{style:Ko.dateText,children:e&&0!==e.length?1===e.length?(0,Ro.format)((0,Do.parse)(e[0],"yyyy-MM-dd",new Date),"MMM dd, yyyy"):"".concat((0,Ro.format)((0,Do.parse)(e[0],"yyyy-MM-dd",new Date),"MMM dd")," - ").concat((0,Ro.format)((0,Do.parse)(e[e.length-1],"yyyy-MM-dd",new Date),"MMM dd, yyyy")):""}),(0,T.jsx)(C.default,{style:[Ko.statusText,{color:(()=>{switch(L()){case"Available":return m.theme.colors.success;case"Partially Available":return m.theme.colors.warning;case"Unavailable":return m.theme.colors.error;default:return m.theme.colors.text}})()}],children:L()})]}),!_&&(0,T.jsx)(w.default.View,{style:{opacity:D},children:(0,T.jsxs)(v.default,{style:Ko.actionButton,onPress:r,children:[(0,T.jsx)(S.default,{name:"clock-outline",size:24,color:m.theme.colors.primary}),(0,T.jsx)(C.default,{style:Ko.actionButtonText,children:"Unavailable\nTimes"})]})})]}),(0,T.jsxs)(w.default.View,{style:[Ko.content,{opacity:D}],children:[(0,T.jsxs)(x.default,{style:Ko.serviceSection,children:[(0,T.jsx)(C.default,{style:[Ko.label,{textAlign:"center"}],children:"Change Availability for Services"}),(0,T.jsxs)(v.default,{style:[Ko.serviceSelector,k&&f.length<=0&&Ko.serviceSelectorError],onPress:()=>b(!y),children:[(0,T.jsx)(C.default,{style:Ko.serviceSelectorText,children:f.length>0?f.includes(le)?"All Services":f.length>1?"".concat(f.length," services selected"):f[0]:"Select one or more service types"}),(0,T.jsx)(S.default,{name:y?"chevron-up":"chevron-down",size:24,color:m.theme.colors.primary})]}),k&&f.length<=0&&!y&&(0,T.jsx)(C.default,{style:Ko.errorText,children:k}),y&&(0,T.jsx)(x.default,{style:Ko.dropdownContainer,children:(0,T.jsx)(H.default,{style:Ko.dropdownScroll,children:de.map((e=>(0,T.jsx)(v.default,{style:Ko.dropdownItem,onPress:()=>{p(e===le?f.includes(le)?[]:[le]:t=>{const o=t.filter((e=>e!==le));return t.includes(e)?o.filter((t=>t!==e)):[...o,e]})},children:(0,T.jsxs)(x.default,{style:Ko.dropdownItemContent,children:[(0,T.jsx)(C.default,{style:[Ko.dropdownText,f.includes(e)&&Ko.selectedOption],children:e}),f.includes(e)&&(0,T.jsx)(S.default,{name:"check",size:20,color:m.theme.colors.primary})]})},e)))})})]}),(0,T.jsxs)(x.default,{style:Ko.timeToggleContainer,children:[(0,T.jsx)(C.default,{style:[Ko.label,{marginBottom:0}],children:"Time Selection"}),(0,T.jsxs)(x.default,{style:Ko.customToggle,children:[(0,T.jsx)(v.default,{style:[Ko.toggleButton,j?Ko.toggleButtonActive:Ko.toggleButtonInactive],onPress:()=>B(!0),children:(0,T.jsx)(C.default,{style:[Ko.toggleButtonText,j&&Ko.toggleButtonTextActive],children:"All Day"})}),(0,T.jsx)(v.default,{style:[Ko.toggleButton,j?Ko.toggleButtonInactive:Ko.toggleButtonActive],onPress:()=>B(!1),children:(0,T.jsx)(C.default,{style:[Ko.toggleButtonText,!j&&Ko.toggleButtonTextActive],children:"Custom Hours"})})]})]}),!j&&(0,T.jsxs)(x.default,{style:Ko.timeSection,children:[(0,T.jsxs)(x.default,{style:Ko.timeContainer,children:[(0,T.jsx)(C.default,{style:[Ko.label,{marginBottom:0}],children:"Start Time"}),(0,T.jsx)(Eo,{value:d,onChange:c,fullWidth:!0})]}),(0,T.jsxs)(x.default,{style:Ko.timeContainer,children:[(0,T.jsx)(C.default,{style:[Ko.label,{marginBottom:0}],children:"End Time"}),(0,T.jsx)(Eo,{value:u,onChange:h,fullWidth:!0})]})]}),(0,T.jsxs)(x.default,{style:Ko.buttonContainer,children:[(0,T.jsx)(v.default,{style:[Ko.button,Ko.availableButton],onPress:()=>z(!0),children:(0,T.jsx)(C.default,{style:Ko.buttonText,children:"Mark Available"})}),(0,T.jsx)(v.default,{style:[Ko.button,Ko.unavailableButton],onPress:()=>z(!1),children:(0,T.jsx)(C.default,{style:Ko.buttonText,children:"Mark Unavailable"})})]})]})]})})},Xo=r.default.create({modalContainer:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center"},modalContent:{backgroundColor:m.theme.colors.surface,borderRadius:20,padding:20,width:"90%",maxWidth:500,maxHeight:"80%"},modalHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:20},modalTitle:{fontSize:m.theme.fontSizes.large,fontWeight:"bold",color:m.theme.colors.text,fontFamily:m.theme.fonts.header.fontFamily},closeButton:{padding:5},timesList:{maxHeight:"90%"},timeSlotContainer:{marginBottom:15},dateHeader:{marginBottom:8},dateText:{fontSize:m.theme.fontSizes.medium,fontWeight:"bold",color:m.theme.colors.text,fontFamily:m.theme.fonts.header.fontFamily},timeSlotContent:{flexDirection:"row",justifyContent:"space-between",alignItems:"flex-start",backgroundColor:m.theme.colors.background,padding:12,borderRadius:8},bookingContent:{borderWidth:1,borderColor:m.theme.colors.border,backgroundColor:m.theme.colors.surface,shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.1,shadowRadius:2,elevation:2},timeAndReason:{flex:1},timeText:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,marginBottom:4,fontFamily:m.theme.fonts.regular.fontFamily},reasonText:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.textSecondary,fontFamily:m.theme.fonts.regular.fontFamily},removeButton:{padding:5,marginLeft:10},bookingButton:{padding:5,marginLeft:10,backgroundColor:m.theme.colors.surface,borderRadius:20,width:34,height:34,alignItems:"center",justifyContent:"center",shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.1,shadowRadius:1,elevation:2},emptyText:{textAlign:"center",color:m.theme.colors.textSecondary,fontSize:m.theme.fontSizes.medium,marginTop:20,fontFamily:m.theme.fonts.regular.fontFamily}}),en=({visible:e,onClose:t,selectedDates:o,currentAvailability:a,onRemoveTimeSlot:r,bookings:i})=>{const s=(0,y.useNavigation)(),l=(0,n.useRef)(new w.default.Value(0)).current,d=(0,n.useRef)(new w.default.Value(600)).current;(0,n.useEffect)((()=>{e&&(w.default.timing(l,{toValue:1,duration:300,useNativeDriver:!0}).start(),w.default.spring(d,{toValue:0,tension:50,friction:8,useNativeDriver:!0}).start())}),[e]);const c=()=>{w.default.parallel([w.default.timing(l,{toValue:0,duration:300,useNativeDriver:!0}),w.default.timing(d,{toValue:600,duration:300,useNativeDriver:!0})]).start((()=>{t()}))},g=e=>{const[t,o]=e.split(":"),n=new Date;return n.setHours(parseInt(t),parseInt(o)),(0,Ro.format)(n,"h:mm a")},h=()=>{if(!o||0===o.length)return[];const e=[],t=new Set;return o.forEach((o=>{const n=i[o]||[],r=a[o];n.forEach((n=>{const a="".concat(o,"-").concat(n.startTime,"-").concat(n.endTime);t.has(a)||(e.push({date:o,startTime:n.startTime,endTime:n.endTime,reason:"".concat(n.service_type,"\nBooked with ").concat(n.owner_name),isBooking:!0,ownerId:n.ownerId}),t.add(a))})),r?.unavailableTimes&&r.unavailableTimes.filter((e=>!e.ownerId)).forEach((n=>{const a="".concat(o,"-").concat(n.startTime,"-").concat(n.endTime);t.has(a)||(e.push({date:o,startTime:n.startTime,endTime:n.endTime,reason:n.reason,isBooking:!1}),t.add(a))}))})),e.sort(((e,t)=>e.date!==t.date?e.date.localeCompare(t.date):e.startTime.localeCompare(t.startTime)))},f=e=>e.isBooking?(0,T.jsx)(v.default,{style:Xo.bookingButton,onPress:()=>(async e=>{t(),await(0,u.navigateToFrom)(s,"BookingDetails","AvailabilitySettings",{bookingId:e})})(e.ownerId),children:(0,T.jsx)(S.default,{name:"arrow-right",size:24,color:m.theme.colors.primary})}):(0,T.jsx)(v.default,{style:Xo.removeButton,onPress:()=>r(e.date,e),children:(0,T.jsx)(S.default,{name:"close",size:24,color:m.theme.colors.error})});return(0,T.jsx)(A.default,{visible:e,transparent:!0,onRequestClose:c,children:(0,T.jsx)(w.default.View,{style:[Xo.modalContainer,{opacity:l}],children:(0,T.jsxs)(w.default.View,{style:[Xo.modalContent,{transform:[{translateY:d}]}],children:[(0,T.jsxs)(x.default,{style:Xo.modalHeader,children:[(0,T.jsx)(C.default,{style:Xo.modalTitle,children:"Unavailable Times"}),(0,T.jsx)(v.default,{onPress:c,style:Xo.closeButton,children:(0,T.jsx)(S.default,{name:"close",size:24,color:m.theme.colors.text})})]}),(0,T.jsxs)(H.default,{style:Xo.timesList,children:[h().map(((e,t)=>((e,t)=>{const o=(0,Ro.format)((0,Do.parse)(e.date,"yyyy-MM-dd",new Date),"MMM d, yyyy"),n=g(e.startTime),a=g(e.endTime);return(0,T.jsxs)(x.default,{style:Xo.timeSlotContainer,children:[(0,T.jsx)(x.default,{style:Xo.dateHeader,children:(0,T.jsx)(C.default,{style:Xo.dateText,children:o})}),(0,T.jsxs)(x.default,{style:[Xo.timeSlotContent,e.isBooking&&Xo.bookingContent],children:[(0,T.jsxs)(x.default,{style:Xo.timeAndReason,children:[(0,T.jsxs)(C.default,{style:Xo.timeText,children:[n," - ",a]}),(0,T.jsx)(C.default,{style:Xo.reasonText,children:e.reason})]}),f(e)]})]},t)})(e,t))),0===h().length&&(0,T.jsx)(C.default,{style:Xo.emptyText,children:"No unavailable times for selected date(s)"})]})]})})})},tn=(e,t)=>r.default.create({mainContainer:{flex:1,backgroundColor:m.theme.colors.background,height:"100vh",overflow:"hidden",position:"fixed",top:0,left:0,right:0,bottom:0,marginLeft:e>900?t?70:250:0,transition:"margin-left 0.3s ease"},container:{flex:1},scrollView:{flex:1},scrollContent:{flexGrow:1},bottomSheetOverlay:{position:"absolute",bottom:0,left:0,right:0},centeredContainer:{maxWidth:e>900?1e3:"100%",width:"100%",alignSelf:"center",flex:1,padding:e<=900?10:20},header:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:e<=900?10:16,flexWrap:e<=600?"wrap":"nowrap",gap:e<=600?10:0},title:{fontSize:e<=600?m.theme.fontSizes.medium:m.theme.fontSizes.large,fontWeight:"bold",color:m.theme.colors.text,fontFamily:m.theme.fonts.header.fontFamily,width:e<=600?"100%":"auto"},addButton:{position:"absolute",right:20,bottom:20,width:56,height:56,borderRadius:28,backgroundColor:m.theme.colors.primary,justifyContent:"center",alignItems:"center",elevation:5,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:3.84},defaultSettingsButton:{flexDirection:"row",alignItems:"center",padding:8},defaultSettingsText:{marginRight:8,fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},colorKeyContainer:{marginTop:20,padding:e<=600?15:10,backgroundColor:"white",borderRadius:5,elevation:2,flexDirection:e<=600?"column":"row",flexWrap:"wrap",gap:10},colorKeyTitle:{fontSize:16,fontWeight:"bold",marginBottom:10,fontFamily:m.theme.fonts.header.fontFamily},colorKeyItem:{flexDirection:"row",alignItems:"center",marginVertical:e<=600?2:5,flex:e<=600?0:1},colorBox:{width:20,height:20,borderRadius:3,marginRight:10},colorKeyText:{fontSize:14,color:"black",fontFamily:m.theme.fonts.regular.fontFamily},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center"},loadingText:{marginTop:10,fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},errorContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:20},errorText:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.error,textAlign:"center",marginBottom:20,fontFamily:m.theme.fonts.regular.fontFamily},retryButton:{backgroundColor:m.theme.colors.primary,padding:10,borderRadius:5},retryButtonText:{color:m.theme.colors.whiteText,fontSize:m.theme.fontSizes.medium,fontFamily:m.theme.fonts.regular.fontFamily},overlay:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"black"},bottomSheetContainer:{position:"absolute",bottom:0,left:0,right:0},calendar:{paddingBottom:20,paddingLeft:10,paddingRight:10}}),on=()=>{const{screenWidth:e,isCollapsed:t,is_DEBUG:o}=(0,n.useContext)(g.AuthContext),[r,i]=(0,n.useState)(e<=900),s=tn(e,t),[l,d]=(0,n.useState)({}),[c,u]=(0,n.useState)([]),[h,f]=(0,n.useState)(!1),[p,b]=(0,n.useState)(!1),[j,B]=(0,n.useState)("available"),[k,A]=(0,n.useState)({}),[I,M]=(0,n.useState)({}),[D,R]=(0,n.useState)({Monday:{isAllDay:!1,isUnavailable:!1,startTime:"09:00",endTime:"17:00",endDate:null},Tuesday:{isAllDay:!1,isUnavailable:!1,startTime:"09:00",endTime:"17:00",endDate:null},Wednesday:{isAllDay:!1,isUnavailable:!1,startTime:"09:00",endTime:"17:00",endDate:null},Thursday:{isAllDay:!1,isUnavailable:!1,startTime:"09:00",endTime:"17:00",endDate:null},Friday:{isAllDay:!1,isUnavailable:!1,startTime:"09:00",endTime:"17:00",endDate:null},Saturday:{isAllDay:!1,isUnavailable:!1,startTime:"09:00",endTime:"17:00",endDate:null},Sunday:{isAllDay:!1,isUnavailable:!1,startTime:"09:00",endTime:"17:00",endDate:null}}),[L,z]=(0,n.useState)(!0),[P,F]=(0,n.useState)(null),[O,E]=(0,n.useState)(!1),[W,N]=(0,n.useState)(!1),[U,V]=(0,n.useState)(!1),[q,Y]=(0,n.useState)(!1),G=(0,y.useNavigation)(),J=(0,n.useRef)(new w.default.Value(0)).current;(0,n.useEffect)((()=>{i(e<=900)}),[e]),(0,n.useEffect)((()=>{(async()=>{try{z(!0);const e=await new Promise((e=>{setTimeout((()=>{e({availableDates:{"2025-02-01":{startTime:"09:00",endTime:"17:00"},"2025-02-02":{startTime:"10:00",endTime:"18:00"},"2025-02-03":{startTime:"09:00",endTime:"17:00"}},unavailableDates:{"2025-02-04":{startTime:"00:00",endTime:"24:00"},"2025-02-05":{startTime:"10:00",endTime:"18:00"}},bookings:{"2025-02-06":[{id:"bk1",startTime:"14:00",endTime:"16:00",owner_name:"Charlie",service_type:"Dog Walking"},{id:"bk2",startTime:"16:00",endTime:"18:00",owner_name:"Bob",service_type:"Dog Walking"},{id:"bk3",startTime:"18:00",endTime:"20:00",owner_name:"Nick",service_type:"Pet Boarding"},{id:"bk4",startTime:"20:00",endTime:"22:00",owner_name:"Alfred",service_type:"Drop-In Visits (30 min)"}],"2025-02-07":[{id:"bk5",startTime:"10:00",endTime:"12:00",owner_name:"Uhtred",service_type:"Dog Walking"}]}})}),1e3)}));$(e.availableDates,e.unavailableDates,e.bookings);const t={};Object.keys(e.availableDates).forEach((e=>{t[e]={isAvailable:!0,unavailableTimes:[]}})),Object.keys(e.unavailableDates).forEach((o=>{t[o]={isAvailable:!1,unavailableTimes:[{startTime:e.unavailableDates[o].startTime,endTime:e.unavailableDates[o].endTime,reason:" Personal Time"}]}})),Object.keys(e.bookings).forEach((o=>{t[o]||(t[o]={isAvailable:!0,unavailableTimes:[]}),t[o].unavailableTimes=[...t[o].unavailableTimes,...e.bookings[o].map((e=>({startTime:e.startTime,endTime:e.endTime,reason:" Booked with ".concat(e.owner_name),ownerId:e.ownerId})))]})),A(t),M(e.bookings)}catch(e){F("Failed to load availability data"),console.error(e)}finally{z(!1)}})()}),[]);const $=(e,t,o)=>{const n={};Object.entries(t).forEach((([e,t])=>{const o="00:00"===t.startTime&&"24:00"===t.endTime,a=!!(r=t.reason)&&r.replace("Unavailable for: ","").split(", ").length===de.length-1;var r;n[e]={customStyles:{container:{backgroundColor:o&&a?"lightgrey":m.theme.colors.calendarColor,width:35,height:35,borderRadius:17.5,alignItems:"center",justifyContent:"center"},text:{color:"white"}}}})),Object.entries(e).forEach((([e,t])=>{n[e]||(n[e]={customStyles:{container:{backgroundColor:"white",width:35,height:35,borderRadius:17.5,alignItems:"center",justifyContent:"center"},text:{color:"black"}}})})),Object.entries(o).forEach((([e,t])=>{const o=t.some((e=>"00:00"===e.startTime&&"24:00"===e.endTime));n[e]={marked:!0,dotColor:m.theme.colors.primary,customStyles:{container:{backgroundColor:o?m.theme.colors.primary:m.theme.colors.calendarColorYellowBrown,width:35,height:35,borderRadius:17.5,alignItems:"center",justifyContent:"center"},text:{color:"white"}}}})),d(n)},Z=e=>{e?(V(!1),E(!0),w.default.timing(J,{toValue:.5,duration:300,useNativeDriver:!0}).start()):(V(!0),w.default.timing(J,{toValue:0,duration:300,useNativeDriver:!0}).start((()=>{E(!1),V(!1)})))},K=e=>{const t=Object.assign({},l),o=Object.assign({},k);e.dates.forEach((n=>{const a=e.serviceTypes.includes(le)||e.serviceTypes.length===de.length-1;e.isAvailable?(o[n]={isAvailable:!0,unavailableTimes:[]},t[n]={customStyles:{container:{backgroundColor:"white",width:35,height:35,borderRadius:17.5,alignItems:"center",justifyContent:"center"},text:{color:"black"}}}):(o[n]={isAvailable:!1,unavailableTimes:[{startTime:e.startTime,endTime:e.endTime,reason:e.reason}]},t[n]={customStyles:{container:{backgroundColor:e.isAllDay&&a?"lightgrey":m.theme.colors.calendarColor,width:35,height:35,borderRadius:17.5,alignItems:"center",justifyContent:"center"},text:{color:"white"}}})})),d(t),A(o),f(!1),u([])},Q="web"===a.default.OS?S.default:Mo.default;return L?(0,T.jsx)(_o.SafeAreaView,{style:s.container,children:(0,T.jsxs)(x.default,{style:s.loadingContainer,children:[(0,T.jsx)(_.default,{size:"large",color:m.theme.colors.primary}),(0,T.jsx)(C.default,{style:s.loadingText,children:"Loading availability..."})]})}):P?(0,T.jsx)(_o.SafeAreaView,{style:s.container,children:(0,T.jsxs)(x.default,{style:s.errorContainer,children:[(0,T.jsx)(C.default,{style:s.errorText,children:P}),(0,T.jsx)(v.default,{style:s.retryButton,onPress:()=>{F(null),loadAvailabilityData()},children:(0,T.jsx)(C.default,{style:s.retryButtonText,children:"Retry"})})]})}):(0,T.jsxs)(x.default,{style:tn(e,t).mainContainer,children:[(0,T.jsxs)(x.default,{style:tn(e,t).container,children:[(0,T.jsx)(H.default,{style:tn(e,t).scrollView,contentContainerStyle:tn(e,t).scrollContent,showsVerticalScrollIndicator:!1,children:(0,T.jsxs)(x.default,{style:tn(e,t).centeredContainer,children:[(0,T.jsxs)(x.default,{style:tn(e,t).header,children:[(0,T.jsx)(C.default,{style:tn(e,t).title,children:"Availability Settings"}),(0,T.jsxs)(v.default,{style:tn(e,t).defaultSettingsButton,onPress:()=>b(!0),children:[(0,T.jsx)(C.default,{style:tn(e,t).defaultSettingsText,children:"Default Settings"}),(0,T.jsx)(Q,{name:"web"===a.default.OS?"cog":"settings-outline",size:24,color:m.theme.colors.text})]})]}),(0,T.jsx)(Io.Calendar,{style:[tn(e,t).calendar,{width:e<=900?"100%":"auto"}],markedDates:l,onDayPress:e=>{const{dateString:t}=e,o=new Date(t);if(o.setDate(o.getDate()+1),o.setHours(0,0,0,0),0===c.length)u([t]),Z(!0);else if(c.length>=1){const e=new Date(c[0]);if(e.setDate(e.getDate()+1),e.setHours(0,0,0,0),o.getTime()===e.getTime())return;if(o<e)return u([t]),void Z(!0);const n=[],a=new Date(e),r=new Date(o);for(;a<=r;)n.push((0,Ro.format)(a,"yyyy-MM-dd")),a.setDate(a.getDate()+1);u(n)}},theme:{backgroundColor:"transparent",calendarBackground:"transparent",textSectionTitleColor:m.theme.colors.text,selectedDayBackgroundColor:m.theme.colors.primary,selectedDayTextColor:"#ffffff",todayTextColor:m.theme.colors.primary,dayTextColor:m.theme.colors.text,textDisabledColor:"#d9e1e8",dotColor:m.theme.colors.primary,monthTextColor:m.theme.colors.text,arrowColor:m.theme.colors.primary,indicatorColor:m.theme.colors.primary}}),(0,T.jsxs)(x.default,{style:tn(e,t).colorKeyContainer,children:[(0,T.jsx)(C.default,{style:tn(e,t).colorKeyTitle,children:"Color Key"}),(0,T.jsxs)(x.default,{style:tn(e,t).colorKeyItem,children:[(0,T.jsx)(x.default,{style:[tn(e,t).colorBox,{backgroundColor:m.theme.colors.calendarColor}]}),(0,T.jsx)(C.default,{style:tn(e,t).colorKeyText,children:"Unavailable"})]}),(0,T.jsxs)(x.default,{style:tn(e,t).colorKeyItem,children:[(0,T.jsx)(x.default,{style:[tn(e,t).colorBox,{backgroundColor:m.theme.colors.calendarColorYellowBrown}]}),(0,T.jsx)(C.default,{style:tn(e,t).colorKeyText,children:"Partially Available"})]})]})]})}),(0,T.jsx)(v.default,{style:tn(e,t).addButton,onPress:()=>f(!0),children:(0,T.jsx)(Mo.default,{name:"add",size:24,color:m.theme.colors.whiteText})})]}),h&&(0,T.jsx)(Uo,{visible:h,onClose:()=>f(!1),onSave:K,selectedDate:c.length>0?c[0]:null}),p&&(0,T.jsx)(Zo,{isVisible:p,onClose:()=>b(!1),onSave:e=>{console.log("Before updating defaultSettings:",D),console.log("New settings to be applied:",e),R(e),setTimeout((()=>{console.log("After updating defaultSettings:",D)}),0),(e=>{const t=Object.assign({},l),o=Object.assign({},k),n=new Date,a=new Date(n.getFullYear()+1,n.getMonth(),n.getDate()),r={Sunday:0,Monday:1,Tuesday:2,Wednesday:3,Thursday:4,Friday:5,Saturday:6};Object.entries(e).forEach((([e,i])=>{let s=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate()));const l=r[e];for(;s<=(i.endDate?new Date(i.endDate):a);){const e=s.getUTCDay(),n=s.toISOString().split("T")[0];e===l&&(i.isUnavailable?i.isAllDay?(t[n]={customStyles:{container:{backgroundColor:"lightgrey"},text:{color:"white"}}},o[n]={isAvailable:!1,unavailableTimes:[{startTime:"00:00",endTime:"24:00",reason:"Default Setting"}]}):(t[n]={customStyles:{container:{backgroundColor:m.theme.colors.calendarColor},text:{color:"white"}}},o[n]={isAvailable:!0,unavailableTimes:[{startTime:i.startTime,endTime:i.endTime,reason:"Default Setting"}]}):(delete t[n],delete o[n])),s.setUTCDate(s.getUTCDate()+1)}})),d(t),A(o)})(e),b(!1)},defaultSettings:D}),(O||U)&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(w.default.View,{style:[s.overlay,{opacity:J,backgroundColor:"black",pointerEvents:q?"none":"auto"}]}),(0,T.jsx)(x.default,{style:[s.bottomSheetContainer,{pointerEvents:"box-none"}],children:(0,T.jsx)(Qo,{selectedDates:c,currentAvailability:k,onClose:()=>{Z(!1),u([])},onViewUnavailableTimes:()=>{N(!0)},onSave:e=>{const{startTime:t,endTime:o,services:n,isAvailable:a}=e;K({dates:c,isAllDay:"00:00"===t&&"24:00"===o,startTime:t,endTime:o,isUnavailable:!a,serviceTypes:n,reason:"Unavailable for: ".concat(n.join(", "))}),Z(!1),u([])},onViewBookings:()=>{c.length>0&&G.navigate("MyBookings",{selectedDates:c,initialTab:"Upcoming"})},onMinimize:e=>{Y(e),w.default.timing(J,{toValue:e?0:.5,duration:300,useNativeDriver:!0}).start()}})})]}),(0,T.jsx)(en,{visible:W,onClose:()=>N(!1),selectedDates:c,currentAvailability:k,onRemoveTimeSlot:(e,t,o,n)=>{if(o&&n){A((e=>Object.assign({},e,o)));const e=Object.assign({},l);n.forEach((t=>{0===o[t]?.unavailableTimes.length&&(e[t]={customStyles:{container:{backgroundColor:"white"},text:{color:"black"}}})})),d(e)}else A((o=>{const n=o[e];if(!n)return o;const a=n.unavailableTimes.filter((e=>!(e.startTime===t.startTime&&e.endTime===t.endTime))),r=Object.assign({},l);return 0===a.length&&(r[e]={customStyles:{container:{backgroundColor:"white"},text:{color:"black"}}},d(r)),Object.assign({},o,{[e]:Object.assign({},n,{unavailableTimes:a})})}))},bookings:I})]})};var nn=o(26318),an=o(21055),rn=o(29299);const sn=r.default.create({container:{flex:1,backgroundColor:m.theme.colors.background},androidContainer:{paddingTop:mt.default.currentHeight},scrollView:{flex:1},scrollViewContent:{padding:16,paddingBottom:"web"===a.default.OS?16:90},card:{marginBottom:16,maxWidth:600,alignSelf:"center",width:"100%"},messageButtonContainer:{maxWidth:600,alignSelf:"center",width:"100%",marginTop:16},messageButton:{width:"100%"}}),ln=({route:e,navigation:t})=>{const{ownerId:o}=e.params,{colors:n}=(0,G.useTheme)(),r={id:o,name:"John Doe",email:"john.doe@example.com",phone:"(123) 456-7890",contracts:[{id:"1",date:"2023-05-01",status:"Completed"},{id:"2",date:"2023-04-15",status:"Pending"}],invoices:[{id:"1",date:"2023-05-02",amount:"$100",status:"Paid"},{id:"2",date:"2023-04-16",amount:"$75",status:"Unpaid"}],upcomingBookings:[{id:"1",date:"2023-06-01",service:"Dog Walking"},{id:"2",date:"2023-06-15",service:"Cat Sitting"}]},i=()=>(0,T.jsxs)(H.default,{style:sn.scrollView,contentContainerStyle:sn.scrollViewContent,children:[(0,T.jsx)(nn.default,{style:sn.card,children:(0,T.jsxs)(nn.default.Content,{children:[(0,T.jsx)(an.default,{children:r.name}),(0,T.jsxs)(rn.default,{children:["Email: ",r.email]}),(0,T.jsxs)(rn.default,{children:["Phone: ",r.phone]})]})}),(0,T.jsx)(nn.default,{style:sn.card,children:(0,T.jsxs)(nn.default.Content,{children:[(0,T.jsx)(an.default,{children:"Upcoming Bookings"}),r.upcomingBookings.map((e=>(0,T.jsx)(So.default,{title:"Booking ".concat(e.id),description:"Date: ".concat(e.date," - Service: ").concat(e.service),left:e=>(0,T.jsx)(lo.default,Object.assign({},e,{icon:"calendar"}))},e.id)))]})}),(0,T.jsxs)(nn.default,{style:sn.card,children:[(0,T.jsxs)(nn.default.Content,{children:[(0,T.jsx)(an.default,{children:"Contracts"}),r.contracts.map((e=>(0,T.jsx)(So.default,{title:"Contract ".concat(e.id),description:"Date: ".concat(e.date," - Status: ").concat(e.status),left:e=>(0,T.jsx)(lo.default,Object.assign({},e,{icon:"file-document-outline"}))},e.id)))]}),(0,T.jsx)(nn.default.Actions,{children:(0,T.jsx)(Re.default,{onPress:()=>(0,u.navigateToFrom)(t,"Contracts","OwnerHistory",{ownerId:o}),children:"View All Contracts"})})]}),(0,T.jsxs)(nn.default,{style:sn.card,children:[(0,T.jsxs)(nn.default.Content,{children:[(0,T.jsx)(an.default,{children:"Invoices"}),r.invoices.map((e=>(0,T.jsx)(So.default,{title:"Invoice ".concat(e.id),description:"Date: ".concat(e.date," - Amount: ").concat(e.amount," - Status: ").concat(e.status),left:e=>(0,T.jsx)(lo.default,Object.assign({},e,{icon:"file-document-outline"}))},e.id)))]}),(0,T.jsx)(nn.default.Actions,{children:(0,T.jsx)(Re.default,{onPress:()=>(0,u.navigateToFrom)(t,"Invoices","OwnerHistory",{ownerId:o}),children:"View All Invoices"})})]}),(0,T.jsx)(x.default,{style:sn.messageButtonContainer,children:(0,T.jsx)(Re.default,{mode:"contained",onPress:()=>(0,u.navigateToFrom)(t,"MessageHistory","OwnerHistory",{ownerId:o}),style:sn.messageButton,children:"View Messages"})})]});return"ios"===a.default.OS?(0,T.jsx)(Ie.default,{style:sn.container,children:(0,T.jsx)(i,{})}):"android"===a.default.OS?(0,T.jsx)(x.default,{style:[sn.container,sn.androidContainer],children:(0,T.jsx)(i,{})}):(0,T.jsx)(x.default,{style:sn.container,children:(0,T.jsx)(i,{})})};var dn=o(35708);const cn=r.default.create({container:{position:"relative"},dateTimeContainer:{flexDirection:"row",alignItems:"center",backgroundColor:m.theme.colors.background,borderRadius:8,borderWidth:1,borderColor:m.theme.colors.border,paddingHorizontal:12,height:40,width:"100%",justifyContent:"space-between"},dateInputGroup:{flexDirection:"row",alignItems:"center",justifyContent:"center",paddingHorizontal:4},timeInputGroup:{flexDirection:"row",alignItems:"center",justifyContent:"center",paddingHorizontal:4},numberInput:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,width:24,textAlign:"center",padding:0},yearInput:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,width:42,textAlign:"center",padding:0},separator:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,marginHorizontal:2},divider:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.border,marginHorizontal:8},periodButton:{backgroundColor:m.theme.colors.surface,borderRadius:4,paddingHorizontal:8,paddingVertical:4,marginLeft:8},periodText:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,fontWeight:"500"},errorBorder:{borderColor:m.theme.colors.error},errorText:{color:m.theme.colors.error,fontSize:m.theme.fontSizes.small,marginTop:4},disabled:{backgroundColor:m.theme.colors.disabled,opacity:.7},icon:{marginLeft:8},pickerContainer:{position:"absolute",top:"100%",left:0,right:0,zIndex:1e3},calendar:{backgroundColor:m.theme.colors.surface,borderRadius:8,borderWidth:1,borderColor:m.theme.colors.border,marginTop:4,padding:12,elevation:5,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:3.84},calendarHeader:{alignItems:"center",marginBottom:12},calendarHeaderText:{fontSize:m.theme.fontSizes.medium,fontWeight:"500"},calendarWeekDays:{flexDirection:"row",justifyContent:"space-around",marginBottom:8},calendarWeekDay:{width:36,textAlign:"center",fontSize:m.theme.fontSizes.small,color:m.theme.colors.placeholder},calendarWeek:{flexDirection:"row",justifyContent:"space-around",marginBottom:4},calendarDay:{width:36,height:36,justifyContent:"center",alignItems:"center",borderRadius:18},calendarDayText:{fontSize:m.theme.fontSizes.medium},selectedDay:{backgroundColor:m.theme.colors.primary},selectedDayText:{color:m.theme.colors.surface},timeSelector:{flexDirection:"row",backgroundColor:m.theme.colors.surface,borderRadius:8,borderWidth:1,borderColor:m.theme.colors.border,marginTop:4,padding:12,gap:12,elevation:5,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:3.84},timeSelectorColumn:{flex:1,alignItems:"center"},timeSelectorLabel:{fontSize:m.theme.fontSizes.small,color:m.theme.colors.placeholder,marginBottom:8},timeSelectorScroll:{height:200,width:"100%"},timeSelectorItem:{padding:12,alignItems:"center",borderRadius:4,width:"100%"},timeSelectorText:{fontSize:m.theme.fontSizes.medium},selectedTime:{backgroundColor:m.theme.colors.primary},selectedTimeText:{color:m.theme.colors.surface},periodContainer:{width:"100%"},disabledDay:{opacity:.3}}),un=({value:e,onChange:t,error:o,disabled:a=!1,containerStyle:r,isMilitary:i=!0,onPickerStateChange:s})=>{const{is_DEBUG:l,screenWidth:d}=(0,n.useContext)(g.AuthContext),[c,u]=(0,n.useState)({month:"",day:"",year:"",hours:"",minutes:"",period:i?null:"AM"}),[h,f]=(0,n.useState)(!1),[p,y]=(0,n.useState)(!1),b=(0,n.useRef)(null),v=(0,n.useRef)(new w.default.Value(0)).current;(0,n.useEffect)((()=>{var e;e=h||p,w.default.timing(v,{toValue:e?1:0,duration:200,useNativeDriver:!0}).start()}),[h,p]),(0,n.useEffect)((()=>{if(e instanceof Date&&!isNaN(e)){l&&console.log("MBA1234 Received date value:",e.toISOString());const t=e.getHours(),o=t%12||12,n=i?null:t>=12?"PM":"AM";l&&console.log("MBA1234 Time format detection:",{hours24:t,hours12:o,period:n,isMilitary:i}),u({month:String(e.getMonth()+1).padStart(2,"0"),day:String(e.getDate()).padStart(2,"0"),year:String(e.getFullYear()),hours:i?String(t).padStart(2,"0"):String(o).padStart(2,"0"),minutes:String(e.getMinutes()).padStart(2,"0"),period:n})}}),[e,i]),(0,n.useEffect)((()=>{l&&console.log("MBA5678 DateTimePicker picker states:",{showCalendar:h,showTimeSelector:p,isPickerActive:h||p}),s?.(h||p)}),[h,p]),(0,n.useEffect)((()=>{const e=e=>{b.current&&!b.current.contains(e.target)&&(l&&console.log("MBA5678 Click outside - closing pickers"),f(!1),y(!1))};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)}),[]);const j=(e,t,o)=>{const n=e.replace(/[^0-9]/g,"");if(l&&console.log("MBA1234 Formatting input:",{field:t,input:e,numbers:n,currentValue:o}),0===n.length)return"00";if(1===n.length)return"0".concat(n);if(n.length>=2){const e=parseInt(n[0],10),a=parseInt(n[1],10);if("month"===t)return e>1||1===e&&a>2?"12":"".concat(e).concat(a);if("day"===t)return e>3||3===e&&a>1?"31":"".concat(e).concat(a);if("hours"===t){if(o.period){if(e>1||1===e&&a>2)return"12"}else if(e>2||2===e&&a>3)return"23";return"".concat(e).concat(a)}if("minutes"===t)return e>5?"59":"".concat(e).concat(a)}return n.slice(0,2)},B=(e,t)=>{let o=t;switch(l&&console.log("MBA1234 Input change:",{field:e,value:t,currentInputs:c}),e){case"month":o=j(t,"month",c);break;case"day":o=j(t,"day",c);break;case"year":o=(e=>{const t=e.replace(/[^0-9]/g,"");return 0===t.length?"0000":t.padStart(4,"0").slice(0,4)})(t);break;case"hours":o=j(t,"hours",c);break;case"minutes":o=j(t,"minutes",c);break;case"period":o=t}l&&console.log("MBA1234 Formatted value:",{field:e,formattedValue:o});const n=Object.assign({},c,{[e]:o});u(n),n.month&&n.day&&n.year&&n.hours&&n.minutes&&k(n)},k=e=>{try{let o=parseInt(e.hours,10);e.period&&("PM"===e.period&&12!==o?o+=12:"AM"===e.period&&12===o&&(o=0));const n=new Date(parseInt(e.year,10),parseInt(e.month,10)-1,parseInt(e.day,10),o,parseInt(e.minutes,10));l&&console.log("MBA1234 Created new date:",{inputs:e,newDate:n.toISOString()}),isNaN(n.getTime())||t(n)}catch(o){l&&console.error("MBA1234 Error creating date:",o)}};return l&&console.log("MBA1234 Current state:",{inputs:c,isMilitary:i}),(0,T.jsxs)(x.default,{style:[cn.container,r],ref:b,children:[(0,T.jsxs)(x.default,{style:[cn.dateTimeContainer,o&&cn.errorBorder,a&&cn.disabled],children:[(0,T.jsxs)(dn.default,{style:cn.dateInputGroup,onPress:()=>!a&&(l&&console.log("MBA5678 Date press - toggling calendar"),f((e=>!e)),void y(!1)),children:[(0,T.jsx)(q.default,{style:cn.numberInput,value:c.month,maxLength:2,keyboardType:"number-pad",onChangeText:e=>B("month",e),placeholder:"MM",editable:!a}),(0,T.jsx)(C.default,{style:cn.separator,children:"/"}),(0,T.jsx)(q.default,{style:cn.numberInput,value:c.day,maxLength:2,keyboardType:"number-pad",onChangeText:e=>B("day",e),placeholder:"DD",editable:!a}),(0,T.jsx)(C.default,{style:cn.separator,children:"/"}),(0,T.jsx)(q.default,{style:cn.yearInput,value:c.year,maxLength:4,keyboardType:"number-pad",onChangeText:e=>B("year",e),placeholder:"YYYY",editable:!a}),d>410&&(0,T.jsx)(S.default,{name:"calendar",size:20,color:m.theme.colors.text,style:cn.icon})]}),(0,T.jsx)(C.default,{style:cn.divider,children:"|"}),(0,T.jsxs)(dn.default,{style:cn.timeInputGroup,onPress:()=>!a&&(l&&console.log("MBA5678 Time press - toggling time selector"),y((e=>!e)),void f(!1)),children:[(0,T.jsx)(q.default,{style:cn.numberInput,value:c.hours,maxLength:2,keyboardType:"number-pad",onChangeText:e=>B("hours",e),placeholder:"HH",editable:!a}),(0,T.jsx)(C.default,{style:cn.separator,children:":"}),(0,T.jsx)(q.default,{style:cn.numberInput,value:c.minutes,maxLength:2,keyboardType:"number-pad",onChangeText:e=>B("minutes",e),placeholder:"MM",editable:!a}),!i&&(0,T.jsx)(dn.default,{style:cn.periodButton,onPress:()=>!a&&B("period",c.period),disabled:a,children:(0,T.jsx)(C.default,{style:cn.periodText,children:c.period})}),d>410&&(0,T.jsx)(S.default,{name:"clock-outline",size:20,color:m.theme.colors.text,style:cn.icon})]})]}),(0,T.jsxs)(w.default.View,{style:[cn.pickerContainer,{opacity:v},{display:h||p?"flex":"none"}],children:[h&&!a&&(0,T.jsxs)(x.default,{style:cn.calendar,children:[(0,T.jsx)(x.default,{style:cn.calendarHeader,children:(0,T.jsxs)(C.default,{style:cn.calendarHeaderText,children:[e.toLocaleString("default",{month:"long"})," ",e.getFullYear()]})}),(0,T.jsx)(x.default,{style:cn.calendarWeekDays,children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map((e=>(0,T.jsx)(C.default,{style:cn.calendarWeekDay,children:e},e)))}),Array.from({length:6}).map(((t,o)=>(0,T.jsx)(x.default,{style:cn.calendarWeek,children:Array.from({length:7}).map(((t,n)=>{const a=7*o+n-e.getDay()+1,r=a>0&&a<=new Date(e.getFullYear(),e.getMonth()+1,0).getDate(),i=parseInt(c.day)===a;return(0,T.jsx)(dn.default,{style:[cn.calendarDay,i&&cn.selectedDay,!r&&cn.disabledDay],onPress:()=>r&&(B("day",String(a)),void f(!1)),children:r&&(0,T.jsx)(C.default,{style:[cn.calendarDayText,i&&cn.selectedDayText],children:a})},"day-".concat(n))}))},"week-".concat(o))))]}),p&&!a&&(0,T.jsxs)(x.default,{style:cn.timeSelector,children:[(0,T.jsxs)(x.default,{style:cn.timeSelectorColumn,children:[(0,T.jsx)(C.default,{style:cn.timeSelectorLabel,children:"Hour"}),(0,T.jsx)(H.default,{style:cn.timeSelectorScroll,children:Array.from({length:i?24:12},((e,t)=>(0,T.jsx)(dn.default,{style:[cn.timeSelectorItem,parseInt(c.hours)===(i?t:t+1)&&cn.selectedTime],onPress:()=>{B("hours",String(i?t:t+1).padStart(2,"0"))},children:(0,T.jsx)(C.default,{style:[cn.timeSelectorText,parseInt(c.hours)===(i?t:t+1)&&cn.selectedTimeText],children:String(i?t:t+1).padStart(2,"0")})},t)))})]}),(0,T.jsxs)(x.default,{style:cn.timeSelectorColumn,children:[(0,T.jsx)(C.default,{style:cn.timeSelectorLabel,children:"Minute"}),(0,T.jsx)(H.default,{style:cn.timeSelectorScroll,children:Array.from({length:60},((e,t)=>(0,T.jsx)(dn.default,{style:[cn.timeSelectorItem,parseInt(c.minutes)===t&&cn.selectedTime],onPress:()=>B("minutes",String(t).padStart(2,"0")),children:(0,T.jsx)(C.default,{style:[cn.timeSelectorText,parseInt(c.minutes)===t&&cn.selectedTimeText],children:String(t).padStart(2,"0")})},t)))})]}),!i&&(0,T.jsxs)(x.default,{style:cn.timeSelectorColumn,children:[(0,T.jsx)(C.default,{style:cn.timeSelectorLabel,children:"Period"}),(0,T.jsxs)(x.default,{style:cn.periodContainer,children:[(0,T.jsx)(dn.default,{style:[cn.timeSelectorItem,"AM"===c.period&&cn.selectedTime],onPress:()=>B("period","AM"),children:(0,T.jsx)(C.default,{style:[cn.timeSelectorText,"AM"===c.period&&cn.selectedTimeText],children:"AM"})}),(0,T.jsx)(dn.default,{style:[cn.timeSelectorItem,"PM"===c.period&&cn.selectedTime],onPress:()=>B("period","PM"),children:(0,T.jsx)(C.default,{style:[cn.timeSelectorText,"PM"===c.period&&cn.selectedTimeText],children:"PM"})})]})]})]})]}),o&&(0,T.jsx)(C.default,{style:cn.errorText,children:o})]})},mn=(e,t,o,n)=>{const[a,r]=o.split(":").map(Number),[i,s]=n.split(":").map(Number),l=new Date(e);let d;return l.setHours(a,r,0),t?(d=new Date(t),d.setHours(i,s,0)):(d=new Date(e),d.setHours(i,s,0)),d<l?{isValid:!1,error:"End date/time cannot be before start date/time"}:{isValid:!0,error:null}};var gn=o(62914);const hn=["1","2","3","4","5"],fn=r.default.create({modalContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0, 0, 0, 0.5)"},modalContent:{backgroundColor:m.theme.colors.background,borderRadius:8,padding:20,width:"95%",maxWidth:500},modalHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:20},modalTitle:{fontSize:m.theme.fontSizes.largeLarge,fontWeight:"bold",fontFamily:m.theme.fonts.header.fontFamily},section:{position:"relative",marginBottom:16},label:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,marginBottom:2,fontFamily:m.theme.fonts.header.fontFamily},inputContainer:{position:"relative",zIndex:200,marginBottom:16},dollarSign:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,marginRight:4,fontFamily:m.theme.fonts.regular.fontFamily},input:{borderWidth:1,borderColor:m.theme.colors.border,borderRadius:8,padding:8,backgroundColor:m.theme.colors.background},buttonContainer:{flexDirection:"row",justifyContent:"space-between",gap:10,marginTop:16},button:{flex:1,paddingVertical:6},rateSection:{},rateContainer:{flexDirection:"row",alignItems:"flex-end",justifyContent:"space-between",gap:12},baseRateInput:{flex:1},timeUnitInput:{flex:1,marginTop:-32},picker:{backgroundColor:m.theme.colors.surface,borderRadius:8,height:39,borderWidth:1,borderColor:m.theme.colors.border,fontFamily:m.theme.fonts.regular.fontFamily},totalSection:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginTop:20,paddingTop:20,borderTopWidth:1,borderTopColor:m.theme.colors.border},totalLabel:{fontSize:m.theme.fontSizes.medium,fontWeight:"bold",fontFamily:m.theme.fonts.regular.fontFamily},totalAmount:{fontSize:m.theme.fontSizes.mediumLarge,fontWeight:"bold",color:m.theme.colors.primary,fontFamily:m.theme.fonts.regular.fontFamily},errorText:{color:m.theme.colors.error,fontSize:m.theme.fontSizes.small,marginTop:8,marginBottom:8,fontFamily:m.theme.fonts.regular.fontFamily},rateRow:{flexDirection:"row",alignItems:"center",gap:10,marginBottom:10,width:"100%",flexWrap:"nowrap"},rateInput:{flex:2,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:8,height:39,padding:12,fontFamily:m.theme.fonts.regular.fontFamily,minWidth:0},rateAmountContainer:{flex:1,minWidth:0},rateAmountInput:{borderWidth:1,borderColor:m.theme.colors.border,borderRadius:8,height:39,padding:12,fontFamily:m.theme.fonts.regular.fontFamily,width:"100%"},addRateButton:{padding:10,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:8,alignItems:"center"},addRateButtonText:{color:m.theme.colors.primary,fontSize:m.theme.fontSizes.medium,fontFamily:m.theme.fonts.regular.fontFamily},rateLabelContainer:{flexDirection:"row",marginTop:10,marginBottom:5},rateTitleLabel:{flex:2,fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},rateAmountLabel:{flex:1,fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,marginLeft:10,fontFamily:m.theme.fonts.regular.fontFamily},scrollView:{flex:1},scrollViewContent:{flexGrow:1},errorMessage:{color:m.theme.colors.error,fontSize:14,textAlign:"center",fontFamily:m.theme.fonts.regular.fontFamily,marginTop:8},loadingContainer:{minWidth:80,alignItems:"center",justifyContent:"center"}}),pn=({visible:e,onClose:t,onAdd:o,defaultRates:a,hideRates:r=!1,initialOccurrence:i=null,isEditing:s=!1,modalTitle:l="Add New Occurrence",isFromRequestBooking:d=!1,booking:c})=>{const{is_DEBUG:u,screenWidth:h,timeSettings:f}=(0,n.useContext)(g.AuthContext),[p,y]=(0,n.useState)(!1),[b,j]=(0,n.useState)(!1),B=(0,n.useRef)(new w.default.Value(0)).current,[k,I]=(0,n.useState)(null),D=(0,n.useRef)(null),[R,L]=(0,n.useState)(!1),z=e=>{if(u&&(console.log("MBA1234 Parsing initial occurrence:",e),console.log("MBA1234 Time settings:",f)),!e){const e=new Date,t=new Date(e.getTime()+36e5);return{startDateTime:e,endDateTime:t,isMilitary:f.use_military_time}}try{const{startDate:t,startTime:o,endDate:n,endTime:a}=e,r=f.use_military_time;let i,s;return u&&console.log("MBA1234 Time format detection:",{startTime:o,endTime:a,isMilitary:r,timeSettings:f}),r?(i=(0,Do.parse)("".concat(t," ").concat(o),"yyyy-MM-dd HH:mm",new Date),s=(0,Do.parse)("".concat(n," ").concat(a),"yyyy-MM-dd HH:mm",new Date)):(i=(0,Do.parse)("".concat(t," ").concat(o),"yyyy-MM-dd hh:mm aa",new Date),s=(0,Do.parse)("".concat(n," ").concat(a),"yyyy-MM-dd hh:mm aa",new Date)),u&&console.log("MBA1234 Parsed dates:",{startDateTime:i.toISOString(),endDateTime:s.toISOString(),isMilitary:r}),{startDateTime:i,endDateTime:s,isMilitary:r}}catch(t){console.error("MBA1234 Error parsing dates:",t);const e=new Date,o=new Date(e.getTime()+36e5);return{startDateTime:e,endDateTime:o,isMilitary:f.use_military_time}}},P=z(i);u&&console.log("MBA565656 AddOccurrenceModal initializing with:",{defaultRates:a,initialOccurrence:i,initialDates:P});const[F,O]=(0,n.useState)((()=>{const e={startDateTime:P.startDateTime,endDateTime:P.endDateTime,isMilitary:f.use_military_time,rates:{baseRate:"0",additionalAnimalRate:"0",appliesAfterAnimals:"1",holidayRate:"0",unit_of_time:"Per Visit",additionalRates:[]},calculatedCost:"0"};return i?.rates?(e.rates=i.rates,e.calculatedCost=i.calculatedCost||"0"):a&&(e.rates={baseRate:a.base_rate?.toString()||"0",additionalAnimalRate:a.additional_animal_rate?.toString()||"0",appliesAfterAnimals:a.applies_after?.toString()||"1",holidayRate:a.holiday_rate?.toString()||"0",unit_of_time:a.unit_of_time||"Per Visit",additionalRates:a.additional_rates?.map((e=>({name:e.title,description:e.description||"",amount:e.amount})))||[]},e.calculatedCost=a.calculated_cost?.toString()||"0"),u&&console.log("MBA565656 Initial state calculated:",e),e})),[E,W]=(0,n.useState)(i?.rates?.unit_of_time||a?.unit_of_time||"Per Visit");(0,n.useEffect)((()=>{e&&(I(null),D.current={baseRate:F.rates.baseRate,additionalAnimalRate:F.rates.additionalAnimalRate,holidayRate:F.rates.holidayRate,unit_of_time:F.rates.unit_of_time,additionalRates:[...F.rates.additionalRates],startDateTime:new Date(F.startDateTime),endDateTime:new Date(F.endDateTime)},u&&console.log("MBA565656 Setting initial values:",D.current))}),[e]);const N=e=>{j(e),u&&console.log("MBA5678 Picker state changed:",{isActive:e,isFromRequestBooking:d,currentModalHeight:e&&d?"65vh":"80%"}),w.default.timing(B,{toValue:e&&d?1:0,duration:300,useNativeDriver:!1}).start()};(0,n.useEffect)((()=>{u&&console.log("MBA5678 Modal state:",{isFromRequestBooking:d,isAnyPickerActive:b,visible:e})}),[d,b,e]),(0,n.useEffect)((()=>{if(!i&&a){u&&console.log("MBA565656 Updating rates from defaultRates:",{defaultRates:a,currentRates:F.rates});const e={baseRate:a.base_rate?.toString()||"0",additionalAnimalRate:a.additional_animal_rate?.toString()||"0",appliesAfterAnimals:a.applies_after?.toString()||"1",holidayRate:a.holiday_rate?.toString()||"0",unit_of_time:a.unit_of_time||"Per Visit",additionalRates:a.additional_rates?.map((e=>({name:e.title,description:e.description||"",amount:e.amount})))||[]};u&&(console.log("MBA565656 Setting new rates:",e),console.log("MBA565656 Setting calculated cost:",a.calculated_cost)),O((t=>{const o=Object.assign({},t,{rates:e,calculatedCost:a.calculated_cost?.toString()||"0"});return u&&console.log("MBA565656 Updated occurrence state:",o),o})),W(a.unit_of_time||"Per Visit")}}),[a,i]);const U=(0,n.useCallback)((0,gn.debounce)((e=>{if(c?.booking_id)try{L(!0);const t=Ot(e,c.pets?.length||0);u&&console.log("MBA565656 Cost calculation result:",t),O((e=>Object.assign({},e,{calculatedCost:t.total_cost.toFixed(2)})))}catch(t){u&&console.error("MBA565656 Error calculating costs:",t)}finally{L(!1)}}),500),[c?.booking_id,c?.pets?.length]);(0,n.useEffect)((()=>{if(e&&D.current&&c?.booking_id){u&&console.log("MBA565656 Checking for changes:",{current:{rates:F.rates,startDateTime:F.startDateTime.toISOString(),endDateTime:F.endDateTime.toISOString()},initial:{rates:D.current,startDateTime:D.current.startDateTime.toISOString(),endDateTime:D.current.endDateTime.toISOString()}});const e={start:Math.abs(F.startDateTime.getTime()-D.current.startDateTime.getTime()),end:Math.abs(F.endDateTime.getTime()-D.current.endDateTime.getTime())},t={baseRate:F.rates.baseRate!==D.current.baseRate,additionalAnimalRate:F.rates.additionalAnimalRate!==D.current.additionalAnimalRate,holidayRate:F.rates.holidayRate!==D.current.holidayRate,unit_of_time:F.rates.unit_of_time!==D.current.unit_of_time,additionalRatesLength:F.rates.additionalRates.length!==D.current.additionalRates.length},o=t.baseRate||t.additionalAnimalRate||t.holidayRate||t.unit_of_time||t.additionalRatesLength||e.start>=1e3||e.end>=1e3;if(u&&console.log("MBA565656 Change detection details:",{timeDiffs:e,rateChanges:t,hasChanges:o}),o){u&&console.log("MBA565656 Changes detected, calculating costs:",{current:{rates:F.rates,startDateTime:F.startDateTime.toISOString(),endDateTime:F.endDateTime.toISOString()},initial:{rates:D.current,startDateTime:D.current.startDateTime.toISOString(),endDateTime:D.current.endDateTime.toISOString()},timeDiffs:e,rateChanges:t});const o={start_date:(0,Ro.format)(F.startDateTime,"yyyy-MM-dd"),end_date:(0,Ro.format)(F.endDateTime,"yyyy-MM-dd"),start_time:(0,Ro.format)(F.startDateTime,"HH:mm"),end_time:(0,Ro.format)(F.endDateTime,"HH:mm"),rates:{base_rate:F.rates.baseRate,additional_animal_rate:F.rates.additionalAnimalRate,applies_after:F.rates.appliesAfterAnimals,holiday_rate:F.rates.holidayRate,unit_of_time:F.rates.unit_of_time,additional_rates:F.rates.additionalRates}};u&&console.log("MBA565656 Calling debouncedCalculateCosts with:",o),U(o)}else u&&console.log("MBA565656 No changes detected, skipping calculation")}else u&&console.log("MBA565656 Skipping cost calculation:",{visible:e,hasInitialValues:!!D.current,hasBookingId:!!c?.booking_id});return()=>{U.cancel()}}),[e,F.startDateTime,F.endDateTime,F.rates.baseRate,F.rates.additionalAnimalRate,F.rates.appliesAfterAnimals,F.rates.holidayRate,F.rates.unit_of_time,F.rates.additionalRates,U,c?.booking_id]),(0,n.useEffect)((()=>{u&&console.log("MBA565656 Rates changed:",F.rates),W(F.rates.unit_of_time)}),[F.rates]),(0,n.useEffect)((()=>{e&&u&&console.log("MBA565656 Modal became visible:",{defaultRates:a,initialOccurrence:i,currentRates:F.rates})}),[e]),(0,n.useEffect)((()=>{u&&console.log("MBA4321 Time settings changed:",f),O((e=>Object.assign({},e,{isMilitary:f.use_military_time})))}),[f]),(0,n.useEffect)((()=>{if(i){u&&(console.log("MBA4321 Initial occurrence rates:",i.rates),console.log("MBA4321 Initial unit_of_time:",i.rates?.unit_of_time));const e=z(i),t=i.rates?.unit_of_time;u&&console.log("MBA4321 Setting unit_of_time to:",t),O((o=>Object.assign({},o,{startDateTime:e.startDateTime,endDateTime:e.endDateTime,isMilitary:e.isMilitary,rates:Object.assign({},i.rates,{unit_of_time:t})}))),W(t)}}),[i]);const[V,Y]=(0,n.useState)(!1),[G,J]=(0,n.useState)({name:"",amount:""});(0,n.useEffect)((()=>{u&&(console.log("MBA1234 Initial occurrence:",i),console.log("MBA1234 Unit of time set to:",E))}),[E,i]),(0,n.useEffect)((()=>{u&&console.log("MBA4321 Unit of time changed:",{newUnitOfTime:E,occurrenceRatesUnitOfTime:F.rates.unit_of_time}),O((e=>Object.assign({},e,{rates:Object.assign({},e.rates,{unit_of_time:E})})))}),[E]);const $=()=>{Z(),t()},Z=()=>{O({startDateTime:new Date,endDateTime:new Date((new Date).setHours((new Date).getHours()+1)),isMilitary:f.use_military_time,rates:{baseRate:a?.base_rate?.toString()||"0",additionalAnimalRate:a?.additional_animal_rate?.toString()||"0",appliesAfterAnimals:a?.applies_after?.toString()||"1",holidayRate:a?.holiday_rate?.toString()||"0",unit_of_time:a?.unit_of_time||"Per Visit",additionalRates:a?.additional_rates?.map((e=>({name:e.title,description:e.description||"",amount:e.amount})))||[]},calculatedCost:"0"}),W(a?.unit_of_time||"Per Visit"),Y(!1),J({name:"",amount:""})};return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(A.default,{visible:e,onRequestClose:$,animationType:"slide",transparent:!0,children:(0,T.jsx)(x.default,{style:fn.modalContainer,children:(0,T.jsxs)(w.default.View,{style:[fn.modalContent,d?{maxHeight:void 0,height:B.interpolate({inputRange:[0,1],outputRange:["325px","650px"]}),transform:[{translateY:B.interpolate({inputRange:[0,1],outputRange:[0,-40]})}]}:{maxHeight:"80%"}],children:[(0,T.jsxs)(x.default,{style:fn.modalHeader,children:[(0,T.jsx)(C.default,{style:fn.modalTitle,children:l}),(0,T.jsx)(v.default,{onPress:$,children:(0,T.jsx)(S.default,{name:"close",size:24,color:m.theme.colors.text})})]}),(0,T.jsxs)(H.default,{style:fn.scrollView,contentContainerStyle:[fn.scrollViewContent,d&&b&&{paddingBottom:300}],children:[(0,T.jsxs)(x.default,{style:[fn.section,{zIndex:10}],children:[(0,T.jsx)(C.default,{style:fn.label,children:"Start Date & Time"}),(0,T.jsx)(un,{value:F.startDateTime,onChange:e=>{u&&console.log("MBA1234 Start datetime changed:",{newDate:e?.toISOString(),currentInitialValues:D.current,currentOccurrence:{startDateTime:F.startDateTime.toISOString(),endDateTime:F.endDateTime.toISOString()}}),e&&!isNaN(e.getTime())&&O((t=>{const o=Object.assign({},t,{startDateTime:e});return u&&console.log("MBA1234 Updated occurrence:",{startDateTime:o.startDateTime.toISOString(),endDateTime:o.endDateTime.toISOString()}),o}))},error:k?.startDateTime,isMilitary:F.isMilitary,onPickerStateChange:N})]}),(0,T.jsxs)(x.default,{style:[fn.section,{zIndex:9}],children:[(0,T.jsx)(C.default,{style:fn.label,children:"End Date & Time"}),(0,T.jsx)(un,{value:F.endDateTime,onChange:e=>{u&&console.log("MBA1234 End datetime changed:",{newDate:e?.toISOString(),currentInitialValues:D.current,currentOccurrence:{startDateTime:F.startDateTime.toISOString(),endDateTime:F.endDateTime.toISOString()}}),e&&!isNaN(e.getTime())&&O((t=>{const o=Object.assign({},t,{endDateTime:e});return u&&console.log("MBA1234 Updated occurrence:",{startDateTime:o.startDateTime.toISOString(),endDateTime:o.endDateTime.toISOString()}),o}))},error:k?.endDateTime,isMilitary:F.isMilitary,onPickerStateChange:N})]}),!r&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)(x.default,{style:[fn.section,{zIndex:8}],children:[(0,T.jsx)(C.default,{style:fn.label,children:"Base Rate"}),(0,T.jsxs)(x.default,{style:fn.rateContainer,children:[(0,T.jsx)(x.default,{style:fn.baseRateInput,children:(0,T.jsx)(q.default,{style:fn.input,value:F.rates.baseRate.toString(),onChangeText:e=>O((t=>Object.assign({},t,{rates:Object.assign({},t.rates,{baseRate:e.replace(/[^0-9.]/g,"")})}))),keyboardType:"decimal-pad",placeholder:"0.00"})}),(0,T.jsxs)(x.default,{style:fn.timeUnitInput,children:[(0,T.jsx)(C.default,{style:fn.label,children:"Per"}),(0,T.jsx)(Pe.default,{selectedValue:E,onValueChange:e=>{u&&console.log("MBA4321 Picker value changed to:",e),W(e),O((t=>Object.assign({},t,{rates:Object.assign({},t.rates,{unit_of_time:e})})))},style:fn.picker,children:(K=ce,K.map((e=>(0,T.jsx)(Pe.default.Item,{label:e,value:e,style:fn.pickerItem},e))))})]})]})]}),(0,T.jsxs)(x.default,{style:[fn.section,{zIndex:7}],children:[(0,T.jsx)(C.default,{style:fn.label,children:h<375?"+".concat(F.rates.appliesAfterAnimals," Pet Rate"):"Additional Pet Rate"}),(0,T.jsxs)(x.default,{style:fn.rateContainer,children:[(0,T.jsx)(x.default,{style:fn.baseRateInput,children:(0,T.jsx)(q.default,{style:fn.input,value:F.rates.additionalAnimalRate.toString(),onChangeText:e=>O((t=>Object.assign({},t,{rates:Object.assign({},t.rates,{additionalAnimalRate:e.replace(/[^0-9.]/g,"")})}))),keyboardType:"decimal-pad",placeholder:"0.00"})}),(0,T.jsxs)(x.default,{style:fn.timeUnitInput,children:[(0,T.jsx)(C.default,{style:fn.label,children:"Applies After"}),(0,T.jsx)(Pe.default,{selectedValue:F.rates.appliesAfterAnimals,onValueChange:e=>O((t=>Object.assign({},t,{rates:Object.assign({},t.rates,{appliesAfterAnimals:e})}))),style:fn.picker,children:hn.map((e=>(0,T.jsx)(Pe.default.Item,{label:"".concat(e," animal").concat("1"===e?"":"s"),value:e},e)))})]})]})]}),(0,T.jsxs)(x.default,{style:[fn.section,{zIndex:6}],children:[(0,T.jsx)(C.default,{style:fn.label,children:"Holiday Rate"}),(0,T.jsx)(x.default,{style:fn.rateContainer,children:(0,T.jsx)(x.default,{style:fn.baseRateInput,children:(0,T.jsx)(q.default,{style:fn.input,value:F.rates.holidayRate.toString(),onChangeText:e=>O((t=>Object.assign({},t,{rates:Object.assign({},t.rates,{holidayRate:e.replace(/[^0-9.]/g,"")})}))),keyboardType:"decimal-pad",placeholder:"0.00"})})})]}),(0,T.jsxs)(x.default,{style:[fn.section,{zIndex:5}],children:[(0,T.jsx)(C.default,{style:fn.label,children:"Additional Rates"}),F.rates.additionalRates.map(((e,t)=>(0,T.jsxs)(x.default,{style:[fn.rateRow,{marginBottom:10}],children:[(0,T.jsx)(q.default,{style:[fn.input,fn.rateInput],value:e.name,editable:!1}),(0,T.jsx)(x.default,{style:[fn.rateAmountContainer],children:(0,T.jsx)(q.default,{style:[fn.input,fn.rateAmountInput],value:e.amount.toString(),editable:!1})}),(0,T.jsx)(v.default,{onPress:()=>(e=>{O((t=>Object.assign({},t,{rates:Object.assign({},t.rates,{additionalRates:t.rates.additionalRates.filter(((t,o)=>o!==e))})})))})(t),children:(0,T.jsx)(S.default,{name:"close",size:24,color:m.theme.colors.error})})]},t))),V?(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)(x.default,{style:fn.rateLabelContainer,children:[(0,T.jsx)(C.default,{style:fn.rateTitleLabel,children:"Rate Title"}),(0,T.jsx)(C.default,{style:fn.rateAmountLabel,children:"Rate Amount"})]}),(0,T.jsxs)(x.default,{style:fn.rateRow,children:[(0,T.jsx)(q.default,{style:[fn.input,fn.rateInput],value:G.name,onChangeText:e=>J((t=>Object.assign({},t,{name:e}))),placeholder:"Rate Title"}),(0,T.jsx)(x.default,{style:[fn.rateAmountContainer],children:(0,T.jsx)(q.default,{style:[fn.input,fn.rateAmountInput],value:G.amount,onChangeText:e=>J((t=>Object.assign({},t,{amount:e.replace(/[^0-9.]/g,"")}))),keyboardType:"decimal-pad",placeholder:"0.00"})}),(0,T.jsx)(v.default,{onPress:()=>handleAddRate(),children:(0,T.jsx)(S.default,{name:"plus",size:24,color:m.theme.colors.primary})})]})]}):(0,T.jsx)(v.default,{style:fn.addRateButton,onPress:()=>Y(!0),children:(0,T.jsx)(C.default,{style:fn.addRateButtonText,children:"Add custom rate"})})]}),(0,T.jsxs)(x.default,{style:fn.totalSection,children:[(0,T.jsx)(C.default,{style:fn.totalLabel,children:"Total:"}),R?(0,T.jsx)(x.default,{style:fn.loadingContainer,children:(0,T.jsx)(_.default,{size:"small",color:m.theme.colors.primary})}):(0,T.jsxs)(C.default,{style:fn.totalAmount,children:["$",parseFloat(F.calculatedCost).toFixed(2)]})]})]})]}),(0,T.jsxs)(x.default,{style:fn.buttonContainer,children:[(0,T.jsx)(Re.default,{mode:"outlined",onPress:()=>{y(!0)},style:[fn.button,{borderColor:m.theme.colors.error}],textColor:m.theme.colors.error,children:"Delete"}),(0,T.jsx)(Re.default,{mode:"contained",onPress:()=>{const e=mn((0,Ro.format)(F.startDateTime,"yyyy-MM-dd"),(0,Ro.format)(F.endDateTime,"yyyy-MM-dd"),(0,Ro.format)(F.startDateTime,"HH:mm"),(0,Ro.format)(F.endDateTime,"HH:mm"));e.isValid?(I(null),(async()=>{try{const e=(0,Ro.format)(F.startDateTime,"yyyy-MM-dd"),n=(0,Ro.format)(F.startDateTime,"HH:mm"),a=(0,Ro.format)(F.endDateTime,"yyyy-MM-dd"),r=(0,Ro.format)(F.endDateTime,"HH:mm");u&&console.log("MBA1234 Adding occurrence:",{startDate:e,startTime:n,endDate:a,endTime:r,startDateTime:F.startDateTime.toISOString(),endDateTime:F.endDateTime.toISOString()});const i=await o({startDate:e,startTime:n,endDate:a,endTime:r,rates:F.rates});u&&console.log("MBA1234 Response from onAdd:",i),"success"===i?.status?(u&&console.log("MBA1234 Successfully added/updated occurrence"),Z(),t(),ft.default.alert("Success",i.message)):I(i?.message||"Failed to add event")}catch(e){u&&console.error("MBA1234 Error adding occurrence:",e),I(e.message||"An unexpected error occurred")}})()):I(e.error)},style:fn.button,children:s?"Save Changes":"Add"})]}),k&&(0,T.jsx)(C.default,{style:fn.errorMessage,children:k})]})})}),(0,T.jsx)(M,{visible:p,onClose:()=>y(!1),onConfirm:()=>{y(!1),$()},actionText:"delete this occurrence"})]});var K},yn=r.default.create({modalContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0, 0, 0, 0.5)"},modalContent:{backgroundColor:m.theme.colors.background,borderRadius:8,padding:20,width:"90%",maxWidth:500,maxHeight:"80%"},modalTitle:{fontSize:m.theme.fontSizes.largeLarge,fontWeight:"bold",marginBottom:20,textAlign:"center"},scrollView:{maxHeight:"70%"},label:{fontSize:m.theme.fontSizes.medium,fontWeight:"500",marginTop:15,marginBottom:10},serviceOptions:{flexDirection:"row",flexWrap:"wrap",gap:10},serviceButton:{marginBottom:10},petOptions:{flexDirection:"row",flexWrap:"wrap",gap:10},petButton:{marginBottom:10},dateContainer:{gap:10},timeContainer:{flexDirection:"row",justifyContent:"space-between",gap:10},buttonContainer:{flexDirection:"row",justifyContent:"space-between",marginTop:20,gap:10},button:{flex:1},timePickerWrapper:{flex:1},dropdownContainer:{position:"relative",marginBottom:20,zIndex:3},dropdownInput:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",borderWidth:1,borderColor:m.theme.colors.border,borderRadius:8,padding:12,backgroundColor:m.theme.colors.surface},dropdownList:{position:"absolute",top:"100%",left:0,right:0,backgroundColor:m.theme.colors.surface,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:8,maxHeight:200,zIndex:1e3,elevation:5},dropdownItem:{padding:12,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},dropdownText:{color:m.theme.colors.text},selectedOption:{color:m.theme.colors.primary,fontWeight:"bold"},petItem:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingVertical:12,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},petInfo:{flex:1},petName:{fontSize:m.theme.fontSizes.medium,fontWeight:"500",marginBottom:4},petDetails:{fontSize:m.theme.fontSizes.smallMedium,color:m.theme.colors.placeholder},addPetButton:{flexDirection:"row",alignItems:"center",padding:12,marginTop:8,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:8,justifyContent:"center"},addPetText:{marginLeft:8,color:m.theme.colors.primary,fontSize:m.theme.fontSizes.medium},occurrenceCard:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:15,backgroundColor:m.theme.colors.surface,borderRadius:8,marginBottom:10,borderWidth:1,borderColor:m.theme.colors.border},occurrenceDetails:{flex:1},dateText:{fontSize:m.theme.fontSizes.medium,fontWeight:"500",marginBottom:4},timeText:{fontSize:m.theme.fontSizes.smallMedium,color:m.theme.colors.placeholder},addOccurrenceButton:{flexDirection:"row",alignItems:"center",justifyContent:"center",padding:16,borderWidth:1,borderColor:m.theme.colors.primary,borderRadius:8,marginTop:12},addOccurrenceText:{marginLeft:8,color:m.theme.colors.primary,fontSize:m.theme.fontSizes.medium},occurrenceActions:{flexDirection:"row",alignItems:"center",gap:10},actionButton:{padding:8,borderWidth:1,borderColor:m.theme.colors.error,borderRadius:4},bookingRequestCard:{backgroundColor:m.theme.colors.surface,borderRadius:8,padding:16,margin:8,borderWidth:1,borderColor:m.theme.colors.primary},bookingRequestHeader:{flexDirection:"row",alignItems:"center",marginBottom:12,gap:8},bookingRequestTitle:{fontSize:m.theme.fontSizes.mediumLarge,fontWeight:"bold",color:m.theme.colors.primary},bookingRequestDetails:{gap:8},detailLabel:{fontSize:m.theme.fontSizes.smallMedium,fontWeight:"500",color:m.theme.colors.placeholder},detailText:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text},acceptButton:{backgroundColor:m.theme.colors.primary,padding:12,borderRadius:8,alignItems:"center",marginTop:16},acceptButtonText:{color:m.theme.colors.surface,fontSize:m.theme.fontSizes.medium,fontWeight:"500"},occurrenceCardError:{borderColor:m.theme.colors.error},errorText:{color:m.theme.colors.error,fontSize:m.theme.fontSizes.small,marginTop:4},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:20},errorContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:20}}),bn=({visible:e,onClose:t,onSubmit:o,conversationId:a})=>{const[r,i]=(0,n.useState)(""),{is_DEBUG:s}=(0,n.useContext)(g.AuthContext),[l,d]=(0,n.useState)([]),[c,u]=(0,n.useState)(!1),[h,p]=(0,n.useState)(!1),[y,C]=(0,n.useState)(!1),[w,j]=(0,n.useState)([]),[B,k]=(0,n.useState)(null),[I,D]=(0,n.useState)({visible:!1,actionText:"",onConfirm:null,isLoading:!1}),[R,L]=(0,n.useState)({}),[z,P]=(0,n.useState)([]),[F,O]=(0,n.useState)([]),[E,W]=(0,n.useState)(!0),[N,U]=(0,n.useState)(null);(0,n.useEffect)((()=>{e&&a?V():e||(W(!1),U(null))}),[e,a]);const V=async()=>{try{W(!0),U(null),s&&console.log("Fetching prerequest data for conversation:",a);const e=await(0,g.getStorage)("userToken"),t=await b.default.get("".concat(f.API_BASE_URL,"/api/messages/v1/prerequest_booking/").concat(a,"/"),{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});s&&console.log("Prerequest data response:",t.data),P(t.data.services),O(t.data.pets),s&&(console.log("Updated services:",t.data.services),console.log("Updated pets:",t.data.pets))}catch(e){s&&console.error("Error fetching pre-request data:",e.response||e),U("Failed to load booking data. Please try again.")}finally{W(!1)}},q=()=>{i(""),d([]),j([]),k(null),W(!1),U(null)},G=e=>{D({visible:!0,actionText:"delete this occurrence",onConfirm:()=>(async e=>{D((e=>Object.assign({},e,{isLoading:!0})));try{j((t=>t.filter((t=>t.startDate!==e.startDate||t.startTime!==e.startTime))))}finally{D({visible:!1,actionText:"",onConfirm:null,isLoading:!1})}})(e),isLoading:!1})},J=()=>{q(),t()},$=()=>{u(!1),p(!1),C(!0)};return(0,T.jsxs)(A.default,{visible:e,onRequestClose:J,animationType:"slide",transparent:!0,children:[(0,T.jsx)(x.default,{style:yn.modalContainer,children:(0,T.jsxs)(x.default,{style:yn.modalContent,children:[(0,T.jsx)(Y.default,{style:yn.modalTitle,children:"Request Booking"}),E?(0,T.jsxs)(x.default,{style:yn.loadingContainer,children:[(0,T.jsx)(_.default,{size:"large",color:m.theme.colors.primary}),(0,T.jsx)(Y.default,{children:"Loading booking data..."})]}):N?(0,T.jsxs)(x.default,{style:yn.errorContainer,children:[(0,T.jsx)(Y.default,{style:yn.errorText,children:N}),(0,T.jsx)(Re.default,{mode:"contained",onPress:V,children:"Retry"})]}):(0,T.jsxs)(H.default,{style:yn.scrollView,children:[(0,T.jsx)(Y.default,{style:yn.label,children:"Select Service"}),(0,T.jsxs)(x.default,{style:yn.dropdownContainer,children:[(0,T.jsxs)(v.default,{style:yn.dropdownInput,onPress:()=>u(!c),children:[(0,T.jsx)(Y.default,{children:r||"Select Service Type"}),(0,T.jsx)(S.default,{name:c?"chevron-up":"chevron-down",size:24,color:m.theme.colors.text})]}),c&&(0,T.jsx)(x.default,{style:yn.dropdownList,children:(0,T.jsx)(H.default,{nestedScrollEnabled:!0,children:z.map((e=>(0,T.jsx)(v.default,{style:yn.dropdownItem,onPress:()=>{i(e.service_name),u(!1)},children:(0,T.jsx)(Y.default,{style:[yn.dropdownText,r===e.service_name&&yn.selectedOption],children:e.service_name})},e.service_id)))})})]}),(0,T.jsx)(Y.default,{style:yn.label,children:"Select Pets"}),(0,T.jsxs)(x.default,{style:{zIndex:2},children:[l.map((e=>{const t=F.find((t=>t.pet_id===e));return(0,T.jsxs)(x.default,{style:yn.petItem,children:[(0,T.jsxs)(x.default,{style:yn.petInfo,children:[(0,T.jsx)(Y.default,{style:yn.petName,children:t.name}),(0,T.jsxs)(Y.default,{style:yn.petDetails,children:[t.pet_type," \u2022 ",t.breed]})]}),(0,T.jsx)(v.default,{onPress:()=>d((t=>t.filter((t=>t!==e)))),children:(0,T.jsx)(S.default,{name:"close",size:24,color:m.theme.colors.error})})]},e)})),(0,T.jsxs)(v.default,{style:yn.addPetButton,onPress:()=>p(!h),children:[(0,T.jsx)(S.default,{name:h?"chevron-up":"chevron-down",size:20,color:m.theme.colors.primary}),(0,T.jsx)(Y.default,{style:yn.addPetText,children:0===l.length?"Select Pets":"Add Pet"})]}),h&&(0,T.jsx)(x.default,{style:yn.dropdownList,children:(0,T.jsx)(H.default,{nestedScrollEnabled:!0,style:yn.petDropdown,children:F.filter((e=>!l.includes(e.pet_id))).map((e=>(0,T.jsx)(v.default,{style:yn.dropdownItem,onPress:()=>{d((t=>[...t,e.pet_id])),p(!1)},children:(0,T.jsxs)(x.default,{children:[(0,T.jsx)(Y.default,{style:yn.dropdownPetName,children:e.name}),(0,T.jsxs)(Y.default,{style:yn.dropdownPetDetails,children:[e.pet_type," \u2022 ",e.breed]})]})},e.pet_id)))})})]}),(0,T.jsx)(Y.default,{style:yn.label,children:"Select Date & Time"}),w.map(((e,t)=>((e,t)=>(0,T.jsx)(x.default,{children:(0,T.jsxs)(v.default,{style:[yn.occurrenceCard,R[t]&&yn.occurrenceCardError],children:[(0,T.jsxs)(x.default,{style:yn.occurrenceDetails,children:[(0,T.jsx)(Y.default,{style:yn.dateText,children:e.endDate&&e.startDate!==e.endDate?"".concat(e.startDate," - ").concat(e.endDate):e.startDate}),(0,T.jsx)(Y.default,{style:yn.timeText,children:"".concat(e.startTime," - ").concat(e.endTime)}),R[t]&&(0,T.jsx)(Y.default,{style:yn.errorText,children:R[t]})]}),(0,T.jsxs)(x.default,{style:yn.occurrenceActions,children:[(0,T.jsx)(v.default,{style:yn.actionButton,onPress:()=>G(e),children:(0,T.jsx)(S.default,{name:"trash-can-outline",size:20,color:m.theme.colors.error})}),(0,T.jsx)(v.default,{style:yn.actionButton,onPress:()=>{k(e),$()},children:(0,T.jsx)(S.default,{name:"pencil",size:20,color:m.theme.colors.primary})})]})]})},t))(e,t))),(0,T.jsxs)(v.default,{style:yn.addOccurrenceButton,onPress:()=>{k(null),$()},children:[(0,T.jsx)(S.default,{name:"plus",size:24,color:m.theme.colors.primary}),(0,T.jsx)(Y.default,{style:yn.addOccurrenceText,children:"Add Date & Time"})]})]}),(0,T.jsxs)(x.default,{style:yn.buttonContainer,children:[(0,T.jsx)(Re.default,{mode:"outlined",onPress:J,style:yn.button,children:"Cancel"}),(0,T.jsx)(Re.default,{mode:"contained",onPress:()=>{if(0===w.length)return;if(!(e=>{const t={};let o=!0;return e.forEach(((e,n)=>{const a=mn(e.startDate,e.endDate,e.startTime,e.endTime);a.isValid||(t[n]=a.error,o=!1)})),L(t),o})(w))return;const e=z.find((e=>e.service_name===r));if(!e)return void U("Please select a valid service");const n={conversation_id:a,service_type:e.service_id,pets:l,occurrences:w.map((e=>({start_date:e.startDate,end_date:e.endDate||e.startDate,start_time:e.startTime,end_time:e.endTime})))};s&&console.log("Sending booking data:",JSON.stringify(n,null,2)),W(!0),U(null),o(n).then((()=>{q(),t()})).catch((e=>{const t=e.response?.data?.error||"Failed to create booking request";U(t)})).finally((()=>{W(!1)}))},style:yn.button,disabled:!r||0===l.length||0===w.length||E,children:"Submit"})]})]})}),(0,T.jsx)(pn,{visible:y,onClose:()=>C(!1),onAdd:e=>{const{startDate:t,endDate:o,startTime:n,endTime:a}=e;return!!mn(t,o,n,a).isValid&&(j(B?e=>e.map((e=>e===B?{startDate:t,endDate:o,startTime:n,endTime:a}:e)):e=>[...e,{startDate:t,endDate:o,startTime:n,endTime:a}]),k(null),C(!1),!0)},hideRates:!0,initialOccurrence:B,modalTitle:B?"Edit Occurrence":"Add New Occurrence",isFromRequestBooking:!0}),(0,T.jsx)(M,{visible:I.visible,actionText:I.actionText,onClose:()=>{I.isLoading||D({visible:!1,actionText:"",onConfirm:null,isLoading:!1})},onConfirm:I.onConfirm,isLoading:I.isLoading})]})},xn=r.default.create({container:{flex:1,backgroundColor:m.theme.colors.background},section:{padding:16},sectionTitle:{fontSize:"web"===a.default.OS?18:14,fontFamily:m.theme.fonts.header.fontFamily,marginBottom:16,color:m.theme.colors.text},servicesGrid:{flexDirection:"row",flexWrap:"wrap",gap:12,justifyContent:"flex-start",width:"100%"},serviceCard:{width:"31%",minWidth:100,maxWidth:150,aspectRatio:1.2,backgroundColor:m.theme.colors.surface,borderRadius:12,padding:12,alignItems:"center",justifyContent:"center",borderWidth:1,borderColor:m.theme.colors.border,marginBottom:8},selectedServiceCard:{backgroundColor:"".concat(m.theme.colors.mainColors.main,"10"),borderColor:m.theme.colors.mainColors.main},serviceText:{marginTop:8,fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,textAlign:"center",width:"100%"},selectedServiceText:{color:m.theme.colors.mainColors.main,fontWeight:"600"},petsContainer:{gap:12,flexDirection:"row",flexWrap:"wrap",justifyContent:"flex-start"},petCard:{flexDirection:"row",alignItems:"center",backgroundColor:m.theme.colors.surface,borderRadius:12,padding:12,borderWidth:1,borderColor:m.theme.colors.border,width:"web"===a.default.OS?"calc(50% - 6px)":"100%",minWidth:"web"===a.default.OS?250:"auto",maxWidth:"web"===a.default.OS?400:"100%"},selectedPetCard:{backgroundColor:"".concat(m.theme.colors.mainColors.main,"10"),borderColor:m.theme.colors.mainColors.main},petImageContainer:{marginRight:12},petImage:{width:48,height:48,borderRadius:24},defaultPetImage:{width:48,height:48,borderRadius:24,backgroundColor:m.theme.colors.surface,alignItems:"center",justifyContent:"center",borderWidth:1,borderColor:m.theme.colors.border},petInfo:{flex:1},petName:{fontSize:16,fontFamily:m.theme.fonts.regular.fontFamily,marginBottom:4,color:m.theme.colors.text},petDetails:{fontSize:14,color:m.theme.colors.placeHolderText,fontFamily:m.theme.fonts.regular.fontFamily},checkIcon:{marginLeft:12},selectedItemsContainer:{backgroundColor:"rgba(0, 0, 0, 0.03)",padding:16,borderRadius:8},selectedItemsTitle:{fontSize:"web"===a.default.OS?14:10,fontFamily:m.theme.fonts.header.fontFamily,marginBottom:16,color:m.theme.colors.text},selectedItemsContent:{flexDirection:"row",flexWrap:"wrap",gap:8},selectedTag:{flexDirection:"row",alignItems:"center",backgroundColor:"".concat(m.theme.colors.mainColors.main,"10"),borderRadius:20,paddingVertical:6,paddingHorizontal:12,gap:8},selectedTagText:{color:m.theme.colors.mainColors.main,fontSize:14,fontFamily:m.theme.fonts.regular.fontFamily},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:20},errorContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:20},errorText:{color:m.theme.colors.error,textAlign:"center",fontFamily:m.theme.fonts.regular.fontFamily},serviceCheckIcon:{position:"absolute",top:8,right:8},createServiceButton:{backgroundColor:m.theme.colors.mainColors.main,padding:16,borderRadius:8,alignItems:"center"},createServiceButtonText:{color:m.theme.colors.surface,fontSize:16,fontFamily:m.theme.fonts.regular.fontFamily}}),Cn=({bookingId:e,onServiceSelect:t,onPetSelect:a,selectedService:r,selectedPets:i,isLoading:s,error:l,onNext:d,currentBookingId:c,navigation:h,onClose:f})=>{const{is_DEBUG:p}=(0,n.useContext)(g.AuthContext),[y,b]=(0,n.useState)([]),[w,j]=(0,n.useState)([]),[B,k]=(0,n.useState)(!1),[A,I]=(0,n.useState)(!1),[M,D]=(0,n.useState)(null),[R,L]=(0,n.useState)(null);(0,n.useEffect)((()=>{e&&(z(),P())}),[e]);const z=async()=>{try{k(!0),D(null);const o=await(0,Ze.getBookingAvailableServices)(e);if(p&&console.log("MBA12345 Available services response:",o),b(o.services),o.selected_service_id&&!r){const e=o.services.find((e=>e.service_id===o.selected_service_id));e&&t(Object.assign({},e,{isOvernightForced:e.is_overnight}))}}catch(l){p&&console.error("MBA12345 Error fetching services:",l),D("Failed to load available services")}finally{k(!1)}},P=async()=>{try{I(!0),L(null);const t=await(0,Ze.getBookingAvailablePets)(e);if(p&&console.log("MBA12345 Available pets response:",t),j(t.pets),t.selected_pet_ids&&t.selected_pet_ids.length>0&&0===i.length){t.pets.filter((e=>t.selected_pet_ids.includes(e.pet_id))).forEach((e=>a(e)))}}catch(l){p&&console.error("MBA12345 Error fetching pets:",l),L("Failed to load available pets")}finally{I(!1)}},F=e=>{switch(e.toLowerCase()){case"dog walking":default:return"paw";case"house sitting":return"home";case"drop-in visits":return"food-variant";case"boarding":return"home-city"}};return s?(0,T.jsx)(x.default,{style:xn.loadingContainer,children:(0,T.jsx)(_.default,{size:"large",color:m.theme.colors.mainColors.main})}):l?(0,T.jsx)(x.default,{style:xn.errorContainer,children:(0,T.jsx)(C.default,{style:xn.errorText,children:l})}):(0,T.jsxs)(H.default,{style:xn.container,children:[(0,T.jsxs)(x.default,{style:xn.section,children:[(0,T.jsx)(C.default,{style:xn.sectionTitle,children:"Select Service"}),M?(0,T.jsx)(C.default,{style:xn.errorText,children:M}):B?(0,T.jsx)(_.default,{size:"small",color:m.theme.colors.mainColors.main}):y.length>0?(0,T.jsx)(x.default,{style:xn.servicesGrid,children:y.map((e=>(e=>{const o=r?.service_id===e.service_id;return(0,T.jsxs)(v.default,{style:[xn.serviceCard,o&&xn.selectedServiceCard],onPress:()=>t(Object.assign({},e,{isOvernightForced:e.is_overnight})),children:[(0,T.jsx)(S.default,{name:F(e.service_name),size:24,color:o?m.theme.colors.mainColors.main:m.theme.colors.text}),(0,T.jsx)(C.default,{style:[xn.serviceText,o&&xn.selectedServiceText],children:e.service_name}),o&&(0,T.jsx)(S.default,{name:"check",size:24,color:m.theme.colors.mainColors.main,style:xn.serviceCheckIcon})]},e.service_id)})(e)))}):(0,T.jsxs)(x.default,{style:xn.noServicesContainer,children:[(0,T.jsx)(C.default,{style:xn.errorText,children:"No services available. Please add services to create a booking."}),(0,T.jsx)(v.default,{style:xn.createServiceButton,onPress:()=>{f(),(0,u.navigateToFrom)(h,"ServiceManager","MessageHistory")},children:(0,T.jsx)(C.default,{style:xn.createServiceButtonText,children:"Create Services"})})]})]}),(0,T.jsxs)(x.default,{style:xn.section,children:[(0,T.jsx)(C.default,{style:xn.sectionTitle,children:"Select Pets"}),R?(0,T.jsx)(C.default,{style:xn.errorText,children:R}):A?(0,T.jsx)(_.default,{size:"small",color:m.theme.colors.mainColors.main}):w.length>0?(0,T.jsx)(x.default,{style:xn.petsContainer,children:w.map((e=>(e=>{const t=i.some((t=>t.pet_id===e.pet_id));return(0,T.jsxs)(v.default,{style:[xn.petCard,t&&xn.selectedPetCard],onPress:()=>a(e),children:[(0,T.jsx)(x.default,{style:xn.petImageContainer,children:e.image_url?(0,T.jsx)(U.default,{source:{uri:e.image_url},style:xn.petImage,defaultSource:o(65460)}):(0,T.jsx)(x.default,{style:xn.defaultPetImage,children:(0,T.jsx)(S.default,{name:"paw",size:24,color:m.theme.colors.placeHolderText})})}),(0,T.jsxs)(x.default,{style:xn.petInfo,children:[(0,T.jsx)(C.default,{style:xn.petName,children:e.name}),(0,T.jsxs)(C.default,{style:xn.petDetails,children:[e.breed," \u2022 ",e.age," years"]})]}),t&&(0,T.jsx)(S.default,{name:"check",size:24,color:m.theme.colors.mainColors.main,style:xn.checkIcon})]},e.pet_id)})(e)))}):(0,T.jsx)(C.default,{style:xn.errorText,children:"Please instruct client to add pets to their account so you can create a booking for their pets."})]})]})},{width:vn,height:wn}=j.default.get("window"),jn=.4*wn,Sn=vn>480,Tn=r.default.create({container:{flex:1,backgroundColor:m.theme.colors.background,padding:12,minHeight:Sn?600:"auto"},bookingTypeContainer:{flexDirection:"row",marginBottom:12,borderRadius:8,overflow:"hidden"},bookingTypeButton:{flex:1,paddingVertical:12,alignItems:"center",justifyContent:"center",backgroundColor:"#e8e8e8"},selectedBookingTypeButton:{backgroundColor:m.theme.colors.mainColors.main},bookingTypeText:{fontSize:16,fontFamily:m.theme.fonts.regular.fontFamily,color:m.theme.colors.text},selectedBookingTypeText:{color:m.theme.colors.surface,fontWeight:"600"},dateRangeTypeContainer:{flexDirection:"row",marginBottom:12,borderRadius:8,overflow:"hidden"},dateRangeTypeButton:{flex:1,paddingVertical:12,alignItems:"center",justifyContent:"center",backgroundColor:"#e8e8e8"},selectedDateRangeTypeButton:{backgroundColor:m.theme.colors.mainColors.main},dateRangeTypeText:{fontSize:16,fontFamily:m.theme.fonts.regular.fontFamily,color:m.theme.colors.text},selectedDateRangeTypeText:{color:m.theme.colors.surface,fontWeight:"600"},calendarContainer:{backgroundColor:m.theme.colors.surface,borderRadius:8,padding:12,marginBottom:12,maxHeight:Sn?vn>700?600:500:jn,overflow:"visible",minHeight:Sn?vn>700?500:400:350,display:"flex",flexDirection:"column"},calendarHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:8},calendarTitle:{fontSize:16,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"600",color:m.theme.colors.text},calendarNavButton:{padding:6},calendarNavButtonText:{fontSize:18,color:m.theme.colors.text},weekdaysContainer:{flexDirection:"row",justifyContent:"space-around",marginBottom:Sn?8:4,paddingHorizontal:4},weekdayText:{flex:1,textAlign:"center",fontSize:12,color:m.theme.colors.text,opacity:.7,fontFamily:m.theme.fonts.regular.fontFamily},weekRow:{flexDirection:"row",justifyContent:"space-around",marginBottom:Sn?12:4,minHeight:Sn?vn>700?70:50:40,flex:1,paddingHorizontal:4},dateCell:{flex:1,aspectRatio:1,alignItems:"center",justifyContent:"center",borderRadius:4,padding:Sn?4:2,minHeight:Sn?vn>700?60:40:"auto"},dateText:{fontSize:Sn&&vn>700?16:14,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},otherMonthDate:{opacity:.3},otherMonthDateText:{color:m.theme.colors.placeHolderText},selectedDate:{backgroundColor:m.theme.colors.mainColors.main},dateInRange:{backgroundColor:"".concat(m.theme.colors.mainColors.main,"80")},selectedDateText:{color:m.theme.colors.surface,fontWeight:"600"},selectedDatesContainer:{marginTop:12},selectedDatesTitle:{fontSize:14,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"600",marginBottom:6,color:m.theme.colors.text},selectedDatesList:{flexDirection:"row",flexWrap:"wrap",gap:6},selectedDateChip:{flexDirection:"row",alignItems:"center",backgroundColor:m.theme.colors.backgroundContrast,borderRadius:16,paddingVertical:6,paddingLeft:10,paddingRight:6,marginRight:6,marginBottom:6},selectedDateChipText:{color:m.theme.colors.mainColors.main,fontFamily:m.theme.fonts.regular.fontFamily,fontSize:12,marginRight:2},removeButton:{marginLeft:4,padding:2},removeButtonText:{fontSize:16,color:m.theme.colors.mainColors.main,fontWeight:"bold"},dateRangeText:{fontSize:14,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,marginBottom:8},recurringOptionsContainer:{marginTop:8},sectionTitle:{fontSize:16,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"600",marginBottom:8,color:m.theme.colors.text},daysOfWeekContainer:{flexDirection:"row",justifyContent:"space-between",marginBottom:16},dayOfWeekButton:{width:40,height:40,borderRadius:20,alignItems:"center",justifyContent:"center",backgroundColor:"#e8e8e8"},selectedDayOfWeekButton:{backgroundColor:m.theme.colors.mainColors.main},dayOfWeekText:{fontSize:14,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},selectedDayOfWeekText:{color:m.theme.colors.surface,fontWeight:"600"},dateRangeSection:{backgroundColor:m.theme.colors.surface,borderRadius:8,padding:12,marginBottom:16,borderWidth:1,borderColor:m.theme.colors.modernBorder},dateRangeRow:{flexDirection:"row",justifyContent:"space-between"},dateRangeColumn:{flex:1,backgroundColor:m.theme.colors.surface,padding:8,borderRadius:8},dateRangeLabel:{fontSize:14,color:m.theme.colors.text,opacity:.7,marginBottom:4,fontFamily:m.theme.fonts.regular.fontFamily},dateRangeValue:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"600"},frequencyContainer:{flexDirection:"row",marginBottom:16},frequencyButton:{flex:1,paddingVertical:10,paddingHorizontal:8,alignItems:"center",justifyContent:"center",backgroundColor:"#e8e8e8",borderRadius:8,marginRight:8},selectedFrequencyButton:{backgroundColor:m.theme.colors.mainColors.main},frequencyText:{fontSize:14,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},selectedFrequencyText:{color:m.theme.colors.surface,fontWeight:"600"},recurrencePatternContainer:{backgroundColor:m.theme.colors.backgroundContrast,borderRadius:8,padding:12,marginBottom:16},recurrencePatternTitle:{fontSize:14,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"600",marginBottom:4,color:m.theme.colors.text},recurrencePatternText:{fontSize:14,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,marginBottom:2},modalOverlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center"},modalContent:{backgroundColor:m.theme.colors.surface,borderRadius:12,padding:16,width:"90%",maxWidth:400},modalTitle:{fontSize:18,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"600",marginBottom:16,textAlign:"center",color:m.theme.colors.text},modalCloseButton:{marginTop:16,paddingVertical:12,alignItems:"center",backgroundColor:m.theme.colors.backgroundContrast,borderRadius:8},modalCloseButtonText:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},previewButton:{marginTop:8,paddingVertical:8,paddingHorizontal:12,backgroundColor:m.theme.colors.mainColors.main,borderRadius:8,alignSelf:"flex-start"},previewButtonText:{color:m.theme.colors.surface,fontSize:14,fontFamily:m.theme.fonts.regular.fontFamily},previewModalContent:{maxHeight:"80%"},previewCalendarContainer:{backgroundColor:m.theme.colors.surface,borderRadius:8,padding:12,marginVertical:16},recurringDate:{backgroundColor:m.theme.colors.mainColors.main},recurringDateText:{color:m.theme.colors.surface,fontWeight:"600"},previewDateCell:{flex:1,aspectRatio:1,alignItems:"center",justifyContent:"center",borderRadius:4,padding:2},dateRangeChip:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",backgroundColor:m.theme.colors.backgroundContrast,borderRadius:16,paddingVertical:8,paddingLeft:12,paddingRight:8},removeRangeButton:{marginLeft:8,padding:4},selectedDateChip:{flexDirection:"row",alignItems:"center",backgroundColor:m.theme.colors.backgroundContrast,borderRadius:16,paddingVertical:6,paddingLeft:10,paddingRight:6,marginRight:6,marginBottom:6},removeButton:{marginLeft:4,padding:2},removeButtonText:{fontSize:16,color:m.theme.colors.mainColors.main,fontWeight:"bold"},oneTimeOptionsContainer:{marginTop:8},dateSelectionTitle:{color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"600",marginBottom:16,paddingHorizontal:4}}),Bn=({selectedDates:e=[],onDateSelect:t,bookingType:o="one-time",dateRangeType:a="date-range",initialDateRange:r=null,isOvernightForced:i=!1})=>{const{is_DEBUG:s,screenWidth:l}=(0,n.useContext)(g.AuthContext),[d,c]=(0,n.useState)(new Date),[u,m]=(0,n.useState)(e),[h,f]=(0,n.useState)(i?"one-time":o),[p,y]=(0,n.useState)("date-range"),[b,w]=(0,n.useState)(r?r.startDate:null),[j,S]=(0,n.useState)([1,3]),[B,k]=(0,n.useState)("weekly"),[_,I]=(0,n.useState)(r?r.endDate:null),[M,D]=(0,n.useState)(!1),[R,L]=(0,n.useState)(new Date),[z,P]=(0,n.useState)((()=>{const e=new Date;return e.setMonth(e.getMonth()+1),e})),[F,O]=(0,n.useState)(!0),[E,W]=(0,n.useState)(!1),[N,U]=(0,n.useState)(!1),[V,q]=(0,n.useState)(null),[Y,G]=(0,n.useState)(null),[J,$]=(0,n.useState)(!1),[Z,K]=(0,n.useState)(null);(0,n.useEffect)((()=>{if((0,g.debugLog)("MBA54321 DateSelectionCard initialized with dates:",e),(0,g.debugLog)("MBA54321 Current booking type:",o),(0,g.debugLog)("MBA54321 Current date range type:",a),(0,g.debugLog)("MBA54321 Initial date range:",r),(0,g.debugLog)("MBA54321 isOvernightForced:",i),f(i?"one-time":o),y(i?"date-range":"multiple-days"),e&&e.length>0){const n=e.map((e=>e instanceof Date?e:"object"===typeof e&&e.date?new Date(e.date):new Date(e)));m(n);const r=Q(n);if(("date-range"===a||i)&&n.length>0&&r){const e=[...n].sort(((e,t)=>e-t));w(e[0]),I(e[e.length-1]),$(!0)}else n.length>0&&$(!1);if(t){const e={type:o,dates:n,rangeType:i?"date-range":"multiple-days",isValid:!0};if(("date-range"===a||i)&&n.length>0&&r){const t=[...n].sort(((e,t)=>e-t));e.startDate=t[0],e.endDate=t[t.length-1]}t(e)}}}),[]);const Q=e=>{if(!e||e.length<=1)return!0;const t=[...e].sort(((e,t)=>e-t));for(let o=1;o<t.length;o++){const e=new Date(t[o-1]),n=new Date(t[o]);if(e.setDate(e.getDate()+1),e.getTime()!==n.getTime())return(0,g.debugLog)("MBA54321 Non-consecutive dates found:",{prev:t[o-1].toISOString().split("T")[0],current:t[o].toISOString().split("T")[0]}),!1}return!0};(0,n.useEffect)((()=>{if(r&&r.startDate&&r.endDate&&!J){if(u.length>0&&!Q(u))return(0,g.debugLog)("MBA54321 Non-consecutive dates already loaded, not converting to range"),void(t&&t({type:o,dates:u,rangeType:"multiple-days",isValid:u.length>0}));const e=[],n=new Date(r.startDate),a=new Date(r.endDate);for(;n<=a;)e.push(new Date(n)),n.setDate(n.getDate()+1);m(e),w(new Date(r.startDate)),I(new Date(r.endDate)),$(!0),t&&t({type:o,dates:e,rangeType:"date-range",startDate:new Date(r.startDate),endDate:new Date(r.endDate),isValid:!0})}}),[r,J]);const X=e=>{s&&console.log("MBA54321 Frequency selected:",e),k(e)},ee=()=>{const e=new Date(d);e.setMonth(e.getMonth()-1),c(e)},te=()=>{const e=new Date(d);e.setMonth(e.getMonth()+1),c(e)},oe=e=>u.some((t=>{if(!(t instanceof Date))if("string"===typeof t)t=new Date(t);else{if(!t||"string"!==typeof t.date)return!1;t=new Date(t.date)}return t.getDate()===e.getDate()&&t.getMonth()===e.getMonth()&&t.getFullYear()===e.getFullYear()})),ne=e=>{if(s&&(console.log("MBA19ynkiy34b handleDateRangeSelection - date:",e),console.log("MBA19ynkiy34b handleDateRangeSelection - current state:",{rangeStartDate:b,dateRangeEnd:_,selectedDatesList:u.length})),u.length>1&&!Q(u))return(0,g.debugLog)("MBA19ynkiy34b handleDateRangeSelection - clearing non-consecutive dates for date range"),m([e]),w(e),I(null),$(!1),void(t&&t({type:"one-time",dates:[e],rangeType:"date-range",startDate:e,isValid:!1}));if(u.length>1&&!Q(u))return"multiple-days"!==p&&((0,g.debugLog)("MBA19ynkiy34b Non-consecutive dates exist, forcing multiple-days mode"),y("multiple-days")),void ae(e);if(b)if(_)w(e),m([e]),I(null),K(null),s&&console.log("MBA19ynkiy34b handleDateRangeSelection - resetting selection"),t&&t({type:"one-time",dates:[e],rangeType:"date-range",startDate:e,isValid:!1});else{let o=new Date(b),n=new Date(e);e<b&&(o=new Date(e),n=new Date(b)),I(n);const a=[],r=new Date(o);for(;r<=n;)a.push(new Date(r)),r.setDate(r.getDate()+1);if(m(a),K({startDate:o,endDate:n,dates:a}),t){const e={type:"one-time",dates:a,rangeType:"date-range",startDate:o,endDate:n,isValid:!0};s&&console.log("MBA19ynkiy34b handleDateRangeSelection - complete range selected, sending data:",e),t(e)}}else w(e),m([e]),I(null),K(null),s&&console.log("MBA19ynkiy34b handleDateRangeSelection - first date selected"),t&&t({type:"one-time",dates:[e],rangeType:"date-range",startDate:e,isValid:!1})},ae=e=>{s&&(console.log("MBA19ynkiy34b toggleDateSelection - date:",e),console.log("MBA19ynkiy34b toggleDateSelection - current selected dates:",u.length));let o;if(o=oe(e)?u.filter((t=>{if(!(t instanceof Date))if("string"===typeof t)t=new Date(t);else{if(!t||"string"!==typeof t.date)return!0;t=new Date(t.date)}return!(t.getDate()===e.getDate()&&t.getMonth()===e.getMonth()&&t.getFullYear()===e.getFullYear())})):[...u,e].sort(((e,t)=>e-t)),m(o),t){const e={type:"one-time",dates:o,rangeType:"multiple-days",isValid:o.length>0};s&&(console.log("MBA19ynkiy34b toggleDateSelection - sending data:",e),console.log("MBA19ynkiy34b toggleDateSelection - newSelectedDates length:",o.length)),t(e)}},re=()=>{const e=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],t=j.map((t=>e[t]));if(0===t.length)return"No days selected";let o="";if(1===t.length)o=t[0];else if(2===t.length)o="".concat(t[0]," and ").concat(t[1]);else{const e=t.pop();o="".concat(t.join(", "),", and ").concat(e)}switch(B){case"bi-weekly":return"every other ".concat(o);case"monthly":const e=ie(R);return"the ".concat(e," ").concat(o," of each month");default:return"every ".concat(o)}},ie=e=>{const t=Math.ceil((e.getDate()+(0===e.getDay()?6:e.getDay()-1))/7);return["first","second","third","fourth","last"][Math.min(t-1,4)]},se=()=>{const e=new Date(d.getFullYear(),d.getMonth(),1),o=new Date(d.getFullYear(),d.getMonth()+1,0),n=new Date(e),a=new Date(o);n.setDate(n.getDate()-n.getDay()),a.setDate(a.getDate()+(6-a.getDay()));const r=[];let l=[],c=new Date(n);for(;c<=a;){for(let e=0;e<7;e++)l.push(new Date(c)),c.setDate(c.getDate()+1);r.push(l),l=[]}const u=d.toLocaleString("default",{month:"long"}),m=d.getFullYear();return(0,T.jsxs)(x.default,{style:Tn.calendarContainer,children:[(0,T.jsxs)(x.default,{style:Tn.calendarHeader,children:[(0,T.jsx)(v.default,{onPress:ee,style:Tn.calendarNavButton,children:(0,T.jsx)(C.default,{style:Tn.calendarNavButtonText,children:"<"})}),(0,T.jsx)(C.default,{style:Tn.calendarTitle,children:"".concat(u," ").concat(m)}),(0,T.jsx)(v.default,{onPress:te,style:Tn.calendarNavButton,children:(0,T.jsx)(C.default,{style:Tn.calendarNavButtonText,children:">"})})]}),(0,T.jsx)(x.default,{style:Tn.weekdaysContainer,children:["S","M","T","W","T","F","S"].map(((e,t)=>(0,T.jsx)(C.default,{style:Tn.weekdayText,children:e},"weekday-".concat(t))))}),r.map(((e,o)=>(0,T.jsx)(x.default,{style:Tn.weekRow,children:e.map(((e,n)=>{const a=(e=>{const t=new Date;return t.setHours(0,0,0,0),e.getMonth()<d.getMonth()?e.getMonth()===(d.getMonth()-1+12)%12&&e>=t:e.getMonth()>d.getMonth()?e.getMonth()===(d.getMonth()+1)%12&&e>=t:e>=t})(e),r=oe(e),l="date-range"===p&&(e=>!(!b||!_)&&e>=b&&e<=_)(e),c=N&&(e=>!(!V||!e)&&(Y?e>=V&&e<=Y:e.getTime()===V.getTime()))(e);return(0,T.jsx)(v.default,{style:[Tn.dateCell,!a&&Tn.otherMonthDate,r&&Tn.selectedDate,l&&Tn.dateInRange,c&&Tn.dateInRange],onPress:()=>a&&(N?(e=>{if(s&&(console.log("MBA19ynkiy34b handleRecurringDateSelect - date:",e),console.log("MBA19ynkiy34b handleRecurringDateSelect - current state:",{tempRangeStart:V,selectedDaysOfWeek:j.length,frequency:B})),V){let o=V,n=e;if(e<V&&(o=e,n=V),L(o),P(n),q(null),G(null),U(!1),t){const e={type:"recurring",daysOfWeek:j,frequency:B,startDate:o,endDate:n,isValid:j.length>0};s&&(console.log("MBA19ynkiy34b handleRecurringDateSelect - complete selection, sending data:",e),console.log("MBA19ynkiy34b handleRecurringDateSelect - selectedDaysOfWeek:",j)),t(e)}}else q(e),L(e),s&&console.log("MBA19ynkiy34b handleRecurringDateSelect - first date selected"),t&&t({type:"recurring",startDate:e,daysOfWeek:j,frequency:B,isValid:!1})})(e):(e=>{s&&console.log("MBA54321 Date selected:",e),i||"date-range"===p?ne(e):ae(e)})(e)),disabled:!a,children:(0,T.jsx)(C.default,{style:[Tn.dateText,!a&&Tn.otherMonthDateText,(r||l||c)&&Tn.selectedDateText],children:e.getDate()})},"date-".concat(o,"-").concat(n))}))},"week-".concat(o))))]})},le=e=>{const t=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][e.getMonth()],o=e.getDate(),n=e.getFullYear();return"".concat(t," ").concat(o,", ").concat(n)},de=()=>{s&&console.log("MBA54321 Clearing date range"),m([]),w(null),I(null),$(!1),K(null),t&&t({type:"one-time",dates:[],rangeType:p,startDate:null,endDate:null,isValid:!1})};return(0,n.useEffect)((()=>{s&&console.log("MBA19ynkiy34b Component mounted with:",{selectedDates:e,bookingType:o,dateRangeType:a})}),[]),(0,T.jsxs)(H.default,{style:Tn.container,children:[i||"one-time"===h?(0,T.jsxs)(x.default,{style:Tn.oneTimeOptionsContainer,children:[(0,T.jsx)(C.default,{style:[Tn.dateSelectionTitle,{fontSize:l>768?24:18}],children:i?"Select a date range":"Select one or more dates"}),se(),(()=>{if(0===u.length)return null;if("date-range"===p&&(_||J&&r)){const e=b||r?.startDate||u[0],t=_||r?.endDate||u[u.length-1];return(0,T.jsxs)(x.default,{style:Tn.selectedDatesContainer,children:[(0,T.jsx)(C.default,{style:Tn.selectedDatesTitle,children:"Selected Range:"}),(0,T.jsxs)(x.default,{style:Tn.dateRangeChip,children:[(0,T.jsxs)(C.default,{style:Tn.dateRangeText,children:["From ",le(e)," to ",le(t)]}),(0,T.jsx)(v.default,{onPress:de,style:Tn.removeRangeButton,children:(0,T.jsx)(C.default,{style:Tn.removeButtonText,children:"\xd7"})})]})]})}return(0,T.jsxs)(x.default,{style:Tn.selectedDatesContainer,children:[(0,T.jsx)(C.default,{style:Tn.selectedDatesTitle,children:"Selected Dates:"}),(0,T.jsx)(x.default,{style:Tn.selectedDatesList,children:u.map(((e,t)=>(0,T.jsxs)(x.default,{style:Tn.selectedDateChip,children:[(0,T.jsx)(C.default,{style:Tn.selectedDateChipText,children:le(e)}),(0,T.jsx)(v.default,{onPress:()=>ae(e),style:Tn.removeButton,children:(0,T.jsx)(C.default,{style:Tn.removeButtonText,children:"\xd7"})})]},"selected-date-".concat(t))))})]})})()]}):"recurring"!==h?null:(0,T.jsxs)(x.default,{style:Tn.recurringOptionsContainer,children:[(0,T.jsx)(C.default,{style:Tn.sectionTitle,children:"Repeat on"}),(0,T.jsx)(x.default,{style:Tn.daysOfWeekContainer,children:["M","T","W","T","F","S","S"].map(((e,t)=>{const o=6===t?0:t+1,n=j.includes(o);return(0,T.jsx)(v.default,{style:[Tn.dayOfWeekButton,n&&Tn.selectedDayOfWeekButton],onPress:()=>(e=>{s&&console.log("MBA54321 Day of week toggled:",e),S((t=>t.includes(e)?t.filter((t=>t!==e)):[...t,e]))})(o),children:(0,T.jsx)(C.default,{style:[Tn.dayOfWeekText,n&&Tn.selectedDayOfWeekText],children:e})},"day-".concat(t))}))}),(0,T.jsxs)(x.default,{style:Tn.dateRangeSection,children:[(0,T.jsxs)(x.default,{style:Tn.dateRangeRow,children:[(0,T.jsxs)(v.default,{style:Tn.dateRangeColumn,onPress:()=>U(!0),children:[(0,T.jsx)(C.default,{style:Tn.dateRangeLabel,children:"From"}),(0,T.jsx)(C.default,{style:Tn.dateRangeValue,children:le(R)})]}),(0,T.jsxs)(v.default,{style:Tn.dateRangeColumn,onPress:()=>U(!0),children:[(0,T.jsx)(C.default,{style:Tn.dateRangeLabel,children:"To"}),(0,T.jsx)(C.default,{style:Tn.dateRangeValue,children:le(z)})]})]}),N?(0,T.jsx)(x.default,{style:Tn.dropdownCalendar,children:(0,T.jsxs)(x.default,{style:Tn.dropdownCalendarContent,children:[se(),(0,T.jsx)(v.default,{style:Tn.dropdownCloseButton,onPress:()=>{U(!1),q(null),G(null)},children:(0,T.jsx)(C.default,{style:Tn.dropdownCloseButtonText,children:"Cancel"})})]})}):null]}),(0,T.jsx)(C.default,{style:Tn.sectionTitle,children:"Frequency"}),(0,T.jsxs)(x.default,{style:Tn.frequencyContainer,children:[(0,T.jsx)(v.default,{style:[Tn.frequencyButton,"weekly"===B&&Tn.selectedFrequencyButton],onPress:()=>X("weekly"),children:(0,T.jsx)(C.default,{style:[Tn.frequencyText,"weekly"===B&&Tn.selectedFrequencyText],children:"Weekly"})}),(0,T.jsx)(v.default,{style:[Tn.frequencyButton,"bi-weekly"===B&&Tn.selectedFrequencyButton],onPress:()=>X("bi-weekly"),children:(0,T.jsx)(C.default,{style:[Tn.frequencyText,"bi-weekly"===B&&Tn.selectedFrequencyText],children:"Bi-weekly"})}),(0,T.jsx)(v.default,{style:[Tn.frequencyButton,"monthly"===B&&Tn.selectedFrequencyButton],onPress:()=>X("monthly"),children:(0,T.jsx)(C.default,{style:[Tn.frequencyText,"monthly"===B&&Tn.selectedFrequencyText],children:"Monthly"})})]}),(0,T.jsxs)(x.default,{style:Tn.recurrencePatternContainer,children:[(0,T.jsx)(C.default,{style:Tn.recurrencePatternTitle,children:"Recurrence Pattern:"}),(0,T.jsx)(C.default,{style:Tn.recurrencePatternText,children:re()}),(0,T.jsxs)(C.default,{style:Tn.recurrencePatternText,children:["From ",le(R)," to ",le(z)]}),(0,T.jsx)(v.default,{style:Tn.previewButton,onPress:()=>W(!0),children:(0,T.jsx)(C.default,{style:Tn.previewButtonText,children:"View on Calendar"})})]})]}),(0,T.jsx)((()=>{const[e,t]=(0,n.useState)(new Date(R)),o=()=>{const o=new Date(e);o.setMonth(o.getMonth()-1),t(o)},a=()=>{const o=new Date(e);o.setMonth(o.getMonth()+1),t(o)};return(0,T.jsx)(A.default,{visible:E,transparent:!0,animationType:"fade",onRequestClose:()=>W(!1),children:(0,T.jsx)(x.default,{style:Tn.modalOverlay,children:(0,T.jsxs)(x.default,{style:[Tn.modalContent,Tn.previewModalContent],children:[(0,T.jsx)(C.default,{style:Tn.modalTitle,children:"Recurring Dates Preview"}),(()=>{const t=new Date(e.getFullYear(),e.getMonth(),1),n=new Date(e.getFullYear(),e.getMonth()+1,0),r=new Date(t),i=new Date(n);r.setDate(r.getDate()-r.getDay()),i.setDate(i.getDate()+(6-i.getDay()));const s=[];let l=[],d=new Date(r);const c=(()=>{if(!R||!z||0===j.length)return new Set;const e=new Set,t=new Date(R),o=new Date(z);for(;t<=o;)j.includes(t.getDay())&&("weekly"===B?e.add(new Date(t).getTime()):"bi-weekly"===B?Math.floor((t-R)/6048e5)%2===0&&e.add(new Date(t).getTime()):"monthly"===B&&ie(R)===ie(t)&&e.add(new Date(t).getTime())),t.setDate(t.getDate()+1);return e})();for(;d<=i;){for(let e=0;e<7;e++)l.push(new Date(d)),d.setDate(d.getDate()+1);s.push(l),l=[]}const u=e.toLocaleString("default",{month:"long"}),m=e.getFullYear();return(0,T.jsxs)(x.default,{style:Tn.previewCalendarContainer,children:[(0,T.jsxs)(x.default,{style:Tn.calendarHeader,children:[(0,T.jsx)(v.default,{onPress:o,style:Tn.calendarNavButton,children:(0,T.jsx)(C.default,{style:Tn.calendarNavButtonText,children:"<"})}),(0,T.jsx)(C.default,{style:Tn.calendarTitle,children:"".concat(u," ").concat(m)}),(0,T.jsx)(v.default,{onPress:a,style:Tn.calendarNavButton,children:(0,T.jsx)(C.default,{style:Tn.calendarNavButtonText,children:">"})})]}),(0,T.jsx)(x.default,{style:Tn.weekdaysContainer,children:["S","M","T","W","T","F","S"].map(((e,t)=>(0,T.jsx)(C.default,{style:Tn.weekdayText,children:e},"weekday-".concat(t))))}),s.map(((t,o)=>(0,T.jsx)(x.default,{style:Tn.weekRow,children:t.map(((t,n)=>{const a=t.getMonth()===e.getMonth(),r=c.has(t.getTime());return(0,T.jsx)(x.default,{style:[Tn.previewDateCell,!a&&Tn.otherMonthDate,r&&Tn.recurringDate],children:(0,T.jsx)(C.default,{style:[Tn.dateText,!a&&Tn.otherMonthDateText,r&&Tn.recurringDateText],children:t.getDate()})},"date-".concat(o,"-").concat(n))}))},"week-".concat(o))))]})})(),(0,T.jsx)(v.default,{style:Tn.modalCloseButton,onPress:()=>W(!1),children:(0,T.jsx)(C.default,{style:Tn.modalCloseButtonText,children:"Close"})})]})})})}),{})]})},kn=Array.from({length:12},((e,t)=>0===t?12:t)),An=Array.from({length:60},((e,t)=>t)).filter((e=>e%5===0)),_n=["AM","PM"],In=r.default.create({timeDisplay:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",backgroundColor:m.theme.colors.surface,padding:10,borderRadius:8,borderWidth:1,borderColor:m.theme.colors.modernBorder,marginVertical:5},timeText:{flex:1,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,fontSize:m.theme.fontSizes.medium,marginLeft:8},dropdownContainer:{position:"absolute",top:"100%",left:0,right:0,backgroundColor:m.theme.colors.background,borderRadius:8,borderWidth:1,borderColor:m.theme.colors.modernBorder,marginTop:4,zIndex:1e3,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3},inlineContainer:{backgroundColor:m.theme.colors.background,borderRadius:8,padding:4},label:{color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,fontSize:m.theme.fontSizes.small,marginBottom:8},dropdownContent:{flexDirection:"row",padding:4},column:{flex:1,height:160},option:{padding:8,alignItems:"center",height:40,justifyContent:"center"},selectedOption:{backgroundColor:"".concat(m.theme.colors.mainColors.main,"20"),borderRadius:4},optionText:{color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,fontSize:m.theme.fontSizes.medium},selectedOptionText:{color:m.theme.colors.mainColors.main,fontWeight:"600"},buttonRow:{flexDirection:"row",justifyContent:"space-between",marginTop:8,paddingHorizontal:4},button:{paddingVertical:8,paddingHorizontal:16,borderRadius:6,flex:1,marginHorizontal:4,alignItems:"center"},confirmButton:{backgroundColor:m.theme.colors.mainColors.main},cancelButton:{backgroundColor:m.theme.colors.modernBorder},confirmButtonText:{color:"white",fontFamily:m.theme.fonts.medium.fontFamily,fontSize:m.theme.fontSizes.small},cancelButtonText:{color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,fontSize:m.theme.fontSizes.small},errorContainer:{flexDirection:"row",alignItems:"center",backgroundColor:"#FFEBEE",padding:8,marginHorizontal:4,marginTop:4,borderRadius:4},errorText:{color:m.theme.colors.error||"#D32F2F",fontSize:m.theme.fontSizes.small,fontFamily:m.theme.fonts.regular.fontFamily,marginLeft:4,flex:1}}),Mn=({initialTime:e,onTimeSelect:t,isOpen:o,onClose:a,label:r="Time",uniqueId:i="default",showInlinePicker:s=!1})=>{const l=(0,n.useRef)(null),d=(0,n.useRef)(null),c=(0,n.useRef)(null),u=JSON.parse(JSON.stringify(e||{hours:9,minutes:0})),h=()=>{const e=u.hours,t=5*Math.round(u.minutes/5);return{hour:e%12===0?12:e%12,minute:t>=60?0:t,period:e>=12?"PM":"AM"}},[f,p]=(0,n.useState)(h()),[y,b]=(0,n.useState)(h()),[w,j]=(0,n.useState)(null);(0,n.useEffect)((()=>{if(e){const e=h();p(e),b(e),j(null)}}),[e?.hours,e?.minutes]),(0,n.useEffect)((()=>{if(w){const e=setTimeout((()=>{j(null)}),5e3);return()=>clearTimeout(e)}}),[w]),(0,n.useEffect)((()=>{o&&setTimeout((()=>{k()}),50)}),[o,f]);const S=()=>{(e=>{const{hour:o,minute:n,period:r}=e;let s=o;"PM"===r&&12!==o&&(s+=12),"AM"===r&&12===o&&(s=0);const l={hours:s,minutes:n};(0,g.debugLog)("MBAoi9uv43d: TimePickerDropdown selected time (".concat(i,"):"),{time12h:e,time24h:l}),b(e),!1===t(l)?(ft.default.alert("Invalid Time Selection",i.includes("start")?"Start time cannot be later than end time.":"End time cannot be earlier than start time.",[{text:"OK"}]),j(i.includes("start")?"Start time cannot be later than end time.":"End time cannot be earlier than start time.")):a()})(f)},B=()=>{p(y),j(null),a()},k=()=>{if(l.current){const e=40*kn.indexOf(f.hour);l.current.scrollTo({y:Math.max(0,e-40),animated:!0})}if(d.current){const e=40*An.indexOf(f.minute);d.current.scrollTo({y:Math.max(0,e-40),animated:!0})}if(c.current){const e=40*_n.indexOf(f.period);c.current.scrollTo({y:Math.max(0,e-20),animated:!0})}},A=()=>(0,T.jsxs)(x.default,{children:[(0,T.jsxs)(x.default,{style:In.dropdownContent,children:[(0,T.jsx)(H.default,{ref:l,style:In.column,showsVerticalScrollIndicator:!1,children:kn.map((e=>(0,T.jsx)(v.default,{style:[In.option,f.hour===e&&In.selectedOption],onPress:()=>(e=>{p((t=>Object.assign({},t,{hour:e}))),j(null)})(e),children:(0,T.jsx)(C.default,{style:[In.optionText,f.hour===e&&In.selectedOptionText],children:e})},"hour-".concat(e))))}),(0,T.jsx)(H.default,{ref:d,style:In.column,showsVerticalScrollIndicator:!1,children:An.map((e=>(0,T.jsx)(v.default,{style:[In.option,f.minute===e&&In.selectedOption],onPress:()=>(e=>{p((t=>Object.assign({},t,{minute:e}))),j(null)})(e),children:(0,T.jsx)(C.default,{style:[In.optionText,f.minute===e&&In.selectedOptionText],children:e.toString().padStart(2,"0")})},"minute-".concat(e))))}),(0,T.jsx)(H.default,{ref:c,style:In.column,showsVerticalScrollIndicator:!1,children:_n.map((e=>(0,T.jsx)(v.default,{style:[In.option,f.period===e&&In.selectedOption],onPress:()=>(e=>{p((t=>Object.assign({},t,{period:e}))),j(null)})(e),children:(0,T.jsx)(C.default,{style:[In.optionText,f.period===e&&In.selectedOptionText],children:e})},"period-".concat(e))))})]}),w&&(0,T.jsxs)(x.default,{style:In.errorContainer,children:[(0,T.jsx)(ee.default,{name:"error",size:16,color:m.theme.colors.error||"#D32F2F"}),(0,T.jsx)(C.default,{style:In.errorText,children:w})]}),(0,T.jsxs)(x.default,{style:In.buttonRow,children:[(0,T.jsx)(v.default,{style:[In.button,In.cancelButton],onPress:B,children:(0,T.jsx)(C.default,{style:In.cancelButtonText,children:"Cancel"})}),(0,T.jsx)(v.default,{style:[In.button,In.confirmButton],onPress:S,children:(0,T.jsx)(C.default,{style:In.confirmButtonText,children:"Confirm"})})]})]});return s?(0,T.jsxs)(x.default,{style:In.inlineContainer,children:[r&&(0,T.jsx)(C.default,{style:In.label,children:r}),A()]}):(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)(v.default,{style:In.timeDisplay,onPress:o?a:()=>{},children:[(0,T.jsx)(ee.default,{name:"access-time",size:18,color:m.theme.colors.mainColors.main}),(0,T.jsx)(C.default,{style:In.timeText,children:(_=f.hour,I=f.minute,M=f.period,"".concat(_,":").concat(I.toString().padStart(2,"0")," ").concat(M))}),(0,T.jsx)(ee.default,{name:o?"keyboard-arrow-up":"keyboard-arrow-down",size:20,color:m.theme.colors.text})]}),o&&(0,T.jsx)(x.default,{style:In.dropdownContainer,children:A()})]});var _,I,M},Dn=r.default.create({container:{backgroundColor:m.theme.colors.background,borderRadius:8,padding:16,marginBottom:16},title:{fontSize:m.theme.fontSizes.medium,fontFamily:m.theme.fonts.medium.fontFamily,color:m.theme.colors.text,marginBottom:16},timeSelectionContainer:{flexDirection:"row",justifyContent:"space-between",marginBottom:16},timePickerContainer:{flex:1,marginHorizontal:4,position:"relative",zIndex:10},dateLabel:{fontSize:m.theme.fontSizes.small,fontFamily:m.theme.fonts.medium.fontFamily,color:m.theme.colors.textSecondary,marginBottom:4},timeLabel:{fontSize:m.theme.fontSizes.smallMedium,fontFamily:m.theme.fonts.regular.fontFamily,color:m.theme.colors.text,marginBottom:8},timeButton:{borderWidth:1,borderColor:m.theme.colors.modernBorder,borderRadius:8,backgroundColor:m.theme.colors.surface,position:"relative"},timeButtonContent:{flexDirection:"row",alignItems:"center",padding:12},timeText:{flex:1,fontSize:m.theme.fontSizes.medium,fontFamily:m.theme.fonts.regular.fontFamily,color:m.theme.colors.text,marginLeft:8},durationContainer:{flexDirection:"row",alignItems:"center",marginTop:4,padding:12,backgroundColor:m.theme.colors.bgColorModern,borderRadius:8},durationText:{fontSize:m.theme.fontSizes.medium,fontFamily:m.theme.fonts.regular.fontFamily,color:m.theme.colors.text,marginLeft:8},modalOverlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.2)",justifyContent:"center",alignItems:"center"},modalContent:{backgroundColor:m.theme.colors.background,borderRadius:8,borderWidth:1,borderColor:m.theme.colors.modernBorder,width:"80%",padding:8,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.2,shadowRadius:4,elevation:5},startModalContent:{alignSelf:"flex-start",marginLeft:"10%"},endModalContent:{alignSelf:"flex-end",marginRight:"10%"}}),Rn=({title:e,onTimeSelect:t,initialTimes:o={},is_overnight:a=!1,uniqueId:r="default",dateRange:i=null,selectedDates:s=[],isIndividualDaySelector:l=!1})=>{const{is_DEBUG:d}=(0,n.useContext)(g.AuthContext),[c,u]=(0,n.useState)((()=>{const e={startTime:{hours:9,minutes:0},endTime:{hours:17,minutes:0},isOvernightForced:o?.isOvernightForced||a||!1};return o?{startTime:o.startTime?JSON.parse(JSON.stringify(o.startTime)):e.startTime,endTime:o.endTime?JSON.parse(JSON.stringify(o.endTime)):e.endTime,isOvernightForced:o.isOvernightForced||a||!1}:e})),[h,f]=(0,n.useState)(null);(0,n.useEffect)((()=>{if(!o)return;(0,g.debugLog)("MBAoi9uv43d: NewTimeRangeSelector (".concat(r,") initialTimes update:"),o);const e={startTime:o.startTime?JSON.parse(JSON.stringify(o.startTime)):c.startTime,endTime:o.endTime?JSON.parse(JSON.stringify(o.endTime)):c.endTime,isOvernightForced:o.isOvernightForced||a||c.isOvernightForced};u(e)}),[o?.startTime?.hours,o?.startTime?.minutes,o?.endTime?.hours,o?.endTime?.minutes,o?.isOvernightForced,a]),(0,n.useEffect)((()=>()=>{}),[h]);const p=e=>{if(!e)return"";const t=e.hours,o=e.minutes,n=t>=12?"PM":"AM";return"".concat(t%12===0?12:t%12,":").concat(o.toString().padStart(2,"0")," ").concat(n)},y=e=>{if(!e)return"";try{return new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}catch(t){return(0,g.debugLog)("MBAoi9uv43d: Error formatting date: ".concat(t.message)),""}},b=(()=>{if(i&&i.startDate)return i.startDate;if(s&&s.length>0){return[...s].sort(((e,t)=>new Date(e)-new Date(t)))[0]}return null})(),w=(()=>{if(i&&i.endDate)return i.endDate;if(s&&s.length>0){const e=[...s].sort(((e,t)=>new Date(e)-new Date(t)));return e[e.length-1]}return null})();return(0,T.jsxs)(x.default,{style:Dn.container,children:[e&&(0,T.jsx)(C.default,{style:Dn.title,children:e}),(0,T.jsxs)(x.default,{style:Dn.timeSelectionContainer,children:[(0,T.jsxs)(x.default,{style:Dn.timePickerContainer,children:[b&&(l||c.isOvernightForced||a)?(0,T.jsx)(C.default,{style:Dn.dateLabel,children:y(b)}):(0,T.jsx)(C.default,{style:Dn.dateLabel,children:"Applies to all individual days"}),(0,T.jsx)(C.default,{style:Dn.timeLabel,children:"Start Time"}),(0,T.jsx)(v.default,{style:Dn.timeButton,onPress:()=>f("start"===h?null:"start"),children:(0,T.jsxs)(x.default,{style:Dn.timeButtonContent,children:[(0,T.jsx)(ee.default,{name:"access-time",size:18,color:m.theme.colors.mainColors.main}),(0,T.jsx)(C.default,{style:Dn.timeText,children:p(c.startTime)}),(0,T.jsx)(ee.default,{name:"start"===h?"keyboard-arrow-up":"keyboard-arrow-down",size:20,color:m.theme.colors.text})]})})]}),(0,T.jsxs)(x.default,{style:Dn.timePickerContainer,children:[w&&(l||c.isOvernightForced||a)?(0,T.jsx)(C.default,{style:Dn.dateLabel,children:y(w)}):(0,T.jsx)(C.default,{style:Dn.dateLabel,children:"Applies to all individual days"}),(0,T.jsx)(C.default,{style:Dn.timeLabel,children:"End Time"}),(0,T.jsx)(v.default,{style:Dn.timeButton,onPress:()=>f("end"===h?null:"end"),children:(0,T.jsxs)(x.default,{style:Dn.timeButtonContent,children:[(0,T.jsx)(ee.default,{name:"access-time",size:18,color:m.theme.colors.mainColors.main}),(0,T.jsx)(C.default,{style:Dn.timeText,children:p(c.endTime)}),(0,T.jsx)(ee.default,{name:"end"===h?"keyboard-arrow-up":"keyboard-arrow-down",size:20,color:m.theme.colors.text})]})})]})]}),(0,T.jsxs)(x.default,{style:Dn.durationContainer,children:[(0,T.jsx)(ee.default,{name:"timelapse",size:18,color:m.theme.colors.mainColors.main}),(0,T.jsxs)(C.default,{style:Dn.durationText,children:["Duration: ",(()=>{const{isOvernightForced:e}=c;if((e||a)&&(i||s&&s.length>0)){let e,t;if(i&&i.startDate&&i.endDate)e=new Date(i.startDate),t=new Date(i.endDate);else{if(!(s&&s.length>=2))return s&&1===s.length?"Same day":"1 night";{const o=[...s].sort(((e,t)=>new Date(e)-new Date(t)));e=new Date(o[0]),t=new Date(o[o.length-1])}}Math.abs(t-e);let o;const n=new Date(e.getFullYear(),e.getMonth(),e.getDate()),a=new Date(t.getFullYear(),t.getMonth(),t.getDate());o=Math.round(Math.abs(a-n)/864e5)+1;const r=o>1?o-1:0;return 0===r?"Same day":1===r?"1 night":"".concat(r," nights")}const{startTime:t,endTime:o}=c,n=60*t.hours+t.minutes;let r=60*o.hours+o.minutes;0===o.hours&&0===o.minutes&&(r=1440);let l=r-n;l<0&&(0!==o.hours||0!==o.minutes)&&(l+=1440);const d=Math.floor(l/60),u=l%60;let m="";return d>0&&(m+="".concat(d," hour").concat(1!==d?"s":"")),u>0&&(m.length>0&&(m+=" "),m+="".concat(u," minute").concat(1!==u?"s":"")),m||"0 minutes"})()]})]}),h&&(0,T.jsx)(A.default,{transparent:!0,animationType:"none",visible:!!h,onRequestClose:()=>f(null),children:(0,T.jsx)(qe.default,{onPress:()=>f(null),children:(0,T.jsx)(x.default,{style:Dn.modalOverlay,children:(0,T.jsx)(qe.default,{children:(0,T.jsx)(x.default,{style:[Dn.modalContent,"start"===h?Dn.startModalContent:Dn.endModalContent],children:(0,T.jsx)(Mn,{initialTime:"start"===h?c.startTime:c.endTime,onTimeSelect:"start"===h?e=>{const o=0===c.endTime.hours&&0===c.endTime.minutes,n=60*e.hours+e.minutes,a=60*c.endTime.hours+c.endTime.minutes;if(!(o||n<a))return(0,g.debugLog)("MBAoi9uv43d: NewTimeRangeSelector (".concat(r,") invalid start time - would be after end time:"),{attemptedStart:e,currentEnd:c.endTime,startMinutes:n,endMinutes:a}),!1;const i=Object.assign({},c,{startTime:JSON.parse(JSON.stringify(e))});return u(i),t(i),(0,g.debugLog)("MBAoi9uv43d: NewTimeRangeSelector (".concat(r,") startTime changed:"),{newTime:e,updatedTimes:i}),!0}:e=>{const o=0===e.hours&&0===e.minutes,n=60*c.startTime.hours+c.startTime.minutes,a=60*e.hours+e.minutes;if(!(o||a>n))return(0,g.debugLog)("MBAoi9uv43d: NewTimeRangeSelector (".concat(r,") invalid end time - would be before start time:"),{currentStart:c.startTime,attemptedEnd:e,startMinutes:n,endMinutes:a}),!1;const i=Object.assign({},c,{endTime:JSON.parse(JSON.stringify(e))});return u(i),t(i),(0,g.debugLog)("MBAoi9uv43d: NewTimeRangeSelector (".concat(r,") endTime changed:"),{newTime:e,updatedTimes:i}),!0},isOpen:!0,onClose:()=>f(null),uniqueId:"".concat(r,"-").concat(h),showInlinePicker:!0})})})})})})]})},Ln=r.default.create({container:{marginBottom:16,borderWidth:1,borderColor:m.theme.colors.modernBorder,borderRadius:8,backgroundColor:m.theme.colors.surface,overflow:"visible"},dateLabel:{fontSize:m.theme.fontSizes.medium,fontFamily:m.theme.fonts.medium.fontFamily,color:m.theme.colors.text,backgroundColor:m.theme.colors.bgColorModern,padding:12,borderBottomWidth:1,borderBottomColor:m.theme.colors.modernBorder}}),zn=({date:e,initialTimes:t={},onTimeChange:o,is_overnight:a=!1})=>{const{is_DEBUG:r}=(0,n.useContext)(g.AuthContext),i=(()=>{if(!e)return"day-unknown";try{if(e instanceof Date)return"day-".concat(e.toISOString().split("T")[0]);if("string"===typeof e&&e.match(/^\d{4}-\d{2}-\d{2}$/))return"day-".concat(e);const t=new Date(e);return isNaN(t.getTime())?"day-unknown-".concat(Date.now()):"day-".concat(t.toISOString().split("T")[0])}catch(t){return(0,g.debugLog)("MBAoi9uv43d: Error generating unique ID for date:",t),"day-unknown-".concat(Date.now())}})(),s=(()=>{if(!e)return null;try{if(e instanceof Date)return e.toISOString().split("T")[0];if("string"===typeof e&&e.match(/^\d{4}-\d{2}-\d{2}$/))return e;const t=new Date(e);return isNaN(t.getTime())?((0,g.debugLog)("MBAoi9uv43d: Could not parse date:",e),null):t.toISOString().split("T")[0]}catch(t){return(0,g.debugLog)("MBAoi9uv43d: Error generating date key:",t),null}})();return(0,T.jsxs)(x.default,{style:Ln.container,children:[(0,T.jsx)(C.default,{style:Ln.dateLabel,children:(e=>{if(!e)return"";return new Date(e).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})})(e)}),(0,T.jsx)(Rn,{onTimeSelect:e=>{if(!s)return void(0,g.debugLog)("MBAoi9uv43d: Cannot handle time selection - invalid date key");const t=JSON.parse(JSON.stringify(e));(0,g.debugLog)("MBAoi9uv43d: DayTimeSelector (".concat(i,") time changed:"),{dateKey:s,timesData:t}),o(t,s)},initialTimes:t,is_overnight:a,uniqueId:i,selectedDates:[e],isIndividualDaySelector:!0})]})},Pn=e=>{if(!e)return null;if("string"===typeof e&&e.includes(":")){const[t,o]=e.split(":").map((e=>parseInt(e,10)));return{hours:t,minutes:o}}return"object"!==typeof e||null===e||void 0===e.hours&&void 0===e.minutes?null:{hours:e.hours||0,minutes:e.minutes||0}},Fn=r.default.create({container:{flex:1,padding:16},card:{backgroundColor:m.theme.colors.background,borderRadius:12},customizeButtonContainer:{marginBottom:24,paddingHorizontal:16},customizeButton:{flexDirection:"row",alignItems:"center",justifyContent:"center",gap:8,paddingVertical:12,paddingHorizontal:16,borderRadius:8,borderWidth:1,borderColor:m.theme.colors.mainColors.main},customizeButtonText:{color:m.theme.colors.mainColors.main,fontSize:m.theme.fontSizes.medium,fontFamily:m.theme.fonts.regular.fontFamily,textAlign:"center"},individualDaysContainer:{gap:12,marginBottom:16},sectionHeader:{fontSize:m.theme.fontSizes.medium,fontFamily:m.theme.fonts.regular.fontFamily,color:m.theme.colors.text,marginBottom:12,paddingHorizontal:16}}),On=({onTimeSelect:e,initialTimes:t={},dateRange:o=null,selectedService:a=null,isOvernightForced:r=!1})=>{const{is_DEBUG:i}=(0,n.useContext)(g.AuthContext),[s,l]=(0,n.useState)((()=>{if(a?.is_overnight||r)return!1;const e=t&&!0===t.hasIndividualTimes;return(0,g.debugLog)("MBAoi9uv43d: Initial showIndividualDays value:",e),e})),[d,c]=(0,n.useState)({}),[u,h]=(0,n.useState)((()=>{try{return t&&"object"===typeof t?t:((0,g.debugLog)("MBAoi9uv43d: Invalid initialTimes, using defaults:",t),{startTime:{hours:9,minutes:0},endTime:{hours:17,minutes:0},isOvernightForced:!1})}catch(e){return(0,g.debugLog)("MBAoi9uv43d: Error initializing times:",e),{startTime:{hours:9,minutes:0},endTime:{hours:17,minutes:0},isOvernightForced:!1}}})),f=(0,n.useRef)(!0);(0,n.useEffect)((()=>{(0,g.debugLog)("MBAoi9uv43d: TimeSelectionCard received initialTimes:",t);try{if(!t||"object"!==typeof t){const e={startTime:{hours:9,minutes:0},endTime:{hours:17,minutes:0},isOvernightForced:a?.is_overnight||!1};return(0,g.debugLog)("MBAoi9uv43d: Using default times:",e),h(e),void l(!1)}const e=!0===t.hasIndividualTimes;(0,g.debugLog)("MBAoi9uv43d: hasIndividualTimes flag is",e),f.current?((0,g.debugLog)("MBAoi9uv43d: Initial render - setting showIndividualDays to",e),l(e),f.current=!1):(0,g.debugLog)("MBAoi9uv43d: Not initial render - preserving showIndividualDays state");const n=Pn(t.startTime),r={startTime:n||{hours:9,minutes:0},endTime:Pn(t.endTime)||{hours:17,minutes:0},isOvernightForced:t.isOvernightForced||a?.is_overnight||!1};(0,g.debugLog)("MBAoi9uv43d: Setting formatted times:",r),h(r);const i=t&&Object.keys(t).some((e=>e.match(/^\d{4}-\d{2}-\d{2}$/)));if((0,g.debugLog)("MBAoi9uv43d: Time selection setup:",{hasDatesInDraft:i,hasIndividualTimesFlag:e,hasDateRange:!!(o&&o.startDate&&o.endDate),hasDates:!!(t&&t.dates&&t.dates.length>0)}),o&&o.startDate&&o.endDate||i){const n={};if(o&&o.startDate&&o.endDate){const e=new Date(o.startDate),t=new Date(o.endDate),a=new Date(e);for(;a<=t;){const e=a.toISOString().split("T")[0];n[e]=JSON.parse(JSON.stringify(r)),a.setDate(a.getDate()+1)}}t.dates&&t.dates.length>0&&!o&&((0,g.debugLog)("MBAoi9uv43d: Creating time ranges from multiple days selection"),t.dates.forEach((e=>{let t;t="string"===typeof e?new Date(e):e&&e.date?new Date(e.date):new Date(e);const o=t.toISOString().split("T")[0];n[o]||(n[o]=JSON.parse(JSON.stringify(r)))}))),(e||i)&&Object.keys(t).forEach((e=>{if(e.match(/^\d{4}-\d{2}-\d{2}$/)&&t[e]){const o=t[e],a=Pn(o.startTime),r=Pn(o.endTime);(a||r)&&(n[e]={startTime:a||{hours:9,minutes:0},endTime:r||{hours:17,minutes:0},isOvernightForced:o.isOvernightForced||!1})}})),t.individualTimeRanges&&Object.keys(t.individualTimeRanges).forEach((e=>{if(e.match(/^\d{4}-\d{2}-\d{2}$/)){const o=t.individualTimeRanges[e],a=Pn(o.startTime),r=Pn(o.endTime);(a||r)&&(n[e]={startTime:a||{hours:9,minutes:0},endTime:r||{hours:17,minutes:0},isOvernightForced:o.isOvernightForced||!1})}})),(0,g.debugLog)("MBAoi9uv43d: Setting individual time ranges:",n),c(n)}}catch(e){(0,g.debugLog)("MBAoi9uv43d: Error processing initialTimes:",e),h({startTime:{hours:9,minutes:0},endTime:{hours:17,minutes:0},isOvernightForced:a?.is_overnight||!1})}}),[t,o,a]);const p=(o,n)=>{if((0,g.debugLog)("MBAoi9uv43d: Individual day time selection for card:",{dateKey:n,timesData:o}),!n)return void(0,g.debugLog)("MBAoi9uv43d: No dateKey provided, returning");const a=JSON.parse(JSON.stringify(d));a[n]=JSON.parse(JSON.stringify(o)),(0,g.debugLog)("MBAoi9uv43d: TimeSelectionCard updating only date:",n),(0,g.debugLog)("MBAoi9uv43d: Current individualTimeRanges keys:",Object.keys(d)),(0,g.debugLog)("MBAoi9uv43d: New updatedRanges keys:",Object.keys(a)),c(a);const r={};Object.keys(a).forEach((e=>{const t=a[e];r[e]={startTime:"".concat(String(t.startTime.hours).padStart(2,"0"),":").concat(String(t.startTime.minutes).padStart(2,"0")),endTime:"".concat(String(t.endTime.hours).padStart(2,"0"),":").concat(String(t.endTime.minutes).padStart(2,"0")),isOvernightForced:!!t.isOvernightForced}}));const i={startTime:JSON.parse(JSON.stringify(u.startTime)),endTime:JSON.parse(JSON.stringify(u.endTime)),isOvernightForced:u.isOvernightForced,hasIndividualTimes:!0,dates:t.dates?[...t.dates]:[],individualTimeRanges:r};i[n]=r[n],(0,g.debugLog)("MBAoi9uv43d: TimeSelectionCard sending updated data to parent"),e(i)};return(0,T.jsx)(x.default,{style:Fn.container,children:(0,T.jsxs)(x.default,{style:Fn.card,children:[!s&&(0,T.jsx)(Rn,{onTimeSelect:t=>{(0,g.debugLog)("MBAoi9uv43d: handleDefaultTimeSelect called with:",t);const o=JSON.parse(JSON.stringify(t));if(h(o),s){const t={};Object.keys(d).forEach((e=>{t[e]={startTime:o.startTime,endTime:o.endTime,isOvernightForced:o.isOvernightForced}})),c(t),e(Object.assign({},o,t,{hasIndividualTimes:!0}))}else e(Object.assign({},o,{hasIndividualTimes:!1}))},initialTimes:u,is_overnight:a?.is_overnight||u.isOvernightForced||r||!1,uniqueId:"default-time-range",dateRange:o,selectedDates:t.dates||[]}),!a?.is_overnight&&!r&&(0,T.jsx)(x.default,{style:Fn.customizeButtonContainer,children:(0,T.jsxs)(v.default,{style:Fn.customizeButton,onPress:()=>{if((0,g.debugLog)("MBAoi9uv43d: TOGGLE button pressed"),(0,g.debugLog)("MBAoi9uv43d: Current showIndividualDays state:",s),s){(0,g.debugLog)("MBAoi9uv43d: Switching FROM individual days TO default time range"),l(!1);const o={startTime:u.startTime,endTime:u.endTime,isOvernightForced:u.isOvernightForced,hasIndividualTimes:!1,dates:t.dates||[]};(0,g.debugLog)("MBAoi9uv43d: Sending default time data to parent:",o),e(o)}else{(0,g.debugLog)("MBAoi9uv43d: Switching FROM default time range TO individual days"),l(!0);let n={};if(t&&t.dates&&t.dates.length>0)(0,g.debugLog)("MBAoi9uv43d: Creating time ranges for multiple individual dates"),t.dates.forEach((e=>{let t;t="string"===typeof e?new Date(e):e&&e.date?new Date(e.date):new Date(e);const o=t.toISOString().split("T")[0];n[o]={startTime:JSON.parse(JSON.stringify(u.startTime)),endTime:JSON.parse(JSON.stringify(u.endTime)),isOvernightForced:u.isOvernightForced}}));else if(o&&o.startDate&&o.endDate){(0,g.debugLog)("MBAoi9uv43d: Creating time ranges from dateRange");const e=new Date(o.startDate),t=new Date(o.endDate),a=new Date(e);for(;a<=t;){const e=a.toISOString().split("T")[0];n[e]={startTime:JSON.parse(JSON.stringify(u.startTime)),endTime:JSON.parse(JSON.stringify(u.endTime)),isOvernightForced:u.isOvernightForced},a.setDate(a.getDate()+1)}}else Object.keys(d).length>0&&(n=JSON.parse(JSON.stringify(d)));(0,g.debugLog)("MBAoi9uv43d: Setting individual time ranges:",n),c(n),e(Object.assign({},u,n,{hasIndividualTimes:!0}))}},activeOpacity:.7,children:[(0,T.jsx)(ee.default,{name:"schedule",size:20,color:m.theme.colors.mainColors.main}),(0,T.jsx)(C.default,{style:Fn.customizeButtonText,children:s?"Set Default Time Range":"Customize Individual Day Schedules"})]})}),s&&!a?.is_overnight&&!r&&(0,T.jsxs)(x.default,{style:Fn.individualDaysContainer,children:[(0,T.jsx)(C.default,{style:Fn.sectionHeader,children:"Individual Day Schedules"}),(0,T.jsx)(H.default,{children:(()=>{let e=[];if(t&&t.dates&&t.dates.length>0)(0,g.debugLog)("MBAoi9uv43d: Using multiple individual dates from initialTimes:",t.dates),e=t.dates.map((e=>"string"===typeof e?new Date(e):e&&e.date?new Date(e.date):new Date(e)));else if(o&&o.startDate&&o.endDate){(0,g.debugLog)("MBAoi9uv43d: Generating dates from dateRange:",o);const t=new Date(o.startDate),n=new Date(o.endDate),a=new Date(t);for(;a<=n;)e.push(new Date(a)),a.setDate(a.getDate()+1)}return e})().map(((e,o)=>{const n=e.toISOString().split("T")[0];let r;if(t&&t[n]){const e=Pn(t[n].startTime),o=Pn(t[n].endTime);r={startTime:e||JSON.parse(JSON.stringify(u.startTime)),endTime:o||JSON.parse(JSON.stringify(u.endTime)),isOvernightForced:!!t[n].isOvernightForced},(0,g.debugLog)("MBAoi9uv43d: Found specific time data for date ".concat(n," in initialTimes"))}else d&&d[n]?(r=JSON.parse(JSON.stringify(d[n])),(0,g.debugLog)("MBAoi9uv43d: Using time from individualTimeRanges for date ".concat(n))):(r={startTime:JSON.parse(JSON.stringify(u.startTime)),endTime:JSON.parse(JSON.stringify(u.endTime)),isOvernightForced:u.isOvernightForced},(0,g.debugLog)("MBAoi9uv43d: Using default times for date ".concat(n)));return(0,T.jsx)(zn,{date:e,initialTimes:r,onTimeChange:p,is_overnight:a?.is_overnight||!1},"day-".concat(n))}))})]})]})})},En={SERVICES_AND_PETS:{id:0,name:"Services & Pets"},DATE_SELECTION:{id:1,name:"Date Selection"},TIME_SELECTION:{id:2,name:"Time Selection"},REVIEW_AND_RATES:{id:3,name:"Review & Rates"}},Wn=r.default.create({modalOverlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center",width:"100%"},modalContent:{width:"95%",maxWidth:"web"===a.default.OS?600:"100%",maxHeight:"90%",backgroundColor:m.theme.colors.background,borderRadius:12,overflow:"hidden",display:"flex",flexDirection:"column"},stepIndicatorContainer:{width:"100%",paddingVertical:12,backgroundColor:m.theme.colors.background,borderBottomWidth:1,borderBottomColor:m.theme.colors.modernBorder},scrollContent:{flex:1},scrollContentContainer:{flexGrow:1},content:{flex:1,backgroundColor:m.theme.colors.background},footer:{flexDirection:"row",padding:16,justifyContent:"space-between",alignItems:"center",backgroundColor:m.theme.colors.background,borderTopWidth:1,borderTopColor:m.theme.colors.modernBorder},spacer:{width:16,flexGrow:1},smallMargin:{width:8},backButton:{minWidth:100,backgroundColor:m.theme.colors.surface,paddingVertical:12,paddingHorizontal:16,borderRadius:8,alignItems:"center",borderWidth:1,borderColor:m.theme.colors.border},smallScreenButton:{minWidth:80,paddingVertical:8,paddingHorizontal:10},backButtonText:{color:m.theme.colors.text,fontSize:16,fontFamily:m.theme.fonts.regular.fontFamily},cancelButton:{flex:1,backgroundColor:m.theme.colors.surface,paddingVertical:12,borderRadius:8,alignItems:"center",borderWidth:1,borderColor:m.theme.colors.border},cancelButtonSmall:{minWidth:100,backgroundColor:m.theme.colors.surface,paddingVertical:12,paddingHorizontal:16,borderRadius:8,alignItems:"center",borderWidth:1,borderColor:m.theme.colors.border},cancelButtonText:{color:m.theme.colors.text,fontSize:16,fontFamily:m.theme.fonts.regular.fontFamily},nextButton:{flex:1,backgroundColor:m.theme.colors.mainColors.main,paddingVertical:12,borderRadius:8,alignItems:"center"},nextButtonSmall:{minWidth:100,backgroundColor:m.theme.colors.mainColors.main,paddingVertical:12,paddingHorizontal:16,borderRadius:8,alignItems:"center"},disabledButton:{backgroundColor:m.theme.colors.placeHolderText},nextButtonText:{color:m.theme.colors.surface,fontSize:16,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"600"},disabledButtonText:{color:m.theme.colors.surface},errorText:{color:m.theme.colors.error,textAlign:"center",marginBottom:16,fontFamily:m.theme.fonts.regular.fontFamily},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:16},loadingText:{color:m.theme.colors.text,fontSize:16,fontFamily:m.theme.fonts.regular.fontFamily},stepContent:{flex:1,backgroundColor:m.theme.colors.background},divider:{height:1,backgroundColor:m.theme.colors.modernBorder,marginVertical:16},errorContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:16},confirmButtonColumn:{flexDirection:"column",alignItems:"center",justifyContent:"center"}}),Nn=({visible:e,onClose:t,bookingId:o,onComplete:a,initialData:r={},navigation:i})=>{const{is_DEBUG:s,screenWidth:l,timeSettings:d}=(0,n.useContext)(g.AuthContext),c=l<600,[u,m]=(0,n.useState)(En.SERVICES_AND_PETS.id),[h,f]=(0,n.useState)({service:r.service||null,pets:r.pets||[],dates:r.dates||[],bookingType:r.bookingType||"one-time",dateRangeType:r.dateRangeType||"date-range",times:r.times||{startTime:"09:00",endTime:"17:00",isOvernightForced:!1,hasIndividualTimes:!1},rates:r.rates||{},dateSelectionData:null,dateRange:null,hasFetchedDates:!1}),[p,y]=(0,n.useState)(null),[b,w]=(0,n.useState)(!1);(0,n.useEffect)((()=>{(0,g.debugLog)("MBA12345 Initial data received:",r),(0,g.debugLog)("MBA12345 Initial booking data state:",h)}),[r]),(0,n.useEffect)((()=>{(async()=>{if(o&&e)if(h.hasFetchedDates)(0,g.debugLog)("MBA2j3kbr9hve4: Skipping fetch as hasFetchedDates is true");else try{w(!0),y(null),(0,g.debugLog)("MBA2j3kbr9hve4: Fetching draft dates and times for booking ID:",o);const e=await(0,Ze.getBookingDraftDatesAndTimes)(o);if((0,g.debugLog)("MBA2j3kbr9hve4: Received draft dates and times:",e),e){const o=(0,mo.parseOccurrencesForBookingSteps)(e.occurrences||[]);(0,g.debugLog)("MBA2j3kbr9hve4: Parsed draft dates and times:",o);const n=(e.service_details?.service_type||"").toLowerCase(),a=["overnight","boarding","house sitting","pet sitting"],r=!0===e.service_details?.is_overnight||a.some((e=>n.includes(e)));(0,g.debugLog)("MBA2j3kbr9hve4: Is overnight service from response:",r),(0,g.debugLog)("MBA2j3kbr9hve4: Service name:",n),(0,g.debugLog)("MBA2j3kbr9hve4: Known overnight terms match:",a.some((e=>n.includes(e)))),(0,g.debugLog)("MBA2j3kbr9hve4: Full service details from response:",e.service_details);let i=null;if(e.service_details&&(i=Object.assign({},e.service_details,{service_id:e.service_details.service_id,service_name:e.service_details.service_type,is_overnight:r}),(0,g.debugLog)("MBA2j3kbr9hve4: Setting service data with overnight status:",i)),e.occurrences&&e.occurrences.length>0){const t=e.occurrences[0],o=e.occurrences[e.occurrences.length-1];if(t.start_date!==o.end_date){const e=new Date(t.start_date),n=new Date(o.end_date),a=Math.ceil((n-e)/864e5);a>=1&&((0,g.debugLog)("MBA2j3kbr9hve4: DETECTED OVERNIGHT from date range:",{startDate:t.start_date,endDate:o.end_date,daysDifference:a}),i&&(i.is_overnight=!0))}}if(2===e.occurrences?.length)try{const t=new Date(e.occurrences[0].start_date),o=new Date(e.occurrences[1].start_date),n=Math.abs(Math.round((o-t)/864e5));n>1&&((0,g.debugLog)("MBA2j3kbr9hve4: DETECTED POTENTIAL OVERNIGHT from date distance:",{date1:e.occurrences[0].start_date,date2:e.occurrences[1].start_date,daysBetween:n}),i&&(i.is_overnight=!0))}catch(t){(0,g.debugLog)("MBA2j3kbr9hve4: Error checking occ dates:",t)}let s=e.date_range_type||"date-range";r||i&&i.is_overnight?(s="date-range",(0,g.debugLog)("MBA2j3kbr9hve4: Forcing date-range type for overnight service")):o.dates&&o.dates.length>1&&!o.dateRange&&(s="multiple-days",(0,g.debugLog)("MBA2j3kbr9hve4: Non-consecutive dates detected, forcing multiple-days mode"));const l=r||i&&i.is_overnight;(0,g.debugLog)("MBA2j3kbr9hve4: Final overnight determination:",{initialCheck:r,afterOccurrenceChecks:i?.is_overnight,finalIsOvernightForced:l}),f((t=>Object.assign({},t,{dates:o.dates||[],dateRange:o.dateRange,times:Object.assign({},o.defaultTimes||{},o.individualTimes,{individualTimeRanges:o.individualTimes||{},allTimesAreTheSame:o.allTimesAreTheSame,hasIndividualTimes:!o.allTimesAreTheSame,isOvernightForced:l}),dateRangeType:s,bookingType:e.booking_type||t.bookingType||"one-time",hasFetchedDates:!0,service:i||t.service})))}}catch(p){(0,g.debugLog)("MBA2j3kbr9hve4: Error fetching draft dates and times:",p),u>En.SERVICES_AND_PETS.id?y("Failed to load booking details. Please try again."):(0,g.debugLog)("MBA2j3kbr9hve4: Suppressing error on first step:",p.message)}finally{w(!1)}})()}),[o,e,u,h.hasFetchedDates]),(0,n.useEffect)((()=>{(h.service?.is_overnight||h.times?.isOvernightForced)&&((0,g.debugLog)("MBA2j3kbr9hve4: Detected overnight service, ensuring dateRangeType is date-range"),"date-range"!==h.dateRangeType&&((0,g.debugLog)("MBA2j3kbr9hve4: Updating dateRangeType from",h.dateRangeType,"to date-range"),f((e=>Object.assign({},e,{dateRangeType:"date-range"})))))}),[h.service,h.times?.isOvernightForced]);const j=e=>{(0,g.debugLog)("MBA12345 Selected service:",e);const t=(e?.service_name||"").toLowerCase(),o=["overnight","boarding","house sitting","pet sitting"],n=!0===e?.is_overnight||o.some((e=>t.includes(e)));(0,g.debugLog)("MBA2j3kbr9hve4: Service overnight status:",{isOvernight:n,serviceData:e,serviceName:t,matchesOvernightTerms:o.some((e=>t.includes(e)))}),f((t=>{const o=Object.assign({},t.times||{},{isOvernightForced:n});(0,g.debugLog)("MBA2j3kbr9hve4: Updated times with overnight status:",o);const a=Object.assign({},e,{is_overnight:n});return Object.assign({},t,{service:a,times:o,dateRangeType:n?"date-range":t.dateRangeType})}))},S=e=>{(0,g.debugLog)("MBA12345 Selected/deselected pet:",e);const t=h.pets.find((t=>t.pet_id===e.pet_id))?h.pets.filter((t=>t.pet_id!==e.pet_id)):[...h.pets,e];f((e=>Object.assign({},e,{pets:t})))},B=e=>{(0,g.debugLog)("MBA12345 Selected dates:",e),(0,g.debugLog)("MBA2j3kbr9hve4: CRITICAL handleDateSelect rangeType:",{rangeType:e.rangeType,currentDateRangeType:h.dateRangeType,isServiceOvernight:h.service?.is_overnight,isTimesOvernightForced:h.times?.isOvernightForced}),f((t=>{let o=t.dateRange;return"date-range"===e.rangeType&&e.startDate&&e.endDate?o={startDate:e.startDate,endDate:e.endDate}:"multiple-days"===e.rangeType?o=t.dateRange:e.dates&&0!==e.dates.length||(o=null),Object.assign({},t,{dates:e.dates||[],dateSelectionData:e,dateRange:o,dateRangeType:e.rangeType||t.dateRangeType})}))},k=e=>{(0,g.debugLog)("MBAoi1h34ghnvo: TimeSelectionCard sent time data:",e);h.service;f((t=>{if(e.hasIndividualTimes){(0,g.debugLog)("MBAoi1h34ghnvo: Processing individual times");const o=Object.assign({},t.times,{hasIndividualTimes:!0,isOvernightForced:e.isOvernightForced,dates:e.dates||t.times.dates||[],individualTimeRanges:e.individualTimeRanges||{}});return Object.keys(e).forEach((t=>{t.match(/^\d{4}-\d{2}-\d{2}$/)&&((0,g.debugLog)("MBAoi1h34ghnvo: Processing date key:",t,e[t]),o[t]={startTime:e[t].startTime,endTime:e[t].endTime,isOvernightForced:e[t].isOvernightForced})})),(0,g.debugLog)("MBAoi1h34ghnvo: Final individual times object:",o),Object.assign({},t,{times:o})}{(0,g.debugLog)("MBAoi1h34ghnvo: Using default time range mode");const o=Object.assign({},t.times,{startTime:e.startTime?"".concat(String(e.startTime.hours).padStart(2,"0"),":").concat(String(e.startTime.minutes||0).padStart(2,"0")):t.times.startTime,endTime:e.endTime?"".concat(String(e.endTime.hours).padStart(2,"0"),":").concat(String(e.endTime.minutes||0).padStart(2,"0")):t.times.endTime,isOvernightForced:e.isOvernightForced,hasIndividualTimes:!1,dates:e.dates||t.times.dates||[]});return(0,g.debugLog)("MBAoi1h34ghnvo: Updated default times:",o),Object.assign({},t,{times:o})}}))},_=()=>{switch(u){case En.SERVICES_AND_PETS.id:return h.service&&h.pets.length>0;case En.DATE_SELECTION.id:return!(!h.dateSelectionData||!h.dateSelectionData.isValid)||(!!(h.dates&&h.dates.length>0)||!!(h.dateRange&&h.dateRange.startDate&&h.dateRange.endDate));case En.TIME_SELECTION.id:case En.REVIEW_AND_RATES.id:return!0;default:return!1}},I=async()=>{if(_())if(y(null),(0,g.debugLog)("MBA2j3kbr9hve4: Moving to next step:",{currentStep:u,nextStep:u+1,hasValidDates:h.dates&&h.dates.length>0,hasValidDateRange:h.dateRange&&h.dateRange.startDate&&h.dateRange.endDate,hasValidDateSelectionData:h.dateSelectionData&&h.dateSelectionData.isValid,dateRangeType:h.dateRangeType,bookingType:h.bookingType}),u<En.REVIEW_AND_RATES.id){if(u===En.SERVICES_AND_PETS.id)try{(0,g.debugLog)("MBA2j3kbr9hve4: Updating booking draft with service and pets"),await(0,Ze.updateBookingDraftPetsAndServices)(o,{service_id:h.service?.service_id,pets:h.pets}),(0,g.debugLog)("MBA2j3kbr9hve4: Successfully updated booking draft with service and pets"),f((e=>Object.assign({},e,{hasFetchedDates:!1})))}catch(p){return(0,g.debugLog)("MBA2j3kbr9hve4: Error updating booking draft:",p),void y("Failed to save service and pet selections")}if(u===En.TIME_SELECTION.id)try{(0,g.debugLog)("MBA5asdt3f4321 Original booking data:",h);const t=!0===h.service?.is_overnight,n=!0===h.times?.isOvernightForced,a=t||n;if((0,g.debugLog)("MBA5asdt3f4321 DIRECT OVERNIGHT CHECK AT START:",{isServiceOvernightFlag:t,isTimeOvernightFlag:n,isAnyOvernightFlag:a,dateRangeType:h.dateRangeType}),a&&h.dateRange){(0,g.debugLog)("MBA53212co2v3nvoub5 DIRECT OVERRIDE: Forcing overnight mode for any overnight service");const e=(0,mo.formatDateForAPI)(h.dateRange.startDate),t=(0,mo.formatDateForAPI)(h.dateRange.endDate),n=(0,mo.formatTimeForAPI)(h.times.startTime),a=(0,mo.formatTimeForAPI)(h.times.endTime);(0,g.debugLog)("MBA53212co2v3nvoub5 DIRECT OVERRIDE: Using time-and-date endpoint with dates:",{startDate:e,endDate:t,startTime:n,endTime:a});const r=d?.timezone||"US/Mountain";(0,g.debugLog)("MBA53212co2v3nvoub5 Using user timezone for UTC conversion:",r);const{date:i,time:s}=(0,mo.convertToUTC)(e,n,r),{date:l,time:c}=(0,mo.convertToUTC)(t,a,r),u=await(0,Ze.updateBookingDraftTimeAndDate)(o,i,l,s,c);return(0,g.debugLog)("MBA53212co2v3nvoub5 DIRECT OVERRIDE: Response from updateBookingDraftTimeAndDate:",u),u?.draft_data&&f((e=>Object.assign({},e,u.draft_data,{times:Object.assign({},u.draft_data.times||e.times,{isOvernightForced:!0}),service:Object.assign({},u.draft_data.service||e.service,{is_overnight:!0}),dateRangeType:"date-range"}))),void m((e=>e+1))}if("date-range"===h.dateRangeType){const t=!0===h.service?.is_overnight,n=!0===h.times?.isOvernightForced&&!("00:00"===h.times.endTime&&!t);let a=!1;if(h.dateRange&&h.dateRange.startDate&&h.dateRange.endDate)try{const e=new Date(h.dateRange.startDate),t=new Date(h.dateRange.endDate),o=Math.ceil((t-e)/864e5);o>1&&(a=!0,(0,g.debugLog)("MBA53212co2v3nvoub5 DETECTED multi-day date range:",{startDate:h.dateRange.startDate,endDate:h.dateRange.endDate,daysDifference:o}))}catch(e){(0,g.debugLog)("MBA53212co2v3nvoub5 Error checking date range:",e)}if((0,g.debugLog)("MBA53212co2v3nvoub5 CRITICAL Checking overnight status:",{dateRangeType:h.dateRangeType,serviceIsOvernight:t,timesIsOvernightForced:h.times?.isOvernightForced,endTime:h.times?.endTime,endTimeIsMidnight:"00:00"===h.times?.endTime,isMidnightEndTimeButNotForced:"00:00"===h.times?.endTime&&!t,isTimeOvernight:n,isMultiDayRange:a,service:h.service,times:h.times}),t||n||a){const e=Object.assign({},h,{service:Object.assign({},h.service,{is_overnight:!0}),times:Object.assign({},h.times,{isOvernightForced:!0})});f(e),(0,g.debugLog)("MBA53212co2v3nvoub5 OVERRIDE: Forcing overnight mode for date range due to overnight service or flag");const t=(0,mo.formatDateForAPI)(h.dateRange.startDate),n=(0,mo.formatDateForAPI)(h.dateRange.endDate),a=(0,mo.formatTimeForAPI)(h.times.startTime),r=(0,mo.formatTimeForAPI)(h.times.endTime),i=d?.timezone||"US/Mountain";(0,g.debugLog)("MBA53212co2v3nvoub5 Using user timezone for UTC conversion:",i);const{date:s,time:l}=(0,mo.convertToUTC)(t,a,i),{date:c,time:u}=(0,mo.convertToUTC)(n,r,i),p=await(0,Ze.updateBookingDraftTimeAndDate)(o,s,c,l,u);return(0,g.debugLog)("MBA53212co2v3nvoub5 Received response from updateBookingDraftTimeAndDate (overnight override):",p),p?.draft_data&&f((e=>Object.assign({},e,p.draft_data,{times:Object.assign({},p.draft_data.times||e.times,{isOvernightForced:!0}),service:Object.assign({},p.draft_data.service||e.service,{is_overnight:!0})}))),void m((e=>e+1))}const r="date-range"===h.dateRangeType&&!t&&!n&&!a;if((0,g.debugLog)("MBA53212co2v3nvoub5 Decision:",{isNonOvernightDateRange:r,willUseEndpoint:r?"updateBookingDraftMultipleDays":"updateBookingDraftTimeAndDate"}),r){(0,g.debugLog)("MBA53212co2v3nvoub5 Handling non-overnight date range as individual occurrences");const e=new Date(h.dateRange.startDate),t=new Date(h.dateRange.endDate),n=[],a=new Date(e);for(;a<=t;)n.push(new Date(a)),a.setDate(a.getDate()+1);(0,g.debugLog)("MBA53212co2v3nvoub5 Generated dates from range:",n.map((e=>e.toISOString().split("T")[0]))),(0,g.debugLog)("MBA53212co2v3nvoub5 Time settings:",h.times);const r=n.map((e=>{const t=e.toISOString().split("T")[0];(0,g.debugLog)("MBA53212co2v3nvoub5 Processing date:",t);let o,n,a=h.times;h.times[t]&&h.times.hasIndividualTimes?(a=h.times[t],(0,g.debugLog)("MBA53212co2v3nvoub5 Using individual times for date:",t,a)):(0,g.debugLog)("MBA53212co2v3nvoub5 Using default times for date:",t,a),o="string"===typeof a.startTime?a.startTime:void 0!==a.startTime?.hours?"".concat(String(a.startTime.hours).padStart(2,"0"),":").concat(String(a.startTime.minutes||0).padStart(2,"0")):"09:00",n="string"===typeof a.endTime?a.endTime:void 0!==a.endTime?.hours?"".concat(String(a.endTime.hours).padStart(2,"0"),":").concat(String(a.endTime.minutes||0).padStart(2,"0")):"17:00",(0,g.debugLog)("MBA53212co2v3nvoub5 Formatted times for date:",t,{startTime:o,endTime:n});const r=(0,mo.formatDateForAPI)(e);(0,g.debugLog)("MBA53212co2v3nvoub5 Formatted date:",r);const i="00:00"===n||parseInt(n.split(":")[0],10)<parseInt(o.split(":")[0],10)||parseInt(n.split(":")[0],10)===parseInt(o.split(":")[0],10)&&parseInt(n.split(":")[1],10)<parseInt(o.split(":")[1],10),s=i?new Date(e.getTime()+864e5):new Date(e),l=(0,mo.formatDateForAPI)(s);(0,g.debugLog)("MBA53212co2v3nvoub5 End date calculation:",{needsNextDayDate:i,startTime:o,endTime:n,originalDate:r,calculatedEndDate:l});const c=d?.timezone||"US/Mountain";(0,g.debugLog)("MBA53212co2v3nvoub5 Using user timezone for UTC conversion in map function:",c);const{date:u,time:m}=(0,mo.convertToUTC)(r,o,c),{date:f,time:p}=(0,mo.convertToUTC)(l,n,c);return(0,g.debugLog)("MBA53212co2v3nvoub5 Converted UTC times:",{utcStartDate:u,utcStartTime:m,utcEndDate:f,utcEndTime:p,isDifferentDates:u!==f}),{date:u,startTime:m,endDate:f,endTime:p}}));(0,g.debugLog)("MBA53212co2v3nvoub5 - Converted UTC dates:",r);const i=await(0,Ze.updateBookingDraftMultipleDays)(o,{dates:r,times:{}},d);(0,g.debugLog)("MBA53212co2v3nvoub5 Received response from updateBookingDraftMultipleDays:",i),i?.draft_data&&f((e=>Object.assign({},e,i.draft_data)))}else{const e=(0,mo.formatDateForAPI)(h.dateRange.startDate),t=(0,mo.formatDateForAPI)(h.dateRange.endDate),n=(0,mo.formatTimeForAPI)(h.times.startTime),a=(0,mo.formatTimeForAPI)(h.times.endTime);(0,g.debugLog)("MBA53212co2v3nvoub5 Using update-time-and-date endpoint for OVERNIGHT service with dates:",{startDate:e,endDate:t,startTime:n,endTime:a,service:{id:h.service?.service_id,name:h.service?.service_name,is_overnight:h.service?.is_overnight},times:{isOvernightForced:h.times?.isOvernightForced}});const{date:r,time:i}=(0,mo.convertToUTC)(e,n,userTz),{date:s,time:l}=(0,mo.convertToUTC)(t,a,userTz);(0,g.debugLog)("MBA53212co2v3nvoub5 UTC dates and times:",{utcStartDate:r,utcStartTime:i,utcEndDate:s,utcEndTime:l});const d=await(0,Ze.updateBookingDraftTimeAndDate)(o,r,s,i,l);(0,g.debugLog)("MBA53212co2v3nvoub5 Received response from updateBookingDraftTimeAndDate:",d),d?.draft_data?f((e=>Object.assign({},e,d.draft_data))):(0,g.debugLog)("MBA53212co2v3nvoub5 No draft_data in response:",d)}}else if("multiple-days"===h.dateRangeType){(0,g.debugLog)("MBA53212co2v3nvoub5 Multiple days selection:",{dates:h.dates,times:h.times});const e=await(0,Ze.updateBookingDraftMultipleDays)(o,{dates:h.dates,times:h.times},d);(0,g.debugLog)("MBA53212co2v3nvoub5 Received response from updateBookingDraftMultipleDays:",e),e?.draft_data&&f((t=>Object.assign({},t,e.draft_data)))}else if("recurring"===h.bookingType){(0,g.debugLog)("MBA53212co2v3nvoub5 Recurring dates selection:",{startDate:h.recurringStartDate,endDate:h.recurringEndDate,daysOfWeek:h.selectedDaysOfWeek,frequency:h.selectedFrequency,times:h.times});const e=await(0,Ze.updateBookingDraftRecurring)(o,{startDate:h.recurringStartDate,endDate:h.recurringEndDate,daysOfWeek:h.selectedDaysOfWeek,frequency:h.selectedFrequency,startTime:h.times.startTime,endTime:h.times.endTime});(0,g.debugLog)("MBA53212co2v3nvoub5 Received response from updateBookingDraftRecurring:",e),e?.draft_data&&f((t=>Object.assign({},t,e.draft_data)))}}catch(p){return(0,g.debugLog)("MBA53212co2v3nvoub5 Error calculating booking totals:",p),(0,g.debugLog)("MBA53212co2v3nvoub5 Error stack:",p.stack),(0,g.debugLog)("MBA53212co2v3nvoub5 Error details:",{message:p.message,name:p.name,response:p.response?.data}),void y("Failed to calculate booking totals")}m((e=>e+1))}else try{if(y(null),!h.conversation_id)return void y("Missing conversation information");(0,g.debugLog)("MBA66777 Creating booking from draft with conversation ID:",h.conversation_id);const e=await(0,Ze.createBookingFromDraft)(h.conversation_id);(0,g.debugLog)("MBA66777 Booking created successfully:",e);const t=e.message||{},o=e.booking_id,n={id:Date.now().toString(),type_of_message:"send_approved_message",metadata:{booking_id:o,service_type:t.service_type||h.service?.service_name,occurrences:t.occurrences||[],cost_summary:t.cost_summary||{total_client_cost:t.occurrences?.[0]?.cost_summary?.total_client_cost,total_sitter_payout:t.occurrences?.[0]?.cost_summary?.total_sitter_payout}},content:"Approval Request",sent_by_other_user:!1,timestamp:(new Date).toISOString()};a(Object.assign({},h,{booking_id:o,status:"Pending Client Approval",message:n})),M()}catch(p){(0,g.debugLog)("MBA66777 Error creating booking:",p),y("Failed to create booking. Please try again."),setTimeout((()=>{a(Object.assign({},h,{error:!0,errorMessage:p.message}))}),3e3)}else y("Please complete all required fields before proceeding")},M=()=>{(0,g.debugLog)("MBA2j3kbr9hve4: Resetting booking step modal state"),m(En.SERVICES_AND_PETS.id),f({service:r.service||null,pets:r.pets||[],dates:r.dates||[],bookingType:r.bookingType||"one-time",dateRangeType:r.dateRangeType||"date-range",times:r.times||{startTime:"09:00",endTime:"17:00",isOvernightForced:!1,hasIndividualTimes:!1},rates:r.rates||{},dateSelectionData:null,dateRange:null,hasFetchedDates:!1}),y(null),w(!1)},D=()=>{(0,g.debugLog)("MBA66777: Closing booking step modal and resetting state"),M(),t()};(0,n.useEffect)((()=>()=>{(0,g.debugLog)("MBA2j3kbr9hve4: BookingStepModal unmounting, cleaning up state")}),[]);return(0,T.jsx)(A.default,{visible:e,animationType:"fade",onRequestClose:D,transparent:!0,children:(0,T.jsx)(x.default,{style:Wn.modalOverlay,children:(0,T.jsxs)(Ie.default,{style:Wn.modalContent,children:[(0,T.jsx)(x.default,{style:Wn.stepIndicatorContainer,children:(0,T.jsx)(ze,{steps:Object.values(En).map((e=>e.name)),currentStep:u})}),(0,T.jsxs)(H.default,{style:Wn.scrollContent,contentContainerStyle:Wn.scrollContentContainer,children:[(0,T.jsx)(x.default,{style:Wn.content,children:b?(0,T.jsx)(x.default,{style:Wn.loadingContainer,children:(0,T.jsx)(C.default,{style:Wn.loadingText,children:"Loading booking information..."})}):(()=>{switch(u){case En.SERVICES_AND_PETS.id:return(0,T.jsx)(Cn,{bookingId:o,onServiceSelect:j,onPetSelect:S,selectedService:h.service,selectedPets:h.pets,navigation:i,onClose:t});case En.DATE_SELECTION.id:(0,g.debugLog)("MBA2j3kbr9hve4: Rendering date selection with:",{dates:h.dates,dateRange:h.dateRange,bookingType:h.bookingType,dateRangeType:h.dateRangeType,hasFetchedDates:h.hasFetchedDates});const e=h.service?.is_overnight||h.times?.isOvernightForced||!1;return(0,g.debugLog)("MBA2j3kbr9hve4: Date selection overnight status:",{serviceIsOvernight:h.service?.is_overnight,timesIsOvernightForced:h.times?.isOvernightForced,combinedMode:e}),(0,T.jsx)(Bn,{selectedDates:h.dates||[],onDateSelect:B,bookingType:h.bookingType||"one-time",dateRangeType:h.dateRangeType||"date-range",initialDateRange:h.dateRange||null,isOvernightForced:e});case En.TIME_SELECTION.id:if(!h.dates||0===h.dates.length)return(0,T.jsx)(x.default,{style:Wn.errorContainer,children:(0,T.jsx)(C.default,{style:Wn.errorText,children:"Please select dates first"})});(0,g.debugLog)("MBA66777: CURRENT STATE Before rendering time selection:",{service:{id:h.service?.service_id,name:h.service?.service_name,is_overnight:h.service?.is_overnight},times:{isOvernightForced:h.times?.isOvernightForced,hasIndividualTimes:h.times?.hasIndividualTimes},dateRange:h.dateRange,dateRangeType:h.dateRangeType});const n=Object.assign({},h.times,{dates:h.dates||[],occurrences:h.occurrences||[],hasIndividualTimes:h.times?.hasIndividualTimes||!1,isOvernightForced:h.service?.is_overnight||h.times?.isOvernightForced||!1});(h.service?.is_overnight||h.times?.isOvernightForced)&&(n.hasIndividualTimes=!1,n.isOvernightForced=!0);const a=h.service?.is_overnight||h.times?.isOvernightForced||!1;return(0,g.debugLog)("MBA66777: Passing initialTimes to TimeSelectionCard:",{hasIndividualTimes:n.hasIndividualTimes,dateCount:n.dates?.length||0,isOvernightService:h.service?.is_overnight,isOvernightForced:h.times?.isOvernightForced,combinedOvernight:a}),(0,T.jsx)(On,{onTimeSelect:k,initialTimes:n,dateRange:h.dateRange,selectedService:Object.assign({},h.service,{is_overnight:a}),isOvernightForced:a});case En.REVIEW_AND_RATES.id:return(0,T.jsx)(po,{bookingData:h,bookingId:o,onRatesUpdate:e=>{(0,g.debugLog)("MBA2j3kbr9hve4: Rates updated:",e),f((t=>Object.assign({},t,{occurrences:e.occurrences,cost_summary:e.cost_summary})))}});default:return null}})()}),p&&(0,T.jsx)(C.default,{style:Wn.errorText,children:p})]}),(0,T.jsx)(x.default,{style:Wn.footer,children:u===En.SERVICES_AND_PETS.id?(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(v.default,{style:Wn.cancelButton,onPress:D,children:(0,T.jsx)(C.default,{style:Wn.cancelButtonText,children:"Cancel"})}),(0,T.jsx)(v.default,{style:[Wn.nextButton,(!_()||b)&&Wn.disabledButton],onPress:I,disabled:!_()||b,children:(0,T.jsx)(C.default,{style:[Wn.nextButtonText,(!_()||b)&&Wn.disabledButtonText],children:"Next"})})]}):(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(v.default,{style:[Wn.backButton,c&&Wn.smallScreenButton],onPress:()=>{u>En.SERVICES_AND_PETS.id?m((e=>e-1)):D()},children:(0,T.jsx)(C.default,{style:Wn.backButtonText,children:"Back"})}),(0,T.jsx)(x.default,{style:Wn.spacer}),(0,T.jsx)(v.default,{style:[Wn.cancelButtonSmall,c&&Wn.smallScreenButton],onPress:D,children:(0,T.jsx)(C.default,{style:Wn.cancelButtonText,children:"Cancel"})}),(0,T.jsx)(x.default,{style:c?Wn.smallMargin:null}),(0,T.jsx)(v.default,{style:[Wn.nextButtonSmall,c&&Wn.smallScreenButton,(!_()||b)&&Wn.disabledButton],onPress:I,disabled:!_()||b,children:u===En.REVIEW_AND_RATES.id&&c?(0,T.jsxs)(x.default,{style:Wn.confirmButtonColumn,children:[(0,T.jsx)(C.default,{style:[Wn.nextButtonText,(!_()||b)&&Wn.disabledButtonText],children:"Request"}),(0,T.jsx)(C.default,{style:[Wn.nextButtonText,(!_()||b)&&Wn.disabledButtonText],children:"Booking"})]}):(0,T.jsx)(C.default,{style:[Wn.nextButtonText,(!_()||b)&&Wn.disabledButtonText],children:u===En.REVIEW_AND_RATES.id?"Request Booking":"Next"})})]})})]})})})};var Hn=o(72302),Un=o.n(Hn);const Vn=r.default.create({card:{backgroundColor:m.theme.colors.surface,borderRadius:12,padding:0,margin:8,borderWidth:1,borderColor:m.theme.colors.border,maxWidth:"80%",shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3,overflow:"hidden",position:"relative"},sentCard:{alignSelf:"flex-end",marginLeft:"20%"},receivedCard:{alignSelf:"flex-start",marginRight:"20%"},approvalCard:{borderColor:m.theme.colors.border,borderWidth:1},confirmedCard:{borderColor:m.theme.colors.success,borderWidth:2},colorBar:{width:4,backgroundColor:m.theme.colors.primary,position:"absolute",top:0,bottom:0,zIndex:1},colorBarLeft:{left:0},colorBarRight:{right:0},cardContent:{padding:12},header:{flexDirection:"row",alignItems:"center",marginBottom:8,paddingBottom:8,borderBottomWidth:1,borderBottomColor:m.theme.colors.border,gap:8},requestHeader:{borderBottomColor:m.theme.colors.border+"40"},approvalHeader:{borderBottomColor:m.theme.colors.border+"40"},confirmedHeader:{borderBottomColor:m.theme.colors.success},title:{fontSize:16,fontWeight:"bold",fontFamily:m.theme.fonts.header.fontFamily},requestTitle:{color:m.theme.colors.primary},approvalTitle:{color:m.theme.colors.primary},changeRequestTitle:{color:m.theme.colors.warning},content:{gap:8},infoSection:{gap:4,paddingBottom:8,borderBottomWidth:1,borderBottomColor:m.theme.colors.border+"40"},row:{flexDirection:"row",alignItems:"center",gap:8},label:{fontSize:14,fontWeight:"500",color:m.theme.colors.text,minWidth:80,fontFamily:m.theme.fonts.regular.fontFamily},value:{fontSize:14,color:m.theme.colors.text,flex:1,fontFamily:m.theme.fonts.regular.fontFamily},datesSection:{gap:4},datesSectionHeader:{flexDirection:"row",alignItems:"center"},datesCount:{fontSize:14,color:m.theme.colors.placeholder,marginLeft:8,fontFamily:m.theme.fonts.regular.fontFamily},occurrenceContainer:{borderBottomWidth:1,borderBottomColor:m.theme.colors.border+"40",paddingBottom:8,marginBottom:4},occurrenceItem:{gap:2,marginLeft:4},dateTimeText:{fontSize:14,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,fontStyle:"italic"},durationText:{fontSize:14,color:m.theme.colors.placeHolderText,fontFamily:m.theme.fonts.regular.fontFamily},dstMessage:{fontSize:12,color:m.theme.colors.error,fontFamily:m.theme.fonts.regular.fontFamily},buttonContainer:{flexDirection:"row",justifyContent:"space-between",marginTop:8,gap:8},detailsButton:{flex:1,padding:8,borderRadius:8,alignItems:"center",backgroundColor:m.theme.colors.primary},detailsButtonText:{color:"white",fontSize:14,fontWeight:"500",fontFamily:m.theme.fonts.regular.fontFamily},approveButton:{flex:1,padding:8,borderRadius:8,alignItems:"center",backgroundColor:m.theme.colors.surface,borderWidth:1,borderColor:m.theme.colors.border},approveButtonText:{color:m.theme.colors.text,fontSize:14,fontWeight:"500",fontFamily:m.theme.fonts.regular.fontFamily},editButton:{flex:1,padding:8,borderRadius:8,alignItems:"center",backgroundColor:m.theme.colors.surface,borderWidth:1,borderColor:m.theme.colors.border},editButtonText:{color:m.theme.colors.text,fontSize:14,fontWeight:"500",fontFamily:m.theme.fonts.regular.fontFamily},disabledButton:{backgroundColor:m.theme.colors.border,opacity:.6},statusOverlay:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.4)",alignItems:"center",justifyContent:"center",zIndex:2},statusText:{color:"white",fontSize:16,fontWeight:"bold",padding:8,backgroundColor:"rgba(0, 0, 0, 0.6)",borderRadius:4,fontFamily:m.theme.fonts.header.fontFamily},changeMessageContainer:{backgroundColor:m.theme.colors.background,borderRadius:8,padding:8,marginTop:4,marginBottom:4,borderLeftWidth:3,borderLeftColor:m.theme.colors.warning},changeMessageLabel:{fontSize:16,fontWeight:"500",color:m.theme.colors.text,marginBottom:4,fontFamily:m.theme.fonts.regular.fontFamily},changeMessageText:{fontSize:14,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},showMoreButton:{flexDirection:"row",alignItems:"center",justifyContent:"center",paddingVertical:8,marginTop:8,marginBottom:4,backgroundColor:m.theme.colors.surface,borderRadius:8,borderWidth:1,borderColor:m.theme.colors.primary+"40",paddingHorizontal:12,shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.1,shadowRadius:1,elevation:1},showMoreText:{fontSize:14,color:m.theme.colors.primary,marginRight:5,fontWeight:"500",fontFamily:m.theme.fonts.regular.fontFamily},confirmationContainerClickable:{flex:1,width:"100%",borderRadius:8},confirmationContainer:{backgroundColor:m.theme.colors.success+"15",padding:12,borderRadius:8,marginBottom:8},confirmationText:{fontSize:14,color:m.theme.colors.text,textAlign:"center",fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"500"},confirmedTitle:{color:m.theme.colors.success},confirmationBorder:{position:"absolute",top:0,left:0,right:0,height:4,backgroundColor:m.theme.colors.success}}),qn=({type:e,displayType:t,data:o,isFromMe:a,onPress:r,isProfessional:i,onApproveSuccess:s,onApproveError:l,onEditDraft:d,bookingStatus:c,hasChangeRequest:u,isNewestMessage:h=!1,messageCreatedAt:f,hasNewerApprovalRequests:p=!1,isAfterConfirmation:y=!1})=>{const{timeSettings:b}=(0,n.useContext)(g.AuthContext),w=b?.timezone||"US/Mountain",[j,B]=(0,n.useState)(!1),[k,A]=(0,n.useState)(null),[_,I]=(0,n.useState)(!1);(0,n.useEffect)((()=>{const e=Object.assign({},o,{occurrences:o.occurrences?.map((e=>Object.assign({},e,{rates:e.rates||{base_rate:0,additional_animal_rate:0,applies_after:1,holiday_rate:0,holiday_days:0,additional_rates:[]}})))});A(e)}),[o]);const M="Confirmed"===c,D="request_changes"===e,R="booking_confirmed"===e,L="approval"===e||D,z=M&&!R&&"approval"!==e&&!y&&!(D&&h)||"approval"===e&&u&&!h||D&&!h||R&&p||"booking_update"===t&&u&&!h||"approval"===e&&y&&!h,P=R&&p||"booking_update"===t&&u&&!h||"approval"===e&&y&&!h?"Booking Updated":"approval"===e&&y&&h||D&&h?"":!M||R||y||D&&h?"approval"===e&&u&&!h?"Changes Requested":D&&!h?"Booking Updated":"":"Booking Confirmed";(0,g.debugLog)("MBA4321: Message state for booking",o.booking_id,{type:e,displayType:t,isFromMe:a,isProfessional:i,bookingStatus:c,hasChangeRequest:u,isNewestMessage:h,isAfterConfirmation:y,hasNewerApprovalRequests:p,shouldShowOverlay:z,overlayText:P,messageCreatedAt:f||"N/A",overlayLogicChecks:{isConfirmedButNotConfirmationMessage:M&&!R,isChangeRequestAndNewestMessage:D&&h,isApprovalWithChangeRequest:"approval"===e&&u&&!h,isBookingConfirmedWithNewerApprovals:R&&p}});const F=()=>{if(!k){const e=Object.assign({},o,{occurrences:o.occurrences?.map((e=>Object.assign({},e,{rates:e.rates||{base_rate:0,additional_animal_rate:0,applies_after:1,holiday_rate:0,holiday_days:0,additional_rates:[]}})))||[]});A(e)}(0,g.debugLog)("MBA9876 Opening approval modal with booking ID:",o.booking_id),B(!0)},O=e=>{if(e.start_date&&e.end_date&&e.start_time&&e.end_time){const t=(0,mo.formatDateTimeRangeFromUTC)({startDate:e.start_date,startTime:e.start_time,endDate:e.end_date,endTime:e.end_time,userTimezone:w,includeTimes:!0,includeTimezone:!0});return((e,t,o,n,a)=>{try{const r=Un().utc("".concat(e,"T").concat(t,":00Z")).tz(a),i=Un().utc("".concat(o,"T").concat(n,":00Z")).tz(a);return r.utcOffset()!==i.utcOffset()}catch(r){return(0,g.debugLog)("MBA9876DST Error checking DST change:",r),!1}})(e.start_date,e.start_time,e.end_date,e.end_time,w)&&!e.dst_message&&((0,g.debugLog)("MBA9876DST Detected DST change for occurrence:",{start:"".concat(e.start_date," ").concat(e.start_time),end:"".concat(e.end_date," ").concat(e.end_time),timezone:w}),e.dst_message="Elapsed time may be different than expected due to Daylight Savings Time."),t}return e.formatted_start&&e.formatted_end?"".concat(e.formatted_start," to ").concat(e.formatted_end):"Date information unavailable"},E=e=>{if(e.duration)return e.duration;if(e.start_date&&e.end_date&&e.start_time&&e.end_time)try{const t=Un().utc("".concat(e.start_date,"T").concat(e.start_time,":00Z")),o=Un().utc("".concat(e.end_date,"T").concat(e.end_time,":00Z")),n=o.diff(t,"hours"),a=o.diff(t,"days");return a>0?"".concat(a," ").concat(1===a?"day":"days",", ").concat(n%24," ").concat(n%24===1?"hour":"hours"):"".concat(n," ").concat(1===n?"hour":"hours")}catch(t){(0,g.debugLog)("MBA9876DST Error calculating duration:",t)}return"N/A"},W=o.occurrences||[],N=W.length>3,H=_?W:W.slice(0,3),U=Math.max(0,W.length-3);return(0,T.jsxs)(x.default,{style:(()=>{const e=[Vn.card,a?Vn.sentCard:Vn.receivedCard];return L&&e.push(Vn.approvalCard),R&&e.push(Vn.confirmedCard),e})(),children:[L&&(0,T.jsx)(x.default,{style:[Vn.colorBar,a?Vn.colorBarLeft:Vn.colorBarRight]}),R&&(0,T.jsx)(x.default,{style:Vn.confirmationBorder}),(0,T.jsxs)(x.default,{style:Vn.cardContent,children:[(0,T.jsxs)(x.default,{style:R?[Vn.header,Vn.confirmedHeader]:[Vn.header,L?Vn.approvalHeader:Vn.requestHeader],children:[(0,T.jsx)(S.default,{name:(()=>{switch(e){case"request":return"calendar-plus";case"approval":return"calendar-check";case"request_changes":return"calendar-edit";case"booking_confirmed":return"check-circle-outline";default:return"calendar"}})(),size:24,color:D?m.theme.colors.warning:R?m.theme.colors.success:m.theme.colors.primary}),(0,T.jsx)(C.default,{style:[Vn.title,D?Vn.changeRequestTitle:R?Vn.confirmedTitle:L?Vn.approvalTitle:Vn.requestTitle],children:(()=>{if("booking_update"===t)return"Booking Update";if("request_changes"===e&&y)return"Update Change Request";switch(e){case"request":return"Booking Request";case"approval":return"Approval Request";case"request_changes":return"Request Changes";case"booking_confirmed":return"Booking Confirmed";default:return"Booking"}})()})]}),(0,T.jsx)(x.default,{style:Vn.content,children:R?(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)(v.default,{style:Vn.confirmationContainerClickable,onPress:F,activeOpacity:.7,children:[(0,T.jsx)(x.default,{style:Vn.confirmationContainer,children:(0,T.jsx)(C.default,{style:Vn.confirmationText,children:"This booking has been confirmed and is ready to go!"})}),(0,T.jsxs)(x.default,{style:Vn.infoSection,children:[(0,T.jsxs)(x.default,{style:Vn.row,children:[(0,T.jsx)(C.default,{style:Vn.label,children:"Booking ID:"}),(0,T.jsx)(C.default,{style:Vn.value,children:o.booking_id||"N/A"})]}),(0,T.jsxs)(x.default,{style:Vn.row,children:[(0,T.jsx)(C.default,{style:Vn.label,children:"Service:"}),(0,T.jsx)(C.default,{style:Vn.value,children:o.service_type||"N/A"})]}),(0,T.jsxs)(x.default,{style:Vn.row,children:[(0,T.jsx)(C.default,{style:Vn.label,children:i?"Your Payout:":"Total Cost:"}),(0,T.jsxs)(C.default,{style:Vn.value,children:["$",i?o.cost_summary?.total_sitter_payout||"0.00":o.cost_summary?.total_client_cost||"0.00"]})]})]})]}),(0,T.jsxs)(x.default,{style:Vn.buttonContainer,children:[(0,T.jsx)(v.default,{style:[Vn.detailsButton,{flex:1}],onPress:F,children:(0,T.jsx)(C.default,{style:Vn.detailsButtonText,children:"View Details"})}),i&&d&&(0,T.jsx)(v.default,{style:[Vn.editButton,{flex:1}],onPress:d,children:(0,T.jsx)(C.default,{style:Vn.editButtonText,children:"Edit Details"})})]})]}):(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)(x.default,{style:Vn.infoSection,children:[(0,T.jsxs)(x.default,{style:Vn.row,children:[(0,T.jsx)(C.default,{style:Vn.label,children:"Booking ID:"}),(0,T.jsx)(C.default,{style:Vn.value,children:o.booking_id||"N/A"})]}),(0,T.jsxs)(x.default,{style:Vn.row,children:[(0,T.jsx)(C.default,{style:Vn.label,children:"Service:"}),(0,T.jsx)(C.default,{style:Vn.value,children:o.service_type||"N/A"})]}),(0,T.jsxs)(x.default,{style:Vn.row,children:[(0,T.jsx)(C.default,{style:Vn.label,children:i?"Your Payout:":"Total Cost:"}),(0,T.jsxs)(C.default,{style:Vn.value,children:["$",(()=>{if(o.cost_summary){if(i){const e=o.cost_summary.total_sitter_payout||"0.00";return"number"===typeof e?e.toFixed(2):parseFloat(e).toFixed(2)}{const e=o.cost_summary.total_client_cost||"0.00";return"number"===typeof e?e.toFixed(2):parseFloat(e).toFixed(2)}}if(i){const e=o.total_sitter_payout||"0.00";return"number"===typeof e?e.toFixed(2):parseFloat(e).toFixed(2)}{const e=o.total_owner_cost||"0.00";return"number"===typeof e?e.toFixed(2):parseFloat(e).toFixed(2)}})()]})]})]}),(0,T.jsxs)(x.default,{style:Vn.datesSection,children:["request_changes"!==e?(0,T.jsxs)(x.default,{style:Vn.datesSectionHeader,children:[(0,T.jsx)(C.default,{style:Vn.label,children:"Dates:"}),N&&(0,T.jsxs)(C.default,{style:Vn.datesCount,children:["(",W.length," total)"]})]}):null,H.map(((e,t)=>{const o=t===H.length-1,n=!(!_&&o&&N);return(0,T.jsx)(x.default,{style:[Vn.occurrenceContainer,n?null:{borderBottomWidth:0}],children:(0,T.jsxs)(x.default,{style:Vn.occurrenceItem,children:[(0,T.jsx)(C.default,{style:Vn.dateTimeText,children:O(e)}),(0,T.jsxs)(C.default,{style:Vn.durationText,children:["Event Duration: ",E(e)," (",e.timezone||w.split("/")[1]||w,")"]}),e.dst_message?(0,T.jsx)(C.default,{style:Vn.dstMessage,children:e.dst_message}):null]})},t)})),N&&(0,T.jsxs)(v.default,{style:Vn.showMoreButton,onPress:()=>{I(!_)},children:[(0,T.jsx)(C.default,{style:Vn.showMoreText,children:_?"Show Fewer Dates":"Show ".concat(U," More Date").concat(1!==U?"s":"")}),(0,T.jsx)(S.default,{name:_?"chevron-up":"chevron-down",size:18,color:m.theme.colors.primary})]})]}),D&&(0,T.jsxs)(x.default,{style:Vn.changeMessageContainer,children:[(0,T.jsx)(C.default,{style:Vn.changeMessageLabel,children:"Change Request Message:"}),(0,T.jsx)(C.default,{style:Vn.changeMessageText,children:o.content||"No details provided"})]}),(0,T.jsxs)(x.default,{style:Vn.buttonContainer,children:[(0,T.jsx)(v.default,{style:[Vn.detailsButton,M&&!R&&!y&&"booking_update"!==t&&Vn.disabledButton],onPress:F,disabled:M&&!R&&!y&&"booking_update"!==t,children:(0,T.jsx)(C.default,{style:Vn.detailsButtonText,children:R?"View Details":"Review Details"})}),"approval"===e&&!i&&!M&&!u&&(0,T.jsx)(v.default,{style:Vn.approveButton,onPress:async()=>{try{const e=await(0,Ze.approveBooking)(o.booking_id);s&&s(e)}catch(e){console.error("Error approving booking from message card:",e),l&&l(e.response?.data?.error||"Failed to approve booking")}},children:(0,T.jsx)(C.default,{style:Vn.approveButtonText,children:"Approve"})}),"request"===e&&i&&d&&!M&&(0,T.jsx)(v.default,{style:Vn.editButton,onPress:d,children:(0,T.jsx)(C.default,{style:Vn.editButtonText,children:"Edit Draft"})}),D&&i&&d&&(0,T.jsx)(v.default,{style:Vn.editButton,onPress:d,children:(0,T.jsx)(C.default,{style:Vn.editButtonText,children:"Edit Details"})})]})]})})]}),z&&(0,T.jsx)(x.default,{style:Vn.statusOverlay,children:(0,T.jsx)(C.default,{style:Vn.statusText,children:P})}),(0,T.jsx)(bo,{visible:j,onClose:()=>B(!1),bookingId:o.booking_id,onApproveSuccess:e=>{s&&s(e)},onApproveError:e=>{l&&l(e)},onRequestChangesSuccess:e=>{(0,g.debugLog)("MBA9999 Change request submitted successfully:",e),s&&s(e)},onRequestChangesError:e=>{(0,g.debugLog)("MBA9999 Error submitting change request:",e),l&&l(e)},initialData:k,isProfessional:i,isReadOnly:(M||R)&&"booking_update"!==t&&!y,hideButtons:(M||R)&&"booking_update"!==t&&!y,modalTitle:"booking_update"===t||y?"Booking Update":R||M?"Booking Details":"Booking Approval Request"})]})};var Yn=o(98055);const Gn=r.default.create({modalContainer:{backgroundColor:m.theme.colors.surface,padding:20,margin:20,borderRadius:8,maxWidth:500,alignSelf:"center"},content:{alignItems:"center"},title:{fontSize:20,fontWeight:"bold",marginBottom:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.header.fontFamily},description:{fontSize:16,marginBottom:24,textAlign:"center",color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},buttonContainer:{flexDirection:"row",justifyContent:"space-around",width:"100%",gap:16},button:{flex:1}}),Jn=({visible:e,onClose:t,onContinueExisting:o,onCreateNew:n})=>(0,T.jsx)(at.default,{children:(0,T.jsx)(Yn.default,{visible:e,onDismiss:t,contentContainerStyle:Gn.modalContainer,children:(0,T.jsxs)(x.default,{style:Gn.content,children:[(0,T.jsx)(C.default,{style:Gn.title,children:"Existing Draft Found"}),(0,T.jsx)(C.default,{style:Gn.description,children:"Would you like to continue with the existing draft or start a new one?"}),(0,T.jsxs)(x.default,{style:Gn.buttonContainer,children:[(0,T.jsx)(Re.default,{mode:"outlined",onPress:n,style:Gn.button,textColor:m.theme.colors.error,children:"Create New"}),(0,T.jsx)(Re.default,{mode:"contained",onPress:o,style:Gn.button,children:"Continue Existing"})]})]})})});var $n=o(65688);const Zn=(e,t,o={})=>{const{disabled:a=!1,handlerId:r=Math.random().toString(36).substr(2,9)}=o,[i,s]=(0,n.useState)(!1),[l,d]=(0,n.useState)("disconnected"),c=(0,n.useRef)(Date.now()),u=(0,n.useRef)(!1),m=(0,n.useRef)(0);(0,n.useEffect)((()=>{if(a)return;(0,g.debugLog)("MBA3210: useWebSocket hook initializing for ".concat(e,", handler ").concat(r));let o=[];(async()=>{try{const n=await(0,g.getStorage)("userToken");if(!n)return void(0,g.debugLog)("MBA3210: No token available for WebSocket connection");if($n.default.init(n),e&&!u.current){const n=$n.default.registerHandler(e,t,"".concat(r,"-").concat(e));o.push(n),u.current=!0,(0,g.debugLog)("MBA3210: Registered handler for ".concat(e))}const a=$n.default.registerHandler("connection",(e=>{const t=l,o=i;c.current=Date.now(),"connected"===e.status?((0,g.debugLog)("MBA3210: Setting connection status to connected"),s(!0),d("connected"),m.current=0):((0,g.debugLog)("MBA3210: Setting connection status to disconnected"),s(!1),d("disconnected")),(0,g.debugLog)("MBA3210: Connection status changed in hook: ".concat(t," -> ").concat(e.status)),(0,g.debugLog)("MBA3210: isConnected changed in hook: ".concat(o," -> ").concat("connected"===e.status))}),"".concat(r,"-connection"));o.push(a),(0,g.debugLog)("MBA3210: Registered connection status handler");const h=$n.default.registerHandler("user_status_update",(o=>{"user_status_update"!==e&&"*"!==e||t(o),(0,g.debugLog)("MBA3210: Received user status update for user ".concat(o.user_id,": ").concat(o.is_online?"online":"offline"))}),"".concat(r,"-user_status_update"));o.push(h),(0,g.debugLog)("MBA3210: Registered user status update handler"),$n.default.isConnected&&((0,g.debugLog)("MBA3210: WebSocket manager reports connected on init, updating state"),s(!0),d("connected"))}catch(n){(0,g.debugLog)("MBA3210: Error initializing WebSocket in hook: ".concat(n.message))}})();const n=setInterval((()=>{$n.default.isConnected?((0,g.debugLog)("MBA3210: Initial connection check: WebSocket is connected"),s(!0),d("connected"),clearInterval(n)):(0,g.debugLog)("MBA3210: Initial connection check: WebSocket not connected yet")}),1e3),h=setTimeout((()=>{clearInterval(n)}),5e3);return()=>{(0,g.debugLog)("MBA3210: useWebSocket hook cleaning up for ".concat(e,", handler ").concat(r)),o.forEach((e=>e())),clearInterval(n),clearTimeout(h),u.current=!1}}),[a,e,t,r]),(0,n.useEffect)((()=>{if(a)return;const e=setInterval((()=>{const e=Date.now(),t=(e-c.current)/1e3;if(t>30){(0,g.debugLog)("MBA3210: [MY CONNECTION] No updates on MY OWN connection in ".concat(t.toFixed(0)," seconds, verifying status"));const o=$n.default.isConnected;o!==i&&((0,g.debugLog)("MBA3210: [MY CONNECTION] State mismatch detected - WebSocket manager: ".concat(o,", hook state: ").concat(i)),s(o),d(o?"connected":"disconnected")),i?((0,g.debugLog)("MBA3210: [MY CONNECTION] Sending heartbeat to verify MY OWN connection"),$n.default.send("heartbeat")):o&&((0,g.debugLog)("MBA3210: [MY CONNECTION] Sending heartbeat despite disconnected state in hook"),$n.default.send("heartbeat")),c.current=e}}),15e3);return()=>clearInterval(e)}),[a,i]);const h=(0,n.useCallback)(((e,t)=>((0,g.debugLog)("MBA3210: [MY CONNECTION] Attempting to send ".concat(e," message through MY OWN WebSocket")),i?$n.default.send(e,t):((0,g.debugLog)("MBA3210: [MY CONNECTION] Cannot send message, MY OWN WebSocket not connected, falling back to REST"),(async()=>{try{const o=await(0,g.getStorage)("userToken");if(!o)return(0,g.debugLog)("MBA3210: [MY CONNECTION] No token available for REST message send"),!1;let n="".concat(f.API_BASE_URL,"/api/messages/v1/send_norm_message/"),a={conversation_id:t.conversation_id,content:t.content};"request_booking"===e&&(n="".concat(f.API_BASE_URL,"/api/messages/v1/send_request_booking/"),a=Object.assign({},a,t)),(0,g.debugLog)("MBA3210: [MY CONNECTION] Sending message via REST API to ".concat(n," (fallback for failed WebSocket)"));const r=await b.default.post(n,a,{headers:{Authorization:"Bearer ".concat(o),"Content-Type":"application/json"}});return setTimeout((()=>{$n.default.reconnect&&((0,g.debugLog)("MBA3210: [MY CONNECTION] Attempting reconnection after REST fallback"),$n.default.reconnect())}),1e3),r.data}catch(o){return(0,g.debugLog)("MBA3210: [MY CONNECTION] Error sending message via REST fallback: ".concat(o.message)),!1}})()))),[i]),p=(0,n.useCallback)(((e,t)=>e&&t&&0!==t.length?((0,g.debugLog)("MBA3210: [MY CONNECTION] Marking messages as read for conversation ".concat(e)),i?$n.default.markMessagesAsRead(e,t):((0,g.debugLog)("MBA3210: [MY CONNECTION] Cannot mark messages as read through WebSocket, using REST API instead"),(async()=>{try{const o=await(0,g.getStorage)("userToken");if(!o)return(0,g.debugLog)("MBA3210: [MY CONNECTION] No token available for REST mark as read"),!1;(0,g.debugLog)("MBA3210: [MY CONNECTION] Sending mark_read via REST API for ".concat(t.length," messages (fallback)"));return(await b.default.post("".concat(f.API_BASE_URL,"/api/messages/v1/mark_read/"),{conversation_id:e,message_ids:t},{headers:{Authorization:"Bearer ".concat(o),"Content-Type":"application/json"}})).data}catch(o){return(0,g.debugLog)("MBA3210: [MY CONNECTION] Error marking messages as read via REST fallback: ".concat(o.message)),!1}})())):((0,g.debugLog)("MBA3210: [MY CONNECTION] Skipping markMessagesAsRead - missing data"),Promise.resolve(!1))),[i]),y=((0,n.useCallback)((()=>{(0,g.debugLog)("MBA3210: [MY CONNECTION] Hook requesting reconnection of MY OWN WebSocket");try{$n.default.disconnect&&((0,g.debugLog)("MBA3210: [MY CONNECTION] Disconnecting MY OWN existing WebSocket before reconnect"),$n.default.disconnect()),setTimeout((()=>{$n.default.reconnect?((0,g.debugLog)("MBA3210: [MY CONNECTION] Calling websocketManager.reconnect() for MY OWN connection"),$n.default.reconnect()):$n.default.connect?((0,g.debugLog)("MBA3210: [MY CONNECTION] Calling websocketManager.connect() as fallback for MY OWN connection"),$n.default.connect()):((0,g.debugLog)("MBA3210: [MY CONNECTION] No reconnect method found, reinitializing MY OWN connection"),(0,g.getStorage)("userToken").then((e=>{e?$n.default.init(e):(0,g.debugLog)("MBA3210: [MY CONNECTION] No token available for WebSocket reconnection")})).catch((e=>{(0,g.debugLog)("MBA3210: [MY CONNECTION] Error getting token for reconnection: ".concat(e.message))})))}),300)}catch(e){(0,g.debugLog)("MBA3210: [MY CONNECTION] Error during reconnection of MY OWN connection: ".concat(e.message))}}),[]),(0,n.useCallback)((()=>{a||((0,g.debugLog)("MBA3210: useWebSocket hook explicitly disconnecting for ".concat(e,", handler ").concat(r)),$n.default.disconnect(),s(!1),d("disconnected"),m.current=0)}),[a,e,r]));return{isConnected:i,connectionStatus:l,sendMessage:h,markMessagesAsRead:p,reconnect:$n.default.reconnect?$n.default.reconnect.bind($n.default):null,disconnect:y,simulateConnection:$n.default.connect?$n.default.connect.bind($n.default):null,isUsingFallback:!i}},Kn=({messages:e,renderMessage:t,hasMore:o,isLoadingMore:a,onLoadMore:r,styles:i,theme:s})=>{const l=(0,n.useRef)(null),d=(0,n.useCallback)((()=>{(0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: onEndReached triggered",{messagesCount:e.length,hasMore:o,isLoadingMore:a}),o&&!a&&r()}),[o,a,r,e.length]),c=(0,n.useCallback)(((e,t)=>{if(e.message_id)return"message-".concat(e.message_id);const o=e.timestamp||e.created_at||Date.now(),n=e.sent_by_other_user?"other":"self",a=e.content?e.content.substring(0,10):"empty";return"message-".concat(o,"-").concat(n,"-").concat(a,"-").concat(t)}),[]);return(0,T.jsx)(wt.default,{ref:l,data:e,renderItem:t,keyExtractor:c,style:i.messageList,onEndReached:d,onEndReachedThreshold:.3,scrollEventThrottle:16,inverted:!0,maintainVisibleContentPosition:{minIndexForVisible:0,autoscrollToTopThreshold:10},contentContainerStyle:{flexGrow:1,justifyContent:"flex-end",paddingTop:16},ListFooterComponent:a&&(0,T.jsx)(_.default,{size:"small",color:s.colors.primary,style:i.loadingMore}),initialNumToRender:20,maxToRenderPerBatch:10,windowSize:15,removeClippedSubviews:!1})},Qn=({conversations:e,selectedConversation:t,onSelectConversation:o,searchQuery:n,onSearchChange:a,styles:r,CURRENT_USER_ID:i,getConversationUnreadCount:s,markConversationAsRead:l})=>{const d=e.filter((e=>{if(!n)return!0;return((e.participant1_id===i?e.participant2_name:e.participant1_name)||e.name||e.other_user_name||"").toLowerCase().includes(n.toLowerCase())||e.last_message&&e.last_message.toLowerCase().includes(n.toLowerCase())}));return(0,T.jsxs)(x.default,{style:r.conversationListContainer,children:[(0,T.jsx)(x.default,{style:r.searchContainer,children:(0,T.jsxs)(x.default,{style:r.searchInputContainer,children:[(0,T.jsx)(S.default,{name:"magnify",size:20,color:m.theme.colors.placeholder,style:r.searchIcon}),(0,T.jsx)(q.default,{style:r.searchInput,placeholder:"Search conversations...",placeholderTextColor:m.theme.colors.placeholder,value:n,onChangeText:a}),n.length>0&&(0,T.jsx)(v.default,{style:r.clearButton,onPress:()=>a(""),children:(0,T.jsx)(S.default,{name:"close-circle",size:16,color:m.theme.colors.placeholder})})]})}),d.map((e=>{const n=e.participant1_id===i?e.participant2_name:e.participant1_name,a=String(e.conversation_id)===String(t),d=s?s(String(e.conversation_id)):0;return(0,T.jsx)(v.default,{style:[r.conversationItem,a&&r.selectedConversation],onPress:()=>{o(e.conversation_id),l&&d>0&&((0,g.debugLog)("MBA4321: Marking conversation ".concat(e.conversation_id," as read when clicked")),l(e.conversation_id))},children:(0,T.jsxs)(x.default,{style:r.conversationContent,children:[(0,T.jsxs)(x.default,{style:r.conversationHeader,children:[(0,T.jsx)(x.default,{style:{flexDirection:"row",alignItems:"center",flex:1},children:(0,T.jsx)(C.default,{style:r.conversationName,children:n||e.name||e.other_user_name||"Unknown"})}),(0,T.jsx)(C.default,{style:r.conversationTime,children:new Date(e.last_message_time).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),(0,T.jsxs)(x.default,{style:r.conversationLastMessageContainer,children:[(0,T.jsx)(C.default,{style:[r.conversationLastMessage,a&&r.activeConversationText,(e.unread||d>0)&&!a&&r.unreadMessage],numberOfLines:1,children:e.last_message}),d>0&&!a&&(0,T.jsx)(x.default,{style:r.unreadBadge,children:(0,T.jsx)(C.default,{style:r.unreadBadgeText,children:d})})]}),e.bookingStatus&&(0,T.jsx)(x.default,{style:[r.bookingStatusContainer,r["booking".concat(e.bookingStatus,"Status")]||r.bookingPendingStatus],children:(0,T.jsx)(C.default,{style:r.bookingStatus,children:e.bookingStatus})})]})},e.conversation_id)}))]})},Xn=({navigation:e,route:t})=>{const{colors:i}=(0,G.useTheme)(),{screenWidth:s,isCollapsed:l}=(0,n.useContext)(g.AuthContext),d=(e=>r.default.create({container:{flex:1,backgroundColor:m.theme.colors.background,paddingTop:0,paddingRight:0,paddingLeft:0,height:e>900?"100vh":"calc(100vh - 64px)",overflow:"hidden",position:"fixed",top:e>900?0:64,left:0,right:0,bottom:0},headerContainer:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:16,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},headerTitle:{fontSize:20,fontWeight:"bold",color:m.theme.colors.primary,fontFamily:m.theme.fonts.header.fontFamily},filterButton:{marginLeft:"auto"},contentContainer:{flex:1,flexDirection:"row",justifyContent:"center",maxWidth:e>900?"100%":900,alignSelf:"center",width:"100%",overflow:"hidden",height:"100%"},mainSection:{flex:1,display:"flex",flexDirection:"column",maxWidth:"web"===a.default.OS?e<=900?"100%":"70%":"100%",alignSelf:e<=900?"stretch":"flex-start",width:e<=900?"100%":"auto",height:"100%"},conversationListContainer:{width:e<=900?"100%":"30%",maxWidth:e<900?"":600,backgroundColor:m.theme.colors.surfaceContrast,overflow:"auto"},conversationItem:{padding:16,maxWidth:e<900?"":600,width:"100%",borderBottomWidth:1,borderBottomColor:m.theme.colors.border},selectedConversation:{backgroundColor:m.theme.colors.primary+"20",borderLeftWidth:3,borderLeftColor:m.theme.colors.primary},conversationName:{fontSize:16,fontFamily:m.theme.fonts.header.fontFamily,flex:1},messageSection:Object.assign({flex:1,display:"flex",flexDirection:"column",overflow:"hidden",paddingHorizontal:5,backgroundColor:m.theme.colors.surface},"web"===a.default.OS&&e<=900?{paddingBottom:0}:{paddingBottom:8}),messageHeader:{padding:22,backgroundColor:m.theme.colors.surfaceContrast,width:"100%",flexDirection:"row",alignItems:"center",shadowColor:"#000",shadowOffset:{width:0,height:.5},shadowOpacity:.1,shadowRadius:3,elevation:3,zIndex:1},profilePhoto:{width:40,height:40,borderRadius:20,marginRight:12},messageHeaderName:{fontSize:18,fontWeight:"bold",color:m.theme.colors.text,fontFamily:m.theme.fonts.header.fontFamily},messagesContainer:Object.assign({flex:1,overflow:"auto",width:"100%"},"web"===a.default.OS&&e<=900?{paddingBottom:120,marginBottom:0}:{}),messageList:Object.assign({width:"100%",paddingBottom:16},"web"===a.default.OS&&e<=900?{paddingBottom:24}:{}),textInput:{flex:1,backgroundColor:m.theme.colors.background,borderRadius:20,paddingHorizontal:16,paddingVertical:8,marginHorizontal:8,fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},sendButton:{width:40,height:40,borderRadius:20,justifyContent:"center",alignItems:"center",marginLeft:8,paddingHorizontal:0,paddingVertical:0},sendButtonMobile:{width:32,height:32,borderRadius:16,paddingHorizontal:0,paddingVertical:0,marginHorizontal:0,minWidth:0},sendButtonActive:{backgroundColor:m.theme.colors.primary},sendButtonInactive:{backgroundColor:m.theme.colors.border},webInput:{flex:1,backgroundColor:m.theme.colors.surface,borderRadius:20,paddingHorizontal:20,paddingVertical:8,marginHorizontal:8,fontSize:18,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,maxHeight:120,minHeight:20,borderWidth:1,borderColor:m.theme.colors.border},input:{flex:1,backgroundColor:m.theme.colors.surface,borderRadius:20,paddingHorizontal:20,paddingVertical:8,marginHorizontal:8,fontSize:18,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,borderWidth:1,borderColor:m.theme.colors.border,minHeight:20},inputSection:Object.assign({width:"100%",padding:8,zIndex:1},"web"===a.default.OS&&e<=900?{position:"fixed",bottom:0,left:0,right:0,zIndex:1e3,backgroundColor:m.theme.colors.surfaceContrast,paddingTop:8,paddingBottom:8,shadowColor:"#000",shadowOffset:{width:0,height:-1},shadowOpacity:.1,shadowRadius:3,elevation:3}:{backgroundColor:m.theme.colors.surfaceContrast,paddingTop:8,paddingBottom:8}),inputContainer:{flexDirection:"row",alignItems:"center",width:"100%"},attachButtonContainer:{marginRight:8},attachButton:{padding:8,backgroundColor:m.theme.colors.surfaceContrast,borderRadius:20,width:40,height:40,justifyContent:"center",alignItems:"center"},inputInnerContainer:{flex:1,flexDirection:"row",alignItems:"center",backgroundColor:m.theme.colors.surfaceContrast,borderRadius:20,marginRight:8},dropdownMenu:{position:"absolute",bottom:"100%",left:0,backgroundColor:m.theme.colors.surface,borderRadius:8,shadowColor:"#000",shadowOffset:{width:0,height:-2},shadowOpacity:.25,shadowRadius:3.84,elevation:5,marginBottom:8,minWidth:150,borderWidth:1,borderColor:m.theme.colors.border},dropdownItem:{padding:12,flexDirection:"row",alignItems:"center"},dropdownText:{color:m.theme.colors.text,fontSize:14,marginLeft:8,fontFamily:m.theme.fonts.regular.fontFamily},messageCard:{marginVertical:4,maxWidth:e>900?"40%":"75%",borderRadius:12,overflow:"hidden"},messageContent:{paddingHorizontal:8,paddingVertical:4},sentMessage:{alignSelf:"flex-end",backgroundColor:m.theme.colors.primary},receivedMessage:{alignSelf:"flex-start",backgroundColor:m.theme.colors.receivedMessage},messageText:{fontSize:20,lineHeight:20,fontFamily:m.theme.fonts.regular.fontFamily},sentMessageContainer:{alignItems:"flex-end",marginBottom:4},receivedMessageContainer:{alignItems:"flex-start",marginBottom:4},sentMessageText:{color:m.theme.colors.whiteText},receivedMessageText:{color:m.theme.colors.text},searchContainer:{padding:16,backgroundColor:m.theme.colors.surfaceContrast},searchInputContainer:{flexDirection:"row",alignItems:"center",backgroundColor:m.theme.colors.surface,borderRadius:20,paddingHorizontal:12,marginVertical:6,height:40,borderWidth:1,borderColor:m.theme.colors.border},searchIcon:{marginRight:8},clearButton:{padding:4},searchInput:Object.assign({flex:1,height:"100%",fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},"web"===a.default.OS&&{WebkitTapHighlightColor:"transparent",WebkitAppearance:"none"}),conversationContent:{flex:1,width:"100%"},conversationHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:6,width:"100%"},conversationTime:{fontSize:12,color:m.theme.colors.placeholder},conversationLastMessageContainer:{flexDirection:"row",alignItems:"center",width:"100%",marginBottom:6},conversationLastMessage:{fontSize:14,color:m.theme.colors.placeholder,flex:1,fontFamily:m.theme.fonts.regular.fontFamily},unreadMessage:{color:m.theme.colors.text,fontWeight:"bold"},bookingStatusContainer:{backgroundColor:m.theme.colors.primary+"20",padding:4,borderRadius:4,alignSelf:"flex-start",marginTop:2},bookingStatus:{fontSize:12,color:m.theme.colors.primary,fontFamily:m.theme.fonts.regular.fontFamily},activeConversationText:{color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},unreadBadge:{backgroundColor:m.theme.colors.error,borderRadius:10,minWidth:18,height:18,justifyContent:"center",alignItems:"center",paddingHorizontal:4,marginLeft:8,alignSelf:"flex-start"},unreadBadgeText:{color:"white",fontSize:11,fontWeight:"bold",fontFamily:m.theme.fonts.regular.fontFamily},mobileHeader:{width:"100%",borderBottomWidth:1,borderBottomColor:m.theme.colors.border,position:"relative",zIndex:10,shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.1,shadowRadius:2,elevation:3},mobileHeaderContent:{flexDirection:"row",alignItems:"center",justifyContent:"center",position:"relative",paddingVertical:16,paddingHorizontal:8,width:"100%",minHeight:60},mobileHeaderName:{fontSize:18,fontWeight:"bold",color:m.theme.colors.text,textAlign:"center",fontFamily:m.theme.fonts.header.fontFamily,flexWrap:"wrap",maxWidth:"70%"},mobileHeaderNameContainer:{flexDirection:"row",alignItems:"center",justifyContent:"center",flexWrap:"wrap"},backArrow:{position:"absolute",left:16,zIndex:10,padding:8},editDraftButton:{flexDirection:"row",alignItems:"center",backgroundColor:m.theme.colors.surface,paddingHorizontal:12,paddingVertical:6,borderRadius:16,marginLeft:"auto",borderWidth:1,borderColor:m.theme.colors.primary},editDraftText:{marginLeft:4,color:m.theme.colors.primary,fontSize:14,fontFamily:m.theme.fonts.regular.fontFamily},mobileEditDraftButton:{marginRight:10,paddingHorizontal:8,paddingVertical:4,borderRadius:12,borderWidth:1,borderColor:m.theme.colors.primary,backgroundColor:m.theme.colors.surface,minWidth:55,alignSelf:"flex-start"},messageHeaderContent:{flexDirection:"row",alignItems:"center",flex:1},createBookingContainer:{position:"absolute",top:8,left:0,right:0,paddingHorizontal:16,alignItems:"center",zIndex:10,pointerEvents:"box-none"},createBookingHangingButton:{flexDirection:"row",alignItems:"center",backgroundColor:m.theme.colors.surface,paddingHorizontal:e<=600?12:16,paddingVertical:e<=600?8:10,borderRadius:20,borderWidth:1,borderColor:m.theme.colors.primary,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:3,elevation:3,width:"50%",justifyContent:"center"},createBookingHangingText:{marginLeft:8,color:m.theme.colors.primary,fontSize:e<=600?14:16,fontWeight:"500",fontFamily:m.theme.fonts.regular.fontFamily},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center"},loadingText:{marginTop:12,color:m.theme.colors.placeholder,fontSize:16,fontFamily:m.theme.fonts.regular.fontFamily},emptyText:{padding:16,color:m.theme.colors.placeholder,fontSize:16,fontFamily:m.theme.fonts.regular.fontFamily,textAlign:"center"},loadingMore:{padding:16},mobileMessageView:Object.assign({flex:1,width:"100%",height:"100%",position:"relative",backgroundColor:m.theme.colors.background,display:"flex",flexDirection:"column"},"web"===a.default.OS&&{minHeight:"100vh"}),mobileContainer:{paddingTop:0,paddingLeft:0,paddingRight:0}}))(s,l),[c,p]=(0,n.useState)(!0),[y,w]=(0,n.useState)(!1),[j,B]=(0,n.useState)(!1),[k,A]=(0,n.useState)(!1),[I,M]=(0,n.useState)(null),[D,R]=(0,n.useState)(null),[L,z]=(0,n.useState)([]),[P,F]=(0,n.useState)(!1),[O,E]=(0,n.useState)(!1),[W,N]=(0,n.useState)(!1),{is_DEBUG:H,is_prototype:V,isApprovedProfessional:Y,userRole:J,timeSettings:$}=(0,n.useContext)(g.AuthContext),[Z,K]=(0,n.useState)([]),[Q,X]=(0,n.useState)([]),[ee,te]=(0,n.useState)(!0),[oe,ne]=(0,n.useState)(1),[ae,re]=(0,n.useState)(!1),ie=(0,n.useRef)(s),[se,le]=((0,n.useRef)(!1),(0,n.useState)(!0)),de=(0,n.useRef)(!0),[ce,ue]=(0,n.useState)(!1),[me,ge]=(0,n.useState)(null),[he,fe]=(0,n.useState)(""),[pe,ye]=(0,n.useState)(!1),[be,Ce]=(0,n.useState)(null),[ve,we]=(0,n.useState)(!1),[je,Se]=(0,n.useState)("disconnected"),{resetNotifications:Te,updateRoute:Be,markConversationAsRead:ke,getConversationUnreadCount:Ae}=(0,n.useContext)(h.default),_e=(0,n.useRef)(!1),Me=(0,n.useRef)(!1),De=(0,n.useRef)(!1),Le=(0,n.useRef)(null),ze=(0,n.useRef)(null),Pe=(0,n.useRef)(!1),Fe=(0,n.useRef)(new Set),Oe=(0,n.useRef)(new Set),Ee=(0,n.useCallback)((e=>{(0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: WebSocket message received:",{type:e.type,conversationId:e.conversation_id,messageId:e.message_id,selectedConversation:I,currentMessageCount:L.length});try{if(!e||!e.message_id&&!e.conversation_id&&!e.type)return void(0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: Invalid message data received");if("user_status_update"===e.type&&e.user_id){(0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: [OTHER USER STATUS] Received online status update for user ID:",e.user_id);const t=String(e.user_id),o=!!e.is_online;if((0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: [OTHER USER STATUS] Processing status change for user ".concat(t,", online=").concat(o)),K((e=>{(0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: [OTHER USER STATUS] Checking ".concat(e.length," conversations for user ").concat(t));const n=e.map((e=>{const n=e.participant1_id?String(e.participant1_id):"",a=e.participant2_id?String(e.participant2_id):"";return t===n||t===a?((0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: [OTHER USER STATUS] Found match in conversation ".concat(e.conversation_id,", setting other_participant_online=").concat(o)),Object.assign({},e,{other_participant_online:o})):e})),a=n.filter(((t,o)=>t.other_participant_online!==e[o].other_participant_online)).length;return(0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: [OTHER USER STATUS] Updated ".concat(a," conversations with new status for user ").concat(t)),n})),D){const e=D.participant1_id?String(D.participant1_id):"",n=D.participant2_id?String(D.participant2_id):"";t!==e&&t!==n||((0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: [OTHER USER STATUS] Updating selected conversation with online status: ".concat(o," for user ").concat(t)),R((e=>Object.assign({},e,{other_participant_online:o}))))}return}I&&e.conversation_id&&String(e.conversation_id)===String(I)?((0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: Message is for current conversation, adding to list"),z((t=>{(0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: Before adding WebSocket message:",{currentMessageCount:t.length,newMessageId:e.message_id,newMessageContent:e.content?.substring(0,50)});if(t.some((t=>{if(t.message_id&&e.message_id&&String(t.message_id)===String(e.message_id))return(0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: Duplicate detected by ID"),!0;if(t.content===e.content&&t.sent_by_other_user===e.sent_by_other_user){if(!t.timestamp||!e.timestamp)return(0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: Duplicate detected by content+sender"),!0;if(Math.abs(new Date(t.timestamp).getTime()-new Date(e.timestamp).getTime())<5e3)return(0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: Duplicate detected by content+timestamp"),!0}return!(!t._isOptimistic||t.content!==e.content||e.sent_by_other_user)&&((0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: Found matching optimistic message, replacing"),!0)}))){if((0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: Message already exists in the list, skipping"),e.message_id){const o=t.map((t=>t._isOptimistic&&t.content===e.content&&!e.sent_by_other_user?Object.assign({},e,{_wasOptimistic:!0}):t));return(0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: Updated optimistic message with real data"),o}return t}(0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: Adding new message to list:",{messageId:e.message_id,messageLength:t.length,newMessageLength:t.length+1});const o=[e,...t];return(0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: Messages array updated via WebSocket:",{oldLength:t.length,newLength:o.length,addedMessageId:e.message_id}),o})),e.message_id&&Le.current&&e.sent_by_other_user&&((0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: Marking message as read:",e.message_id),Le.current(I,[e.message_id]))):e.conversation_id&&((0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: Message is for another conversation, updating conversation list"),K((t=>t.map((t=>String(t.conversation_id)===String(e.conversation_id)?Object.assign({},t,{last_message:e.content,last_message_time:e.timestamp,unread:!0}):t)))))}catch(t){(0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: Error handling WebSocket message:",t)}}),[I]),{isConnected:We,connectionStatus:Ne,markMessagesAsRead:He,reconnect:Ue,disconnect:Ve,simulateConnection:qe,isUsingFallback:Ye}=Zn("message",Ee,{handlerId:"message-history"});(0,n.useEffect)((()=>{Le.current=He}),[He]);(0,n.useCallback)((()=>{(0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: [CONNECTION] User manually requested WebSocket reconnection"),"function"===typeof Ue&&Ue()}),[Ue,D]);(0,n.useEffect)((()=>{Se(Ne),window&&window.WebSocket,"connected"===Ne&&We||Ye?(0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: [MY CONNECTION] Connection fully verified as connected or using fallback"):(0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: [MY CONNECTION] Connection not fully verified, status and state mismatch")}),[Ne,We,Ye]),(0,n.useEffect)((()=>{const e=setTimeout((()=>{(0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: [MY CONNECTION] Forcing reconnection on component mount"),"function"===typeof Ue&&Ue()}),1e3);return()=>clearTimeout(e)}),[Ue]),(0,n.useEffect)((()=>{if(!de.current)return;(0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: Component mounted - initializing data");return(async()=>{try{if(K([]),z([]),M(null),R(null),p(!0),w(!1),ne(1),te(!0),ze.current=null,"web"===a.default.OS){const e=new URL(window.location.href),t=e.searchParams.get("conversationId");if(e.searchParams.has("conversationId")&&(e.searchParams.delete("conversationId"),window.history.replaceState({},"",e.toString()),(0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: Cleared URL parameters on initial load")),t){await Ge();return void M(t)}}if(t.params?.conversationId){_e.current=!0,!0===t.params.isProfessional&&(De.current=!0,(0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: Will open booking creation after data loads"));await Ge();return M(t.params.conversationId),void e.setParams({messageId:null,conversationId:null,otherUserName:null,isProfessional:null,clientId:null})}const o=await Ge();"web"===a.default.OS&&s>900&&o?.length>0&&M(o[0].conversation_id)}catch(o){console.error("Error in initialization:",o)}finally{de.current=!1,le(!1),_e.current=!1}})(),()=>{(0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: Component unmounting - cleaning up"),K([]),z([]),M(null),R(null),de.current=!0,le(!0),_e.current=!1,Me.current=!1,De.current=!1,ze.current=null,window.selectedConversationId=null}}),[]),(0,n.useEffect)((()=>{de.current||_e.current||!t.params?.conversationId||(H&&console.log("MBA98765 Route params detected (non-reload):",{messageId:t.params.messageId,conversationId:t.params.conversationId,otherUserName:t.params.otherUserName,isProfessional:t.params.isProfessional,clientId:t.params.clientId}),_e.current=!0,!0===t.params.isProfessional&&(De.current=!0,H&&console.log("MBA98765 Will open booking creation after data loads")),M(t.params.conversationId),ne(1),te(!0),Ge().then((()=>{_e.current=!1})),e.setParams({messageId:null,conversationId:null,otherUserName:null,isProfessional:null,clientId:null}))}),[t.params]),(0,n.useEffect)((()=>{De.current&&D&&Me.current&&(H&&console.log("MBA98765 Conversation data and messages loaded, triggering booking creation",{conversationId:D.conversation_id,isProfessional:D.is_professional,hasDraft:pe,draftData:be?"exists":"none"}),De.current=!1,setTimeout((()=>{Ke()}),300))}),[D,Me.current,pe,be]),(0,n.useEffect)((()=>{if(!I||se)return void(H&&console.log("MBA98765 Skipping conversation data update - initial load or no conversation"));if(ze.current===I)return void(H&&console.log("MBA98765 Skipping redundant conversation update - already viewing this conversation"));H&&console.log("MBA98765 Selected conversation changed:",{id:I,type:typeof I,isHandlingRouteParams:_e.current}),window.selectedConversationId=I,(0,g.debugLog)("MBA4321: Updated global selectedConversationId to ".concat(I));const e=Z.find((e=>String(e.conversation_id)===String(I)));if(e){if((0,g.debugLog)("MBA3210: [OTHER USER STATUS] Setting selected conversation to ".concat(e.conversation_id,' with user "').concat(e.other_user_name,'"')),(0,g.debugLog)('MBA3210: [OTHER USER STATUS] Initial online status for "'.concat(e.other_user_name,'": ').concat(e.other_participant_online?"ONLINE":"OFFLINE")),R(e),ke&&((0,g.debugLog)("MBA4321: Marking ONLY conversation ".concat(I," as read when selected")),ke(I)),"web"===a.default.OS){const e=new URL(window.location.href);e.searchParams.set("conversationId",I),window.history.replaceState({},"",e.toString())}ne(1),te(!0),Me.current=!1,ze.current=I}else H&&console.log("MBA98765 Could not find conversation data for ID:",I),(0,g.debugLog)("MBA3210: [OTHER USER STATUS] Could not find conversation data for ID: ".concat(I))}),[I,Z,se,ke]),(0,n.useEffect)((()=>()=>{window.selectedConversationId=null,(0,g.debugLog)("MBA4321: Cleared global selectedConversationId on unmount")}),[]),(0,n.useEffect)((()=>{if(!I||se)return;const e=ze.current!==I;if(!e&&Me.current)return void(0,g.debugLog)("MBA4321: Skipping message fetch - conversation unchanged and messages already loaded");H&&console.log("MBA98765 Fetching messages for conversation:",{id:I,hasLoaded:Me.current,hasChanged:e,shouldOpenBookingCreation:De.current});let t=!0;return Me.current=!0,w(!0),Je(I,1).then((()=>{t&&(w(!1),De.current&&D&&H&&console.log("MBA98765 Messages loaded, now draft data is available"),ke&&e&&((0,g.debugLog)("MBA4321: Marking conversation ".concat(I," as read after successful message fetch")),ke(I)))})).catch((e=>{t&&(w(!1),console.error("Error fetching messages:",e))})),()=>{t=!1}}),[I,se,ke]),(0,n.useEffect)((()=>{const e=ie.current,t=e<=900&&s>900||e>900&&s<=900;H&&console.log("MBA98765 Screen width change:",{prev:e,current:s,crossedThreshold:t}),ie.current=s,t&&s>900&&Z.length>0&&!I&&(H&&console.log("MBA98765 Auto-selecting first conversation on width change"),M(Z[0].conversation_id))}),[s]),(0,n.useEffect)((()=>{if(""===he.trim())X(Z);else{const e=he.trim().toLowerCase(),t=Z.filter((t=>t.other_user_name&&t.other_user_name.toLowerCase().includes(e)));X(t)}}),[Z,he]);const Ge=async()=>{try{if(c&&Z.length>0&&!de.current)return(0,g.debugLog)("MBA3210: [OTHER USERS STATUS] Skipping duplicate conversation fetch - already loading"),Z;p(!0),(0,g.debugLog)("MBA3210: [OTHER USERS STATUS] Starting to fetch conversations with online status data");const e=await(0,g.getStorage)("userToken"),t="".concat(f.API_BASE_URL,"/api/conversations/v1/");(0,g.debugLog)("MBA3210: [OTHER USERS STATUS] Making API request to get conversations with online statuses");const o=await b.default.get(t,{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(o.data&&Array.isArray(o.data)){const e=o.data.map((e=>Object.assign({},e,{other_participant_online:e.other_participant_online||!1})));return e.forEach((e=>{const t=e.other_user_name||"Unknown";(0,g.debugLog)('MBA3210: [OTHER USERS STATUS] User "'.concat(t,'" (conversation ').concat(e.conversation_id,") online status: ").concat(e.other_participant_online?"ONLINE":"OFFLINE"))})),(0,g.debugLog)("MBA3210: [OTHER USERS STATUS] Fetched ".concat(e.length," conversations with online status data")),K(e),X(e),e}return[]}catch(e){return console.error("Error fetching conversations:",e),(0,g.debugLog)("MBA3210: [OTHER USERS STATUS] Error fetching conversation status data: ".concat(e.message)),[]}finally{p(!1)}},Je=async(e,t=1)=>{try{(0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: fetchMessages called",{conversationId:e,page:t,currentPage:oe,isLoadingMore:Pe.current,messagesLength:L.length,hasMore:ee,processedPagesSize:Fe.current.size});const o="".concat(e,"-").concat(t);if(Fe.current.has(o)&&t>1)return void(0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: Skipping duplicate fetch for page ".concat(t," of conversation ").concat(e));if(1===t)(0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: Fetching page 1 - resetting messages list"),w(!0),z([]),Fe.current.clear(),Oe.current.clear(),(0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: Reset state for page 1 fetch",{processedPagesCleared:0===Fe.current.size,messageIdsCleared:0===Oe.current.size});else{if(Pe.current)return void(0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: Already loading more messages, skipping request for page ".concat(t));(0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: Setting pagination loading state for page ".concat(t)),Pe.current=!0}Fe.current.add(o),(0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: Added page ".concat(o," to processed pages. Total processed: ").concat(Fe.current.size));const n=await(0,Ze.getConversationMessages)(e,t);(0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: API response received for page ".concat(t),{messageCount:n.messages?.length||0,hasNext:n.has_more,currentMessageCount:L.length,hasDraft:n.has_draft});const a=n.messages||[],r=a.filter((e=>e.message_id&&Oe.current.has(e.message_id)?((0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: Skipping duplicate message ".concat(e.message_id)),!1):(e.message_id&&Oe.current.add(e.message_id),!0)));(0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: Processed ".concat(a.length," messages, ").concat(r.length," unique for page ").concat(t)),1===t?((0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: Setting page 1 messages - count: ".concat(r.length)),z(r),w(!1),te(n.has_more||!1),ye(n.has_draft||!1),Ce(n.draft_data||null),(0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: Page 1 state updated",{messageCount:r.length,hasMore:n.has_more||!1,hasDraft:n.has_draft||!1}),setTimeout((()=>{(0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: Triggering force rerender after page 1 load")}),100)):((0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: Appending page ".concat(t," messages"),{newCount:r.length,existingCount:L.length,totalAfter:L.length+r.length}),z((e=>{(0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: Before pagination update",{existingMessagesLength:e.length,messagesToAdd:r.length,page:t});const o=new Set(e.map((e=>e.message_id)).filter(Boolean)),n=r.filter((e=>!e.message_id||!o.has(e.message_id)));(0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: Filtered messages for pagination",{uniqueMessagesFromAPI:r.length,afterDuplicateFilter:n.length,existingIdsCount:o.size});const a=[...e,...n];return(0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: Messages array updated via pagination",{before:e.length,added:n.length,after:a.length,pageBeingAdded:t}),a})),te(n.has_more||!1),re(!1),Pe.current=!1,(0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: Pagination state updated",{page:t,hasMore:n.has_more||!1,isLoadingMore:!1,currentPageAfter:t})),ne(t),(0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: fetchMessages completed successfully",{page:t,finalMessageCount:1===t?r.length:L.length+r.length,currentPage:t,hasMore:n.has_more||!1}),setTimeout((()=>{(0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: Messages state should be updated now",{page:t,addedCount:r.length,totalAfterUpdate:1===t?r.length:L.length+r.length,isLoadingMoreAfter:Pe.current,currentPageAfter:oe})}),100)}catch(o){(0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: Error in fetchMessages for page ".concat(t,":"),{error:o.message,response:o.response?.data,status:o.response?.status}),console.error("Error fetching messages:",o),w(!1),t>1&&(Pe.current=!1,re(!1))}},$e=async e=>{try{(0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: SendNormalMessage called",{messageLength:e.length,conversationId:I,currentMessageCount:L.length});const t=await(0,g.getStorage)("userToken"),o=await b.default.post("".concat(f.API_BASE_URL,"/api/messages/v1/send_norm_message/"),{conversation_id:I,content:e},{headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"}});return(0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: Message sent successfully",{messageId:o.data.message_id,timestamp:o.data.timestamp}),z((e=>((0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: Adding sent message to list",{beforeLength:e.length,afterLength:e.length+1,newMessageId:o.data.message_id}),[o.data,...e]))),K((t=>t.map((t=>t.conversation_id===I?Object.assign({},t,{last_message:e,last_message_time:o.data.timestamp}):t)))),(0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: SendNormalMessage completed successfully"),o.data}catch(t){throw(0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: Error in SendNormalMessage:",t),console.error("Error sending message:",t),t}},Ke=async()=>{if(H&&console.log("MBA98765 handleCreateBooking:",{selectedConversationData:D,selectedConversation:I,isProfessional:D?.is_professional,hasDraft:pe,draftData:be}),!D){console.log("MBA98765 No conversation data found, refreshing conversations"),await Ge();const e=Z.find((e=>e.conversation_id===I));if(!e)return void console.log("MBA98765 Still no conversation data after refresh");R(e),H&&console.log("MBA98765 Updated conversation data:",e)}const e=!0===D.is_professional;H&&console.log("MBA98765 Is Professional?",e),N(!1),e?(H&&console.log("MBA98765 User is professional - checking for existing draft",{hasDraft:pe,draftData:be}),pe&&be?we(!0):await Qe()):(console.log("MBA98765 User is owner - showing request modal"),E(!0))},Qe=async()=>{try{const e=await(0,g.getStorage)("userToken"),t=await b.default.post("".concat(f.API_BASE_URL,"/api/bookings/v1/create/"),{conversation_id:I},{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});H&&console.log("MBA98765 Create draft response:",t.data),await Je(I,1),t.data.draft_id&&(ge(t.data.draft_id),setTimeout((()=>{ue(!0)}),100))}catch(e){console.error("Error creating draft:",e),ft.default.alert("Error","Unable to create draft. Please try again.")}},Xe=(0,n.useCallback)((()=>{(0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: loadMoreMessages called",{hasMore:ee,isLoadingMore:ae,isLoadingMoreRef:Pe.current,currentPage:oe,selectedConversation:I,messagesLength:L.length}),ee&&!Pe.current&&I?((0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: Starting pagination load for page ".concat(oe+1)),Je(I,oe+1)):(0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: Not loading more messages - conditions not met",{hasMore:ee,isLoadingMoreRefCurrent:Pe.current,selectedConversation:!!I})}),[ee,oe,I,L.length]),et=(0,n.useCallback)((({item:t})=>{const o=(e=>{const t={};return e.forEach((e=>{if(e.metadata&&e.metadata.booking_id){const o=e.metadata.booking_id;t[o]||(t[o]=[]),t[o].push({messageId:e.message_id,type:e.type_of_message,timestamp:new Date(e.created_at||e.timestamp),message:e})}})),Object.keys(t).forEach((e=>{t[e].sort(((e,t)=>t.timestamp-e.timestamp))})),t})(L),n=L.filter((e=>"booking_confirmed"===e.type_of_message)).map((e=>e.metadata?.booking_id)).filter(Boolean),a={};n.forEach((e=>{const t=L.filter((t=>t.metadata?.booking_id===e)).sort(((e,t)=>new Date(t.timestamp)-new Date(e.timestamp))),o=t.find((e=>"booking_confirmed"===e.type_of_message));if(o){const n=new Date(o.timestamp),r=t.filter((e=>"send_approved_message"===e.type_of_message&&new Date(e.timestamp)>n));r.length>0&&(a[e]=!0,(0,g.debugLog)("MBA6428: Detected booking update for confirmed booking:",{bookingId:e,confirmationTime:n,newerApprovalRequests:r.map((e=>e.message_id))}))}}));t.metadata?.booking_id&&L.some((e=>"request_changes"===e.type_of_message&&e.metadata?.booking_id===t.metadata.booking_id));const r=t.metadata?.booking_id&&n.includes(t.metadata.booking_id),i=t.metadata?.booking_id&&a[t.metadata.booking_id];let s=!1,l=new Date(t.created_at||t.timestamp);if(t.metadata?.booking_id&&o[t.metadata.booking_id]){const e=o[t.metadata.booking_id];s=e.length>0&&e[0].messageId===t.message_id,(0,g.debugLog)("MBA7321: Message ".concat(t.message_id," for booking ").concat(t.metadata.booking_id," isNewestMessage: ").concat(s))}if("initial_booking_request"===t.type_of_message||"send_approved_message"===t.type_of_message){const o=!t.sent_by_other_user,n=t.metadata?.booking_id,a=n&&L.some((e=>"request_changes"===e.type_of_message&&e.metadata?.booking_id===n)),i="send_approved_message"===t.type_of_message,d=r?"Confirmed":t.metadata?.booking_status,c=i&&r&&n&&L.some((e=>"booking_confirmed"===e.type_of_message&&e.metadata?.booking_id===n&&new Date(e.timestamp)<new Date(t.timestamp))),m=c&&n&&L.some((e=>"request_changes"===e.type_of_message&&e.metadata?.booking_id===n&&new Date(e.timestamp)>new Date(t.timestamp)));c&&(0,g.debugLog)("MBA6428: Detected approval request for already confirmed booking:",{messageId:t.message_id,bookingId:n,isApprovalMessage:i,bookingIsConfirmed:r,isUpdateToConfirmedBooking:c,hasNewerRequestChanges:m});const h=D?.is_professional&&("initial_booking_request"===t.type_of_message||"send_approved_message"===t.type_of_message&&a);h&&(0,g.debugLog)("MBA6428: Showing edit draft button for message:",{messageId:t.message_id,bookingId:n,type:t.type_of_message});let f="0.00";try{t.metadata.cost_summary&&t.metadata.cost_summary.total_client_cost&&(f=t.metadata.cost_summary.total_client_cost)}catch(u){console.error("Error parsing total cost:",u)}return(0,T.jsx)(qn,{type:"initial_booking_request"===t.type_of_message?"request":"approval",displayType:c?"booking_update":void 0,data:Object.assign({},t.metadata,{booking_id:t.metadata.booking_id,service_type:t.metadata.service_type,total_owner_cost:f,occurrences:t.metadata.occurrences||[]}),isFromMe:o,onPress:()=>{t.metadata.booking_id&&e.navigate("BookingDetails",{bookingId:t.metadata.booking_id,from:"MessageHistory"})},isProfessional:D?.is_professional,onApproveSuccess:e=>{e&&e.status&&(ft.default.alert("Success","Booking approved successfully"),(0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: Refreshing messages after approval success"),Je(I,1))},onApproveError:e=>{ft.default.alert("Error",e||"Failed to approve booking")},onEditDraft:h?()=>{(0,g.debugLog)("MBA6428: Edit Draft button clicked, calling handleEditDraft with bookingId:",n),rt(n)}:void 0,bookingStatus:d,hasChangeRequest:a||m,isNewestMessage:s,messageCreatedAt:l,isAfterConfirmation:c})}if("request_changes"===t.type_of_message){const o=!t.sent_by_other_user,n=t.metadata?.booking_id,a=t.metadata?.service_type,i=r?"Confirmed":t.metadata?.booking_status;let d=s;if(!d&&"request_changes"===t.type_of_message&&n){const e=L.some((e=>"send_approved_message"===e.type_of_message&&e.metadata?.booking_id===n&&new Date(e.timestamp)>new Date(t.timestamp)));d=!e,(0,g.debugLog)("MBA4321: Checking if request_changes is effectively newest:",{messageId:t.message_id,originalIsNewest:s,hasNewerApprovals:e,effectivelyNewest:d})}const c=r&&n&&L.some((e=>("send_approved_message"===e.type_of_message||"booking_confirmed"===e.type_of_message)&&e.metadata?.booking_id===n));return(0,g.debugLog)("MBA4321: Rendering change request message:",{bookingId:n,isFromMe:o,content:t.content,metadata:t.metadata,isNewestMessage:s,isNewestChangeRequest:d,isConfirmed:r,isRelatedToUpdate:c,hasOlderBookingConfirmedMessage:L.some((e=>"booking_confirmed"===e.type_of_message&&e.metadata?.booking_id===n&&new Date(e.timestamp)<new Date(t.timestamp))),hasOlderApprovalMessage:L.some((e=>"send_approved_message"===e.type_of_message&&e.metadata?.booking_id===n&&new Date(e.timestamp)<new Date(t.timestamp)))}),(0,T.jsx)(qn,{type:"request_changes",data:Object.assign({},t.metadata,{booking_id:n,service_type:a,cost_summary:t.metadata?.cost_summary||{},occurrences:t.metadata?.occurrences||[],content:t.content}),isFromMe:o,onPress:()=>{n&&e.navigate("BookingDetails",{bookingId:n,from:"MessageHistory"})},isProfessional:D?.is_professional,onApproveSuccess:e=>{e&&e.status&&(ft.default.alert("Success","Changes handled successfully"),(0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: Refreshing messages after change approval"),Je(I,1))},onApproveError:e=>{ft.default.alert("Error",e||"Failed to process changes")},onEditDraft:D?.is_professional?()=>{rt(n)}:void 0,bookingStatus:i,hasChangeRequest:!1,isNewestMessage:d,messageCreatedAt:l,isAfterConfirmation:c})}if("booking_confirmed"===t.type_of_message){const o=!t.sent_by_other_user,n=t.metadata?.booking_id,a=t.metadata?.service_type;let r="0.00",d="0.00";try{t.metadata.cost_summary&&(r=t.metadata.cost_summary.total_client_cost||"0.00",d=t.metadata.cost_summary.total_sitter_payout||"0.00")}catch(u){console.error("Error parsing cost data:",u)}return(0,g.debugLog)("MBA6428: Rendering booking confirmation message:",{bookingId:n,isFromMe:o,metadata:t.metadata,totalCost:r,payout:d,hasNewerApprovalRequests:i}),(0,T.jsx)(qn,{type:"booking_confirmed",data:{booking_id:n,service_type:a,cost_summary:{total_client_cost:r,total_sitter_payout:d}},isFromMe:o,onPress:()=>{n&&e.navigate("BookingDetails",{bookingId:n,from:"MessageHistory"})},isProfessional:D?.is_professional,bookingStatus:"Confirmed",isNewestMessage:s,messageCreatedAt:l,onEditDraft:D?.is_professional?()=>{(0,g.debugLog)("MBA6428: Edit Draft button clicked for confirmed booking with bookingId:",n),rt(n)}:void 0,hasNewerApprovalRequests:i})}const c=!t.sent_by_other_user;return(0,T.jsx)(x.default,{style:c?d.sentMessageContainer:d.receivedMessageContainer,children:(0,T.jsx)(x.default,{style:[d.messageCard,c?d.sentMessage:d.receivedMessage],children:(0,T.jsx)(x.default,{style:d.messageContent,children:(0,T.jsx)(C.default,{style:[d.messageText,c?d.sentMessageText:d.receivedMessageText],children:t.content})})})})}),[e,D,$,pe,be,I,Je,L]),tt=()=>{const[e,t]=(0,n.useState)(""),o=(0,n.useRef)(null),a=(0,n.useRef)(!1),r=async()=>{if(e.trim()&&!P&&!a.current){a.current=!0,F(!0);try{const n=e.trim();t(""),o.current&&(o.current.style.height="24px",o.current.scrollTop=0);const a={message_id:"temp-".concat(Date.now(),"-").concat(Math.random().toString(36).substring(2,9)),content:n,timestamp:(new Date).toISOString(),status:"sent",type_of_message:"normal_message",is_clickable:!1,sent_by_other_user:!1,_isOptimistic:!0};z((e=>e.some((e=>e._isOptimistic&&e.content===n))?((0,g.debugLog)("MBA3210: Skipping duplicate optimistic message"),e):[a,...e]));const r=await $e(n);z((e=>{const t=e.filter((e=>!(e._isOptimistic&&e.content===n)));return t.some((e=>e.message_id&&r.message_id&&String(e.message_id)===String(r.message_id)))?((0,g.debugLog)("MBA3210: Real message already exists, skipping"),t):[r,...t]}))}catch(n){console.error("Failed to send message:",n),t(e),z((e=>e.filter((e=>!e._isOptimistic)))),ft.default.alert("Error","Failed to send message. Please try again.")}finally{F(!1),setTimeout((()=>{a.current=!1}),300)}}};return(0,T.jsxs)(x.default,{style:d.inputInnerContainer,children:[(0,T.jsx)("textarea",{ref:o,style:Object.assign({},d.webInput,{resize:"none",height:"auto",minHeight:"20px",paddingLeft:"10px",paddingRight:"10px"}),placeholder:"Type a message...",value:e,onChange:e=>{t(e.target.value),(()=>{if(o.current){const e=o.current.scrollTop;o.current.style.height="inherit";const t=Math.min(o.current.scrollHeight,120);o.current.style.height="".concat(t,"px"),o.current.scrollHeight>120&&(o.current.scrollTop=e)}})()},onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),r())},disabled:P,rows:1}),(0,T.jsx)(Re.default,{mode:"contained",onPress:r,disabled:P,style:[d.sendButton,s<=600&&d.sendButtonMobile],children:P?(0,T.jsx)(_.default,{color:m.theme.colors.whiteText,size:"small"}):s<=600?(0,T.jsx)(S.default,{name:"arrow-up",size:16,color:m.theme.colors.whiteText,style:{marginLeft:0,marginRight:0,marginTop:0,marginBottom:0,paddingHorizontal:0}}):"Send"})]})},ot=()=>{const[e,t]=(0,n.useState)(""),o=(0,n.useRef)(null),a=(0,n.useRef)(!1);return(0,T.jsxs)(x.default,{style:d.inputContainer,children:[(0,T.jsx)(q.default,{ref:o,style:d.input,placeholder:"Type a message...",value:e,onChangeText:t,multiline:!0,blurOnSubmit:!1,editable:!P}),(0,T.jsx)(Re.default,{mode:"contained",onPress:async()=>{if(e.trim()&&!P&&!a.current){a.current=!0,F(!0);try{const o=e.trim();t("");const n={message_id:"temp-".concat(Date.now(),"-").concat(Math.random().toString(36).substring(2,9)),content:o,timestamp:(new Date).toISOString(),status:"sent",type_of_message:"normal_message",is_clickable:!1,sent_by_other_user:!1,_isOptimistic:!0};z((e=>e.some((e=>e._isOptimistic&&e.content===o))?((0,g.debugLog)("MBA3210: Skipping duplicate optimistic message"),e):[n,...e]));const a=await $e(o);z((e=>{const t=e.filter((e=>!(e._isOptimistic&&e.content===o)));return t.some((e=>e.message_id&&a.message_id&&String(e.message_id)===String(a.message_id)))?((0,g.debugLog)("MBA3210: Real message already exists, skipping"),t):[a,...t]}))}catch(o){console.error("Failed to send message:",o),t(e),z((e=>e.filter((e=>!e._isOptimistic)))),ft.default.alert("Error","Failed to send message. Please try again.")}finally{F(!1),setTimeout((()=>{a.current=!1}),300)}}},disabled:P,children:P?(0,T.jsx)(_.default,{color:m.theme.colors.primary,size:"small"}):"Send"})]})},nt=("web"===a.default.OS?(0,T.jsx)(tt,{}):(0,T.jsx)(ot,{}),()=>(0,T.jsx)(Qn,{conversations:Z,selectedConversation:I,onSelectConversation:M,searchQuery:he,onSearchChange:fe,styles:d,CURRENT_USER_ID:xe,getConversationUnreadCount:Ae,markConversationAsRead:ke})),at=()=>I?(0,T.jsxs)(x.default,{style:d.mainSection,children:[s>900&&(0,T.jsx)(x.default,{style:d.messageHeader,children:(0,T.jsxs)(x.default,{style:d.messageHeaderContent,children:[(0,T.jsx)(U.default,{source:D?.profile_photo||o(4456),style:d.profilePhoto}),(0,T.jsx)(C.default,{style:d.messageHeaderName,children:D?.other_user_name}),pe&&be?.draft_id&&D?.is_professional&&(0,T.jsxs)(v.default,{style:d.editDraftButton,onPress:()=>{be?.draft_id&&it(be.draft_id)},children:[(0,T.jsx)(S.default,{name:"pencil",size:20,color:m.theme.colors.primary}),(0,T.jsx)(C.default,{style:d.editDraftText,children:"Edit Draft"})]})]})}),(0,T.jsxs)(x.default,{style:d.messageSection,children:[D?.is_professional&&(0,T.jsx)(x.default,{style:d.createBookingContainer,children:(0,T.jsxs)(v.default,{style:d.createBookingHangingButton,onPress:Ke,children:[(0,T.jsx)(S.default,{name:"calendar-plus",size:20,color:m.theme.colors.primary}),(0,T.jsx)(C.default,{style:d.createBookingHangingText,children:"Create Booking"})]})}),(0,T.jsx)(x.default,{style:d.messagesContainer,children:y?(0,T.jsxs)(x.default,{style:d.loadingContainer,children:[(0,T.jsx)(_.default,{size:"large",color:m.theme.colors.primary}),(0,T.jsx)(C.default,{style:d.loadingText,children:"Loading messages..."})]}):0===L.length?(0,T.jsx)(C.default,{style:d.emptyText,children:"No messages yet, start the conversation!"}):(0,T.jsx)(Kn,{messages:L,renderMessage:et,hasMore:ee,isLoadingMore:ae,onLoadMore:()=>Xe(I),styles:d,theme:m.theme})})]}),(0,T.jsx)(x.default,{style:d.inputSection,children:(0,T.jsxs)(x.default,{style:d.inputContainer,children:[(0,T.jsxs)(x.default,{style:d.attachButtonContainer,children:[(0,T.jsx)(v.default,{style:d.attachButton,onPress:()=>N(!W),children:(0,T.jsx)(S.default,{name:W?"close":"plus",size:24,color:m.theme.colors.primary})}),W&&(0,T.jsx)(x.default,{style:d.dropdownMenu,children:(0,T.jsxs)(v.default,{style:d.dropdownItem,onPress:()=>{N(!1)},children:[(0,T.jsx)(S.default,{name:"image",size:20,color:m.theme.colors.placeholder}),(0,T.jsx)(C.default,{style:[d.dropdownText,{color:m.theme.colors.placeholder}],children:"Coming Soon - Images"})]})})]}),"web"===a.default.OS?(0,T.jsx)(tt,{}):(0,T.jsx)(ot,{})]})})]}):null,rt=async e=>{if((0,g.debugLog)("MBA6428: handleEditDraft called with booking ID:",e),!e)return(0,g.debugLog)("MBA6428: Error - No booking ID provided"),void ft.default.alert("Error","Missing booking information. Please try again.");try{B(!0),(0,g.debugLog)("MBA6428: Calling createDraftFromBooking API with booking ID:",e);const t=await(0,Ze.createDraftFromBooking)(e);if(t.error)return(0,g.debugLog)("MBA6428: Error returned from createDraftFromBooking:",t),void ft.default.alert("Error",t.message||"Failed to create draft from booking. Please try again.");t&&t.draft_id?((0,g.debugLog)("MBA6428: Draft created successfully:",t),ye(!0),Ce(t.draft_data),ge(t.draft_id),we(!1),setTimeout((()=>{(0,g.debugLog)("MBA6428: Opening BookingStepModal with draft:",t.draft_id),ue(!0)}),100)):((0,g.debugLog)("MBA6428: Error - Invalid response from createDraftFromBooking:",t),ft.default.alert("Error","Failed to create draft from booking. Please try again."))}catch(t){(0,g.debugLog)("MBA6428: Error creating draft from booking:",t),ft.default.alert("Error","Failed to create draft from booking. Please try again.")}finally{B(!1)}},it=e=>{if((0,g.debugLog)("MBA6428: handleOpenExistingDraft called with draft ID:",e),!e)return(0,g.debugLog)("MBA6428: Error - No draft ID provided"),void ft.default.alert("Error","Missing draft information. Please try again.");try{ge(e),we(!1),setTimeout((()=>{(0,g.debugLog)("MBA6428: Opening BookingStepModal with existing draft:",e),ue(!0)}),100)}catch(t){(0,g.debugLog)("MBA6428: Error opening booking modal with draft:",t),ft.default.alert("Error","Failed to open booking draft. Please try again.")}};return(0,n.useEffect)((()=>{if(!D||!I)return;const e=D.other_user_name||"Unknown user";return(0,g.debugLog)('MBA3210: [OTHER USER STATUS] Setting up polling for "'.concat(e,'" online status')),()=>{(0,g.debugLog)('MBA3210: [OTHER USER STATUS] Cleaning up polling interval for "'.concat(e,'"'))}}),[D,I]),(0,n.useEffect)((()=>()=>{(0,g.debugLog)("MBA3210: MessageHistory unmounting, cleaning up websocket references")}),[]),(0,n.useEffect)((()=>{const e=()=>{(0,g.debugLog)("MBA3210: Page unloading, but keeping websocket alive for session restore")};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}}),[]),(0,n.useEffect)((()=>(Be&&Be("MessageHistory"),()=>{})),[]),(0,n.useEffect)((()=>(Be&&((0,g.debugLog)("MBA4321: Updating route in MessageNotificationContext to MessageHistory"),Be("MessageHistory")),()=>{(0,g.debugLog)("MBA4321: Cleaning up message notification tracking for MessageHistory")})),[Be]),(0,n.useEffect)((()=>{I&&ke&&((0,g.debugLog)("MBA4321: Marking conversation ".concat(I," as read")),ke(I))}),[I,ke]),(0,n.useEffect)((()=>{if(!de.current)return;return(async()=>{try{K([]),z([]),M(null),R(null),p(!0),w(!1),ne(1),te(!0),ze.current=null;let e=null;if("web"===a.default.OS){const t=new URL(window.location.href).searchParams.get("conversationId");t&&(e=t,(0,g.debugLog)("MBA4321: Using conversation ID ".concat(t," from URL parameters")))}!e&&t.params?.conversationId&&(e=t.params.conversationId,(0,g.debugLog)("MBA4321: Using conversation ID ".concat(e," from route parameters")),!0===t.params.isProfessional&&(De.current=!0));const o=await Ge();e?(M(e),(0,g.debugLog)("MBA4321: Setting initially selected conversation to ".concat(e))):"web"===a.default.OS&&s>900&&o?.length>0&&(M(o[0].conversation_id),(0,g.debugLog)("MBA4321: Auto-selecting first conversation ".concat(o[0].conversation_id," on desktop")))}catch(e){console.error("Error initializing MessageHistory:",e)}finally{de.current=!1,le(!1)}})(),()=>{(0,g.debugLog)("MBA4321: Cleaning up MessageHistory component"),ze.current=null,window.selectedConversationId=null}}),[]),(0,n.useEffect)((()=>{{const e=()=>{(0,g.debugLog)("MBA3210: Page unloading, but keeping websocket alive for session restore")};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}}}),[]),(0,n.useEffect)((()=>{I&&((0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: Clearing processed messages cache for new conversation",{conversationId:I,previousCacheSize:Fe.current.size,previousMessageIdsSize:Oe.current.size}),Fe.current.clear(),Oe.current.clear(),Pe.current=!1,(0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: Cache cleared for conversation switch",{processedPagesSize:Fe.current.size,messageIdsSize:Oe.current.size,isLoadingMoreRef:Pe.current}))}),[I]),(0,T.jsxs)(Ie.default,{style:[d.container,s<=900&&I&&d.mobileContainer,{marginLeft:s>900?l?70:250:0}],children:[c?(0,T.jsxs)(x.default,{style:{flex:1,justifyContent:"center",alignItems:"center"},children:[(0,T.jsx)(_.default,{size:"large",color:m.theme.colors.primary}),(0,T.jsx)(C.default,{style:{marginTop:16,color:m.theme.colors.placeholder},children:"Loading conversations..."})]}):Z.length>0?(0,T.jsx)(T.Fragment,{children:(0,T.jsx)(x.default,{style:d.contentContainer,children:s<=900?I?(0,T.jsxs)(x.default,{style:d.mobileMessageView,children:[(0,T.jsx)(x.default,{style:[d.mobileHeader,{backgroundColor:m.theme.colors.surfaceContrast}],children:(0,T.jsxs)(x.default,{style:d.mobileHeaderContent,children:[(0,T.jsx)(v.default,{style:d.backArrow,onPress:()=>M(null),children:(0,T.jsx)(S.default,{name:"arrow-left",size:24,color:m.theme.colors.primary})}),(0,T.jsx)(x.default,{style:d.mobileHeaderNameContainer,children:(0,T.jsx)(C.default,{style:d.mobileHeaderName,children:D?.name||D?.other_user_name})}),pe&&be?.draft_id&&D?.is_professional&&(0,T.jsxs)(v.default,{style:[d.editDraftButton,d.mobileEditDraftButton,{position:"absolute",right:10,top:"50%",transform:[{translateY:-20}]}],onPress:()=>{be?.draft_id&&it(be.draft_id)},children:[(0,T.jsx)(S.default,{name:"pencil",size:16,color:m.theme.colors.primary}),(0,T.jsxs)(x.default,{style:{alignItems:"center"},children:[(0,T.jsx)(C.default,{style:[d.editDraftText,{fontSize:12,lineHeight:14}],children:"Edit"}),(0,T.jsx)(C.default,{style:[d.editDraftText,{fontSize:12,lineHeight:14}],children:"Draft"})]})]})]})}),at()]}):nt():(0,T.jsxs)(T.Fragment,{children:[nt(),at()]})})}):(0,T.jsxs)(x.default,{style:{flex:1,justifyContent:"center",alignItems:"center",padding:20},children:[(0,T.jsx)(S.default,{name:"message-text-outline",color:m.theme.colors.placeholder,style:{marginBottom:16}}),(0,T.jsx)(C.default,{style:{fontSize:20,fontWeight:"bold",color:m.theme.colors.text,marginBottom:8,textAlign:"center"},children:"No Messages Yet"}),(0,T.jsx)(C.default,{style:{fontSize:16,color:m.theme.colors.placeholder,marginBottom:24,textAlign:"center"},children:"professional"===J?"Create services to start getting bookings and messages from owners":"Search professionals to find services and start messaging"}),(0,T.jsx)(Re.default,{mode:"contained",onPress:()=>(0,u.navigateToFrom)(e,"professional"===J?"ServiceManager":"SearchProfessionalsListing","MessageHistory"),style:{borderRadius:8},children:"professional"===J?"Create Services":"Find Professionals"})]}),j&&(0,T.jsx)(x.default,{style:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.4)",justifyContent:"center",alignItems:"center",zIndex:1e3},children:(0,T.jsxs)(x.default,{style:{backgroundColor:m.theme.colors.surface,borderRadius:12,padding:24,alignItems:"center",shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:3.84,elevation:5},children:[(0,T.jsx)(_.default,{size:"large",color:m.theme.colors.primary}),(0,T.jsx)(C.default,{style:{marginTop:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},children:"Creating draft from booking..."})]})}),(0,T.jsx)(bn,{visible:O,onClose:()=>E(!1),onSubmit:async e=>{try{(0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: handleBookingRequest called",{conversationId:e.conversation_id,currentMessageCount:L.length});const t=await(0,g.getStorage)("userToken"),o=await b.default.post("".concat(f.API_BASE_URL,"/api/bookings/v1/request_booking/"),e,{headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"}});(0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: Booking request created",{bookingId:o.data.booking_id});const n=await b.default.post("".concat(f.API_BASE_URL,"/api/messages/v1/send_request_booking/"),Object.assign({},e,{booking_id:o.data.booking_id}),{headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"}});(0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: Booking message sent",{messageId:n.data.message_id,bookingId:o.data.booking_id}),z((e=>((0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: Adding booking request message to list",{beforeLength:e.length,afterLength:e.length+1,messageId:n.data.message_id}),[n.data,...e]))),E(!1),(0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: handleBookingRequest completed successfully")}catch(t){(0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: Error in handleBookingRequest:",t),console.error("Error creating booking:",t),ft.default.alert("Error","Unable to create booking. Please try again.",[{text:"OK"}])}},conversationId:I}),(0,T.jsx)(Nn,{visible:ce,onClose:()=>{ue(!1),ge(null),I&&((0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: Refreshing message data after closing BookingStepModal"),Je(I,1))},navigation:e,bookingId:me,onComplete:e=>{if((0,g.debugLog)("MBA6428: Booking completed:",e),(0,g.debugLog)("MBA6428: New booking message:",e.message),(0,g.debugLog)("MBA6428: Message metadata:",e.message?.metadata),(0,g.debugLog)("MBA6428: Is this an update?",e.isUpdate),e.error)return ft.default.alert("Error",e.errorMessage||"Failed to process booking. Please try again."),ue(!1),ge(null),void(I&&((0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: Refreshing message data after booking error"),Je(I,1)));if(e.message){(0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: Adding booking completion message to list",{messageId:e.message.message_id,currentMessageCount:L.length}),z((t=>{const o=[e.message,...t];return(0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: Booking message added to list",{oldLength:t.length,newLength:o.length}),o}));const t=e.isUpdate?"Updated Booking Request":"Approval Request";K((o=>o.map((o=>o.conversation_id===I?Object.assign({},o,{last_message:t,last_message_time:e.message.timestamp}):o))))}ye(!1),Ce(null),ue(!1),ge(null),I&&((0,g.debugLog)("MBA2349f87g9qbh2nfv9cg: Refreshing message data after successful booking completion"),Je(I,1));const t=e.isUpdate?"Booking update request sent successfully!":"Booking request sent successfully!";ft.default.alert("Success",t)}}),(0,T.jsx)(Jn,{visible:ve,onClose:()=>we(!1),onContinueExisting:()=>{H&&console.log("MBA98765 handleContinueExisting:",{draftData:be,showDraftConfirmModal:ve,showBookingStepModal:ce}),we(!1),be?.draft_id?(ge(be.draft_id),setTimeout((()=>{H&&console.log("MBA98765 Opening BookingStepModal with draft:",be.draft_id),ue(!0)}),100)):console.error("MBA98765 No draft_id found in draftData:",be)},onCreateNew:async()=>{we(!1),await Qe()}})]})},ea=(e,t)=>r.default.create({mainContainer:{flex:1,backgroundColor:m.theme.colors.background,height:"100vh",overflow:"hidden",position:"fixed",top:0,left:0,right:0,bottom:0,marginLeft:e>900?t?70:250:0,transition:"margin-left 0.3s ease"},container:{flex:1},content:{flex:1,backgroundColor:m.theme.colors.background,paddingTop:"android"===a.default.OS?mt.default.currentHeight:0},listSection:{backgroundColor:m.theme.colors.surface},webContent:{width:"100%",maxWidth:e>900?800:600,alignSelf:"center",padding:e<=900?10:16},webListItem:{borderBottomWidth:1,borderBottomColor:m.theme.colors.border,paddingVertical:e<=900?8:12},listItemTitle:{fontSize:e<=900?m.theme.fontSizes.medium:m.theme.fontSizes.large,fontFamily:m.theme.fonts.regular.fontFamily},warningContainer:{backgroundColor:"#FFF3CD",padding:m.theme.spacing.small,marginHorizontal:m.theme.spacing.small,marginTop:m.theme.spacing.small,borderRadius:4},warningText:{color:"#856404",textAlign:"center"}}),ta=({navigation:e})=>{const{screenWidth:t,isCollapsed:o,is_DEBUG:r}=(0,n.useContext)(g.AuthContext),[i,s]=(0,n.useState)(t<=900),l=ea(t,o);(0,n.useEffect)((()=>{s(t<=900)}),[t]);const d=[{title:"Change Password",icon:"lock-reset",route:"ChangePassword"},{title:"Notification Preferences",icon:"bell-outline",route:"NotificationPreferences"},{title:"Privacy Settings",icon:"shield-account",route:"PrivacySettings"},{title:"Language",icon:"translate",route:"LanguageSettings"},{title:"Display & Accessibility",icon:"palette",route:"DisplaySettings"},{title:"Data Usage",icon:"chart-bar",route:"DataUsage"},{title:"About",icon:"information-outline",route:"About"}];return(0,T.jsx)(x.default,{style:l.mainContainer,children:(0,T.jsx)(Ie.default,{style:l.container,children:(0,T.jsxs)(x.default,{style:l.content,children:[i&&(0,T.jsx)(ut,{title:"Settings",onBackPress:()=>e.navigate("More")}),(0,T.jsx)(x.default,{style:l.webContent,children:(0,T.jsx)(To.default,{style:l.listSection,children:d.map(((o,r)=>(0,T.jsxs)(n.Fragment,{children:[(0,T.jsx)(So.default,{title:o.title,titleStyle:l.listItemTitle,left:e=>"web"===a.default.OS?(0,T.jsx)(S.default,{name:o.icon,size:t<=900?20:24,color:m.theme.colors.primary}):(0,T.jsx)(lo.default,Object.assign({},e,{icon:o.icon})),onPress:()=>e.navigate(o.route),style:[l.webListItem,{paddingHorizontal:t<=900?8:16}]}),r<d.length-1&&(0,T.jsx)(Bo.default,{})]},r)))})})]})})})},oa="Zen Exotics",na=r.default.create({container:{flex:1,padding:20,width:"100%",maxWidth:800,alignSelf:"center"},contentContainer:{paddingBottom:"web"===a.default.OS?16:80},title:{fontSize:24,fontWeight:"bold",marginBottom:10,color:m.theme.colors.primary},date:{fontSize:16,marginBottom:20,color:m.theme.colors.text},sectionTitle:{fontSize:20,fontWeight:"bold",marginTop:20,marginBottom:10,color:m.theme.colors.primary},paragraph:{fontSize:16,marginBottom:10,color:m.theme.colors.text},listItem:{fontSize:16,marginBottom:5,marginLeft:10,color:m.theme.colors.text}}),aa=()=>{const e=(0,y.useNavigation)();return(0,T.jsxs)(ht,{fullWidthHeader:!0,children:[(0,T.jsx)(ut,{title:"Privacy Policy",onBackPress:()=>(0,u.handleBack)(e)}),(0,T.jsxs)(H.default,{style:na.container,contentContainerStyle:na.contentContainer,children:[(0,T.jsxs)(C.default,{style:na.title,children:["Privacy Policy for ",oa]}),(0,T.jsx)(C.default,{style:na.date,children:"Effective Date: 10/21/2024"}),(0,T.jsxs)(C.default,{style:na.paragraph,children:["By accessing or using ",oa,", you agree to the practices described in this Privacy Policy. If you do not agree with these terms, please discontinue the use of our services immediately."]}),(0,T.jsx)(C.default,{style:na.sectionTitle,children:"Information We Collect"}),(0,T.jsxs)(C.default,{style:na.paragraph,children:["When you use ",oa,", we collect several types of information to ensure the best experience for both professionals and pet owners. This includes:"]}),(0,T.jsx)(C.default,{style:na.listItem,children:"\u2022 Personal Information: Name, email, phone number, address, and service preferences."}),(0,T.jsx)(C.default,{style:na.listItem,children:"\u2022 Payment Information: Card type, expiration date, and the last four digits of your payment card. Complete payment details are managed by third-party processors, and we do not store full card numbers."}),(0,T.jsx)(C.default,{style:na.listItem,children:"\u2022 Health Data: Medical information about your pets (e.g., medical history, medications, vaccinations, behavioral traits). By using this service, you consent to our use of this health data as we deem necessary for analytics, research, marketing, or any other purpose related to improving our services."}),(0,T.jsx)(C.default,{style:na.listItem,children:"\u2022 Device Data: We collect information about your device, including IP address, browser type, operating system, and other usage data."}),(0,T.jsx)(C.default,{style:na.listItem,children:"\u2022 Location Data: With your permission, we collect location information to match professionals and owners more effectively. Disabling location services may limit certain app features."}),(0,T.jsx)(C.default,{style:na.listItem,children:"\u2022 Cookies and Tracking: We use cookies and tracking technologies to improve user experience and monitor traffic patterns. You can disable cookies in your browser settings."}),(0,T.jsx)(C.default,{style:na.sectionTitle,children:"How We Use Your Data"}),(0,T.jsx)(C.default,{style:na.paragraph,children:"We use the data we collect to:"}),(0,T.jsx)(C.default,{style:na.listItem,children:"\u2022 Facilitate bookings and transactions between professionals and owners."}),(0,T.jsx)(C.default,{style:na.listItem,children:"\u2022 Verify professional eligibility through background checks."}),(0,T.jsx)(C.default,{style:na.listItem,children:"\u2022 Provide customer support and resolve disputes between users."}),(0,T.jsx)(C.default,{style:na.listItem,children:"\u2022 Improve app functionality through analytics and feedback."}),(0,T.jsx)(C.default,{style:na.listItem,children:"\u2022 Manage communications between professionals and owners."}),(0,T.jsx)(C.default,{style:na.listItem,children:"\u2022 Use health data for internal analysis and marketing purposes. We retain control over how this data is used."}),(0,T.jsx)(C.default,{style:na.sectionTitle,children:"Sharing of Information"}),(0,T.jsx)(C.default,{style:na.paragraph,children:"We may share your data in the following ways:"}),(0,T.jsx)(C.default,{style:na.listItem,children:"\u2022 With Other Users: For bookings, we share relevant information between professionals and pet owners."}),(0,T.jsx)(C.default,{style:na.listItem,children:"\u2022 With Third-Party Providers: Payment processors, analytics providers, and background check services may access limited information to perform their services."}),(0,T.jsx)(C.default,{style:na.listItem,children:"\u2022 Legal and Compliance Purposes: We may disclose information if required by law or to protect the safety and security of our users."}),(0,T.jsx)(C.default,{style:na.listItem,children:"\u2022 Business Transfers: In case of a merger, sale, or acquisition, your data may be transferred to a new owner."}),(0,T.jsx)(C.default,{style:na.listItem,children:"\u2022 Aggregated Data: We may share non-identifiable, aggregated data for research or business purposes."}),(0,T.jsx)(C.default,{style:na.sectionTitle,children:"Your Rights and Choices"}),(0,T.jsx)(C.default,{style:na.listItem,children:"\u2022 Account Management: You can update or delete your account information through the app settings."}),(0,T.jsx)(C.default,{style:na.listItem,children:"\u2022 Health Data Access: You may review the health data associated with your pets but agree that we control its use."}),(0,T.jsx)(C.default,{style:na.listItem,children:"\u2022 Location Services: Manage your location preferences through your device settings."}),(0,T.jsx)(C.default,{style:na.listItem,children:"\u2022 Cookie Preferences: You can opt out of personalized ads and tracking through your browser settings."}),(0,T.jsx)(C.default,{style:na.sectionTitle,children:"Security and Data Retention"}),(0,T.jsx)(C.default,{style:na.paragraph,children:"We implement reasonable security measures to protect your data, though no system is entirely secure. We retain your data as long as needed for operational purposes or as required by law."}),(0,T.jsx)(C.default,{style:na.sectionTitle,children:"International Data Transfers"}),(0,T.jsx)(C.default,{style:na.paragraph,children:"Your data may be processed or stored in countries outside your own. By using the app, you agree to these transfers, even if those countries have different data protection laws."}),(0,T.jsx)(C.default,{style:na.sectionTitle,children:"Changes to This Privacy Policy"}),(0,T.jsx)(C.default,{style:na.paragraph,children:"We may update this policy from time to time to reflect changes in our practices or services. We will notify you of significant changes through the app or via email. Continued use of the app constitutes acceptance of the revised policy."}),(0,T.jsx)(C.default,{style:na.sectionTitle,children:"Contact Us"}),(0,T.jsx)(C.default,{style:na.paragraph,children:"If you have questions or concerns about this policy, please contact us:"}),(0,T.jsx)(C.default,{style:na.listItem,children:"Email: zam.hh.llc@gmail.com"}),(0,T.jsx)(C.default,{style:na.listItem,children:"Phone: 7195106341"})]})]})},ra=r.default.create({container:{flex:1,padding:20,backgroundColor:m.theme.colors.background},title:{fontSize:24,fontWeight:"bold",marginBottom:20,color:m.theme.colors.primary}}),ia=()=>(0,T.jsxs)(x.default,{style:ra.container,children:[(0,T.jsx)(C.default,{style:ra.title,children:"Professional Settings"}),(0,T.jsx)(C.default,{children:"Manage your professional profile and preferences here."})]}),sa="Zen Exotics",la=r.default.create({container:{flex:1,padding:20},contentContainer:{paddingBottom:80},title:{fontSize:24,fontWeight:"bold",marginBottom:10,color:m.theme.colors.primary},date:{fontSize:16,marginBottom:20,color:m.theme.colors.text},sectionTitle:{fontSize:20,fontWeight:"bold",marginTop:20,marginBottom:10,color:m.theme.colors.primary},paragraph:{fontSize:16,marginBottom:10,color:m.theme.colors.text},listItem:{fontSize:16,marginBottom:5,marginLeft:10,color:m.theme.colors.text},testSection:{marginBottom:20,borderWidth:1,borderColor:m.theme.colors.border,padding:10,borderRadius:4}}),da=()=>{const e=(0,y.useNavigation)();return(0,T.jsxs)(ht,{fullWidthHeader:!0,children:[(0,T.jsx)(ut,{title:"Terms of Service",onBackPress:()=>(0,u.handleBack)(e)}),(0,T.jsx)(C.default,{children:"Terms of Service coming soon. Right now we are in prototype mode, so no data is saved except for email/name if you choose to contact us through this platform, then it is saved for marketing purposes."}),(0,T.jsxs)(H.default,{style:la.container,contentContainerStyle:la.contentContainer,children:[(0,T.jsxs)(C.default,{style:la.title,children:["Terms of Service for ",sa]}),(0,T.jsx)(C.default,{style:la.date,children:"Effective Date: 10/21/2024"}),(0,T.jsxs)(C.default,{style:la.paragraph,children:["Welcome to ",sa,'! By using our platform, mobile application, or any services offered through our platform (collectively, "the Service"), you agree to be bound by these Terms of Service ("Terms"). If you do not agree to these Terms, you must discontinue use of the Service immediately.']}),(0,T.jsx)(C.default,{style:la.sectionTitle,children:"1. Description of Service"}),(0,T.jsxs)(C.default,{style:la.paragraph,children:[sa," provides an online platform for connecting pet owners with professionals specializing in exotic animals, as well as dogs and cats. Users can book services, communicate with professionals, and manage pet-related services, including payments and reviews."]}),(0,T.jsx)(C.default,{style:la.sectionTitle,children:"2. User Accounts"}),(0,T.jsx)(C.default,{style:la.paragraph,children:"To use certain features of the Service, you must create an account. You are responsible for keeping your account information accurate and secure."}),(0,T.jsx)(C.default,{style:la.listItem,children:"\u2022 Eligibility: Users must be at least 18 years old to create an account."}),(0,T.jsx)(C.default,{style:la.listItem,children:"\u2022 Account Security: You are responsible for all activities under your account. Notify us immediately if you suspect unauthorized use."}),(0,T.jsx)(C.default,{style:la.listItem,children:"\u2022 Account Termination: We reserve the right to suspend or terminate accounts at our sole discretion for violations of these Terms."}),(0,T.jsx)(C.default,{style:la.sectionTitle,children:"3. User Conduct and Acceptable Use"}),(0,T.jsx)(C.default,{style:la.paragraph,children:"By using the Service, you agree:"}),(0,T.jsx)(C.default,{style:la.listItem,children:"\u2022 To provide accurate and complete information."}),(0,T.jsx)(C.default,{style:la.listItem,children:"\u2022 Not to engage in fraudulent or unlawful activities."}),(0,T.jsx)(C.default,{style:la.listItem,children:"\u2022 Not to use the Service for spam, harassment, or abusive behavior toward other users."}),(0,T.jsx)(C.default,{style:la.listItem,children:"\u2022 To comply with all local, national, and international laws applicable to your activities on the platform."}),(0,T.jsx)(C.default,{style:la.paragraph,children:"Failure to comply with these rules may result in account suspension or termination."}),(0,T.jsx)(C.default,{style:la.sectionTitle,children:"4. Pet and Health Information"}),(0,T.jsx)(C.default,{style:la.paragraph,children:"You acknowledge that the Service involves the collection and sharing of health-related data for pets. By using the Service, you agree to provide accurate medical information for your animals and grant us permission to use and share this data as outlined in our Privacy Policy."}),(0,T.jsx)(C.default,{style:la.sectionTitle,children:"5. Payment Terms"}),(0,T.jsx)(C.default,{style:la.paragraph,children:"All transactions between pet owners and professionals must be processed through the platform's payment system, powered by Stripe. You agree to the following:"}),(0,T.jsx)(C.default,{style:la.listItem,children:"\u2022 Booking Fees: You will be charged the agreed-upon amount at the time of booking."}),(0,T.jsx)(C.default,{style:la.listItem,children:"\u2022 Cancellations and Refunds: Cancellations are subject to our cancellation policy, which may result in partial or no refunds."}),(0,T.jsx)(C.default,{style:la.listItem,children:"\u2022 Payouts to Professionals: Professionals must provide accurate payment information and comply with local tax regulations."}),(0,T.jsx)(C.default,{style:la.sectionTitle,children:"6. Liability and Disclaimer of Warranties"}),(0,T.jsxs)(C.default,{style:la.paragraph,children:["You acknowledge that ",sa," does not guarantee the quality or safety of services provided by professionals. Our platform only facilitates connections between users."]}),(0,T.jsx)(C.default,{style:la.listItem,children:"\u2022 We are not liable for any injury, damage, or loss caused during the provision of pet care services."}),(0,T.jsx)(C.default,{style:la.listItem,children:'\u2022 The Service is provided "as is" and "as available" without warranties of any kind, express or implied.'}),(0,T.jsx)(C.default,{style:la.sectionTitle,children:"7. Dispute Resolution Between Users"}),(0,T.jsxs)(C.default,{style:la.paragraph,children:["Disputes between users (e.g., pet owners and professionals) must first be addressed directly between the parties. If no resolution is reached, ",sa," may mediate but is not responsible for the outcome."]}),(0,T.jsx)(C.default,{style:la.sectionTitle,children:"8. Limitation of Liability"}),(0,T.jsxs)(C.default,{style:la.paragraph,children:["In no event shall ",sa,", its affiliates, officers, employees, or partners be liable for:"]}),(0,T.jsx)(C.default,{style:la.listItem,children:"\u2022 Indirect, incidental, or consequential damages arising from the use of the Service."}),(0,T.jsx)(C.default,{style:la.listItem,children:"\u2022 Any claims exceeding the amount you paid through the Service within the last six months."}),(0,T.jsx)(C.default,{style:la.sectionTitle,children:"9. Termination and Suspension"}),(0,T.jsx)(C.default,{style:la.paragraph,children:"We reserve the right to suspend or terminate access to the Service at any time without notice if:"}),(0,T.jsx)(C.default,{style:la.listItem,children:"\u2022 You breach these Terms."}),(0,T.jsx)(C.default,{style:la.listItem,children:"\u2022 Your actions jeopardize the safety or security of the platform or other users."}),(0,T.jsx)(C.default,{style:la.sectionTitle,children:"10. Modifications to the Service and Terms"}),(0,T.jsx)(C.default,{style:la.paragraph,children:"We may modify these Terms or the Service at any time. Significant changes will be communicated via email or in-app notifications. Continued use of the Service after changes constitutes acceptance of the revised Terms."}),(0,T.jsx)(C.default,{style:la.sectionTitle,children:"11. Intellectual Property Rights"}),(0,T.jsxs)(C.default,{style:la.paragraph,children:["All content, trademarks, and logos on the platform are owned by or licensed to ",sa,". You may not copy, modify, or distribute content without express permission."]}),(0,T.jsx)(C.default,{style:la.sectionTitle,children:"12. Governing Law and Dispute Resolution"}),(0,T.jsx)(C.default,{style:la.paragraph,children:"These Terms are governed by the laws of El Paso County, Colorado, without regard to conflict of law principles."}),(0,T.jsx)(C.default,{style:la.listItem,children:"\u2022 Arbitration Clause: All disputes arising under these Terms shall be resolved through binding arbitration in Colorado Springs, Colorado."}),(0,T.jsx)(C.default,{style:la.listItem,children:"\u2022 Class Action Waiver: You agree to waive your right to participate in class action lawsuits."}),(0,T.jsx)(C.default,{style:la.sectionTitle,children:"13. Indemnification"}),(0,T.jsxs)(C.default,{style:la.paragraph,children:["You agree to indemnify and hold harmless ",sa,", its affiliates, officers, and employees from any claims, damages, or liabilities arising from your use of the Service or breach of these Terms."]}),(0,T.jsx)(C.default,{style:la.sectionTitle,children:"14. Third-Party Links and Services"}),(0,T.jsxs)(C.default,{style:la.paragraph,children:["The platform may contain links to third-party websites or services. ",sa," is not responsible for the content or actions of those third parties."]}),(0,T.jsx)(C.default,{style:la.sectionTitle,children:"15. Contact Us"}),(0,T.jsx)(C.default,{style:la.paragraph,children:"If you have questions about these Terms, please contact us:"}),(0,T.jsx)(C.default,{style:la.listItem,children:"Email: zam.hh.llc@gmail.com"}),(0,T.jsx)(C.default,{style:la.listItem,children:"Phone: 7195106341"}),(0,T.jsx)(C.default,{style:la.sectionTitle,children:"Acknowledgment of Agreement"}),(0,T.jsxs)(C.default,{style:la.paragraph,children:["By accessing or using ",sa,", you acknowledge that you have read, understood, and agreed to these Terms of Service."]})]})]})},ca=r.default.create({container:{flex:1,padding:20,backgroundColor:m.theme.colors.background},title:{fontSize:24,fontWeight:"bold",marginBottom:20,color:m.theme.colors.primary}}),ua=()=>(0,T.jsxs)(H.default,{style:ca.container,children:[(0,T.jsx)(C.default,{style:ca.title,children:"Help / FAQ"}),(0,T.jsx)(C.default,{children:"Frequently asked questions and help topics go here..."})]}),ma=r.default.create({container:{flex:1,width:"100%",alignItems:"center",justifyContent:"center",paddingVertical:20,minHeight:"80vh"},contentWrapper:{padding:20,alignItems:"center",backgroundColor:"white",borderRadius:10,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3,maxWidth:"100%"},title:{fontSize:m.theme.fontSizes.largeLarge,fontWeight:"bold",marginBottom:10,color:m.theme.colors.primary,fontFamily:m.theme.fonts.header.fontFamily,textAlign:"center"},subtitle:{fontSize:m.theme.fontSizes.medium,marginBottom:20,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,textAlign:"center"},input:{backgroundColor:m.theme.colors.surface,borderRadius:5,borderColor:m.theme.colors.border,borderWidth:1,padding:15,marginBottom:15,fontSize:m.theme.fontSizes.medium,width:"100%",fontFamily:m.theme.fonts.regular.fontFamily},messageInput:{height:120,textAlignVertical:"top"},button:{backgroundColor:m.theme.colors.primary,padding:15,borderRadius:5,alignItems:"center",width:"100%",marginTop:10},buttonText:{color:m.theme.colors.whiteText,fontSize:m.theme.fontSizes.mediumLarge,fontWeight:"bold",fontFamily:m.theme.fonts.regular.fontFamily},successMessage:{color:m.theme.colors.success,textAlign:"center",marginBottom:10,fontSize:m.theme.fontSizes.medium,fontFamily:m.theme.fonts.regular.fontFamily,width:"100%"},disabledButton:{opacity:.7}}),ga=()=>{(0,y.useNavigation)();const{screenWidth:e,isCollapsed:t}=(0,n.useContext)(g.AuthContext),[o,r]=(0,Q.useForm)("mkgobpro"),[i,s]=(0,n.useState)(""),[l,d]=(0,n.useState)(""),[c,u]=(0,n.useState)(""),[h,p]=(0,n.useState)(!1),[w,j]=(0,n.useState)(""),S=e<900,B=S?"90%":"600px",k=S?"100%":"800px";return o.succeeded?(0,T.jsx)(ht,{fullWidthHeader:!1,contentWidth:k,style:S||"web"!==a.default.OS?{}:{marginLeft:t?"70px":"250px",width:"calc(100% - ".concat(t?"70px":"250px",")"),transition:"margin-left 0.3s ease, width 0.3s ease"},children:(0,T.jsx)(x.default,{style:ma.container,children:(0,T.jsxs)(x.default,{style:[ma.contentWrapper,{width:B}],children:[(0,T.jsx)(C.default,{style:[ma.title,{color:m.theme.colors.primary}],children:"Thanks for reaching out!"}),(0,T.jsx)(C.default,{style:ma.successMessage,children:"We'll get back to you soon."})]})})}):(0,T.jsx)(ht,{fullWidthHeader:!1,contentWidth:k,style:S||"web"!==a.default.OS?{}:{marginLeft:t?"70px":"250px",width:"calc(100% - ".concat(t?"70px":"250px",")"),transition:"margin-left 0.3s ease, width 0.3s ease"},children:(0,T.jsx)(x.default,{style:ma.container,children:(0,T.jsxs)(x.default,{style:[ma.contentWrapper,{width:B}],children:[(0,T.jsx)(C.default,{style:ma.title,children:"Contact Us"}),(0,T.jsx)(C.default,{style:ma.subtitle,children:"Get in touch with our support team"}),(0,T.jsx)(q.default,{style:ma.input,placeholder:"Your Name",value:i,onChangeText:s,name:"name"}),(0,T.jsx)(Q.ValidationError,{prefix:"Name",field:"name",errors:o.errors}),(0,T.jsx)(q.default,{style:ma.input,placeholder:"Your Email",value:l,onChangeText:d,keyboardType:"email-address",name:"email",autoCapitalize:"none"}),(0,T.jsx)(Q.ValidationError,{prefix:"Email",field:"email",errors:o.errors}),(0,T.jsx)(q.default,{style:[ma.input,ma.messageInput],placeholder:"Your Message",value:c,onChangeText:u,multiline:!0,name:"message"}),(0,T.jsx)(Q.ValidationError,{prefix:"Message",field:"message",errors:o.errors}),w?(0,T.jsx)(C.default,{style:ma.successMessage,children:w}):null,(0,T.jsx)(v.default,{style:[ma.button,h&&ma.disabledButton],onPress:async()=>{if(i&&l&&c){p(!0),j("");try{if(200!==(await b.default.post("".concat(f.API_BASE_URL,"/api/users/v1/contact/"),{name:i,email:l,message:c})).status)throw new Error("Failed to send message");j("Your message has been sent successfully!"),s(""),d(""),u("")}catch(e){j(e.response?.data?.error||"Failed to send message. Please try again later."),console.error(e)}finally{p(!1)}}else j("Please fill in all fields")},disabled:h||o.submitting,children:(0,T.jsx)(C.default,{style:ma.buttonText,children:h||o.submitting?"Sending...":"Send Message"})})]})})})};var ha=o(802),fa=o(61457);const pa=(0,n.forwardRef)((({placeholder:e,onChangeText:t,initialValue:o="",style:a},r)=>{const{colors:i}=(0,G.useTheme)(),[s,l]=(0,n.useState)(o),d=(0,n.useRef)(null);(0,n.useEffect)((()=>{o!==s&&l(o)}),[o]);return(0,T.jsxs)(x.default,{style:[ya.container,a,{backgroundColor:i.surface}],children:[(0,T.jsx)(fa.default,{icon:()=>(0,T.jsx)(ee.default,{name:"search",size:24,color:i.primary}),onPress:()=>d.current?.focus()}),(0,T.jsx)(q.default,{ref:d,style:[ya.input,{color:i.text}],placeholder:e,placeholderTextColor:i.placeholder,value:s,onChangeText:e=>{e!==s&&(l(e),t(e))},autoFocus:!0,keyboardType:"default",returnKeyType:"search",blurOnSubmit:!1})]})})),ya=r.default.create({container:{flexDirection:"row",alignItems:"center",borderRadius:25,elevation:2,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:2},input:{flex:1,fontSize:16,paddingVertical:8,paddingRight:8}}),ba=(0,n.memo)(pa),xa=r.default.create({container:{flex:1,backgroundColor:m.theme.colors.background},androidSafeArea:{paddingTop:"android"===a.default.OS?mt.default.currentHeight:0},searchAndFilterContainer:{flexDirection:"row",alignItems:"center",margin:16,maxWidth:600,alignSelf:"center",width:"100%"},searchBar:{flex:1,marginRight:8,marginLeft:"web"===a.default.OS?0:8},filterButton:{minWidth:80,marginRight:"web"===a.default.OS?0:8},ownerList:{padding:16},ownerCard:{marginBottom:16,maxWidth:600,alignSelf:"center",width:"100%"},petTypes:{flexDirection:"row",marginTop:8},petChip:{marginRight:8},noOwnersContainer:{flex:1,justifyContent:"center",alignItems:"center"},modalContainer:{backgroundColor:"white",padding:20,margin:20,borderRadius:5,maxWidth:600,alignSelf:"center",width:"90%"},modalTitle:{marginBottom:10},filtersContainer:{flexDirection:"row",flexWrap:"wrap",marginBottom:20},filterChip:{margin:4},applyButton:{marginTop:10},closeButton:{marginTop:10,alignSelf:"flex-end"},closeIcon:{position:"absolute",top:10,right:10,zIndex:1}}),Ca=({navigation:e})=>{const{colors:t}=(0,G.useTheme)(),[o,r]=(0,n.useState)(""),[i,s]=(0,n.useState)([]),[l,d]=(0,n.useState)([]),[c,u]=(0,n.useState)(!1),[m,g]=(0,n.useState)([]);(0,n.useEffect)((()=>{h()}),[]);const h=async()=>{try{await new Promise((e=>setTimeout(e,1e3))),g(pe)}catch(e){console.error("Error fetching owners:",e)}},f=[{label:"Dog Sitting",value:"Dog"},{label:"Cat Sitting",value:"Cat"},{label:"Exotic Sitting",value:"Exotic"},{label:"Last Week",value:"week"},{label:"Last Month",value:"month"},{label:"Last Year",value:"year"}],p=(0,n.useCallback)((e=>{d((t=>t.includes(e)?t.filter((t=>t!==e)):[...t,e]))}),[]),y=(0,n.useCallback)((()=>{s(l),u(!1)}),[l]),b=(0,n.useMemo)((()=>m.filter((e=>{const t=e.name.toLowerCase().includes(o.toLowerCase()),n=0===i.length||i.every((t=>{if(["Dog","Cat","Exotic"].includes(t))return e.pet_types.includes(t);const o=new Date(e.last_booking),n=new Date;switch(t){case"week":const e=new Date;return e.setDate(n.getDate()-7),o>=e;case"month":const t=new Date;return t.setMonth(n.getMonth()-1),o>=t;case"year":const a=new Date;return a.setFullYear(n.getFullYear()-1),o>=a;default:return!0}}));return t&&n}))),[m,o,i]),C=(0,n.useCallback)((({item:t})=>(0,T.jsx)(v.default,{onPress:()=>e.navigate("OwnerHistory",{ownerId:t.id}),children:(0,T.jsx)(nn.default,{style:xa.ownerCard,children:(0,T.jsxs)(nn.default.Content,{children:[(0,T.jsx)(an.default,{children:t.name}),(0,T.jsxs)(rn.default,{children:["Last booking: ",t.last_booking]}),(0,T.jsx)(x.default,{style:xa.petTypes,children:t.pet_types.map((e=>(0,T.jsx)(ha.default,{style:xa.petChip,children:e},e)))})]})})})),[e]),w=(0,n.useCallback)((e=>{r(e)}),[]);return"web"===a.default.OS?(0,T.jsxs)(x.default,{style:xa.container,children:[(0,T.jsxs)(x.default,{style:xa.searchAndFilterContainer,children:[(0,T.jsx)(qe.default,{onPress:()=>{},children:(0,T.jsx)(ba,{placeholder:"Search owners",onChangeText:w,initialValue:o,style:xa.searchBar})}),(0,T.jsx)(Re.default,{mode:"outlined",onPress:()=>{d(i),u(!0)},style:xa.filterButton,children:"Filters"})]}),b.length>0?(0,T.jsx)(wt.default,{data:b,renderItem:C,keyExtractor:e=>e.id,contentContainerStyle:xa.ownerList,keyboardShouldPersistTaps:"handled",removeClippedSubviews:!1}):(0,T.jsx)(x.default,{style:xa.noOwnersContainer,children:(0,T.jsx)(rn.default,{children:"No owners match your search or filters."})}),(0,T.jsx)(at.default,{children:(0,T.jsxs)(Yn.default,{visible:c,onDismiss:()=>u(!1),contentContainerStyle:xa.modalContainer,children:[(0,T.jsx)(v.default,{onPress:()=>u(!1),style:xa.closeIcon,children:(0,T.jsx)(S.default,{name:"close",size:24,color:"black"})}),(0,T.jsx)(an.default,{style:xa.modalTitle,children:"Filters"}),(0,T.jsx)(x.default,{style:xa.filtersContainer,children:f.map((e=>(0,T.jsx)(ha.default,{style:xa.filterChip,selected:l.includes(e.value),onPress:()=>p(e.value),icon:l.includes(e.value)?({size:e,color:t})=>(0,T.jsx)(S.default,{name:"check",size:e,color:t}):void 0,children:e.label},e.value)))}),(0,T.jsx)(Re.default,{mode:"contained",onPress:y,style:xa.applyButton,children:"Apply Filters"})]})})]}):(0,T.jsxs)(Ie.default,{style:[xa.container,xa.androidSafeArea],children:[(0,T.jsxs)(x.default,{style:xa.searchAndFilterContainer,children:[(0,T.jsx)(qe.default,{onPress:()=>{},children:(0,T.jsx)(ba,{placeholder:"Search owners",onChangeText:w,initialValue:o,style:xa.searchBar})}),(0,T.jsx)(Re.default,{mode:"outlined",onPress:()=>{d(i),u(!0)},style:xa.filterButton,children:"Filters"})]}),b.length>0?(0,T.jsx)(wt.default,{data:b,renderItem:C,keyExtractor:e=>e.id,contentContainerStyle:xa.ownerList,keyboardShouldPersistTaps:"handled",removeClippedSubviews:!1}):(0,T.jsx)(x.default,{style:xa.noOwnersContainer,children:(0,T.jsx)(rn.default,{children:"No owners match your search or filters."})}),(0,T.jsx)(at.default,{children:(0,T.jsxs)(Yn.default,{visible:c,onDismiss:()=>u(!1),contentContainerStyle:xa.modalContainer,children:[(0,T.jsx)(v.default,{onPress:()=>u(!1),style:xa.closeIcon,children:(0,T.jsx)(S.default,{name:"close",size:24,color:"black"})}),(0,T.jsx)(an.default,{style:xa.modalTitle,children:"Filters"}),(0,T.jsx)(x.default,{style:xa.filtersContainer,children:f.map((e=>(0,T.jsx)(ha.default,{style:xa.filterChip,selected:l.includes(e.value),onPress:()=>p(e.value),icon:l.includes(e.value)?({size:e,color:t})=>(0,T.jsx)(S.default,{name:"check",size:e,color:t}):void 0,children:e.label},e.value)))}),(0,T.jsx)(Re.default,{mode:"contained",onPress:y,style:xa.applyButton,children:"Apply Filters"})]})})]})},va=({visible:e,onClose:t,serviceName:o,additionalRates:a=[],professionalName:r="Professional",onContactPress:i})=>{const[s,l]=(0,n.useState)(new Date),[d,c]=(0,n.useState)(new Date),[u,g]=(0,n.useState)(0),[h,f]=(0,n.useState)(!1),[p,y]=(0,n.useState)({}),[b,w]=(0,n.useState)(0),[j,S]=(0,n.useState)(0);return(0,n.useEffect)((()=>{const e={};a.forEach((t=>{e[t.title]=Object.assign({},t,{selected:!1})})),y(e)}),[a]),(0,n.useEffect)((()=>{(()=>{let e=h?40:20;e+=10*u,Object.entries(p).forEach((([t,o])=>{o.selected&&(e+=o.amount)})),w(e),S(.1*e)})()}),[u,h,p]),(0,T.jsx)(A.default,{visible:e,animationType:"slide",transparent:!0,onRequestClose:t,children:(0,T.jsx)(x.default,{style:wa.modalContainer,children:(0,T.jsxs)(x.default,{style:wa.modalContent,children:[(0,T.jsx)(v.default,{style:wa.closeIcon,onPress:t,children:(0,T.jsx)(ee.default,{name:"close",size:24,color:m.theme.colors.text})}),(0,T.jsx)(C.default,{style:wa.modalTitle,children:o}),(0,T.jsxs)(H.default,{style:wa.scrollContent,showsVerticalScrollIndicator:!0,persistentScrollbar:!0,children:[(0,T.jsxs)(x.default,{style:wa.rateItem,children:[(0,T.jsx)(C.default,{children:"Base Rate"}),(0,T.jsxs)(C.default,{children:["$",20]})]}),(0,T.jsxs)(x.default,{style:wa.rateItem,children:[(0,T.jsxs)(C.default,{children:["Additional Animals ($",10," each)"]}),(0,T.jsxs)(x.default,{style:wa.counterContainer,children:[(0,T.jsx)(v.default,{onPress:()=>g(Math.max(0,u-1)),style:wa.counterButton,children:(0,T.jsx)(ee.default,{name:"remove",size:24,color:m.theme.colors.primary})}),(0,T.jsx)(C.default,{style:wa.counterText,children:u}),(0,T.jsx)(v.default,{onPress:()=>g(u+1),style:wa.counterButton,children:(0,T.jsx)(ee.default,{name:"add",size:24,color:m.theme.colors.primary})})]})]}),(0,T.jsxs)(x.default,{style:wa.rateItem,children:[(0,T.jsxs)(C.default,{children:["Holiday Rate ($",40,")"]}),(0,T.jsx)(He.default,{value:h,onValueChange:f,trackColor:{false:"#767577",true:m.theme.colors.primary}})]}),Object.entries(p).map((([e,t])=>(0,T.jsxs)(x.default,{style:wa.rateItem,children:[(0,T.jsxs)(C.default,{children:[e," ($",t.amount,")"]}),(0,T.jsx)(He.default,{value:t.selected,onValueChange:o=>{y(Object.assign({},p,{[e]:Object.assign({},t,{selected:o})}))},trackColor:{false:"#767577",true:m.theme.colors.primary}})]},e))),(0,T.jsxs)(x.default,{style:wa.totalSection,children:[(0,T.jsxs)(x.default,{style:wa.totalItem,children:[(0,T.jsx)(C.default,{style:wa.totalLabel,children:"Subtotal:"}),(0,T.jsxs)(C.default,{style:wa.totalAmount,children:["$",b]})]}),(0,T.jsxs)(x.default,{style:wa.totalItem,children:[(0,T.jsx)(C.default,{style:wa.totalLabel,children:"Service Fees (10%):"}),(0,T.jsxs)(C.default,{style:wa.totalAmount,children:["$",j.toFixed(2)]})]}),(0,T.jsxs)(x.default,{style:[wa.totalItem,wa.finalTotal],children:[(0,T.jsx)(C.default,{style:[wa.totalLabel,wa.finalTotalText],children:"Total Cost:"}),(0,T.jsxs)(C.default,{style:[wa.totalAmount,wa.finalTotalText],children:["$",(b+j).toFixed(2)]})]})]})]}),(0,T.jsx)(v.default,{style:wa.contactButton,onPress:i,children:(0,T.jsxs)(C.default,{style:wa.contactButtonText,children:["Contact ",r]})})]})})})},wa=r.default.create({modalContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0, 0, 0, 0.5)"},modalContent:{backgroundColor:m.theme.colors.surface,borderRadius:12,padding:20,paddingRight:15,width:"90%",maxHeight:"43%",maxWidth:400},scrollContent:{flexGrow:0,marginBottom:10,paddingRight:12,marginRight:-7},modalTitle:{fontSize:m.theme.fontSizes.large,fontWeight:"bold",marginBottom:15,textAlign:"center",marginTop:5,paddingHorizontal:30},dateSection:{marginBottom:20,flexDirection:"row",justifyContent:"space-between",gap:16},dateColumn:{flex:1},dateLabel:{marginBottom:8,fontSize:m.theme.fontSizes.smallMedium,color:m.theme.colors.text},rateItem:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:15},counterContainer:{flexDirection:"row",alignItems:"center"},counterButton:{padding:5},counterText:{marginHorizontal:10,fontSize:m.theme.fontSizes.medium},totalSection:{marginTop:20,borderTopWidth:1,borderTopColor:m.theme.colors.border,paddingTop:15},totalItem:{flexDirection:"row",justifyContent:"space-between",marginBottom:10},finalTotal:{borderTopWidth:1,borderTopColor:m.theme.colors.border,paddingTop:10,marginTop:5},totalLabel:{fontSize:m.theme.fontSizes.medium,fontWeight:"600"},totalAmount:{fontSize:m.theme.fontSizes.medium,fontWeight:"bold"},finalTotalText:{fontSize:m.theme.fontSizes.mediumLarge,fontWeight:"bold",color:m.theme.colors.primary},closeButton:{backgroundColor:m.theme.colors.primary,padding:12,borderRadius:8,alignItems:"center",marginTop:10},closeButtonText:{color:m.theme.colors.surface,fontSize:m.theme.fontSizes.medium,fontWeight:"600"},closeIcon:{position:"absolute",right:15,top:15,zIndex:1,padding:5},contactButton:{backgroundColor:m.theme.colors.primary,padding:12,borderRadius:8,alignItems:"center",marginTop:10},contactButtonText:{color:m.theme.colors.surface,fontSize:m.theme.fontSizes.medium,fontWeight:"600"}}),ja=r.default.create({serviceCard:{backgroundColor:m.theme.colors.surface,borderRadius:12,padding:12,marginRight:12,width:280,height:220,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3,position:"relative",justifyContent:"space-between"},heartButton:{position:"absolute",right:8,top:8,zIndex:1},serviceName:{fontSize:m.theme.fontSizes.mediumLarge,fontWeight:"600",marginTop:8,marginBottom:6,fontFamily:m.theme.fonts.header.fontFamily,flexShrink:1},startingPrice:{fontSize:m.theme.fontSizes.medium+2,color:m.theme.colors.secondary,marginBottom:6,fontFamily:m.theme.fonts.regular.fontFamily},animalTypeContainer:{flexDirection:"row",flexWrap:"wrap",gap:4,marginBottom:8},animalType:{fontSize:m.theme.fontSizes.small+2,color:m.theme.colors.secondary,backgroundColor:m.theme.colors.background,borderRadius:8,paddingHorizontal:6,paddingVertical:2,fontFamily:m.theme.fonts.regular.fontFamily},calculateButton:{backgroundColor:m.theme.colors.primary,padding:10,borderRadius:8,alignItems:"center",marginTop:"auto"},calculateButtonText:{color:m.theme.colors.surface,fontSize:m.theme.fontSizes.medium,fontWeight:"600",fontFamily:m.theme.fonts.regular.fontFamily},contentContainer:{flex:1}}),Sa=({service:e,onHeartPress:t,isFavorite:o,professionalName:a,professionalId:r,navigation:i})=>{const[s,l]=(0,n.useState)(!1);return(0,T.jsxs)(x.default,{style:ja.serviceCard,children:[(0,T.jsxs)(x.default,{style:ja.contentContainer,children:[(0,T.jsx)(S.default,{name:e.icon,size:30,color:m.theme.colors.primary}),(0,T.jsx)(C.default,{numberOfLines:2,style:ja.serviceName,children:e.name}),(0,T.jsxs)(C.default,{style:ja.startingPrice,children:["Starting at $",e.startingPrice]}),(0,T.jsx)(x.default,{style:ja.animalTypeContainer,children:e.animalTypes.map(((e,t)=>(0,T.jsx)(C.default,{style:ja.animalType,children:e},t)))})]}),(0,T.jsx)(v.default,{style:ja.calculateButton,onPress:()=>l(!0),children:(0,T.jsx)(C.default,{style:ja.calculateButtonText,children:"Calculate Cost"})}),(0,T.jsx)(va,{visible:s,onClose:()=>l(!1),serviceName:e.name,additionalRates:e.additionalRates||[],professionalName:a,professionalId:r,onContactPress:()=>{const e=Ce.find((e=>e.professionalId===r));if(e)i.replace("MessageHistory",{selectedConversation:e.id,professionalName:a,professionalId:r});else{const e=((e,t,o)=>{const n="conv_".concat(Date.now()),a=o===xe;return{id:n,participant1_id:a?o:e,participant2_id:a?e:o,role_map:{participant1_role:a?"owner":"professional",participant2_role:a?"professional":"owner"},lastMessage:"",timestamp:(new Date).toISOString(),unread:!1,bookingStatus:null}})(r,0,"current_user_id");Ce.unshift(e),ve[e.id]=[],i.replace("MessageHistory",{selectedConversation:e.id,professionalName:a,professionalId:r})}l(!1)}})]})},Ta="web"===a.default.OS?o(27733).MapContainer:null,Ba=[{id:1,name:"Noah M.",service:"Fish Tank Cleaning",date:"Dec 02, 2024",rating:5,text:"Dina was fantastic with our dog! Sent lots of photos and clearly made sure she was comfortable. Will definitely use again!",photo:"https://via.placeholder.com/50"},{id:2,name:"Kaily J.",service:"Ferrier",date:"Nov 26, 2024",rating:4,text:"Dina always takes such good care of Elijah. He was having tummy problems today and she kept me updated all day on how he was doing.",photo:"https://via.placeholder.com/50"},{id:3,name:"Nadia U.",service:"Reptile Boarding & Habitat Maintenance",date:"Nov 19, 2024",rating:5,text:"She took such great care of our puppy! Sent pictures and videos the whole time, her backyard was super nice and clean \u2764\ufe0f my puppy was definitely in great hands! Bonus her dogs were so sweet with our puppy.",photo:"https://via.placeholder.com/50"},{id:4,name:"Vanessa G.",service:"Bird Feeding",date:"Nov 19, 2024",rating:5,text:"Dina was great! She communicated through the whole stay and sent plenty of videos and photos. 10/10",photo:"https://via.placeholder.com/50"}];if("web"===a.default.OS){const e=document.createElement("style");e.textContent="\n    .services-scroll::-webkit-scrollbar {\n      -webkit-appearance: none;\n    }\n\n    .services-scroll::-webkit-scrollbar:vertical {\n      width: 11px;\n    }\n\n    .services-scroll::-webkit-scrollbar:horizontal {\n      height: 11px;\n    }\n\n    .services-scroll::-webkit-scrollbar-thumb {\n      border-radius: 8px;\n      border: 2px solid white;\n      background-color: rgba(0, 0, 0, .5);\n    }\n  ",document.head.appendChild(e)}const ka=r.default.create({scrollViewContent:{flexGrow:1,paddingBottom:"web"===a.default.OS?16:80,height:"web"===a.default.OS?"calc(100vh - 124px)":"100%",overflow:"auto"},content:{alignSelf:"center",padding:24},topSection:{flexDirection:"web"===a.default.OS?"row":"column",gap:24,marginBottom:24},gallerySection:{maxHeight:400,overflow:"hidden",marginBottom:24},photoGrid:{flexDirection:"row",flexWrap:"wrap",gap:8,maxHeight:320,overflow:"auto"},bottomSection:{flexDirection:"web"===a.default.OS?"row":"column",gap:24},servicesSection:{flex:"web"===a.default.OS?1:void 0,backgroundColor:m.theme.colors.background,padding:24,borderRadius:12,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3},aboutSection:{maxHeight:300,overflow:"auto",marginBottom:24,padding:16,backgroundColor:m.theme.colors.surface,borderRadius:12},profileHeader:{alignItems:"web"===a.default.OS?"flex-start":"center"},profileInfo:{alignItems:"web"===a.default.OS?"flex-start":"center"},hostingSection:{marginTop:24},hostTitle:{fontSize:18,fontWeight:"bold",marginBottom:12,fontFamily:m.theme.fonts.header.fontFamily},weightRanges:{gap:8},weightRange:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},galleryPhoto:{width:"web"===a.default.OS?100:50,height:"web"===a.default.OS?100:50,borderRadius:8},centered:{flex:1,justifyContent:"center",alignItems:"center"},profilePhoto:{width:120,height:120,borderRadius:60,marginBottom:16,alignSelf:"center"},profilePhotoPlaceholder:{backgroundColor:m.theme.colors.surface,justifyContent:"center",alignItems:"center",marginBottom:10},name:{fontSize:24,fontWeight:"bold",marginBottom:4,textAlign:"center",fontFamily:m.theme.fonts.header.fontFamily},location:{fontSize:16,color:m.theme.colors.secondary,marginBottom:8,textAlign:"center",fontFamily:m.theme.fonts.regular.fontFamily},section:{padding:20,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},sectionTitle:{fontSize:20,fontWeight:"bold",marginBottom:10,color:m.theme.colors.primary,fontFamily:m.theme.fonts.header.fontFamily},bioInput:{backgroundColor:m.theme.colors.surface},service:{fontSize:16,marginBottom:5},rateItem:{flexDirection:"row",alignItems:"center",marginBottom:10},rateLabel:{flex:1,fontSize:16},rateInput:{flex:1,backgroundColor:m.theme.colors.surface},photoGrid:{flexDirection:"row",flexWrap:"wrap"},petPhoto:{width:50,height:50,borderRadius:25,backgroundColor:m.theme.colors.surface,justifyContent:"center",alignItems:"center",borderWidth:1,borderColor:m.theme.colors.border},addPhotoButton:{width:100,height:100,margin:5,borderRadius:10,borderWidth:1,borderColor:m.theme.colors.primary,justifyContent:"center",alignItems:"center"},saveButton:{margin:20},ratingContainer:{flexDirection:"row",alignItems:"center",justifyContent:"center",marginBottom:16},rating:{fontSize:16,fontWeight:"bold",marginLeft:5},reviewCount:{fontSize:14,color:m.theme.colors.secondary,marginLeft:4},contactButton:{backgroundColor:m.theme.colors.primary,padding:12,borderRadius:8,alignSelf:"center"},contactButtonText:{fontSize:16,fontWeight:"bold",color:m.theme.colors.surface,textAlign:"center"},statsContainer:{flexDirection:"row",justifyContent:"space-around",marginBottom:20},statItem:{flexDirection:"row",alignItems:"center",marginRight:10},statText:{fontSize:16,marginLeft:5},bioText:{fontSize:18,lineHeight:28,color:m.theme.colors.text,overflow:"hidden",fontFamily:m.theme.fonts.regular.fontFamily},serviceItem:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:10},serviceText:{fontSize:8,fontFamily:m.theme.fonts.regular.fontFamily},servicePrice:{fontSize:14,color:m.theme.colors.secondary,fontFamily:m.theme.fonts.regular.fontFamily},skillsGrid:{flexDirection:"row",flexWrap:"wrap"},skillBadge:{backgroundColor:m.theme.colors.surface,padding:10,borderRadius:5,margin:5},skillText:{fontSize:16,fontFamily:m.theme.fonts.regular.fontFamily},photoGallery:{flexDirection:"row"},calculatorText:{fontSize:16,color:m.theme.colors.secondary,fontFamily:m.theme.fonts.regular.fontFamily},additionalRatesButton:{marginTop:16,paddingVertical:12,paddingHorizontal:16,borderRadius:6,backgroundColor:m.theme.colors.surface,alignItems:"center",borderWidth:1,borderColor:m.theme.colors.outline},additionalRatesText:{color:m.theme.colors.primary,fontSize:16,fontWeight:"600",fontFamily:m.theme.fonts.regular.fontFamily},calendarSection:{marginTop:24},readMoreButton:{marginTop:8},readMoreText:{color:m.theme.colors.primary,fontSize:16,fontWeight:"600",fontFamily:m.theme.fonts.regular.fontFamily},reviewsSection:{marginVertical:32,width:"100%",backgroundColor:m.theme.colors.background},reviewItem:{marginBottom:16,backgroundColor:m.theme.colors.surface,padding:16,borderRadius:12,maxWidth:"web"===a.default.OS?600:void 0},servicesSection:{backgroundColor:m.theme.colors.surface,padding:24,borderRadius:12,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3,marginBottom:24},mapContainer:{height:400,width:"100%",marginVertical:24},map:{flex:1},petsSection:{marginBottom:24,backgroundColor:m.theme.colors.surface,padding:16,borderRadius:12},petItem:{flexDirection:"row",alignItems:"center",marginBottom:12,padding:12,borderRadius:8,borderWidth:1,borderColor:m.theme.colors.border,backgroundColor:m.theme.colors.background},petInfo:{marginLeft:12,flex:1},petName:{fontSize:16,fontWeight:"600",marginBottom:2,fontFamily:m.theme.fonts.header.fontFamily},petBreed:{fontSize:14,color:m.theme.colors.secondary,marginBottom:2,fontFamily:m.theme.fonts.regular.fontFamily},petDetails:{fontSize:14,color:m.theme.colors.secondary,fontFamily:m.theme.fonts.regular.fontFamily},modalContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0, 0, 0, 0.5)"},aboutSubsections:{flexDirection:"web"===a.default.OS?"row":"column",gap:24},communicationSection:{flex:1},skillsSection:{flex:1},homeDetails:{flexDirection:"row",flexWrap:"wrap",gap:16},noReviews:{fontSize:16,color:m.theme.colors.secondary,fontStyle:"italic",textAlign:"center",marginTop:16},twoColumnLayout:{flexDirection:"row",gap:24},singleColumnLayout:{flexDirection:"column"},leftColumn:{flex:"web"===a.default.OS?1:void 0,maxWidth:"web"===a.default.OS?400:void 0},rightColumn:{flex:"web"===a.default.OS?2:void 0},calendar:{height:300,marginTop:16},serviceText:{fontSize:12,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"100"},homeFeaturesGrid:{flexDirection:"row",flexWrap:"wrap",gap:8,marginTop:16},featureBubble:{backgroundColor:m.theme.colors.surface,paddingVertical:8,paddingHorizontal:16,borderRadius:20,borderWidth:1,borderColor:m.theme.colors.outline},featureText:{fontSize:14,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},reviewItem:{marginBottom:24,backgroundColor:m.theme.colors.surface,padding:16,borderRadius:12},reviewHeader:{flexDirection:"row",marginBottom:12},reviewerPhoto:{width:40,height:40,borderRadius:20,marginRight:12},reviewerInfo:{flex:1},reviewerName:{fontSize:16,fontWeight:"600",marginBottom:4,fontFamily:m.theme.fonts.header.fontFamily},serviceInfo:{flexDirection:"row",alignItems:"center",gap:4},reviewText:{fontSize:14,lineHeight:20,fontFamily:m.theme.fonts.regular.fontFamily},modalTitle:{fontSize:20,fontWeight:"600",marginBottom:16,fontFamily:m.theme.fonts.header.fontFamily},modalScroll:{maxHeight:"web"===a.default.OS?"70vh":"80%"},closeButton:{marginTop:16,alignItems:"center",padding:12,backgroundColor:m.theme.colors.primary,borderRadius:8},closeButtonText:{color:"#fff",fontSize:16,fontWeight:"600",fontFamily:m.theme.fonts.regular.fontFamily},modalHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16},modalCloseIcon:{padding:8},modalScrollContent:{paddingBottom:24},modalContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0, 0, 0, 0.5)",padding:"web"===a.default.OS?40:20},reviewsGrid:{flexDirection:"row",flexWrap:"wrap",gap:16,marginTop:16},reviewItem:{backgroundColor:m.theme.colors.surface,padding:16,borderRadius:12,flex:1,minWidth:"web"===a.default.OS?300:"100%",marginBottom:0},specialistSection:{marginTop:24,backgroundColor:m.theme.colors.surface,padding:16,borderRadius:12},specialistText:{fontSize:16,lineHeight:24,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},modalReviewItem:{marginBottom:16,width:"100%"},leftColumnMobile:{maxWidth:"100%",alignItems:"center"},seeAllButton:{borderWidth:1,borderColor:m.theme.colors.primary,paddingHorizontal:12,paddingVertical:6,borderRadius:8,alignSelf:"flex-start",minWidth:"auto",width:"auto"},seeAllButtonText:{color:m.theme.colors.primary,fontSize:16,fontWeight:"600",textAlign:"center",fontFamily:m.theme.fonts.regular.fontFamily},modalServicesGrid:{flexDirection:"row",flexWrap:"wrap",gap:16,justifyContent:"center",padding:16},reviewMeta:{gap:4},starContainer:{flexDirection:"row",alignItems:"center",marginBottom:4}}),Aa=({route:e,navigation:t})=>{const{width:i}=(0,_e.default)(),{screenWidth:s,isCollapsed:l,is_DEBUG:d}=(0,n.useContext)(g.AuthContext),[c,u]=(0,n.useState)(null),[h,f]=(0,n.useState)(!1),[y,b]=(0,n.useState)(!1),[w,j]=(0,n.useState)(!1),[B,k]=(0,n.useState)(!1),[_,I]=(0,n.useState)([]),[M,D]=(0,n.useState)(!1),[R,L]=(0,n.useState)(s<=900),z=(()=>{const{width:e}=(0,_e.default)(),[t,o]=(0,n.useState)(!0);return(0,n.useEffect)((()=>{o("web"===a.default.OS&&e>=900)}),[e]),t})();(0,n.useEffect)((()=>(d&&console.log("MBA9999: ProfessionalProfile component mounted"),()=>{d&&console.log("MBA9999: ProfessionalProfile component unmounting")})),[]),(0,n.useEffect)((()=>{d&&console.log("MBA9999: Professional data changed:",c?c.name:"null")}),[c]),(0,n.useEffect)((()=>{L(s<=900)}),[s]),(0,n.useEffect)((()=>{const e=t.getState().routes.some((e=>"SearchProfessionalsListing"===e.name));f(t.canGoBack()&&e)}),[t]);const P=()=>{d&&console.log("MBA9999: handleBack called, Platform:",a.default.OS),"web"===a.default.OS?(sessionStorage.removeItem("currentProfessional"),d&&console.log("MBA9999: Navigating back to SearchProfessionalsListing"),t.navigate("SearchProfessionalsListing")):(d&&console.log("MBA9999: Using navigation.goBack()"),t.goBack())};(0,n.useEffect)((()=>{(async()=>{if(d&&console.log("MBA9999: loadProfessionalData called",{hasRouteParams:!!e?.params?.professional,platform:a.default.OS}),e?.params?.professional)d&&console.log("MBA9999: Setting professional data from route params:",e.params.professional.name),u(e.params.professional),"web"===a.default.OS&&sessionStorage.setItem("currentProfessional",JSON.stringify(e.params.professional));else if("web"===a.default.OS){const e=sessionStorage.getItem("currentProfessional");if(d&&console.log("MBA9999: Checking sessionStorage for professional data:",!!e),e)try{const t=JSON.parse(e);d&&console.log("MBA9999: Setting professional data from sessionStorage:",t.name),u(t)}catch(o){console.error("MBA9999: Error parsing stored professional data:",o),t.replace("SearchProfessionalsListing")}else d&&console.log("MBA9999: No professional data found, redirecting to search"),t.replace("SearchProfessionalsListing")}})()}),[e?.params?.professional,t,d]),(0,n.useEffect)((()=>{"web"!==a.default.OS&&c&&p.default.setItem("currentProfessional",JSON.stringify(c))}),[c]);const F=e=>{I((t=>t.includes(e)?t.filter((t=>t!==e)):[...t,e]))};if(!c)return(0,T.jsxs)(ht,{fullWidthHeader:!0,children:[(0,T.jsx)(ut,{title:"Professional Profile",onBackPress:P}),(0,T.jsx)(x.default,{style:ka.centered,children:(0,T.jsx)(C.default,{children:"Loading..."})})]});const O=()=>c.profilePicture?(0,T.jsx)(U.default,{source:{uri:c.profilePicture},style:ka.profilePhoto}):(0,T.jsx)(x.default,{style:[ka.profilePhoto,ka.profilePhotoPlaceholder],children:(0,T.jsx)(S.default,{name:"account",size:80,color:m.theme.colors.primary})}),E=()=>(0,T.jsxs)(x.default,{style:ka.ratingContainer,children:[(0,T.jsx)(S.default,{name:"star",size:24,color:m.theme.colors.primary}),(0,T.jsx)(C.default,{style:ka.rating,children:c.reviews}),(0,T.jsxs)(C.default,{style:[ka.reviewCount,{marginLeft:12}],children:["(",c.reviewCount||50," reviews)"]})]}),W=({text:e,maxLines:t=3})=>(0,T.jsxs)(x.default,{children:[(0,T.jsx)(C.default,{numberOfLines:t,style:ka.specialistText,children:e}),(0,T.jsx)(v.default,{style:ka.readMoreButton,onPress:()=>k(!0),children:(0,T.jsx)(C.default,{style:ka.readMoreText,children:"Read more"})})]}),N=()=>{if("web"===a.default.OS&&Ta){const{MapContainer:e,TileLayer:t,Marker:n}=o(27733);return(0,T.jsx)(x.default,{style:ka.mapContainer,children:(0,T.jsxs)(e,{center:[38.8339,-104.8214],zoom:13,style:{height:400,width:"100%"},children:[(0,T.jsx)(t,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'\xa9 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}),(0,T.jsx)(n,{position:[38.8339,-104.8214]})]})})}return null},V=r.default.create({modalContent:{backgroundColor:m.theme.colors.background,padding:24,borderRadius:12,width:"web"===a.default.OS?s<=650?"90%":"60%":"90%",maxWidth:800,maxHeight:"90%"}}),q=({text:e})=>(0,T.jsx)(x.default,{style:ka.featureBubble,children:(0,T.jsx)(C.default,{style:ka.featureText,children:e})}),Y=e=>(0,T.jsxs)(x.default,{style:ka.reviewItem,children:[(0,T.jsxs)(x.default,{style:ka.reviewHeader,children:[(0,T.jsx)(U.default,{source:{uri:e.photo},style:ka.reviewerPhoto}),(0,T.jsxs)(x.default,{style:ka.reviewerInfo,children:[(0,T.jsx)(C.default,{style:ka.reviewerName,children:e.name}),(0,T.jsxs)(x.default,{style:ka.reviewMeta,children:[(0,T.jsx)(x.default,{style:ka.starContainer,children:[...Array(5)].map(((t,o)=>(0,T.jsx)(S.default,{name:o<e.rating?"star":"star-outline",size:16,color:m.theme.colors.primary},o)))}),(0,T.jsxs)(x.default,{style:ka.serviceInfo,children:[(0,T.jsx)(S.default,{name:"home",size:16,color:m.theme.colors.secondary}),(0,T.jsxs)(C.default,{style:ka.serviceText,children:[e.service," \u2022 ",e.date]})]})]})]})]}),(0,T.jsx)(C.default,{style:ka.reviewText,children:e.text})]},e.id),G=()=>(0,T.jsx)(x.default,{style:$.dynamicServicesBox,children:(0,T.jsxs)(x.default,{style:ka.calendarSection,children:[(0,T.jsx)(C.default,{style:[ka.sectionTitle,{marginBottom:0}],children:"Availability"}),(0,T.jsx)(Io.Calendar,{style:ka.calendar,theme:{calendarBackground:m.theme.colors.surface,selectedDayBackgroundColor:m.theme.colors.primary,selectedDayTextColor:"#ffffff",todayTextColor:m.theme.colors.primary}})]})}),J=(r.default.create({servicesSection:{marginBottom:24},sectionHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16},seeAllButton:{borderWidth:1,borderColor:m.theme.colors.primary,paddingHorizontal:12,paddingVertical:6,borderRadius:8,alignSelf:"flex-start",minWidth:"auto",width:"auto"},seeAllButtonText:{color:m.theme.colors.primary,fontSize:16,fontWeight:"600",textAlign:"center"},servicesScroll:{marginHorizontal:-24,paddingHorizontal:24},modalServicesGrid:{flexDirection:"row",flexWrap:"wrap",gap:16,justifyContent:"center",padding:16}}),()=>{const e=Ce.find((e=>e.professionalId===c.id));if(e)t.replace("MessageHistory",{selectedConversation:e.id});else{const e={id:"conv_".concat(Date.now()),name:c.name,professionalId:c.id,lastMessage:"",timestamp:(new Date).toISOString(),unread:!1,bookingStatus:null};Ce.unshift(e),ve[e.id]=[],t.replace("MessageHistory",{selectedConversation:e.id})}}),$=((e,t)=>r.default.create({mainContainer:{flex:1,backgroundColor:m.theme.colors.background,height:"web"===a.default.OS?"100vh":"100%",overflow:"hidden",position:"web"===a.default.OS?"fixed":"relative",top:0,left:0,right:0,bottom:0,marginLeft:e>900?t?70:250:0,transition:"web"===a.default.OS?"margin-left 0.3s ease":void 0},dynamicProfileSection:{backgroundColor:m.theme.colors.surface,borderRadius:12,padding:16,marginBottom:16,alignItems:"center",width:"100%",display:i>=600?"flex":"block"},dynamicProfileSectionMobile:{backgroundColor:m.theme.colors.surface,borderRadius:12,padding:16,marginBottom:16,alignItems:"center",width:"100%",maxWidth:500,alignSelf:"center",display:"flex",flexDirection:"column",alignItems:"center"},dynamicServicesBox:{backgroundColor:m.theme.colors.surface,padding:24,paddingTop:0,borderRadius:12,marginTop:24,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.2,shadowRadius:4,elevation:3,width:"100%",maxWidth:"web"===a.default.OS?600:void 0,alignSelf:"center"}}))(s,l);return(0,T.jsx)(x.default,{style:$.mainContainer,children:(0,T.jsxs)(ht,{fullWidthHeader:!0,contentWidth:"1200px",children:[(0,T.jsx)(ut,{title:"Professional Profile",onBackPress:P}),(0,T.jsx)(H.default,{contentContainerStyle:ka.scrollViewContent,children:(0,T.jsx)(x.default,{style:[ka.content,{width:(()=>{if("web"===a.default.OS){const e=s>900?i-(l?70:250):i;return Math.min(1e3,e-32)}return i-32})()}],children:(0,T.jsxs)(x.default,{style:[ka.twoColumnLayout,!z&&ka.singleColumnLayout],children:[i>=600?(0,T.jsxs)(x.default,{style:[ka.leftColumn,!z&&ka.leftColumnMobile],children:[(0,T.jsxs)(x.default,{style:[ka.profileSection,!z&&ka.profileSectionMobile],children:[O(),(0,T.jsx)(C.default,{style:ka.name,children:c.name}),(0,T.jsx)(C.default,{style:ka.location,children:c.location}),E(),(0,T.jsx)(v.default,{style:ka.contactButton,onPress:J,children:(0,T.jsxs)(C.default,{style:ka.contactButtonText,children:["Contact ",c.name]})})]}),z&&G(),z&&N(),z&&fe&&fe.length>0&&(fe&&0!==fe.length?(0,T.jsxs)(x.default,{style:ka.petsSection,children:[(0,T.jsx)(C.default,{style:ka.sectionTitle,children:"Pets"}),fe.map(((e,t)=>(0,T.jsxs)(x.default,{style:ka.petItem,children:[(0,T.jsx)(x.default,{style:ka.petPhoto,children:(0,T.jsx)(S.default,{name:"dog"===e.animal_type.toLowerCase()?"dog":"cat"===e.animal_type.toLowerCase()?"cat":"snake",size:30,color:m.theme.colors.primary})}),(0,T.jsxs)(x.default,{style:ka.petInfo,children:[(0,T.jsx)(C.default,{style:ka.petName,children:e.name}),(0,T.jsx)(C.default,{style:ka.petBreed,children:e.breed}),(0,T.jsx)(C.default,{style:ka.petDetails,children:"".concat(e.weight," lbs, ").concat(e.age.years," years").concat(e.age.months?" ".concat(e.age.months," months"):"")})]})]},e.id)))]}):null)]}):(0,T.jsxs)(x.default,{style:[$.dynamicProfileSection,$.dynamicProfileSectionMobile],children:[O(),(0,T.jsx)(C.default,{style:ka.name,children:c.name}),(0,T.jsx)(C.default,{style:ka.location,children:c.location}),E(),(0,T.jsx)(v.default,{style:ka.contactButton,onPress:J,children:(0,T.jsxs)(C.default,{style:ka.contactButtonText,children:["Contact ",c.name]})})]}),(0,T.jsxs)(x.default,{style:ka.rightColumn,children:[(0,T.jsxs)(x.default,{style:ka.servicesSection,children:[(0,T.jsxs)(x.default,{style:ka.sectionHeader,children:[(0,T.jsx)(C.default,{style:ka.sectionTitle,children:"Services"}),(0,T.jsx)(v.default,{style:ka.seeAllButton,onPress:()=>D(!0),children:(0,T.jsx)(C.default,{style:ka.seeAllButtonText,children:"See All"})})]}),(0,T.jsx)(x.default,{style:ka.servicesWrapper,children:(0,T.jsx)(H.default,{horizontal:!0,showsHorizontalScrollIndicator:!0,style:[ka.servicesScroll,"web"===a.default.OS&&{className:"services-scroll",overflowX:"scroll"}],contentContainerStyle:ka.servicesScrollContent,persistentScrollbar:!0,children:he.slice(0,5).map((e=>(0,T.jsx)(Sa,{service:e,onHeartPress:F,isFavorite:_.includes(e.id),professionalName:c.name,professionalId:c.id,navigation:t},e.id)))})})]}),!z&&G(),(0,T.jsxs)(x.default,{style:ka.specialistSection,children:[(0,T.jsx)(C.default,{style:ka.sectionTitle,children:"Specialist Experience"}),(0,T.jsx)(W,{text:c?.bio||""})]}),(0,T.jsxs)(x.default,{style:ka.reviewsSection,children:[(0,T.jsx)(C.default,{style:ka.sectionTitle,children:"Reviews"}),(0,T.jsx)(x.default,{style:ka.reviewsGrid,children:Ba.slice(0,4).map(Y)}),(0,T.jsx)(v.default,{style:ka.readMoreButton,onPress:()=>j(!0),children:(0,T.jsx)(C.default,{style:ka.readMoreText,children:"Read more reviews"})})]}),(0,T.jsxs)(x.default,{style:ka.homeSection,children:[(0,T.jsx)(C.default,{style:ka.sectionTitle,children:"Home"}),(0,T.jsxs)(x.default,{style:ka.homeFeaturesGrid,children:[(0,T.jsx)(q,{text:"No children present"}),(0,T.jsx)(q,{text:"Has security system"}),(0,T.jsx)(q,{text:"Non-smoking household"}),(0,T.jsx)(q,{text:"Has 2 dogs"}),(0,T.jsx)(q,{text:"Dogs allowed on bed"}),(0,T.jsx)(q,{text:"Dogs allowed on furniture"}),(0,T.jsx)(q,{text:"Potty breaks every 0-2 hours"})]})]}),!z&&N()]})]})})}),(0,T.jsx)(A.default,{visible:y,animationType:"slide",transparent:!0,onRequestClose:()=>b(!1),children:(0,T.jsx)(x.default,{style:ka.modalContainer,children:(0,T.jsxs)(x.default,{style:V.modalContent,children:[(0,T.jsx)(C.default,{style:ka.bioText,children:c.bio}),(0,T.jsx)(v.default,{style:ka.closeButton,onPress:()=>b(!1),children:(0,T.jsx)(C.default,{style:ka.closeButtonText,children:"Close"})})]})})}),(0,T.jsx)(A.default,{visible:w,animationType:"slide",transparent:!0,onRequestClose:()=>j(!1),children:(0,T.jsx)(x.default,{style:ka.modalContainer,children:(0,T.jsxs)(x.default,{style:V.modalContent,children:[(0,T.jsxs)(x.default,{style:ka.modalHeader,children:[(0,T.jsx)(C.default,{style:ka.modalTitle,children:"All Reviews"}),(0,T.jsx)(v.default,{style:ka.modalCloseIcon,onPress:()=>j(!1),children:(0,T.jsx)(S.default,{name:"close",size:24,color:m.theme.colors.text})})]}),(0,T.jsx)(H.default,{style:ka.modalScroll,contentContainerStyle:ka.modalScrollContent,children:Ba.map((e=>(0,T.jsx)(x.default,{style:ka.modalReviewItem,children:Y(e)},e.id)))})]})})}),(0,T.jsx)(A.default,{visible:B,animationType:"slide",transparent:!0,onRequestClose:()=>k(!1),children:(0,T.jsx)(x.default,{style:ka.modalContainer,children:(0,T.jsxs)(x.default,{style:V.modalContent,children:[(0,T.jsxs)(x.default,{style:ka.modalHeader,children:[(0,T.jsx)(C.default,{style:ka.modalTitle,children:"Specialist Experience"}),(0,T.jsx)(v.default,{style:ka.modalCloseIcon,onPress:()=>k(!1),children:(0,T.jsx)(S.default,{name:"close",size:24,color:m.theme.colors.text})})]}),(0,T.jsx)(H.default,{style:ka.modalScroll,contentContainerStyle:ka.modalScrollContent,children:(0,T.jsx)(C.default,{style:ka.bioText,children:c?.bio})})]})})}),(0,T.jsx)(A.default,{visible:M,animationType:"slide",transparent:!0,onRequestClose:()=>D(!1),children:(0,T.jsx)(x.default,{style:ka.modalContainer,children:(0,T.jsxs)(x.default,{style:V.modalContent,children:[(0,T.jsxs)(x.default,{style:ka.modalHeader,children:[(0,T.jsx)(C.default,{style:ka.modalTitle,children:"All Services"}),(0,T.jsx)(v.default,{style:ka.modalCloseIcon,onPress:()=>D(!1),children:(0,T.jsx)(S.default,{name:"close",size:24,color:m.theme.colors.text})})]}),(0,T.jsx)(H.default,{style:ka.modalScroll,contentContainerStyle:ka.modalScrollContent,children:(0,T.jsx)(x.default,{style:ka.modalServicesGrid,children:he.map((e=>(0,T.jsx)(Sa,{service:e,onHeartPress:F,isFavorite:_.includes(e.id),professionalName:c.name,professionalId:c.id,navigation:t},e.id)))})})]})})})]})})},_a=r.default.create({container:{marginTop:16},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center",marginTop:50},sectionTitle:{fontSize:m.theme.fontSizes.mediumLarge,fontWeight:"bold",marginBottom:8,color:m.theme.colors.text},noContractsText:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,textAlign:"center",marginTop:20},card:{backgroundColor:m.theme.colors.surface,borderRadius:8,padding:16,marginBottom:16},contractTitle:{fontSize:m.theme.fontSizes.medium,fontWeight:"bold",color:m.theme.colors.primary},ownerName:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,marginTop:4},buttonContainer:{flexDirection:"row",justifyContent:"flex-end",marginTop:8},button:{backgroundColor:m.theme.colors.primary,paddingHorizontal:12,paddingVertical:6,borderRadius:4,marginLeft:8},buttonText:{color:m.theme.colors.background,fontWeight:"bold"}}),Ia=()=>{const[e,t]=(0,n.useState)([]),[o,a]=(0,n.useState)(!0);(0,n.useEffect)((()=>{r()}),[]);const r=async()=>{a(!0);try{const e=await p.default.getItem("userToken");if(!e)return void console.error("No token found");const o=await b.default.get("".concat(f.API_BASE_URL,"/api/contracts/"),{headers:{Authorization:"Bearer ".concat(e)}});t(o.data)}catch(e){console.error("Error fetching contracts:",e)}finally{a(!1)}};return o?(0,T.jsx)(x.default,{style:_a.loadingContainer,children:(0,T.jsx)(_.default,{size:"large",color:m.theme.colors.primary})}):(0,T.jsxs)(x.default,{style:_a.container,children:[(0,T.jsx)(C.default,{style:_a.sectionTitle,children:"Your Contracts"}),0===e.length?(0,T.jsx)(C.default,{style:_a.noContractsText,children:"No contracts yet"}):e.map((e=>(0,T.jsxs)(x.default,{style:_a.card,children:[(0,T.jsx)(C.default,{style:_a.contractTitle,children:e.title}),(0,T.jsxs)(C.default,{style:_a.ownerName,children:["Owner: ",e.owner_name]}),(0,T.jsxs)(x.default,{style:_a.buttonContainer,children:[(0,T.jsx)(v.default,{style:_a.button,children:(0,T.jsx)(C.default,{style:_a.buttonText,children:"Share"})}),(0,T.jsx)(v.default,{style:_a.button,children:(0,T.jsx)(C.default,{style:_a.buttonText,children:"Edit"})})]})]},e.id)))]})};var Ma=o(17366);const Da=r.default.create({picker:{backgroundColor:m.theme.colors.surface,marginBottom:8,borderRadius:4,padding:"ios"===a.default.OS?12:0,width:"90%"},modalPicker:{width:"90%"},dropdownButton:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",backgroundColor:m.theme.colors.surface,borderRadius:4,padding:12,marginBottom:16,borderWidth:1,borderColor:m.theme.colors.border},dropdownButtonText:{color:m.theme.colors.text},pickerModalContainer:{flex:1,justifyContent:"flex-end",backgroundColor:"rgba(0, 0, 0, 0.5)"},pickerContainer:{backgroundColor:m.theme.colors.background,borderTopLeftRadius:20,borderTopRightRadius:20,padding:16},pickerCloseButton:{backgroundColor:m.theme.colors.primary,padding:16,alignItems:"center"},pickerCloseButtonText:{color:m.theme.colors.background,fontWeight:"bold"}}),Ra=({owners:e,selectedOwner:t,onSelectOwner:o})=>{const[r,i]=(0,n.useState)(!1);return"web"===a.default.OS?(0,T.jsxs)(Ma.Picker,{selectedValue:t,onValueChange:e=>o(e),style:Da.picker,children:[(0,T.jsx)(Ma.Picker.Item,{label:"Select a owner...",value:""}),e.map((e=>(0,T.jsx)(Ma.Picker.Item,{label:e.name,value:e.name},e.id)))]}):(0,T.jsxs)(x.default,{children:[(0,T.jsxs)(v.default,{style:Da.dropdownButton,onPress:()=>i(!0),children:[(0,T.jsx)(C.default,{style:Da.dropdownButtonText,children:t||"Select a owner..."}),(0,T.jsx)(S.default,{name:"chevron-down",size:24,color:m.theme.colors.primary})]}),(0,T.jsx)(A.default,{visible:r,transparent:!0,animationType:"slide",onRequestClose:()=>i(!1),children:(0,T.jsxs)(x.default,{style:Da.pickerModalContainer,children:[(0,T.jsx)(x.default,{style:Da.pickerContainer,children:(0,T.jsxs)(Ma.Picker,{selectedValue:t,onValueChange:e=>{o(e),i(!1)},style:Da.modalPicker,children:[(0,T.jsx)(Ma.Picker.Item,{label:"Select a owner...",value:""}),e.map((e=>(0,T.jsx)(Ma.Picker.Item,{label:e.name,value:e.name},e.id)))]})}),(0,T.jsx)(v.default,{style:Da.pickerCloseButton,onPress:()=>i(!1),children:(0,T.jsx)(C.default,{style:Da.pickerCloseButtonText,children:"Close"})})]})})]})},La=r.default.create({container:{marginBottom:16},sectionTitle:{fontSize:18,fontWeight:"bold",marginBottom:8,color:m.theme.colors.text},button:{backgroundColor:m.theme.colors.primary,paddingHorizontal:16,paddingVertical:12,borderRadius:8,alignItems:"center",marginBottom:10},buttonText:{color:m.theme.colors.background,fontWeight:"bold",fontSize:16},modalContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0, 0, 0, 0.5)"},modalContent:{width:"80%",backgroundColor:m.theme.colors.surface,borderRadius:10,padding:20,alignItems:"center"},modalTitle:{fontSize:20,fontWeight:"bold",marginBottom:20},templateGrid:{flexDirection:"row",flexWrap:"wrap",justifyContent:"center"},templateBox:{width:100,height:100,margin:10,justifyContent:"center",alignItems:"center",backgroundColor:m.theme.colors.primary,borderRadius:5},templateTitle:{color:m.theme.colors.background,textAlign:"center"},noTemplatesText:{fontSize:16,color:m.theme.colors.text,textAlign:"center",marginTop:20},closeButton:{marginTop:20,padding:10,backgroundColor:m.theme.colors.primary,borderRadius:5},closeButtonText:{color:m.theme.colors.background,fontWeight:"bold"},textArea:{width:"100%",height:100,padding:10,borderColor:m.theme.colors.primary,borderWidth:1,borderRadius:5,marginBottom:10,textAlignVertical:"top"},ownerPickerContainer:{width:"100%",marginBottom:10},pickerModalContainer:{flex:1,justifyContent:"flex-end",backgroundColor:"rgba(0, 0, 0, 0.5)"},pickerContainer:{backgroundColor:m.theme.colors.background,borderTopLeftRadius:20,borderTopRightRadius:20,padding:16},pickerCloseButton:{backgroundColor:m.theme.colors.primary,padding:16,alignItems:"center"},pickerCloseButtonText:{color:m.theme.colors.background,fontWeight:"bold"}}),za=({templates:e})=>{const[t,o]=(0,n.useState)(!1),[a,r]=(0,n.useState)(!1),[i,s]=(0,n.useState)(null),[l,d]=(0,n.useState)(""),[c,u]=(0,n.useState)([]),[m,g]=(0,n.useState)("");(0,n.useEffect)((()=>{h()}),[]);const h=async()=>{try{const e=await p.default.getItem("userToken");if(!e)return void console.error("No token found");const t=await b.default.get("".concat(f.API_BASE_URL,"/api/clients/"),{headers:{Authorization:"Bearer ".concat(e)}});u(t.data)}catch(e){console.error("Error fetching owners:",e)}};return(0,T.jsxs)(x.default,{style:La.container,children:[(0,T.jsx)(C.default,{style:La.sectionTitle,children:"Create New Contract"}),(0,T.jsx)(v.default,{style:La.button,onPress:()=>o(!0),children:(0,T.jsx)(C.default,{style:La.buttonText,children:"Use Template"})}),(0,T.jsx)(A.default,{visible:t,transparent:!0,animationType:"slide",onRequestClose:()=>o(!1),children:(0,T.jsx)(x.default,{style:La.modalContainer,children:(0,T.jsxs)(x.default,{style:La.modalContent,children:[(0,T.jsx)(C.default,{style:La.modalTitle,children:"Select a Template"}),(0,T.jsx)(H.default,{contentContainerStyle:La.templateGrid,children:0===e.length?(0,T.jsx)(C.default,{style:La.noTemplatesText,children:"No templates yet"}):e.map((e=>(0,T.jsx)(v.default,{style:La.templateBox,onPress:()=>(e=>{s(e),d(e.description),o(!1),r(!0)})(e),children:(0,T.jsx)(C.default,{style:La.templateTitle,children:e.title})},e.id)))}),(0,T.jsx)(v.default,{style:La.closeButton,onPress:()=>o(!1),children:(0,T.jsx)(C.default,{style:La.closeButtonText,children:"Close"})})]})})}),(0,T.jsx)(A.default,{visible:a,transparent:!0,animationType:"slide",onRequestClose:()=>r(!1),children:(0,T.jsx)(x.default,{style:La.modalContainer,children:(0,T.jsxs)(x.default,{style:La.modalContent,children:[(0,T.jsx)(C.default,{style:La.modalTitle,children:"Edit Contract"}),(0,T.jsxs)(x.default,{style:La.ownerPickerContainer,children:[(0,T.jsx)(C.default,{style:La.sectionTitle,children:"Select a Owner"}),(0,T.jsx)(Ra,{owners:c,selectedOwner:m,onSelectOwner:g})]}),(0,T.jsx)(q.default,{style:La.textArea,placeholder:"Contract Content",value:l,onChangeText:d,multiline:!0}),(0,T.jsx)(v.default,{style:La.button,onPress:()=>{d((e=>"".concat(e,"\n[signable] ___________ [end signable]")))},children:(0,T.jsx)(C.default,{style:La.buttonText,children:"Add Signable Field"})}),(0,T.jsx)(v.default,{style:La.button,onPress:async()=>{try{const e=await p.default.getItem("userToken");if(!e)return void console.error("No token found");const t=await b.default.post("".concat(f.API_BASE_URL,"/api/contracts/"),{template:i.id,content:l,owner:m},{headers:{Authorization:"Bearer ".concat(e)}});console.log("Contract submitted:",t.data),r(!1)}catch(e){console.error("Error submitting contract:",e)}},children:(0,T.jsx)(C.default,{style:La.buttonText,children:"Submit Contract"})}),(0,T.jsx)(v.default,{style:La.closeButton,onPress:()=>r(!1),children:(0,T.jsx)(C.default,{style:La.closeButtonText,children:"Close"})})]})})})]})},Pa=r.default.create({container:{flex:1},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center",minHeight:200},emptyContainer:{flex:1,justifyContent:"center",alignItems:"center",minHeight:200,backgroundColor:m.theme.colors.surface,borderRadius:8,padding:20,marginTop:16},emptyText:{fontSize:16,color:m.theme.colors.text,textAlign:"center"},sectionTitle:{fontSize:18,fontWeight:"bold",marginBottom:8,color:m.theme.colors.text},card:{backgroundColor:m.theme.colors.surface,borderRadius:8,padding:16,marginBottom:16},chronicleTitle:{fontSize:16,fontWeight:"bold",color:m.theme.colors.primary},ownerName:{fontSize:14,color:m.theme.colors.text,marginTop:4},petName:{fontSize:14,color:m.theme.colors.text,marginTop:2},summary:{fontSize:14,color:m.theme.colors.text,marginTop:8,marginBottom:8},buttonContainer:{flexDirection:"row",justifyContent:"flex-end",marginTop:8},button:{backgroundColor:m.theme.colors.primary,paddingHorizontal:12,paddingVertical:6,borderRadius:4,marginLeft:8},buttonText:{color:m.theme.colors.background,fontWeight:"bold"}}),Fa=({chronicles:e})=>e&&0!==e.length?(0,T.jsxs)(H.default,{style:Pa.container,children:[(0,T.jsx)(C.default,{style:Pa.sectionTitle,children:"Your Chronicles"}),e.map((e=>(0,T.jsxs)(x.default,{style:Pa.card,children:[(0,T.jsx)(C.default,{style:Pa.chronicleTitle,children:e.title}),(0,T.jsxs)(C.default,{style:Pa.ownerName,children:["Owner: ",e.owner]}),(0,T.jsxs)(C.default,{style:Pa.petName,children:["Pet: ",e.pets.join(", ")]}),(0,T.jsx)(C.default,{style:Pa.summary,children:e.summary}),(0,T.jsxs)(x.default,{style:Pa.buttonContainer,children:[(0,T.jsx)(v.default,{style:Pa.button,children:(0,T.jsx)(C.default,{style:Pa.buttonText,children:"Edit"})}),(0,T.jsx)(v.default,{style:Pa.button,children:(0,T.jsx)(C.default,{style:Pa.buttonText,children:"Send to Owner"})})]})]},e.id)))]}):(0,T.jsx)(x.default,{style:Pa.emptyContainer,children:(0,T.jsx)(C.default,{style:Pa.emptyText,children:"No chronicles yet"})}),{width:Oa}=j.default.get("window"),Ea=r.default.create({outerContainer:{width:"100%",alignItems:"center",marginBottom:16},container:{width:Oa-80,maxWidth:600,alignItems:"center"},inputContainer:{width:"100%",position:"relative"},input:Object.assign({width:"100%",backgroundColor:m.theme.colors.surface,borderRadius:4,padding:8,minHeight:60},a.default.select({web:{border:"1px solid ".concat(m.theme.colors.border)},default:{borderWidth:1,borderColor:m.theme.colors.border}})),dropdownButton:{position:"absolute",right:8,top:8,padding:4},modalOverlay:{flex:1},dropdownContainer:Object.assign({position:"absolute",backgroundColor:m.theme.colors.background,borderRadius:4,borderWidth:1,borderColor:m.theme.colors.border,maxHeight:200,zIndex:1e3},a.default.select({web:{boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},default:{elevation:4}})),dropdownList:{maxHeight:200},dropdownItem:{padding:12,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},dropdownItemText:{color:m.theme.colors.text}}),Wa=({value:e,onChange:t})=>{const[o,r]=(0,n.useState)(!1),[i,s]=(0,n.useState)({top:0,left:0,width:0}),l=(0,n.useRef)(null),[d,c]=(0,n.useState)(null),u=e=>{t(e)};(0,n.useLayoutEffect)((()=>(o&&l.current&&l.current.measure(((e,t,o,n,a,r)=>{if(!isNaN(r)&&!isNaN(n)){s({top:r+n,left:a,width:o})}})),"web"===a.default.OS&&(document.body.style.overflow=o?"hidden":"auto"),()=>{"web"===a.default.OS&&(document.body.style.overflow="auto")})),[o,d]);const g=()=>{r(!o)};return(0,T.jsx)(x.default,{style:Ea.outerContainer,children:(0,T.jsxs)(x.default,{style:Ea.container,children:[(0,T.jsxs)(x.default,{style:Ea.inputContainer,ref:l,onLayout:e=>{const{x:t,y:o,width:n,height:a}=e.nativeEvent.layout;c({x:t,y:o,width:n,height:a})},children:[(0,T.jsx)(q.default,{style:Ea.input,value:e,onChangeText:u,placeholder:"Enter or select a question",multiline:!0}),(0,T.jsx)(v.default,{style:Ea.dropdownButton,onPress:g,children:(0,T.jsx)(S.default,{name:o?"chevron-up":"chevron-down",size:24,color:m.theme.colors.primary})})]}),(0,T.jsx)(A.default,{visible:o,transparent:!0,animationType:"none",onRequestClose:g,children:(0,T.jsx)(v.default,{style:Ea.modalOverlay,activeOpacity:1,onPress:g,children:(0,T.jsx)(x.default,{style:[Ea.dropdownContainer,{top:i.top,left:i.left,width:i.width}],children:(0,T.jsx)(H.default,{style:Ea.dropdownList,children:["What is your favorite animal?","How many pets do you have?","What's your experience with exotic pets?","Do you have any allergies to animals?","What type of exotic pet are you interested in?","Have you owned an exotic pet before?","Are you familiar with the care requirements for exotic pets?","Do you have a veterinarian experienced with exotic animals?","What's your living situation? (House, apartment, etc.)","Are there any local regulations about exotic pet ownership in your area?"].map(((e,t)=>(0,T.jsx)(v.default,{style:Ea.dropdownItem,onPress:()=>{u(e),g()},children:(0,T.jsx)(C.default,{style:Ea.dropdownItemText,children:e})},t)))})})})})]})})},{width:Na}=j.default.get("window"),Ha=r.default.create({createButton:{backgroundColor:m.theme.colors.primary,paddingHorizontal:16,paddingVertical:12,borderRadius:8,alignItems:"center",marginBottom:16},createButtonText:{color:m.theme.colors.background,fontWeight:"bold",fontSize:16},modalContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0, 0, 0, 0.5)"},modalContent:{backgroundColor:m.theme.colors.background,borderRadius:8,padding:16,width:"90%",maxHeight:"80%"},webModalContent:{width:Na>600?"40%":"90%"},modalHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16},modalTitle:{fontSize:20,fontWeight:"bold",color:m.theme.colors.text},closeButton:{padding:8},closeButtonText:{fontSize:20,color:m.theme.colors.text,fontWeight:"bold"},label:{fontSize:16,fontWeight:"bold",marginBottom:8,color:m.theme.colors.text},input:{backgroundColor:m.theme.colors.surface,borderRadius:4,marginBottom:8,minHeight:20},picker:{backgroundColor:m.theme.colors.surface,marginBottom:8,borderRadius:4,padding:"ios"===a.default.OS?12:0},petOption:{padding:8,backgroundColor:m.theme.colors.surface,marginBottom:8,borderRadius:4},selectedPet:{backgroundColor:m.theme.colors.primary},petOptionText:{color:m.theme.colors.text},uploadButton:{flexDirection:"row",alignItems:"center",justifyContent:"center",padding:12,backgroundColor:m.theme.colors.surface,borderRadius:4,marginTop:16},uploadButtonText:{marginLeft:8,color:m.theme.colors.primary,fontWeight:"bold"},photoPreview:{flexDirection:"row",marginTop:16},photoThumbnail:{width:80,height:80,marginRight:8,borderRadius:4},questionContainer:{marginBottom:16,width:"100%",alignItems:"center"},modalButtonContainer:{flexDirection:"row",justifyContent:"space-between",marginTop:16},cancelButton:{backgroundColor:m.theme.colors.error,paddingHorizontal:16,paddingVertical:12,borderRadius:4,alignItems:"center",flex:1,marginRight:8},cancelButtonText:{color:m.theme.colors.background,fontWeight:"bold"},submitButton:{backgroundColor:m.theme.colors.primary,paddingHorizontal:16,paddingVertical:12,borderRadius:4,alignItems:"center",flex:1,marginLeft:8},submitButtonText:{color:m.theme.colors.background,fontWeight:"bold"},addQuestionButton:{flexDirection:"row",alignItems:"center",justifyContent:"center",padding:12,backgroundColor:m.theme.colors.surface,borderRadius:4,marginTop:8,marginBottom:16,zIndex:1},addQuestionButtonText:{marginLeft:8,zIndex:1,color:m.theme.colors.primary,fontWeight:"bold"},answerInputContainer:{width:"100%",alignItems:"center"},answerInput:Object.assign({width:Na-80,maxWidth:600,minHeight:60,backgroundColor:m.theme.colors.surface,borderRadius:4,padding:8,marginTop:8},a.default.select({web:{border:"1px solid ".concat(m.theme.colors.border)},default:{borderWidth:1,borderColor:m.theme.colors.border}})),summaryInput:Object.assign({backgroundColor:m.theme.colors.surface,borderRadius:4,marginBottom:8,padding:8,height:100,textAlignVertical:"top"},a.default.select({web:{minHeight:100},ios:{paddingTop:8},android:{paddingTop:8}}),a.default.select({web:{border:"1px solid ".concat(m.theme.colors.border)},default:{borderWidth:1,borderColor:m.theme.colors.border}})),dropdownButton:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",backgroundColor:m.theme.colors.surface,borderRadius:4,padding:12,marginBottom:16,borderWidth:1,borderColor:m.theme.colors.border},dropdownButtonText:{color:m.theme.colors.text},pickerModalContainer:{flex:1,justifyContent:"flex-end",backgroundColor:"rgba(0, 0, 0, 0.5)"},pickerContainer:{backgroundColor:m.theme.colors.background,borderTopLeftRadius:20,borderTopRightRadius:20,padding:16},pickerCloseButton:{backgroundColor:m.theme.colors.primary,padding:16,alignItems:"center"},pickerCloseButtonText:{color:m.theme.colors.background,fontWeight:"bold"},photoContainer:{marginRight:8},photo:{width:100,height:100,borderRadius:8}}),Ua=({onCreateChronicle:e})=>{const[t,o]=(0,n.useState)(!1),[r,i]=(0,n.useState)(""),[s,l]=(0,n.useState)([]),[d,c]=(0,n.useState)([{question:"",answer:"",isPreset:!0}]),[u,g]=(0,n.useState)(""),[h,f]=(0,n.useState)([]),[p,y]=(0,n.useState)(!1),[b,w]=(0,n.useState)(!1),[j,B]=(0,n.useState)(!1),k=[{id:"1",name:"John Doe",pets:[{id:"1",name:"Max"},{id:"2",name:"Bella"}]},{id:"2",name:"Jane Smith",pets:[{id:"3",name:"Luna"},{id:"4",name:"Charlie"}]}],I=(e,t,o)=>{const n=[...d];n[e]=Object.assign({},n[e],{[t]:o}),c(n)},M=()=>{i(""),l([]),g(""),c([{question:"",answer:""}]),f([])},D=({photo:e})=>(0,T.jsx)(x.default,{style:Ha.photoContainer,children:(0,T.jsx)(U.default,{source:{uri:e.uri},style:Ha.photo})});return(0,T.jsxs)(x.default,{children:[(0,T.jsx)(v.default,{style:Ha.createButton,onPress:()=>o(!0),children:(0,T.jsx)(C.default,{style:Ha.createButtonText,children:"Create New Chronicle"})}),(0,T.jsx)(A.default,{animationType:"slide",transparent:!0,visible:t,onRequestClose:()=>o(!1),children:(0,T.jsx)(x.default,{style:Ha.modalContainer,children:(0,T.jsxs)(x.default,{style:[Ha.modalContent,"web"===a.default.OS&&Ha.webModalContent],children:[(0,T.jsxs)(x.default,{style:Ha.modalHeader,children:[(0,T.jsx)(C.default,{style:Ha.modalTitle,children:"Create New Chronicle"}),(0,T.jsx)(v.default,{onPress:()=>o(!1),children:(0,T.jsx)(C.default,{style:Ha.closeButtonText,children:"\u2715"})})]}),(0,T.jsxs)(H.default,{children:[(0,T.jsx)(C.default,{style:Ha.label,children:"Select Owner"}),(0,T.jsx)(Ra,{owners:k,selectedOwner:r,onSelectOwner:i}),(0,T.jsx)(C.default,{style:Ha.label,children:"Select Pets"}),r&&k.find((e=>e.name===r))?.pets.map((e=>(0,T.jsx)(v.default,{style:[Ha.petOption,s.includes(e.name)&&Ha.selectedPet],onPress:()=>{s.includes(e.name)?l(s.filter((t=>t!==e.name))):l([...s,e.name])},children:(0,T.jsx)(C.default,{style:Ha.petOptionText,children:e.name})},e.id))),(0,T.jsx)(C.default,{style:Ha.label,children:"Summary"}),(0,T.jsx)(q.default,{style:Ha.summaryInput,multiline:!0,value:u,onChangeText:g,placeholder:"Write a summary of the chronicle",textAlignVertical:"top"}),d.map(((e,t)=>(0,T.jsxs)(x.default,{style:Ha.questionContainer,children:[(0,T.jsxs)(C.default,{style:Ha.label,children:["Question ",t+1]}),(0,T.jsx)(Wa,{value:e.question,onChange:e=>I(t,"question",e)}),(0,T.jsx)(x.default,{style:Ha.answerInputContainer,children:(0,T.jsx)(q.default,{style:[Ha.input,Ha.answerInput],value:e.answer,onChangeText:e=>I(t,"answer",e),placeholder:"Enter answer",multiline:!0})})]},t))),(0,T.jsxs)(v.default,{style:Ha.addQuestionButton,onPress:()=>{c([...d,{question:"",answer:"",isPreset:!1}])},children:[(0,T.jsx)(S.default,{name:"plus",size:20,color:m.theme.colors.primary}),(0,T.jsx)(C.default,{style:Ha.addQuestionButtonText,children:"Add Another Question"})]}),(0,T.jsxs)(v.default,{style:Ha.uploadButton,onPress:async()=>{try{y(!0);const e=await Me.launchImageLibraryAsync({mediaTypes:De.MediaTypeOptions.Images,allowsMultipleSelection:!0,quality:1});e.canceled||f([...h,...e.assets])}catch(e){console.error("Error uploading images:",e)}finally{y(!1)}},disabled:p,children:[(0,T.jsx)(S.default,{name:"camera",size:24,color:p?m.theme.colors.disabled:m.theme.colors.primary}),(0,T.jsx)(C.default,{style:[Ha.uploadButtonText,p&&Ha.uploadingText],children:p?"Uploading...":"Upload Photos"}),p&&(0,T.jsx)(_.default,{size:"small",color:m.theme.colors.primary,style:Ha.uploadingSpinner})]}),(0,T.jsx)(H.default,{horizontal:!0,style:Ha.photoPreview,children:h.map(((e,t)=>(0,T.jsx)(D,{photo:e},t)))})]}),(0,T.jsxs)(x.default,{style:Ha.modalButtonContainer,children:[(0,T.jsx)(v.default,{style:Ha.cancelButton,onPress:()=>{o(!1),M()},children:(0,T.jsx)(C.default,{style:Ha.cancelButtonText,children:"Cancel"})}),(0,T.jsx)(v.default,{style:Ha.submitButton,onPress:()=>{B(!0);const t={id:Date.now(),owner:r,pets:s,summary:u,questions:d,photos:h,title:"Chronicle for ".concat(r)};setTimeout((()=>{console.log("Sending data to backend:",t),e(t),B(!1),o(!1),M()}),2e3)},disabled:j,children:(0,T.jsx)(C.default,{style:Ha.submitButtonText,children:j?"Creating Chronicle...":"Create Chronicle"})})]})]})})})]})},Va=r.default.create({safeArea:{flex:1,backgroundColor:m.theme.colors.background,paddingTop:"android"===a.default.OS?mt.default.currentHeight:0},scrollViewContent:{flexGrow:1},container:{flex:1,padding:16,alignItems:"center"},title:{fontSize:24,fontWeight:"bold",marginBottom:16,color:m.theme.colors.primary,textAlign:"center"},tabContainer:{flexDirection:"row",marginBottom:16,width:"100%",maxWidth:500},tab:{flex:1,paddingVertical:12,alignItems:"center",backgroundColor:m.theme.colors.surface,borderRadius:8,marginHorizontal:4},activeTab:{backgroundColor:m.theme.colors.primary},tabText:{color:m.theme.colors.text,fontWeight:"bold"},activeTabText:{color:m.theme.colors.background},contentContainer:{width:"100%",maxWidth:500},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center",minHeight:200},useTemplateButton:{backgroundColor:m.theme.colors.primary,padding:10,borderRadius:5,marginBottom:16,alignItems:"center"},useTemplateButtonText:{color:m.theme.colors.background,fontWeight:"bold"},modalContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0, 0, 0, 0.5)"},modalContent:{width:"80%",backgroundColor:m.theme.colors.surface,borderRadius:10,padding:20,alignItems:"center"},modalTitle:{fontSize:20,fontWeight:"bold",marginBottom:20},templateGrid:{flexDirection:"row",flexWrap:"wrap",justifyContent:"center"},templateBox:{width:100,height:100,backgroundColor:m.theme.colors.primary,margin:10,justifyContent:"center",alignItems:"center",borderRadius:5},templateTitle:{color:m.theme.colors.background,textAlign:"center"},closeButton:{marginTop:20,padding:10,backgroundColor:m.theme.colors.primary,borderRadius:5},closeButtonText:{color:m.theme.colors.background,fontWeight:"bold"}}),qa=()=>{const[e,t]=(0,n.useState)("contracts"),[o,a]=(0,n.useState)([]),[r,i]=(0,n.useState)(!1),[s,l]=(0,n.useState)([]);(0,n.useEffect)((()=>{"chronicles"===e&&d()}),[e]);const d=async()=>{i(!0),await new Promise((e=>setTimeout(e,1e3)));a([{id:1,title:"Fluffy's Adventure",owner:"John Doe",pets:["Fluffy"],summary:"Fluffy had a great time at the park today!"},{id:2,title:"Max's Playdate",owner:"Jane Smith",pets:["Max"],summary:"Max enjoyed playing with other dogs at the beach."}]),i(!1)};(0,n.useEffect)((()=>{(async()=>{try{const e=await p.default.getItem("userToken");if(!e)return void console.error("No token found");const t=await b.default.get("".concat(f.API_BASE_URL,"/api/contracts/templates/"),{headers:{Authorization:"Bearer ".concat(e)}});l(t.data)}catch(e){console.error("Error fetching templates:",e)}})()}),[]);return(0,T.jsx)(Ie.default,{style:Va.safeArea,children:(0,T.jsx)(H.default,{contentContainerStyle:Va.scrollViewContent,children:(0,T.jsxs)(x.default,{style:Va.container,children:[(0,T.jsx)(C.default,{style:Va.title,children:"My Contracts & Chronicles"}),(0,T.jsxs)(x.default,{style:Va.tabContainer,children:[(0,T.jsx)(v.default,{style:[Va.tab,"contracts"===e&&Va.activeTab],onPress:()=>t("contracts"),children:(0,T.jsx)(C.default,{style:[Va.tabText,"contracts"===e&&Va.activeTabText],children:"Contracts"})}),(0,T.jsx)(v.default,{style:[Va.tab,"chronicles"===e&&Va.activeTab],onPress:()=>t("chronicles"),children:(0,T.jsx)(C.default,{style:[Va.tabText,"chronicles"===e&&Va.activeTabText],children:"Critter Chronicles"})})]}),"contracts"===e&&(0,T.jsxs)(x.default,{style:Va.contentContainer,children:[(0,T.jsx)(za,{templates:s}),(0,T.jsx)(Ia,{})]}),"chronicles"===e&&(0,T.jsx)(x.default,{style:Va.contentContainer,children:r?(0,T.jsx)(x.default,{style:Va.loadingContainer,children:(0,T.jsx)(_.default,{size:"large",color:m.theme.colors.primary})}):(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(Ua,{onCreateChronicle:e=>{a((t=>[...t,e]))}}),(0,T.jsx)(Fa,{chronicles:o})]})})]})})})},{width:Ya}=j.default.get("window"),Ga=(e,t)=>r.default.create({container:{flex:1,backgroundColor:m.theme.colors.background,marginLeft:e>900?t?70:250:0,transition:"margin-left 0.3s ease"},safeArea:{flex:1,paddingTop:"android"===a.default.OS?mt.default.currentHeight:0},content:{flex:1,justifyContent:"center",alignItems:"center",padding:20},backButton:{position:"absolute",top:20,left:20,flexDirection:"row",alignItems:"center",zIndex:1},backText:{marginLeft:8,fontSize:18,fontWeight:"600",color:m.theme.colors.text},card:{backgroundColor:m.theme.colors.surfaceContrast,borderRadius:12,padding:40,width:"100%",maxWidth:400,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:8,elevation:5},title:{fontSize:28,fontWeight:"600",color:m.theme.colors.text,textAlign:"center",marginBottom:30},inputContainer:{position:"relative",marginBottom:20},input:{backgroundColor:m.theme.colors.surface,borderRadius:8,padding:15,fontSize:16,color:m.theme.colors.text,borderWidth:1,borderColor:m.theme.colors.border,paddingRight:50},eyeIcon:{position:"absolute",right:15,top:15,padding:5},button:{marginTop:10,marginBottom:20},errorText:{color:m.theme.colors.error,textAlign:"center",marginBottom:15,fontSize:14},successText:{color:m.theme.colors.success||"#4CAF50",textAlign:"center",marginBottom:15,fontSize:14},loader:{marginTop:10},forgotPasswordButton:{alignItems:"center",marginTop:10},forgotPasswordText:{color:m.theme.colors.primary,fontSize:14,textDecorationLine:"underline"}}),Ja=({navigation:e})=>{const[t,o]=(0,n.useState)(""),[a,r]=(0,n.useState)(""),[i,s]=(0,n.useState)(""),[l,d]=(0,n.useState)(""),[c,u]=(0,n.useState)(""),[h,y]=(0,n.useState)(!1),[w,j]=(0,n.useState)(!1),[B,k]=(0,n.useState)(!1),[A,I]=(0,n.useState)(!1),{isSignedIn:M,screenWidth:D,isCollapsed:R}=(0,n.useContext)(g.AuthContext),[L,z]=(0,n.useState)(null);(0,n.useEffect)((()=>{(async()=>{const e=await p.default.getItem("userToken");z(e)})()}),[]);const P=Ga(D,R);return(0,T.jsx)(x.default,{style:P.container,children:(0,T.jsx)(Ie.default,{style:P.safeArea,children:(0,T.jsxs)(x.default,{style:P.content,children:[(0,T.jsxs)(v.default,{onPress:()=>e.navigate("MyProfile",{initialTab:"settings_payments"}),style:P.backButton,children:[(0,T.jsx)(S.default,{name:"arrow-left",size:24,color:m.theme.colors.text}),(0,T.jsx)(C.default,{style:P.backText,children:"Change Password"})]}),(0,T.jsxs)(x.default,{style:P.card,children:[(0,T.jsx)(C.default,{style:P.title,children:"Change Password"}),(0,T.jsxs)(x.default,{style:P.inputContainer,children:[(0,T.jsx)(q.default,{style:P.input,placeholder:"Current Password",value:t,onChangeText:o,secureTextEntry:!w,placeholderTextColor:m.theme.colors.placeHolderText}),(0,T.jsx)(v.default,{style:P.eyeIcon,onPress:()=>j(!w),children:(0,T.jsx)(S.default,{name:w?"eye-off":"eye",size:20,color:m.theme.colors.placeHolderText})})]}),(0,T.jsxs)(x.default,{style:P.inputContainer,children:[(0,T.jsx)(q.default,{style:P.input,placeholder:"New Password",value:a,onChangeText:r,secureTextEntry:!B,placeholderTextColor:m.theme.colors.placeHolderText}),(0,T.jsx)(v.default,{style:P.eyeIcon,onPress:()=>k(!B),children:(0,T.jsx)(S.default,{name:B?"eye-off":"eye",size:20,color:m.theme.colors.placeHolderText})})]}),(0,T.jsxs)(x.default,{style:P.inputContainer,children:[(0,T.jsx)(q.default,{style:P.input,placeholder:"Confirm New Password",value:i,onChangeText:s,secureTextEntry:!A,placeholderTextColor:m.theme.colors.placeHolderText}),(0,T.jsx)(v.default,{style:P.eyeIcon,onPress:()=>I(!A),children:(0,T.jsx)(S.default,{name:A?"eye-off":"eye",size:20,color:m.theme.colors.placeHolderText})})]}),l?(0,T.jsx)(C.default,{style:P.errorText,children:l}):null,c?(0,T.jsx)(C.default,{style:P.successText,children:c}):null,(0,T.jsx)(Gt,{title:"Change Password",onPress:async()=>{if(d(""),u(""),a===i)if(M&&L){y(!0);try{200===(await b.default.post("".concat(f.API_BASE_URL,"/api/users/change-password/"),{current_password:t,new_password:a},{headers:{Authorization:"Bearer ".concat(L)}})).status&&(u("Password changed successfully"),o(""),r(""),s(""))}catch(l){d(l.response?.data?.error||"Failed to change password")}finally{y(!1)}}else d("You are not authenticated. Please log in again.");else d("New passwords do not match")},disabled:h,style:P.button}),h&&(0,T.jsx)(_.default,{size:"large",color:m.theme.colors.primary,style:P.loader}),(0,T.jsx)(v.default,{onPress:()=>{e.navigate("ResetPassword")},style:P.forgotPasswordButton,children:(0,T.jsx)(C.default,{style:P.forgotPasswordText,children:"Forgot Password?"})})]})]})})})};o(90013);var $a=o(27851),Za=o.n($a);o(5433),o(31943);r.default.create({container:{position:"relative"},dropdownContainer:{position:"relative"},header:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:6,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:8,backgroundColor:m.theme.colors.background},dropdown:{position:"absolute",top:"100%",left:0,right:0,maxHeight:200,backgroundColor:m.theme.colors.background,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:8,marginTop:4,elevation:1e3,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:3.84,zIndex:9999},scrollView:{maxHeight:200},scrollViewContent:{flexGrow:1},item:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:12,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},itemText:{fontSize:m.theme.fontSizes.medium+2,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},placeholderText:{color:m.theme.colors.placeholderText,fontSize:m.theme.fontSizes.medium+2,fontFamily:m.theme.fonts.regular.fontFamily},selectedText:{color:m.theme.colors.text,fontSize:m.theme.fontSizes.medium+2,fontFamily:m.theme.fonts.regular.fontFamily},chipsContainer:{flexDirection:"row",flexWrap:"wrap",gap:8,marginTop:8},chip:{flexDirection:"row",alignItems:"center",backgroundColor:m.theme.colors.background,borderWidth:1,borderColor:m.theme.colors.primary,borderRadius:16,paddingVertical:4,paddingHorizontal:8},chipText:{fontSize:m.theme.fontSizes.small+2,color:m.theme.colors.text,marginRight:4,fontFamily:m.theme.fonts.regular.fontFamily},chipRemove:{padding:2},label:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,marginBottom:m.theme.spacing.small,fontFamily:m.theme.fonts.header.fontFamily}}),r.default.create({modalOverlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center"},tooltipContainer:{backgroundColor:m.theme.colors.surface,padding:m.theme.spacing.medium,borderRadius:8,maxWidth:300,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:3.84,elevation:5},tooltipText:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,textAlign:"center"},right:{marginLeft:m.theme.spacing.medium},left:{marginRight:m.theme.spacing.medium},top:{marginBottom:m.theme.spacing.medium},bottom:{marginTop:m.theme.spacing.medium},tooltipHeader:{alignItems:"flex-end",marginBottom:m.theme.spacing.small},closeButton:{width:24,height:24,alignItems:"center",justifyContent:"center",borderRadius:12},closeButtonText:{fontSize:20,color:m.theme.colors.text,lineHeight:20}});const Ka=r.default.create({container:{width:"100%",position:"relative",marginRight:m.theme.spacing.medium,marginBottom:m.theme.spacing.medium,zIndex:1e3},input:{height:48,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:8,paddingHorizontal:m.theme.spacing.medium,backgroundColor:m.theme.colors.surface,width:"100%"},suggestionsWrapper:{position:"absolute",top:"100%",left:0,right:0,maxHeight:200,backgroundColor:m.theme.colors.background,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:8,zIndex:1e3,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:3,elevation:3},suggestionsContainer:{flex:1},suggestionItem:{padding:m.theme.spacing.medium,borderBottomWidth:1,borderBottomColor:m.theme.colors.border}}),Qa=({value:e,onChange:t})=>{const[o,a]=(0,n.useState)(!1),[r,i]=(0,n.useState)([]);return(0,T.jsxs)(x.default,{style:Ka.container,children:[(0,T.jsx)(q.default,{style:Ka.input,placeholder:"Search services...",value:e,onChangeText:e=>{if(t(e),e.length>0){const t=de.filter((t=>t.toLowerCase().includes(e.toLowerCase())));i(t),a(!0)}else a(!1)},onFocus:()=>e.length>0&&a(!0),onBlur:()=>{setTimeout((()=>{a(!1)}),150)}}),o&&(0,T.jsx)(x.default,{style:Ka.suggestionsWrapper,children:(0,T.jsx)(H.default,{style:Ka.suggestionsContainer,keyboardShouldPersistTaps:"always",nestedScrollEnabled:!0,children:r.map(((e,o)=>(0,T.jsx)(v.default,{style:Ka.suggestionItem,onPress:()=>(e=>{t(e),a(!1)})(e),children:(0,T.jsx)(C.default,{children:e})},o)))})})]})},Xa=["Horse","Cow","Sheep","Goat","Pig","Dogs","Cats","Bird","Rabbit","Hamster","Snake","Lizard","Turtle","Gecko","Chameleon","Fish","Frog","Newt","Axolotl","Spider","Scorpion","Crab","Snail","Millipede"],er=[{display:"Colorado Springs, Colorado",city:"Colorado Springs",state:"Colorado",zips:["80901","80902","80903","80904","80905","80906","80907","80908","80909","80910","80911","80912","80913","80914","80915","80916","80917","80918","80919","80920","80921","80922","80923","80924","80925","80926","80927","80928","80929","80930","80931","80932","80933","80934","80935","80936","80937","80938","80939","80941","80942","80946","80947","80949","80950","80951","80960","80962","80970","80977","80995","80997"]}],tr=(()=>{const e=[];return er.forEach((t=>{e.push({display:t.display,searchText:"".concat(t.city,", ").concat(t.state),type:"city"}),t.zips.forEach((o=>{e.push({display:"".concat(o,", ").concat(t.city,", ").concat(t.state),searchText:o,type:"zip"})}))})),e})(),or=(["Farm Animals","Domestic","Exotic","Aquatic","Invertibrates"].map((e=>({label:e,value:e.toLowerCase().replace(/\s+/g,"-")}))),({onFiltersChange:e,onShowProfessionals:t,isMobile:o,onSearchResults:i,initialFilters:s})=>{const[l,d]=(0,n.useState)(s?.location||""),[c,u]=(0,n.useState)([]),[h,f]=(0,n.useState)(s?.service_query||""),[p,y]=(0,n.useState)(s?.animal_types||[]),[b,w]=(0,n.useState)(s?.overnight_service||!1),[j,B]=(0,n.useState)(s?.price_max||200),[k,A]=(0,n.useState)(new Date),[_,I]=(0,n.useState)(new Date),[M,D]=(0,n.useState)(!1),[R,L]=(0,n.useState)(!1),[z,P]=(0,n.useState)(!1),[F,O]=(0,n.useState)(""),[E,W]=(0,n.useState)([]),[N,U]=(0,n.useState)(!1),{screenWidth:V,isSignedIn:Y}=(0,n.useContext)(g.AuthContext);n.useEffect((()=>{s&&(d(s.location||""),f(s.service_query||""),y(s.animal_types||[]),w(s.overnight_service||!1),B(s.price_max||200))}),[s]);const G=r.default.create({container:{padding:m.theme.spacing.medium,backgroundColor:m.theme.colors.surface,height:"100%",width:"100%",overflow:"visible",paddingTop:m.theme.spacing.medium},header:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:m.theme.spacing.xlarge,gap:m.theme.spacing.small},title:{fontSize:m.theme.fontSizes.xlarge,fontWeight:"600",color:m.theme.colors.text,fontFamily:m.theme.fonts.header.fontFamily},section:{marginBottom:m.theme.spacing.xlarge,position:"relative"},label:{fontSize:m.theme.fontSizes.medium,fontWeight:"500",color:m.theme.colors.text,marginVertical:m.theme.spacing.small,fontFamily:m.theme.fonts.regular.fontFamily},dropdown:{height:48,backgroundColor:m.theme.colors.background,borderRadius:8,padding:m.theme.spacing.medium,borderWidth:1,borderColor:m.theme.colors.border},locationInputWrapper:{position:"relative",marginBottom:m.theme.spacing.small,zIndex:1100},locationInput:{height:48,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:8,paddingHorizontal:m.theme.spacing.medium,backgroundColor:m.theme.colors.background,fontSize:m.theme.fontSizes.medium},suggestionsWrapper:{position:"absolute",top:"100%",left:0,right:0,maxHeight:200,backgroundColor:m.theme.colors.background,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:8,zIndex:1100,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:3,elevation:3},suggestionsContainer:{flex:1},suggestionItem:{padding:m.theme.spacing.medium,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},suggestionItemNotSupported:{backgroundColor:m.theme.colors.background},suggestionText:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},suggestionTextNotSupported:{color:m.theme.colors.placeholderText,fontStyle:"italic"},suggestionType:{fontSize:m.theme.fontSizes.small,color:m.theme.colors.placeholderText,fontFamily:m.theme.fonts.regular.fontFamily},datePickersContainer:{flexDirection:"column",gap:m.theme.spacing.medium,marginRight:16,zIndex:500},datePickerWrapper:{width:"100%"},dateLabel:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,marginBottom:8,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"500"},dateInput:{height:48,backgroundColor:m.theme.colors.background,borderRadius:8,padding:m.theme.spacing.medium,borderWidth:1,borderColor:m.theme.colors.border,fontSize:m.theme.fontSizes.medium},priceRangeContainer:{flexDirection:"row",alignItems:"center",gap:m.theme.spacing.medium,marginTop:m.theme.spacing.small},slider:{flex:1,height:48,marginHorizontal:m.theme.spacing.medium},priceText:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,minWidth:50},selectedText:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,fontWeight:"500",fontFamily:m.theme.fonts.regular.fontFamily},placeholderText:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.placeholderText,fontFamily:m.theme.fonts.regular.fontFamily},dropdownContainer:{backgroundColor:m.theme.colors.background,borderRadius:8,borderWidth:1,borderColor:m.theme.colors.border,overflow:"hidden"},dropdownItem:{padding:m.theme.spacing.medium},dropdownItemSelected:{backgroundColor:m.theme.colors.surface,borderWidth:1,borderColor:m.theme.colors.primary,borderRadius:8,margin:4},dropdownItemText:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},dropdownItemTextSelected:{color:m.theme.colors.primary,fontWeight:"500",fontFamily:m.theme.fonts.regular.fontFamily},personButton:{padding:m.theme.spacing.small,borderRadius:8,marginLeft:"auto"},showProfessionalsButton:{backgroundColor:m.theme.colors.primary,padding:m.theme.spacing.medium,borderRadius:8,alignItems:"center",marginTop:m.theme.spacing.large},showProfessionalsText:{color:m.theme.colors.whiteText,fontSize:m.theme.fontSizes.medium,fontWeight:"600",fontFamily:m.theme.fonts.regular.fontFamily},locationContainer:{flexDirection:"column",width:"100%",gap:m.theme.spacing.small,zIndex:1100,position:"relative"},useLocationButton:{flexDirection:"row",alignItems:"center",padding:m.theme.spacing.small,backgroundColor:m.theme.colors.surface,borderRadius:8,borderWidth:1,borderColor:m.theme.colors.border,gap:4,alignSelf:"flex-start"},useLocationText:{color:m.theme.colors.text,fontSize:m.theme.fontSizes.small},input:{height:48,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:8,paddingHorizontal:m.theme.spacing.medium,backgroundColor:m.theme.colors.surface},animalTypesContainer:{flexDirection:"row",flexWrap:"wrap",gap:m.theme.spacing.small,marginTop:m.theme.spacing.small,marginBottom:m.theme.spacing.medium,zIndex:800},animalTypeButton:{flexDirection:"row",alignItems:"center",padding:m.theme.spacing.small,backgroundColor:m.theme.colors.surface,borderRadius:20,borderWidth:1,borderColor:m.theme.colors.border,gap:4},animalTypeButtonSelected:{backgroundColor:m.theme.colors.primary,borderColor:m.theme.colors.primary},animalTypeLabel:{color:m.theme.colors.text,fontSize:m.theme.fontSizes.small},animalTypeLabelSelected:{color:m.theme.colors.whiteText},switchContainer:{flexDirection:"row",alignItems:"center",justifyContent:"web"===a.default.OS?"space-between":"flex-start",marginVertical:m.theme.spacing.small,gap:m.theme.spacing.medium,zIndex:700},priceContainer:{flexDirection:"row",alignItems:"center",gap:m.theme.spacing.small,zIndex:600},priceLabel:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,minWidth:50},checkboxContainer:{marginTop:m.theme.spacing.medium,gap:m.theme.spacing.small,zIndex:400},checkboxRow:{flexDirection:"row",alignItems:"center",gap:m.theme.spacing.small},checkbox:{width:24,height:24,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:4,alignItems:"center",justifyContent:"center",backgroundColor:m.theme.colors.surface},checkboxLabel:{flex:1,fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text},headerButtons:{flexDirection:"row",gap:m.theme.spacing.small},iconButton:{padding:m.theme.spacing.small,borderRadius:8},checkboxLabelContainer:{flex:1,flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingRight:m.theme.spacing.small},searchButton:{backgroundColor:m.theme.colors.primary,padding:m.theme.spacing.medium,borderRadius:8,alignItems:"center",marginTop:m.theme.spacing.large,marginBottom:m.theme.spacing.large},searchButtonText:{color:m.theme.colors.whiteText,fontSize:m.theme.fontSizes.medium,fontWeight:"600"},searchButtonDisabled:{backgroundColor:m.theme.colors.border,opacity:.6},otherAnimalInputWrapper:{backgroundColor:m.theme.colors.background,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:8,marginTop:m.theme.spacing.small,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:3,elevation:3},otherAnimalHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:m.theme.spacing.medium},otherAnimalTitle:{fontSize:m.theme.fontSizes.medium,fontWeight:"600",color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},closeButton:{padding:m.theme.spacing.small,borderRadius:8},animalInput:{height:48,borderWidth:0,borderRadius:8,paddingHorizontal:m.theme.spacing.medium,backgroundColor:m.theme.colors.background,fontSize:m.theme.fontSizes.medium,marginHorizontal:m.theme.spacing.medium,marginBottom:m.theme.spacing.small},animalSuggestionsWrapper:{flex:1},animalSuggestionsContainer:{flex:1},animalSuggestionItem:{padding:m.theme.spacing.medium,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},animalSuggestionText:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},animalSelectionWrapper:{flexDirection:"column",gap:m.theme.spacing.small},selectedAnimalsContainer:{marginTop:m.theme.spacing.medium,padding:m.theme.spacing.medium,backgroundColor:m.theme.colors.background,borderRadius:8},selectedAnimalsLabel:{fontSize:m.theme.fontSizes.medium,fontWeight:"500",color:m.theme.colors.text,marginBottom:m.theme.spacing.small,fontFamily:m.theme.fonts.regular.fontFamily},selectedAnimalsList:{flexDirection:"row",flexWrap:"wrap",gap:m.theme.spacing.small},selectedAnimalTag:{flexDirection:"row",alignItems:"center",padding:m.theme.spacing.small,backgroundColor:m.theme.colors.primary,borderRadius:8,gap:m.theme.spacing.small},selectedAnimalText:{color:m.theme.colors.whiteText,fontSize:m.theme.fontSizes.medium,fontWeight:"500",fontFamily:m.theme.fonts.regular.fontFamily}}),J=({icon:e,label:t,selected:o,onPress:n})=>(0,T.jsxs)(v.default,{style:[G.animalTypeButton,o&&G.animalTypeButtonSelected],onPress:n,children:[(0,T.jsx)(S.default,{name:e,size:24,color:o?m.theme.colors.whiteText:m.theme.colors.text}),(0,T.jsx)(C.default,{style:[G.animalTypeLabel,o&&G.animalTypeLabelSelected],children:t})]}),$=e=>{p.includes(e)?y(p.filter((t=>t!==e))):y([...p,e])};return(0,T.jsxs)(H.default,{style:G.container,children:[(0,T.jsxs)(x.default,{style:G.header,children:[(0,T.jsx)(C.default,{style:G.title,children:"Refine Search"}),(0,T.jsx)(v.default,{style:G.personButton,onPress:t,children:(0,T.jsx)(S.default,{name:"account-group",size:24,color:m.theme.colors.text})}),o&&(0,T.jsx)(x.default,{style:G.headerButtons,children:(0,T.jsx)(v.default,{style:G.iconButton,onPress:()=>{t&&t("map")},children:(0,T.jsx)(S.default,{name:"map",size:24,color:m.theme.colors.text})})})]}),(0,T.jsx)(C.default,{style:G.label,children:"I'm looking for services for my:"}),(0,T.jsxs)(x.default,{style:G.animalSelectionWrapper,children:[(0,T.jsxs)(x.default,{style:G.animalTypesContainer,children:[(0,T.jsx)(J,{icon:"dog",label:"Dogs",selected:p.includes("Dogs"),onPress:()=>$("Dogs")}),(0,T.jsx)(J,{icon:"cat",label:"Cats",selected:p.includes("Cats"),onPress:()=>$("Cats")}),(0,T.jsxs)(v.default,{style:[G.animalTypeButton,z&&G.animalTypeButtonSelected],onPress:()=>P(!z),children:[(0,T.jsx)(S.default,{name:"dots-horizontal",size:24,color:z?m.theme.colors.whiteText:m.theme.colors.text}),(0,T.jsx)(C.default,{style:[G.animalTypeLabel,z&&G.animalTypeLabelSelected],children:"Other"})]})]}),z&&(0,T.jsx)((({value:e,onChange:t,suggestions:o,onSuggestionSelect:a,isVisible:r,onClose:i,onAnimalSelect:s})=>{const l=(0,n.useRef)(null),d=(0,n.useCallback)((0,gn.debounce)((e=>{if(e.length<1)return void a([]);const t=Xa.filter((t=>t.toLowerCase().includes(e.toLowerCase())));a(t)}),300),[a]);return r?(0,T.jsxs)(x.default,{style:G.otherAnimalInputWrapper,children:[(0,T.jsxs)(x.default,{style:G.otherAnimalHeader,children:[(0,T.jsx)(C.default,{style:G.otherAnimalTitle,children:"Search for animal type"}),(0,T.jsx)(v.default,{onPress:i,style:G.closeButton,children:(0,T.jsx)(S.default,{name:"close",size:20,color:m.theme.colors.text})})]}),(0,T.jsx)(q.default,{ref:l,style:G.animalInput,placeholder:"Type animal name (e.g., Snake, Turtle, Horse)",value:e,onChangeText:e=>{t(e),d(e)},autoFocus:!0}),o.length>0&&(0,T.jsx)(x.default,{style:G.animalSuggestionsWrapper,children:(0,T.jsx)(H.default,{style:G.animalSuggestionsContainer,keyboardShouldPersistTaps:"always",nestedScrollEnabled:!0,children:o.map(((e,o)=>(0,T.jsx)(v.default,{style:G.animalSuggestionItem,onPress:()=>{s(e),t(""),a([]),i()},children:(0,T.jsx)(C.default,{style:G.animalSuggestionText,children:e})},o)))})})]}):null}),{value:F,onChange:O,suggestions:E,onSuggestionSelect:W,isVisible:z,onClose:()=>{P(!1),O(""),W([])},onAnimalSelect:$})]}),p.length>0&&(0,T.jsxs)(x.default,{style:G.selectedAnimalsContainer,children:[(0,T.jsx)(C.default,{style:G.selectedAnimalsLabel,children:"Selected animals:"}),(0,T.jsx)(x.default,{style:G.selectedAnimalsList,children:p.map(((e,t)=>(0,T.jsxs)(v.default,{style:G.selectedAnimalTag,onPress:()=>$(e),children:[(0,T.jsx)(C.default,{style:G.selectedAnimalText,children:e}),(0,T.jsx)(S.default,{name:"close",size:16,color:m.theme.colors.whiteText})]},t)))})]}),(0,T.jsx)(C.default,{style:G.label,children:"Location"}),(0,T.jsx)(x.default,{style:G.locationContainer,children:(0,T.jsx)((({value:e,onChange:t,suggestions:o,onSuggestionSelect:a})=>{const r=(0,n.useRef)(null),i=(0,n.useCallback)((0,gn.debounce)((e=>{if(e.length<1)return void a([]);const t=tr.filter((t=>t.searchText.toLowerCase().includes(e.toLowerCase())||t.display.toLowerCase().includes(e.toLowerCase()))).slice(0,5);0===t.length?a([{display:"We're not available in \"".concat(e,'" yet - coming soon!'),searchText:e,type:"not_supported"}]):a(t)}),100),[a]);return(0,T.jsxs)(x.default,{style:[G.locationInputWrapper,{zIndex:2}],children:[(0,T.jsx)(q.default,{ref:r,style:G.locationInput,placeholder:"Enter city or zip in Colorado",value:e,onChangeText:e=>{t(e),e.length<1?a([]):i(e)},onFocus:()=>{e.length>0&&i(e)},onBlur:()=>{setTimeout((()=>{a([])}),150)}}),o.length>0&&(0,T.jsx)(x.default,{style:G.suggestionsWrapper,children:(0,T.jsx)(H.default,{style:G.suggestionsContainer,keyboardShouldPersistTaps:"always",nestedScrollEnabled:!0,children:o.map(((e,o)=>(0,T.jsxs)(v.default,{style:[G.suggestionItem,"not_supported"===e.type&&G.suggestionItemNotSupported],onPress:()=>{"not_supported"!==e.type&&(t(e.display),a([]))},disabled:"not_supported"===e.type,children:[(0,T.jsx)(C.default,{style:[G.suggestionText,"not_supported"===e.type&&G.suggestionTextNotSupported],children:e.display}),"zip"===e.type&&(0,T.jsx)(C.default,{style:G.suggestionType,children:"ZIP Code"})]},o)))})})]})}),{value:l,onChange:d,suggestions:c,onSuggestionSelect:u})}),(0,T.jsx)(C.default,{style:G.label,children:"What service do you need? (e.g., Dog Walking, Pet Sitting)"}),(0,T.jsx)(Qa,{value:h,onChange:f}),(0,T.jsxs)(x.default,{style:G.switchContainer,children:[(0,T.jsx)(C.default,{style:G.label,children:"Overnight Service"}),(0,T.jsx)(He.default,{value:b,onValueChange:w,trackColor:{false:m.theme.colors.border,true:m.theme.colors.primary}})]}),(0,T.jsx)(C.default,{style:G.label,children:"Price Range"}),(0,T.jsxs)(x.default,{style:G.priceContainer,children:[(0,T.jsx)(C.default,{style:G.priceLabel,children:"$0"}),(0,T.jsx)(Za(),{style:G.slider,minimumValue:0,maximumValue:250,value:j,onValueChange:B,minimumTrackTintColor:m.theme.colors.primary,maximumTrackTintColor:m.theme.colors.border,thumbTintColor:m.theme.colors.primary,step:1}),(0,T.jsxs)(C.default,{style:G.priceLabel,children:["$",Math.round(j)]})]}),(0,T.jsx)(v.default,{style:[G.searchButton,N&&G.searchButtonDisabled],onPress:async()=>{U(!0);try{(0,g.debugLog)("MBA9999","Starting professional search with filters:",{selectedAnimals:p,location:l,service:h,overnightService:b,priceRange:j});const e={animal_types:p,location:l.trim(),service_query:h.trim(),overnight_service:b,price_min:0,price_max:j,radius_miles:30,page:1,page_size:20},o=await(0,Ze.searchProfessionals)(e);(0,g.debugLog)("MBA9999","Search completed successfully:",o),i&&i(o,e),t&&t()}catch(e){(0,g.debugLog)("MBA9999","Search failed:",e),console.error("Search failed:",e)}finally{U(!1)}},disabled:N,children:(0,T.jsx)(C.default,{style:G.searchButtonText,children:N?"Searching...":"Search"})})]})}),nr=({professional:e,index:t,onPress:n})=>{e.primary_service?.unit_of_time&&(0,g.debugLog)("MBA4001: Unit of time mapping",{backend_value:e.primary_service.unit_of_time,frontend_value:me[e.primary_service.unit_of_time],professional_name:e.name});return(0,T.jsx)(v.default,{style:ar.listItem,onPress:()=>{n&&n()},children:(0,T.jsxs)(x.default,{style:ar.cardContent,children:[(0,T.jsx)(x.default,{style:ar.leftSection,children:(0,T.jsx)(U.default,{source:e.profile_picture_url?{uri:e.profile_picture_url}:o(4456),style:ar.profileImage})}),(0,T.jsx)(x.default,{style:ar.mainContent,children:(0,T.jsxs)(x.default,{style:ar.header,children:[(0,T.jsxs)(x.default,{style:ar.nameSection,children:[(0,T.jsxs)(C.default,{style:ar.name,children:[t+1,". ",e.primary_service?.service_name||"Various Services"]}),(0,T.jsx)(C.default,{style:ar.location,children:e.location}),(0,T.jsx)(C.default,{style:ar.distance,children:e.name})]}),(0,T.jsxs)(x.default,{style:ar.priceSection,children:[(0,T.jsx)(C.default,{style:ar.fromText,children:"from"}),(0,T.jsxs)(C.default,{style:ar.amount,children:[(0,T.jsx)(C.default,{style:ar.dollarSign,children:"$"}),e.primary_service?e.primary_service.price_per_visit:"N/A"]}),(0,T.jsx)(C.default,{style:ar.perNight,children:e.primary_service?me[e.primary_service.unit_of_time]||e.primary_service.unit_of_time:"per visit"})]})]})})]})})},ar=r.default.create({container:{flex:1,width:"100%",backgroundColor:m.theme.colors.surfaceContrast},listContent:{flexGrow:1},listItem:{width:"100%",backgroundColor:m.theme.colors.surfaceContrast,borderBottomWidth:1,borderBottomColor:m.theme.colors.border,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:3,elevation:3},cardContent:{flexDirection:"row",paddingHorizontal:m.theme.spacing.medium,paddingTop:m.theme.spacing.medium,paddingBottom:m.theme.spacing.medium},leftSection:{marginRight:m.theme.spacing.medium},profileImage:{width:80,height:80,borderRadius:40},mainContent:{flex:1},header:{flexDirection:"row",justifyContent:"space-between",alignItems:"flex-start"},nameSection:{flex:1,marginRight:m.theme.spacing.medium},name:{fontSize:m.theme.fontSizes.large,fontWeight:"600",color:m.theme.colors.text,marginBottom:4},location:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.textSecondary,marginBottom:2},distance:{fontSize:m.theme.fontSizes.small,color:m.theme.colors.textSecondary},priceSection:{alignItems:"flex-end"},fromText:{fontSize:m.theme.fontSizes.small,color:m.theme.colors.textSecondary},amount:{fontSize:m.theme.fontSizes.large+4,fontWeight:"600",color:m.theme.colors.primary,marginVertical:2},dollarSign:{color:m.theme.colors.primary},perNight:{fontSize:m.theme.fontSizes.small,color:m.theme.colors.textSecondary},reviewSection:{paddingHorizontal:m.theme.spacing.medium,paddingVertical:m.theme.spacing.small,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},ratingContainer:{flexDirection:"row",alignItems:"center",marginBottom:m.theme.spacing.small},ratingText:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,fontWeight:"500",marginLeft:4},dot:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.textSecondary},reviews:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.textSecondary},repeatOwners:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.textSecondary},bestReviewContainer:{flexDirection:"row",alignItems:"center"},reviewerImage:{width:32,height:32,borderRadius:16,marginRight:m.theme.spacing.small},bestReviewTextContainer:{flex:1},bestReview:{flex:1,fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,fontStyle:"italic"},readMore:{color:m.theme.colors.primary,fontStyle:"normal",fontWeight:"500"},header:{flexDirection:"row",justifyContent:"space-between",alignItems:"flex-start",paddingHorizontal:m.theme.spacing.medium,paddingTop:m.theme.spacing.medium,backgroundColor:m.theme.colors.surfaceContrast},mobileHeaderRight:{flexDirection:"row",alignItems:"center"},headerContent:{flex:1,marginRight:m.theme.spacing.medium},headerTitle:{fontSize:m.theme.fontSizes.large,fontWeight:"600",color:m.theme.colors.text,marginBottom:m.theme.spacing.small},filterChips:{flexDirection:"row",flexWrap:"wrap",gap:m.theme.spacing.small},filterChip:{backgroundColor:m.theme.colors.background,paddingHorizontal:m.theme.spacing.medium,paddingVertical:m.theme.spacing.small,borderRadius:16,borderWidth:1,borderColor:m.theme.colors.border},filterChipText:{fontSize:m.theme.fontSizes.small,color:m.theme.colors.text},filterButton:{padding:m.theme.spacing.small,borderRadius:8},headerButtons:{flexDirection:"row",gap:m.theme.spacing.small},emptyStateContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:m.theme.spacing.large},emptyStateTitle:{fontSize:m.theme.fontSizes.large,fontWeight:"600",color:m.theme.colors.text,marginTop:m.theme.spacing.medium,marginBottom:m.theme.spacing.small,textAlign:"center"},emptyStateMessage:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.textSecondary,textAlign:"center",marginBottom:m.theme.spacing.large,lineHeight:22},adjustSearchButton:{paddingHorizontal:m.theme.spacing.large,paddingVertical:m.theme.spacing.medium,borderRadius:8,backgroundColor:m.theme.colors.primary},adjustSearchButtonText:{fontSize:m.theme.fontSizes.medium,fontWeight:"600",color:m.theme.colors.whiteText}}),rr=({professionals:e,onLoadMore:t,onProfessionalSelect:o,isMobile:n,filters:a,onFilterPress:r,searchParams:i=null})=>{const s=()=>{const e=(()=>{if(!i)return{title:"No professionals found",message:"Please try adjusting your search criteria."};const{animal_types:e=[],location:t="",service_query:o="",overnight_service:n=!1}=i,a=t.toLowerCase().includes("colorado springs")||t.toLowerCase().includes("colorado")||""===t;if(a&&0===e.length&&!o&&!n)return{title:"No professionals in the Colorado Springs area yet!",message:"Please come back later when we onboard more professionals to your area."};let r=[];if(e.length>0){const t=1===e.length?"".concat(e[0]," care"):"care for ".concat(e.join(", "));r.push(t)}if(o&&r.push('"'.concat(o,'" services')),n&&r.push("overnight services"),t&&!a&&r.push("in ".concat(t)),r.length>0){const e=r.join(", ");return{title:"No professionals found with ".concat(e),message:"Please try adjusting your search parameters or expanding your search area."}}return{title:"No professionals found",message:"Please try adjusting your search criteria."}})();return(0,g.debugLog)("MBA4001: Showing empty state",{searchParams:i,emptyStateTitle:e.title,emptyStateMessage:e.message}),(0,T.jsxs)(x.default,{style:ar.emptyStateContainer,children:[(0,T.jsx)(S.default,{name:"account-search",size:80,color:m.theme.colors.textSecondary}),(0,T.jsx)(C.default,{style:ar.emptyStateTitle,children:e.title}),(0,T.jsx)(C.default,{style:ar.emptyStateMessage,children:e.message}),(0,T.jsx)(v.default,{style:ar.adjustSearchButton,onPress:()=>r&&r(),children:(0,T.jsx)(C.default,{style:ar.adjustSearchButtonText,children:"Adjust Search"})})]})},l=()=>(0,T.jsxs)(x.default,{style:[ar.header,{borderBottomWidth:1,borderBottomColor:m.theme.colors.border,paddingBottom:m.theme.spacing.medium}],children:[(0,T.jsxs)(x.default,{style:ar.headerContent,children:[(0,T.jsx)(C.default,{style:ar.headerTitle,children:"Pet Care Professionals"}),(0,T.jsx)(x.default,{style:ar.filterChips,children:a?.categories?.map(((e,t)=>(0,T.jsx)(x.default,{style:ar.filterChip,children:(0,T.jsx)(C.default,{style:ar.filterChipText,children:e})},t)))})]}),(0,T.jsxs)(x.default,{style:ar.headerButtons,children:[(0,T.jsx)(v.default,{style:ar.filterButton,onPress:r,children:(0,T.jsx)(S.default,{name:"filter",size:24,color:m.theme.colors.text})}),n&&(0,T.jsx)(v.default,{style:ar.filterButton,onPress:()=>{r&&r("map")},children:(0,T.jsx)(S.default,{name:"map",size:24,color:m.theme.colors.text})})]})]});return e&&0!==e.length?(0,T.jsxs)(x.default,{style:ar.container,children:[l(),(0,T.jsx)(wt.default,{data:e,renderItem:({item:e,index:t})=>(0,T.jsx)(nr,{professional:e,index:t,onPress:()=>o(e)}),keyExtractor:e=>e.professional_id.toString(),onEndReached:t,onEndReachedThreshold:.5,contentContainerStyle:ar.listContent})]}):(0,T.jsxs)(x.default,{style:ar.container,children:[l(),s()]})};var ir=o(74400),sr=o(12906),lr=o(12391),dr=o(72321),cr=(o(1297),o(14918)),ur=o.n(cr);delete ur().Icon.Default.prototype._getIconUrl,ur().Icon.Default.mergeOptions({iconRetinaUrl:o(18249),iconUrl:o(37024),shadowUrl:o(91071)});const mr=({professional:e,onShowServicesModal:t})=>{const o=(0,n.useRef)(null),a=(0,n.useRef)(null),r=ur().divIcon({className:"custom-marker",html:'<div style="\n    width: 32px;\n    height: 32px;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n  ">\n    <svg viewBox="0 0 24 24" width="32" height="32">\n      <path fill="'.concat(m.theme.colors.primary,'" d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>\n    </svg>\n  </div>'),iconSize:[32,32],iconAnchor:[16,32],popupAnchor:[0,-32]});return(0,n.useEffect)((()=>{const e=o.current;if(e){const t=e.getElement?e:e._leaflet_marker;t&&t.on("mouseover",(()=>{a.current&&a.current.openOn(e._map)}))}}),[]),(0,T.jsx)(ir.Marker,{ref:o,position:[e.coordinates.latitude,e.coordinates.longitude],icon:r,children:(0,T.jsx)(sr.Popup,{ref:a,closeButton:!0,autoClose:!1,closeOnClick:!1,closeOnEscapeKey:!0,children:(0,T.jsxs)("div",{style:fr.popupContent,children:[(0,T.jsx)("h3",{style:{margin:"0 0 8px 0",fontSize:"18px",fontWeight:"600",fontFamily:m.theme.fonts.header.fontFamily,color:m.theme.colors.text},children:e.name}),(0,T.jsx)("p",{style:{margin:"0 0 4px 0",fontSize:"14px",color:m.theme.colors.textSecondary},children:e.location}),(0,T.jsx)("p",{style:{margin:"0 0 8px 0",fontSize:"14px",color:m.theme.colors.text,fontWeight:"500"},children:e.primary_service?.service_name}),(0,T.jsxs)("p",{style:{margin:"0 0 12px 0",fontSize:"16px",fontWeight:"600",color:m.theme.colors.primary},children:["from $",e.primary_service?.price_per_visit||"N/A","/",(i=e.primary_service?.unit_of_time||"visit",me[i]||i)]}),(0,T.jsx)("button",{style:{backgroundColor:m.theme.colors.primary,color:m.theme.colors.whiteText,border:"none",padding:"10px 16px",borderRadius:"8px",fontSize:"14px",fontWeight:"500",cursor:"pointer",width:"100%"},onClick:()=>{t&&t(e)},children:"View Details"})]})})});var i},gr=({professionals:e,onMarkerPress:t,region:o,isMobile:n,onShowServicesModal:a})=>{const r=(()=>{const t=e.filter((e=>e.coordinates&&e.coordinates.latitude&&e.coordinates.longitude));if(0===t.length)return{center:[o.latitude,o.longitude],zoom:13};if(1===t.length){const e=t[0];return{center:[e.coordinates.latitude,e.coordinates.longitude],zoom:14}}const n=t.map((e=>e.coordinates.latitude)),a=t.map((e=>e.coordinates.longitude)),r=Math.min(...n),i=Math.max(...n),s=Math.min(...a),l=Math.max(...a),d=(r+i)/2,c=(s+l)/2,u=i-r,m=l-s,g=Math.max(u,m);let h=13;return h=g>.5?10:g>.2?11:g>.1?12:g>.05?13:14,{center:[d,c],zoom:h}})();return(0,T.jsx)("div",{style:fr.mapContainer,children:(0,T.jsxs)(lr.MapContainer,{center:r.center,zoom:r.zoom,style:{height:"100%",width:"100%"},children:[(0,T.jsx)(dr.TileLayer,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'\xa9 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}),e.filter((e=>e.coordinates&&e.coordinates.latitude&&e.coordinates.longitude)).map(((e,t)=>(0,T.jsx)(mr,{professional:e,onShowServicesModal:a},e.professional_id)))]},"".concat(r.center[0],"-").concat(r.center[1],"-").concat(r.zoom))})},hr=({professionals:e,onMarkerPress:t,region:o,isMobile:n})=>(0,T.jsx)(x.default,{style:fr.mapContainer}),fr=r.default.create({mapContainer:{flex:1,backgroundColor:m.theme.colors.background,height:"100%",width:"100%",overflow:"hidden"},map:{flex:1,height:"100%",width:"100%"},markerContainer:{backgroundColor:m.theme.colors.primary,borderRadius:20,padding:m.theme.spacing.small,borderWidth:2,borderColor:"white"},markerText:{color:m.theme.colors.whiteText,fontWeight:"bold"},calloutContainer:{backgroundColor:m.theme.colors.surface,padding:m.theme.spacing.small,borderRadius:8,borderWidth:1,borderColor:m.theme.colors.border},calloutText:{color:m.theme.colors.text,fontSize:m.theme.fontSizes.small},popupContent:{padding:16,minWidth:250,maxWidth:300}}),pr=({professionals:e,onMarkerPress:t,region:o,isMobile:n,onShowServicesModal:r})=>"web"===a.default.OS?(0,T.jsx)(gr,{professionals:e,onMarkerPress:t,region:o,isMobile:n,onShowServicesModal:r}):(0,T.jsx)(hr,{professionals:e,onMarkerPress:t,region:o,isMobile:n,onShowServicesModal:r}),yr=r.default.create({modalOverlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center",padding:20},modalContainer:{backgroundColor:m.theme.colors.surface,borderRadius:12,width:"90%",maxWidth:800,maxHeight:"80%",overflow:"hidden"},modalContainerSmallMobile:{width:"calc(100% - 10px)",height:"calc(100% - 10px)",maxWidth:"none",maxHeight:"none",borderRadius:8},header:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:20,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},headerLeft:{flex:1},professionalName:{fontSize:20,fontWeight:"600",color:m.theme.colors.text,fontFamily:m.theme.fonts.header.fontFamily},professionalLocation:{fontSize:14,color:m.theme.colors.textSecondary,marginTop:4},closeButton:{padding:8},loadingContainer:{padding:40,alignItems:"center"},loadingText:{marginTop:16,color:m.theme.colors.textSecondary},errorContainer:{padding:40,alignItems:"center"},errorText:{color:m.theme.colors.error,textAlign:"center",marginBottom:16},retryButton:{backgroundColor:m.theme.colors.primary,paddingHorizontal:20,paddingVertical:10,borderRadius:8},retryText:{color:m.theme.colors.whiteText,fontWeight:"500"},content:{flexDirection:"row",flex:1},contentMobile:{flexDirection:"column"},mobileServicesView:{flex:1,padding:20},mobileServiceItem:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",padding:16,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},mobileServiceContent:{flex:1},mobileServiceName:{fontSize:16,fontWeight:"500",color:m.theme.colors.text,marginBottom:4},mobileServicePrice:{fontSize:14,color:m.theme.colors.textSecondary},mobileDetailsView:{flex:1},mobileDetailsHeader:{flexDirection:"row",alignItems:"center",padding:20,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},backButton:{padding:8,marginRight:12},mobileDetailsTitle:{fontSize:18,fontWeight:"600",color:m.theme.colors.text,flex:1},mobileDetailsScrollView:{flex:1,padding:20},servicesList:{width:"40%",borderRightWidth:1,borderRightColor:m.theme.colors.border,padding:20},sectionTitle:{fontSize:18,fontWeight:"600",color:m.theme.colors.text,marginBottom:16,fontFamily:m.theme.fonts.header.fontFamily},servicesScrollView:{flex:1},serviceItem:{padding:12,borderRadius:8,marginBottom:8,backgroundColor:m.theme.colors.background,borderWidth:1,borderColor:m.theme.colors.border},serviceItemSelected:{backgroundColor:m.theme.colors.primary,borderColor:m.theme.colors.primary},serviceName:{fontSize:14,fontWeight:"500",color:m.theme.colors.text,marginBottom:4},serviceNameSelected:{color:m.theme.colors.whiteText},servicePrice:{fontSize:12,color:m.theme.colors.textSecondary},servicePriceSelected:{color:m.theme.colors.whiteText},serviceDetails:{flex:1,padding:20},detailsScrollView:{flex:1},detailsTitle:{fontSize:24,fontWeight:"600",color:m.theme.colors.text,marginBottom:20,fontFamily:m.theme.fonts.header.fontFamily},detailSection:{marginBottom:20},detailLabel:{fontSize:14,fontWeight:"600",color:m.theme.colors.text,marginBottom:8},detailText:{fontSize:14,color:m.theme.colors.textSecondary,lineHeight:20},overnightBadge:{backgroundColor:m.theme.colors.primary,color:m.theme.colors.whiteText,paddingHorizontal:12,paddingVertical:6,borderRadius:16,fontSize:12,fontWeight:"500",alignSelf:"flex-start"},additionalRateItem:{paddingVertical:8,borderBottomWidth:1,borderBottomColor:m.theme.colors.border,position:"relative"},additionalRateRow:{flexDirection:"row",alignItems:"center",justifyContent:"space-between"},additionalRateTitleContainer:{flexDirection:"row",alignItems:"flex-start",flex:1},additionalRateTitle:{fontSize:14,color:m.theme.colors.text,flex:1,marginLeft:4},infoIcon:{padding:2,marginTop:-2},additionalRatePrice:{fontSize:14,fontWeight:"500",color:m.theme.colors.primary,marginLeft:16},tooltipModalOverlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center"},tooltipModalContent:{backgroundColor:m.theme.colors.surface,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:12,padding:16,margin:20,maxWidth:300,shadowColor:"#000",shadowOffset:{width:0,height:4},shadowOpacity:.2,shadowRadius:8,elevation:10},tooltipHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:12},tooltipTitle:{fontSize:16,fontWeight:"600",color:m.theme.colors.text,flex:1},tooltipCloseButton:{padding:4,marginLeft:8},tooltipText:{fontSize:14,color:m.theme.colors.textSecondary,lineHeight:20},noSelectionContainer:{flex:1,justifyContent:"center",alignItems:"center"},noSelectionText:{color:m.theme.colors.textSecondary,fontSize:16},footer:{padding:20,borderTopWidth:1,borderTopColor:m.theme.colors.border},contactButton:{backgroundColor:m.theme.colors.primary,paddingVertical:16,borderRadius:8,alignItems:"center"},contactButtonDisabled:{backgroundColor:m.theme.colors.placeholder,opacity:.7},contactButtonContent:{flexDirection:"row",alignItems:"center",justifyContent:"center"},contactButtonText:{color:m.theme.colors.whiteText,fontSize:16,fontWeight:"600"},errorModalContent:{backgroundColor:m.theme.colors.surface,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:12,padding:16,margin:20,maxWidth:300,shadowColor:"#000",shadowOffset:{width:0,height:4},shadowOpacity:.2,shadowRadius:8,elevation:10},errorModalHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:12},errorModalTitle:{fontSize:16,fontWeight:"600",color:m.theme.colors.text,flex:1},errorModalCloseButton:{padding:4,marginLeft:8},errorModalText:{fontSize:14,color:m.theme.colors.textSecondary,lineHeight:20},errorModalOkButton:{backgroundColor:m.theme.colors.primary,paddingVertical:16,borderRadius:8,alignItems:"center",marginTop:16},errorModalOkText:{color:m.theme.colors.whiteText,fontSize:16,fontWeight:"600"}}),br=({visible:e,onClose:t,professional:o,primaryService:a})=>{const r=(0,y.useNavigation)(),{isSignedIn:i}=(0,n.useContext)(g.AuthContext),[s,l]=(0,n.useState)([]),[d,c]=(0,n.useState)(null),[u,h]=(0,n.useState)(!1),[f,p]=(0,n.useState)(null),[b,w]=(0,n.useState)(null),[B,k]=(0,n.useState)("services"),[I,M]=(0,n.useState)(!1),[D,R]=(0,n.useState)(!1),[L,z]=(0,n.useState)(""),{width:P}=j.default.get("window"),F=P<=768,O=P<=600;(0,n.useEffect)((()=>{e&&o?.professional_id&&E()}),[e,o?.professional_id]),(0,n.useEffect)((()=>{if(s.length>0&&a){const e=s.find((e=>e.service_id===a.service_id));c(e||s[0])}else s.length>0&&c(s[0])}),[s,a]);const E=async()=>{h(!0),p(null);try{(0,g.debugLog)("MBA9999","Fetching services for professional:",o.professional_id);const e=await(0,Ze.getProfessionalServicesDetailed)(o.professional_id);l(e)}catch(e){(0,g.debugLog)("MBA9999","Error fetching professional services:",e),p("Failed to load services")}finally{h(!1)}},W=()=>{c(null),l([]),p(null),w(null),k("services"),R(!1),z(""),t()},N=e=>{c(e),F&&k("details")},U=e=>{if(!e||"object"!==typeof e)return"Various animals";const t=Object.keys(e);return 0===t.length?"Various animals":1===t.length?t[0]:2===t.length?"".concat(t[0]," & ").concat(t[1]):"".concat(t[0],", ").concat(t[1]," & ").concat(t.length-2," more")},V=e=>{return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)(x.default,{style:yr.detailSection,children:[(0,T.jsx)(C.default,{style:yr.detailLabel,children:"Description"}),(0,T.jsx)(C.default,{style:yr.detailText,children:e.description})]}),(0,T.jsxs)(x.default,{style:yr.detailSection,children:[(0,T.jsx)(C.default,{style:yr.detailLabel,children:"Animal Types"}),(0,T.jsx)(C.default,{style:yr.detailText,children:U(e.animal_types)})]}),(0,T.jsxs)(x.default,{style:yr.detailSection,children:[(0,T.jsx)(C.default,{style:yr.detailLabel,children:"Base Rate"}),(0,T.jsxs)(C.default,{style:yr.detailText,children:["$",e.base_rate," per ",e.unit_of_time]})]}),(0,T.jsxs)(x.default,{style:yr.detailSection,children:[(0,T.jsx)(C.default,{style:yr.detailLabel,children:"Additional Animal Rate"}),(0,T.jsxs)(C.default,{style:yr.detailText,children:["$",e.additional_animal_rate," (applies after ",e.applies_after," animal",e.applies_after>1?"s":"",")"]})]}),e.holiday_rate&&"$0"!==e.holiday_rate&&"$0.00"!==e.holiday_rate&&"0%"!==e.holiday_rate&&"0.00%"!==e.holiday_rate&&"0"!==e.holiday_rate&&(0,T.jsxs)(x.default,{style:yr.detailSection,children:[(0,T.jsx)(C.default,{style:yr.detailLabel,children:"Holiday Rate"}),(0,T.jsx)(C.default,{style:yr.detailText,children:e.holiday_rate})]}),e.is_overnight&&(0,T.jsx)(x.default,{style:yr.detailSection,children:(0,T.jsx)(C.default,{style:yr.overnightBadge,children:"Overnight Service"})}),(t=e.additional_rates,t&&0!==t.length?(0,T.jsxs)(x.default,{style:yr.detailSection,children:[(0,T.jsx)(C.default,{style:yr.detailLabel,children:"Additional Rates"}),t.map((e=>(0,T.jsx)(x.default,{style:yr.additionalRateItem,children:(0,T.jsxs)(x.default,{style:yr.additionalRateRow,children:[(0,T.jsxs)(x.default,{style:yr.additionalRateTitleContainer,children:[e.description&&(0,T.jsx)(v.default,{style:yr.infoIcon,onPress:()=>w(b===e.rate_id?null:e.rate_id),children:(0,T.jsx)(S.default,{name:"information-outline",size:16,color:m.theme.colors.primary})}),(0,T.jsx)(C.default,{style:yr.additionalRateTitle,children:e.title})]}),(0,T.jsxs)(C.default,{style:yr.additionalRatePrice,children:["$",e.rate]})]})},e.rate_id)))]}):null)]});var t};return(0,T.jsxs)(A.default,{visible:e,onRequestClose:W,animationType:"slide",transparent:!0,children:[(0,T.jsx)(x.default,{style:yr.modalOverlay,children:(0,T.jsxs)(x.default,{style:[yr.modalContainer,O&&yr.modalContainerSmallMobile],children:[(0,T.jsxs)(x.default,{style:yr.header,children:[(0,T.jsxs)(x.default,{style:yr.headerLeft,children:[(0,T.jsx)(C.default,{style:yr.professionalName,children:o?.name}),(0,T.jsx)(C.default,{style:yr.professionalLocation,children:o?.location})]}),(0,T.jsx)(v.default,{onPress:W,style:yr.closeButton,children:(0,T.jsx)(S.default,{name:"close",size:24,color:m.theme.colors.text})})]}),u?(0,T.jsxs)(x.default,{style:yr.loadingContainer,children:[(0,T.jsx)(_.default,{size:"large",color:m.theme.colors.primary}),(0,T.jsx)(C.default,{style:yr.loadingText,children:"Loading services..."})]}):f?(0,T.jsxs)(x.default,{style:yr.errorContainer,children:[(0,T.jsx)(C.default,{style:yr.errorText,children:f}),(0,T.jsx)(v.default,{style:yr.retryButton,onPress:E,children:(0,T.jsx)(C.default,{style:yr.retryText,children:"Retry"})})]}):(0,T.jsxs)(x.default,{style:[yr.content,F&&yr.contentMobile],children:[F&&"services"===B&&(0,T.jsxs)(x.default,{style:yr.mobileServicesView,children:[(0,T.jsx)(C.default,{style:yr.sectionTitle,children:"Services"}),(0,T.jsx)(H.default,{style:yr.servicesScrollView,children:s.map((e=>(0,T.jsxs)(v.default,{style:yr.mobileServiceItem,onPress:()=>N(e),children:[(0,T.jsxs)(x.default,{style:yr.mobileServiceContent,children:[(0,T.jsx)(C.default,{style:yr.mobileServiceName,children:e.service_name}),(0,T.jsxs)(C.default,{style:yr.mobileServicePrice,children:["$",e.base_rate,"/",e.unit_of_time]})]}),(0,T.jsx)(S.default,{name:"chevron-right",size:24,color:m.theme.colors.textSecondary})]},e.service_id)))})]}),F&&"details"===B&&d&&(0,T.jsxs)(x.default,{style:yr.mobileDetailsView,children:[(0,T.jsxs)(x.default,{style:yr.mobileDetailsHeader,children:[(0,T.jsx)(v.default,{style:yr.backButton,onPress:()=>{k("services")},children:(0,T.jsx)(S.default,{name:"arrow-left",size:24,color:m.theme.colors.primary})}),(0,T.jsx)(C.default,{style:yr.mobileDetailsTitle,children:d.service_name})]}),(0,T.jsx)(H.default,{style:yr.mobileDetailsScrollView,children:V(d)})]}),!F&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)(x.default,{style:yr.servicesList,children:[(0,T.jsx)(C.default,{style:yr.sectionTitle,children:"Services"}),(0,T.jsx)(H.default,{style:yr.servicesScrollView,children:s.map((e=>(0,T.jsxs)(v.default,{style:[yr.serviceItem,d?.service_id===e.service_id&&yr.serviceItemSelected],onPress:()=>N(e),children:[(0,T.jsx)(C.default,{style:[yr.serviceName,d?.service_id===e.service_id&&yr.serviceNameSelected],children:e.service_name}),(0,T.jsxs)(C.default,{style:[yr.servicePrice,d?.service_id===e.service_id&&yr.servicePriceSelected],children:["$",e.base_rate,"/",e.unit_of_time]})]},e.service_id)))})]}),(0,T.jsx)(x.default,{style:yr.serviceDetails,children:d?(0,T.jsxs)(H.default,{style:yr.detailsScrollView,children:[(0,T.jsx)(C.default,{style:yr.detailsTitle,children:d.service_name}),V(d)]}):(0,T.jsx)(x.default,{style:yr.noSelectionContainer,children:(0,T.jsx)(C.default,{style:yr.noSelectionText,children:"Select a service to view details"})})})]})]}),!u&&!f&&(0,T.jsx)(x.default,{style:yr.footer,children:(0,T.jsx)(v.default,{style:[yr.contactButton,I&&yr.contactButtonDisabled],onPress:async()=>{if(o?.professional_id){if(!i)return(0,g.debugLog)("MBA3456","User not signed in, redirecting to login"),t(),void r.navigate("SignIn");M(!0);try{(0,g.debugLog)("MBA3456","Creating conversation with professional:",o.professional_id);const e=await(0,Ze.createConversation)(o.professional_id);(0,g.debugLog)("MBA3456","Conversation created, navigating to MessageHistory with ID:",e.conversation_id),t(),r.navigate("MessageHistory",{conversationId:e.conversation_id,otherUserName:o.name})}catch(e){(0,g.debugLog)("MBA3456","Error creating conversation:",e),400===e.response?.status&&"Cannot create conversation with yourself"===e.response?.data?.error?(z("You cannot contact yourself."),R(!0)):(z("Failed to create conversation. Please try again."),R(!0))}finally{M(!1)}}else ft.default.alert("Error","Professional information not available")},disabled:I,children:I?(0,T.jsxs)(x.default,{style:yr.contactButtonContent,children:[(0,T.jsx)(_.default,{size:"small",color:m.theme.colors.whiteText}),(0,T.jsx)(C.default,{style:[yr.contactButtonText,{marginLeft:8}],children:"Creating conversation..."})]}):(0,T.jsxs)(C.default,{style:yr.contactButtonText,children:["Contact ",o?.name]})})})]})}),(0,T.jsx)(A.default,{visible:null!==b,transparent:!0,animationType:"fade",onRequestClose:()=>w(null),children:(0,T.jsx)(v.default,{style:yr.tooltipModalOverlay,activeOpacity:1,onPress:()=>w(null),children:(0,T.jsxs)(x.default,{style:yr.tooltipModalContent,children:[(0,T.jsxs)(x.default,{style:yr.tooltipHeader,children:[(0,T.jsx)(C.default,{style:yr.tooltipTitle,children:s.find((e=>e.additional_rates?.find((e=>e.rate_id===b))))?.additional_rates?.find((e=>e.rate_id===b))?.title||"Rate Info"}),(0,T.jsx)(v.default,{style:yr.tooltipCloseButton,onPress:()=>w(null),children:(0,T.jsx)(S.default,{name:"close",size:18,color:m.theme.colors.text})})]}),(0,T.jsx)(C.default,{style:yr.tooltipText,children:s.find((e=>e.additional_rates?.find((e=>e.rate_id===b))))?.additional_rates?.find((e=>e.rate_id===b))?.description||""})]})})}),(0,T.jsx)(A.default,{visible:D,transparent:!0,animationType:"fade",onRequestClose:()=>R(!1),children:(0,T.jsx)(v.default,{style:yr.tooltipModalOverlay,activeOpacity:1,onPress:()=>R(!1),children:(0,T.jsxs)(v.default,{style:yr.errorModalContent,activeOpacity:1,onPress:e=>e.stopPropagation(),children:[(0,T.jsxs)(x.default,{style:yr.errorModalHeader,children:[(0,T.jsx)(C.default,{style:yr.errorModalTitle,children:"Error"}),(0,T.jsx)(v.default,{style:yr.errorModalCloseButton,onPress:()=>R(!1),children:(0,T.jsx)(S.default,{name:"close",size:20,color:m.theme.colors.text})})]}),(0,T.jsx)(C.default,{style:yr.errorModalText,children:L}),(0,T.jsx)(v.default,{style:yr.errorModalOkButton,onPress:()=>R(!1),children:(0,T.jsx)(C.default,{style:yr.errorModalOkText,children:"OK"})})]})})})]})};var xr=o(49377);const Cr=({navigation:e,route:t})=>{const{width:o}=(0,_e.default)(),{screenWidth:a,isCollapsed:i,isSignedIn:s}=(0,n.useContext)(g.AuthContext),[l,d]=(0,n.useState)(a<=1200),[c,u]=(0,n.useState)(a<=900),[h,f]=(0,n.useState)(l?"filters":"all"),[p,y]=(0,n.useState)([]),[b,C]=(0,n.useState)({}),[w,j]=(0,n.useState)(!1),[S,B]=(0,n.useState)(!0),[k,A]=(0,n.useState)(!0),[_,I]=(0,n.useState)(!1),[M,D]=(0,n.useState)(null),[R,L]=(0,n.useState)(null),[z,P]=(0,n.useState)({latitude:38.8339,longitude:-104.8214,latitudeDelta:.0922,longitudeDelta:.0421}),[F,O]=(0,n.useState)({categories:["Dogs","Within 5 miles"]}),[E,W]=(0,n.useState)(!1),[N,H]=(0,n.useState)(null);(0,n.useEffect)((()=>{d(a<=1200),u(a<=900),f(a<=1200?"filters":"all")}),[a]),(0,n.useEffect)((()=>e.addListener("focus",(()=>{l&&f("filters")}))),[e,l]),(0,n.useEffect)((()=>{U()}),[]);const U=async()=>{I(!0);try{(0,g.debugLog)("MBA9999","Loading initial professionals for Colorado Springs");const e={animal_types:[],location:"Colorado Springs, Colorado",service_query:"",overnight_service:!1,price_min:0,price_max:999999,radius_miles:30,page:1,page_size:20},t=await(0,Ze.searchProfessionals)(e);(0,g.debugLog)("MBA9999","Initial professionals loaded:",t),D(t),y(t.professionals||[]),L(e)}catch(e){(0,g.debugLog)("MBA9999","Error loading initial professionals:",e),console.error("Error loading initial professionals:",e)}finally{I(!1)}},V=(e,t=null)=>{(0,g.debugLog)("MBA9999","Received search results:",e),D(e),y(e.professionals||[]),t&&L(t)},q=e=>{C(e)},Y=()=>{},G=e=>{H(e),W(!0)},J=e=>{H(e),W(!0)},$=()=>{j(!w)},Z=e=>{A(!1),l&&f("map"===e?"map":"list")},K=()=>{B(!S),S||j(!0)},Q=((e,t,o,n)=>r.default.create({mainContainer:{flex:1,backgroundColor:m.theme.colors.background,position:"fixed",top:0,left:0,right:0,bottom:0,marginLeft:e>900&&o?t?70:250:0,paddingTop:!o||n?60:0,transition:"margin-left 0.3s ease"},container:{flex:1,display:"flex",flexDirection:"column",height:!o||n?"calc(100vh - 60px)":"100vh",overflow:"hidden"},content:{flex:1,flexDirection:"row",height:n?"100%":"calc(100vh - 64px)",overflow:"hidden"},leftColumn:{height:"100%",borderRightWidth:1,borderRightColor:m.theme.colors.border,backgroundColor:m.theme.colors.background,transition:"width 0.3s ease",position:"relative",zIndex:1},leftColumnToggle:{position:"absolute",top:"50%",right:-16,transform:[{translateY:-20}],zIndex:2e3,backgroundColor:m.theme.colors.surface,padding:m.theme.spacing.small,borderRadius:20,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:3,elevation:3,width:32,height:32,alignItems:"center",justifyContent:"center",borderWidth:1,borderColor:m.theme.colors.border},mapColumn:{flex:1,backgroundColor:m.theme.colors.background,height:"100%",transition:"width 0.3s ease",position:"relative",zIndex:0},toggleButton:{position:"absolute",top:m.theme.spacing.medium,right:m.theme.spacing.medium,zIndex:1e3,backgroundColor:m.theme.colors.surface,padding:m.theme.spacing.small,borderRadius:8,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:3,elevation:3},toggleButtonText:{color:m.theme.colors.primary,fontSize:m.theme.fontSizes.medium,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"500"},containerMobile:{flex:1,backgroundColor:m.theme.colors.background,height:"100%",overflow:"hidden"},mobileHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",borderBottomWidth:2,padding:10,marginHorizontal:10,backgroundColor:m.theme.colors.background},mobileHeaderText:{fontSize:m.theme.fontSizes.large,fontWeight:"500",fontFamily:m.theme.fonts.header.fontFamily},headerIcon:{padding:8,marginLeft:16},searchButton:{backgroundColor:m.theme.colors.primary,padding:10,alignItems:"center",borderRadius:5,margin:10},searchButtonText:{color:m.theme.colors.whiteText,fontSize:m.theme.fontSizes.medium+2,fontFamily:m.theme.fonts.regular.fontFamily},mapToggleButton:{position:"absolute",top:m.theme.spacing.medium,right:m.theme.spacing.medium,zIndex:1e3,backgroundColor:m.theme.colors.surface,padding:m.theme.spacing.small,borderRadius:8,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:3,elevation:3}}))(a,i,s,c);return(0,T.jsxs)(x.default,{style:Q.mainContainer,children:[(0,T.jsx)(Ie.default,{style:Q.container,children:(0,T.jsx)(x.default,{style:Q.content,children:(()=>{if(!l){const e=S?"50%":"33.333%",t=w?"50%":"66.666%";return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)(x.default,{style:[Q.leftColumn,{width:e}],children:[(0,T.jsx)(v.default,{style:[Q.toggleButton,Q.leftColumnToggle],onPress:K,children:(0,T.jsx)(xr.default,{name:S?"chevron-left":"chevron-right",size:24,color:m.theme.colors.primary})}),k?(0,T.jsx)(or,{onFiltersChange:q,onShowProfessionals:Z,onSearchResults:V,initialFilters:R}):(0,T.jsx)(rr,{professionals:p,onLoadMore:Y,onProfessionalSelect:G,isMobile:c,filters:F,searchParams:R,onFilterPress:e=>{"map"===e?f("map"):A(!0)}})]}),(0,T.jsxs)(x.default,{style:[Q.mapColumn,{width:t}],children:[(0,T.jsx)(v.default,{style:[Q.toggleButton,Q.mapToggleButton],onPress:$,children:(0,T.jsx)(xr.default,{name:w?"arrow-expand":"arrow-collapse",size:24,color:m.theme.colors.primary})}),(0,T.jsx)(pr,{professionals:p,onMarkerPress:G,onShowServicesModal:J,region:z,isMobile:c})]})]})}return(0,T.jsxs)(x.default,{style:Q.containerMobile,children:["filters"===h&&(0,T.jsx)(T.Fragment,{children:(0,T.jsx)(or,{onFiltersChange:q,onShowProfessionals:Z,onSearchResults:V,isMobile:l,initialFilters:R})}),"list"===h&&(0,T.jsx)(T.Fragment,{children:(0,T.jsx)(rr,{professionals:p,onLoadMore:Y,onProfessionalSelect:G,isMobile:l,filters:F,searchParams:R,onFilterPress:e=>{f("map"===e?"map":"filters")}})}),"map"===h&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(x.default,{style:Q.mobileHeader,children:(0,T.jsx)(v.default,{onPress:()=>f("list"),children:(0,T.jsx)(xr.default,{name:"arrow-left",size:24,color:m.theme.colors.primary})})}),(0,T.jsx)(pr,{professionals:p,onMarkerPress:G,onShowServicesModal:J,region:z,isMobile:l})]})]})})()})}),(0,T.jsx)(br,{visible:E,onClose:()=>{W(!1),H(null)},professional:N,primaryService:N?.primary_service})]})},vr=r.default.create({container:{flex:1,height:"100vh",backgroundColor:m.theme.colors.surface,position:"fixed",top:0,right:0,bottom:0,left:0,overflow:"hidden",transition:"margin-left 0.3s ease"},content:{flex:1,height:"100%",overflow:"auto"},mainContent:{flex:1,width:"100%",alignSelf:"center",backgroundColor:m.theme.colors.background},headerSection:{width:"100%",backgroundColor:m.theme.colors.surfaceContrast,paddingHorizontal:24,paddingTop:24,zIndex:2},bookingsContent:{flex:1,backgroundColor:m.theme.colors.surface,position:"relative"},title:{fontSize:32,fontWeight:"600",color:m.theme.colors.text,marginBottom:24,fontFamily:m.theme.fonts.header.fontFamily},tabContainer:{flexDirection:"row",gap:32},tab:{paddingBottom:8,borderBottomWidth:2,borderBottomColor:"transparent"},activeTab:{borderBottomColor:m.theme.colors.primary},tabText:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},activeTabText:{color:m.theme.colors.primary,fontWeight:"500"},stickyHeader:{position:"absolute",top:0,left:0,right:0,backgroundColor:m.theme.colors.surfaceContrast,zIndex:2,marginHorizontal:24,marginTop:24,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,borderRadius:8,padding:16},stickyHeaderContent:{width:"100%",gap:16},searchContainer:{flexDirection:"row",alignItems:"center",backgroundColor:m.theme.colors.surfaceContrast,borderRadius:8,padding:12,borderWidth:1,borderColor:"#CCCBC9"},filterScrollContent:{flexGrow:0},filtersWrapper:{flexDirection:"row",justifyContent:"flex-end",marginRight:-16},filterContainer:{flexDirection:"row",gap:8,backgroundColor:m.theme.colors.surfaceContrast,paddingVertical:8,paddingLeft:4,paddingRight:16},filterButton:Object.assign({paddingHorizontal:12,paddingVertical:6,borderRadius:16,justifyContent:"center"},"web"===a.default.OS&&{transition:"all 0.2s ease-in-out",cursor:"pointer"}),filterButtonHovered:{transform:[{scale:1.05}],shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:5},filterContent:{flexDirection:"row",alignItems:"center",justifyContent:"center",gap:6},checkmark:{marginLeft:4},allButton:{backgroundColor:"#EFF9FF"},allButtonText:{color:"#0784C6"},pendingButton:{backgroundColor:m.theme.colors.mybookings.main},pendingButtonText:{color:m.theme.colors.mybookings.secondary},confirmedButton:{backgroundColor:"#E8E9E2"},confirmedButtonText:{color:"#898974"},completedButton:{backgroundColor:"#F5F5F4"},completedButtonText:{color:m.theme.colors.mybookings.completedText},filterText:{fontSize:14,fontFamily:m.theme.fonts.regular.fontFamily,textAlign:"center"},listHeaderSpacing:{paddingTop:16},listContainer:{paddingHorizontal:24,paddingBottom:34},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center"},loadingMoreContainer:{paddingVertical:16,alignItems:"center"},emptyStateContainer:{flex:1,justifyContent:"center",alignItems:"center",paddingHorizontal:24},emptyStateTitle:{fontSize:m.theme.fontSizes.large,fontWeight:"600",color:m.theme.colors.text,marginTop:16,textAlign:"center",fontFamily:m.theme.fonts.header.fontFamily},emptyStateSubtitle:{fontSize:16,color:m.theme.colors.placeholder,textAlign:"center",marginTop:8,marginBottom:24,fontFamily:m.theme.fonts.regular.fontFamily},createServiceButton:{backgroundColor:m.theme.colors.primary,paddingHorizontal:24,paddingVertical:12,borderRadius:8,marginTop:8},createServiceButtonText:{color:m.theme.colors.surface,fontSize:16,fontWeight:"600",fontFamily:m.theme.fonts.regular.fontFamily},retryButton:{backgroundColor:m.theme.colors.error,paddingHorizontal:24,paddingVertical:12,borderRadius:8,marginTop:8},retryButtonText:{color:m.theme.colors.surface,fontSize:16,fontWeight:"600",fontFamily:m.theme.fonts.regular.fontFamily},searchInput:{outlineStyle:"none",outlineWidth:0,outline:"none",marginLeft:8}}),wr=()=>{const e=(0,y.useNavigation)(),{isApprovedProfessional:t,userRole:o,is_DEBUG:r,isCollapsed:i,screenWidth:s}=(0,n.useContext)(g.AuthContext),[l,d]=(0,n.useState)(s<900),[c,h]=(0,n.useState)(s>=1200),[w,B]=(0,n.useState)("professional"===o?"professional":"owner"),[k,A]=(0,n.useState)(""),[I,M]=(0,n.useState)([]),[D,R]=(0,n.useState)(!0),[L,z]=(0,n.useState)(null),[P,F]=(0,n.useState)(1),[O,E]=(0,n.useState)(!0),[W,N]=(0,n.useState)(!1),[U,V]=(0,n.useState)("all"),[Y,G]=(0,n.useState)(null),J=rt();(0,n.useEffect)((()=>{const e=j.default.addEventListener("change",(()=>{d(j.default.get("window").width<900),h(j.default.get("window").width>=1200)}));return()=>{e?.remove()}}),[]),(0,n.useEffect)((()=>{"professional"===o&&t&&B("professional")}),[o,t]);const $=async(e=1,n=!1)=>{n?N(!0):(R(!0),z(null));try{let i="web"===a.default.OS?sessionStorage.getItem("userToken"):await p.default.getItem("userToken");if(!i)throw new Error("No authentication token found");r&&console.log("MBA1234 Fetching bookings:",{isApprovedProfessional:t,userRole:o,activeTab:w,page:e,status:U});const s=await b.default.get("".concat(f.API_BASE_URL,"/api/bookings/v1/"),{headers:{Authorization:"Bearer ".concat(i)},params:{page:e,page_size:20,status:U}}),l="professional"===w?s.data.bookings.professional_bookings||[]:s.data.bookings.owner_bookings||[];M(n?e=>[...e,...l]:l),E(20===l.length),F(e)}catch(L){console.error("Error fetching bookings:",L),z("Failed to fetch bookings")}finally{R(!1),N(!1)}};(0,n.useEffect)((()=>{r&&console.log("MBA1234 Fetching bookings due to dependency change:",{activeTab:w,userRole:o,isApprovedProfessional:t,activeFilter:U}),F(1),M([]),$(1)}),[w,o,t,U]);return(0,T.jsx)(x.default,{style:[vr.container,{marginLeft:l?0:i?70:250}],children:(0,T.jsx)(x.default,{style:[vr.content,{marginTop:l?60:0}],children:(0,T.jsxs)(x.default,{style:vr.mainContent,children:[(0,T.jsxs)(x.default,{style:vr.headerSection,children:[(0,T.jsx)(C.default,{style:vr.title,children:"My Bookings"}),t&&(0,T.jsxs)(x.default,{style:vr.tabContainer,children:[(0,T.jsx)(v.default,{style:[vr.tab,"professional"===w&&vr.activeTab],onPress:()=>B("professional"),children:(0,T.jsx)(C.default,{style:[vr.tabText,"professional"===w&&vr.activeTabText],children:"Your Bookings"})}),(0,T.jsx)(v.default,{style:[vr.tab,"owner"===w&&vr.activeTab],onPress:()=>B("owner"),children:(0,T.jsx)(C.default,{style:[vr.tabText,"owner"===w&&vr.activeTabText],children:"Owner Bookings"})})]})]}),(0,T.jsx)(x.default,{style:vr.bookingsContent,children:D?(0,T.jsx)(x.default,{style:vr.loadingContainer,children:(0,T.jsx)(_.default,{size:"large",color:m.theme.colors.primary})}):I.length>0?(0,T.jsxs)(x.default,{style:vr.bookingsContent,children:[(0,T.jsx)(x.default,{style:vr.stickyHeader,children:(0,T.jsxs)(x.default,{style:[vr.stickyHeaderContent,{flexDirection:c?"row":"column"}],children:[(0,T.jsxs)(x.default,{style:[vr.searchContainer,c?{flex:.4,marginRight:"auto"}:null],children:[(0,T.jsx)(S.default,{name:"magnify",size:24,color:m.theme.colors.mybookings.searchBar}),(0,T.jsx)(q.default,{style:[vr.searchInput,{color:m.theme.colors.mybookings.searchBar,width:"100%",height:"100%"}],placeholder:"Search by pet name, owner, or date",value:k,onChangeText:e=>{if(A(e),!e.trim())return F(1),M([]),void $(1);const t=e.toLowerCase(),o=I.filter((e=>"professional"===w?e.id.toLowerCase().includes(t)||e.ownerName.toLowerCase().includes(t):e.id.toLowerCase().includes(t)||e.professionalName.toLowerCase().includes(t)));M(o)},outlineStyle:"none"})]}),(0,T.jsx)(x.default,{style:[vr.filtersWrapper,c?{flex:.6,alignItems:"flex-end"}:null],children:(0,T.jsx)(H.default,{horizontal:!0,showsHorizontalScrollIndicator:!1,contentContainerStyle:vr.filterScrollContent,children:(0,T.jsxs)(x.default,{style:vr.filterContainer,children:[(0,T.jsx)(v.default,{style:[vr.filterButton,vr.allButton,J&&"all"===Y&&vr.filterButtonHovered],onPress:()=>V("all"),onMouseEnter:()=>J&&G("all"),onMouseLeave:()=>J&&G(null),children:(0,T.jsxs)(x.default,{style:vr.filterContent,children:[(0,T.jsx)(S.default,{name:"filter-variant",size:16,color:"#0784C6"}),(0,T.jsx)(C.default,{style:[vr.filterText,vr.allButtonText],children:"All"}),"all"===U&&(0,T.jsx)(S.default,{name:"check",size:16,color:"#0784C6",style:vr.checkmark})]})}),(0,T.jsx)(v.default,{style:[vr.filterButton,vr.pendingButton,J&&"pending"===Y&&vr.filterButtonHovered],onPress:()=>V("pending"),onMouseEnter:()=>J&&G("pending"),onMouseLeave:()=>J&&G(null),children:(0,T.jsxs)(x.default,{style:vr.filterContent,children:[(0,T.jsx)(S.default,{name:"clock-outline",size:16,color:m.theme.colors.mybookings.secondary}),(0,T.jsx)(C.default,{style:[vr.filterText,vr.pendingButtonText],children:"Pending"}),"pending"===U&&(0,T.jsx)(S.default,{name:"check",size:16,color:m.theme.colors.mybookings.secondary,style:vr.checkmark})]})}),(0,T.jsx)(v.default,{style:[vr.filterButton,vr.confirmedButton,J&&"confirmed"===Y&&vr.filterButtonHovered],onPress:()=>V("confirmed"),onMouseEnter:()=>J&&G("confirmed"),onMouseLeave:()=>J&&G(null),children:(0,T.jsxs)(x.default,{style:vr.filterContent,children:[(0,T.jsx)(S.default,{name:"check-circle-outline",size:16,color:"#898974"}),(0,T.jsx)(C.default,{style:[vr.filterText,vr.confirmedButtonText],children:"Confirmed"}),"confirmed"===U&&(0,T.jsx)(S.default,{name:"check",size:16,color:"#898974",style:vr.checkmark})]})}),(0,T.jsx)(v.default,{style:[vr.filterButton,vr.completedButton,J&&"completed"===Y&&vr.filterButtonHovered],onPress:()=>V("completed"),onMouseEnter:()=>J&&G("completed"),onMouseLeave:()=>J&&G(null),children:(0,T.jsxs)(x.default,{style:vr.filterContent,children:[(0,T.jsx)(S.default,{name:"flag-checkered",size:16,color:m.theme.colors.mybookings.completedText}),(0,T.jsx)(C.default,{style:[vr.filterText,vr.completedButtonText],children:"Completed"}),"completed"===U&&(0,T.jsx)(S.default,{name:"check",size:16,color:m.theme.colors.mybookings.completedText,style:vr.checkmark})]})})]})})})]})}),(0,T.jsx)(wt.default,{data:I,renderItem:({item:t})=>(0,T.jsx)(ho,{booking:{id:t.booking_id||t.id,ownerName:t.owner_name||t.ownerName,professionalName:t.professional_name||t.professionalName,serviceName:t.service_type||t.serviceName,date:t.start_date||t.date,time:t.start_time||t.time,status:t.status},type:w,onViewDetails:()=>(async t=>{r&&console.log("MBA1234 Navigating to booking details:",{bookingId:t.booking_id||t.id,isProfessional:"professional"===w}),await(0,u.navigateToFrom)(e,"BookingDetails","MyBookings",{bookingId:t.booking_id||t.id,isProfessional:"professional"===w})})(t),onCancel:()=>(async e=>{r&&console.log("MBA1234 Cancel booking:",e)})(t.booking_id||t.id)}),keyExtractor:e=>(e.booking_id||e.id||Math.random().toString()).toString(),contentContainerStyle:vr.listContainer,onEndReached:()=>{!W&&O&&$(P+1,!0)},onEndReachedThreshold:.5,ListFooterComponent:()=>W?(0,T.jsx)(x.default,{style:vr.loadingMoreContainer,children:(0,T.jsx)(_.default,{size:"small",color:m.theme.colors.primary})}):null,ListHeaderComponent:(0,T.jsx)(x.default,{style:[vr.listHeaderSpacing,{height:c?130:190}]})})]}):(0,T.jsx)((()=>(0,T.jsxs)(x.default,{style:vr.emptyStateContainer,children:[(0,T.jsx)(S.default,{name:L?"alert-circle-outline":"calendar-blank-outline",size:64,color:L?m.theme.colors.error:m.theme.colors.primary}),(0,T.jsx)(C.default,{style:vr.emptyStateTitle,children:L?"Error Getting Bookings":"No Bookings Found"}),(0,T.jsx)(C.default,{style:vr.emptyStateSubtitle,children:L?"There was an error fetching your bookings. Please try again later.":"professional"===w?t?"Create a service to start receiving bookings":"Apply to become a professional to start receiving bookings":"Browse available services to make your first booking"}),!L&&(0,T.jsx)(v.default,{style:vr.createServiceButton,onPress:()=>e.navigate("professional"===w?t?"ServiceManager":"BecomeProfessional":"SearchProfessionalsListing"),children:(0,T.jsx)(C.default,{style:vr.createServiceButtonText,children:"professional"===w?t?"Create Service":"Become Professional":"Browse Services"})}),L&&(0,T.jsx)(v.default,{style:vr.retryButton,onPress:()=>$(1),children:(0,T.jsx)(C.default,{style:vr.retryButtonText,children:"Retry"})})]})),{})})]})})})},jr=r.default.create({container:{flex:1,height:"100vh",backgroundColor:m.theme.colors.surface,position:"fixed",top:0,right:0,bottom:0,left:0,overflow:"hidden",transition:"margin-left 0.3s ease"},content:{flex:1,height:"100%",overflow:"auto"},loadingContainer:{justifyContent:"center",alignItems:"center"}}),Sr=()=>{const e=(0,y.useNavigation)(),[t,o]=(0,n.useState)([]),[r,i]=(0,n.useState)(!1),[s,l]=(0,n.useState)(!0),[d,c]=(0,n.useState)(j.default.get("window").width<900),{isCollapsed:h,is_DEBUG:f,isSignedIn:b,userRole:C}=(0,n.useContext)(g.AuthContext),v=E();(0,n.useEffect)((()=>{const e=j.default.addEventListener("change",(()=>{c(j.default.get("window").width<900)}));return()=>{e?.remove()}}),[]);const w=async()=>{try{l(!0);const e=await(0,Ze.getProfessionalServices)();f&&console.log("MBA7890: Fetched services:",e),o(e)}catch(e){console.error("MBA7890: Error fetching services:",e),v({message:"Failed to load services",type:"error",duration:3e3})}finally{l(!1)}};return(0,n.useEffect)((()=>{b&&C?((0,g.debugLog)("MBA7890","Fetching services for user:",{userRole:C,isSignedIn:b}),w()):(o([]),l(!1))}),[b,C]),(0,n.useEffect)((()=>{r&&(w(),i(!1))}),[r]),(0,y.useFocusEffect)((0,n.useCallback)((()=>{b&&C&&((0,g.debugLog)("MBA7890","Screen focused, fetching services for user:",{userRole:C,isSignedIn:b}),w())}),[b,C])),(0,n.useEffect)((()=>{(async()=>{const e="ServiceManager";let t;"web"===a.default.OS?(t=sessionStorage.getItem("previousRoute"),sessionStorage.setItem("previousRoute",t||""),sessionStorage.setItem("currentRoute",e)):(t=await p.default.getItem("previousRoute"),await p.default.setItem("previousRoute",t||""),await p.default.setItem("currentRoute",e)),t||(t="Dashboard","web"===a.default.OS?(sessionStorage.setItem("previousRoute",t||""),sessionStorage.setItem("currentRoute",e)):(await p.default.setItem("previousRoute",t||""),await p.default.setItem("currentRoute",e)))})()}),[]),s?(0,T.jsx)(x.default,{style:[jr.container,jr.loadingContainer],children:(0,T.jsx)(_.default,{size:"large",color:m.theme.colors.primary})}):(0,T.jsxs)(x.default,{style:[jr.container,{marginLeft:d?0:h?70:250}],children:[d&&(0,T.jsx)(ut,{title:"Service Manager",onBackPress:()=>(0,u.handleBack)(e)}),(0,T.jsx)(x.default,{style:[jr.content,{marginTop:d?20:0}],children:(0,T.jsx)(lt,{services:t||[],setServices:o,setHasUnsavedChanges:i,isProfessionalTab:!1,isMobile:d})})]})};var Tr=o(71225);const Br=r.default.create({container:{flex:1},searchBarContainer:{margin:16},searchBar:{elevation:4,borderRadius:8,backgroundColor:m.theme.colors.surface,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:3.84,flexDirection:"row",alignItems:"center",padding:8},searchInput:{fontSize:16,color:m.theme.colors.text},scrollView:{flex:1},blogCard:{margin:16,padding:16,borderRadius:12,elevation:4,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:3.84},authorContainer:{flexDirection:"row"},authorImage:{width:40,height:40,borderRadius:20,marginRight:12},blogContent:{flex:1},title:{fontSize:20,fontWeight:"bold",marginBottom:8,fontFamily:m.theme.fonts.header.fontFamily},authorInfo:{flexDirection:"row",alignItems:"center",marginBottom:8},authorName:{fontSize:14,fontWeight:"500",fontFamily:m.theme.fonts.regular.fontFamily},dot:{marginHorizontal:4,fontFamily:m.theme.fonts.regular.fontFamily},readTime:{fontSize:14,color:"#666",fontFamily:m.theme.fonts.regular.fontFamily},preview:{fontSize:14,lineHeight:20,marginBottom:12,color:"#444",fontFamily:m.theme.fonts.regular.fontFamily},tags:{flexDirection:"row",flexWrap:"wrap",marginBottom:12},tag:{paddingHorizontal:8,paddingVertical:4,borderRadius:16,marginRight:8,marginBottom:8},tagText:{fontSize:12,fontWeight:"500",fontFamily:m.theme.fonts.regular.fontFamily},stats:{flexDirection:"row",justifyContent:"flex-start",marginTop:8},stat:{flexDirection:"row",alignItems:"center",marginRight:16},statText:{marginLeft:4,color:"#666",fontFamily:m.theme.fonts.regular.fontFamily},noResultsContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:20,marginTop:40},noResultsText:{fontSize:18,fontWeight:"500",marginTop:16,fontFamily:m.theme.fonts.regular.fontFamily},webSearchInput:{flex:1,padding:8,fontSize:16,color:m.theme.colors.text,border:"none",backgroundColor:"transparent",WebkitTapHighlightColor:"transparent",outlineWidth:0,outlineStyle:"none",boxShadow:"none",borderColor:"transparent",fontFamily:m.theme.fonts.regular.fontFamily}}),kr=({navigation:e})=>{const t=(0,G.useTheme)(),[o,r]=(0,n.useState)(""),[i,s]=(0,n.useState)(we),l=(0,n.useCallback)((e=>{r(e);const t=e.toLowerCase(),o=we.filter((e=>e.title.toLowerCase().includes(t)||e.author.name.toLowerCase().includes(t)||e.content.toLowerCase().includes(t)));s(o)}),[]);return(0,T.jsxs)(x.default,{style:[Br.container,{backgroundColor:t.colors.background}],children:[(0,T.jsx)(ut,{title:"Blog",onBackPress:()=>{e.navigate("More")}}),(0,T.jsx)(x.default,{style:Br.searchBarContainer,children:"web"===a.default.OS?(0,T.jsxs)(x.default,{style:[Br.searchBar,{backgroundColor:t.colors.surface}],children:[(0,T.jsx)(S.default,{name:"magnify",size:24,color:t.colors.primary}),(0,T.jsx)(q.default,{placeholder:"Search by title, author, or content",onChangeText:l,value:o,style:Br.webSearchInput}),o?(0,T.jsx)(v.default,{onPress:()=>l(""),children:(0,T.jsx)(S.default,{name:"close-circle",size:24,color:t.colors.primary})}):null]}):(0,T.jsx)(Tr.default,{placeholder:"Search by title, author, or content",onChangeText:l,value:o,style:Br.searchBar,icon:"magnify",clearIcon:"close-circle"})}),(0,T.jsx)(H.default,{style:Br.scrollView,children:i.length>0?i.map((o=>{const n=o.content.slice(0,200)+"...";return(0,T.jsx)(v.default,{style:[Br.blogCard,{backgroundColor:t.colors.surface}],onPress:()=>(0,u.navigateToFrom)(e,"Blog","BlogPost",{post:o}),children:(0,T.jsxs)(x.default,{style:Br.authorContainer,children:[(0,T.jsx)(U.default,{source:{uri:o.author.profilePicture},style:Br.authorImage}),(0,T.jsxs)(x.default,{style:Br.blogContent,children:[(0,T.jsx)(C.default,{style:[Br.title,{color:t.colors.primary}],children:o.title}),(0,T.jsxs)(x.default,{style:Br.authorInfo,children:[(0,T.jsx)(C.default,{style:[Br.authorName,{color:t.colors.secondary}],children:o.author.name}),(0,T.jsx)(C.default,{style:Br.dot,children:" \u2022 "}),(0,T.jsx)(C.default,{style:Br.readTime,children:o.readTime})]}),(0,T.jsx)(C.default,{style:Br.preview,numberOfLines:3,children:n}),(0,T.jsx)(x.default,{style:Br.tags,children:o.tags.map(((e,o)=>(0,T.jsx)(x.default,{style:[Br.tag,{backgroundColor:t.colors.primary+"20"}],children:(0,T.jsx)(C.default,{style:[Br.tagText,{color:t.colors.primary}],children:e})},o)))}),(0,T.jsxs)(x.default,{style:Br.stats,children:[(0,T.jsxs)(x.default,{style:Br.stat,children:[(0,T.jsx)(S.default,{name:"heart-outline",size:20,color:t.colors.secondary}),(0,T.jsx)(C.default,{style:Br.statText,children:o.likes})]}),(0,T.jsxs)(x.default,{style:Br.stat,children:[(0,T.jsx)(S.default,{name:"comment-outline",size:20,color:t.colors.secondary}),(0,T.jsx)(C.default,{style:Br.statText,children:o.comments})]}),(0,T.jsxs)(x.default,{style:Br.stat,children:[(0,T.jsx)(S.default,{name:"share-outline",size:20,color:t.colors.secondary}),(0,T.jsx)(C.default,{style:Br.statText,children:o.shares})]})]})]})]})},o.id)})):(0,T.jsxs)(x.default,{style:Br.noResultsContainer,children:[(0,T.jsx)(S.default,{name:"magnify-close",size:48,color:t.colors.secondary}),(0,T.jsx)(C.default,{style:[Br.noResultsText,{color:t.colors.secondary}],children:"No blog posts found"})]})})]})},Ar=r.default.create({mainContainer:{flex:1},container:{flex:1},header:{padding:16},authorContainer:{flexDirection:"row",marginBottom:16},authorImage:{width:50,height:50,borderRadius:25,marginRight:12},authorInfo:{flex:1},authorName:{fontSize:16,fontWeight:"600",marginBottom:4,fontFamily:m.theme.fonts.header.fontFamily},authorBio:{fontSize:14,color:"#666",marginBottom:4,fontFamily:m.theme.fonts.regular.fontFamily},postInfo:{flexDirection:"row",alignItems:"center"},date:{fontSize:14,color:"#666",fontFamily:m.theme.fonts.regular.fontFamily},dot:{marginHorizontal:4,color:"#666",fontFamily:m.theme.fonts.regular.fontFamily},readTime:{fontSize:14,color:"#666",fontFamily:m.theme.fonts.regular.fontFamily},tags:{flexDirection:"row",flexWrap:"wrap",padding:16,paddingTop:0},tag:{paddingHorizontal:12,paddingVertical:6,borderRadius:16,marginRight:8,marginBottom:8},tagText:{fontSize:14,fontWeight:"500",fontFamily:m.theme.fonts.regular.fontFamily},content:{fontSize:16,lineHeight:24,padding:16,fontFamily:m.theme.fonts.regular.fontFamily},stats:{flexDirection:"row",justifyContent:"space-around",padding:16,borderTopWidth:1,borderBottomWidth:1,borderColor:"#eee"},stat:{flexDirection:"row",alignItems:"center"},statText:{marginLeft:8,fontSize:16,color:"#666",fontFamily:m.theme.fonts.regular.fontFamily},references:{padding:16},referencesTitle:{fontSize:20,fontWeight:"bold",marginBottom:12,fontFamily:m.theme.fonts.header.fontFamily},reference:{marginBottom:12},referenceText:{fontSize:14,color:"#444",lineHeight:20,fontFamily:m.theme.fonts.regular.fontFamily},errorContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:20},errorText:{fontSize:18,fontWeight:"500",marginTop:16,marginBottom:24,fontFamily:m.theme.fonts.regular.fontFamily},errorButton:{paddingHorizontal:20,paddingVertical:10,borderRadius:8},errorButtonText:{fontSize:16,fontWeight:"500",fontFamily:m.theme.fonts.regular.fontFamily}}),_r=({route:e,navigation:t})=>{const[o,r]=(0,n.useState)(null),i=(0,G.useTheme)(),s=e=>e&&"object"===typeof e&&e.author&&"object"===typeof e.author&&e.author.name&&e.author.profilePicture&&e.author.bio&&e.title&&e.content&&Array.isArray(e.tags);if((0,n.useEffect)((()=>{(async()=>{try{if(e?.params?.post&&s(e.params.post))return r(e.params.post),void("web"===a.default.OS?sessionStorage.setItem("currentBlogPost",JSON.stringify(e.params.post)):await p.default.setItem("currentBlogPost",JSON.stringify(e.params.post)));let o;if(o="web"===a.default.OS?sessionStorage.getItem("currentBlogPost"):await p.default.getItem("currentBlogPost"),o){const e=JSON.parse(o);if(s(e))return void r(e)}if(e?.params?.postId){const t=we.find((t=>t.id===e.params.postId));if(t&&s(t))return void r(t)}(0,u.navigateToFrom)(t,"Blog","BlogPost")}catch(o){console.error("Error loading blog post:",o),(0,u.navigateToFrom)(t,"Blog","BlogPost")}})()}),[e?.params]),!o||!s(o))return(0,T.jsxs)(x.default,{style:[Ar.mainContainer,{backgroundColor:i.colors.background}],children:[(0,T.jsx)(ut,{title:"Blog Post",onBackPress:()=>(0,u.handleBack)(t)}),(0,T.jsxs)(x.default,{style:Ar.errorContainer,children:[(0,T.jsx)(S.default,{name:"alert-circle-outline",size:48,color:i.colors.error}),(0,T.jsx)(C.default,{style:[Ar.errorText,{color:i.colors.error}],children:"Blog post not found or invalid"}),(0,T.jsx)(v.default,{style:[Ar.errorButton,{backgroundColor:i.colors.primary}],onPress:()=>(0,u.navigateToFrom)(t,"Blog","BlogPost"),children:(0,T.jsx)(C.default,{style:[Ar.errorButtonText,{color:i.colors.surface}],children:"Go to Blog List"})})]})]});return(0,T.jsxs)(x.default,{style:[Ar.mainContainer,{backgroundColor:i.colors.background}],children:[(0,T.jsx)(ut,{title:o.title,onBackPress:()=>(0,u.handleBack)(t)}),(0,T.jsxs)(H.default,{style:Ar.container,children:[(0,T.jsx)(x.default,{style:Ar.header,children:(0,T.jsxs)(x.default,{style:Ar.authorContainer,children:[(0,T.jsx)(U.default,{source:{uri:o.author.profilePicture},style:Ar.authorImage}),(0,T.jsxs)(x.default,{style:Ar.authorInfo,children:[(0,T.jsx)(C.default,{style:[Ar.authorName,{color:i.colors.secondary}],children:o.author.name}),(0,T.jsx)(C.default,{style:Ar.authorBio,children:o.author.bio}),(0,T.jsxs)(x.default,{style:Ar.postInfo,children:[(0,T.jsx)(C.default,{style:Ar.date,children:o.publishDate}),(0,T.jsx)(C.default,{style:Ar.dot,children:" \u2022 "}),(0,T.jsx)(C.default,{style:Ar.readTime,children:o.readTime})]})]})]})}),(0,T.jsx)(x.default,{style:Ar.tags,children:o.tags.map(((e,t)=>(0,T.jsx)(x.default,{style:[Ar.tag,{backgroundColor:i.colors.primary+"20"}],children:(0,T.jsx)(C.default,{style:[Ar.tagText,{color:i.colors.primary}],children:e})},t)))}),(0,T.jsx)(C.default,{style:[Ar.content,{color:i.colors.text}],children:o.content}),(0,T.jsxs)(x.default,{style:Ar.stats,children:[(0,T.jsxs)(v.default,{style:Ar.stat,children:[(0,T.jsx)(S.default,{name:"heart-outline",size:24,color:i.colors.secondary}),(0,T.jsx)(C.default,{style:Ar.statText,children:o.likes})]}),(0,T.jsxs)(v.default,{style:Ar.stat,children:[(0,T.jsx)(S.default,{name:"comment-outline",size:24,color:i.colors.secondary}),(0,T.jsx)(C.default,{style:Ar.statText,children:o.comments})]}),(0,T.jsxs)(v.default,{style:Ar.stat,children:[(0,T.jsx)(S.default,{name:"share-outline",size:24,color:i.colors.secondary}),(0,T.jsx)(C.default,{style:Ar.statText,children:o.shares})]})]}),(0,T.jsxs)(x.default,{style:Ar.references,children:[(0,T.jsx)(C.default,{style:[Ar.referencesTitle,{color:i.colors.primary}],children:"References"}),o.references.map(((e,t)=>(0,T.jsx)(v.default,{style:Ar.reference,onPress:()=>(e=>{e.url?V.default.openURL(e.url):e.doi&&V.default.openURL("https://doi.org/".concat(e.doi))})(e),children:(0,T.jsxs)(C.default,{style:Ar.referenceText,children:[e.authors," (",e.year||"n.d.","). ",e.title,". ",e.publication,".",e.doi&&" DOI: ".concat(e.doi)]})},t)))]})]})]})};var Ir=o(67146);const Mr=({children:e})=>"web"===a.default.OS?(0,T.jsx)(x.default,{style:{width:"100%",maxWidth:550,marginLeft:"auto",marginRight:"auto",paddingHorizontal:15},children:e}):(0,T.jsx)(T.Fragment,{children:e}),Dr=({visible:e,message:t,onClose:o})=>(0,T.jsx)(A.default,{visible:e,transparent:!0,animationType:"fade",onRequestClose:o,children:(0,T.jsx)(x.default,{style:Lr.modalOverlay,children:(0,T.jsxs)(x.default,{style:Lr.modalContent,children:[(0,T.jsx)(C.default,{style:Lr.modalText,children:t}),(0,T.jsx)(v.default,{style:Lr.modalButton,onPress:o,children:(0,T.jsx)(C.default,{style:Lr.modalButtonText,children:"OK"})})]})})}),Rr=({selectedCity:e,onSelectCity:t})=>{const[o,a]=(0,n.useState)(!1),[r,i]=(0,n.useState)(""),s=[{id:"1",name:"Colorado Springs"},{id:"2",name:"Denver"},{id:"3",name:"Boulder"},{id:"4",name:"Fort Collins"},{id:"5",name:"Pueblo"},{id:"6",name:"Aurora"},{id:"7",name:"Littleton"},{id:"8",name:"Castle Rock"},{id:"9",name:"Parker"},{id:"10",name:"Centennial"},{id:"11",name:"Other"}].filter((e=>e.name.toLowerCase().includes(r.toLowerCase()))),l=s.some((e=>"Other"===e.name))?s:[...s,{id:"11",name:"Other"}];return(0,T.jsxs)(x.default,{style:Lr.dropdownContainer,children:[(0,T.jsxs)(v.default,{style:[Lr.dropdownButton,!e&&Lr.requiredField],onPress:()=>a(!o),children:[(0,T.jsx)(C.default,{style:Lr.dropdownButtonText,children:e||"Select your city"}),(0,T.jsx)(S.default,{name:o?"chevron-up":"chevron-down",size:24,color:m.theme.colors.primary})]}),o&&(0,T.jsxs)(x.default,{style:Lr.dropdownList,children:[(0,T.jsx)(q.default,{style:Lr.searchInput,placeholder:"Search cities...",value:r,onChangeText:i}),(0,T.jsx)(wt.default,{data:l,renderItem:({item:e})=>(0,T.jsx)(v.default,{style:[Lr.cityItem,"Other"===e.name&&Lr.otherCityItem],onPress:()=>{t(e.name),a(!1)},children:(0,T.jsx)(C.default,{style:[Lr.cityItemText,"Other"===e.name&&Lr.otherCityText],children:e.name})}),keyExtractor:e=>e.id,style:Lr.cityList})]})]})},Lr=r.default.create({scrollView:{flex:1,width:"100%"},scrollViewContent:{flexGrow:1,alignItems:"center",justifyContent:"center",width:"100%"},container:{width:"100%",alignItems:"center",justifyContent:"center",paddingVertical:20},contentWrapper:{padding:20,backgroundColor:"white",borderRadius:10,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3,width:"100%"},title:{fontSize:m.theme.fontSizes.largeLarge,fontWeight:"bold",marginBottom:10,color:m.theme.colors.primary,fontFamily:m.theme.fonts.header.fontFamily,textAlign:"center"},description:{fontSize:m.theme.fontSizes.medium,marginBottom:20,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,textAlign:"center",lineHeight:24},formSection:{width:"100%"},nameContainer:{flexDirection:"row",gap:10,marginBottom:15},nameField:{flex:1},label:{fontSize:m.theme.fontSizes.medium,marginBottom:5,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"500"},input:{backgroundColor:m.theme.colors.surface,borderRadius:5,borderColor:m.theme.colors.border,borderWidth:1,padding:15,marginBottom:15,fontSize:m.theme.fontSizes.medium,width:"100%",fontFamily:m.theme.fonts.regular.fontFamily},textArea:{height:100,textAlignVertical:"top"},checkboxGroup:{marginBottom:15},checkboxContainer:{flexDirection:"row",alignItems:"flex-start",marginBottom:10,paddingRight:10},checkboxIcon:{marginRight:10},checkboxLabel:{flex:1,fontSize:m.theme.fontSizes.medium,fontFamily:m.theme.fonts.regular.fontFamily},radioGroup:{marginBottom:15},radioContainer:{flexDirection:"row",alignItems:"center",marginBottom:10},radio:{width:20,height:20,borderRadius:10,borderWidth:2,borderColor:m.theme.colors.primary,marginRight:10},radioSelected:{backgroundColor:m.theme.colors.primary},radioLabel:{fontSize:m.theme.fontSizes.medium,fontFamily:m.theme.fonts.regular.fontFamily},submitButton:{backgroundColor:m.theme.colors.primary,padding:15,borderRadius:5,alignItems:"center",width:"100%",marginTop:20},submitButtonText:{color:m.theme.colors.whiteText,fontSize:m.theme.fontSizes.mediumLarge,fontWeight:"bold",fontFamily:m.theme.fonts.regular.fontFamily},disabledButton:{opacity:.7},successMessage:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,textAlign:"center",marginBottom:15,lineHeight:24},otherInputContainer:{paddingLeft:34,width:"100%"},otherInput:{marginTop:5,marginBottom:10,width:"90%"},addressSection:{marginBottom:20},cityStateContainer:{flexDirection:"row",justifyContent:"space-between",gap:10},cityInput:{flex:2,marginBottom:0},stateInput:{flex:1,marginBottom:0},zipInput:{flex:1,marginBottom:0},addressNote:{fontSize:m.theme.fontSizes.small,color:m.theme.colors.text,marginBottom:10,paddingHorizontal:5},optional:{color:m.theme.colors.secondary,fontSize:m.theme.fontSizes.small,fontStyle:"italic"},referralSection:{backgroundColor:m.theme.colors.surface,padding:20,borderRadius:10,marginVertical:20,borderWidth:1,borderColor:m.theme.colors.border},buttonContainer:{flexDirection:"row",justifyContent:"flex-start",gap:10,marginBottom:20},button:{paddingVertical:8,paddingHorizontal:24,borderRadius:5,borderWidth:1,borderColor:m.theme.colors.primary,backgroundColor:"white",minWidth:80,alignItems:"center"},buttonSelected:{backgroundColor:m.theme.colors.primary},buttonText:{color:m.theme.colors.primary,fontSize:m.theme.fontSizes.medium,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"500"},buttonTextSelected:{color:"white"},requiredFieldNote:{fontSize:m.theme.fontSizes.small,color:m.theme.colors.text,marginBottom:20,fontStyle:"italic"},requiredAsterisk:{color:"#FF0000",fontSize:m.theme.fontSizes.medium},linkContainer:{flexDirection:"row",alignItems:"center",justifyContent:"center",backgroundColor:m.theme.colors.surface,padding:10,borderRadius:5,marginVertical:10},link:{color:m.theme.colors.primary,fontSize:m.theme.fontSizes.medium,fontFamily:m.theme.fonts.regular.fontFamily,marginRight:10},copyButton:{padding:5},modalOverlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center"},modalContent:{backgroundColor:m.theme.colors.surface,borderRadius:8,padding:20,width:"90%",maxWidth:400,alignItems:"center"},modalText:{fontSize:m.theme.fontSizes.medium,marginBottom:20,textAlign:"center",color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},modalButton:{backgroundColor:m.theme.colors.primary,paddingVertical:12,paddingHorizontal:24,borderRadius:8,minWidth:100,alignItems:"center"},modalButtonText:{color:m.theme.colors.surface,fontSize:m.theme.fontSizes.medium,fontWeight:"500",fontFamily:m.theme.fonts.regular.fontFamily},inputError:{borderColor:"#FF0000",borderWidth:1},errorText:{color:"#FF0000",fontSize:m.theme.fontSizes.small,marginTop:-10,marginBottom:15,fontFamily:m.theme.fonts.regular.fontFamily},dropdownContainer:{marginBottom:15,zIndex:1e3},dropdownButton:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",backgroundColor:m.theme.colors.surface,borderRadius:5,borderColor:m.theme.colors.border,borderWidth:1,padding:15},dropdownButtonText:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},dropdownList:{position:"absolute",top:"100%",left:0,right:0,backgroundColor:"white",borderRadius:5,borderColor:m.theme.colors.border,borderWidth:1,marginTop:5,maxHeight:300,zIndex:1e3},searchInput:{padding:10,borderBottomWidth:1,borderBottomColor:m.theme.colors.border,fontSize:m.theme.fontSizes.medium,fontFamily:m.theme.fonts.regular.fontFamily},cityList:{maxHeight:250},cityItem:{padding:15,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},cityItemText:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},requiredField:{borderColor:"#FF0000",borderWidth:1},otherCityItem:{borderTopWidth:1,borderTopColor:m.theme.colors.border,backgroundColor:m.theme.colors.surface},otherCityText:{color:m.theme.colors.primary,fontWeight:"500"}}),zr=()=>{const e=(0,y.useNavigation)(),{is_prototype:t,screenWidth:o}=(0,n.useContext)(g.AuthContext),[a,r]=(0,Q.useForm)("mkgobpro"),[i,s]=(0,n.useState)(""),[l,d]=(0,n.useState)(""),[c,u]=(0,n.useState)(""),[h,f]=(0,n.useState)(""),[p,b]=(0,n.useState)(""),[w,j]=(0,n.useState)([]),[B,k]=(0,n.useState)(""),[A,_]=(0,n.useState)(""),[I,M]=(0,n.useState)(""),[D,R]=(0,n.useState)(!1),[L,z]=(0,n.useState)(!1),[P,F]=(0,n.useState)(!1),[O,E]=(0,n.useState)(""),[W,N]=(0,n.useState)(!1),[U,V]=(0,n.useState)(""),[Y,G]=(0,n.useState)(""),[J,$]=(0,n.useState)(""),[Z,K]=(0,n.useState)(""),[X,ee]=(0,n.useState)(""),[te,oe]=(0,n.useState)(""),[ne,ae]=(0,n.useState)(""),[re,ie]=(0,n.useState)({visible:!1,message:""}),[se,le]=(0,n.useState)(""),[de,ce]=(0,n.useState)(""),[ue,me]=(0,n.useState)(""),[ge,he]=(0,n.useState)(""),[fe,pe]=(0,n.useState)(""),ye="100%",be=()=>{e.navigate("SignUp")},xe=async()=>{try{await Ir.default.setString("https://crittrcove.com/waitlist"),alert("Link copied to clipboard!")}catch(e){console.error("Failed to copy link:",e)}};return a.succeeded?(0,T.jsxs)(ht,{fullWidthHeader:!0,contentWidth:ye,children:[(0,T.jsx)(ut,{title:"Join Waitlist",onBackPress:be}),(0,T.jsx)(H.default,{style:Lr.scrollView,contentContainerStyle:Lr.scrollViewContent,children:(0,T.jsx)(Mr,{children:(0,T.jsx)(x.default,{style:Lr.container,children:(0,T.jsxs)(x.default,{style:Lr.contentWrapper,children:[(0,T.jsx)(C.default,{style:[Lr.title,{color:m.theme.colors.primary}],children:"Thank you for joining the CrittrCove waitlist!"}),(0,T.jsx)(C.default,{style:Lr.successMessage,children:"As a waitlist member, you'll enjoy exclusive early access to the app, priority placement, special gifts, and a unique profile badge to highlight your role as a founding member of CrittrCove."}),(0,T.jsxs)(x.default,{style:Lr.referralSection,children:[(0,T.jsx)(C.default,{style:[Lr.title,{fontSize:m.theme.fontSizes.large,marginTop:20}],children:"Want Another Custom Pet Sticker? \ud83c\udf81"}),(0,T.jsx)(C.default,{style:Lr.successMessage,children:"Share CrittrCove with your pet-loving friends! When they join the waitlist using this link:"}),(0,T.jsxs)(x.default,{style:Lr.linkContainer,children:[(0,T.jsx)(C.default,{style:Lr.link,children:"https://crittrcove.com/waitlist"}),(0,T.jsx)(v.default,{onPress:xe,style:Lr.copyButton,children:(0,T.jsx)(S.default,{name:"content-copy",size:20,color:m.theme.colors.primary})})]}),(0,T.jsx)(C.default,{style:Lr.successMessage,children:"and mention your name, we'll send you another custom sticker featuring your pet. It's our way of saying thank you for helping grow our community!"}),(0,T.jsx)(C.default,{style:[Lr.successMessage,{fontStyle:"italic"}],children:"Simply tell your friends to mention your name when they sign up, and we'll take care of the rest."})]}),(0,T.jsx)(C.default,{style:Lr.successMessage,children:"Stay tuned for exciting updates!"})]})})})})]}):(0,T.jsxs)(ht,{fullWidthHeader:!0,contentWidth:ye,children:[(0,T.jsx)(ut,{title:"Join Waitlist",onBackPress:be}),(0,T.jsx)(H.default,{style:Lr.scrollView,contentContainerStyle:Lr.scrollViewContent,children:(0,T.jsx)(Mr,{children:(0,T.jsx)(x.default,{style:Lr.container,children:(0,T.jsxs)(x.default,{style:Lr.contentWrapper,children:[(0,T.jsx)(C.default,{style:Lr.title,children:"Join the CrittrCove Waitlist!"}),(0,T.jsx)(C.default,{style:Lr.description,children:"Welcome to Critter Cove's early sign-up, the ultimate pet care marketplace for all pets\u2014whether furry, feathery, or scaly! Our app connects local pet care specialists with pet owners, offering reliable and loving care for your beloved companions."}),(0,T.jsx)(C.default,{style:Lr.description,children:"By joining our waitlist, you'll gain early access to exclusive features, special gifts, education, discounts, a custom sticker featuring your pet (if you so wish), and a profile badge as a founding member of the Critter Cove community."}),(0,T.jsxs)(C.default,{style:Lr.requiredFieldNote,children:[(0,T.jsx)(C.default,{style:Lr.requiredAsterisk,children:"*"})," indicates required field"]}),(0,T.jsxs)(x.default,{style:Lr.formSection,children:[(0,T.jsxs)(x.default,{style:Lr.nameContainer,children:[(0,T.jsxs)(x.default,{style:Lr.nameField,children:[(0,T.jsxs)(C.default,{style:Lr.label,children:["First Name ",(0,T.jsx)(C.default,{style:Lr.requiredAsterisk,children:"*"})]}),(0,T.jsx)(q.default,{style:Lr.input,value:i,onChangeText:s,placeholder:"First Name"})]}),(0,T.jsxs)(x.default,{style:Lr.nameField,children:[(0,T.jsxs)(C.default,{style:Lr.label,children:["Last Name ",(0,T.jsx)(C.default,{style:Lr.requiredAsterisk,children:"*"})]}),(0,T.jsx)(q.default,{style:Lr.input,value:l,onChangeText:d,placeholder:"Last Name"})]})]}),(0,T.jsxs)(C.default,{style:Lr.label,children:["Email ",(0,T.jsx)(C.default,{style:Lr.requiredAsterisk,children:"*"})]}),(0,T.jsx)(q.default,{style:[Lr.input,se?Lr.inputError:null],value:c,onChangeText:e=>{u(e),le("")},placeholder:"Email",keyboardType:"email-address",autoCapitalize:"none"}),se?(0,T.jsx)(C.default,{style:Lr.errorText,children:se}):null,(0,T.jsxs)(C.default,{style:Lr.label,children:["Phone Number ",(0,T.jsx)(C.default,{style:Lr.requiredAsterisk,children:"*"})]}),(0,T.jsx)(q.default,{style:[Lr.input,de?Lr.inputError:null],value:h,onChangeText:e=>{const t=(e=>{const t=e.replace(/\D/g,""),o=t.match(/^(\d{0,3})(\d{0,3})(\d{0,4})$/);if(o){const[,e,t,n]=o;let a="";return e&&(a+="(".concat(e)),t&&(a+=") ".concat(t)),n&&(a+="-".concat(n)),a}return t})(e);f(t),ce("")},placeholder:"(XXX) XXX-XXXX",keyboardType:"numeric",maxLength:14}),de?(0,T.jsx)(C.default,{style:Lr.errorText,children:de}):null,(0,T.jsxs)(C.default,{style:Lr.label,children:["Do you currently own pets? If yes, tell us all about them! ",(0,T.jsx)(C.default,{style:Lr.requiredAsterisk,children:"*"})]}),(0,T.jsx)(q.default,{style:[Lr.input,Lr.textArea],value:p,onChangeText:b,placeholder:"Tell us about your pets",multiline:!0,numberOfLines:4}),(0,T.jsxs)(C.default,{style:Lr.label,children:["What kind of pet care services are you most interested in? ",(0,T.jsx)(C.default,{style:Lr.requiredAsterisk,children:"*"})]}),(0,T.jsx)(x.default,{style:Lr.checkboxGroup,children:["Pet Sitting","Grooming","Training","Veterinary Services","Farm/Homestead Care","Care Consulting","Other"].map((e=>(0,T.jsxs)(x.default,{children:[(0,T.jsxs)(v.default,{style:Lr.checkboxContainer,onPress:()=>(e=>{j((t=>("Other"===e&&N(!t.includes("Other")),t.includes(e)?t.filter((t=>t!==e)):[...t,e])))})(e),children:[(0,T.jsx)(S.default,{name:w.includes(e)?"checkbox-marked":"checkbox-blank-outline",size:24,color:m.theme.colors.primary,style:Lr.checkboxIcon}),(0,T.jsx)(C.default,{style:Lr.checkboxLabel,children:e})]}),"Other"===e&&w.includes("Other")&&(0,T.jsxs)(x.default,{style:Lr.otherInputContainer,children:[(0,T.jsxs)(C.default,{style:Lr.label,children:["Please specify other service ",(0,T.jsx)(C.default,{style:Lr.requiredAsterisk,children:"*"})]}),(0,T.jsx)(q.default,{style:[Lr.input,Lr.otherInput],value:O,onChangeText:E,placeholder:"Enter other service"})]})]},e)))}),(0,T.jsxs)(C.default,{style:Lr.label,children:["Are you signing up as a: ",(0,T.jsx)(C.default,{style:Lr.requiredAsterisk,children:"*"})]}),(0,T.jsx)(x.default,{style:Lr.radioGroup,children:["Pet owner in need of services","Care specialist (sitter, groomer, ferrier, fish tank cleaner, etc)","Both"].map((e=>(0,T.jsxs)(v.default,{style:Lr.radioContainer,onPress:()=>k(e),children:[(0,T.jsx)(x.default,{style:[Lr.radio,B===e&&Lr.radioSelected]}),(0,T.jsx)(C.default,{style:Lr.radioLabel,children:e})]},e)))}),(0,T.jsxs)(C.default,{style:Lr.label,children:["Where did you hear about us? ",(0,T.jsx)(C.default,{style:Lr.requiredAsterisk,children:"*"})]}),(0,T.jsx)(x.default,{style:Lr.radioGroup,children:["Nextdoor","Reddit","Google","Other - Enter name of Person who referred you or other referral source for a free sticker"].map((e=>(0,T.jsxs)(v.default,{style:Lr.radioContainer,onPress:()=>oe(e),children:[(0,T.jsx)(x.default,{style:[Lr.radio,te===e&&Lr.radioSelected]}),(0,T.jsx)(C.default,{style:Lr.radioLabel,children:e})]},e)))}),"Other - Enter name of Person who referred you or other referral source for a free sticker"===te&&(0,T.jsxs)(x.default,{children:[(0,T.jsxs)(C.default,{style:Lr.label,children:["Please specify where you heard about us ",(0,T.jsx)(C.default,{style:Lr.requiredAsterisk,children:"*"})]}),(0,T.jsx)(q.default,{style:Lr.input,value:ne,onChangeText:ae,placeholder:"Enter referral source"})]}),(0,T.jsxs)(C.default,{style:Lr.label,children:["Which city are you located in? ",(0,T.jsx)(C.default,{style:Lr.requiredAsterisk,children:"*"})]}),(0,T.jsx)(Rr,{selectedCity:ue,onSelectCity:e=>{me(e),pe("")}}),"Other"===ue&&(0,T.jsxs)(x.default,{style:Lr.otherInputContainer,children:[(0,T.jsxs)(C.default,{style:Lr.label,children:["Please specify your city ",(0,T.jsx)(C.default,{style:Lr.requiredAsterisk,children:"*"})]}),(0,T.jsx)(q.default,{style:[Lr.input,fe&&Lr.inputError],value:ge,onChangeText:e=>{he(e),pe("")},placeholder:"Enter your city"})]}),fe?(0,T.jsx)(C.default,{style:Lr.errorText,children:fe}):null,(0,T.jsxs)(C.default,{style:Lr.label,children:["What hesitations do you have about using an app to connect you to local pet care? ",(0,T.jsx)(C.default,{style:Lr.optional,children:"(Optional)"})]}),(0,T.jsx)(q.default,{style:[Lr.input,Lr.textArea],value:A,onChangeText:_,placeholder:"Share your concerns",multiline:!0,numberOfLines:4}),(0,T.jsxs)(C.default,{style:Lr.label,children:["What features or tools would make Critter Cove perfect for you? ",(0,T.jsx)(C.default,{style:Lr.optional,children:"(Optional)"})]}),(0,T.jsx)(q.default,{style:[Lr.input,Lr.textArea],value:I,onChangeText:M,placeholder:"Share your ideas",multiline:!0,numberOfLines:4}),(0,T.jsxs)(x.default,{style:Lr.addressSection,children:[(0,T.jsxs)(C.default,{style:Lr.label,children:["Mailing Address ",(0,T.jsx)(C.default,{style:Lr.optional,children:"(Optional)"})]}),(0,T.jsxs)(C.default,{style:Lr.addressNote,children:["\ud83c\udf81 ",(0,T.jsx)(C.default,{style:{fontStyle:"italic"},children:" Want a custom sticker featuring your pet? Add your mailing address and we'll send you one for joining the waitlist!"})]}),(0,T.jsx)(q.default,{style:Lr.input,value:U,onChangeText:V,placeholder:"Street Address"}),(0,T.jsx)(q.default,{style:Lr.input,value:Y,onChangeText:G,placeholder:"Apartment/Unit # (if applicable)"}),(0,T.jsxs)(x.default,{style:Lr.cityStateContainer,children:[(0,T.jsx)(q.default,{style:[Lr.input,Lr.cityInput],value:J,onChangeText:$,placeholder:"City"}),(0,T.jsx)(q.default,{style:[Lr.input,Lr.stateInput],value:Z,onChangeText:K,placeholder:"State",maxLength:2,autoCapitalize:"characters"}),(0,T.jsx)(q.default,{style:[Lr.input,Lr.zipInput],value:X,onChangeText:ee,placeholder:"ZIP",keyboardType:"numeric",maxLength:5})]})]}),(0,T.jsxs)(C.default,{style:Lr.label,children:["Would you like to be added to the email newsletter for updates on the app, pet care tips, discounts and more? ",(0,T.jsx)(C.default,{style:Lr.optional,children:"(Optional)"})]}),(0,T.jsxs)(x.default,{style:Lr.buttonContainer,children:[(0,T.jsx)(v.default,{style:[Lr.button,D&&Lr.buttonSelected],onPress:()=>R(!0),children:(0,T.jsx)(C.default,{style:[Lr.buttonText,D&&Lr.buttonTextSelected],children:"Yes"})}),(0,T.jsx)(v.default,{style:[Lr.button,!D&&Lr.buttonSelected],onPress:()=>R(!1),children:(0,T.jsx)(C.default,{style:[Lr.buttonText,!D&&Lr.buttonTextSelected],children:"No"})})]}),(0,T.jsxs)(C.default,{style:Lr.label,children:["I agree to the terms and conditions and understand my data will be used to improve the app experience. ",(0,T.jsx)(C.default,{style:Lr.requiredAsterisk,children:"*"})]}),(0,T.jsxs)(x.default,{style:Lr.buttonContainer,children:[(0,T.jsx)(v.default,{style:[Lr.button,L&&Lr.buttonSelected],onPress:()=>z(!0),children:(0,T.jsx)(C.default,{style:[Lr.buttonText,L&&Lr.buttonTextSelected],children:"Yes"})}),(0,T.jsx)(v.default,{style:[Lr.button,!L&&Lr.buttonSelected],onPress:()=>z(!1),children:(0,T.jsx)(C.default,{style:[Lr.buttonText,!L&&Lr.buttonTextSelected],children:"No"})})]}),(0,T.jsx)(v.default,{style:[Lr.submitButton,(P||!L)&&Lr.disabledButton],onPress:async e=>{if(e.preventDefault(),le(""),ce(""),pe(""),!(e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e))(c))return le("Please enter a valid email address"),void ie({visible:!0,message:"Please enter a valid email address"});if(!h)return ce("Please enter a valid phone number"),void ie({visible:!0,message:"Please enter a valid phone number"});if(!ue)return pe("Please select your city"),void ie({visible:!0,message:"Please select your city"});if("Other"===ue&&!ge.trim())return pe("Please specify your city"),void ie({visible:!0,message:"Please specify your city"});if(c&&i&&l&&h&&p&&0!==w.length&&B&&L&&te)if(!w.includes("Other")||O.trim())if("Other - Enter name of Person who referred you or other referral source for a free sticker"!==te||ne.trim()){F(!0);try{const e={firstName:i,lastName:l,email:c,phone:h,petInfo:p,services:w.includes("Other")?[...w.filter((e=>"Other"!==e)),"Other - ".concat(O.trim())].join(", "):w.join(", "),userType:B,hesitations:A,desiredFeatures:I,newsletter:D?"Yes":"No",agreeToTerms:L?"Yes":"No",referralSource:"Other - Enter name of Person who referred you or other referral source for a free sticker"===te?"Other - ".concat(ne.trim()):te,streetAddress:U||"",aptUnit:Y||"",city:"Other"===ue?"Other - ".concat(ge.trim()):ue,stateRegion:Z||"",zipCode:X||""};console.log("MBA9876: Submitting form data:",e);const t=await r(e);console.log("MBA9876: Formspree response:",t),a.succeeded&&(s(""),d(""),u(""),f(""),b(""),j([]),E(""),N(!1),k(""),_(""),M(""),R(!1),z(!1),V(""),G(""),$(""),K(""),ee(""),oe(""),ae(""))}catch(t){console.error("MBA9876: Error submitting form:",t),console.error("MBA9876: Error response:",t.response?.data),ie({visible:!0,message:t.response?.data?.error||"An error occurred while submitting the form. Please try again."})}finally{F(!1)}}else ie({visible:!0,message:"Please specify where you heard about us"});else ie({visible:!0,message:"Please specify the other service you are interested in"});else ie({visible:!0,message:"Please fill in all required fields"})},disabled:P||!L,children:(0,T.jsx)(C.default,{style:Lr.submitButtonText,children:P?"Submitting...":"Join Waitlist"})})]})]})})})}),(0,T.jsx)(Dr,{visible:re.visible,message:re.message,onClose:()=>ie({visible:!1,message:""})})]})};var Pr=o(58180);const Fr=r.default.create({container:{flex:1,justifyContent:"center",alignItems:"center",padding:20,backgroundColor:m.theme.colors.background},title:{fontSize:24,fontWeight:"bold",marginBottom:30,color:m.theme.colors.text,fontFamily:m.theme.fonts?.medium?.fontFamily||void 0},buttonContainer:{width:"100%",marginVertical:10,maxWidth:300}}),Or=()=>{const e=E();return(0,T.jsxs)(x.default,{style:Fr.container,children:[(0,T.jsx)(C.default,{style:Fr.title,children:"Toast Notification Test"}),(0,T.jsx)(x.default,{style:Fr.buttonContainer,children:(0,T.jsx)(Pr.default,{title:"Show Success Toast",onPress:()=>{e({message:"Success! Operation completed successfully.",type:"success",duration:3e3})},color:m.theme.colors.primary})}),(0,T.jsx)(x.default,{style:Fr.buttonContainer,children:(0,T.jsx)(Pr.default,{title:"Show Error Toast",onPress:()=>{e({message:"Error! Something went wrong.",type:"error",duration:3e3})},color:m.theme.colors.error})}),(0,T.jsx)(x.default,{style:Fr.buttonContainer,children:(0,T.jsx)(Pr.default,{title:"Show Info Toast",onPress:()=>{e({message:"Info: This is an informational message.",type:"info",duration:3e3})},color:m.theme.colors.info||"#29B6F6"})}),(0,T.jsx)(x.default,{style:Fr.buttonContainer,children:(0,T.jsx)(Pr.default,{title:"Show Warning Toast",onPress:()=>{e({message:"Warning: This action may have consequences.",type:"warning",duration:3e3})},color:m.theme.colors.warning||"#FFA726"})}),(0,T.jsx)(x.default,{style:Fr.buttonContainer,children:(0,T.jsx)(Pr.default,{title:"Show Long Toast",onPress:()=>{e({message:"This is a longer toast message that will stay visible for 5 seconds to demonstrate how longer messages look.",type:"info",duration:5e3})},color:"#9C27B0"})})]})},Er=r.default.create({card:{backgroundColor:m.theme.colors.surfaceContrast,borderRadius:8,padding:16,elevation:2,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,width:"100%"},contentContainer:{width:"100%"},topRow:{flexDirection:"row",justifyContent:"space-between",alignItems:"flex-start",width:"100%",flexWrap:"wrap"},profileInfo:{flexDirection:"row",alignItems:"center",flex:1,minWidth:0},profileInfoWrap:{flexDirection:"row",alignItems:"center",flex:1,minWidth:"70%"},avatar:{width:60,height:60,borderRadius:30,marginRight:16,flexShrink:0},nameContainer:{flex:1,justifyContent:"center",minWidth:0,marginRight:16},nameContainerWide:{maxWidth:"60%"},name:{fontSize:18,fontWeight:"600",color:m.theme.colors.text,fontFamily:m.theme.fonts.header.fontFamily,marginBottom:8},petsContainer:{flexDirection:"row",flexWrap:"wrap",alignItems:"center",marginBottom:8},petsLabel:{fontSize:14,fontWeight:"600",color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,flexShrink:0},petsText:{fontSize:14,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,flex:1,minWidth:0},petsTextWide:{maxWidth:"80%",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},servicesContainer:{flexDirection:"row",flexWrap:"wrap",alignItems:"center",marginBottom:8},servicesLabel:{fontSize:14,fontWeight:"600",color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,flexShrink:0},servicesText:{fontSize:14,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,flex:1,minWidth:0},servicesTextWide:{maxWidth:"80%",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},statusSection:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingVertical:8,marginTop:8},lastBookingContainer:{flexDirection:"row",alignItems:"center"},lastBookingText:{marginLeft:6,fontSize:14,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},noBookingsContainer:{flexDirection:"row",alignItems:"center",backgroundColor:"#F2F2F0",borderRadius:4,padding:4,marginTop:8,alignSelf:"flex-start"},noBookingsText:{fontSize:12,color:"#898974",fontFamily:m.theme.fonts.regular.fontFamily,marginLeft:6},pastBookingsContainer:{flexDirection:"row",alignItems:"center",backgroundColor:"#F9F2FC",borderRadius:4,padding:4,marginTop:8,alignSelf:"flex-start"},pastBookingsText:{marginLeft:6,fontSize:12,color:"#9C27B0",fontFamily:m.theme.fonts.regular.fontFamily},upcomingContainer:{flexDirection:"row",alignItems:"center",backgroundColor:"#F0F9E5",padding:6,borderRadius:16},upcomingText:{marginLeft:6,fontSize:14,color:m.theme.colors.primary,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"500"},buttonSection:{flexDirection:"row",gap:12,alignItems:"center",justifyContent:"flex-end",flexShrink:0},buttonSectionWrap:{marginTop:12,marginLeft:"auto"},mobileBtnSection:{flexDirection:"row",justifyContent:"flex-end",gap:12,marginTop:12},viewProfileButton:{paddingVertical:8,paddingHorizontal:16,backgroundColor:"#F0F9E5",borderRadius:6,alignItems:"center",justifyContent:"center",transition:"transform 0.2s ease, box-shadow 0.2s ease"},viewProfileText:{color:m.theme.colors.primary,fontSize:14,fontWeight:"600",fontFamily:m.theme.fonts.regular.fontFamily},createBookingButton:{paddingVertical:8,paddingHorizontal:16,backgroundColor:m.theme.colors.primary,borderRadius:6,alignItems:"center",justifyContent:"center",transition:"transform 0.2s ease, box-shadow 0.2s ease"},createBookingText:{color:m.theme.colors.surfaceContrast,fontSize:14,fontWeight:"600",fontFamily:m.theme.fonts.regular.fontFamily},buttonHovered:{transform:[{translateY:-3}],boxShadow:"0px 6px 10px rgba(0, 0, 0, 0.15)"},activeBookingsContainer:{flexDirection:"row",alignItems:"center",backgroundColor:"#F0F9E5",borderRadius:4,padding:4,marginTop:8,alignSelf:"flex-start"},activeBookingsText:{marginLeft:6,fontSize:12,color:"#4CAF50",fontFamily:m.theme.fonts.regular.fontFamily}}),Wr=({connection:e,type:t,onViewProfile:a,onCreateBooking:r})=>{const i="clients"===t,{screenWidth:s}=(0,n.useContext)(g.AuthContext),l=s<900,d=s>=1200,c=s>=2500,[u,h]=(0,n.useState)(!1),[f,p]=(0,n.useState)(!1),y=rt(),b=e.active_bookings_count>0?{icon:"calendar-check",iconColor:"#4CAF50",text:"Active Bookings",containerStyle:Er.activeBookingsContainer,textStyle:Er.activeBookingsText}:1===e.has_past_booking?{icon:"history",iconColor:"#9C27B0",text:"Past Bookings",containerStyle:Er.pastBookingsContainer,textStyle:Er.pastBookingsText}:{icon:"calendar-remove",iconColor:"#898974",text:"No Bookings Yet",containerStyle:Er.noBookingsContainer,textStyle:Er.noBookingsText};return(0,g.debugLog)("MBA9452: Rendering ConnectionCard:",{connectionId:e.id,connectionName:e.name,connectionType:t,conversationId:e.conversation_id,hasActivePastBooking:e.has_past_booking,activeBookingsCount:e.active_bookings_count,isMobile:l,isWideScreen:d,isExtraWideScreen:c,screenWidth:s}),(0,T.jsx)(x.default,{style:Er.card,children:(0,T.jsxs)(x.default,{style:Er.contentContainer,children:[(0,T.jsxs)(x.default,{style:Er.topRow,children:[(0,T.jsxs)(x.default,{style:[Er.profileInfo,!c&&Er.profileInfoWrap],children:[(0,T.jsx)(U.default,{source:e.avatar?{uri:e.avatar}:o(4456),style:Er.avatar}),(0,T.jsxs)(x.default,{style:[Er.nameContainer,d&&Er.nameContainerWide],children:[(0,T.jsx)(C.default,{style:Er.name,children:e.name}),i?(0,T.jsxs)(x.default,{style:Er.petsContainer,children:[(0,T.jsx)(C.default,{style:Er.petsLabel,children:"Pets: "}),(0,T.jsx)(C.default,{style:[Er.petsText,d&&Er.petsTextWide],children:e.pets?.length>0?e.pets.map((e=>"".concat(e.name," (").concat(e.species,")"))).join(", "):"No pets added yet"})]}):(0,T.jsxs)(x.default,{style:Er.servicesContainer,children:[(0,T.jsx)(C.default,{style:Er.servicesLabel,children:"Services: "}),(0,T.jsx)(C.default,{style:[Er.servicesText,d&&Er.servicesTextWide],children:e.services?.join(", ")||"No services"})]}),(0,T.jsxs)(x.default,{style:b.containerStyle,children:[(0,T.jsx)(S.default,{name:b.icon,size:14,color:b.iconColor}),(0,T.jsx)(C.default,{style:b.textStyle,children:b.text})]})]})]}),!l&&(0,T.jsxs)(x.default,{style:[Er.buttonSection,!c&&Er.buttonSectionWrap],children:[(0,T.jsx)(v.default,{style:[Er.viewProfileButton,u&&Er.buttonHovered],onPress:()=>{(0,g.debugLog)("MBA4321 View Messages button clicked",{connectionName:e.name,conversationId:e.conversation_id}),a(e)},onMouseEnter:()=>y&&h(!0),onMouseLeave:()=>y&&h(!1),children:(0,T.jsx)(C.default,{style:Er.viewProfileText,children:"View Messages"})}),i&&(0,T.jsx)(v.default,{style:[Er.createBookingButton,f&&Er.buttonHovered],onPress:()=>{(0,g.debugLog)("MBA4321 Create Booking button clicked",{connectionName:e.name,conversationId:e.conversation_id}),r(e)},onMouseEnter:()=>y&&p(!0),onMouseLeave:()=>y&&p(!1),children:(0,T.jsx)(C.default,{style:Er.createBookingText,children:"Create Booking"})})]})]}),e.last_booking&&(0,T.jsxs)(x.default,{style:Er.statusSection,children:[(0,T.jsxs)(x.default,{style:Er.lastBookingContainer,children:[(0,T.jsx)(S.default,{name:"calendar-clock",size:16,color:m.theme.colors.text}),(0,T.jsxs)(C.default,{style:Er.lastBookingText,children:["Last booking: ",e.last_booking]})]}),e.upcoming_booking&&(0,T.jsxs)(x.default,{style:Er.upcomingContainer,children:[(0,T.jsx)(S.default,{name:"calendar-check",size:16,color:m.theme.colors.primary}),(0,T.jsx)(C.default,{style:Er.upcomingText,children:"Upcoming Booking"})]})]}),l&&(0,T.jsxs)(x.default,{style:Er.mobileBtnSection,children:[(0,T.jsx)(v.default,{style:[Er.viewProfileButton,u&&Er.buttonHovered],onPress:()=>{(0,g.debugLog)("MBA4321 View Messages button clicked (mobile)",{connectionName:e.name,conversationId:e.conversation_id}),a(e)},onMouseEnter:()=>y&&h(!0),onMouseLeave:()=>y&&h(!1),children:(0,T.jsx)(C.default,{style:Er.viewProfileText,children:"View Messages"})}),i&&(0,T.jsx)(v.default,{style:[Er.createBookingButton,f&&Er.buttonHovered],onPress:()=>{(0,g.debugLog)("MBA4321 Create Booking button clicked (mobile)",{connectionName:e.name,conversationId:e.conversation_id}),r(e)},onMouseEnter:()=>y&&p(!0),onMouseLeave:()=>y&&p(!1),children:(0,T.jsx)(C.default,{style:Er.createBookingText,children:"Create Booking"})})]})]})})},Nr=r.default.create({container:{flex:1,height:"100vh",backgroundColor:m.theme.colors.surface,position:"fixed",top:0,right:0,bottom:0,left:0,overflow:"hidden",transition:"margin-left 0.3s ease"},content:{flex:1,height:"100%",overflow:"auto"},mainContent:{flex:1,width:"100%",alignSelf:"center",backgroundColor:m.theme.colors.background,position:"relative"},headerSection:{width:"100%",backgroundColor:m.theme.colors.surfaceContrast,paddingHorizontal:24,paddingTop:24,zIndex:2},connectionsContent:{flex:1,backgroundColor:m.theme.colors.surface,position:"relative"},title:{fontSize:32,fontWeight:"600",color:m.theme.colors.text,marginBottom:24,fontFamily:m.theme.fonts.header.fontFamily},tabContainer:{flexDirection:"row",gap:32},tab:{paddingBottom:8,borderBottomWidth:2,borderBottomColor:"transparent"},activeTab:{borderBottomColor:m.theme.colors.primary},tabText:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},activeTabText:{color:m.theme.colors.primary,fontWeight:"500"},stickyHeader:{position:"absolute",top:0,left:0,right:0,backgroundColor:m.theme.colors.surfaceContrast,zIndex:2,marginHorizontal:24,marginTop:24,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,borderRadius:8,padding:16},stickyHeaderContent:{width:"100%",gap:16},searchAndInviteContainer:{flexDirection:"row",alignItems:"center",gap:12},searchContainer:{flex:1,flexDirection:"row",alignItems:"center",backgroundColor:m.theme.colors.surfaceContrast,borderRadius:8,padding:12,borderWidth:1,borderColor:"#CCCBC9",minHeight:48},searchContainerFocused:{borderColor:m.theme.colors.primary,borderWidth:2,shadowColor:m.theme.colors.primary,shadowOffset:{width:0,height:0},shadowOpacity:.1,shadowRadius:4},searchInput:Object.assign({flex:1,color:"#666",fontSize:16,marginLeft:8,fontFamily:m.theme.fonts.regular.fontFamily,outlineStyle:"none",outlineWidth:0,WebkitAppearance:"none",padding:0,minHeight:24},"web"===a.default.OS&&{caretColor:m.theme.colors.primary}),inviteButtonSmall:Object.assign({flexDirection:"row",alignItems:"center",paddingVertical:10,paddingHorizontal:12,borderRadius:8,backgroundColor:m.theme.colors.primary,gap:6},"web"===a.default.OS&&{transition:"all 0.2s ease",cursor:"pointer"}),inviteButtonSmallText:{color:m.theme.colors.surface,fontSize:14,fontWeight:"600",fontFamily:m.theme.fonts.regular.fontFamily},filtersWrapper:{flexDirection:"row",justifyContent:"flex-end",marginRight:-16},filterScrollContent:{flexGrow:0},filterContainer:{flexDirection:"row",gap:8,backgroundColor:m.theme.colors.surfaceContrast,paddingVertical:8,paddingLeft:4,paddingRight:16},filterButton:Object.assign({paddingHorizontal:12,paddingVertical:6,borderRadius:16,justifyContent:"center"},"web"===a.default.OS&&{transition:"all 0.2s ease-in-out",cursor:"pointer"}),filterButtonHovered:{transform:[{scale:1.05}],shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:5},filterContent:{flexDirection:"row",alignItems:"center",justifyContent:"center",gap:6},checkmark:{marginLeft:4},allButton:{backgroundColor:"#EFF9FF"},allButtonText:{color:"#0784C6"},activeBookingsButton:{backgroundColor:"#E8F5E9"},activeBookingsButtonText:{color:"#4CAF50"},noBookingsButton:{backgroundColor:"#E8E9E2"},noBookingsButtonText:{color:"#898974"},pastBookingsButton:{backgroundColor:"#F3E5F5"},pastBookingsButtonText:{color:"#9C27B0"},filterText:{fontSize:14,fontFamily:m.theme.fonts.regular.fontFamily,textAlign:"center"},listHeaderSpacing:{paddingTop:16},listContainer:{paddingHorizontal:24,paddingBottom:34,alignItems:"stretch",width:"100%"},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center"},loadingMoreContainer:{paddingVertical:16,alignItems:"center"},emptyContainer:{flex:1,justifyContent:"center",alignItems:"center",paddingHorizontal:24},emptyText:{fontSize:16,color:m.theme.colors.placeholder,textAlign:"center",marginTop:8,marginBottom:24,fontFamily:m.theme.fonts.regular.fontFamily},inviteButton:{backgroundColor:m.theme.colors.primary,paddingHorizontal:24,paddingVertical:12,borderRadius:8,marginTop:8},inviteButtonText:{color:m.theme.colors.surface,fontSize:16,fontWeight:"600",fontFamily:m.theme.fonts.regular.fontFamily},footer:{paddingVertical:16,alignItems:"center",justifyContent:"center",width:"100%"},footerText:{color:m.theme.colors.placeholder,fontSize:16,fontFamily:m.theme.fonts.regular.fontFamily,textAlign:"center",marginBottom:12},createServiceButton:Object.assign({paddingVertical:10,paddingHorizontal:16,backgroundColor:m.theme.colors.primary,borderRadius:8,marginTop:8},"web"===a.default.OS&&{transition:"all 0.2s ease",cursor:"pointer"}),createServiceButtonText:{color:m.theme.colors.surface,fontSize:16,fontWeight:"600",fontFamily:m.theme.fonts.regular.fontFamily},modalOverlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center"},modalContent:{backgroundColor:m.theme.colors.surface,borderRadius:12,padding:24,width:"90%",maxWidth:500,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:4,elevation:5},modalHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16},modalTitle:{fontSize:20,fontWeight:"600",color:m.theme.colors.text,fontFamily:m.theme.fonts.header.fontFamily},closeButton:{padding:4},modalText:{fontSize:16,color:m.theme.colors.text,marginBottom:24,fontFamily:m.theme.fonts.regular.fontFamily,lineHeight:24},inviteTypeToggle:{flexDirection:"row",gap:12,marginBottom:24},inviteTypeButton:Object.assign({flex:1,padding:12,borderWidth:1,borderColor:"#CCCBC9",borderRadius:8,flexDirection:"row",alignItems:"center",justifyContent:"center",gap:6},"web"===a.default.OS&&{cursor:"pointer"}),inviteTypeButtonActive:{borderColor:m.theme.colors.primary,backgroundColor:"rgba(7, 132, 198, 0.05)"},inviteTypeText:{fontSize:16,color:"#666",fontFamily:m.theme.fonts.regular.fontFamily},inviteTypeTextActive:{color:m.theme.colors.primary,fontWeight:"500"},inputContainer:{marginBottom:24},inputLabel:{fontSize:16,fontWeight:"500",color:m.theme.colors.text,marginBottom:8,fontFamily:m.theme.fonts.regular.fontFamily},emailInput:{borderWidth:1,borderColor:"#CCCBC9",borderRadius:8,padding:12,fontSize:16,fontFamily:m.theme.fonts.regular.fontFamily},linkContainer:{marginBottom:24},generatedLinkContainer:{flexDirection:"row",alignItems:"center",gap:12,padding:12,borderWidth:1,borderColor:"#CCCBC9",borderRadius:8,backgroundColor:"rgba(0, 0, 0, 0.02)"},generatedLink:{flex:1,color:m.theme.colors.text,fontSize:16,fontFamily:m.theme.fonts.regular.fontFamily},copyButton:Object.assign({padding:8},"web"===a.default.OS&&{cursor:"pointer"}),errorText:{color:m.theme.colors.error||"#D32F2F",fontSize:16,marginBottom:16,fontFamily:m.theme.fonts.regular.fontFamily},successText:{color:m.theme.colors.success||"#4CAF50",fontSize:16,marginBottom:16,fontFamily:m.theme.fonts.regular.fontFamily},modalButtons:{flexDirection:"row",justifyContent:"flex-end",gap:12,marginTop:8},cancelButton:Object.assign({paddingVertical:10,paddingHorizontal:16,borderRadius:8,borderWidth:1,borderColor:"#CCCBC9",backgroundColor:m.theme.colors.surface},"web"===a.default.OS&&{cursor:"pointer"}),cancelButtonText:{color:m.theme.colors.text,fontSize:16,fontWeight:"500",fontFamily:m.theme.fonts.regular.fontFamily},sendInviteButton:Object.assign({paddingVertical:10,paddingHorizontal:16,borderRadius:8,backgroundColor:m.theme.colors.primary,minWidth:140,alignItems:"center",justifyContent:"center"},"web"===a.default.OS&&{cursor:"pointer"}),sendInviteButtonText:{color:m.theme.colors.surface,fontSize:16,fontWeight:"600",fontFamily:m.theme.fonts.regular.fontFamily},disabledButton:Object.assign({backgroundColor:"#CCCCCC",opacity:.7},"web"===a.default.OS&&{cursor:"not-allowed"}),columnWrapper:{flexWrap:"wrap",justifyContent:"space-between",gap:16,width:"100%"},cardWrapper:{flex:1,width:"100%",marginBottom:16},mobileCardWrapper:{maxWidth:"100%"},wideScreenCardWrapper:{maxWidth:"calc(50% - 11px)"},buttonHovered:{transform:[{translateY:-3}],shadowColor:"#000",shadowOffset:{width:0,height:6},shadowOpacity:.15,shadowRadius:10,elevation:5}}),Hr=()=>{const e=(0,y.useNavigation)(),{isApprovedProfessional:t,userRole:o,isCollapsed:r,screenWidth:i}=(0,n.useContext)(g.AuthContext),[s,l]=(0,n.useState)(i<900),[d,c]=(0,n.useState)(i>=1500),[h,f]=(0,n.useState)("clients"),[b,w]=(0,n.useState)(""),[B,k]=(0,n.useState)([]),[I,M]=(0,n.useState)(!0),[D,R]=(0,n.useState)(null),[L,z]=(0,n.useState)(1),[P,F]=(0,n.useState)(!0),[O,E]=(0,n.useState)(!1),[W,N]=(0,n.useState)("all"),[U,V]=(0,n.useState)(null),[Y,G]=(0,n.useState)(!1),[J,$]=(0,n.useState)(""),[Z,K]=(0,n.useState)(!1),[Q,X]=(0,n.useState)(!1),ee=(0,n.useRef)(null),[te,oe]=(0,n.useState)([]),[ne,ae]=(0,n.useState)("email"),[re,ie]=(0,n.useState)(""),[se,le]=(0,n.useState)(""),[de,ce]=(0,n.useState)(""),[ue,me]=(0,n.useState)(!1),[ge,he]=(0,n.useState)(!1),fe=rt();(0,n.useEffect)((()=>{const e=j.default.addEventListener("change",(()=>{l(j.default.get("window").width<900),c(j.default.get("window").width>=1200)}));return()=>{e?.remove()}}),[]),(0,n.useEffect)((()=>{f("professional"===o?"clients":"professionals")}),[o]),(0,n.useEffect)((()=>{(async()=>{(0,g.debugLog)("MBA4321 Checking user role for navigation",{userRole:o}),"petOwner"===o&&("web"===a.default.OS?(sessionStorage.setItem("previousRoute",""),sessionStorage.setItem("currentRoute","Dashboard")):(await p.default.setItem("previousRoute",""),await p.default.setItem("currentRoute","Dashboard")),(0,g.debugLog)("MBA4321 User is pet owner, navigating to Dashboard"),e.navigate("Dashboard"))})()}),[o,e]);const pe=async(e=1,t=!1)=>{M(!t),t&&E(!0),(0,g.debugLog)("MBA4321 Fetching connections:",{page:e,isLoadMore:t});try{const o=await(0,Ze.getUserConnections)(e);(0,g.debugLog)("MBA4321 Response from API:",o);const n=o.connections||[];if(t){const e=[...B,...n];k(e),oe(e)}else k(n),oe(n);F(20===n.length),z(e)}catch(D){(0,g.debugLog)("MBA4321 Error fetching connections:",D),R("Failed to fetch connections")}finally{M(!1),E(!1)}};(0,n.useEffect)((()=>{(0,g.debugLog)("MBA4321 Fetching connections due to dependency change:",{activeTab:h,userRole:o}),z(1),k([]),pe(1)}),[h,o]),(0,n.useEffect)((()=>{(0,g.debugLog)("MBA4321 Filtering connections locally based on:",{activeFilter:W}),te.length>0&&ye()}),[W,te]);const ye=()=>{if(!te.length)return;if((0,g.debugLog)("MBA9452: Filtering connections locally with filter:",W),"all"===W)return void k(te);let e=[];switch(W){case"active_bookings":e=te.filter((e=>e.active_bookings_count>0));break;case"no_bookings":e=te.filter((e=>0===e.active_bookings_count&&0===e.has_past_booking));break;case"past_bookings":e=te.filter((e=>0===e.active_bookings_count&&1===e.has_past_booking));break;default:e=te}k(e)},be=()=>{(0,g.debugLog)("MBA4321 Opening invite client modal"),$(""),ie(""),le(""),ce(""),ae("email"),G(!0)};return(0,T.jsx)(x.default,{style:[Nr.container,{marginLeft:s?0:r?70:250}],children:(0,T.jsxs)(x.default,{style:[Nr.content,{marginTop:s?60:0}],children:[(0,T.jsxs)(x.default,{style:Nr.mainContent,children:[(0,T.jsxs)(x.default,{style:Nr.headerSection,children:[(0,T.jsx)(C.default,{style:Nr.title,children:"Connections"}),(0,T.jsx)(x.default,{style:Nr.tabContainer,children:"professional"===o&&(0,T.jsx)(v.default,{style:[Nr.tab,"clients"===h&&Nr.activeTab],onPress:()=>f("clients"),children:(0,T.jsx)(C.default,{style:[Nr.tabText,"clients"===h&&Nr.activeTabText],children:"My Clients"})})})]}),(0,T.jsx)(x.default,{style:Nr.connectionsContent,children:I?(0,T.jsx)(x.default,{style:Nr.loadingContainer,children:(0,T.jsx)(_.default,{size:"large",color:m.theme.colors.primary})}):(0,T.jsxs)(x.default,{style:Nr.connectionsContent,children:[(0,T.jsx)(x.default,{style:Nr.stickyHeader,children:(0,T.jsxs)(x.default,{style:[Nr.stickyHeaderContent,{flexDirection:d?"row":"column"}],children:[(0,T.jsxs)(x.default,{style:[Nr.searchAndInviteContainer,d?{flex:.4,marginRight:"auto",flexDirection:"row",alignItems:"center"}:{flexDirection:"row",alignItems:"center"}],children:[(0,T.jsxs)(x.default,{style:[Nr.searchContainer,Q&&Nr.searchContainerFocused],children:[(0,T.jsx)(S.default,{name:"magnify",size:24,color:Q?m.theme.colors.primary:"#666"}),(0,T.jsx)(q.default,{ref:ee,style:Nr.searchInput,placeholder:"clients"===h?"Search by client name or pet":"Search by professional name or service",value:b,onChangeText:e=>{if(w(e),!e.trim())return(0,g.debugLog)("MBA9452: Empty search query, reapplying current filter"),void ye();(0,g.debugLog)("MBA9452: Searching connections with query:",e);let t=[];if("all"===W)t=te;else switch(W){case"active_bookings":t=te.filter((e=>e.active_bookings_count>0));break;case"no_bookings":t=te.filter((e=>0===e.active_bookings_count&&0===e.has_past_booking));break;case"past_bookings":t=te.filter((e=>0===e.active_bookings_count&&1===e.has_past_booking));break;default:t=te}const o=e.toLowerCase(),n=t.filter((e=>e.name.toLowerCase().includes(o)||"clients"===h&&e.pets?.some((e=>e.name?.toLowerCase().includes(o)||e.species?.toLowerCase().includes(o)))));k(n)},onFocus:()=>X(!0),onBlur:()=>X(!1)}),b?(0,T.jsx)(v.default,{onPress:()=>{w(""),ye()},children:(0,T.jsx)(S.default,{name:"close-circle",size:20,color:"#777"})}):null]}),"clients"===h&&"professional"===o&&(0,T.jsxs)(v.default,{style:[Nr.inviteButtonSmall,ue&&Nr.buttonHovered],onPress:be,onMouseEnter:()=>fe&&me(!0),onMouseLeave:()=>fe&&me(!1),children:[(0,T.jsx)(S.default,{name:"account-plus",size:16,color:m.theme.colors.surface}),(0,T.jsx)(C.default,{style:Nr.inviteButtonSmallText,children:"Invite"})]})]}),(0,T.jsx)(x.default,{style:[Nr.filtersWrapper,d?{flex:.6,alignItems:"flex-end"}:null],children:(0,T.jsx)(H.default,{horizontal:!0,showsHorizontalScrollIndicator:!1,contentContainerStyle:Nr.filterScrollContent,children:(0,T.jsxs)(x.default,{style:Nr.filterContainer,children:[(0,T.jsx)(v.default,{style:[Nr.filterButton,Nr.allButton,"web"===a.default.OS&&"all"===U&&Nr.filterButtonHovered],onPress:()=>N("all"),onMouseEnter:()=>fe&&V("all"),onMouseLeave:()=>fe&&V(null),children:(0,T.jsxs)(x.default,{style:Nr.filterContent,children:[(0,T.jsx)(S.default,{name:"filter-variant",size:16,color:"#0784C6"}),(0,T.jsx)(C.default,{style:[Nr.filterText,Nr.allButtonText],children:"All"}),"all"===W&&(0,T.jsx)(S.default,{name:"check",size:16,color:"#0784C6",style:Nr.checkmark})]})}),(0,T.jsx)(v.default,{style:[Nr.filterButton,Nr.activeBookingsButton,"web"===a.default.OS&&"active_bookings"===U&&Nr.filterButtonHovered],onPress:()=>N("active_bookings"),onMouseEnter:()=>fe&&V("active_bookings"),onMouseLeave:()=>fe&&V(null),children:(0,T.jsxs)(x.default,{style:Nr.filterContent,children:[(0,T.jsx)(S.default,{name:"calendar-check",size:16,color:"#4CAF50"}),(0,T.jsx)(C.default,{style:[Nr.filterText,Nr.activeBookingsButtonText],children:"Active Bookings"}),"active_bookings"===W&&(0,T.jsx)(S.default,{name:"check",size:16,color:"#4CAF50",style:Nr.checkmark})]})}),(0,T.jsx)(v.default,{style:[Nr.filterButton,Nr.noBookingsButton,"web"===a.default.OS&&"no_bookings"===U&&Nr.filterButtonHovered],onPress:()=>N("no_bookings"),onMouseEnter:()=>fe&&V("no_bookings"),onMouseLeave:()=>fe&&V(null),children:(0,T.jsxs)(x.default,{style:Nr.filterContent,children:[(0,T.jsx)(S.default,{name:"calendar-remove",size:16,color:"#898974"}),(0,T.jsx)(C.default,{style:[Nr.filterText,Nr.noBookingsButtonText],children:"No Bookings"}),"no_bookings"===W&&(0,T.jsx)(S.default,{name:"check",size:16,color:"#898974",style:Nr.checkmark})]})}),(0,T.jsx)(v.default,{style:[Nr.filterButton,Nr.pastBookingsButton,"web"===a.default.OS&&"past_bookings"===U&&Nr.filterButtonHovered],onPress:()=>N("past_bookings"),onMouseEnter:()=>fe&&V("past_bookings"),onMouseLeave:()=>fe&&V(null),children:(0,T.jsxs)(x.default,{style:Nr.filterContent,children:[(0,T.jsx)(S.default,{name:"history",size:16,color:"#9C27B0"}),(0,T.jsx)(C.default,{style:[Nr.filterText,Nr.pastBookingsButtonText],children:"Past Bookings"}),"past_bookings"===W&&(0,T.jsx)(S.default,{name:"check",size:16,color:"#9C27B0",style:Nr.checkmark})]})})]})})})]})}),B.length>0?(0,T.jsx)(wt.default,{data:B,renderItem:({item:t})=>((0,g.debugLog)("MBA4321 Rendering connection item:",t),(0,T.jsx)(x.default,{style:[Nr.cardWrapper,s&&Nr.mobileCardWrapper,d&&Nr.wideScreenCardWrapper],children:(0,T.jsx)(Wr,{connection:t,type:h,onViewProfile:()=>(async t=>{(0,g.debugLog)("MBA4321 Navigating to messages with connection:",{connectionId:t.id,connectionName:t.name,conversationId:t.conversation_id}),await(0,u.navigateToFrom)(e,"MessageHistory","Connections",{conversationId:t.conversation_id,otherUserName:t.name})})(t),onCreateBooking:"clients"===h?()=>(async t=>{(0,g.debugLog)("MBA4321 Creating booking with client:",{clientId:t.id,clientName:t.name,conversationId:t.conversation_id}),await(0,u.navigateToFrom)(e,"MessageHistory","Connections",{conversationId:t.conversation_id,otherUserName:t.name,clientId:t.client_id,isProfessional:!0})})(t):null})})),keyExtractor:e=>e.client_id.toString(),contentContainerStyle:Nr.listContainer,onEndReached:()=>{!O&&P&&pe(L+1,!0)},onEndReachedThreshold:.5,ListFooterComponent:()=>O?((0,g.debugLog)("MBA4321 Loading more connections"),(0,T.jsx)(x.default,{style:Nr.footer,children:(0,T.jsx)(_.default,{size:"small",color:m.theme.colors.primary})})):!P&&B.length>0?((0,g.debugLog)("MBA4321 No more connections to load"),(0,T.jsxs)(x.default,{style:Nr.footer,children:[(0,T.jsxs)(C.default,{style:Nr.footerText,children:["No more ",h," to load"]}),"professional"===o&&"clients"===h&&(0,T.jsx)(v.default,{style:[Nr.createServiceButton,ge&&Nr.buttonHovered],onPress:()=>{(0,g.debugLog)("MBA4321 Create Service button clicked in footer"),(0,u.navigateToFrom)(e,"ServiceManager","Connections")},onMouseEnter:()=>fe&&he(!0),onMouseLeave:()=>fe&&he(!1),children:(0,T.jsx)(C.default,{style:Nr.createServiceButtonText,children:"Create a Service to Get More Clients"})})]})):null,ListHeaderComponent:(0,T.jsx)(x.default,{style:[Nr.listHeaderSpacing,{height:d?130:190}]}),numColumns:d?3:s?1:2,columnWrapperStyle:!s&&Nr.columnWrapper},d?"three-columns":s?"one-column":"two-columns"):b?(0,T.jsxs)(x.default,{style:Nr.emptyContainer,children:[(0,T.jsx)(x.default,{style:[Nr.listHeaderSpacing,{height:d?130:190}]}),(0,T.jsx)(S.default,{name:"magnify-close",size:80,color:m.theme.colors.placeholder}),(0,T.jsxs)(C.default,{style:Nr.emptyText,children:["No ",h,' found matching "',b,'"']}),(0,T.jsx)(v.default,{style:Nr.inviteButton,onPress:()=>{w(""),ye()},children:(0,T.jsx)(C.default,{style:Nr.inviteButtonText,children:"Clear Search"})})]}):(0,T.jsx)((({type:e})=>(0,T.jsxs)(x.default,{style:Nr.emptyContainer,children:[(0,T.jsx)(S.default,{name:"clients"===e?"account-group-outline":"account-tie-outline",size:80,color:m.theme.colors.primary}),(0,T.jsx)(C.default,{style:Nr.emptyText,children:{clients:{all:"You don't have any clients yet. Invite a client to get started!",active:"You don't have any active clients.",pending:"You don't have any pending client requests.",past:"You don't have any past clients."},professionals:{all:"You're not connected with any professionals yet.",active:"You don't have any active professionals.",pending:"You don't have any pending professional connections.",past:"You don't have any past professional connections."}}[e][W]}),"clients"===e&&"professional"===o&&(0,T.jsx)(v.default,{style:Nr.inviteButton,onPress:be,children:(0,T.jsx)(C.default,{style:Nr.inviteButtonText,children:"Invite Client"})})]})),{type:h})]})})]}),(0,T.jsx)(A.default,{visible:Y,transparent:!0,animationType:"fade",onRequestClose:()=>G(!1),children:(0,T.jsx)(x.default,{style:Nr.modalOverlay,children:(0,T.jsxs)(x.default,{style:Nr.modalContent,children:[(0,T.jsxs)(x.default,{style:Nr.modalHeader,children:[(0,T.jsx)(C.default,{style:Nr.modalTitle,children:"Invite Client"}),(0,T.jsx)(v.default,{style:Nr.closeButton,onPress:()=>G(!1),children:(0,T.jsx)(S.default,{name:"close",size:24,color:"#666"})})]}),(0,T.jsx)(C.default,{style:Nr.modalText,children:"Invite a client to connect with you on CrittrCove. You can either send them an email invitation or generate a link to share."}),(0,T.jsxs)(x.default,{style:Nr.inviteTypeToggle,children:[(0,T.jsxs)(v.default,{style:[Nr.inviteTypeButton,"email"===ne&&Nr.inviteTypeButtonActive],onPress:()=>{ae("email"),le(""),ce("")},children:[(0,T.jsx)(S.default,{name:"email-outline",size:20,color:"email"===ne?m.theme.colors.primary:"#666"}),(0,T.jsx)(C.default,{style:[Nr.inviteTypeText,"email"===ne&&Nr.inviteTypeTextActive],children:"Email Invitation"})]}),(0,T.jsxs)(v.default,{style:[Nr.inviteTypeButton,"link"===ne&&Nr.inviteTypeButtonActive],onPress:()=>{ae("link"),le(""),ce("")},children:[(0,T.jsx)(S.default,{name:"link-variant",size:20,color:"link"===ne?m.theme.colors.primary:"#666"}),(0,T.jsx)(C.default,{style:[Nr.inviteTypeText,"link"===ne&&Nr.inviteTypeTextActive],children:"Generate Link"})]})]}),"email"===ne?(0,T.jsxs)(x.default,{style:Nr.inputContainer,children:[(0,T.jsx)(C.default,{style:Nr.inputLabel,children:"Client's Email Address"}),(0,T.jsx)(q.default,{style:Nr.emailInput,placeholder:"client@example.com",value:J,onChangeText:$,keyboardType:"email-address",autoCapitalize:"none"})]}):re?(0,T.jsxs)(x.default,{style:Nr.linkContainer,children:[(0,T.jsx)(C.default,{style:Nr.inputLabel,children:"Shareable Invitation Link"}),(0,T.jsxs)(x.default,{style:Nr.generatedLinkContainer,children:[(0,T.jsx)(C.default,{style:Nr.generatedLink,numberOfLines:1,ellipsizeMode:"middle",children:re}),"web"===a.default.OS&&(0,T.jsx)(v.default,{style:Nr.copyButton,onPress:()=>{re&&(navigator.clipboard.writeText(re),ce("Link copied to clipboard!"))},children:(0,T.jsx)(S.default,{name:"content-copy",size:20,color:m.theme.colors.primary})})]})]}):null,se?(0,T.jsx)(C.default,{style:Nr.errorText,children:se}):null,de?(0,T.jsx)(C.default,{style:Nr.successText,children:de}):null,(0,T.jsxs)(x.default,{style:Nr.modalButtons,children:[(0,T.jsx)(v.default,{style:Nr.cancelButton,onPress:()=>G(!1),children:(0,T.jsx)(C.default,{style:Nr.cancelButtonText,children:"Close"})}),re&&"email"!==ne?null:(0,T.jsx)(v.default,{style:[Nr.sendInviteButton,"email"===ne&&(!J||!J.includes("@"))&&Nr.disabledButton,Z&&Nr.disabledButton],onPress:async()=>{if(le(""),ce(""),"email"===ne&&(!J||!J.includes("@")))return le("Please enter a valid email address"),void(0,g.debugLog)("MBA4321 Invalid email format:",J);K(!0),(0,g.debugLog)("MBA4321 Creating invitation:",{type:ne,email:"email"===ne?J:null});try{const e=await(0,Ze.inviteClient)(ne,"email"===ne?J:null);(0,g.debugLog)("MBA4321 Invitation created successfully:",e),"email"===ne?(ce("Invitation sent to ".concat(J)),$("")):(ie(e.invitation_link),ce("Invitation link created successfully!")),"pending"!==W&&"all"!==W||pe(1)}catch(D){(0,g.debugLog)("MBA4321 Error creating invitation:",D),le(D.response?.data?.error||"Failed to send invitation. Please try again.")}finally{K(!1)}},disabled:Z||"email"===ne&&(!J||!J.includes("@")),children:Z?(0,T.jsx)(_.default,{size:"small",color:m.theme.colors.surface}):(0,T.jsx)(C.default,{style:Nr.sendInviteButtonText,children:"email"===ne?"Send Invitation":"Generate Link"})})]})]})})})]})})},Ur=(0,l.default)(),Vr=(0,c.default)(),qr=[{name:"Home",component:function({navigation:e}){const{colors:t}=(0,G.useTheme)(),{screenWidth:r}=(0,n.useContext)(g.AuthContext),i=r<660,[s,l]=(0,n.useState)(!1),d=({data:e,renderItem:t,title:o,cardWidth:r=320})=>{const i=n.useRef(null),[s,l]=(0,n.useState)(0),[d,c]=(0,n.useState)(!1),u=n.useRef(null);(0,n.useEffect)((()=>(d||(u.current=setInterval((()=>{if(i.current){const t=(s+1)%e.length;g(t)}}),3e3)),()=>{u.current&&clearInterval(u.current)})),[s,d,e.length]);const g=e=>{i.current&&(i.current.scrollTo({x:e*r,animated:!0}),l(e))},h=()=>{setTimeout((()=>{c(!1)}),1e3)};return(0,T.jsxs)(x.default,{style:ke.section,children:[(0,T.jsx)(Y.default,{style:ke.sectionTitle,children:o}),(0,T.jsxs)(x.default,{style:ke.scrollContainer,children:[(0,T.jsx)(H.default,{ref:i,horizontal:!0,showsHorizontalScrollIndicator:!0,style:[ke.scrollContainer,{WebkitOverflowScrolling:"touch"}],contentContainerStyle:ke.scrollContent,onScroll:e=>{const t=e.nativeEvent.contentOffset.x,o=Math.round(t/r);l(o)},scrollEventThrottle:16,pagingEnabled:"web"!==a.default.OS,onScrollBeginDrag:()=>{c(!0),u.current&&clearInterval(u.current)},onScrollEndDrag:h,onMomentumScrollEnd:h,children:e.map(((e,o)=>t(e,o)))}),(0,T.jsx)(x.default,{style:ke.scrollIndicators,children:e.map(((e,t)=>(0,T.jsx)(v.default,{onPress:()=>(e=>{c(!0),g(e),setTimeout((()=>{c(!1)}),1e3)})(t),style:ke.scrollIndicatorButton,children:(0,T.jsx)(x.default,{style:[ke.scrollIndicator,s===t&&ke.scrollIndicatorActive]})},t)))}),"web"!==a.default.OS&&(0,T.jsxs)(x.default,{style:ke.scrollHint,children:[(0,T.jsx)(Y.default,{style:ke.scrollHintText,children:"Swipe for more"}),(0,T.jsx)(S.default,{name:"gesture-swipe-horizontal",size:24,color:m.theme.colors.primary})]})]})]})},c=({icon:e,title:t,description:o,color:n})=>{const a={container:{width:i?"90%":"45%",minWidth:i?"auto":300,maxWidth:500,padding:20,backgroundColor:"#fff",borderRadius:10,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3,marginBottom:20,alignSelf:"center"},header:{flexDirection:"column",alignItems:"center",marginBottom:15},iconContainer:{width:60,height:60,borderRadius:30,backgroundColor:"".concat(m.theme.colors.primary,"15"),justifyContent:"center",alignItems:"center",marginBottom:15},title:{fontSize:20,fontWeight:"bold",color:m.theme.colors.text,fontFamily:m.theme.fonts.header.fontFamily,textAlign:"center",marginBottom:10},description:{fontSize:16,lineHeight:24,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,textAlign:"center"}};return(0,T.jsxs)(x.default,{style:a.container,children:[(0,T.jsxs)(x.default,{style:a.header,children:[(0,T.jsx)(x.default,{style:a.iconContainer,children:(0,T.jsx)(S.default,{name:e,size:32,color:n})}),(0,T.jsx)(Y.default,{style:a.title,children:t})]}),(0,T.jsx)(Y.default,{style:a.description,children:o})]})};return(0,T.jsxs)(H.default,{style:ke.container,contentContainerStyle:ke.contentContainer,showsVerticalScrollIndicator:!0,bounces:!1,overScrollMode:"never",children:[(0,T.jsxs)(x.default,{style:ke.heroSection,children:[(0,T.jsx)(U.default,{source:o(32571),style:ke.heroImage,resizeMode:"cover"}),(0,T.jsxs)(x.default,{style:ke.heroContent,children:[(0,T.jsx)(Y.default,{style:ke.heroText,children:"Welcome to CrittrCove"}),(0,T.jsx)(v.default,{style:ke.heroSignupButton,onPress:()=>(0,u.navigateToFrom)(e,"SignUp","Home"),children:(0,T.jsx)(Y.default,{style:ke.heroSignupButtonText,children:"Sign Up Today"})})]})]}),(0,T.jsxs)(x.default,{style:ke.serviceHighlightsSection,children:[(0,T.jsx)(Y.default,{style:ke.mainServiceTitle,children:"Marketplace for Pet Owners and Care Professionals"}),(0,T.jsxs)(x.default,{style:[ke.servicesGrid,{flexDirection:i?"column":"row",alignItems:i?"center":"flex-start"}],children:[(0,T.jsx)(c,{icon:"paw",title:"All Animals Welcome",description:"From common pets to exotic animals, we connect you with professionals experienced in caring for any type of animal companion.",color:m.theme.colors.mainColors.senary}),(0,T.jsx)(c,{icon:"calendar-clock",title:"Flexible Booking Options",description:"Book single visits, multiple days, or set up recurring services. Create subscription plans or schedule services months in advance.",color:m.theme.colors.mainColors.quinary}),(0,T.jsx)(c,{icon:"shield-check",title:"Verified Professionals",description:"All professionals are thoroughly vetted and must maintain active insurance coverage to provide services through our platform.",color:m.theme.colors.mainColors.main}),(0,T.jsx)(c,{icon:"tune-variant",title:"Customizable Services",description:"Professionals can create custom service packages and pricing plans tailored to your specific needs and preferences.",color:m.theme.colors.mainColors.quaternary})]})]}),(0,T.jsx)((()=>{const[t,o]=(0,n.useState)("owners"),a=["#515d6c","#516a6c","#516C61","#6A6C51"],r={flexDirection:"row",marginBottom:20,alignItems:"flex-start",width:"100%"},i={flex:1,marginLeft:5};return(0,T.jsxs)(x.default,{style:ke.featuresSection,children:[(0,T.jsx)(Y.default,{style:ke.sectionTitle,children:"How It Works"}),(0,T.jsxs)(x.default,{style:ke.toggleContainer,children:[(0,T.jsx)(v.default,{style:[ke.toggleButton,"owners"===t&&ke.toggleButtonActive],onPress:()=>o("owners"),children:(0,T.jsx)(Y.default,{style:[ke.toggleButtonText,"owners"===t&&ke.toggleButtonTextActive],children:"For Pet Owners"})}),(0,T.jsx)(v.default,{style:[ke.toggleButton,"sitters"===t&&ke.toggleButtonActive],onPress:()=>o("sitters"),children:(0,T.jsx)(Y.default,{style:[ke.toggleButtonText,"sitters"===t&&ke.toggleButtonTextActive],children:"For Pet Professionals"})})]}),(0,T.jsxs)(x.default,{style:ke.featuresContainer,children:["owners"===t&&(0,T.jsxs)(x.default,{style:ke.featureColumn,children:[(0,T.jsx)(Y.default,{style:ke.columnTitle,children:"For Pet Owners"}),(0,T.jsxs)(x.default,{style:ke.featuresList,children:[(0,T.jsxs)(x.default,{style:r,children:[(0,T.jsx)(x.default,{style:[ke.featureIconCircle,{backgroundColor:a[0]}],children:(0,T.jsx)(X.default,{name:"person-running",size:24,color:"white"})}),(0,T.jsxs)(x.default,{style:i,children:[(0,T.jsx)(Y.default,{style:ke.featureTitle,children:"Complete Your Profile"}),(0,T.jsx)(Y.default,{style:ke.featureText,children:"Submit details about you and your requirements."})]})]}),(0,T.jsxs)(x.default,{style:r,children:[(0,T.jsx)(x.default,{style:[ke.featureIconCircle,{backgroundColor:a[1]}],children:(0,T.jsx)(S.default,{name:"horse-human",size:24,color:"white"})}),(0,T.jsxs)(x.default,{style:i,children:[(0,T.jsx)(Y.default,{style:ke.featureTitle,children:"Complete Pet Profile"}),(0,T.jsx)(Y.default,{style:ke.featureText,children:"Submit details about your pet and sitting requirements."})]})]}),(0,T.jsxs)(x.default,{style:r,children:[(0,T.jsx)(x.default,{style:[ke.featureIconCircle,{backgroundColor:a[2]}],children:(0,T.jsx)(S.default,{name:"professional-hexagon",size:24,color:"white"})}),(0,T.jsxs)(x.default,{style:i,children:[(0,T.jsx)(Y.default,{style:ke.featureTitle,children:"Search for Pro's"}),(0,T.jsx)(Y.default,{style:ke.featureText,children:"You can use our marketplace to find the best pro for your desired service."})]})]}),(0,T.jsxs)(x.default,{style:r,children:[(0,T.jsx)(x.default,{style:[ke.featureIconCircle,{backgroundColor:a[3]}],children:(0,T.jsx)($.default,{name:"calendar-check",size:24,color:"white"})}),(0,T.jsxs)(x.default,{style:i,children:[(0,T.jsx)(Y.default,{style:ke.featureTitle,children:"Confirm Your Booking"}),(0,T.jsx)(Y.default,{style:ke.featureText,children:"Coordinate directly with your professional to finalize details."})]})]})]}),(0,T.jsx)(x.default,{style:ke.buttonContainer,children:(0,T.jsx)(v.default,{style:ke.actionButton,onPress:()=>(0,u.navigateToFrom)(e,"SignUp","Home"),children:(0,T.jsx)(Y.default,{style:ke.buttonText,children:"Sign up Today!"})})})]}),"sitters"===t&&(0,T.jsxs)(x.default,{style:ke.featureColumn,children:[(0,T.jsx)(Y.default,{style:ke.columnTitle,children:"For Pet Professionals"}),(0,T.jsxs)(x.default,{style:ke.featuresList,children:[(0,T.jsxs)(x.default,{style:r,children:[(0,T.jsx)(x.default,{style:[ke.featureIconCircle,{backgroundColor:a[0]}],children:(0,T.jsx)(J.default,{name:"sign-in",size:24,color:"white"})}),(0,T.jsxs)(x.default,{style:i,children:[(0,T.jsx)(Y.default,{style:ke.featureTitle,children:"Apply to Join Pro Community"}),(0,T.jsx)(Y.default,{style:ke.featureText,children:"Submit your specialties, documents, bio, and availability to begin."})]})]}),(0,T.jsxs)(x.default,{style:r,children:[(0,T.jsx)(x.default,{style:[ke.featureIconCircle,{backgroundColor:a[1]}],children:(0,T.jsx)(S.default,{name:"plus-circle",size:24,color:"white"})}),(0,T.jsxs)(x.default,{style:i,children:[(0,T.jsx)(Y.default,{style:ke.featureTitle,children:"Create Services"}),(0,T.jsx)(Y.default,{style:ke.featureText,children:"Create services to offer to pet owners."})]})]}),(0,T.jsxs)(x.default,{style:r,children:[(0,T.jsx)(x.default,{style:[ke.featureIconCircle,{backgroundColor:a[2]}],children:(0,T.jsx)(X.default,{name:"handshake-simple",size:24,color:"white"})}),(0,T.jsxs)(x.default,{style:i,children:[(0,T.jsx)(Y.default,{style:ke.featureTitle,children:"Get Matched with Owners"}),(0,T.jsx)(Y.default,{style:ke.featureText,children:"Pet owners in your area will reach out to you for yourservices."})]})]}),(0,T.jsxs)(x.default,{style:r,children:[(0,T.jsx)(x.default,{style:[ke.featureIconCircle,{backgroundColor:a[3]}],children:(0,T.jsx)(ee.default,{name:"auto-graph",size:24,color:"white"})}),(0,T.jsxs)(x.default,{style:i,children:[(0,T.jsx)(Y.default,{style:ke.featureTitle,children:"Grow Your Business"}),(0,T.jsx)(Y.default,{style:ke.featureText,children:"Manage bookings and get support as you build your pet service business."})]})]})]}),(0,T.jsx)(x.default,{style:ke.buttonContainer,children:(0,T.jsx)(v.default,{style:ke.actionButton,onPress:()=>(0,u.navigateToFrom)(e,"SignUp","Home"),children:(0,T.jsx)(Y.default,{style:ke.buttonText,children:"Become a Professional"})})})]})]})]})}),{}),(0,T.jsx)((()=>(0,T.jsx)(d,{data:Te,renderItem:(e,t)=>(0,T.jsxs)(x.default,{style:ke.reviewCard,children:[(0,T.jsx)(Y.default,{style:ke.reviewText,children:e.text}),(0,T.jsxs)(x.default,{style:ke.reviewAuthorContainer,children:[(0,T.jsx)(Be,{source:e.image,style:ke.reviewerImage}),(0,T.jsxs)(x.default,{children:[(0,T.jsx)(Y.default,{style:ke.reviewAuthorName,children:e.author}),(0,T.jsx)(Y.default,{style:ke.reviewAuthorTitle,children:"Owner Review"}),(0,T.jsx)(x.default,{style:ke.starsContainer,children:[1,2,3,4,5].map(((e,t)=>(0,T.jsx)(S.default,{name:"star",size:16,color:m.theme.colors.primary,style:ke.starIcon},t)))})]})]})]},t),title:"Kind Words From Users"})),{}),(0,T.jsx)((()=>(0,T.jsx)(d,{data:we,renderItem:(t,o)=>(0,T.jsx)(v.default,{style:[ke.blogCard,{marginRight:o===we.length-1?0:10}],onPress:()=>(0,u.navigateToFrom)(e,"BlogPost","Home",{post:t}),children:(0,T.jsxs)(x.default,{style:ke.authorContainer,children:[(0,T.jsx)(U.default,{source:{uri:t.author.profilePicture},style:ke.authorImage}),(0,T.jsxs)(x.default,{style:ke.blogContent,children:[(0,T.jsx)(Y.default,{style:[ke.title,{color:m.theme.colors.primary}],numberOfLines:2,children:t.title}),(0,T.jsxs)(x.default,{style:ke.authorInfo,children:[(0,T.jsx)(Y.default,{style:[ke.authorName,{color:m.theme.colors.secondary}],children:t.author.name}),(0,T.jsx)(Y.default,{style:ke.dot,children:" \u2022 "}),(0,T.jsx)(Y.default,{style:ke.readTime,children:t.readTime})]}),(0,T.jsxs)(Y.default,{style:ke.preview,numberOfLines:3,children:[t.content.slice(0,100),"..."]}),(0,T.jsx)(x.default,{style:ke.tags,children:t.tags.slice(0,2).map(((e,t)=>(0,T.jsx)(x.default,{style:[ke.tag,{backgroundColor:m.theme.colors.primary+"20"}],children:(0,T.jsx)(Y.default,{style:[ke.tagText,{color:m.theme.colors.primary}],children:e})},t)))}),(0,T.jsxs)(x.default,{style:ke.stats,children:[(0,T.jsxs)(x.default,{style:ke.stat,children:[(0,T.jsx)(S.default,{name:"heart-outline",size:16,color:m.theme.colors.secondary}),(0,T.jsx)(Y.default,{style:ke.statText,children:t.likes})]}),(0,T.jsxs)(x.default,{style:ke.stat,children:[(0,T.jsx)(S.default,{name:"comment-outline",size:16,color:m.theme.colors.secondary}),(0,T.jsx)(Y.default,{style:ke.statText,children:t.comments})]}),(0,T.jsxs)(x.default,{style:ke.stat,children:[(0,T.jsx)(S.default,{name:"share-outline",size:16,color:m.theme.colors.secondary}),(0,T.jsx)(Y.default,{style:ke.statText,children:t.shares})]})]})]})]})},t.id),title:"Blog",cardWidth:320})),{}),(0,T.jsx)(K,{}),(0,T.jsx)((()=>{const[e,t]=(0,Q.useForm)("mkgobpro"),[o,a]=(0,n.useState)(""),[r,i]=(0,n.useState)(""),[s,l]=(0,n.useState)("");return e.succeeded?(0,T.jsx)(x.default,{style:ke.contactSection,children:(0,T.jsxs)(x.default,{style:ke.contactContainer,children:[(0,T.jsx)(Y.default,{style:[ke.sectionTitle,{color:m.theme.colors.primary}],children:"Thanks for reaching out!"}),(0,T.jsx)(Y.default,{style:ke.successMessage,children:"We'll get back to you soon."})]})}):(0,T.jsx)(x.default,{style:ke.contactSection,children:(0,T.jsxs)(x.default,{style:ke.contactContainer,children:[(0,T.jsx)(Y.default,{style:ke.sectionTitle,children:"Contact Us"}),(0,T.jsx)(q.default,{placeholder:"Your Name",style:ke.input,value:o,onChangeText:a,name:"name"}),(0,T.jsx)(Q.ValidationError,{prefix:"Name",field:"name",errors:e.errors}),(0,T.jsx)(q.default,{placeholder:"Your Email",style:ke.input,value:r,onChangeText:i,keyboardType:"email-address",name:"email",autoCapitalize:"none"}),(0,T.jsx)(Q.ValidationError,{prefix:"Email",field:"email",errors:e.errors}),(0,T.jsx)(q.default,{placeholder:"Your Message",style:[ke.input,ke.messageInput],value:s,onChangeText:l,multiline:!0,name:"message"}),(0,T.jsx)(Q.ValidationError,{prefix:"Message",field:"message",errors:e.errors}),(0,T.jsx)(x.default,{style:ke.buttonContainer,children:(0,T.jsx)(v.default,{style:[ke.actionButton,e.submitting&&ke.disabledButton],onPress:async n=>{n.preventDefault();const d={name:o,email:r,message:s};await t(d),e.succeeded&&(a(""),i(""),l(""))},disabled:e.submitting,children:(0,T.jsx)(Y.default,{style:ke.buttonText,children:e.submitting?"Sending...":"Send"})})})]})})}),{}),(0,T.jsxs)(x.default,{style:ke.footer,children:[(0,T.jsxs)(x.default,{style:ke.socialIconsRow,children:[(0,T.jsx)(v.default,{style:ke.socialIcon,onPress:()=>V.default.openURL("https://www.instagram.com/thezensitter"),children:(0,T.jsx)(J.default,{name:"instagram",size:24,color:"white"})}),(0,T.jsx)(v.default,{style:ke.socialIcon,onPress:()=>V.default.openURL("https://discord.com/your-profile"),children:(0,T.jsx)($.default,{name:"discord",size:24,color:"white"})})]}),(0,T.jsxs)(x.default,{style:ke.footerLinksRow,children:[(0,T.jsx)(Y.default,{style:ke.footerLink,onPress:()=>(0,u.navigateToFrom)(e,"PrivacyPolicy","Home"),children:"Privacy Policy"}),(0,T.jsx)(Y.default,{style:ke.footerLink,onPress:()=>(0,u.navigateToFrom)(e,"TermsOfService","Home"),children:"Terms of Service"})]})]})]})}},{name:"About",component:function(){return(0,T.jsx)(x.default,{style:{flex:1,justifyContent:"center",alignItems:"center"},children:(0,T.jsx)(Y.default,{children:"About Screen"})})}},{name:"MyProfile",component:qt},{name:"SignIn",component:function(){const[e,t]=(0,n.useState)(""),[o,r]=(0,n.useState)(""),[i,s]=(0,n.useState)(""),[l,d]=(0,n.useState)(""),[c,h]=(0,n.useState)(!1),[p,w]=(0,n.useState)(""),[j,B]=(0,n.useState)(!1),[k,A]=(0,n.useState)(!1),I=(0,y.useNavigation)(),{signIn:M,is_prototype:D,is_DEBUG:R}=(0,n.useContext)(g.AuthContext),L=async()=>{if("ios"!==a.default.OS&&"android"!==a.default.OS||Yt.default.dismiss(),(()=>{let t=!0;const n=$t(e);s(n.message),n.isValid||(t=!1);const a=Kt(o);return d(a.message),a.isValid||(t=!1),t})()){h(!0);try{(0,g.debugLog)("MBA67890 Starting login process"),(0,g.debugLog)("MBA67890 API Base URL:",f.API_BASE_URL),(0,g.debugLog)("MBA67890 Login request details:",{url:"".concat(f.API_BASE_URL,"/api/token/"),method:"POST",data:{email:e.toLowerCase(),password:"***"}}),(0,g.debugLog)("MBA67890 Attempting to authenticate with backend");const a=await b.default.post("".concat(f.API_BASE_URL,"/api/token/"),{email:e.toLowerCase(),password:o});(0,g.debugLog)("MBA67890 Login response:",{status:a.status,statusText:a.statusText,headers:a.headers});const{access:r,refresh:i}=a.data;(0,g.debugLog)("MBA67890 Authentication successful, received tokens");const s=await M(r,i,I);(0,g.debugLog)("MBA67890 Sign in status:",s);try{const e=Intl.DateTimeFormat().resolvedOptions().timeZone;(0,g.debugLog)("MBA67890 Detected timezone:",e),console.log("MBA67890 Detected timezone:",e),await(0,Ze.updateTimeSettings)(e),(0,g.debugLog)("MBA67890 Successfully updated timezone in backend")}catch(t){(0,g.debugLog)("MBA67890 Error updating timezone:",t)}try{const e=await b.default.get("".concat(f.API_BASE_URL,"/api/users/v1/tutorial-status/current/")),t=e.data.first_time_logging_in||e.data.first_time_logging_in_after_signup;(0,g.debugLog)("MBA67890 Tutorial status:",e.data),(0,g.debugLog)("MBA67890 Needs tutorial:",t),t?((0,g.debugLog)("MBA67890 Navigating to MyProfile for tutorial"),(0,u.navigateToFrom)(I,"MyProfile","SignIn")):((0,g.debugLog)("MBA67890 Navigating to Dashboard"),(0,u.navigateToFrom)(I,"Dashboard","SignIn"))}catch(n){(0,g.debugLog)("MBA67890 Error checking tutorial status:",n),(0,u.navigateToFrom)(I,"Dashboard","SignIn")}}catch(r){(0,g.debugLog)("MBA67890 Login failed",r.response?.data||r.message);const e=r.response&&401===r.response.status?"Invalid credentials. Please try again.":"An unexpected error occurred.";"ios"===a.default.OS||"android"===a.default.OS?ft.default.alert("Login Failed",e):w("Login Failed: ".concat(e)),s("Invalid email or password"),d("Invalid email or password")}finally{h(!1)}}};(0,n.useEffect)((()=>{if("web"===a.default.OS){const e=e=>{"Enter"===e.key&&L()};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}}}),[e,o]);const z=e=>{"web"===a.default.OS&&"Enter"===e.nativeEvent.key&&L()};return(0,n.useEffect)((()=>{if("web"===a.default.OS){const e=window.location.pathname;if((0,g.debugLog)("MBA5555 SignIn screen - Current URL path:",e),e.includes("/invite/")){const t=e.split("/"),o=t.findIndex((e=>"invite"===e));if(-1!==o&&t.length>o+1){const e=t[o+1];(0,g.debugLog)("MBA5555 SignIn detected invite token, redirecting to SignUp:",e),I.navigate("SignUp",{token:e})}}}}),[]),(0,T.jsx)(x.default,{style:Xt.container,children:(0,T.jsxs)(x.default,{style:Xt.card,children:[(0,T.jsx)(C.default,{style:Xt.title,children:"Log in"}),D&&(0,T.jsx)(C.default,{style:Xt.prototypeWarning,children:"Prototype Mode: You can sign in with anything for email and password"}),(0,T.jsxs)(x.default,{style:Xt.createAccountContainer,children:[(0,T.jsx)(C.default,{style:Xt.createAccountText,children:"Need a CrittrCove account?"}),(0,T.jsx)(v.default,{onPress:()=>I.navigate("SignUp"),children:(0,T.jsx)(C.default,{style:Xt.createAccountLink,children:"Create an account"})})]}),(0,T.jsxs)(x.default,{style:Xt.inputLabelContainer,children:[(0,T.jsx)(C.default,{style:Xt.inputLabel,children:"Username or Email"}),(0,T.jsx)(q.default,{style:[Xt.input,i?Xt.errorInput:null],value:e,onChangeText:e=>{t(e),s("")},autoCapitalize:"none",onKeyPress:"web"===a.default.OS?z:void 0}),i?(0,T.jsx)(C.default,{style:Xt.errorText,children:i}):null]}),(0,T.jsxs)(x.default,{style:Xt.inputLabelContainer,children:[(0,T.jsxs)(x.default,{style:Xt.passwordLabelContainer,children:[(0,T.jsx)(C.default,{style:Xt.inputLabel,children:"Password"}),(0,T.jsx)(v.default,{onPress:()=>{B(!j)},children:(0,T.jsx)(C.default,{style:Xt.showHideText,children:j?"Hide":"Show"})})]}),(0,T.jsx)(q.default,{style:[Xt.input,l?Xt.errorInput:null],secureTextEntry:!j,value:o,onChangeText:e=>{r(e),d("")},onKeyPress:"web"===a.default.OS?z:void 0}),l?(0,T.jsx)(C.default,{style:Xt.errorText,children:l}):null]}),(0,T.jsxs)(x.default,{style:Xt.rememberMeContainer,children:[(0,T.jsx)(v.default,{style:Xt.checkbox,onPress:()=>A(!k),children:k&&(0,T.jsx)(x.default,{style:Xt.checkboxInner,children:(0,T.jsx)(S.default,{name:"check",size:14,color:m.theme.colors.whiteText})})}),(0,T.jsx)(C.default,{style:Xt.rememberMeText,children:"Keep me logged in"})]}),(0,T.jsx)(v.default,{style:Xt.loginButton,onPress:L,children:(0,T.jsx)(C.default,{style:Xt.loginButtonText,children:"Log in"})}),c&&(0,T.jsx)(_.default,{size:"large",color:m.theme.colors.primary}),p?(0,T.jsx)(C.default,{style:Xt.message,children:p}):null,(0,T.jsx)(v.default,{onPress:()=>I.navigate("ResetPassword"),style:Xt.forgotPasswordContainer,children:(0,T.jsx)(C.default,{style:Xt.link,children:"Forgot Password?"})})]})})}},{name:"SignUp",component:oo},{name:"Invite",component:oo},{name:"ResetPassword",component:function(){const[e,t]=(0,n.useState)(""),[o,r]=(0,n.useState)(!1),[i,s]=(0,n.useState)(!1),[l,d]=(0,n.useState)(""),c=(0,y.useNavigation)(),{screenWidth:u,isCollapsed:h,isSignedIn:p}=(0,n.useContext)(g.AuthContext),w=ro(u,h,p);return(0,T.jsx)(x.default,{style:w.container,children:(0,T.jsx)(Ie.default,{style:w.safeArea,children:(0,T.jsxs)(x.default,{style:w.content,children:[p&&(0,T.jsxs)(v.default,{onPress:()=>c.navigate("ChangePassword"),style:w.backButton,children:[(0,T.jsx)(S.default,{name:"arrow-left",size:24,color:m.theme.colors.text}),(0,T.jsx)(C.default,{style:w.backText,children:"Reset Password"})]}),(0,T.jsxs)(x.default,{style:w.card,children:[(0,T.jsx)(C.default,{style:w.title,children:"Reset Password"}),(0,T.jsx)(q.default,{style:[w.input,o&&w.inputError],placeholder:"Email",value:e,onChangeText:e=>{t(e),r(!1),d("")},keyboardType:"email-address",autoCapitalize:"none",placeholderTextColor:m.theme.colors.placeHolderText}),(0,T.jsx)(Gt,{title:"Reset Password",onPress:async()=>{if(e){s(!0);try{await b.default.post("".concat(f.API_BASE_URL,"/api/users/v1/reset-password/"),{email:e});"ios"===a.default.OS||"android"===a.default.OS?ft.default.alert("Success","A reset password link has been sent to your email.",[{text:"OK",onPress:()=>c.navigate("SignIn")}]):(d("A reset password link has been sent to your email."),setTimeout((()=>{c.navigate("SignIn")}),2e3))}catch(t){t.response&&404===t.response.status?(r(!0),"ios"===a.default.OS||"android"===a.default.OS?ft.default.alert("Error","Email is not associated with any user."):d("Error: Email is not associated with any user.")):"ios"===a.default.OS||"android"===a.default.OS?ft.default.alert("Error","Failed to send reset password email. Please try again later."):d("Error: Failed to send reset password email. Please try again later.")}finally{s(!1)}}else"ios"===a.default.OS||"android"===a.default.OS?ft.default.alert("Error","Please enter your email address."):d("Error: Please enter your email address.")},disabled:i,style:w.button}),i&&(0,T.jsx)(_.default,{size:"large",color:m.theme.colors.primary,style:w.loader}),l?(0,T.jsx)(C.default,{style:[w.message,l.includes("Error")&&w.errorMessage],children:l}):null]})]})})})}},{name:"ResetPasswordConfirm",component:function({route:e}){const{uid:t,token:o}=e.params,[r,i]=(0,n.useState)(""),[s,l]=(0,n.useState)(""),[d,c]=(0,n.useState)(!1),[g,h]=(0,n.useState)(""),p=(0,y.useNavigation)();return(0,T.jsxs)(x.default,{style:so.container,children:[(0,T.jsx)(C.default,{style:so.title,children:"Reset Password"}),(0,T.jsx)(q.default,{style:so.input,placeholder:"New Password",value:r,onChangeText:i,secureTextEntry:!0}),(0,T.jsx)(q.default,{style:so.input,placeholder:"Confirm Password",value:s,onChangeText:l,secureTextEntry:!0}),(0,T.jsx)(Gt,{title:"Reset Password",onPress:async()=>{if(r===s){c(!0);try{await b.default.post("".concat(f.API_BASE_URL,"/api/users/v1/reset-password-confirm/").concat(t,"/").concat(o,"/"),{new_password:r});"ios"===a.default.OS||"android"===a.default.OS?ft.default.alert("Success","Your password has been reset.",[{text:"OK",onPress:()=>(0,u.navigateToFrom)(p,"SignIn","ResetPasswordConfirm")}]):(h("Your password has been reset."),setTimeout((()=>{(0,u.navigateToFrom)(p,"SignIn","ResetPasswordConfirm")}),2e3))}catch(e){const t="Failed to reset password. Please try again later.";"ios"===a.default.OS||"android"===a.default.OS?ft.default.alert("Error",t):h(t)}finally{c(!1)}}else"ios"===a.default.OS||"android"===a.default.OS?ft.default.alert("Error","Passwords do not match."):h("Passwords do not match.")}}),d&&(0,T.jsx)(_.default,{size:"large",color:m.theme.colors.primary}),g?(0,T.jsx)(C.default,{style:so.message,children:g}):null]})}},{name:"SearchProfessionalsListing",component:Cr},{name:"OwnerHistory",component:ln},{name:"MessageHistory",component:Xn},{name:"Dashboard",component:wo},{name:"BecomeProfessional",component:jo},{name:"More",component:Ao},{name:"Owners",component:Ca},{name:"AvailabilitySettings",component:on},{name:"Settings",component:ta},{name:"PrivacyPolicy",component:aa},{name:"ProfessionalSettings",component:ia},{name:"TermsOfService",component:da},{name:"HelpFAQ",component:ua},{name:"ContactUs",component:ga},{name:"ProfessionalProfile",component:Aa},{name:"MyContracts",component:qa},{name:"ChangePassword",component:Ja},{name:"MyBookings",component:wr},{name:"ServiceManager",component:Sr},{name:"Blog",component:kr},{name:"BlogPost",component:_r},{name:"Waitlist",component:zr},{name:"TestToast",component:Or},{name:"Connections",component:Hr}],Yr={enabled:!0,prefixes:["https://staging.crittrcove.com","http://staging.crittrcove.com","".concat(f.API_BASE_URL)],config:{screens:{Home:"*",About:"about",MyProfile:"my-profile",SignIn:"signin",SignUp:{path:"signup/:token?",parse:{token:e=>e||null}},Invite:{path:"invite/:token",exact:!0,parse:{token:e=>e},stringify:{token:e=>e}},ResetPassword:"reset-password",ResetPasswordConfirm:"reset-password/:uid/:token",SearchProfessionalsListing:"search-professionals-listing",OwnerHistory:"owner-history",MessageHistory:{path:"message-history",parse:{messageId:e=>e||null,senderName:e=>e||"Unknown User"}},Dashboard:"Dashboard",BecomeProfessional:"become-professional",More:"more",Owners:"owners",AvailabilitySettings:"availability-settings",Settings:"settings",PrivacyPolicy:"privacy-policy",ProfessionalSettings:"professional-settings",TermsOfService:"terms-of-service",HelpFAQ:"help-faq",ContactUs:"contact-us",ProfessionalProfile:{path:"professional-profile",parse:{professional:e=>{}}},MyContracts:"my-contracts",ChangePassword:"change-password",MyBookings:"my-bookings",ServiceManager:"service-manager",Blog:"blog",BlogPost:"blog-post",Waitlist:"waitlist",TestToast:"test-toast",Connections:"connections"}}},Gr=(0,y.createNavigationContainerRef)();function Jr(e,t){Gr.isReady()&&Gr.navigate(e,t)}function $r(){return(0,T.jsx)(Vr.Navigator,{tabBar:e=>(0,T.jsx)(u.default,Object.assign({},e)),children:qr.map((e=>(0,T.jsx)(Vr.Screen,{name:e.name,component:e.component,options:{headerShown:!1}},e.name)))})}function Zr(){const e=(0,n.useContext)(g.AuthContext),{checkAuthStatus:t,is_DEBUG:o}=e,[r,i]=(0,n.useState)(null),[s,l]=(0,n.useState)(!0),[c,m]=(0,n.useState)(!0),[h,f]=(0,n.useState)(null);return(0,n.useEffect)((()=>{if("web"===a.default.OS){const t=window.location.pathname;if(e.debugLog&&e.debugLog("MBA6666 App - Current URL path:",t),t.includes("/invite/")){const o=t.split("/"),n=o.findIndex((e=>"invite"===e));if(-1!==n&&o.length>n+1){const t=o[n+1];e.debugLog&&e.debugLog("MBA6666 Found invitation token in URL:",t),f(t)}}}}),[]),(0,n.useEffect)((()=>{(async()=>{try{const o=await t();let n="Home";h?(e.debugLog&&e.debugLog("MBA6666 Setting initial route to SignUp with token:",h),n="SignUp"):o.isAuthenticated&&(n="professional"===o.userRole?"Dashboard":"Home"),i(n)}catch(o){console.error("Error initializing app:",o),i(h?"SignUp":"Home")}finally{l(!1)}})()}),[h]),(0,n.useEffect)((()=>{!s&&r&&"web"!==a.default.OS&&p.default.setItem("lastRoute",r).catch((e=>console.error("Error storing route:",e)))}),[r,s]),s||!r?null:(0,T.jsx)(T.Fragment,{children:"web"===a.default.OS?(0,T.jsx)(Ur.Navigator,{initialRouteName:r,screenOptions:Object.assign({headerShown:!0,header:({navigation:e})=>(0,T.jsx)(u.default,{navigation:e})},d.SlideFromRightIOS,{presentation:"card",animation:"slide_from_right"}),children:qr.map((e=>(0,T.jsx)(Ur.Screen,{name:e.name,component:e.component,options:{headerShown:!0,animation:"slide_from_right"}},e.name)))}):(0,T.jsx)($r,{})})}r.default.create({container:{flex:1,display:"flex",flexDirection:"column",height:"100%"},warningBanner:{backgroundColor:"#ffebee",padding:"web"===a.default.OS?12:10,borderBottomWidth:1,borderBottomColor:"#ef5350",width:"100%",flexShrink:0},warningContent:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:10,maxWidth:1200,marginHorizontal:"auto",width:"100%"},warningText:{color:"#c62828",textAlign:"center",fontSize:"web"===a.default.OS?15:14,flexShrink:1,flex:1,marginHorizontal:15},waitlistButton:{backgroundColor:"#ef5350",paddingHorizontal:15,paddingVertical:8,borderRadius:20,marginLeft:"auto"},waitlistButtonText:{color:"white",fontSize:"web"===a.default.OS?14:13,fontWeight:"600"},closeButton:{width:24,height:24,justifyContent:"center",alignItems:"center",marginRight:5},closeButtonText:{color:"#c62828",fontSize:18,fontWeight:"600"}});function Kr(){return(0,T.jsx)(s.default,{ref:Gr,linking:Yr,onStateChange:async e=>{if("web"!==a.default.OS&&e?.routes?.length>0){const t=e.routes[e.routes.length-1].name;await p.default.setItem("lastRoute",t).catch((e=>console.error("Error storing route:",e)))}},children:(0,T.jsx)(g.AuthProvider,{children:(0,T.jsx)(h.MessageNotificationProvider,{children:(0,T.jsx)(z,{children:(0,T.jsx)(i.default,{theme:m.theme,children:(0,T.jsx)(W,{children:(0,T.jsx)(Zr,{})})})})})})})}},50294:(e,t,o)=>{"use strict";o.r(t),o.d(t,{acceptInvitation:()=>P,addPet:()=>w,approveBooking:()=>c,createBookingFromDraft:()=>W,createConversation:()=>q,createDraftFromBooking:()=>H,createService:()=>B,deleteInvitation:()=>F,deletePet:()=>T,deleteService:()=>k,fixPetOwner:()=>S,getBookingAvailablePets:()=>d,getBookingAvailableServices:()=>l,getBookingDetails:()=>u,getBookingDraftDatesAndTimes:()=>N,getConnectionProfile:()=>I,getConversationMessages:()=>G,getInvitationDetails:()=>L,getInvitations:()=>R,getProfessionalServices:()=>s,getProfessionalServicesDetailed:()=>V,getTimeSettings:()=>y,getUnreadMessageCount:()=>Y,getUserConnections:()=>_,getUserName:()=>x,inviteClient:()=>M,requestBookingChanges:()=>m,resendInvitation:()=>O,searchProfessionals:()=>U,sendReferral:()=>D,updateBookingDraftMultipleDays:()=>f,updateBookingDraftPetsAndServices:()=>g,updateBookingDraftRates:()=>E,updateBookingDraftRecurring:()=>p,updateBookingDraftTimeAndDate:()=>h,updatePet:()=>j,updateProfileInfo:()=>v,updateService:()=>A,updateTimeSettings:()=>b,userProfile:()=>C,verifyInvitation:()=>z});var n=o(77109),a=o(19620),r=o(38432),i=o(32160);const s=async()=>{try{(0,r.debugLog)("MBA7890: Fetching professional services");return(await n.default.get("".concat(a.API_BASE_URL,"/api/services/v1/professional/services/"))).data}catch(e){throw(0,r.debugLog)("MBA7890: Error fetching professional services:",e),(0,r.debugLog)("MBA7890: Error details:",e.response?.data||e.message),e}},l=async e=>{try{return(await n.default.get("".concat(a.API_BASE_URL,"/api/booking_drafts/v1/").concat(e,"/available_services/"))).data}catch(t){throw(0,r.debugLog)("MBA12345 Error fetching available services:",t),t}},d=async e=>{try{return(await n.default.get("".concat(a.API_BASE_URL,"/api/booking_drafts/v1/").concat(e,"/available_pets/"))).data}catch(t){throw(0,r.debugLog)("MBA12345 Error fetching available pets:",t),t}},c=async e=>{try{return(await n.default.post("".concat(a.API_BASE_URL,"/api/bookings/v1/").concat(e,"/approve/"),{})).data}catch(t){throw(0,r.debugLog)("Error approving booking:",t),t}},u=async e=>{try{(0,r.debugLog)("MBA88899","Fetching booking details for ID:",e);const t=await n.default.get("".concat(a.API_BASE_URL,"/api/bookings/v1/").concat(e,"/details/"));return(0,r.debugLog)("MBA88899","Booking details fetched successfully"),t.data}catch(t){throw(0,r.debugLog)("MBA88899","Error fetching booking details:",t.response?.data||t.message),t}},m=async(e,t)=>{try{(0,r.debugLog)("MBA88899 Requesting changes for booking ID:",e),(0,r.debugLog)("MBA88899 Change request message:",t);const o=await n.default.post("".concat(a.API_BASE_URL,"/api/bookings/v1/").concat(e,"/request-changes/"),{message:t});return(0,r.debugLog)("MBA88899 Change request submitted successfully"),o.data}catch(o){throw(0,r.debugLog)("MBA88899 Error requesting booking changes:",o),o}},g=async(e,t)=>{try{const o=await n.default.patch("".concat(a.API_BASE_URL,"/api/booking_drafts/v1/").concat(e,"/update_pets_and_services/"),t);return(0,r.debugLog)("MBA12345 Draft update response:",o.data),o.data}catch(o){throw(0,r.debugLog)("MBA12345 Error updating booking draft:",o),o}},h=async(e,t,o,i,s)=>{try{(0,r.debugLog)("MBA5asdt3f4321 - Updating booking draft time and date:",{draftId:e,startDate:t,endDate:o,startTime:i,endTime:s});const l=await n.default.post("".concat(a.API_BASE_URL,"/api/booking_drafts/v1/update-time-and-date/").concat(e,"/"),{start_date:t,end_date:o,start_time:i,end_time:s});return(0,r.debugLog)("MBA5asdt3f4321 - Booking draft time and date update response:",l.data),l.data}catch(l){throw(0,r.debugLog)("MBA5asdt3f4321 Error updating booking draft time and date:",l),l}},f=async(e,t,o)=>{try{const s=o?.timezone||"US/Mountain";(0,r.debugLog)("MBA8800: Updating booking draft multiple days:",{draftId:e,data:t,userTimezone:s});const l=t.dates.map((e=>{let o,n,a,l,d=!1;if(e.date&&e.start_time&&e.end_time)return(0,r.debugLog)("MBA8800: Using provided occurrence data format",e),{date:e.date,startTime:e.start_time,endDate:e.end_date||e.date,endTime:e.end_time,is_overnight:e.is_overnight||!1};if(e.date&&e.startTime&&e.endTime)return(0,r.debugLog)("MBA8800: Using provided date and times",e),{date:e.date,startTime:e.startTime,endDate:e.endDate||e.date,endTime:e.endTime,is_overnight:e.is_overnight||!1};if(!(e instanceof Date))throw(0,r.debugLog)("MBA8800: Unexpected date format",e),new Error("Unexpected date format");{o=(0,i.formatDateForAPI)(e);let s=t.times;const c=e.toISOString().split("T")[0];t.times[c]&&t.times.hasIndividualTimes&&(s=t.times[c]),n="string"===typeof s.startTime?s.startTime:void 0!==s.startTime?.hours?"".concat(String(s.startTime.hours).padStart(2,"0"),":").concat(String(s.startTime.minutes||0).padStart(2,"0")):"09:00",a="string"===typeof s.endTime?s.endTime:void 0!==s.endTime?.hours?"".concat(String(s.endTime.hours).padStart(2,"0"),":").concat(String(s.endTime.minutes||0).padStart(2,"0")):"17:00",(0,r.debugLog)("MBA8800: Formatted times for date:",c,{startTimeStr:n,endTimeStr:a});const u="00:00"===a,m=parseInt(a.split(":")[0],10)<parseInt(n.split(":")[0],10)||parseInt(a.split(":")[0],10)===parseInt(n.split(":")[0],10)&&parseInt(a.split(":")[1],10)<parseInt(n.split(":")[1],10),g=u||m,h=g?new Date(e.getTime()+864e5):new Date(e);l=(0,i.formatDateForAPI)(h),(0,r.debugLog)("MBA8800: End date calculation in API.js:",{needsNextDayDate:g,isMidnightEnd:u,isTimeBeforeStart:m,startTimeStr:n,endTimeStr:a,originalDate:o,calculatedEndDate:l}),d=s.isOvernightForced||!1}const{date:c,time:u}=(0,i.convertToUTC)(o,n,s),{date:m,time:g}=(0,i.convertToUTC)(l||o,a,s);return{date:c,startTime:u,endDate:m,endTime:g,is_overnight:d}}));(0,r.debugLog)("MBA8800: Converted UTC dates:",l);const d=await n.default.post("".concat(a.API_BASE_URL,"/api/booking_drafts/v1/update-multiple-days/").concat(e,"/"),{dates:l});return(0,r.debugLog)("MBA8800: Booking draft multiple days update response:",d.data),d.data}catch(s){throw(0,r.debugLog)("MBA8800: Error updating booking draft multiple days:",s),s}},p=async(e,t)=>{try{(0,r.debugLog)("MBA5asdt3f4321 - Updating booking draft recurring dates:",{draftId:e,recurringData:t});const o=await n.default.post("".concat(a.API_BASE_URL,"/api/booking_drafts/v1/update-recurring/").concat(e,"/"),t);return(0,r.debugLog)("MBA5asdt3f4321 - Booking draft recurring update response:",o.data),o.data}catch(o){throw(0,r.debugLog)("MBA5asdt3f4321 Error updating booking draft recurring dates:",o),o}},y=async()=>{try{return(await n.default.get("".concat(a.API_BASE_URL,"/api/users/v1/time-settings/"))).data}catch(e){throw(0,r.debugLog)("MBA12345 Error fetching time settings",e),e}},b=async e=>{try{const t="object"===typeof e?e:{timezone:e};(0,r.debugLog)("MBA12345 Sending time settings update",t);return(await n.default.post("".concat(a.API_BASE_URL,"/api/users/v1/update-time-settings/"),t)).data}catch(t){throw(0,r.debugLog)("MBA12345 Error updating time settings",t),t}},x=async()=>{try{return(await n.default.get("".concat(a.API_BASE_URL,"/api/users/v1/get-name/"))).data}catch(e){throw(0,r.debugLog)("MBA12345 Error fetching user name",e),e}},C=async()=>{try{(0,r.debugLog)("MBA12345","Fetching user profile data");const e=await n.default.get("".concat(a.API_BASE_URL,"/api/users/v1/profile/"));return(0,r.debugLog)("MBA12345","User profile data fetched successfully:",{name:e.data.name,email:e.data.email,address:e.data.address}),e.data}catch(e){throw(0,r.debugLog)("MBA12345","Error in userProfile:",e),e}},v=async e=>{try{(0,r.debugLog)("MBA76543","Updating profile info with data:",e);const t=e instanceof FormData;(0,r.debugLog)("MBA76543","Making ".concat(t?"FormData":"JSON"," request to update profile"));const o={method:"patch",url:"".concat(a.API_BASE_URL,"/api/users/v1/update-profile/"),data:e};t||(o.headers={"Content-Type":"application/json"});const i=await(0,n.default)(o);return(0,r.debugLog)("MBA76543","Profile updated successfully with response:",i.data),i.data}catch(t){throw(0,r.debugLog)("MBA76543","Error updating profile info:",t),t}},w=async e=>{try{(0,r.debugLog)("MBA789","Adding new pet with data:",e);const t=await n.default.post("".concat(a.API_BASE_URL,"/api/pets/v1/add-pet/"),e);return(0,r.debugLog)("MBA789","Pet added successfully:",t.data),t.data}catch(t){throw(0,r.debugLog)("MBA789","Error adding pet:",t),t}},j=async(e,t)=>{try{(0,r.debugLog)("MBA789","Updating pet with ID:",e,"and data:",t);const o=await n.default.patch("".concat(a.API_BASE_URL,"/api/pets/v1/").concat(e,"/"),t);return(0,r.debugLog)("MBA789","Pet updated successfully:",o.data),o.data}catch(o){throw(0,r.debugLog)("MBA789","Error updating pet:",o),o}},S=async e=>{try{(0,r.debugLog)("MBA789","Fixing owner for pet with ID:",e);const t=await n.default.post("".concat(a.API_BASE_URL,"/api/pets/v1/").concat(e,"/fix-owner/"),{});return(0,r.debugLog)("MBA789","Pet owner fixed successfully:",t.data),t.data}catch(t){throw(0,r.debugLog)("MBA789","Error fixing pet owner:",t),t}},T=async e=>{try{(0,r.debugLog)("MBA789","Deleting pet with ID:",e);const t=await n.default.delete("".concat(a.API_BASE_URL,"/api/pets/v1/").concat(e,"/"));return(0,r.debugLog)("MBA789","Pet deleted successfully:",t.data),t.data}catch(t){throw(0,r.debugLog)("MBA789","Error deleting pet:",t),t}},B=async e=>{try{(0,r.debugLog)("MBA54321","Creating new service - sending data to backend:",e);let t={};e.animal_types&&Array.isArray(e.animal_types)?e.animal_types.forEach((e=>{"object"===typeof e&&e.name&&e.category?t[e.name]=e.category:"string"===typeof e&&(t[e]="Other")})):e.animal_types&&"object"===typeof e.animal_types?t=e.animal_types:e.animal_type?t[e.animal_type]="Other":t.Other="Other";const o=(e.additional_rates||[]).map((e=>Object.assign({},e,{rate:String(e.rate)}))),i=Object.assign({},e,{base_rate:String(e.base_rate),additional_animal_rate:String(e.additional_animal_rate||0),holiday_rate:String(e.holiday_rate||0),animal_types:t,additional_rates:o});(0,r.debugLog)("MBA54321","Sending additional rates to backend:",i.additional_rates);const s=await n.default.post("".concat(a.API_BASE_URL,"/api/services/v1/create/"),i);return(0,r.debugLog)("MBA54321","Service created successfully - backend response:",s.data),s.data}catch(t){throw(0,r.debugLog)("MBA54321","Error creating service:",t),(0,r.debugLog)("MBA54321","Error response data:",t.response?.data),t}},k=async e=>{try{(0,r.debugLog)("MBA7890: Deleting service with ID:",e);const t=await n.default.delete("".concat(a.API_BASE_URL,"/api/services/v1/delete/").concat(e,"/"));return(0,r.debugLog)("MBA7890: Service deleted successfully - backend response:",t.data),t.data}catch(t){throw(0,r.debugLog)("MBA7890: Error deleting service:",t),(0,r.debugLog)("MBA7890: Error response data:",t.response?.data),t}},A=async e=>{try{(0,r.debugLog)("API updateService","Updating service with data:",e);const t=await n.default.patch("".concat(a.API_BASE_URL,"/api/services/v1/update/").concat(e.service_id,"/"),e);return(0,r.debugLog)("API updateService Response:",t.data),t.data}catch(t){throw(0,r.debugLog)("API updateService Error:",t.response?.data||t.message),t}},_=async(e=1)=>{try{(0,r.debugLog)("MBA4321 Fetching client connections, page:",e);const t=await n.default.get("".concat(a.API_BASE_URL,"/api/bookings/v1/connections/"),{params:{page:e}});return(0,r.debugLog)("MBA4321 Connections response:",t.data),t.data}catch(t){throw(0,r.debugLog)("MBA4321 Error fetching connections:",t),(0,r.debugLog)("MBA4321 Error details:",t.response?.data||t.message),t}},I=async(e,t="client")=>{try{(0,r.debugLog)("MBA4321 Fetching connection profile:",{userId:e,type:t});const o=await n.default.get("".concat(a.API_BASE_URL,"/api/connections/v1/profile/").concat(e,"/"),{params:{type:t}});return(0,r.debugLog)("MBA4321 Connection profile response:",o.data),o.data}catch(o){throw(0,r.debugLog)("MBA4321 Error fetching connection profile:",o),(0,r.debugLog)("MBA4321 Error details:",o.response?.data||o.message),o}},M=async(e="email",t=null)=>{try{(0,r.debugLog)("MBA4321 Inviting client:",{type:e,email:t});const o=await n.default.post("".concat(a.API_BASE_URL,"/api/users/v1/invitations/"),{type:e,email:t,is_professional_invite:!0});return(0,r.debugLog)("MBA4321 Invite client response:",o.data),o.data}catch(o){throw(0,r.debugLog)("MBA4321 Error inviting client:",o),(0,r.debugLog)("MBA4321 Error details:",o.response?.data||o.message),o}},D=async(e="email",t=null,o)=>{try{(0,r.debugLog)("MBA4321 Sending referral:",{type:e,email:t,referralType:o});const i=await n.default.post("".concat(a.API_BASE_URL,"/api/users/v1/invitations/"),{type:e,email:t,is_professional_invite:!1,referral_type:o});return(0,r.debugLog)("MBA4321 Send referral response:",i.data),i.data}catch(i){throw(0,r.debugLog)("MBA4321 Error sending referral:",i),(0,r.debugLog)("MBA4321 Error details:",i.response?.data||i.message),i}},R=async(e="all")=>{try{(0,r.debugLog)("MBA4321 Getting invitations:",{type:e});const t=await n.default.get("".concat(a.API_BASE_URL,"/api/users/v1/invitations/?type=").concat(e));return(0,r.debugLog)("MBA4321 Get invitations response:",t.data),t.data}catch(t){throw(0,r.debugLog)("MBA4321 Error getting invitations:",t),(0,r.debugLog)("MBA4321 Error details:",t.response?.data||t.message),t}},L=async e=>{try{(0,r.debugLog)("MBA4321 Getting invitation details:",{token:e});const t=await n.default.get("".concat(a.API_BASE_URL,"/api/users/v1/invitations/").concat(e,"/"));return(0,r.debugLog)("MBA4321 Get invitation details response:",t.data),t.data}catch(t){throw(0,r.debugLog)("MBA4321 Error getting invitation details:",t),(0,r.debugLog)("MBA4321 Error details:",t.response?.data||t.message),t}},z=async e=>{try{(0,r.debugLog)("MBA4321 Verifying invitation:",{token:e}),(0,r.debugLog)("MBA4321 Verification endpoint:","".concat(a.API_BASE_URL,"/api/users/v1/invitations/").concat(e,"/verify/"));const t=await n.default.get("".concat(a.API_BASE_URL,"/api/users/v1/invitations/").concat(e,"/verify/"));return(0,r.debugLog)("MBA4321 Verify invitation response:",t.data),t.data}catch(t){throw(0,r.debugLog)("MBA4321 Error verifying invitation:",t),(0,r.debugLog)("MBA4321 Error details:",t.response?.data||t.message),t}},P=async e=>{try{(0,r.debugLog)("MBA4321 Accepting invitation:",{token:e});const t=await n.default.post("".concat(a.API_BASE_URL,"/api/users/v1/invitations/").concat(e,"/accept/"));return(0,r.debugLog)("MBA4321 Accept invitation response:",t.data),t.data}catch(t){throw(0,r.debugLog)("MBA4321 Error accepting invitation:",t),(0,r.debugLog)("MBA4321 Error details:",t.response?.data||t.message),t}},F=async e=>{try{return(0,r.debugLog)("MBA4321 Deleting invitation:",{token:e}),await n.default.delete("".concat(a.API_BASE_URL,"/api/users/v1/invitations/").concat(e,"/")),(0,r.debugLog)("MBA4321 Delete invitation success"),!0}catch(t){throw(0,r.debugLog)("MBA4321 Error deleting invitation:",t),(0,r.debugLog)("MBA4321 Error details:",t.response?.data||t.message),t}},O=async e=>{try{(0,r.debugLog)("MBA4321 Resending invitation:",{token:e});const t=await n.default.post("".concat(a.API_BASE_URL,"/api/users/v1/invitations/").concat(e,"/resend/"));return(0,r.debugLog)("MBA4321 Resend invitation response:",t.data),t.data}catch(t){throw(0,r.debugLog)("MBA4321 Error resending invitation:",t),(0,r.debugLog)("MBA4321 Error details:",t.response?.data||t.message),t}},E=async(e,t)=>{try{(0,r.debugLog)("MBA98765 - Updating booking draft rates:",{draftId:e,occurrences:t});const o=await n.default.post("".concat(a.API_BASE_URL,"/api/booking_drafts/v1/update-rates/").concat(e,"/"),{occurrences:t});return(0,r.debugLog)("MBA98765 - Booking draft rates update response:",o.data),o.data}catch(o){throw(0,r.debugLog)("MBA98765 Error updating booking draft rates:",o),o}},W=async e=>{try{(0,r.debugLog)("MBA66777 - Creating booking from draft:",{conversationId:e});const t=await n.default.post("".concat(a.API_BASE_URL,"/api/bookings/v1/create-from-draft/"),{conversation_id:e});return(0,r.debugLog)("MBA66777 - Booking created from draft:",t.data),t.data}catch(t){throw(0,r.debugLog)("MBA66777 Error creating booking from draft:",t),t}},N=async e=>{try{(0,r.debugLog)("MBA9876: Fetching booking draft dates and times:",e);const t=await n.default.get("".concat(a.API_BASE_URL,"/api/booking_drafts/v1/").concat(e,"/dates_and_times/"));return(0,r.debugLog)("MBA9876: Draft dates and times fetched successfully"),t.data}catch(t){throw(0,r.debugLog)("MBA9876: Error fetching booking draft dates and times:",t),t}},H=async e=>{try{(0,r.debugLog)("MBA6428: Creating draft from booking:",{bookingId:e});const t=await n.default.post("".concat(a.API_BASE_URL,"/api/booking_drafts/v1/create-from-booking/").concat(e,"/"),{});return(0,r.debugLog)("MBA6428: Draft created successfully:",t.data),t.data}catch(t){if((0,r.debugLog)("MBA6428: Error creating draft from booking:",t),t.response?.data)return{error:!0,status:t.response.status,message:t.response.data.error||"Failed to create draft from booking",data:t.response.data};throw t}},U=async(e={})=>{try{(0,r.debugLog)("MBA9999","Searching professionals with params:",e);const t=await n.default.post("".concat(a.API_BASE_URL,"/api/professionals/v1/search/"),e);return(0,r.debugLog)("MBA9999","Professional search completed successfully"),t.data}catch(t){throw(0,r.debugLog)("MBA9999","Error searching professionals:",t.response?.data||t.message),t}},V=async e=>{try{(0,r.debugLog)("MBA9999","Getting detailed services for professional:",e);const t=await n.default.get("".concat(a.API_BASE_URL,"/api/professionals/v1/services/").concat(e,"/"));return(0,r.debugLog)("MBA9999","Professional services fetched successfully"),t.data}catch(t){throw(0,r.debugLog)("MBA9999","Error fetching professional services:",t.response?.data||t.message),t}},q=async e=>{try{(0,r.debugLog)("MBA3456","Creating conversation with professional:",e);const t=await n.default.post("".concat(a.API_BASE_URL,"/api/conversations/v1/create/"),{professional_id:e});return(0,r.debugLog)("MBA3456","Conversation created successfully:",t.data),t.data}catch(t){throw(0,r.debugLog)("MBA3456","Error creating conversation:",t.response?.data||t.message),t}},Y=async()=>{try{(0,r.debugLog)("MBA4321: Fetching unread message count");const e=await n.default.get("".concat(a.API_BASE_URL,"/api/messages/v1/unread-count/"));return(0,r.debugLog)("MBA4321: Unread count fetched:",e.data),e.data}catch(e){throw(0,r.debugLog)("MBA4321: Error with unread message count:",e.message),e}},G=async(e,t=1)=>{try{(0,r.debugLog)("MBA2349f87g9qbh2nfv9cg: Fetching messages for conversation ".concat(e,", page ").concat(t));const o=await n.default.get("".concat(a.API_BASE_URL,"/api/messages/v1/conversation/").concat(e,"/"),{params:{page:t}});return(0,r.debugLog)("MBA2349f87g9qbh2nfv9cg: Messages fetched successfully",{messageCount:o.data.messages?.length||0,hasNext:o.data.has_more,hasDraft:o.data.has_draft}),o.data}catch(o){throw(0,r.debugLog)("MBA2349f87g9qbh2nfv9cg: Error fetching messages for conversation ".concat(e,":"),o),o}}},45010:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>k,handleBack:()=>w,navigateToFrom:()=>j});var n=o(36665),a=o(73929),r=o(6283),i=o(73944),s=o(15648),l=o(26725),d=o(95991),c=o(40484),u=o(7869),m=o(6541),g=o(38432),h=o(59742),f=o(91087),p=o(16204),y=o(29483),b=o(95463),x=o(87744),C=o(15843),v=o(60397);const w=async e=>{try{const t=await(0,g.getStorage)("previousRoute"),o=await(0,g.getStorage)("currentRoute");if((0,g.debugLog)("MBAuieo2o34nf handleBack - routes from storage",{previousRoute:t,currentRoute:o}),t){const n=await(0,g.getStorage)("MyProfileActiveTab");(0,g.debugLog)("MBAuieo2o34nf handleBack - active tab from storage",{activeTab:n}),"MyProfile"===t&&n?e.navigate(t,{initialTab:n}):e.navigate(t),await(0,g.setStorage)("currentRoute",t),await(0,g.setStorage)("previousRoute",o),(0,g.debugLog)("MBAuieo2o34nf handleBack - navigation complete",{newCurrentRoute:t,newPreviousRoute:o})}else e.navigate("Dashboard"),(0,g.debugLog)("MBAuieo2o34nf handleBack - no previous route, going to More")}catch(t){(0,g.debugLog)("MBAuieo2o34nf handleBack - error",t),e.navigate("Dashboard")}},j=async(e,t,o,n={})=>{try{const a=await(0,g.getStorage)("currentRoute");if(await(0,g.setStorage)("previousRoute",a),"MyProfile"===t){const e=await(0,g.getStorage)("MyProfileActiveTab");e&&(n.initialTab=e)}e.navigate(t,n),await(0,g.setStorage)("currentRoute",t),(0,g.debugLog)("MBAuieo2o34nf navigateToFrom - navigation complete",{from:o,to:t,params:n,previousRoute:a,newCurrentRoute:t})}catch(a){(0,g.debugLog)("MBAuieo2o34nf navigateToFrom - error",a)}},S={code:'function anonymous(){const{size,color,line1TranslateY,line1Rotation}=this.__closure;return{width:size,height:3,backgroundColor:color,marginVertical:2,borderRadius:1.5,transform:[{translateY:line1TranslateY.value},{rotate:line1Rotation.value+"deg"}]};}'},T={code:"function anonymous(){const{size,color,line2Opacity}=this.__closure;return{width:size,height:3,backgroundColor:color,marginVertical:2,borderRadius:1.5,opacity:line2Opacity.value};}"},B={code:'function anonymous(){const{size,color,line3TranslateY,line3Rotation}=this.__closure;return{width:size,height:3,backgroundColor:color,marginVertical:2,borderRadius:1.5,transform:[{translateY:line3TranslateY.value},{rotate:line3Rotation.value+"deg"}]};}'};function k({state:e,descriptors:t,navigation:i}){const[w,k]=(0,n.useState)(!1),[_,I]=(0,n.useState)(l.default.get("window").width<900),[M,D]=(0,n.useState)(!1),{colors:R}=(0,p.useTheme)(),{isSignedIn:L,is_DEBUG:z,userRole:P,isCollapsed:F,setIsCollapsed:O,switchRole:E,screenWidth:W,signOut:N,isApprovedProfessional:H}=(0,n.useContext)(g.AuthContext),{hasUnreadMessages:U,unreadCount:V,resetNotifications:q,updateRoute:Y}=(0,n.useContext)(h.default),[G,J]=(0,n.useState)(""),[$,Z]=(0,n.useState)(3),K=(0,y.useSharedValue)(0),Q=(0,y.useSharedValue)(1),X=(0,y.useSharedValue)(0),ee=(0,y.useSharedValue)(0),te=(0,y.useSharedValue)(0),oe=({size:e=28,color:t=m.theme.colors.text})=>{const o=(0,b.useAnimatedStyle)(function(){const o=()=>({width:e,height:3,backgroundColor:t,marginVertical:2,borderRadius:1.5,transform:[{translateY:ee.value},{rotate:"".concat(K.value,"deg")}]});return o.__closure={size:e,color:t,line1TranslateY:ee,line1Rotation:K},o.__workletHash=1130445313934,o.__initData=S,o}()),n=(0,b.useAnimatedStyle)(function(){const o=()=>({width:e,height:3,backgroundColor:t,marginVertical:2,borderRadius:1.5,opacity:Q.value});return o.__closure={size:e,color:t,line2Opacity:Q},o.__workletHash=238094918771,o.__initData=T,o}()),r=(0,b.useAnimatedStyle)(function(){const o=()=>({width:e,height:3,backgroundColor:t,marginVertical:2,borderRadius:1.5,transform:[{translateY:te.value},{rotate:"".concat(X.value,"deg")}]});return o.__closure={size:e,color:t,line3TranslateY:te,line3Rotation:X},o.__workletHash=7555450561358,o.__initData=B,o}());return(0,v.jsxs)(a.default,{style:{alignItems:"center",justifyContent:"center"},children:[(0,v.jsx)(x.AnimatedView,{style:o}),(0,v.jsx)(x.AnimatedView,{style:n}),(0,v.jsx)(x.AnimatedView,{style:r})]})};(0,n.useEffect)((()=>{z&&console.log("MBA98386196v Navigation State Update:",{isSignedIn:L,userRole:P,isApprovedProfessional:H,currentRoute:G})}),[L,P,H,G]),(0,n.useEffect)((()=>{(e=>{const t=300;(0,g.debugLog)("MBA4477: Animating hamburger menu",{toX:e,isMenuOpen:M}),e?(K.value=(0,C.withTiming)(45,{duration:t}),Q.value=(0,C.withTiming)(0,{duration:t}),X.value=(0,C.withTiming)(-45,{duration:t}),ee.value=(0,C.withTiming)(7,{duration:t}),te.value=(0,C.withTiming)(-7,{duration:t})):(K.value=(0,C.withTiming)(0,{duration:t}),Q.value=(0,C.withTiming)(1,{duration:t}),X.value=(0,C.withTiming)(0,{duration:t}),ee.value=(0,C.withTiming)(0,{duration:t}),te.value=(0,C.withTiming)(0,{duration:t}))})(M)}),[M]);const ne=()=>D(!M);(0,n.useEffect)((()=>{const e=l.default.addEventListener("change",(()=>{I(l.default.get("window").width<900)}));return()=>{e?.remove()}}),[]),(0,n.useEffect)((()=>{const e=async()=>{try{let e;e=await(0,g.getStorage)("currentRoute"),z&&e!==G&&console.log("MBA98386196v Current Route Updated:",e),e&&e!==G&&(J(e),Y&&Y(e),"MessageHistory"===e&&U&&q&&q(e))}catch(e){console.error("Error updating current route:",e)}};e();return i.addListener("state",e)}),[i,q,Y,U,z]),(0,n.useEffect)((()=>{if("web"===d.default.OS){const e=async()=>{const e=await(0,g.getStorage)("currentRoute");(0,g.debugLog)("MBAuieo2o34nf popstate detected, updating currentRoute from storage",{route:e}),e&&e!==G&&(J(e),Y&&Y(e))};return window.addEventListener("popstate",e),()=>window.removeEventListener("popstate",e)}}),[G,Y]),(0,n.useEffect)((()=>i.addListener("state",(async()=>{try{const e=i.getState&&i.getState();let t="";if(e){const o=e.routes[e.index];t=o?.name||""}t&&(await(0,g.setStorage)("currentRoute",t),(0,g.debugLog)("MBAuieo2o34nf navigation state change - set currentRoute in storage",{routeName:t}),J(t),Y&&Y(t))}catch(e){(0,g.debugLog)("MBAuieo2o34nf error updating currentRoute in storage",e)}}))),[i,Y]);const ae=async(e,t=null)=>{k(!1),z&&(console.log("MBA98386196v Navigating to:",e,t?"with tab: ".concat(t):""),console.log("MBA98386196v Current route before:",G));try{if(e===G)return void("MessageHistory"===e&&U&&q&&q());(0,g.setStorage)("previousRoute",G),(0,g.setStorage)("currentRoute",e),J(e),Y&&Y(e),"MessageHistory"===e&&U&&q&&q(),t?j(i,e,G,{screen:t}):j(i,e,G),z&&console.log("MBA98386196v Current route after:",e)}catch(o){console.error("Error handling navigation:",o),j(i,e,G)}};(0,n.useEffect)((()=>{(async()=>{try{if(!await(0,g.getStorage)("currentRoute")){const e=L?"Dashboard":"Home";await(0,g.setStorage)("currentRoute",e)}}catch(e){console.error("Error initializing route tracking:",e)}})()}),[L,P]);const re=async e=>{try{const t=G;switch(z&&console.log("MBA98386196v Role switch initiated:",{from:P,to:e,currentScreen:t}),await E(e),await(0,g.setStorage)("userRole",e),t){case"MyProfile":const o=i.getState().routes.find((e=>"MyProfile"===e.name))?.params,n=o?.screen||o?.initialTab||"profile_info";z&&console.log("MBA98386196v MyProfile tab preservation:",{currentTab:n,newRole:e});let a=n;"petOwner"===e&&"services_availability"===n&&(a="profile_info"),j(i,"MyProfile",t,{screen:a});break;case"MessageHistory":j(i,"MessageHistory",t);break;case"MyBookings":const r="professional"===e?"professional":"owner";z&&console.log("MBA98386196v MyBookings tab switch:",{newRole:e,activeTab:r}),j(i,"MyBookings",t,{screen:r});break;case"Connections":const s="professional"===e?"clients":"professionals";z&&console.log("MBA98386196v Connections tab switch:",{newRole:e,connectionsTab:s}),j(i,"Connections",t,{screen:s});break;case"Dashboard":j(i,"Dashboard",t);break;case"SearchProfessionalsListing":j(i,"professional"===e?"Dashboard":t,t);break;case"ServiceManager":j(i,"petOwner"===e?"Dashboard":t,t);break;default:j(i,t,t)}}catch(t){console.error("Error switching role:",t)}},ie=async()=>{try{z&&console.log("MBA98386196v Logging out user"),await N(),"web"===d.default.OS?(sessionStorage.removeItem("currentRoute"),sessionStorage.removeItem("previousRoute"),sessionStorage.removeItem("userRole")):(await f.default.removeItem("currentRoute"),await f.default.removeItem("previousRoute"),await f.default.removeItem("userRole")),J(""),i.navigate("SignIn")}catch(e){console.error("Error during logout:",e)}},se=()=>L?"professional"===P?[{title:"Dashboard",icon:"view-dashboard",route:"Dashboard"},{title:"Messages",icon:"message-text",route:"MessageHistory"},{title:"Services",icon:"briefcase",route:"ServiceManager"},{title:"Connections",icon:"account-group",route:"Connections"},{title:"Profile",icon:"account",route:"MyProfile",tab:"profile_info"},{title:"Contact Us",icon:"help-circle",route:"ContactUs"}]:[{title:"Dashboard",icon:"view-dashboard",route:"Dashboard"},{title:"Messages",icon:"message-text",route:"MessageHistory"},{title:"Search Pros",icon:"magnify",route:"SearchProfessionalsListing"},{title:"Profile",icon:"account",route:"MyProfile",tab:"profile_info"},{title:"Contact Us",icon:"help-circle",route:"ContactUs"}]:[{title:"Sign In",icon:"login",route:"SignIn"},{title:"Sign Up",icon:"account-plus",route:"SignUp"},{title:"Search Pros",icon:"magnify",route:"SearchProfessionalsListing"}];return(0,v.jsx)(v.Fragment,{children:"web"===d.default.OS?(0,v.jsxs)(v.Fragment,{children:[!_&&L&&(0,v.jsx)(a.default,{style:A.navContainer,children:(()=>{const e=se(),t=F?70:250,n="professional"===P,i="petOwner"===P;return z&&console.log("MBA98386196v Rendering Sidebar:",{userRole:P,isApprovedProfessional:H,currentRoute:G,isProfessionalRole:n,isOwnerRole:i}),(0,v.jsxs)(a.default,{style:[A.sidebarContainer,{width:t}],children:[(0,v.jsx)(a.default,{style:A.sidebarLogoContainer,children:(0,v.jsx)(s.default,{onPress:()=>ae("Home","Overview"),style:A.logoButton,children:(0,v.jsx)(c.default,{source:o(18827),style:[A.sidebarLogo,{width:F?40:150,tintColor:m.theme.colors.primary}],resizeMode:"contain"})})}),(0,v.jsx)(s.default,{style:A.collapseButton,onPress:()=>O(!F),children:(0,v.jsx)(u.default,{name:F?"chevron-right":"chevron-left",size:24,color:m.theme.colors.primary})}),(0,v.jsxs)(a.default,{style:A.menuItems,children:[!F&&(0,v.jsxs)(a.default,{style:A.roleToggleContainer,children:[(0,v.jsx)(r.default,{style:A.roleToggleTitle,children:"Switch Role:"}),(0,v.jsxs)(a.default,{style:A.roleButtonsContainer,children:[(0,v.jsx)(s.default,{style:[A.roleButton,i&&A.roleButtonActive],onPress:()=>{z&&console.log("MBA98386196v Owner Role Button Press:",{currentRole:P,isApprovedProfessional:H}),n&&re("petOwner")},activeOpacity:.7,children:(0,v.jsx)(r.default,{style:[A.roleButtonText,i&&A.roleButtonTextActive],children:"Owner"})}),(0,v.jsx)(s.default,{style:[A.roleButton,n&&A.roleButtonActive,!H&&A.roleButtonDisabled],onPress:()=>{z&&console.log("MBA98386196v Professional Role Button Press:",{currentRole:P,isApprovedProfessional:H}),i&&H&&re("professional")},disabled:!H,activeOpacity:H?.7:1,children:(0,v.jsx)(r.default,{style:[A.roleButtonText,n&&A.roleButtonTextActive,!H&&A.roleButtonTextDisabled],children:"Professional"})})]})]}),e.map(((e,t)=>{const o=G===e.route||"More"===e.route&&"Settings"===e.title&&"More"===G,n="Messages"===e.title&&U;return(0,v.jsxs)(s.default,{style:[A.sidebarItem,o&&A.activeItem],onPress:()=>ae(e.route,e.tab||"Overview"),children:[(0,v.jsxs)(a.default,{style:{position:"relative"},children:[(0,v.jsx)(u.default,{name:e.icon,size:24,color:o?m.theme.colors.primary:"#4B5563"}),n&&(0,v.jsx)(a.default,{style:A.messageNotificationBadge,children:V>0&&(0,v.jsx)(r.default,{style:A.messageNotificationText,children:V})})]}),!F&&(0,v.jsxs)(r.default,{style:[A.sidebarItemText,{color:o?m.theme.colors.primary:"#4B5563"}],children:[e.title,"Messages"===e.title&&U&&V>0&&(0,v.jsx)(r.default,{style:{color:m.theme.colors.error},children:" (".concat(V,")")})]})]},t)}))]}),(0,v.jsxs)(s.default,{style:[A.logoutButton,{width:t}],onPress:ie,children:[(0,v.jsx)(u.default,{name:"logout",size:24,color:"#F26969"}),!F&&(0,v.jsx)(r.default,{style:A.logoutText,children:"Logout"})]})]})})()}),(_||!L)&&(()=>{const e=W<=470?{width:100,height:30}:{width:150,height:40},t="professional"===P,n="petOwner"===P;return(0,v.jsxs)(a.default,{style:[A.mobileHeader,{backgroundColor:m.theme.colors.surfaceContrast}],children:[(0,v.jsxs)(a.default,{style:A.mobileHeaderContent,children:[(0,v.jsx)(s.default,{onPress:()=>ae("Home","Overview"),style:A.logoButton,children:(0,v.jsx)(c.default,{source:o(18827),style:[A.mobileLogo,{tintColor:m.theme.colors.primary},e]})}),(0,v.jsx)(a.default,{style:A.mobileRightContent,children:(0,v.jsx)(s.default,{onPress:ne,style:A.profileContainer,children:(0,v.jsx)(a.default,{style:A.hamburgerMenuContainer,children:(0,v.jsx)(oe,{size:28,color:m.theme.colors.text})})})})]}),M&&(0,v.jsxs)(a.default,{style:[A.mobileMenu,{backgroundColor:m.theme.colors.surfaceContrast}],children:[L&&(0,v.jsxs)(a.default,{style:A.mobileRoleToggleContainer,children:[(0,v.jsx)(r.default,{style:A.mobileRoleToggleTitle,children:"Switch Role:"}),(0,v.jsxs)(a.default,{style:A.mobileRoleButtonsContainer,children:[(0,v.jsx)(s.default,{style:[A.mobileRoleButton,n&&A.mobileRoleButtonActive],onPress:()=>{z&&console.log("MBA98386196v Mobile Owner Role Button Press:",{currentRole:P,isApprovedProfessional:H}),t&&(re("petOwner"),D(!1))},activeOpacity:.7,children:(0,v.jsx)(r.default,{style:[A.mobileRoleButtonText,n&&A.mobileRoleButtonTextActive],children:"Owner"})}),(0,v.jsx)(s.default,{style:[A.mobileRoleButton,t&&A.mobileRoleButtonActive,!H&&A.mobileRoleButtonDisabled],onPress:()=>{z&&console.log("MBA98386196v Mobile Professional Role Button Press:",{currentRole:P,isApprovedProfessional:H}),n&&H&&(re("professional"),D(!1))},disabled:!H,activeOpacity:H?.7:1,children:(0,v.jsx)(r.default,{style:[A.mobileRoleButtonText,t&&A.mobileRoleButtonTextActive,!H&&A.mobileRoleButtonTextDisabled],children:"Professional"})})]})]}),se().map(((e,t)=>{const o="Messages"===e.title&&U;return(0,v.jsxs)(s.default,{style:A.mobileMenuItem,onPress:()=>{ae(e.route,e.tab||"Overview"),D(!1)},children:[(0,v.jsxs)(a.default,{style:{flexDirection:"row",alignItems:"center",position:"relative"},children:[(0,v.jsx)(u.default,{name:e.icon,size:24,color:m.theme.colors.text}),o&&(0,v.jsx)(a.default,{style:A.mobileMessageNotificationBadge,children:V>0&&(0,v.jsx)(r.default,{style:A.mobileMessageNotificationText,children:V})})]}),(0,v.jsxs)(r.default,{style:A.mobileMenuItemText,children:[e.title,"Messages"===e.title&&U&&V>0&&(0,v.jsx)(r.default,{style:{color:m.theme.colors.error},children:" (".concat(V,")")})]})]},t)})),L&&(0,v.jsxs)(s.default,{style:[A.mobileMenuItem,A.mobileLogoutItem],onPress:()=>{ie(),D(!1)},children:[(0,v.jsx)(u.default,{name:"logout",size:24,color:"#F26969"}),(0,v.jsx)(r.default,{style:[A.mobileMenuItemText,A.mobileLogoutText],children:"Logout"})]})]})]})})()]}):(0,v.jsx)(a.default,{style:A.container,children:(()=>{const e=se(),t=l.default.get("window").width/e.length;return(0,v.jsx)(a.default,{style:[A.customNavBar,{backgroundColor:m.theme.colors.surfaceContrast}],children:e.map(((e,o)=>(0,v.jsxs)(s.default,{style:[A.navButton,{width:t}],onPress:()=>ae(e.route,e.tab),children:[(0,v.jsx)(u.default,{name:e.icon,size:24,color:m.theme.colors.text}),(0,v.jsx)(r.default,{style:[A.navText,{color:m.theme.colors.text}],numberOfLines:2,ellipsizeMode:"tail",children:e.title})]},o)))})})()})})}const A=i.default.create({container:{display:"flex",backgroundColor:m.theme.colors.primary},content:{flex:1},header:{backgroundColor:m.theme.colors.primary},titleContainer:{justifyContent:"center"},titleContainer2:{flex:1,justifyContent:"center",flexDirection:"row",justifyContent:"flex-start"},title:{textAlign:"left",marginLeft:m.theme.spacing.medium,fontSize:m.theme.fontSizes.large,color:m.theme.colors.text,fontWeight:"bold",fontFamily:m.theme.fonts.header.fontFamily},desktopNav:{flexDirection:"row",justifyContent:"flex-end",alignItems:"center"},navItem:{marginHorizontal:m.theme.spacing.medium,fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,cursor:"pointer",fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"600"},customNavBar:{flexDirection:"row",justifyContent:"space-around",alignItems:"center",backgroundColor:m.theme.colors.primary,position:"absolute",bottom:0,left:0,right:0,paddingVertical:10,borderTopWidth:1,borderTopColor:m.theme.colors.border},navButton:{alignItems:"center",justifyContent:"center",height:60,paddingHorizontal:5},navText:{color:m.theme.colors.whiteText,fontSize:m.theme.fontSizes.small,marginTop:5,textAlign:"center",fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"600"},webNavItem:{marginHorizontal:m.theme.spacing.medium},webNavText:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.whiteText,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"600"},navLinkContainer:{flexDirection:"row",alignItems:"center",marginHorizontal:6},sidebarContainer:{height:"100%",minHeight:"100vh",backgroundColor:m.theme.colors.surfaceContrast,borderRightWidth:0,position:"fixed",left:0,top:0,bottom:0,zIndex:1e3,display:"flex",flexDirection:"column",transition:"width 0.3s ease",borderTopRightRadius:24,borderBottomRightRadius:24},sidebarLogoContainer:{padding:16,borderBottomWidth:3,borderBottomColor:m.theme.colors.surface,alignItems:"center",backgroundColor:m.theme.colors.surfaceContrast},logoButton:{alignItems:"center"},sidebarLogo:{height:50,resizeMode:"contain"},collapseButton:{position:"absolute",right:-16,top:"50%",transform:[{translateY:-20}],width:32,height:40,backgroundColor:m.theme.colors.surfaceContrast,borderWidth:0,borderRadius:8,justifyContent:"center",alignItems:"center",zIndex:1001},menuItems:{flex:1,padding:16,backgroundColor:m.theme.colors.surfaceContrast},sidebarItem:{flexDirection:"row",alignItems:"center",padding:12,marginBottom:8,borderRadius:8,backgroundColor:"transparent",cursor:"pointer"},sidebarItemText:{marginLeft:12,fontSize:m.theme.fontSizes.medium,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"500"},logoutButton:{width:"100%",padding:16,flexDirection:"row",alignItems:"center",borderTopWidth:0,backgroundColor:m.theme.colors.surfaceContrast,borderBottomRightRadius:24},logoutText:{marginLeft:12,fontSize:m.theme.fontSizes.medium,color:"#F26969",fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"500"},headerRight:{flexDirection:"row",alignItems:"center",gap:16,marginRight:16},notificationButton:{position:"relative",padding:8},notificationBadge:{position:"absolute",top:4,right:4,backgroundColor:m.theme.colors.error,borderRadius:10,minWidth:20,height:20,justifyContent:"center",alignItems:"center"},notificationCount:{color:m.theme.colors.whiteText,fontSize:12,fontWeight:"bold"},profileButton:{borderRadius:20,overflow:"hidden"},menuContent:{marginTop:45},mobileHeader:{width:"100%",paddingVertical:10,paddingHorizontal:20,borderBottomWidth:1,borderBottomColor:"rgba(255,255,255,0.1)",position:"relative"},mobileHeaderContent:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:"100%"},mobileLogo:{resizeMode:"contain"},mobileRightContent:{flexDirection:"row",alignItems:"center",gap:15},mobileMenu:{position:"absolute",top:"100%",right:20,backgroundColor:m.theme.colors.surface,borderRadius:8,padding:8,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:3.84,elevation:5,zIndex:1e3,minWidth:200},mobileMenuItem:{flexDirection:"row",alignItems:"center",padding:12,borderRadius:8},mobileMenuItemText:{marginLeft:12,fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},profileContainer:{width:44,height:44,borderRadius:22,overflow:"hidden",justifyContent:"center",alignItems:"center"},iconButton:{padding:8,position:"relative"},notificationText:{color:m.theme.colors.whiteText,fontSize:12,fontWeight:"bold"},navContainer:{position:"fixed",top:0,left:0,bottom:0,zIndex:1e3,backgroundColor:m.theme.colors.surface,borderRightWidth:1,borderRightColor:m.theme.colors.border},activeItem:{backgroundColor:"#F0F9E5"},roleToggleContainer:{padding:12,marginBottom:16,borderRadius:8,backgroundColor:"#F0F9E5"},roleToggleTitle:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"600",marginBottom:8},roleButtonsContainer:{flexDirection:"row",gap:8},roleButton:{flex:1,padding:8,borderRadius:6,alignItems:"center",justifyContent:"center",borderWidth:1,borderColor:m.theme.colors.primary,cursor:"pointer"},roleButtonDisabled:{opacity:.5,borderColor:m.theme.colors.border,cursor:"not-allowed"},roleButtonText:{fontSize:m.theme.fontSizes.small,fontFamily:m.theme.fonts.regular.fontFamily,color:m.theme.colors.primary},roleButtonTextDisabled:{color:m.theme.colors.border},roleButtonActive:{backgroundColor:m.theme.colors.primary},roleButtonTextActive:{color:m.theme.colors.surface},mobileRoleToggleContainer:{padding:16,marginBottom:8,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},mobileRoleToggleTitle:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"600",marginBottom:8},mobileRoleButtonsContainer:{flexDirection:"row",gap:8},mobileRoleButton:{flex:1,padding:8,borderRadius:6,alignItems:"center",justifyContent:"center",borderWidth:1,borderColor:m.theme.colors.primary},mobileRoleButtonDisabled:{opacity:.5,borderColor:m.theme.colors.border},mobileRoleButtonText:{fontSize:m.theme.fontSizes.small,fontFamily:m.theme.fonts.regular.fontFamily,color:m.theme.colors.primary},mobileRoleButtonTextDisabled:{color:m.theme.colors.border},mobileRoleButtonActive:{backgroundColor:m.theme.colors.primary},mobileRoleButtonTextActive:{color:m.theme.colors.surface},mobileLogoutItem:{borderTopWidth:1,borderTopColor:m.theme.colors.border,marginTop:8},mobileLogoutText:{color:"#F26969"},messageNotificationDot:{position:"absolute",top:-2,right:-2,width:10,height:10,borderRadius:5,backgroundColor:m.theme.colors.error,borderWidth:1,borderColor:m.theme.colors.surface},mobileMessageNotificationDot:{position:"absolute",top:-2,right:-2,width:8,height:8,borderRadius:4,backgroundColor:m.theme.colors.error,borderWidth:1,borderColor:m.theme.colors.surfaceContrast},messageNotificationBadge:{position:"absolute",top:-8,right:-8,minWidth:18,height:18,borderRadius:9,backgroundColor:m.theme.colors.error,borderWidth:1,borderColor:m.theme.colors.surface,justifyContent:"center",alignItems:"center",paddingHorizontal:2},messageNotificationText:{color:"white",fontSize:10,fontWeight:"bold"},mobileMessageNotificationBadge:{position:"absolute",top:-8,right:-8,minWidth:16,height:16,borderRadius:8,backgroundColor:m.theme.colors.error,borderWidth:1,borderColor:m.theme.colors.surfaceContrast,justifyContent:"center",alignItems:"center",paddingHorizontal:2},mobileMessageNotificationText:{color:"white",fontSize:9,fontWeight:"bold"},hamburgerMenuContainer:{width:28,height:28,justifyContent:"center",alignItems:"center"}})},19620:(e,t,o)=>{"use strict";o.r(t),o.d(t,{API_BASE_URL:()=>s});var n=o(95991);const a=(e,t)=>{console.log("MBA1234: Current process.env.NODE_ENV:","staging"),t?console.log(e,t):console.log(e)};console.log("MBA1234: All environment variables:",{NODE_ENV:"staging",process_env_NODE_ENV:"staging",STAGING_API_BASE_URL_ANDROID:"https://staging-ec2.crittrcove.com",STAGING_API_BASE_URL_IOS:"https://staging-ec2.crittrcove.com",STAGING_API_BASE_URL_WEB:"https://staging-ec2.crittrcove.com",PRODUCTION_API_BASE_URL_ANDROID:"http://localhost:8000",PRODUCTION_API_BASE_URL_IOS:"http://localhost:8000",PRODUCTION_API_BASE_URL_WEB:"http://localhost:8000",DEV_API_BASE_URL_ANDROID:"http://10.0.2.2:8000",DEV_API_BASE_URL_IOS:"http://127.0.0.1:8000",DEV_API_BASE_URL_WEB:"http://localhost:8000",platform:n.default.OS}),a("MBA1234: Environment Variables Loaded",{NODE_ENV:"staging",STAGING_API_BASE_URL_ANDROID:"https://staging-ec2.crittrcove.com",STAGING_API_BASE_URL_IOS:"https://staging-ec2.crittrcove.com",STAGING_API_BASE_URL_WEB:"https://staging-ec2.crittrcove.com",PRODUCTION_API_BASE_URL_ANDROID:"http://localhost:8000",PRODUCTION_API_BASE_URL_IOS:"http://localhost:8000",PRODUCTION_API_BASE_URL_WEB:"http://localhost:8000",DEV_API_BASE_URL_ANDROID:"http://10.0.2.2:8000",DEV_API_BASE_URL_IOS:"http://127.0.0.1:8000",DEV_API_BASE_URL_WEB:"http://localhost:8000",platform:n.default.OS});const r=!1,i=!0;let s;a("MBA1234: Environment Configuration",{NODE_ENV:"staging",isDevelopment:r,isStaging:i,isProduction:!1,platform:n.default.OS}),s=("android"===n.default.OS||n.default.OS,"https://staging-ec2.crittrcove.com"),a("MBA1234: Selected API Base URL",{API_BASE_URL:s})},38432:(e,t,o)=>{"use strict";o.r(t),o.d(t,{AuthContext:()=>x,AuthProvider:()=>S,IsProduction:()=>j,SCREEN_HEIGHT:()=>h,SCREEN_WIDTH:()=>g,debugLog:()=>y,getStorage:()=>C,setDebugEnabled:()=>p,setStorage:()=>v});var n=o(36665),a=o(91087),r=o(77109),i=o(19620),s=o(26725),l=o(95991),d=o(52532),c=o(45010),u=o(50294),m=o(60397);const g=s.default.get("window").width,h=s.default.get("window").height;let f=!0;const p=e=>{f=e},y=(e,...t)=>{f&&!e.includes("MBA3210")&&(t.length>0?console.log("".concat(e,":"),...t):console.log("".concat(e)))};class b{constructor(){this.accessToken=null,this.refreshToken=null,this.isRefreshing=!1,this.refreshSubscribers=[],this.tokenExpiryTime=null,this.lastValidation=null,this.authStateCallbacks=new Set,this.isSigningOut=!1,this.lastTokenCheck=0,this.TOKEN_REFRESH_THRESHOLD=1e4,this.TOKEN_PREEMPTIVE_REFRESH=3e3,this.VALIDATION_CACHE_TIME=3e4}onAuthStateChange(e){return this.authStateCallbacks.add(e),()=>this.authStateCallbacks.delete(e)}notifyAuthStateChange(e){y("MBA1111 Notifying auth state change:",e),this.authStateCallbacks.forEach((t=>{try{t(e)}catch(o){console.error("MBA1111 Error in auth state callback:",o)}}))}parseJwt(e){try{if(!e)return null;const t=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/");let o;return o="function"===typeof atob?decodeURIComponent(atob(t).split("").map((e=>"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2))).join("")):decodeURIComponent(Buffer.from(t,"base64").toString("binary").split("").map((e=>"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2))).join("")),JSON.parse(o)}catch(t){return console.error("MBA1111 Error parsing JWT:",t),null}}getTimeUntilExpiry(e){const t=this.parseJwt(e);if(!t||!t.exp)return 0;const o=1e3*t.exp;return this.tokenExpiryTime=o,o-Date.now()}shouldRefreshToken(e){if(!e)return!1;const t=this.getTimeUntilExpiry(e),o=t<this.TOKEN_REFRESH_THRESHOLD&&t>0;return o&&y("MBA1111 Token should be refreshed - expires in ".concat(Math.round(t/1e3)," seconds")),o}async refreshTokens(){y("MBA1111 refreshTokens called");try{if(this.isRefreshing)return y("MBA1111 Token refresh already in progress, subscribing"),new Promise(((e,t)=>{this.refreshSubscribers.push({resolve:e,reject:t}),setTimeout((()=>{const o=this.refreshSubscribers.findIndex((t=>t.resolve===e));-1!==o&&(this.refreshSubscribers.splice(o,1),t(new Error("Token refresh timeout")))}),1e4)}));if(this.isRefreshing=!0,this.refreshSubscribers=[],!this.refreshToken)throw new Error("No refresh token available");if(this.getTimeUntilExpiry(this.refreshToken)<=0)throw y("MBA1111 Refresh token is expired, cannot refresh"),new Error("Refresh token expired");const e=Date.now();y("MBA1111 Making refresh token request to backend");const t=await fetch("".concat(i.API_BASE_URL,"/api/token/refresh/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh:this.refreshToken})});if(!t.ok){const e=await t.json().catch((()=>({})));throw y("MBA1111 Token refresh failed with status:",t.status,e),new Error("Token refresh failed: ".concat(t.status))}const o=await t.json(),{access:n,refresh:a}=o;if(!n)throw new Error("No access token in refresh response");this.accessToken=n,a&&(y("MBA1111 New refresh token received, updating stored refresh token"),this.refreshToken=a,await v("refreshToken",a)),await v("userToken",n);const r=Date.now()-e;return y("MBA1111 Token refresh successful in ".concat(r,"ms")),this.refreshSubscribers.forEach((({resolve:e})=>{try{e(n)}catch(t){y("MBA1111 Error resolving refresh subscriber:",t)}})),n}catch(e){throw y("MBA1111 Token refresh failed:",e),this.refreshSubscribers.forEach((({reject:t})=>{try{t(e)}catch(o){y("MBA1111 Error rejecting refresh subscriber:",o)}})),await this.clearTokens(),e}finally{this.isRefreshing=!1,this.refreshSubscribers=[],y("MBA1111 Token refresh process completed")}}async getAccessToken(){if(this.isSigningOut)return y("MBA1111 getAccessToken: signing out, returning null"),null;if(this.accessToken){this.getTimeUntilExpiry(this.accessToken)<=0&&(y("MBA1111 getAccessToken: current token is expired, clearing it"),this.accessToken=null)}if(!this.accessToken&&this.refreshToken){y("MBA1111 getAccessToken: no access token but have refresh token, attempting refresh");try{await this.refreshTokens()}catch(e){return y("MBA1111 getAccessToken: failed to refresh token:",e),null}}if(this.accessToken&&this.shouldRefreshToken(this.accessToken)){if(this.getTimeUntilExpiry(this.accessToken)>0){y("MBA1111 getAccessToken: token needs refresh but still valid, attempting refresh");try{await this.refreshTokens()}catch(e){return y("MBA1111 getAccessToken: failed to refresh token:",e),this.getTimeUntilExpiry(this.accessToken)>0?(y("MBA1111 getAccessToken: refresh failed but token still valid, returning current token"),this.accessToken):null}}}if(this.accessToken){return this.getTimeUntilExpiry(this.accessToken)>0?this.accessToken:(y("MBA1111 getAccessToken: token is expired, returning null"),this.accessToken=null,null)}return y("MBA1111 getAccessToken: returning null, no token available"),null}async validateToken(e){const t=Date.now();if(this.lastValidation&&t-this.lastValidation<this.VALIDATION_CACHE_TIME){y("MBA1111 Using cached token validation");return this.getTimeUntilExpiry(e)>0}y("MBA1111 Performing server-side token validation");try{const o=await r.default.post("".concat(i.API_BASE_URL,"/api/token/verify/"),{token:e});return this.lastValidation=t,200===o.status}catch(o){return y("MBA1111 Token validation failed:",o.response?.status),!1}}async clearTokens(){y("MBA1111 Clearing tokens");try{"web"===l.default.OS?(sessionStorage.removeItem("userToken"),sessionStorage.removeItem("refreshToken")):await a.default.multiRemove(["userToken","refreshToken"]),this.accessToken=null,this.refreshToken=null,y("MBA1111 Tokens cleared successfully")}catch(e){console.error("MBA1111 Error clearing tokens:",e)}}async setTokens(e,t){y("MBA1111 Setting tokens");try{this.accessToken=e,this.refreshToken=t,"web"===l.default.OS?(sessionStorage.setItem("userToken",e),sessionStorage.setItem("refreshToken",t)):await a.default.multiSet([["userToken",e],["refreshToken",t]]),y("MBA1111 Tokens set successfully")}catch(o){throw console.error("MBA1111 Error setting tokens:",o),o}}async initialize(){y("MBA1111 Starting AuthService.initialize()");try{let t,o;if(t=await C("userToken"),o=await C("refreshToken"),this.accessToken=t,this.refreshToken=o,y("MBA1111 Tokens retrieved:",{hasAccessToken:!!this.accessToken,hasRefreshToken:!!this.refreshToken}),this.accessToken&&this.shouldRefreshToken(this.accessToken)){y("MBA1111 Token needs refresh during init");try{await this.refreshTokens()}catch(e){y("MBA1111 Failed to refresh token during init:",e)}}return{hasAccessToken:!!this.accessToken,hasRefreshToken:!!this.refreshToken}}catch(t){return console.error("MBA1111 Error in AuthService.initialize():",t),{hasAccessToken:!1,hasRefreshToken:!1}}}forceSignOut(e){this.isSigningOut||(y("MBA1111 Force sign out triggered. Reason: ".concat(e)),this.isSigningOut=!0,this.notifyAuthStateChange({type:"FORCE_SIGN_OUT",reason:e,timestamp:(new Date).toISOString()}))}}const x=(0,n.createContext)(),C=async e=>{try{if("web"===l.default.OS){return sessionStorage.getItem(e)}return await a.default.getItem(e)}catch(t){return console.error("MBA1111 Error getting from storage:",t),null}},v=async(e,t)=>{try{"web"===l.default.OS?(sessionStorage.setItem(e,t),y("MBA1111 setStorage web:",{key:e,value:t})):(await a.default.setItem(e,t),y("MBA1111 setStorage mobile:",{key:e,value:t}))}catch(o){console.error("MBA1111 Error setting storage:",o)}},w=!1,j=()=>w,S=({children:e})=>{const t=(0,n.useRef)(new b),g=(0,n.useRef)(!1),h=(0,n.useRef)(null),[f,p]=(0,n.useState)(!1),[v,j]=(0,n.useState)(null),[S,T]=(0,n.useState)(!1),[B,k]=(0,n.useState)(!0),[A,_]=(0,n.useState)(s.default.get("window").width),[I,M]=(0,n.useState)(""),[D,R]=(0,n.useState)(""),[L,z]=(0,n.useState)(!1),[P,F]=(0,n.useState)({timezone:"UTC",timezone_abbrev:"UTC",use_military_time:!1}),[O,E]=(0,n.useState)(!1),[W,N]=(0,n.useState)(!0),H=async(e="user_action")=>{y("MBA1111 signOut called with reason:",e);try{if(t.current.isSigningOut)return void y("MBA1111 Sign out already in progress, skipping");t.current.isSigningOut=!0,h.current&&(clearTimeout(h.current),h.current=null);try{(await Promise.resolve().then(o.bind(o,65688))).default.disconnect(),y("MBA1111 WebSocket disconnected during signOut")}catch(n){y("MBA1111 Error disconnecting websocket:",n)}await t.current.clearTokens(),await a.default.multiRemove(["userRole","isApprovedProfessional"]),"web"===l.default.OS&&(sessionStorage.removeItem("userRole"),sessionStorage.removeItem("isApprovedProfessional"),sessionStorage.removeItem("currentProfessional"),sessionStorage.setItem("explicitSignOut","true")),y("MBA1111 Storage cleared during sign out"),p(!1),M(""),R(""),j(null),T(!1),F({timezone:"UTC",timezone_abbrev:"UTC",use_military_time:!1}),t.current.accessToken=null,t.current.refreshToken=null,setTimeout((()=>{(0,d.navigate)("SignIn")}),0),y("MBA1111 Sign out completed successfully")}catch(n){y("MBA1111 Error during sign out:",n)}finally{t.current.isSigningOut=!1}};(0,n.useEffect)((()=>t.current.onAuthStateChange((e=>{y("MBA1111 Auth state change received:",e),"FORCE_SIGN_OUT"===e.type&&(t.current.isSigningOut=!1,H(e.reason))}))),[]),(0,n.useEffect)((()=>{y("MBA1111 Setting up consolidated axios interceptors");let e=0;const o=r.default.interceptors.request.use((async e=>{if(O)y("MBA1111 Prototype mode - skipping token for: ".concat(e.method?.toUpperCase()," ").concat(e.url));else try{const o=await t.current.getAccessToken();o?e.headers.Authorization="Bearer ".concat(o):y("MBA1111 No token available for request: ".concat(e.method?.toUpperCase()," ").concat(e.url))}catch(o){console.error("MBA1111 Error getting access token for request:",o),y("MBA1111 Token error for request: ".concat(e.method?.toUpperCase()," ").concat(e.url),o)}return e}),(e=>(y("MBA1111 Request interceptor error:",e),Promise.reject(e)))),n=r.default.interceptors.response.use((t=>(e=0,t)),(async o=>{const n=o.config;if(y("MBA1111 Response error: ".concat(o.response?.status," ").concat(o.config.method?.toUpperCase()," ").concat(o.config.url)),401===o.response?.status&&!n._retry){if(e++,y("MBA1111 401 error detected (".concat(e,"/").concat(3,"), attempting token refresh")),e>=3)return y("MBA1111 Circuit breaker triggered: Too many consecutive 401 errors, forcing sign out"),t.current.forceSignOut("too_many_auth_failures"),Promise.reject(o);n._retry=!0;try{const e=n.url?.includes("/api/core/log-auth-event/");if(e)throw y("MBA1111 Auth logging call failed, not retrying to prevent loops"),o;{y("MBA1111 Attempting token refresh for failed request");const e=t.current.refreshTokens(),o=new Promise(((e,t)=>setTimeout((()=>t(new Error("Token refresh timeout"))),8e3)));await Promise.race([e,o]);const a=await t.current.getAccessToken();if(a)return n.headers.Authorization="Bearer ".concat(a),y("MBA1111 Retrying request with new token"),(0,r.default)(n);throw y("MBA1111 No new token available after refresh"),new Error("No token available after refresh")}}catch(a){throw y("MBA1111 Token refresh failed:",a),(a.message.includes("timeout")||e>=2)&&(y("MBA1111 Token refresh timeout or repeated failure, forcing sign out"),t.current.forceSignOut("token_refresh_failed")),o}}return Promise.reject(o)}));return()=>{r.default.interceptors.request.eject(o),r.default.interceptors.response.eject(n)}}),[O]),(0,n.useEffect)((()=>{if(!f||O)return;let e=null;const o=()=>{e&&clearTimeout(e),e=setTimeout((async()=>{if(t.current&&!t.current.isSigningOut){const o=t.current.accessToken;if(o&&t.current.shouldRefreshToken(o)){y("MBA1111 Token needs refresh on focus");try{await t.current.refreshTokens()}catch(e){y("MBA1111 Error refreshing token on focus:",e)}}}}),500)};return"web"===l.default.OS&&(window.addEventListener("focus",o),document.addEventListener("visibilitychange",(()=>{"visible"===document.visibilityState&&o()}))),()=>{e&&clearTimeout(e),"web"===l.default.OS&&(window.removeEventListener("focus",o),document.removeEventListener("visibilitychange",o))}}),[f,O]),(0,n.useEffect)((()=>{(async()=>{if(!g.current)try{y("MBA1111 Initializing auth state");const{hasAccessToken:o,hasRefreshToken:n}=await t.current.initialize();if(o||n){const o=await t.current.getAccessToken();if(o){if(await t.current.validateToken(o)){p(!0),await U();const t=await V(o);let n=null;try{n=await C("userRole")}catch(e){console.error("MBA1111 Error getting stored role:",e)}const a=!n||"professional"!==n&&"petOwner"!==n?t.suggestedRole:n;y("MBA1111 Role selection:",{storedRole:n,suggestedRole:t.suggestedRole,finalRole:a,isApprovedProfessional:t.isApprovedProfessional}),j(a),T(t.isApprovedProfessional),await q()}else await H("token_validation_failed")}else await H("no_valid_token")}else y("MBA1111 No tokens found during initialization")}catch(e){console.error("MBA1111 Error initializing auth state:",e),await H("initialization_error")}finally{k(!1),g.current=!0}})()}),[]);const U=async()=>{try{y("MBA1111 Fetching user name");const e=await(0,u.getUserName)();y("MBA1111 User name response:",e),M(e.first_name),R(e.name)}catch(e){console.error("MBA1111 Error fetching user name:",e.response?e.response.data:e.message),M(""),R("")}},V=async e=>{try{const t=await r.default.get("".concat(i.API_BASE_URL,"/api/professional-status/v1/"),{headers:{Authorization:"Bearer ".concat(e)}});y("MBA1111 Professional status response:",t.data);const{is_approved:o}=t.data;return T(o),"web"===l.default.OS?sessionStorage.setItem("isApprovedProfessional",String(o)):await a.default.setItem("isApprovedProfessional",String(o)),{isApprovedProfessional:o,suggestedRole:o?"professional":"petOwner"}}catch(t){return console.error("MBA1111 Error getting professional status:",t.response?.data||t),{isApprovedProfessional:!1,suggestedRole:"petOwner"}}},q=async()=>{if(!O)try{const e=await(0,u.getTimeSettings)();F(e),y("MBA1111 Time settings response:",e)}catch(e){console.error("MBA1111 Error fetching time settings:",e.response?e.response.data:e.message)}};(0,n.useEffect)((()=>{const e=s.default.addEventListener("change",(({window:e})=>{_(e.width)}));return()=>{e?.remove&&e.remove()}}),[]),(0,n.useEffect)((()=>{if(B||O)return;const e=async()=>{try{const o=!!await C("userToken")||!!await C("refreshToken"),n=!!t.current.accessToken||!!t.current.refreshToken;if(f&&!o&&!n&&!t.current.isSigningOut)return y("MBA1111 STATE INCONSISTENCY DETECTED: UI shows signed in but no tokens exist"),void await H("state_inconsistency_no_tokens");if(!f&&(o||n)&&!t.current.isSigningOut){y("MBA1111 STATE INCONSISTENCY DETECTED: UI shows signed out but tokens exist");try{const e=await t.current.getAccessToken();if(e){if(await t.current.validateToken(e)){y("MBA1111 Restoring session with valid tokens"),p(!0),await U();const t=await V(e);return j(t.suggestedRole),void T(t.isApprovedProfessional)}}}catch(e){y("MBA1111 Failed to restore session:",e)}await H("state_inconsistency_invalid_tokens")}}catch(e){y("MBA1111 Error in state consistency check:",e)}},o=setTimeout(e,2e3),n=setInterval(e,3e4);return()=>{clearTimeout(o),clearInterval(n)}}),[f,B,O]),(0,n.useEffect)((()=>{if(!f||O)return;const e=setInterval((async()=>{try{const o=await t.current.getAccessToken();if(o){const n=t.current.getTimeUntilExpiry(o),a=t.current.shouldRefreshToken(o);if(n<0&&y("MBA1111 TOKEN EXPIRED DETECTED in monitor"),a&&!t.current.isRefreshing){y("MBA1111 Token monitor triggering proactive refresh");try{await t.current.refreshTokens(),y("MBA1111 Proactive token refresh completed successfully")}catch(e){y("MBA1111 Proactive token refresh failed:",e)}}}else y("MBA1111 Token monitor: No token available")}catch(e){y("MBA1111 Error in token monitor:",e)}}),2e3);return()=>clearInterval(e)}),[f,O]);return(0,m.jsx)(x.Provider,{value:{isSignedIn:f,userRole:v,isApprovedProfessional:S,loading:B,screenWidth:A,firstName:I,name:D,is_prototype:O,is_DEBUG:W,is_PRODUCTION:w,timeSettings:P,isCollapsed:L,setIsCollapsed:z,signIn:async(e,o,n)=>{try{y("MBA1111 Starting sign in process"),t.current.isSigningOut=!1,await t.current.setTokens(e,o),p(!0),await U();try{const e=await(0,u.getTimeSettings)();F(e),y("MBA1111 Time settings fetched during sign in:",e)}catch(r){console.error("MBA1111 Error fetching time settings during sign in:",r)}const i=await V(e),s=i.suggestedRole;return j(s),T(i.isApprovedProfessional),"web"===l.default.OS?sessionStorage.setItem("userRole",s):await a.default.setItem("userRole",s),y("MBA1111 Sign in successful:",{initialRole:s,isApprovedProfessional:i.isApprovedProfessional}),n&&setTimeout((()=>{(0,c.navigateToFrom)(n,"Dashboard","SignIn")}),0),{userRole:s,isApprovedProfessional:i.isApprovedProfessional}}catch(i){throw y("MBA1111 Sign in error:",i),console.error("MBA1111 Error during sign in:",i),i}},signOut:H,switchRole:async e=>{if(S){y("MBA1111 Switching role, current role:",v);const o="professional"===v?"petOwner":"professional";j(o);try{"web"===l.default.OS?sessionStorage.setItem("userRole",o):await a.default.setItem("userRole",o);const t=e?.getCurrentRoute?.()?.name;"petOwner"===o&&"Connections"===t&&(y("MBA1111 Navigating to Dashboard from Connections when switching to pet owner"),(0,d.navigate)("Dashboard")),y("MBA1111 Role switched to:",o)}catch(t){console.error("MBA1111 Error updating role in storage:",t)}}else console.log("MBA1111 User is not an approved professional, cannot switch roles")},setIsDebug:N,setIsPrototype:E,checkAuthStatus:async()=>{try{const e=await t.current.getAccessToken();if(!e)return{isAuthenticated:!1};return await t.current.validateToken(e)?(y("MBA1111 checkAuthStatus",{isAuthenticated:!0,userRole:v,isApprovedProfessional:S}),{isAuthenticated:!0,userRole:v,isApprovedProfessional:S}):(await H("auth_status_check_failed"),{isAuthenticated:!1})}catch(e){return console.error("MBA1111 Error checking auth status:",e),{isAuthenticated:!1}}},fetchTimeSettings:q,debugTokenStatus:()=>{const e=t.current.accessToken;if(!e)return void y("MBA1111 No access token available");const o=t.current.getTimeUntilExpiry(e),n=o<=0,a=t.current.shouldRefreshToken(e);y("MBA1111 Token status:",{hasToken:!!e,timeUntilExpirySeconds:Math.round(o/1e3),isExpired:n,shouldRefresh:a,isRefreshing:t.current.isRefreshing,isSigningOut:t.current.isSigningOut})}},children:e})}},59742:(e,t,o)=>{"use strict";o.r(t),o.d(t,{MessageNotificationContext:()=>d,MessageNotificationProvider:()=>c,default:()=>u});var n=o(36665),a=o(38432),r=o(50294),i=o(65688),s=o(95991),l=o(60397);const d=(0,n.createContext)(),c=({children:e})=>{const[t,o]=(0,n.useState)(!1),[c,u]=(0,n.useState)(0),[m,g]=(0,n.useState)({}),[h,f]=(0,n.useState)(""),[p,y]=(0,n.useState)(!1),[b,x]=(0,n.useState)(0),{isSignedIn:C}=(0,n.useContext)(a.AuthContext),v=(0,n.useRef)(!1),w=(0,n.useRef)(!1),j=(0,n.useRef)(null),S=(0,n.useRef)(null),T=(0,n.useRef)(!1),B=(0,n.useRef)(0),k=(0,n.useRef)(null),A=(0,n.useRef)(0),_=(0,n.useRef)(0),I=(0,n.useRef)(0),M=(0,n.useRef)(null),D=(0,n.useRef)(!0),R=(0,n.useRef)(!1),[L,z]=(0,n.useState)(null),P=(0,n.useRef)(0),F=async(e=!1)=>{try{if(w.current)return(0,a.debugLog)("MBA4321: Skipping unread check - another check is already in progress"),t;const o=(new Error).stack;if((0,a.debugLog)("MBA4321: checkUnreadMessages called from:\n".concat(o)),w.current=!0,e)return(0,a.debugLog)("MBA432wihe21: Forced API call for unread messages"),await E();const n=i.default&&i.default.isWebSocketConnected();return(0,a.debugLog)("MBA4321: WebSocket connected: ".concat(n)),n&&T.current?((0,a.debugLog)("MBA4321: WebSocket is connected and data received, using current state"),w.current=!1,t):R.current?((0,a.debugLog)("MBA4321: Using existing state, we already made an initial API call"),w.current=!1,t):((0,a.debugLog)("MBA4321: First check on page load, implementing progressive WebSocket wait"),k.current&&clearTimeout(k.current),await O())}catch(o){return(0,a.debugLog)("MBA4321: Error in checkUnreadMessages:",o),w.current=!1,t}},O=async()=>(A.current=0,R.current?new Promise((e=>{const o=()=>{const n=i.default&&i.default.isWebSocketConnected();return T.current?((0,a.debugLog)("MBA4321: WebSocket data received during wait, using current state"),w.current=!1,void e(t)):(A.current++,(0,a.debugLog)("MBA4321: WebSocket wait attempt ".concat(A.current,"/").concat(12,", connected: ").concat(n)),n&&((0,a.debugLog)("MBA4321: WebSocket is connected, sending heartbeat request"),i.default.send("heartbeat",{timestamp:Date.now()}),I.current=Date.now()),A.current>=12?((0,a.debugLog)("MBA432wihe21: Max WebSocket wait attempts reached, falling back to API"),void E().then((t=>e(t)))):void(k.current=setTimeout(o,5e3)))};o()})):((0,a.debugLog)("MBA432wihe21: Fresh page load - making initial API call to get accurate unread count"),await E())),E=async()=>{(0,a.debugLog)("MBA432wihe21: makeApiCall called, checking if necessary");const e=Date.now();if(e-P.current<6e4&&T.current&&D.current)return(0,a.debugLog)("MBA432wihe21: Skipping API call - checked recently and connection is healthy"),t;(0,a.debugLog)("MBA432wihe21: Making API call for unread messages");try{const t=await(0,r.getUnreadMessageCount)(),n=t.unread_count||0,i=t.conversation_counts||{};return(0,a.debugLog)("MBA432wihe21: Unread message count from API:",n),z({unread_count:n,conversation_counts:i,timestamp:e}),u(n),o(n>0),g(i),x(e),B.current=e,P.current=e,v.current=!0,R.current=!0,T.current=!0,w.current=!1,n>0}catch(n){return(0,a.debugLog)("MBA432wihe21: Error in API call:",n),w.current=!1,t}},W=(e=!1)=>{S.current&&clearTimeout(S.current),S.current=setTimeout((()=>{F(e),S.current=null}),300)},N=e=>{if((0,a.debugLog)("MBA4321: onNewMessage called with data:",e),e&&e.sent_by_other_user){const t=e.conversation_id;if("MessageHistory"===h&&t&&String(t)===String(window.selectedConversationId))return void(0,a.debugLog)("MBA4321: User is viewing this specific conversation, not creating notification");if((0,a.debugLog)("MBA4321: New message from ".concat(e.sender_name||"unknown"," in conversation ").concat(t)),((e=null)=>{(0,a.debugLog)("MBA4321: Adding unread message notification for conversation ".concat(e)),o(!0),u((e=>{const t=e+1;return(0,a.debugLog)("MBA4321: Increasing total unread count from ".concat(e," to ").concat(t)),t})),e&&g((t=>{const o=t[e]||0,n=o+1;return(0,a.debugLog)("MBA4321: Conversation ".concat(e," unread count: ").concat(o," \u2192 ").concat(n)),Object.assign({},t,{[e]:n})}))})(t),T.current=!0,L){const e=Object.assign({},L.conversation_counts);e[t]=(e[t]||0)+1,z({unread_count:L.unread_count+1,conversation_counts:e,timestamp:Date.now()})}}};(0,n.useEffect)((()=>{window.selectedConversationId=null}),[]);const H=async e=>{if((0,a.debugLog)("MBA4321: Marking conversation as read:",e),window.selectedConversationId=e,e&&m[e]){const t=m[e]||0;u((o=>{const n=Math.max(0,o-t);return(0,a.debugLog)("MBA4321: Reducing total unread count from ".concat(o," to ").concat(n," after reading conversation ").concat(e)),n}));const n=Object.assign({},m);if(delete n[e],g(n),L){const o=Object.assign({},L.conversation_counts);delete o[e],z({unread_count:Math.max(0,L.unread_count-t),conversation_counts:o,timestamp:Date.now()})}const r=Object.keys(n).length>0;if(o(r),(0,a.debugLog)("MBA4321: After marking conversation ".concat(e," as read, still have unread messages: ").concat(r)),r){const e=Object.keys(n).map((e=>"".concat(e,":").concat(n[e]))).join(", ");(0,a.debugLog)("MBA4321: Remaining unread conversations: ".concat(e))}}(0,a.debugLog)("MBA4321: Updated unread state after marking conversation as read")};(0,n.useEffect)((()=>((async()=>{if(C)try{const e=await(0,a.getStorage)("userToken");if(!e)return void(0,a.debugLog)("MBA4321: No token available for WebSocket connection");(0,a.debugLog)("MBA4321: Initializing WebSocket connection"),i.default.init(e),y(!0),A.current=0,setTimeout((()=>{(0,a.debugLog)("MBA432wihe21: Forcing initial API check on page load to get accurate count"),E()}),500)}catch(e){(0,a.debugLog)("MBA4321: Error initializing WebSocket:",e)}else p&&((0,a.debugLog)("MBA4321: User signed out, force disconnecting WebSocket"),i.default.disconnect(!0),y(!1),j.current&&(clearInterval(j.current),j.current=null),k.current&&(clearTimeout(k.current),k.current=null),M.current&&(clearTimeout(M.current),M.current=null),A.current=0,T.current=!1,D.current=!1,R.current=!1)})(),()=>{j.current&&((0,a.debugLog)("MBA4321: Cleaning up WebSocket reconnect interval"),clearInterval(j.current),j.current=null),S.current&&(clearTimeout(S.current),S.current=null),k.current&&(clearTimeout(k.current),k.current=null),M.current&&(clearTimeout(M.current),M.current=null)})),[C]),(0,n.useEffect)((()=>{if(!C||!p)return;(0,a.debugLog)("MBA4321: Setting up WebSocket message handler");const e=i.default.registerHandler("message",(e=>{if((0,a.debugLog)("MBA4321: Message notification received via WebSocket:",e),_.current=Date.now(),D.current=!0,!R.current)return(0,a.debugLog)("MBA432wihe21: No initial API call made yet, making one now to ensure correct state"),void E();N(e)}),"notification-context"),t=i.default.registerHandler("unread_update",(e=>{(0,a.debugLog)("MBA4321: Unread update received via WebSocket:",e),_.current=Date.now(),D.current=!0,e&&"undefined"!==typeof e.unread_count&&(u(e.unread_count),o(e.unread_count>0),g(e.conversation_counts||{}),z({unread_count:e.unread_count,conversation_counts:e.conversation_counts||{},timestamp:Date.now()}),x(Date.now()),T.current=!0,v.current=!0)}),"unread-update-context"),n=i.default.registerHandler("heartbeat_ack",(e=>{(0,a.debugLog)("MBA4321: Heartbeat acknowledgment received"),_.current=Date.now(),D.current=!0,T.current=!0}),"heartbeat-context"),r=i.default.registerHandler("connection",(e=>{(0,a.debugLog)("MBA4321: WebSocket connection event:",e),"connected"===e.status?(_.current=Date.now(),D.current=!0):e.forced&&(T.current=!1,D.current=!1,(0,a.debugLog)("MBA4321: Connection forcibly closed, resetting WebSocket data flag")),"connected"!==e.status||v.current||setTimeout((()=>{T.current||((0,a.debugLog)("MBA432wihe21: in connection handler"),F(!0))}),1e3)}),"connection-context");return()=>{(0,a.debugLog)("MBA4321: Cleaning up WebSocket handlers"),e(),t(),r(),n()}}),[C,p]),(0,n.useEffect)((()=>{if(!C)return;const e=()=>{if("web"===s.default.OS&&"visible"===document.visibilityState){(0,a.debugLog)("MBA4321: Tab became visible, ensuring WebSocket connection");const e=i.default&&i.default.isWebSocketConnected();if((0,a.debugLog)("MBA4321: WebSocket connection status on visibility change: ".concat(e?"Connected":"Disconnected")),e)return(0,a.debugLog)("MBA4321: WebSocket is already connected, no reconnection needed"),i.default.send("heartbeat",{timestamp:Date.now()}),I.current=Date.now(),T.current=!0,void(D.current=!0);if(i.default&&"function"===typeof i.default.reconnectIfNeeded){(0,a.debugLog)("MBA4321: WebSocket not connected, attempting reconnection"),i.default.reconnectIfNeeded(),A.current=0;const e=()=>i.default&&i.default.isWebSocketConnected()||T.current?((0,a.debugLog)("MBA4321: WebSocket reconnected successfully, stopping retry process"),void(k.current&&(clearTimeout(k.current),k.current=null))):(A.current++,(0,a.debugLog)("MBA4321: WebSocket reconnection attempt ".concat(A.current,"/").concat(12)),A.current>=12?((0,a.debugLog)("MBA432wihe21: Max retries reached, fall back to API"),void W(!0)):void(k.current=setTimeout(e,5e3)));setTimeout(e,1e3)}}};return"web"===s.default.OS&&"undefined"!==typeof document&&document.addEventListener("visibilitychange",e),()=>{"web"===s.default.OS&&"undefined"!==typeof document&&document.removeEventListener("visibilitychange",e),k.current&&(clearTimeout(k.current),k.current=null),M.current&&(clearTimeout(M.current),M.current=null)}}),[C]),(0,n.useEffect)((()=>{if(!C)return o(!1),u(0),g({}),T.current=!1,R.current=!1,void(k.current&&(clearTimeout(k.current),k.current=null));if(!R.current){(0,a.debugLog)("MBA4321: Ensuring we get fresh unread count on page load/sign-in");const e=setTimeout((()=>{R.current||((0,a.debugLog)("MBA432wihe21: Making initial API call to get fresh unread count"),E())}),1e3);return()=>clearTimeout(e)}return()=>{}}),[C]);const U={hasUnreadMessages:t,unreadCount:c,conversationCounts:m,getConversationUnreadCount:e=>e&&m[e]||0,updateRoute:e=>{e&&e!==h&&((0,a.debugLog)("MBA4321: Updating route to:",e),f(e))},checkUnreadMessages:W,onNewMessage:N,markConversationAsRead:H,resetNotifications:(e,t)=>{if(e&&e!==h&&f(e),t)return(0,a.debugLog)("MBA4321: Resetting notifications for specific conversation: ".concat(t)),void H(t);"RESET_ALL"===e&&((0,a.debugLog)("MBA4321: Explicitly resetting ALL message notifications"),o(!1),u(0),g({}))}};return(0,l.jsx)(d.Provider,{value:U,children:e})},u=d},6541:(e,t,o)=>{"use strict";o.r(t),o.d(t,{theme:()=>a});var n=o(16204);const a=Object.assign({},n.DefaultTheme,{fonts:Object.assign({},n.DefaultTheme.fonts,{regular:{fontFamily:"PlayfairDisplay"},medium:{fontFamily:"PlayfairDisplay-Medium"},header:{fontFamily:"Futura"}}),typography:{header:{fontFamily:"Futura"},body:{fontFamily:"PlayfairDisplay"}},colors:Object.assign({},n.DefaultTheme.colors,{mainColors:{main:"#6A6C51",secondary:"#5D6C51",tertiary:"#516C53",quaternary:"#516C61",quinary:"#516A6C",senary:"#515D6C"},proDashboard:{main:"#F0F9E5",secondary:"#E7F3F8",tertiary:"#FEF0DA",quaternary:"#E1E2DB"},mybookings:{main:"#FFF7ED",secondary:"#EA580E",tertiary:"#6A6C51",ownerName:"#4B4C3B",metaText:"#959885",confirmedBg:"#E8E9E2",confirmedText:"#898974",completedBg:"#F5F5F4",completedText:"#898983",searchBar:"rgb(183, 183, 183)"},primary:"#6A6C51",secondary:"#516C61",background:"#f6f6f6",backgroundContrast:"#F6F3FC",calendarColor:"#A99E6B",calendarColorYellowBrown:"#8A8C6D",text:"black",whiteText:"white",placeHolderText:"#A9A9A9",accent:"#03dac4",error:"#B00020",warning:"#FFA726",info:"#29B6F6",surface:"#F9FAFB",surfaceContrast:"#FFFFFF",border:"rgb(183, 183, 183)",bgColorModern:"rgb(239, 239, 239)",modernBorder:"#E0E0E0",inputBackground:"#f6f6f6",receivedMessage:"#e7eae6",danger:"#A52A2A"}),fontSizes:{small:12,smallMedium:14,medium:16,mediumLarge:18,large:20,largeLarge:24,extraLarge:26},spacing:{small:8,medium:16,large:24}})},32160:(e,t,o)=>{"use strict";o.r(t),o.d(t,{FORMAT_TYPES:()=>x,checkDSTChange:()=>f,convertDateTimeFromUTC:()=>g,convertTo12Hour:()=>u,convertTo24Hour:()=>c,convertToUTC:()=>m,formatDate:()=>d,formatDateForAPI:()=>y,formatDateTimeRangeFromUTC:()=>v,formatFromUTC:()=>C,formatOccurrenceFromUTC:()=>p,formatTimeForAPI:()=>b,getFormattedTimes:()=>h,parseOccurrencesForBookingSteps:()=>j});var n=o(32724),a=o(9307),r=o(72302),i=o.n(r),s=o(38432),l=o(5977);const d=e=>{if(!e)return"";(0,s.debugLog)("MBA5677: Formatting date input",e);try{const t=(0,l.parseISO)(e);if(!isNaN(t.getTime())){const e=t.toLocaleString("default",{month:"short"}),o=t.getDate();return(0,s.debugLog)("MBA5677: Parsed as ISO date",{parsedDate:t,month:e,day:o}),"".concat(e," ").concat(o)}const o=(0,n.parse)(e,"yyyy-MM-dd",new Date);if(!isNaN(o.getTime())){const e=o.toLocaleString("default",{month:"short"}),t=o.getDate();return(0,s.debugLog)("MBA5677: Parsed with date-fns",{date:o,month:e,day:t}),"".concat(e," ").concat(t)}const a=i()(e);if(a.isValid()){const e=a.format("MMM D");return(0,s.debugLog)("MBA5677: Parsed with moment",{momentDate:a,formatted:e}),e}return(0,s.debugLog)("MBA5677: Failed to parse date",e),e}catch(t){return(0,s.debugLog)("MBA5677: Error formatting date",{dateString:e,error:t}),e}},c=e=>{if(!e.includes(" "))return e;const[t,o]=e.split(" ");let[n,a]=t.split(":");return n=parseInt(n,10),"PM"===o&&n<12?n+=12:"AM"===o&&12===n&&(n=0),"".concat(n.toString().padStart(2,"0"),":").concat(a)},u=e=>{if(e.includes(" "))return e;const[t,o]=e.split(":"),n=parseInt(t,10);let a=n>=12?"PM":"AM",r=n%12;return r=0===r?12:r,"".concat(r,":").concat(o," ").concat(a)},m=(e,t,o)=>{try{(0,s.debugLog)("MBA12345: Converting to UTC - Input:",{date:e,time:t,fromTimezone:o});const n=i().tz("".concat(e," ").concat(t),o),a=n.utc(),r=a.format("YYYY-MM-DD"),l=a.format("HH:mm");return(0,s.debugLog)("MBA12345: UTC conversion result:",{input:{date:e,time:t,fromTimezone:o},output:{utcDate:r,utcTime:l,originalMoment:n.format(),utcMoment:a.format()}}),{date:r,time:l}}catch(n){return(0,s.debugLog)("MBA12345: Error converting to UTC:",n),{date:e,time:t}}},g=(e,t,o,n=!1)=>{try{if((0,s.debugLog)("MBA5677: Converting UTC to local:",{date:e,time:t,timezone:o,useMilitaryTime:n}),!e||!t)return(0,s.debugLog)("MBA5677: Invalid input for conversion",{date:e,time:t}),{date:e,time:t};let r=null;try{let o=t;t.includes(".")&&(o=t.split(".")[0]);const n="".concat(e,"T").concat(o).concat(o.includes("Z")?"":"Z");(0,s.debugLog)("MBA5677: Trying ISO string format",n),r=new Date(n),isNaN(r.getTime())?((0,s.debugLog)("MBA5677: ISO format parsing failed"),r=null):(0,s.debugLog)("MBA5677: ISO format parsing succeeded")}catch(a){(0,s.debugLog)("MBA5677: Error in ISO format parsing",a)}if(!r)try{(0,s.debugLog)("MBA5677: Trying date-fns parsing");const o="".concat(e," ").concat(t);r=i().utc(o).toDate(),isNaN(r.getTime())?((0,s.debugLog)("MBA5677: date-fns parsing failed"),r=null):(0,s.debugLog)("MBA5677: date-fns parsing succeeded")}catch(a){(0,s.debugLog)("MBA5677: Error in date-fns parsing",a)}if(!r)try{(0,s.debugLog)("MBA5677: Trying manual parsing");const[o,n,a]=e.split("-").map(Number);let i=0,l=0;if(t.includes(":")){const e=t.split(":");i=parseInt(e[0],10),l=parseInt(e[1],10)}r=new Date(Date.UTC(o,n-1,a,i,l)),isNaN(r.getTime())?((0,s.debugLog)("MBA5677: Manual parsing failed"),r=null):(0,s.debugLog)("MBA5677: Manual parsing succeeded")}catch(a){(0,s.debugLog)("MBA5677: Error in manual parsing",a)}if(!r)return(0,s.debugLog)("MBA5677: All parsing strategies failed, returning original"),{date:e,time:t};(0,s.debugLog)("MBA5677: Valid UTC Date created:",r.toISOString());const l=i().utc(r),d=l.tz(o||"UTC"),c=d.format("YYYY-MM-DD"),u=d.format(n?"HH:mm":"h:mm A");return(0,s.debugLog)("MBA5677: Date conversion result:",{input:{date:e,time:t,timezone:o},utc:r.toISOString(),utcMoment:l.format(),localMoment:d.format(),output:{date:c,time:u}}),{date:c,time:u}}catch(r){return(0,s.debugLog)("MBA5677: Error in convertDateTimeFromUTC:",r,{date:e,time:t,timezone:o}),{date:e,time:t}}},h=(e,t,o,n,r)=>{try{console.log("MBA134njo0vh032 getFormattedTimes input:",{startDate:e,startTime:t,endDate:o,endTime:n,timezone:r});const[i,s,l]=e.split("-").map(Number),[d,c]=t.split(":").map(Number),[u,m,g]=o.split("-").map(Number),[h,f]=n.split(":").map(Number);console.log("MBA134njo0vh032 Parsed components:",{start:{year:i,month:s,day:l,hours:d,minutes:c},end:{year:u,month:m,day:g,hours:h,minutes:f}});const p="".concat(i,"-").concat(String(s).padStart(2,"0"),"-").concat(String(l).padStart(2,"0"),"T").concat(String(d).padStart(2,"0"),":").concat(String(c).padStart(2,"0"),":00"),y="".concat(u,"-").concat(String(m).padStart(2,"0"),"-").concat(String(g).padStart(2,"0"),"T").concat(String(h).padStart(2,"0"),":").concat(String(f).padStart(2,"0"),":00");console.log("MBA134njo0vh032 Created date strings:",{startDateStr:p,endDateStr:y,timezone:r});const b=(0,a.formatInTimeZone)(p,r,"MMM dd, yyyy (h:mm a)"),x=(0,a.formatInTimeZone)(y,r,"MMM dd, yyyy (h:mm a)");console.log("MBA134njo0vh032 Formatted dates:",{formatted_start:b,formatted_end:x});const C=new Date(p),v=new Date(y)-C,w=Math.floor(v/864e5),j=v%864e5,S=Math.floor(j/36e5);let T="";return w>0?(T+="".concat(w," day").concat(w>1?"s":""),S>0&&(T+=", ".concat(S," hour").concat(S>1?"s":""))):S>0&&(T+="".concat(S," hour").concat(S>1?"s":"")),console.log("MBA134njo0vh032 Final formatted output:",{formatted_start:b,formatted_end:x,duration:T,timezone:r.split("/")[1]||r}),{formatted_start:b,formatted_end:x,duration:T||"0 hours",timezone:r.split("/")[1]||r}}catch(i){throw console.error("Error in getFormattedTimes:",i),i}},f=(e,t,o,n,r)=>{try{const[i,s,l]=e.split("-").map(Number),[d,u]=c(t).split(":").map(Number),[m,g,h]=o.split("-").map(Number),[f,p]=c(n).split(":").map(Number),y=new Date(i,s-1,l,d,u),b=new Date(m,g-1,h,f,p),x=(0,a.fromZonedTime)((0,a.toZonedTime)(y,r)),C=(0,a.fromZonedTime)((0,a.toZonedTime)(b,r)),v=(0,a.toZonedTime)(x,r),w=(0,a.toZonedTime)(C,r);return v.getTimezoneOffset()!==w.getTimezoneOffset()}catch(i){throw console.error("Error in checkDSTChange:",i),i}},p=(e,t)=>{try{const o=t.includes("/")?t:"US/Mountain";console.log("MBA134njo0vh03 Formatting occurrence from UTC:",{occurrence:e,userTimezone:t,fullTimezone:o});const n=g(e.start_date,e.start_time,o),a=g(e.end_date,e.end_time,o);console.log("MBA134njo0vh03 Local start:",n),console.log("MBA134njo0vh03 Local end:",a),console.log("MBA134njo0vh03 Full timezone:",o);const r=h(n.date,n.time,a.date,a.time,o);console.log("MBA134njo0vh03 Formatted times from getFormattedTimes:",r);const i=f(n.date,n.time,a.date,a.time,o),s=t.includes("/")?t.split("/")[1]:t;return Object.assign({},e,{formatted_start:r.formatted_start,formatted_end:r.formatted_end,duration:r.duration,timezone:s,dst_message:i?"Elapsed time may be different than expected due to Daylight Savings Time.":""})}catch(o){return console.error("Error in formatOccurrenceFromUTC:",o),Object.assign({},e,{formatted_start:e.start_date,formatted_end:e.end_date,duration:"Unknown",timezone:t.includes("/")?t.split("/")[1]:t,dst_message:""})}},y=e=>{if(!e)return null;let t;(0,s.debugLog)("MBA12345 formatDateForAPI input:",e,typeof e);try{if("string"===typeof e&&/^\d{4}-\d{2}-\d{2}$/.test(e))return(0,s.debugLog)("MBA12345 formatDateForAPI: already in YYYY-MM-DD format:",e),e;if("object"===typeof e&&e.date&&e.startTime&&e.endTime)return(0,s.debugLog)("MBA12345 formatDateForAPI: extracting date from date item:",e.date),e.date;if(e instanceof Date?(t=e,(0,s.debugLog)("MBA12345 formatDateForAPI: using Date object")):(t=new Date(e),(0,s.debugLog)("MBA12345 formatDateForAPI: created Date from input:",t)),isNaN(t.getTime()))throw(0,s.debugLog)("MBA12345 formatDateForAPI: invalid date:",e),new Error("Invalid date format");const o=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),a=String(t.getDate()).padStart(2,"0"),r="".concat(o,"-").concat(n,"-").concat(a);return(0,s.debugLog)("MBA12345 formatDateForAPI result:",r),r}catch(o){throw(0,s.debugLog)("MBA12345 formatDateForAPI error:",o,"for input:",e),o}},b=e=>{if(!e)return(0,s.debugLog)("MBA12345 formatTimeForAPI received null/undefined time:",e),null;let t,o;if((0,s.debugLog)("MBA12345 formatTimeForAPI input:",e),"object"===typeof e&&void 0!==e.hours)t=e.hours,o=e.minutes,(0,s.debugLog)("MBA12345 formatTimeForAPI processing time object:",{hours:t,minutes:o});else{if("string"!==typeof e)throw(0,s.debugLog)("MBA12345 formatTimeForAPI invalid time format:",typeof e),new Error("Invalid time format");[t,o]=e.split(":").map(Number),(0,s.debugLog)("MBA12345 formatTimeForAPI processing time string:",{hours:t,minutes:o})}if(t=parseInt(t),o=parseInt(o),isNaN(t)||isNaN(o))throw(0,s.debugLog)("MBA12345 formatTimeForAPI invalid time values:",{hours:t,minutes:o}),new Error("Invalid time values");const n="".concat(String(t).padStart(2,"0"),":").concat(String(o).padStart(2,"0"));return(0,s.debugLog)("MBA12345 formatTimeForAPI result:",n),n},x={SHORT_DATE:"SHORT_DATE",MEDIUM_DATE:"MEDIUM_DATE",LONG_DATE:"LONG_DATE",TIME_ONLY:"TIME_ONLY",TIME_ONLY_24H:"TIME_ONLY_24H",DATE_TIME:"DATE_TIME",DATE_TIME_WITH_TZ:"DATE_TIME_WITH_TZ",DATE_RANGE:"DATE_RANGE",DATE_TIME_RANGE:"DATE_TIME_RANGE"},C=(e,t=null,o,n=x.MEDIUM_DATE)=>{try{console.log("MBA134njo0vh02c23 formatFromUTC input:",{dateStr:e,timeStr:t,userTimezone:o,formatType:n});const a=i().utc("".concat(e,"T").concat(t||"00:00",":00Z"));console.log("MBA134njo0vh02c23 UTC moment:",a.format());const r=a.tz(o);console.log("MBA134njo0vh02c23 Local moment:",r.format());const s=r.zoneAbbr();switch(console.log("MBA134njo0vh02c23 Timezone abbreviation:",s),n){case x.SHORT_DATE:return r.format("MMM D");case x.MEDIUM_DATE:return r.format("MMM D, YYYY");case x.LONG_DATE:return r.format("MMMM D, YYYY");case x.TIME_ONLY:return r.format("h:mm A");case x.TIME_ONLY_24H:return r.format("HH:mm");case x.DATE_TIME:return r.format("MMM D, YYYY 'at' h:mm A");case x.DATE_TIME_WITH_TZ:return"".concat(r.format("MMM D, YYYY 'at' h:mm A")," ").concat(s);default:return r.format("MMM D, YYYY")}}catch(a){return console.error("MBA134njo0vh02c23 Error in formatFromUTC:",a),""}},v=({startDate:e,startTime:t,endDate:o,endTime:n,userTimezone:a,includeTimes:r=!0,includeTimezone:l=!0})=>{try{if((0,s.debugLog)("MBA134njo: formatDateTimeRangeFromUTC input:",{startDate:e,startTime:t,endDate:o,endTime:n,userTimezone:a,includeTimes:r,includeTimezone:l}),r){const r=i().utc("".concat(e,"T").concat(t,":00Z")),d=i().utc("".concat(o,"T").concat(n,":00Z"));(0,s.debugLog)("MBA134njo: UTC moments:",{start:r.format(),end:d.format()});const c=r.tz(a),u=d.tz(a);(0,s.debugLog)("MBA134njo: Local moments:",{start:c.format(),end:u.format()});const m=c.zoneAbbr();(0,s.debugLog)("MBA134njo: Timezone abbreviation:",m);const g=c.format("MMM D, YYYY h:mm A"),h=u.format("MMM D, YYYY h:mm A"),f=l?"".concat(g," ").concat(m):g,p=l?"".concat(h," ").concat(m):h;return(0,s.debugLog)("MBA134njo: Formatted dates:",{startFormatted:f,endFormatted:p,tzAbbrev:m}),"".concat(f," - ").concat(p)}{const t=i().utc("".concat(e,"T00:00:00Z")).tz(a),n=i().utc("".concat(o,"T00:00:00Z")).tz(a);return"".concat(t.format("MMM D, YYYY")," - ").concat(n.format("MMM D, YYYY"))}}catch(d){return(0,s.debugLog)("MBA134njo: Error in formatDateTimeRangeFromUTC:",d),""}};function w(e,t,o="US/Mountain"){try{const n="".concat(e,"T").concat(t,":00Z"),a=i().utc(n).tz(o),r=a.hours(),l=a.minutes(),d=a.format("YYYY-MM-DD"),c=d!==e;return(0,s.debugLog)("MBA2j3kbr9hve4: Time conversion details:",{utc:{date:e,time:t,fullDateTime:n},local:{date:d,time:"".concat(r,":").concat(l),fullDateTime:a.format(),dateChanged:c}}),{hours:r,minutes:l,adjustedDate:c?d:null}}catch(n){(0,s.debugLog)("MBA2j3kbr9hve4: Error converting time from UTC:",n);const[e,o]=t.split(":").map(Number);return{hours:e||0,minutes:o||0,adjustedDate:null}}}const j=e=>{if((0,s.debugLog)("MBA2j3kbr9hve4: Parsing occurrences for booking steps:",e),!e||!Array.isArray(e)||0===e.length)return(0,s.debugLog)("MBA2j3kbr9hve4: No occurrences to parse"),{dates:[],dateRange:null,individualTimes:{},defaultTimes:{startTime:{hours:9,minutes:0},endTime:{hours:17,minutes:0}}};const t=new Set,o={},n=[...e].sort(((e,t)=>new Date(e.start_date)-new Date(t.start_date)));(0,s.debugLog)("MBA2j3kbr9hve4: Sorted occurrences:",n);const a="US/Mountain";n.forEach((e=>{const{start_date:n,end_date:r,start_time:i,end_time:l}=e;if(!n||!i||!l)return void(0,s.debugLog)("MBA2j3kbr9hve4: Invalid occurrence data, missing required fields:",e);const d=w(n,i,a),c=w(r||n,l,a),u=d.adjustedDate||n,m=c.adjustedDate||r||n;(0,s.debugLog)("MBA2j3kbr9hve4: Converted times with date adjustments:",{utc:{startDate:n,startTime:i,endDate:r||n,endTime:l},local:{startDate:u,startTime:d,endDate:m,endTime:c}}),t.add(u),m!==u&&t.add(m),o[u]={startTime:{hours:d.hours,minutes:d.minutes},endTime:{hours:c.hours,minutes:c.minutes},isOvernightForced:u!==m}}));const r=Array.from(t).map((e=>{const[t,o,n]=e.split("-").map(Number);return new Date(t,o-1,n)}));(0,s.debugLog)("MBA2j3kbr9hve4: Parsed dates after timezone adjustment:",r.map((e=>e.toISOString().split("T")[0])));let i=null;if(r.length>0){const e=[...r].sort(((e,t)=>e-t));i={startDate:e[0],endDate:e[e.length-1]},(0,s.debugLog)("MBA2j3kbr9hve4: Created date range after timezone adjustment:",{startDate:i.startDate.toISOString().split("T")[0],endDate:i.endDate.toISOString().split("T")[0]})}let l={startTime:{hours:9,minutes:0},endTime:{hours:17,minutes:0}};if(Object.keys(o).length>0){const e=Object.keys(o)[0];l={startTime:o[e].startTime,endTime:o[e].endTime}}const d={dates:r,dateRange:i,individualTimes:o,defaultTimes:l,allTimesAreTheSame:Object.keys(o).length<=1||Object.values(o).every((e=>e.startTime.hours===l.startTime.hours&&e.startTime.minutes===l.startTime.minutes&&e.endTime.hours===l.endTime.hours&&e.endTime.minutes===l.endTime.minutes))};return(0,s.debugLog)("MBA2j3kbr9hve4: Parsed result with timezone adjustments:",d),d}},65688:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>i});var n=o(19620),a=o(38432),r=o(95991);const i=new class{constructor(){this.socket=null,this.isConnected=!1,this.token=null,this.connectionAttempts=0,this.maxConnectionAttempts=5,this.heartbeatInterval=null,this.disconnectTimeout=null,this.messageHandlers=new Map,this.connectionId=null,this.wsUrl=n.API_BASE_URL.replace("http://","ws://").replace("https://","wss://"),this._reconnectTimeout=null,this.forceDisconnect=!1,this._hasVisibilityListener=!1,(0,a.debugLog)("MBA4321: WebSocketManager initialized, wsUrl is "+this.wsUrl)}init(e){e?this.token===e&&this.isConnected&&this.socket&&this.socket.readyState===WebSocket.OPEN?(0,a.debugLog)("MBA4321: WebSocket already connected with this token"):(this.token&&this.token!==e&&((0,a.debugLog)("MBA4321: Token changed, force disconnecting before reconnecting"),this.disconnect(!0)),this.token=e,this.forceDisconnect=!1,!this.socket||this.socket.readyState!==WebSocket.CLOSING&&this.socket.readyState!==WebSocket.CLOSED||((0,a.debugLog)("MBA4321: Closing existing non-functional socket"),this.disconnect(!1)),this.connect(),this.resetDisconnectTimeout(),this.setupVisibilityListener()):(0,a.debugLog)("MBA4321: Cannot initialize WebSocket without a valid token")}setupVisibilityListener(){if("undefined"===typeof document)return;if(this._hasVisibilityListener)return;(0,a.debugLog)("MBA4321: Setting up visibility change listener");const e=()=>{"web"===r.default.OS&&"visible"===document.visibilityState&&((0,a.debugLog)("MBA4321: Document became visible, checking WebSocket connection"),this.token&&!this.forceDisconnect&&this.reconnectIfNeeded())};"web"===r.default.OS&&(document.addEventListener("visibilitychange",e),this._hasVisibilityListener=!0,window.addEventListener("beforeunload",(()=>{(0,a.debugLog)("MBA4321: Page unloading, connection may persist for session restore")})))}connect(){if(!this.token)return(0,a.debugLog)("MBA4321: Cannot connect WebSocket without a valid token"),!1;if(this.isConnected&&this.socket&&this.socket.readyState===WebSocket.OPEN)return(0,a.debugLog)("MBA4321: WebSocket already connected and open"),!0;if(this.socket&&this.socket.readyState===WebSocket.CONNECTING)return(0,a.debugLog)("MBA4321: WebSocket already connecting, skipping duplicate connect"),!0;if(this.heartbeatInterval&&(clearInterval(this.heartbeatInterval),this.heartbeatInterval=null),this.connectionAttempts>=this.maxConnectionAttempts)return(0,a.debugLog)("MBA4321: Too many connection attempts (".concat(this.connectionAttempts,"), backing off")),setTimeout((()=>{this.connectionAttempts=0,this.connect()}),6e4),!1;try{this.connectionAttempts++;const e="".concat(this.wsUrl,"/ws/messages/?token=").concat(this.token);return(0,a.debugLog)("MBA4321: [MY CONNECTION] Connecting WebSocket at ".concat(e," (attempt ").concat(this.connectionAttempts,")")),this.socket=new WebSocket(e),(0,a.debugLog)("MBA4321: [MY CONNECTION] WebSocket instance created"),this.socket.onopen=this.handleOpen.bind(this),this.socket.onclose=this.handleClose.bind(this),this.socket.onmessage=this.handleMessage.bind(this),this.socket.onerror=this.handleError.bind(this),!0}catch(e){return(0,a.debugLog)("MBA4321: [MY CONNECTION] WebSocket connection error: ".concat(e.message)),this.scheduleReconnect(),!1}}handleOpen(e){(0,a.debugLog)("MBA4321: [MY CONNECTION] WebSocket connection established"),this.isConnected=!0,this.connectionAttempts=0,this.startHeartbeat(),(0,a.debugLog)("MBA4321: [MY CONNECTION] isConnected set to ".concat(this.isConnected,", socket state: ").concat(this.socket?.readyState)),this.notifyHandlers("connection",{status:"connected",timestamp:(new Date).toISOString()}),setTimeout((()=>{this.isConnected&&((0,a.debugLog)("MBA4321: [MY CONNECTION] Sending initial heartbeat after connection"),this.send("heartbeat"))}),500)}handleClose(e){if(!this.isConnected&&!this.socket)return;const t=this.isConnected;this.isConnected=!1,this.socket=null,(0,a.debugLog)("MBA4321: [MY CONNECTION] WebSocket connection closed: code=".concat(e.code,", reason=").concat(e.reason)),this.heartbeatInterval&&(clearInterval(this.heartbeatInterval),this.heartbeatInterval=null),t&&this.notifyHandlers("disconnection",{code:e.code,reason:e.reason,timestamp:(new Date).toISOString()}),this.scheduleReconnect()}handleMessage(e){try{const t=JSON.parse(e.data);if((0,a.debugLog)("MBA4321: [MY CONNECTION] WebSocket message received: ".concat(t.type)),(0,a.debugLog)("MBA4321: [MY CONNECTION] WebSocket message content: ".concat(e.data)),"heartbeat_ack"===t.type)return;this.notifyHandlers(t.type,t.data||{}),this.notifyHandlers("all",{type:t.type,data:t.data||{}})}catch(t){(0,a.debugLog)("MBA4321: [MY CONNECTION] Error handling WebSocket message: ".concat(t.message))}}handleError(e){(0,a.debugLog)("MBA4321: [MY CONNECTION] WebSocket error: ".concat(e.message||"Unknown error")),this.notifyHandlers("error",{error:e.message||"Unknown error",timestamp:(new Date).toISOString()}),this.scheduleReconnect()}send(e,t={}){if(!this.isConnected||!this.socket)return(0,a.debugLog)("MBA4321: [MY CONNECTION] Cannot send message, WebSocket not connected"),!1;try{const o=JSON.stringify({type:e,data:t,timestamp:Date.now()});return this.socket.send(o),(0,a.debugLog)("MBA4321: [MY CONNECTION] Sent ".concat(e," message through connection")),!0}catch(o){return(0,a.debugLog)("MBA4321: [MY CONNECTION] Error sending message through connection: ".concat(o.message)),!1}}scheduleReconnect(){if(this._reconnectTimeout)return void(0,a.debugLog)("MBA4321: Reconnect already scheduled, skipping duplicate");const e=Math.min(1e3*Math.pow(2,this.connectionAttempts-1),3e4);(0,a.debugLog)("MBA4321: Scheduling reconnect in ".concat(e,"ms (attempt ").concat(this.connectionAttempts,")")),this._reconnectTimeout=setTimeout((()=>{this._reconnectTimeout=null,this.isConnected||this.connect()}),e)}startHeartbeat(){this.heartbeatInterval&&clearInterval(this.heartbeatInterval),this.heartbeatInterval=setInterval((()=>{this.isConnected?(this.send("heartbeat",{timestamp:Date.now()}),(0,a.debugLog)("MBA4321: Heartbeat sent")):((0,a.debugLog)("MBA4321: Skipping heartbeat, not connected"),clearInterval(this.heartbeatInterval),this.heartbeatInterval=null)}),3e4),(0,a.debugLog)("MBA4321: Heartbeat mechanism started")}disconnect(e=!1){(0,a.debugLog)("MBA4321: [MY CONNECTION] Disconnecting WebSocket connection (force=".concat(e,")")),this.forceDisconnect=e;const t=!e,o=t?this.token:null;if(this.heartbeatInterval&&(clearInterval(this.heartbeatInterval),this.heartbeatInterval=null),this.disconnectTimeout&&(clearTimeout(this.disconnectTimeout),this.disconnectTimeout=null),this.socket)try{this.socket.onopen=null,this.socket.onclose=null,this.socket.onmessage=null,this.socket.onerror=null,this.socket.close(),this.socket=null,(0,a.debugLog)("MBA4321: [MY CONNECTION] WebSocket connection closed successfully")}catch(n){(0,a.debugLog)("MBA4321: [MY CONNECTION] Error closing WebSocket: ".concat(n.message))}return this.isConnected=!1,t&&o&&(this.token=o,(0,a.debugLog)("MBA4321: [MY CONNECTION] Preserved token for reconnection on tab visibility change")),this.notifyHandlers("connection",{status:"disconnected",forced:e,timestamp:(new Date).toISOString()}),!0}resetDisconnectTimeout(){this.disconnectTimeout&&clearTimeout(this.disconnectTimeout),this.disconnectTimeout=setTimeout((()=>{(0,a.debugLog)("MBA4321: Disconnecting due to inactivity"),this.disconnect()}),6e5)}isWebSocketConnected(){return this.isConnected&&this.socket&&this.socket.readyState===WebSocket.OPEN}registerHandler(e,t,o){return this.messageHandlers.has(e)||this.messageHandlers.set(e,new Map),this.messageHandlers.get(e).set(o,t),(0,a.debugLog)("MBA4321: Registered handler ".concat(o," for ").concat(e," messages")),()=>this.unregisterHandler(e,o)}unregisterHandler(e,t){this.messageHandlers.has(e)&&(this.messageHandlers.get(e).delete(t),(0,a.debugLog)("MBA4321: Unregistered handler ".concat(t," for ").concat(e," messages")))}notifyHandlers(e,t){if(this.messageHandlers.has(e)){this.messageHandlers.get(e).forEach(((o,n)=>{try{o(t)}catch(r){(0,a.debugLog)("MBA4321: Error in ".concat(e," handler ").concat(n,": ").concat(r.message))}}))}if("all"!==e&&this.messageHandlers.has("all")){this.messageHandlers.get("all").forEach(((o,n)=>{try{o({type:e,data:t})}catch(r){(0,a.debugLog)("MBA4321: Error in global handler ".concat(n,": ").concat(r.message))}}))}}markMessagesAsRead(e,t){return!(!Array.isArray(t)||0===t.length)&&this.send("mark_read",{conversation_id:e,message_ids:t})}reconnectIfNeeded(){if((0,a.debugLog)("MBA4321: [MY CONNECTION] Checking if WebSocket reconnection needed"),!this.token||this.forceDisconnect)return(0,a.debugLog)("MBA4321: [MY CONNECTION] Cannot reconnect - ".concat(this.token?"force disconnected":"no token")),!1;if(!this.isConnected||!this.socket||this.socket&&(this.socket.readyState===WebSocket.CLOSED||this.socket.readyState===WebSocket.CLOSING)){if((0,a.debugLog)("MBA4321: [MY CONNECTION] WebSocket needs reconnection, attempting now"),this.forceDisconnect=!1,this.socket)try{this.socket.onclose=null,this.socket.close(),this.socket=null}catch(e){(0,a.debugLog)("MBA4321: [MY CONNECTION] Error closing existing socket: ".concat(e.message))}return this.isConnected=!1,setTimeout((()=>{this.connect()}),100),!0}return this.isConnected&&this.socket&&this.socket.readyState===WebSocket.OPEN&&((0,a.debugLog)("MBA4321: [MY CONNECTION] WebSocket appears connected, sending heartbeat to verify"),this.send("heartbeat"),this.resetDisconnectTimeout()),!1}}},35358:(e,t,o)=>{var n={"./af":17582,"./af.js":17582,"./ar":93042,"./ar-dz":54265,"./ar-dz.js":54265,"./ar-kw":92553,"./ar-kw.js":92553,"./ar-ly":85352,"./ar-ly.js":85352,"./ar-ma":67097,"./ar-ma.js":67097,"./ar-ps":76150,"./ar-ps.js":76150,"./ar-sa":84427,"./ar-sa.js":84427,"./ar-tn":7221,"./ar-tn.js":7221,"./ar.js":93042,"./az":60458,"./az.js":60458,"./be":17596,"./be.js":17596,"./bg":93830,"./bg.js":93830,"./bm":27044,"./bm.js":27044,"./bn":58573,"./bn-bd":13296,"./bn-bd.js":13296,"./bn.js":58573,"./bo":25614,"./bo.js":25614,"./br":62041,"./br.js":62041,"./bs":91786,"./bs.js":91786,"./ca":75833,"./ca.js":75833,"./cs":52711,"./cs.js":52711,"./cv":71036,"./cv.js":71036,"./cy":84977,"./cy.js":84977,"./da":8770,"./da.js":8770,"./de":67342,"./de-at":81566,"./de-at.js":81566,"./de-ch":87544,"./de-ch.js":87544,"./de.js":67342,"./dv":82875,"./dv.js":82875,"./el":78536,"./el.js":78536,"./en-au":38617,"./en-au.js":38617,"./en-ca":79227,"./en-ca.js":79227,"./en-gb":59754,"./en-gb.js":59754,"./en-ie":37217,"./en-ie.js":37217,"./en-il":85418,"./en-il.js":85418,"./en-in":80800,"./en-in.js":80800,"./en-nz":67299,"./en-nz.js":67299,"./en-sg":76305,"./en-sg.js":76305,"./eo":8673,"./eo.js":8673,"./es":71301,"./es-do":3187,"./es-do.js":3187,"./es-mx":48223,"./es-mx.js":48223,"./es-us":37634,"./es-us.js":37634,"./es.js":71301,"./et":4976,"./et.js":4976,"./eu":11847,"./eu.js":11847,"./fa":74372,"./fa.js":74372,"./fi":41628,"./fi.js":41628,"./fil":56802,"./fil.js":56802,"./fo":42874,"./fo.js":42874,"./fr":9853,"./fr-ca":87170,"./fr-ca.js":87170,"./fr-ch":22825,"./fr-ch.js":22825,"./fr.js":9853,"./fy":68876,"./fy.js":68876,"./ga":93533,"./ga.js":93533,"./gd":82770,"./gd.js":82770,"./gl":98602,"./gl.js":98602,"./gom-deva":63059,"./gom-deva.js":63059,"./gom-latn":48212,"./gom-latn.js":48212,"./gu":23409,"./gu.js":23409,"./he":17210,"./he.js":17210,"./hi":4750,"./hi.js":4750,"./hr":51315,"./hr.js":51315,"./hu":47626,"./hu.js":47626,"./hy-am":91317,"./hy-am.js":91317,"./id":26892,"./id.js":26892,"./is":97577,"./is.js":97577,"./it":57628,"./it-ch":3046,"./it-ch.js":3046,"./it.js":57628,"./ja":92504,"./ja.js":92504,"./jv":25917,"./jv.js":25917,"./ka":64513,"./ka.js":64513,"./kk":94935,"./kk.js":94935,"./km":96661,"./km.js":96661,"./kn":89964,"./kn.js":89964,"./ko":98067,"./ko.js":98067,"./ku":61165,"./ku-kmr":85158,"./ku-kmr.js":85158,"./ku.js":61165,"./ky":11177,"./ky.js":11177,"./lb":2967,"./lb.js":2967,"./lo":81972,"./lo.js":81972,"./lt":58469,"./lt.js":58469,"./lv":33155,"./lv.js":33155,"./me":87935,"./me.js":87935,"./mi":74483,"./mi.js":74483,"./mk":32501,"./mk.js":32501,"./ml":73120,"./ml.js":73120,"./mn":20266,"./mn.js":20266,"./mr":19406,"./mr.js":19406,"./ms":80109,"./ms-my":90864,"./ms-my.js":90864,"./ms.js":80109,"./mt":22904,"./mt.js":22904,"./my":44067,"./my.js":44067,"./nb":21301,"./nb.js":21301,"./ne":81152,"./ne.js":81152,"./nl":76735,"./nl-be":97761,"./nl-be.js":97761,"./nl.js":76735,"./nn":37569,"./nn.js":37569,"./oc-lnc":20833,"./oc-lnc.js":20833,"./pa-in":3044,"./pa-in.js":3044,"./pl":34249,"./pl.js":34249,"./pt":87585,"./pt-br":26826,"./pt-br.js":26826,"./pt.js":87585,"./ro":62526,"./ro.js":62526,"./ru":62204,"./ru.js":62204,"./sd":43270,"./sd.js":43270,"./se":61541,"./se.js":61541,"./si":71921,"./si.js":71921,"./sk":49935,"./sk.js":49935,"./sl":46254,"./sl.js":46254,"./sq":59897,"./sq.js":59897,"./sr":42496,"./sr-cyrl":11135,"./sr-cyrl.js":11135,"./sr.js":42496,"./ss":32215,"./ss.js":32215,"./sv":84716,"./sv.js":84716,"./sw":50803,"./sw.js":50803,"./ta":31538,"./ta.js":31538,"./te":2302,"./te.js":2302,"./tet":25280,"./tet.js":25280,"./tg":14100,"./tg.js":14100,"./th":95385,"./th.js":95385,"./tk":736,"./tk.js":736,"./tl-ph":79726,"./tl-ph.js":79726,"./tlh":41873,"./tlh.js":41873,"./tr":36463,"./tr.js":36463,"./tzl":27491,"./tzl.js":27491,"./tzm":29500,"./tzm-latn":80196,"./tzm-latn.js":80196,"./tzm.js":29500,"./ug-cn":91287,"./ug-cn.js":91287,"./uk":35341,"./uk.js":35341,"./ur":36246,"./ur.js":36246,"./uz":55550,"./uz-latn":77254,"./uz-latn.js":77254,"./uz.js":55550,"./vi":78796,"./vi.js":78796,"./x-pseudo":22736,"./x-pseudo.js":22736,"./yo":28621,"./yo.js":28621,"./zh-cn":67601,"./zh-cn.js":67601,"./zh-hk":39053,"./zh-hk.js":39053,"./zh-mo":71248,"./zh-mo.js":71248,"./zh-tw":74725,"./zh-tw.js":74725};function a(e){var t=r(e);return o(t)}function r(e){if(!o.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}a.keys=function(){return Object.keys(n)},a.resolve=r,e.exports=a,a.id=35358},58162:(e,t,o)=>{"use strict";e.exports=o.p+"static/media/ZEGN_USER.ab7ee48e98c0856bd407.jpeg"},18827:(e,t,o)=>{"use strict";e.exports=o.p+"static/media/crittrcove-high-resolution-logo-transparent.761085745bd386bf07cb.png"},65460:(e,t,o)=>{"use strict";e.exports=o.p+"static/media/default-pet-image.3b5628b61ce454d19bca.png"},4456:(e,t,o)=>{"use strict";e.exports=o.p+"static/media/default-profile.0695878757dbc86fae81.png"},32571:(e,t,o)=>{"use strict";e.exports=o.p+"static/media/hero-image.394965577111d15fa349.jpg"},81029:(e,t,o)=>{"use strict";e.exports=o.p+"static/media/user1.7a2574d2f5544235a6c5.png"},24289:(e,t,o)=>{"use strict";e.exports=o.p+"static/media/user10.55bbb564f3b12d6a736e.png"},53198:(e,t,o)=>{"use strict";e.exports=o.p+"static/media/user2.2356c55dbde8d97f60f2.png"},52695:(e,t,o)=>{"use strict";e.exports=o.p+"static/media/user3.ceef543650ca617d5e9e.png"},30552:(e,t,o)=>{"use strict";e.exports=o.p+"static/media/user4.58378ed25cf9bc79aeb4.png"},51681:(e,t,o)=>{"use strict";e.exports=o.p+"static/media/user5.6e041c0f826063afc158.png"},10602:(e,t,o)=>{"use strict";e.exports=o.p+"static/media/user6.943d36e020756a238d35.png"},26163:(e,t,o)=>{"use strict";e.exports=o.p+"static/media/user7.1431674f298a9f88bd16.png"},244:(e,t,o)=>{"use strict";e.exports=o.p+"static/media/user8.fb62e9c497f7a3d39de8.png"},21373:(e,t,o)=>{"use strict";e.exports=o.p+"static/media/user9.fdb12560d3f0a8511959.png"}},t={};function o(n){var a=t[n];if(void 0!==a)return a.exports;var r=t[n]={id:n,loaded:!1,exports:{}};return e[n].call(r.exports,r,r.exports,o),r.loaded=!0,r.exports}o.m=e,(()=>{var e=[];o.O=(t,n,a,r)=>{if(!n){var i=1/0;for(c=0;c<e.length;c++){for(var[n,a,r]=e[c],s=!0,l=0;l<n.length;l++)(!1&r||i>=r)&&Object.keys(o.O).every((e=>o.O[e](n[l])))?n.splice(l--,1):(s=!1,r<i&&(i=r));if(s){e.splice(c--,1);var d=a();void 0!==d&&(t=d)}}return t}r=r||0;for(var c=e.length;c>0&&e[c-1][2]>r;c--)e[c]=e[c-1];e[c]=[n,a,r]}})(),o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),o.p="/",(()=>{var e={792:0};o.O.j=t=>0===e[t];var t=(t,n)=>{var a,r,[i,s,l]=n,d=0;if(i.some((t=>0!==e[t]))){for(a in s)o.o(s,a)&&(o.m[a]=s[a]);if(l)var c=l(o)}for(t&&t(n);d<i.length;d++)r=i[d],o.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return o.O(c)},n=self.webpackChunkweb=self.webpackChunkweb||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var n=o.O(void 0,[9],(()=>o(55819)));n=o.O(n)})();
//# sourceMappingURL=main.26c2c59b.js.map